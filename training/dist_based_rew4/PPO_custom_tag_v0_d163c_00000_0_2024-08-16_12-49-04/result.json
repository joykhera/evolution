{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.9243735468103773, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.704304279599871, "policy_loss": -0.0033358346311148828, "vf_loss": 5.706377858964224, "vf_explained_var": 0.004192602508282535, "kl": 0.006311267527080081, "entropy": 1.6031542398942211, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 945.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.973814254636487, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.996864834538212, "policy_loss": -0.006654669099521858, "vf_loss": 6.002285651050547, "vf_explained_var": -0.0009477701767411813, "kl": 0.006169176544366439, "entropy": 1.6033142793115485, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 945.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "env_runners": {"episode_reward_max": 149.75604195055888, "episode_reward_min": -2.983959188548498, "episode_reward_mean": 49.63969762629453, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 3600, "policy_reward_min": {"prey_policy": -102.49165396716678, "predator_policy": 0.6555041467658698}, "policy_reward_max": {"prey_policy": 127.22053780379298, "predator_policy": 113.18433267872244}, "policy_reward_mean": {"prey_policy": -10.518382246459879, "predator_policy": 35.33823105960718}, "custom_metrics": {}, "hist_stats": {"episode_reward": [6.6464158583550965, -2.491213482754997, 149.75604195055888, 17.910000000000224, -2.983959188548498, 30.647496578504875, 138.88740604715525, 66.92832223644113, 2.0100000000000002, 86.99210422435353, 7.0576325676794305, 6.653304131223338, 8.622893639961035, 129.09123038230933, 33.373002232286325, 65.1450149913892, 143.926081203783, 5.342783900604354], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-9.435218371388688, -5.292551719540984, -36.73574180469024, -18.80412376924984, 127.22053780379298, -47.13816302918068, -102.49165396716678, -25.518175724543823, -32.663159299733, -40.33069276307399, -1.7610091628405096, -34.00947900430485, 57.64132691242457, 10.4099006987609, -17.660973272357495, 27.74000000000015, -66.6560479349119, -33.18613709676584, 48.940266654958094, -1.6755001783690566, -46.7236706296504, -3.3473639592382685, -14.40170278416673, 1.7900000000000016, -11.062418809167797, -90.16515490012259, 109.21009581683069, -80.75185268785955, -9.768356667014586, -79.2921041685323, 56.4263856048799, -8.683343257158878, 77.056858481836, -25.315681696773385, -27.995212461797337, -24.231643726439415], "policy_predator_policy_reward": [8.318967577896112, 13.055218371388653, 2.9492998563846142, 50.09935223480051, 0.6555041467658698, 69.01816302918053, 103.29165396716701, 42.62817572454401, 25.795715374277993, 44.21417749998048, 31.288606439006283, 35.12937830664348, 34.460880686411414, 36.37529774955811, 46.4243730623202, 10.424922446478513, 67.7360479349124, 34.1161370967658, 3.9275377201745116, 35.79980002758989, 36.43839403609908, 20.690273120469055, 13.78757419782323, 5.477432717566881, 90.15742979176657, 19.69303755748478, 21.143726429579853, 79.48926082375878, 113.18433267872244, 9.249130389110528, 8.532015825386688, 8.869956818281196, 34.74431910129788, 57.440585317424045, 40.36452009161869, 17.205119997222795]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.540776116836126, "mean_inference_ms": 6.3311027376550975, "mean_action_processing_ms": 1.0125830307462147, "mean_env_wait_ms": 0.878896373987904, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01532435417175293, "StateBufferConnector_ms": 0.0136362181769477, "ViewRequirementAgentConnector_ms": 0.4050877359178331}, "num_episodes": 18, "episode_return_max": 149.75604195055888, "episode_return_min": -2.983959188548498, "episode_return_mean": 49.63969762629453, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 122.2193863137438, "num_env_steps_trained_throughput_per_sec": 122.2193863137438, "timesteps_total": 4000, "num_env_steps_sampled_lifetime": 4000, "num_agent_steps_sampled_lifetime": 16000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 16000, "timers": {"training_iteration_time_ms": 32728.041, "restore_workers_time_ms": 0.019, "training_step_time_ms": 32727.989, "sample_time_ms": 5027.206, "learn_time_ms": 27570.564, "learn_throughput": 145.082, "synch_weights_time_ms": 128.843}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "done": false, "training_iteration": 1, "trial_id": "d163c_00000", "date": "2024-08-16_12-49-55", "timestamp": 1723792795, "time_this_iter_s": 32.75244331359863, "time_total_s": 32.75244331359863, "pid": 81201, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16af90f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 32.75244331359863, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 43.791304347826085, "ram_util_percent": 63.543478260869556}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.9110107745443072, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.9314133533094293, "policy_loss": -0.006265873132303121, "vf_loss": 3.9356570112642157, "vf_explained_var": 0.04372189284632445, "kl": 0.010111070819708839, "entropy": 1.6015610464666254, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 2835.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1521308767890173, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.691217797900003, "policy_loss": -0.01422693654919467, "vf_loss": 7.702855815584697, "vf_explained_var": 0.04651010313992778, "kl": 0.012944539605791018, "entropy": 1.5811893168580595, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 2835.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "env_runners": {"episode_reward_max": 292.80200470651766, "episode_reward_min": -2.983959188548498, "episode_reward_mean": 103.64893552474595, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 7200, "policy_reward_min": {"prey_policy": -123.98447667160579, "predator_policy": 0.6555041467658698}, "policy_reward_max": {"prey_policy": 176.2470038373904, "predator_policy": 113.18433267872244}, "policy_reward_mean": {"prey_policy": 20.721798335821003, "predator_policy": 31.102669426551984}, "custom_metrics": {}, "hist_stats": {"episode_reward": [6.6464158583550965, -2.491213482754997, 149.75604195055888, 17.910000000000224, -2.983959188548498, 30.647496578504875, 138.88740604715525, 66.92832223644113, 2.0100000000000002, 86.99210422435353, 7.0576325676794305, 6.653304131223338, 8.622893639961035, 129.09123038230933, 33.373002232286325, 65.1450149913892, 143.926081203783, 5.342783900604354, 172.9039033383758, 76.32448815182971, 87.49838808523617, 292.80200470651766, 76.16287770260513, 193.85999999999945, 81.87918938216806, 97.41110534242246, 277.8048386363691, 177.9247689296103, 167.2065480882389, 122.73998456577245, 170.27227976009877, 272.58000000000015, 176.72166970934364, 104.10443583801568, 127.62145731966021, 162.02918206128868], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-9.435218371388688, -5.292551719540984, -36.73574180469024, -18.80412376924984, 127.22053780379298, -47.13816302918068, -102.49165396716678, -25.518175724543823, -32.663159299733, -40.33069276307399, -1.7610091628405096, -34.00947900430485, 57.64132691242457, 10.4099006987609, -17.660973272357495, 27.74000000000015, -66.6560479349119, -33.18613709676584, 48.940266654958094, -1.6755001783690566, -46.7236706296504, -3.3473639592382685, -14.40170278416673, 1.7900000000000016, -11.062418809167797, -90.16515490012259, 109.21009581683069, -80.75185268785955, -9.768356667014586, -79.2921041685323, 56.4263856048799, -8.683343257158878, 77.056858481836, -25.315681696773385, -27.995212461797337, -24.231643726439415, 123.91125137128503, -123.98447667160579, 4.239620878560724, 46.30075933959806, 22.33190869947577, -1.2786089639759706, 91.30275343780883, 164.9446162891034, -45.52634437935254, 54.6928322803745, 167.40556346779692, -22.25954222101657, 6.949999999999978, 68.97766301070264, -29.603745649890115, 63.13932629133531, 170.29999999999973, 82.17865669586664, 31.030952322271105, 80.61677265358105, 16.670806104155744, 32.68587222427432, 9.398313671753048, 81.04333985347931, 68.77377091691565, 65.3728565068583, 78.01136923307931, 176.2470038373904, 128.29231269610875, 7.6647985871273825, 69.88851514445686, -43.99008356791783, -24.458470133063173, 102.79897861956997, 63.91666254271991, 82.64523596284127], "policy_predator_policy_reward": [8.318967577896112, 13.055218371388653, 2.9492998563846142, 50.09935223480051, 0.6555041467658698, 69.01816302918053, 103.29165396716701, 42.62817572454401, 25.795715374277993, 44.21417749998048, 31.288606439006283, 35.12937830664348, 34.460880686411414, 36.37529774955811, 46.4243730623202, 10.424922446478513, 67.7360479349124, 34.1161370967658, 3.9275377201745116, 35.79980002758989, 36.43839403609908, 20.690273120469055, 13.78757419782323, 5.477432717566881, 90.15742979176657, 19.69303755748478, 21.143726429579853, 79.48926082375878, 113.18433267872244, 9.249130389110528, 8.532015825386688, 8.869956818281196, 34.74431910129788, 57.440585317424045, 40.36452009161869, 17.205119997222795, 92.48703943949876, 80.49008919919815, 20.96699588785932, 4.817112045811481, 2.531106139590157, 63.913982210146074, 21.43268238998254, 15.121952589622659, 50.35534797580398, 16.64104182577901, 7.868766626678848, 40.84521212654087, 2.5587838445225186, 3.392742526942351, 24.799892243277363, 39.075632457699726, 13.242307441820426, 12.083874498682308, 44.275217897226135, 22.00182605653248, 100.44536716722683, 17.404502592582215, 12.956333726120498, 19.341997314419242, 20.55850776248104, 15.567144573843759, 13.56863076692068, 4.752996162609612, 30.54655265678981, 10.218005769317733, 35.67325837625089, 42.53274588522539, 18.018791332578715, 31.262157500574833, 13.12024369766499, 2.3470398580628693]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.896165096651081, "mean_inference_ms": 7.222453381940081, "mean_action_processing_ms": 1.18143916157524, "mean_env_wait_ms": 1.0173839850691222, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.043580598301357694, "StateBufferConnector_ms": 0.01195669174194336, "ViewRequirementAgentConnector_ms": 0.5853123135036893}, "num_episodes": 18, "episode_return_max": 292.80200470651766, "episode_return_min": -2.983959188548498, "episode_return_mean": 103.64893552474595, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 130.62810732174313, "num_env_steps_trained_throughput_per_sec": 130.62810732174313, "timesteps_total": 8000, "num_env_steps_sampled_lifetime": 8000, "num_agent_steps_sampled_lifetime": 32000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 32000, "timers": {"training_iteration_time_ms": 31674.722, "restore_workers_time_ms": 0.095, "training_step_time_ms": 31674.509, "sample_time_ms": 6409.653, "learn_time_ms": 25162.116, "learn_throughput": 158.969, "synch_weights_time_ms": 98.72}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "done": false, "training_iteration": 2, "trial_id": "d163c_00000", "date": "2024-08-16_12-50-42", "timestamp": 1723792842, "time_this_iter_s": 30.642549991607666, "time_total_s": 63.3949933052063, "pid": 81201, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16afbd5e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 63.3949933052063, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 50.29253731343284, "ram_util_percent": 71.0089552238806}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.9053584312320386, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.5802337876072636, "policy_loss": -0.008438206274584725, "vf_loss": 3.586446235671876, "vf_explained_var": 0.07084421878138547, "kl": 0.01112876675669542, "entropy": 1.589267854778855, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 4725.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.505655442201902, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.284699017660959, "policy_loss": -0.0037530568783127128, "vf_loss": 9.28677374925563, "vf_explained_var": 0.013555676407284207, "kl": 0.008391731030592285, "entropy": 1.5666712770386348, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 4725.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "env_runners": {"episode_reward_max": 366.06857964991934, "episode_reward_min": -2.983959188548498, "episode_reward_mean": 142.73487014640077, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 10800, "policy_reward_min": {"prey_policy": -123.98447667160579, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 192.08000000000004, "predator_policy": 129.4844663833387}, "policy_reward_mean": {"prey_policy": 41.101197002410714, "predator_policy": 30.266238070789694}, "custom_metrics": {}, "hist_stats": {"episode_reward": [6.6464158583550965, -2.491213482754997, 149.75604195055888, 17.910000000000224, -2.983959188548498, 30.647496578504875, 138.88740604715525, 66.92832223644113, 2.0100000000000002, 86.99210422435353, 7.0576325676794305, 6.653304131223338, 8.622893639961035, 129.09123038230933, 33.373002232286325, 65.1450149913892, 143.926081203783, 5.342783900604354, 172.9039033383758, 76.32448815182971, 87.49838808523617, 292.80200470651766, 76.16287770260513, 193.85999999999945, 81.87918938216806, 97.41110534242246, 277.8048386363691, 177.9247689296103, 167.2065480882389, 122.73998456577245, 170.27227976009877, 272.58000000000015, 176.72166970934364, 104.10443583801568, 127.62145731966021, 162.02918206128868, 146.00784692678215, 162.58670697991255, 285.5829762711612, 267.9728918429729, 180.87861987844565, 272.34168854705143, 160.95437416676975, 366.06857964991934, 197.46004914543266, 252.32775040756684, 103.93000000000018, 314.27, 275.9506835998921, 209.15415415028215, 189.0391147847325, 293.5978317722049, 104.6480408916625, 193.54999999999995], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-9.435218371388688, -5.292551719540984, -36.73574180469024, -18.80412376924984, 127.22053780379298, -47.13816302918068, -102.49165396716678, -25.518175724543823, -32.663159299733, -40.33069276307399, -1.7610091628405096, -34.00947900430485, 57.64132691242457, 10.4099006987609, -17.660973272357495, 27.74000000000015, -66.6560479349119, -33.18613709676584, 48.940266654958094, -1.6755001783690566, -46.7236706296504, -3.3473639592382685, -14.40170278416673, 1.7900000000000016, -11.062418809167797, -90.16515490012259, 109.21009581683069, -80.75185268785955, -9.768356667014586, -79.2921041685323, 56.4263856048799, -8.683343257158878, 77.056858481836, -25.315681696773385, -27.995212461797337, -24.231643726439415, 123.91125137128503, -123.98447667160579, 4.239620878560724, 46.30075933959806, 22.33190869947577, -1.2786089639759706, 91.30275343780883, 164.9446162891034, -45.52634437935254, 54.6928322803745, 167.40556346779692, -22.25954222101657, 6.949999999999978, 68.97766301070264, -29.603745649890115, 63.13932629133531, 170.29999999999973, 82.17865669586664, 31.030952322271105, 80.61677265358105, 16.670806104155744, 32.68587222427432, 9.398313671753048, 81.04333985347931, 68.77377091691565, 65.3728565068583, 78.01136923307931, 176.2470038373904, 128.29231269610875, 7.6647985871273825, 69.88851514445686, -43.99008356791783, -24.458470133063173, 102.79897861956997, 63.91666254271991, 82.64523596284127, 98.23103064884818, -104.64524099815063, -8.930365536233154, 98.4295386049811, 159.62247631623967, 79.75399446152817, 148.46220207203314, 32.53487889188246, 24.75567166431678, 104.72443363459591, 77.2417573631765, 165.00800402925555, -5.255049209757001, 109.65393156970953, 192.08000000000004, 142.7218891493332, 53.79979308361593, 116.79898893532948, 55.18368170863959, 142.87033362046594, 88.35468830517948, -15.713782193495069, 127.51983470480283, 168.50135260398162, 95.37983849069059, 112.9879158091353, -15.545132297538089, 147.5704155550106, 18.823446756867863, 102.63268938669354, 151.60903025615164, 113.97301917582996, 59.14042238239744, -32.570164976271045, 75.28476023900686, 65.9695118729914], "policy_predator_policy_reward": [8.318967577896112, 13.055218371388653, 2.9492998563846142, 50.09935223480051, 0.6555041467658698, 69.01816302918053, 103.29165396716701, 42.62817572454401, 25.795715374277993, 44.21417749998048, 31.288606439006283, 35.12937830664348, 34.460880686411414, 36.37529774955811, 46.4243730623202, 10.424922446478513, 67.7360479349124, 34.1161370967658, 3.9275377201745116, 35.79980002758989, 36.43839403609908, 20.690273120469055, 13.78757419782323, 5.477432717566881, 90.15742979176657, 19.69303755748478, 21.143726429579853, 79.48926082375878, 113.18433267872244, 9.249130389110528, 8.532015825386688, 8.869956818281196, 34.74431910129788, 57.440585317424045, 40.36452009161869, 17.205119997222795, 92.48703943949876, 80.49008919919815, 20.96699588785932, 4.817112045811481, 2.531106139590157, 63.913982210146074, 21.43268238998254, 15.121952589622659, 50.35534797580398, 16.64104182577901, 7.868766626678848, 40.84521212654087, 2.5587838445225186, 3.392742526942351, 24.799892243277363, 39.075632457699726, 13.242307441820426, 12.083874498682308, 44.275217897226135, 22.00182605653248, 100.44536716722683, 17.404502592582215, 12.956333726120498, 19.341997314419242, 20.55850776248104, 15.567144573843759, 13.56863076692068, 4.752996162609612, 30.54655265678981, 10.218005769317733, 35.67325837625089, 42.53274588522539, 18.018791332578715, 31.262157500574833, 13.12024369766499, 2.3470398580628693, 22.9375908927458, 129.4844663833387, 14.197631863804531, 58.889902047359904, 33.2506950683375, 12.955810425056196, 31.142228367861406, 55.83358251119594, 8.09087682037657, 43.307637759156464, 16.303585524662186, 13.788341629957579, 31.386473013365894, 25.169018793451308, 2.110409736585363, 29.156280764000858, 25.675688901644747, 1.1855782248425468, 5.857992276514507, 48.41574280194676, 14.045311694820512, 17.243782193495097, 0.0, 18.248812691215537, 16.966049365249418, 50.616879934816744, 75.19474122556169, 1.934129667247974, 48.318100162186894, 19.26487847898424, 20.30411589638796, 7.711666443835353, 62.56069015011117, 15.517093335424649, 28.380488127008565, 23.915239760993153]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.0074450518581197, "mean_inference_ms": 7.617232418722426, "mean_action_processing_ms": 1.2431752951269563, "mean_env_wait_ms": 1.0669538035465986, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04041614355864348, "StateBufferConnector_ms": 0.010992862560130932, "ViewRequirementAgentConnector_ms": 0.5652306256470857}, "num_episodes": 18, "episode_return_max": 366.06857964991934, "episode_return_min": -2.983959188548498, "episode_return_mean": 142.73487014640077, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 166.9450541017604, "num_env_steps_trained_throughput_per_sec": 166.9450541017604, "timesteps_total": 12000, "num_env_steps_sampled_lifetime": 12000, "num_agent_steps_sampled_lifetime": 48000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 48000, "timers": {"training_iteration_time_ms": 29103.145, "restore_workers_time_ms": 0.071, "training_step_time_ms": 29102.983, "sample_time_ms": 6520.707, "learn_time_ms": 22506.716, "learn_throughput": 177.725, "synch_weights_time_ms": 72.42}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "done": false, "training_iteration": 3, "trial_id": "d163c_00000", "date": "2024-08-16_12-51-06", "timestamp": 1723792866, "time_this_iter_s": 23.964759826660156, "time_total_s": 87.35975313186646, "pid": 81201, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16aff7280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 87.35975313186646, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 35.68529411764706, "ram_util_percent": 73.84117647058825}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.0971879838004943, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.322714464752762, "policy_loss": -0.015271050539902515, "vf_loss": 6.334800645535585, "vf_explained_var": 0.09912969552019917, "kl": 0.015924218152477916, "entropy": 1.567105579754663, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 6615.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6781770061563563, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.25564137615224, "policy_loss": -0.0019540959321179244, "vf_loss": 9.256183004126978, "vf_explained_var": -0.009677483038927513, "kl": 0.007062358043853, "entropy": 1.5547761488843848, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 6615.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "env_runners": {"episode_reward_max": 366.06857964991934, "episode_reward_min": -2.983959188548498, "episode_reward_mean": 159.2860032847447, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 14400, "policy_reward_min": {"prey_policy": -123.98447667160579, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 192.08000000000004, "predator_policy": 129.4844663833387}, "policy_reward_mean": {"prey_policy": 47.82626378310774, "predator_policy": 31.816737859264624}, "custom_metrics": {}, "hist_stats": {"episode_reward": [6.6464158583550965, -2.491213482754997, 149.75604195055888, 17.910000000000224, -2.983959188548498, 30.647496578504875, 138.88740604715525, 66.92832223644113, 2.0100000000000002, 86.99210422435353, 7.0576325676794305, 6.653304131223338, 8.622893639961035, 129.09123038230933, 33.373002232286325, 65.1450149913892, 143.926081203783, 5.342783900604354, 172.9039033383758, 76.32448815182971, 87.49838808523617, 292.80200470651766, 76.16287770260513, 193.85999999999945, 81.87918938216806, 97.41110534242246, 277.8048386363691, 177.9247689296103, 167.2065480882389, 122.73998456577245, 170.27227976009877, 272.58000000000015, 176.72166970934364, 104.10443583801568, 127.62145731966021, 162.02918206128868, 146.00784692678215, 162.58670697991255, 285.5829762711612, 267.9728918429729, 180.87861987844565, 272.34168854705143, 160.95437416676975, 366.06857964991934, 197.46004914543266, 252.32775040756684, 103.93000000000018, 314.27, 275.9506835998921, 209.15415415028215, 189.0391147847325, 293.5978317722049, 104.6480408916625, 193.54999999999995, 313.99732560871615, 82.3737958141965, 292.9180344114149, 278.0913393215624, 134.18317628891995, 148.9266782329197, 182.79131396524525, 227.05510161699104, 346.3227705597111, 98.7027472191676, 223.66608806714535, 267.0148427306772, 221.41468643048773, 127.5772690669252, 204.64955054152878, 101.8904110179065, 247.08, 262.25411770246086], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-9.435218371388688, -5.292551719540984, -36.73574180469024, -18.80412376924984, 127.22053780379298, -47.13816302918068, -102.49165396716678, -25.518175724543823, -32.663159299733, -40.33069276307399, -1.7610091628405096, -34.00947900430485, 57.64132691242457, 10.4099006987609, -17.660973272357495, 27.74000000000015, -66.6560479349119, -33.18613709676584, 48.940266654958094, -1.6755001783690566, -46.7236706296504, -3.3473639592382685, -14.40170278416673, 1.7900000000000016, -11.062418809167797, -90.16515490012259, 109.21009581683069, -80.75185268785955, -9.768356667014586, -79.2921041685323, 56.4263856048799, -8.683343257158878, 77.056858481836, -25.315681696773385, -27.995212461797337, -24.231643726439415, 123.91125137128503, -123.98447667160579, 4.239620878560724, 46.30075933959806, 22.33190869947577, -1.2786089639759706, 91.30275343780883, 164.9446162891034, -45.52634437935254, 54.6928322803745, 167.40556346779692, -22.25954222101657, 6.949999999999978, 68.97766301070264, -29.603745649890115, 63.13932629133531, 170.29999999999973, 82.17865669586664, 31.030952322271105, 80.61677265358105, 16.670806104155744, 32.68587222427432, 9.398313671753048, 81.04333985347931, 68.77377091691565, 65.3728565068583, 78.01136923307931, 176.2470038373904, 128.29231269610875, 7.6647985871273825, 69.88851514445686, -43.99008356791783, -24.458470133063173, 102.79897861956997, 63.91666254271991, 82.64523596284127, 98.23103064884818, -104.64524099815063, -8.930365536233154, 98.4295386049811, 159.62247631623967, 79.75399446152817, 148.46220207203314, 32.53487889188246, 24.75567166431678, 104.72443363459591, 77.2417573631765, 165.00800402925555, -5.255049209757001, 109.65393156970953, 192.08000000000004, 142.7218891493332, 53.79979308361593, 116.79898893532948, 55.18368170863959, 142.87033362046594, 88.35468830517948, -15.713782193495069, 127.51983470480283, 168.50135260398162, 95.37983849069059, 112.9879158091353, -15.545132297538089, 147.5704155550106, 18.823446756867863, 102.63268938669354, 151.60903025615164, 113.97301917582996, 59.14042238239744, -32.570164976271045, 75.28476023900686, 65.9695118729914, 186.99176643123025, 84.91846866046653, 23.44998977678195, -46.108199992273946, 140.66749925344828, 139.55173190570935, 118.2236705961473, 128.0180983135607, -73.42853207864356, 100.96267488678512, 50.34779003509462, 54.12718513283024, 36.78035788593154, 22.923886401975242, 72.04003981343229, 94.80697740629672, 131.83496817597734, 185.19201652726736, -0.2925095676102072, -46.885775516504246, 68.91848907235074, 83.72170680742323, 126.82249385301888, 115.50858603984679, 72.17102901764336, 100.86036133986825, -11.14004795589213, 35.38142352196645, 139.6780098853608, -6.081383163308758, 36.682789432651695, -59.90695591977523, 67.29528906920825, 109.51054838425992, 141.4025048106237, 23.105760264007834], "policy_predator_policy_reward": [8.318967577896112, 13.055218371388653, 2.9492998563846142, 50.09935223480051, 0.6555041467658698, 69.01816302918053, 103.29165396716701, 42.62817572454401, 25.795715374277993, 44.21417749998048, 31.288606439006283, 35.12937830664348, 34.460880686411414, 36.37529774955811, 46.4243730623202, 10.424922446478513, 67.7360479349124, 34.1161370967658, 3.9275377201745116, 35.79980002758989, 36.43839403609908, 20.690273120469055, 13.78757419782323, 5.477432717566881, 90.15742979176657, 19.69303755748478, 21.143726429579853, 79.48926082375878, 113.18433267872244, 9.249130389110528, 8.532015825386688, 8.869956818281196, 34.74431910129788, 57.440585317424045, 40.36452009161869, 17.205119997222795, 92.48703943949876, 80.49008919919815, 20.96699588785932, 4.817112045811481, 2.531106139590157, 63.913982210146074, 21.43268238998254, 15.121952589622659, 50.35534797580398, 16.64104182577901, 7.868766626678848, 40.84521212654087, 2.5587838445225186, 3.392742526942351, 24.799892243277363, 39.075632457699726, 13.242307441820426, 12.083874498682308, 44.275217897226135, 22.00182605653248, 100.44536716722683, 17.404502592582215, 12.956333726120498, 19.341997314419242, 20.55850776248104, 15.567144573843759, 13.56863076692068, 4.752996162609612, 30.54655265678981, 10.218005769317733, 35.67325837625089, 42.53274588522539, 18.018791332578715, 31.262157500574833, 13.12024369766499, 2.3470398580628693, 22.9375908927458, 129.4844663833387, 14.197631863804531, 58.889902047359904, 33.2506950683375, 12.955810425056196, 31.142228367861406, 55.83358251119594, 8.09087682037657, 43.307637759156464, 16.303585524662186, 13.788341629957579, 31.386473013365894, 25.169018793451308, 2.110409736585363, 29.156280764000858, 25.675688901644747, 1.1855782248425468, 5.857992276514507, 48.41574280194676, 14.045311694820512, 17.243782193495097, 0.0, 18.248812691215537, 16.966049365249418, 50.616879934816744, 75.19474122556169, 1.934129667247974, 48.318100162186894, 19.26487847898424, 20.30411589638796, 7.711666443835353, 62.56069015011117, 15.517093335424649, 28.380488127008565, 23.915239760993153, 21.71643261221924, 20.37065790480024, 7.410566830354747, 97.6214391993338, 0.7593927096411699, 11.939410542615988, 21.31718023871327, 10.53239017314095, 29.51696054631988, 77.13207293445879, 22.46875583522438, 21.982947229770563, 2.668536548929236, 120.41853312840914, 29.48619831424603, 30.721886083015995, 7.843542813704967, 21.452243042761516, 83.77191382321256, 62.109118480069455, 36.388665051833485, 34.63722713553792, 7.001693812909098, 17.682069024902276, 1.5138959871619635, 46.86940008581415, 54.570845964802906, 48.765047536047824, 45.665943007161445, 25.386980812315382, 34.1869172864994, 90.92766021853075, 49.71471093079176, 20.55945161574008, 36.81931961906866, 60.92653300876066]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.043659444412692, "mean_inference_ms": 7.779886229066057, "mean_action_processing_ms": 1.2670955937196238, "mean_env_wait_ms": 1.0794697756771603, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0398293137550354, "StateBufferConnector_ms": 0.019667049249013264, "ViewRequirementAgentConnector_ms": 0.6120238039228652}, "num_episodes": 18, "episode_return_max": 366.06857964991934, "episode_return_min": -2.983959188548498, "episode_return_mean": 159.2860032847447, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 167.26662506107914, "num_env_steps_trained_throughput_per_sec": 167.26662506107914, "timesteps_total": 16000, "num_env_steps_sampled_lifetime": 16000, "num_agent_steps_sampled_lifetime": 64000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 64000, "timers": {"training_iteration_time_ms": 27805.841, "restore_workers_time_ms": 0.058, "training_step_time_ms": 27805.707, "sample_time_ms": 6397.318, "learn_time_ms": 21346.11, "learn_throughput": 187.388, "synch_weights_time_ms": 59.712}, "counters": {"num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "done": false, "training_iteration": 4, "trial_id": "d163c_00000", "date": "2024-08-16_12-51-30", "timestamp": 1723792890, "time_this_iter_s": 23.920058965682983, "time_total_s": 111.27981209754944, "pid": 81201, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16b815a60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 111.27981209754944, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 36.017647058823535, "ram_util_percent": 74.28235294117648}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.9212432068491738, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.892407973355087, "policy_loss": -0.010755460627411527, "vf_loss": 7.900320008696703, "vf_explained_var": 0.03791985719922989, "kl": 0.014217073587389446, "entropy": 1.561050239631108, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 8505.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.88581223487854, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.0138572455714, "policy_loss": -0.0029772391763303882, "vf_loss": 9.015607663815615, "vf_explained_var": 0.007982104228287146, "kl": 0.006134131052712023, "entropy": 1.5554011544222555, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 8505.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "env_runners": {"episode_reward_max": 366.06857964991934, "episode_reward_min": -2.983959188548498, "episode_reward_mean": 142.53333164384674, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 19800, "policy_reward_min": {"prey_policy": -233.67712016981162, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 192.08000000000004, "predator_policy": 268.34736926003666}, "policy_reward_mean": {"prey_policy": 27.271487590699635, "predator_policy": 43.99517823122375}, "custom_metrics": {}, "hist_stats": {"episode_reward": [6.6464158583550965, -2.491213482754997, 149.75604195055888, 17.910000000000224, -2.983959188548498, 30.647496578504875, 138.88740604715525, 66.92832223644113, 2.0100000000000002, 86.99210422435353, 7.0576325676794305, 6.653304131223338, 8.622893639961035, 129.09123038230933, 33.373002232286325, 65.1450149913892, 143.926081203783, 5.342783900604354, 172.9039033383758, 76.32448815182971, 87.49838808523617, 292.80200470651766, 76.16287770260513, 193.85999999999945, 81.87918938216806, 97.41110534242246, 277.8048386363691, 177.9247689296103, 167.2065480882389, 122.73998456577245, 170.27227976009877, 272.58000000000015, 176.72166970934364, 104.10443583801568, 127.62145731966021, 162.02918206128868, 146.00784692678215, 162.58670697991255, 285.5829762711612, 267.9728918429729, 180.87861987844565, 272.34168854705143, 160.95437416676975, 366.06857964991934, 197.46004914543266, 252.32775040756684, 103.93000000000018, 314.27, 275.9506835998921, 209.15415415028215, 189.0391147847325, 293.5978317722049, 104.6480408916625, 193.54999999999995, 313.99732560871615, 82.3737958141965, 292.9180344114149, 278.0913393215624, 134.18317628891995, 148.9266782329197, 182.79131396524525, 227.05510161699104, 346.3227705597111, 98.7027472191676, 223.66608806714535, 267.0148427306772, 221.41468643048773, 127.5772690669252, 204.64955054152878, 101.8904110179065, 247.08, 262.25411770246086, 45.712652569560284, 58.834073631395746, -1.8320856423872431, 175.2683581771854, -0.8195020789212758, -1.8081627801817621, 166.99071404812622, 59.67125824262954, 76.82948042988154, 174.18888011454564, 87.27072324149846, 71.15865750141634, 240.20340408556672, 138.5123207308659, 102.14809349554328, 89.83335364178404, 54.01511787314227, 41.397865609185715, 216.56407781114706, 79.95562859336859, 52.192666600231334, 227.9324704580984, 36.59734642298447, 203.79331143374358, 152.83452129224338, 34.10718752439209, 60.65518321216435], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-9.435218371388688, -5.292551719540984, -36.73574180469024, -18.80412376924984, 127.22053780379298, -47.13816302918068, -102.49165396716678, -25.518175724543823, -32.663159299733, -40.33069276307399, -1.7610091628405096, -34.00947900430485, 57.64132691242457, 10.4099006987609, -17.660973272357495, 27.74000000000015, -66.6560479349119, -33.18613709676584, 48.940266654958094, -1.6755001783690566, -46.7236706296504, -3.3473639592382685, -14.40170278416673, 1.7900000000000016, -11.062418809167797, -90.16515490012259, 109.21009581683069, -80.75185268785955, -9.768356667014586, -79.2921041685323, 56.4263856048799, -8.683343257158878, 77.056858481836, -25.315681696773385, -27.995212461797337, -24.231643726439415, 123.91125137128503, -123.98447667160579, 4.239620878560724, 46.30075933959806, 22.33190869947577, -1.2786089639759706, 91.30275343780883, 164.9446162891034, -45.52634437935254, 54.6928322803745, 167.40556346779692, -22.25954222101657, 6.949999999999978, 68.97766301070264, -29.603745649890115, 63.13932629133531, 170.29999999999973, 82.17865669586664, 31.030952322271105, 80.61677265358105, 16.670806104155744, 32.68587222427432, 9.398313671753048, 81.04333985347931, 68.77377091691565, 65.3728565068583, 78.01136923307931, 176.2470038373904, 128.29231269610875, 7.6647985871273825, 69.88851514445686, -43.99008356791783, -24.458470133063173, 102.79897861956997, 63.91666254271991, 82.64523596284127, 98.23103064884818, -104.64524099815063, -8.930365536233154, 98.4295386049811, 159.62247631623967, 79.75399446152817, 148.46220207203314, 32.53487889188246, 24.75567166431678, 104.72443363459591, 77.2417573631765, 165.00800402925555, -5.255049209757001, 109.65393156970953, 192.08000000000004, 142.7218891493332, 53.79979308361593, 116.79898893532948, 55.18368170863959, 142.87033362046594, 88.35468830517948, -15.713782193495069, 127.51983470480283, 168.50135260398162, 95.37983849069059, 112.9879158091353, -15.545132297538089, 147.5704155550106, 18.823446756867863, 102.63268938669354, 151.60903025615164, 113.97301917582996, 59.14042238239744, -32.570164976271045, 75.28476023900686, 65.9695118729914, 186.99176643123025, 84.91846866046653, 23.44998977678195, -46.108199992273946, 140.66749925344828, 139.55173190570935, 118.2236705961473, 128.0180983135607, -73.42853207864356, 100.96267488678512, 50.34779003509462, 54.12718513283024, 36.78035788593154, 22.923886401975242, 72.04003981343229, 94.80697740629672, 131.83496817597734, 185.19201652726736, -0.2925095676102072, -46.885775516504246, 68.91848907235074, 83.72170680742323, 126.82249385301888, 115.50858603984679, 72.17102901764336, 100.86036133986825, -11.14004795589213, 35.38142352196645, 139.6780098853608, -6.081383163308758, 36.682789432651695, -59.90695591977523, 67.29528906920825, 109.51054838425992, 141.4025048106237, 23.105760264007834, -54.12215732754596, -18.82571766703697, -41.30402056042042, -111.20173177916065, -131.8231466747388, -133.23464223720512, 62.07402610304553, 30.758802508234236, -94.79353913645294, -135.35565521181968, -88.76184826179096, -80.96138938284177, 14.386996549416208, 76.47155093812194, -13.612889392198305, -122.35302705753213, -0.16202308037781396, -20.516482865840654, 56.265971146608855, 26.053095065096745, 37.195155658502834, -24.665784931642825, -150.21614467396998, -32.99839124318969, 116.50908005200912, 95.15808734307858, 43.34370167547634, -10.290502210750736, -69.58329921587037, -47.17620989814615, -36.60275394223992, 32.93547783966996, -95.9665350094167, -73.52550251366065, -66.31601004713696, 2.4660072556275656, 59.05631471992825, 82.64356209073617, -27.935095105653993, -121.79521137494184, -41.768568345570195, -14.102082680059027, 105.36897326623873, 19.193010178396545, -40.31886248510505, -90.5506245426412, 68.87705947235968, 86.39977291397037, 111.61242778910831, -53.17012207694648, -163.76094217264227, -233.67712016981162, -90.75886958007575, -81.78961152017801], "policy_predator_policy_reward": [8.318967577896112, 13.055218371388653, 2.9492998563846142, 50.09935223480051, 0.6555041467658698, 69.01816302918053, 103.29165396716701, 42.62817572454401, 25.795715374277993, 44.21417749998048, 31.288606439006283, 35.12937830664348, 34.460880686411414, 36.37529774955811, 46.4243730623202, 10.424922446478513, 67.7360479349124, 34.1161370967658, 3.9275377201745116, 35.79980002758989, 36.43839403609908, 20.690273120469055, 13.78757419782323, 5.477432717566881, 90.15742979176657, 19.69303755748478, 21.143726429579853, 79.48926082375878, 113.18433267872244, 9.249130389110528, 8.532015825386688, 8.869956818281196, 34.74431910129788, 57.440585317424045, 40.36452009161869, 17.205119997222795, 92.48703943949876, 80.49008919919815, 20.96699588785932, 4.817112045811481, 2.531106139590157, 63.913982210146074, 21.43268238998254, 15.121952589622659, 50.35534797580398, 16.64104182577901, 7.868766626678848, 40.84521212654087, 2.5587838445225186, 3.392742526942351, 24.799892243277363, 39.075632457699726, 13.242307441820426, 12.083874498682308, 44.275217897226135, 22.00182605653248, 100.44536716722683, 17.404502592582215, 12.956333726120498, 19.341997314419242, 20.55850776248104, 15.567144573843759, 13.56863076692068, 4.752996162609612, 30.54655265678981, 10.218005769317733, 35.67325837625089, 42.53274588522539, 18.018791332578715, 31.262157500574833, 13.12024369766499, 2.3470398580628693, 22.9375908927458, 129.4844663833387, 14.197631863804531, 58.889902047359904, 33.2506950683375, 12.955810425056196, 31.142228367861406, 55.83358251119594, 8.09087682037657, 43.307637759156464, 16.303585524662186, 13.788341629957579, 31.386473013365894, 25.169018793451308, 2.110409736585363, 29.156280764000858, 25.675688901644747, 1.1855782248425468, 5.857992276514507, 48.41574280194676, 14.045311694820512, 17.243782193495097, 0.0, 18.248812691215537, 16.966049365249418, 50.616879934816744, 75.19474122556169, 1.934129667247974, 48.318100162186894, 19.26487847898424, 20.30411589638796, 7.711666443835353, 62.56069015011117, 15.517093335424649, 28.380488127008565, 23.915239760993153, 21.71643261221924, 20.37065790480024, 7.410566830354747, 97.6214391993338, 0.7593927096411699, 11.939410542615988, 21.31718023871327, 10.53239017314095, 29.51696054631988, 77.13207293445879, 22.46875583522438, 21.982947229770563, 2.668536548929236, 120.41853312840914, 29.48619831424603, 30.721886083015995, 7.843542813704967, 21.452243042761516, 83.77191382321256, 62.109118480069455, 36.388665051833485, 34.63722713553792, 7.001693812909098, 17.682069024902276, 1.5138959871619635, 46.86940008581415, 54.570845964802906, 48.765047536047824, 45.665943007161445, 25.386980812315382, 34.1869172864994, 90.92766021853075, 49.71471093079176, 20.55945161574008, 36.81931961906866, 60.92653300876066, 59.89289400233491, 58.76763356180835, 191.7259117110954, 19.613914259881433, 117.61358168791358, 145.61212158164307, 60.45240268481196, 21.983126881093806, 110.63971566905094, 118.68997660030044, 82.06768678034098, 85.8473880841099, 28.66053086280806, 47.47163569777992, 85.79023772285002, 109.84693696950993, 70.6501174035976, 26.857868972502505, 14.93199294577385, 76.93782095706618, 36.809954967564934, 37.93139754707346, 109.56637966274806, 144.8068137558277, 23.862911238543845, 4.673325451935331, 84.27471325633655, 21.184408009803807, 121.10955373878036, 97.79804887077948, 23.413711750581907, 70.08691799377212, 118.7501071030953, 104.75704829312456, 16.792510071514798, 88.45535832918026, 67.37025662794457, 7.493944372538317, 93.76297366214618, 135.9229614118182, 40.525046097645465, 67.53827152821519, 14.682489434869721, 88.68799757859338, 76.90997711197909, 90.55685633875171, 10.223673839442592, 38.29280520797112, 44.62533976525213, 49.76687581482907, 268.34736926003666, 163.19788060680926, 64.61309931488985, 168.59056499752833]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.095681076191475, "mean_inference_ms": 7.943221638066086, "mean_action_processing_ms": 1.2901919852278272, "mean_env_wait_ms": 1.0915014590812184, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04013487786957712, "StateBufferConnector_ms": 0.03130544315684925, "ViewRequirementAgentConnector_ms": 0.6242688256080704}, "num_episodes": 27, "episode_return_max": 366.06857964991934, "episode_return_min": -2.983959188548498, "episode_return_mean": 142.53333164384674, "episodes_this_iter": 27}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 136.6483534818439, "num_env_steps_trained_throughput_per_sec": 136.6483534818439, "timesteps_total": 20000, "num_env_steps_sampled_lifetime": 20000, "num_agent_steps_sampled_lifetime": 80000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 80000, "timers": {"training_iteration_time_ms": 28099.118, "restore_workers_time_ms": 0.051, "training_step_time_ms": 28099.0, "sample_time_ms": 6487.85, "learn_time_ms": 21557.317, "learn_throughput": 185.552, "synch_weights_time_ms": 51.59}, "counters": {"num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "done": false, "training_iteration": 5, "trial_id": "d163c_00000", "date": "2024-08-16_12-51-59", "timestamp": 1723792919, "time_this_iter_s": 29.27700924873352, "time_total_s": 140.55682134628296, "pid": 81201, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16aff7160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 140.55682134628296, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 41.50487804878048, "ram_util_percent": 65.62926829268292}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.9791325037756924, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.572303924611006, "policy_loss": -0.00440849856788874, "vf_loss": 8.575002388727098, "vf_explained_var": 0.006745293499931457, "kl": 0.008550169444765778, "entropy": 1.5459855904654851, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 10395.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.0879373611911896, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.14109085022457, "policy_loss": -0.011480873928124469, "vf_loss": 9.149487519642664, "vf_explained_var": 0.022730306563553987, "kl": 0.015420935112064056, "entropy": 1.5712610828182685, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 10395.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "env_runners": {"episode_reward_max": 366.06857964991934, "episode_reward_min": -1.8320856423872431, "episode_reward_mean": 147.0414359162522, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -233.67712016981162, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 192.08000000000004, "predator_policy": 268.34736926003666}, "policy_reward_mean": {"prey_policy": 18.008637474263637, "predator_policy": 55.51208048386246}, "custom_metrics": {}, "hist_stats": {"episode_reward": [5.342783900604354, 172.9039033383758, 76.32448815182971, 87.49838808523617, 292.80200470651766, 76.16287770260513, 193.85999999999945, 81.87918938216806, 97.41110534242246, 277.8048386363691, 177.9247689296103, 167.2065480882389, 122.73998456577245, 170.27227976009877, 272.58000000000015, 176.72166970934364, 104.10443583801568, 127.62145731966021, 162.02918206128868, 146.00784692678215, 162.58670697991255, 285.5829762711612, 267.9728918429729, 180.87861987844565, 272.34168854705143, 160.95437416676975, 366.06857964991934, 197.46004914543266, 252.32775040756684, 103.93000000000018, 314.27, 275.9506835998921, 209.15415415028215, 189.0391147847325, 293.5978317722049, 104.6480408916625, 193.54999999999995, 313.99732560871615, 82.3737958141965, 292.9180344114149, 278.0913393215624, 134.18317628891995, 148.9266782329197, 182.79131396524525, 227.05510161699104, 346.3227705597111, 98.7027472191676, 223.66608806714535, 267.0148427306772, 221.41468643048773, 127.5772690669252, 204.64955054152878, 101.8904110179065, 247.08, 262.25411770246086, 45.712652569560284, 58.834073631395746, -1.8320856423872431, 175.2683581771854, -0.8195020789212758, -1.8081627801817621, 166.99071404812622, 59.67125824262954, 76.82948042988154, 174.18888011454564, 87.27072324149846, 71.15865750141634, 240.20340408556672, 138.5123207308659, 102.14809349554328, 89.83335364178404, 54.01511787314227, 41.397865609185715, 216.56407781114706, 79.95562859336859, 52.192666600231334, 227.9324704580984, 36.59734642298447, 203.79331143374358, 152.83452129224338, 34.10718752439209, 60.65518321216435, 13.614241886854213, 95.55676382902661, 114.57164727159585, 56.182147434231446, 62.39310548094526, 76.10133476461019, 59.73705215654936, 149.76487451696798, 103.68106379764245, 129.36385138033828, 31.48521601864673, 134.8006005656791, 49.42272262547815, 98.69941068659821, 42.12265649731054, 185.13714291774414, 52.80175713448232, 26.07994329238659], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-27.995212461797337, -24.231643726439415, 123.91125137128503, -123.98447667160579, 4.239620878560724, 46.30075933959806, 22.33190869947577, -1.2786089639759706, 91.30275343780883, 164.9446162891034, -45.52634437935254, 54.6928322803745, 167.40556346779692, -22.25954222101657, 6.949999999999978, 68.97766301070264, -29.603745649890115, 63.13932629133531, 170.29999999999973, 82.17865669586664, 31.030952322271105, 80.61677265358105, 16.670806104155744, 32.68587222427432, 9.398313671753048, 81.04333985347931, 68.77377091691565, 65.3728565068583, 78.01136923307931, 176.2470038373904, 128.29231269610875, 7.6647985871273825, 69.88851514445686, -43.99008356791783, -24.458470133063173, 102.79897861956997, 63.91666254271991, 82.64523596284127, 98.23103064884818, -104.64524099815063, -8.930365536233154, 98.4295386049811, 159.62247631623967, 79.75399446152817, 148.46220207203314, 32.53487889188246, 24.75567166431678, 104.72443363459591, 77.2417573631765, 165.00800402925555, -5.255049209757001, 109.65393156970953, 192.08000000000004, 142.7218891493332, 53.79979308361593, 116.79898893532948, 55.18368170863959, 142.87033362046594, 88.35468830517948, -15.713782193495069, 127.51983470480283, 168.50135260398162, 95.37983849069059, 112.9879158091353, -15.545132297538089, 147.5704155550106, 18.823446756867863, 102.63268938669354, 151.60903025615164, 113.97301917582996, 59.14042238239744, -32.570164976271045, 75.28476023900686, 65.9695118729914, 186.99176643123025, 84.91846866046653, 23.44998977678195, -46.108199992273946, 140.66749925344828, 139.55173190570935, 118.2236705961473, 128.0180983135607, -73.42853207864356, 100.96267488678512, 50.34779003509462, 54.12718513283024, 36.78035788593154, 22.923886401975242, 72.04003981343229, 94.80697740629672, 131.83496817597734, 185.19201652726736, -0.2925095676102072, -46.885775516504246, 68.91848907235074, 83.72170680742323, 126.82249385301888, 115.50858603984679, 72.17102901764336, 100.86036133986825, -11.14004795589213, 35.38142352196645, 139.6780098853608, -6.081383163308758, 36.682789432651695, -59.90695591977523, 67.29528906920825, 109.51054838425992, 141.4025048106237, 23.105760264007834, -54.12215732754596, -18.82571766703697, -41.30402056042042, -111.20173177916065, -131.8231466747388, -133.23464223720512, 62.07402610304553, 30.758802508234236, -94.79353913645294, -135.35565521181968, -88.76184826179096, -80.96138938284177, 14.386996549416208, 76.47155093812194, -13.612889392198305, -122.35302705753213, -0.16202308037781396, -20.516482865840654, 56.265971146608855, 26.053095065096745, 37.195155658502834, -24.665784931642825, -150.21614467396998, -32.99839124318969, 116.50908005200912, 95.15808734307858, 43.34370167547634, -10.290502210750736, -69.58329921587037, -47.17620989814615, -36.60275394223992, 32.93547783966996, -95.9665350094167, -73.52550251366065, -66.31601004713696, 2.4660072556275656, 59.05631471992825, 82.64356209073617, -27.935095105653993, -121.79521137494184, -41.768568345570195, -14.102082680059027, 105.36897326623873, 19.193010178396545, -40.31886248510505, -90.5506245426412, 68.87705947235968, 86.39977291397037, 111.61242778910831, -53.17012207694648, -163.76094217264227, -233.67712016981162, -90.75886958007575, -81.78961152017801, -90.89953258666806, -131.0931765807004, -94.9457846892016, -51.981995706071025, -45.056943757107476, 4.600491204887753, -60.72364697962941, -33.697866852679695, -113.72703204435817, -0.6007273482513997, -8.412010148263692, -78.5159811627724, -58.368992748286516, -148.76346501016718, -8.4896050204922, 25.0059750693068, -61.25472457423789, 15.530428893374221, 31.32562422856198, -71.93842792386603, -85.75517652378088, -146.09581381454356, -117.99331641880313, 47.689013678444915, -96.87007110720108, -47.93833142600691, -101.54293690148121, 23.729566687358204, -23.65897700541834, -119.88673649395534, 62.07933960199722, 10.374333268516432, -159.97965578730538, -103.72928599631972, -210.58773914096443, -72.28877167403483], "policy_predator_policy_reward": [40.36452009161869, 17.205119997222795, 92.48703943949876, 80.49008919919815, 20.96699588785932, 4.817112045811481, 2.531106139590157, 63.913982210146074, 21.43268238998254, 15.121952589622659, 50.35534797580398, 16.64104182577901, 7.868766626678848, 40.84521212654087, 2.5587838445225186, 3.392742526942351, 24.799892243277363, 39.075632457699726, 13.242307441820426, 12.083874498682308, 44.275217897226135, 22.00182605653248, 100.44536716722683, 17.404502592582215, 12.956333726120498, 19.341997314419242, 20.55850776248104, 15.567144573843759, 13.56863076692068, 4.752996162609612, 30.54655265678981, 10.218005769317733, 35.67325837625089, 42.53274588522539, 18.018791332578715, 31.262157500574833, 13.12024369766499, 2.3470398580628693, 22.9375908927458, 129.4844663833387, 14.197631863804531, 58.889902047359904, 33.2506950683375, 12.955810425056196, 31.142228367861406, 55.83358251119594, 8.09087682037657, 43.307637759156464, 16.303585524662186, 13.788341629957579, 31.386473013365894, 25.169018793451308, 2.110409736585363, 29.156280764000858, 25.675688901644747, 1.1855782248425468, 5.857992276514507, 48.41574280194676, 14.045311694820512, 17.243782193495097, 0.0, 18.248812691215537, 16.966049365249418, 50.616879934816744, 75.19474122556169, 1.934129667247974, 48.318100162186894, 19.26487847898424, 20.30411589638796, 7.711666443835353, 62.56069015011117, 15.517093335424649, 28.380488127008565, 23.915239760993153, 21.71643261221924, 20.37065790480024, 7.410566830354747, 97.6214391993338, 0.7593927096411699, 11.939410542615988, 21.31718023871327, 10.53239017314095, 29.51696054631988, 77.13207293445879, 22.46875583522438, 21.982947229770563, 2.668536548929236, 120.41853312840914, 29.48619831424603, 30.721886083015995, 7.843542813704967, 21.452243042761516, 83.77191382321256, 62.109118480069455, 36.388665051833485, 34.63722713553792, 7.001693812909098, 17.682069024902276, 1.5138959871619635, 46.86940008581415, 54.570845964802906, 48.765047536047824, 45.665943007161445, 25.386980812315382, 34.1869172864994, 90.92766021853075, 49.71471093079176, 20.55945161574008, 36.81931961906866, 60.92653300876066, 59.89289400233491, 58.76763356180835, 191.7259117110954, 19.613914259881433, 117.61358168791358, 145.61212158164307, 60.45240268481196, 21.983126881093806, 110.63971566905094, 118.68997660030044, 82.06768678034098, 85.8473880841099, 28.66053086280806, 47.47163569777992, 85.79023772285002, 109.84693696950993, 70.6501174035976, 26.857868972502505, 14.93199294577385, 76.93782095706618, 36.809954967564934, 37.93139754707346, 109.56637966274806, 144.8068137558277, 23.862911238543845, 4.673325451935331, 84.27471325633655, 21.184408009803807, 121.10955373878036, 97.79804887077948, 23.413711750581907, 70.08691799377212, 118.7501071030953, 104.75704829312456, 16.792510071514798, 88.45535832918026, 67.37025662794457, 7.493944372538317, 93.76297366214618, 135.9229614118182, 40.525046097645465, 67.53827152821519, 14.682489434869721, 88.68799757859338, 76.90997711197909, 90.55685633875171, 10.223673839442592, 38.29280520797112, 44.62533976525213, 49.76687581482907, 268.34736926003666, 163.19788060680926, 64.61309931488985, 168.59056499752833, 113.4762792596094, 122.13067179461328, 137.77420531334764, 104.71033891095166, 66.78598027471915, 88.24211954909629, 107.55039972431982, 43.05326154222071, 125.84055007189792, 50.880314801656844, 72.77277184027537, 90.25655423537081, 92.29847586177036, 174.57103405323264, 79.30330190406838, 53.9452025640849, 80.2207326031968, 69.18462687530933, 93.27410740565897, 76.70254766998318, 158.8240737834159, 104.51213257355526, 135.98214302539293, 69.1227602806444, 72.93446347467317, 121.29666168401288, 80.77068971108054, 95.74209118964066, 96.53014131868099, 89.13822867800317, 87.64066701271413, 25.0428030345165, 139.65692525154537, 176.85377366656203, 236.63880809963166, 72.3176460077544]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.2336228034132803, "mean_inference_ms": 8.38134353833294, "mean_action_processing_ms": 1.357353503127511, "mean_env_wait_ms": 1.1424251272386912, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.041506409645080566, "StateBufferConnector_ms": 0.03398144245147705, "ViewRequirementAgentConnector_ms": 0.6792151927947998}, "num_episodes": 18, "episode_return_max": 366.06857964991934, "episode_return_min": -1.8320856423872431, "episode_return_mean": 147.0414359162522, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 102.95646448333981, "num_env_steps_trained_throughput_per_sec": 102.95646448333981, "timesteps_total": 24000, "num_env_steps_sampled_lifetime": 24000, "num_agent_steps_sampled_lifetime": 96000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 96000, "timers": {"training_iteration_time_ms": 29891.162, "restore_workers_time_ms": 0.045, "training_step_time_ms": 29891.056, "sample_time_ms": 6767.053, "learn_time_ms": 23075.669, "learn_throughput": 173.343, "synch_weights_time_ms": 46.316}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "done": false, "training_iteration": 6, "trial_id": "d163c_00000", "date": "2024-08-16_12-52-38", "timestamp": 1723792958, "time_this_iter_s": 38.85684299468994, "time_total_s": 179.4136643409729, "pid": 81201, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16af90dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 179.4136643409729, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 49.635714285714286, "ram_util_percent": 66.31071428571428}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.811278041109206, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.945029172190914, "policy_loss": -0.00205437109987966, "vf_loss": 6.944169035159722, "vf_explained_var": 0.002928356581894809, "kl": 0.014572538121257268, "entropy": 1.5535085790371768, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 12285.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.5840479267968073, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.196427995691854, "policy_loss": -0.016023885193785958, "vf_loss": 8.208745597405409, "vf_explained_var": 0.14496033182219853, "kl": 0.018531480850567158, "entropy": 1.5607102120994891, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 12285.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000}, "env_runners": {"episode_reward_max": 366.06857964991934, "episode_reward_min": -1.8320856423872431, "episode_reward_mean": 146.89075757255534, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -233.67712016981162, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 192.08000000000004, "predator_policy": 268.34736926003666}, "policy_reward_mean": {"prey_policy": 11.986625713687163, "predator_policy": 61.45875307259052}, "custom_metrics": {}, "hist_stats": {"episode_reward": [162.02918206128868, 146.00784692678215, 162.58670697991255, 285.5829762711612, 267.9728918429729, 180.87861987844565, 272.34168854705143, 160.95437416676975, 366.06857964991934, 197.46004914543266, 252.32775040756684, 103.93000000000018, 314.27, 275.9506835998921, 209.15415415028215, 189.0391147847325, 293.5978317722049, 104.6480408916625, 193.54999999999995, 313.99732560871615, 82.3737958141965, 292.9180344114149, 278.0913393215624, 134.18317628891995, 148.9266782329197, 182.79131396524525, 227.05510161699104, 346.3227705597111, 98.7027472191676, 223.66608806714535, 267.0148427306772, 221.41468643048773, 127.5772690669252, 204.64955054152878, 101.8904110179065, 247.08, 262.25411770246086, 45.712652569560284, 58.834073631395746, -1.8320856423872431, 175.2683581771854, -0.8195020789212758, -1.8081627801817621, 166.99071404812622, 59.67125824262954, 76.82948042988154, 174.18888011454564, 87.27072324149846, 71.15865750141634, 240.20340408556672, 138.5123207308659, 102.14809349554328, 89.83335364178404, 54.01511787314227, 41.397865609185715, 216.56407781114706, 79.95562859336859, 52.192666600231334, 227.9324704580984, 36.59734642298447, 203.79331143374358, 152.83452129224338, 34.10718752439209, 60.65518321216435, 13.614241886854213, 95.55676382902661, 114.57164727159585, 56.182147434231446, 62.39310548094526, 76.10133476461019, 59.73705215654936, 149.76487451696798, 103.68106379764245, 129.36385138033828, 31.48521601864673, 134.8006005656791, 49.42272262547815, 98.69941068659821, 42.12265649731054, 185.13714291774414, 52.80175713448232, 26.07994329238659, 73.22779793977836, 35.21638451200704, 57.357927957957294, 154.25107399466108, 152.79708850644425, 174.54823191243634, 166.17550713961725, 239.12563312260835, 168.57911358918687, 188.62416970036782, 135.32145467500877, 249.48753363641438, 234.8256009352209, 188.43343228482013, 134.82528714757052, 72.69392845845012, 62.325600546870405, 178.27712302776445], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [63.91666254271991, 82.64523596284127, 98.23103064884818, -104.64524099815063, -8.930365536233154, 98.4295386049811, 159.62247631623967, 79.75399446152817, 148.46220207203314, 32.53487889188246, 24.75567166431678, 104.72443363459591, 77.2417573631765, 165.00800402925555, -5.255049209757001, 109.65393156970953, 192.08000000000004, 142.7218891493332, 53.79979308361593, 116.79898893532948, 55.18368170863959, 142.87033362046594, 88.35468830517948, -15.713782193495069, 127.51983470480283, 168.50135260398162, 95.37983849069059, 112.9879158091353, -15.545132297538089, 147.5704155550106, 18.823446756867863, 102.63268938669354, 151.60903025615164, 113.97301917582996, 59.14042238239744, -32.570164976271045, 75.28476023900686, 65.9695118729914, 186.99176643123025, 84.91846866046653, 23.44998977678195, -46.108199992273946, 140.66749925344828, 139.55173190570935, 118.2236705961473, 128.0180983135607, -73.42853207864356, 100.96267488678512, 50.34779003509462, 54.12718513283024, 36.78035788593154, 22.923886401975242, 72.04003981343229, 94.80697740629672, 131.83496817597734, 185.19201652726736, -0.2925095676102072, -46.885775516504246, 68.91848907235074, 83.72170680742323, 126.82249385301888, 115.50858603984679, 72.17102901764336, 100.86036133986825, -11.14004795589213, 35.38142352196645, 139.6780098853608, -6.081383163308758, 36.682789432651695, -59.90695591977523, 67.29528906920825, 109.51054838425992, 141.4025048106237, 23.105760264007834, -54.12215732754596, -18.82571766703697, -41.30402056042042, -111.20173177916065, -131.8231466747388, -133.23464223720512, 62.07402610304553, 30.758802508234236, -94.79353913645294, -135.35565521181968, -88.76184826179096, -80.96138938284177, 14.386996549416208, 76.47155093812194, -13.612889392198305, -122.35302705753213, -0.16202308037781396, -20.516482865840654, 56.265971146608855, 26.053095065096745, 37.195155658502834, -24.665784931642825, -150.21614467396998, -32.99839124318969, 116.50908005200912, 95.15808734307858, 43.34370167547634, -10.290502210750736, -69.58329921587037, -47.17620989814615, -36.60275394223992, 32.93547783966996, -95.9665350094167, -73.52550251366065, -66.31601004713696, 2.4660072556275656, 59.05631471992825, 82.64356209073617, -27.935095105653993, -121.79521137494184, -41.768568345570195, -14.102082680059027, 105.36897326623873, 19.193010178396545, -40.31886248510505, -90.5506245426412, 68.87705947235968, 86.39977291397037, 111.61242778910831, -53.17012207694648, -163.76094217264227, -233.67712016981162, -90.75886958007575, -81.78961152017801, -90.89953258666806, -131.0931765807004, -94.9457846892016, -51.981995706071025, -45.056943757107476, 4.600491204887753, -60.72364697962941, -33.697866852679695, -113.72703204435817, -0.6007273482513997, -8.412010148263692, -78.5159811627724, -58.368992748286516, -148.76346501016718, -8.4896050204922, 25.0059750693068, -61.25472457423789, 15.530428893374221, 31.32562422856198, -71.93842792386603, -85.75517652378088, -146.09581381454356, -117.99331641880313, 47.689013678444915, -96.87007110720108, -47.93833142600691, -101.54293690148121, 23.729566687358204, -23.65897700541834, -119.88673649395534, 62.07933960199722, 10.374333268516432, -159.97965578730538, -103.72928599631972, -210.58773914096443, -72.28877167403483, -2.368389060964577, -3.983993282928015, -68.17171847345375, -122.64741868077078, -69.13178946366281, -34.76712585243909, -143.70598557890142, 99.06638471445106, -172.8863629509204, 107.12133937998941, 71.82173932244177, 89.75559933438747, 137.79076588561827, 13.696445615052097, 135.00654819422732, 37.942466631679096, 92.28771023808271, -4.227654315700393, 17.680005584468095, 51.48148597896345, -173.71004916670867, 77.12223929351524, 161.72206630783165, -42.08373789502647, -88.74328457135351, 160.6763907344173, 98.7290668099135, 43.18864705373125, 55.74320673049983, -94.21043945116932, -6.42779867635406, 23.61913171304544, -63.85902022170458, -0.5271168621781834, 15.060978691397414, 69.37980053309936], "policy_predator_policy_reward": [13.12024369766499, 2.3470398580628693, 22.9375908927458, 129.4844663833387, 14.197631863804531, 58.889902047359904, 33.2506950683375, 12.955810425056196, 31.142228367861406, 55.83358251119594, 8.09087682037657, 43.307637759156464, 16.303585524662186, 13.788341629957579, 31.386473013365894, 25.169018793451308, 2.110409736585363, 29.156280764000858, 25.675688901644747, 1.1855782248425468, 5.857992276514507, 48.41574280194676, 14.045311694820512, 17.243782193495097, 0.0, 18.248812691215537, 16.966049365249418, 50.616879934816744, 75.19474122556169, 1.934129667247974, 48.318100162186894, 19.26487847898424, 20.30411589638796, 7.711666443835353, 62.56069015011117, 15.517093335424649, 28.380488127008565, 23.915239760993153, 21.71643261221924, 20.37065790480024, 7.410566830354747, 97.6214391993338, 0.7593927096411699, 11.939410542615988, 21.31718023871327, 10.53239017314095, 29.51696054631988, 77.13207293445879, 22.46875583522438, 21.982947229770563, 2.668536548929236, 120.41853312840914, 29.48619831424603, 30.721886083015995, 7.843542813704967, 21.452243042761516, 83.77191382321256, 62.109118480069455, 36.388665051833485, 34.63722713553792, 7.001693812909098, 17.682069024902276, 1.5138959871619635, 46.86940008581415, 54.570845964802906, 48.765047536047824, 45.665943007161445, 25.386980812315382, 34.1869172864994, 90.92766021853075, 49.71471093079176, 20.55945161574008, 36.81931961906866, 60.92653300876066, 59.89289400233491, 58.76763356180835, 191.7259117110954, 19.613914259881433, 117.61358168791358, 145.61212158164307, 60.45240268481196, 21.983126881093806, 110.63971566905094, 118.68997660030044, 82.06768678034098, 85.8473880841099, 28.66053086280806, 47.47163569777992, 85.79023772285002, 109.84693696950993, 70.6501174035976, 26.857868972502505, 14.93199294577385, 76.93782095706618, 36.809954967564934, 37.93139754707346, 109.56637966274806, 144.8068137558277, 23.862911238543845, 4.673325451935331, 84.27471325633655, 21.184408009803807, 121.10955373878036, 97.79804887077948, 23.413711750581907, 70.08691799377212, 118.7501071030953, 104.75704829312456, 16.792510071514798, 88.45535832918026, 67.37025662794457, 7.493944372538317, 93.76297366214618, 135.9229614118182, 40.525046097645465, 67.53827152821519, 14.682489434869721, 88.68799757859338, 76.90997711197909, 90.55685633875171, 10.223673839442592, 38.29280520797112, 44.62533976525213, 49.76687581482907, 268.34736926003666, 163.19788060680926, 64.61309931488985, 168.59056499752833, 113.4762792596094, 122.13067179461328, 137.77420531334764, 104.71033891095166, 66.78598027471915, 88.24211954909629, 107.55039972431982, 43.05326154222071, 125.84055007189792, 50.880314801656844, 72.77277184027537, 90.25655423537081, 92.29847586177036, 174.57103405323264, 79.30330190406838, 53.9452025640849, 80.2207326031968, 69.18462687530933, 93.27410740565897, 76.70254766998318, 158.8240737834159, 104.51213257355526, 135.98214302539293, 69.1227602806444, 72.93446347467317, 121.29666168401288, 80.77068971108054, 95.74209118964066, 96.53014131868099, 89.13822867800317, 87.64066701271413, 25.0428030345165, 139.65692525154537, 176.85377366656203, 236.63880809963166, 72.3176460077544, 66.075792264987, 13.504388018683589, 136.07083062899753, 89.96469103723399, 129.0374843096204, 32.21935896443888, 109.92675465016585, 88.96392020894591, 140.47600170831967, 78.0861103690557, 12.302661343171293, 0.6682319124365603, 7.450894335081724, 7.237401303864901, 38.26831111636444, 27.908307180337843, 37.8638615883268, 42.655196078477886, 87.7134289538745, 31.749249183061966, 178.90291068910653, 53.00635385909569, 97.58384127269308, 32.26536395091607, 48.53650414051405, 114.35599063164337, 5.663039947798175, 40.852678473377054, 78.68739357275376, 94.60512629548651, 25.376397623126437, 30.12619779863218, 80.99907384613054, 45.71266378462271, 63.35758613831721, 30.478757664950166]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.2727409033435864, "mean_inference_ms": 8.57508639205014, "mean_action_processing_ms": 1.380811601182022, "mean_env_wait_ms": 1.153757898387662, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04106175899505615, "StateBufferConnector_ms": 0.03398942947387695, "ViewRequirementAgentConnector_ms": 0.6778112649917603}, "num_episodes": 18, "episode_return_max": 366.06857964991934, "episode_return_min": -1.8320856423872431, "episode_return_mean": 146.89075757255534, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 138.78394747768985, "num_env_steps_trained_throughput_per_sec": 138.78394747768985, "timesteps_total": 28000, "num_env_steps_sampled_lifetime": 28000, "num_agent_steps_sampled_lifetime": 112000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 112000, "timers": {"training_iteration_time_ms": 29738.394, "restore_workers_time_ms": 0.041, "training_step_time_ms": 29738.297, "sample_time_ms": 6965.606, "learn_time_ms": 22728.593, "learn_throughput": 175.99, "synch_weights_time_ms": 42.245}, "counters": {"num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000}, "done": false, "training_iteration": 7, "trial_id": "d163c_00000", "date": "2024-08-16_12-53-07", "timestamp": 1723792987, "time_this_iter_s": 28.828288078308105, "time_total_s": 208.241952419281, "pid": 81201, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16b860670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 208.241952419281, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 46.77, "ram_util_percent": 70.545}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.4851857389722554, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.046310353279114, "policy_loss": -0.009618385454329352, "vf_loss": 5.052668758296462, "vf_explained_var": 0.09595249251083092, "kl": 0.016299818437234295, "entropy": 1.55536753241978, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 14175.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.5964881560789843, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.99896489703466, "policy_loss": -0.01629368595498067, "vf_loss": 9.012109113622595, "vf_explained_var": 0.01624979433559236, "kl": 0.015747409945675982, "entropy": 1.539250728692958, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 14175.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000}, "env_runners": {"episode_reward_max": 346.3227705597111, "episode_reward_min": -1.8320856423872431, "episode_reward_mean": 139.24399075180693, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -233.67712016981162, "predator_policy": 0.6682319124365603}, "policy_reward_max": {"prey_policy": 186.99176643123025, "predator_policy": 268.34736926003666}, "policy_reward_mean": {"prey_policy": 7.273286507442285, "predator_policy": 62.34870886846117}, "custom_metrics": {}, "hist_stats": {"episode_reward": [193.54999999999995, 313.99732560871615, 82.3737958141965, 292.9180344114149, 278.0913393215624, 134.18317628891995, 148.9266782329197, 182.79131396524525, 227.05510161699104, 346.3227705597111, 98.7027472191676, 223.66608806714535, 267.0148427306772, 221.41468643048773, 127.5772690669252, 204.64955054152878, 101.8904110179065, 247.08, 262.25411770246086, 45.712652569560284, 58.834073631395746, -1.8320856423872431, 175.2683581771854, -0.8195020789212758, -1.8081627801817621, 166.99071404812622, 59.67125824262954, 76.82948042988154, 174.18888011454564, 87.27072324149846, 71.15865750141634, 240.20340408556672, 138.5123207308659, 102.14809349554328, 89.83335364178404, 54.01511787314227, 41.397865609185715, 216.56407781114706, 79.95562859336859, 52.192666600231334, 227.9324704580984, 36.59734642298447, 203.79331143374358, 152.83452129224338, 34.10718752439209, 60.65518321216435, 13.614241886854213, 95.55676382902661, 114.57164727159585, 56.182147434231446, 62.39310548094526, 76.10133476461019, 59.73705215654936, 149.76487451696798, 103.68106379764245, 129.36385138033828, 31.48521601864673, 134.8006005656791, 49.42272262547815, 98.69941068659821, 42.12265649731054, 185.13714291774414, 52.80175713448232, 26.07994329238659, 73.22779793977836, 35.21638451200704, 57.357927957957294, 154.25107399466108, 152.79708850644425, 174.54823191243634, 166.17550713961725, 239.12563312260835, 168.57911358918687, 188.62416970036782, 135.32145467500877, 249.48753363641438, 234.8256009352209, 188.43343228482013, 134.82528714757052, 72.69392845845012, 62.325600546870405, 178.27712302776445, 250.67033636274323, 205.4770084646234, 120.70042298861105, 228.4866935768813, 195.01637856223635, 150.23432003267368, 104.37560925520205, 243.1267112244898, 120.02130000453153, 199.3002561136577, 166.62956846626236, 273.3996462314408, 141.1451207488679, 132.28909046192445, 200.3645173678317, 165.41487021860502, 177.64391652229043, 105.82804239835977], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [75.28476023900686, 65.9695118729914, 186.99176643123025, 84.91846866046653, 23.44998977678195, -46.108199992273946, 140.66749925344828, 139.55173190570935, 118.2236705961473, 128.0180983135607, -73.42853207864356, 100.96267488678512, 50.34779003509462, 54.12718513283024, 36.78035788593154, 22.923886401975242, 72.04003981343229, 94.80697740629672, 131.83496817597734, 185.19201652726736, -0.2925095676102072, -46.885775516504246, 68.91848907235074, 83.72170680742323, 126.82249385301888, 115.50858603984679, 72.17102901764336, 100.86036133986825, -11.14004795589213, 35.38142352196645, 139.6780098853608, -6.081383163308758, 36.682789432651695, -59.90695591977523, 67.29528906920825, 109.51054838425992, 141.4025048106237, 23.105760264007834, -54.12215732754596, -18.82571766703697, -41.30402056042042, -111.20173177916065, -131.8231466747388, -133.23464223720512, 62.07402610304553, 30.758802508234236, -94.79353913645294, -135.35565521181968, -88.76184826179096, -80.96138938284177, 14.386996549416208, 76.47155093812194, -13.612889392198305, -122.35302705753213, -0.16202308037781396, -20.516482865840654, 56.265971146608855, 26.053095065096745, 37.195155658502834, -24.665784931642825, -150.21614467396998, -32.99839124318969, 116.50908005200912, 95.15808734307858, 43.34370167547634, -10.290502210750736, -69.58329921587037, -47.17620989814615, -36.60275394223992, 32.93547783966996, -95.9665350094167, -73.52550251366065, -66.31601004713696, 2.4660072556275656, 59.05631471992825, 82.64356209073617, -27.935095105653993, -121.79521137494184, -41.768568345570195, -14.102082680059027, 105.36897326623873, 19.193010178396545, -40.31886248510505, -90.5506245426412, 68.87705947235968, 86.39977291397037, 111.61242778910831, -53.17012207694648, -163.76094217264227, -233.67712016981162, -90.75886958007575, -81.78961152017801, -90.89953258666806, -131.0931765807004, -94.9457846892016, -51.981995706071025, -45.056943757107476, 4.600491204887753, -60.72364697962941, -33.697866852679695, -113.72703204435817, -0.6007273482513997, -8.412010148263692, -78.5159811627724, -58.368992748286516, -148.76346501016718, -8.4896050204922, 25.0059750693068, -61.25472457423789, 15.530428893374221, 31.32562422856198, -71.93842792386603, -85.75517652378088, -146.09581381454356, -117.99331641880313, 47.689013678444915, -96.87007110720108, -47.93833142600691, -101.54293690148121, 23.729566687358204, -23.65897700541834, -119.88673649395534, 62.07933960199722, 10.374333268516432, -159.97965578730538, -103.72928599631972, -210.58773914096443, -72.28877167403483, -2.368389060964577, -3.983993282928015, -68.17171847345375, -122.64741868077078, -69.13178946366281, -34.76712585243909, -143.70598557890142, 99.06638471445106, -172.8863629509204, 107.12133937998941, 71.82173932244177, 89.75559933438747, 137.79076588561827, 13.696445615052097, 135.00654819422732, 37.942466631679096, 92.28771023808271, -4.227654315700393, 17.680005584468095, 51.48148597896345, -173.71004916670867, 77.12223929351524, 161.72206630783165, -42.08373789502647, -88.74328457135351, 160.6763907344173, 98.7290668099135, 43.18864705373125, 55.74320673049983, -94.21043945116932, -6.42779867635406, 23.61913171304544, -63.85902022170458, -0.5271168621781834, 15.060978691397414, 69.37980053309936, 112.1579337637219, 94.07, 43.094680035751026, 111.54847551158777, 92.753268633154, 0.5341019237044257, 50.538310156067574, 131.71728633673473, 97.00258996099245, 64.54290522256687, -31.832856843087544, 74.2870855734538, -21.2187642184642, 29.267786180567967, 135.48173658975568, 13.56464713804911, -52.829909906171196, 24.141592229358928, 78.10967049119847, 63.06751417396268, 48.52999999999998, 74.44287992326505, 150.85388485877561, 86.87110381576551, 81.20000000000059, -16.276989409548783, 3.981570157836506, 34.875045866951986, 70.6095430504791, 112.48072127688468, 72.18524721524074, -40.30473632698494, 62.59250067825055, 74.8686808400766, 59.39571066867546, 23.296365657259603], "policy_predator_policy_reward": [28.380488127008565, 23.915239760993153, 21.71643261221924, 20.37065790480024, 7.410566830354747, 97.6214391993338, 0.7593927096411699, 11.939410542615988, 21.31718023871327, 10.53239017314095, 29.51696054631988, 77.13207293445879, 22.46875583522438, 21.982947229770563, 2.668536548929236, 120.41853312840914, 29.48619831424603, 30.721886083015995, 7.843542813704967, 21.452243042761516, 83.77191382321256, 62.109118480069455, 36.388665051833485, 34.63722713553792, 7.001693812909098, 17.682069024902276, 1.5138959871619635, 46.86940008581415, 54.570845964802906, 48.765047536047824, 45.665943007161445, 25.386980812315382, 34.1869172864994, 90.92766021853075, 49.71471093079176, 20.55945161574008, 36.81931961906866, 60.92653300876066, 59.89289400233491, 58.76763356180835, 191.7259117110954, 19.613914259881433, 117.61358168791358, 145.61212158164307, 60.45240268481196, 21.983126881093806, 110.63971566905094, 118.68997660030044, 82.06768678034098, 85.8473880841099, 28.66053086280806, 47.47163569777992, 85.79023772285002, 109.84693696950993, 70.6501174035976, 26.857868972502505, 14.93199294577385, 76.93782095706618, 36.809954967564934, 37.93139754707346, 109.56637966274806, 144.8068137558277, 23.862911238543845, 4.673325451935331, 84.27471325633655, 21.184408009803807, 121.10955373878036, 97.79804887077948, 23.413711750581907, 70.08691799377212, 118.7501071030953, 104.75704829312456, 16.792510071514798, 88.45535832918026, 67.37025662794457, 7.493944372538317, 93.76297366214618, 135.9229614118182, 40.525046097645465, 67.53827152821519, 14.682489434869721, 88.68799757859338, 76.90997711197909, 90.55685633875171, 10.223673839442592, 38.29280520797112, 44.62533976525213, 49.76687581482907, 268.34736926003666, 163.19788060680926, 64.61309931488985, 168.59056499752833, 113.4762792596094, 122.13067179461328, 137.77420531334764, 104.71033891095166, 66.78598027471915, 88.24211954909629, 107.55039972431982, 43.05326154222071, 125.84055007189792, 50.880314801656844, 72.77277184027537, 90.25655423537081, 92.29847586177036, 174.57103405323264, 79.30330190406838, 53.9452025640849, 80.2207326031968, 69.18462687530933, 93.27410740565897, 76.70254766998318, 158.8240737834159, 104.51213257355526, 135.98214302539293, 69.1227602806444, 72.93446347467317, 121.29666168401288, 80.77068971108054, 95.74209118964066, 96.53014131868099, 89.13822867800317, 87.64066701271413, 25.0428030345165, 139.65692525154537, 176.85377366656203, 236.63880809963166, 72.3176460077544, 66.075792264987, 13.504388018683589, 136.07083062899753, 89.96469103723399, 129.0374843096204, 32.21935896443888, 109.92675465016585, 88.96392020894591, 140.47600170831967, 78.0861103690557, 12.302661343171293, 0.6682319124365603, 7.450894335081724, 7.237401303864901, 38.26831111636444, 27.908307180337843, 37.8638615883268, 42.655196078477886, 87.7134289538745, 31.749249183061966, 178.90291068910653, 53.00635385909569, 97.58384127269308, 32.26536395091607, 48.53650414051405, 114.35599063164337, 5.663039947798175, 40.852678473377054, 78.68739357275376, 94.60512629548651, 25.376397623126437, 30.12619779863218, 80.99907384613054, 45.71266378462271, 63.35758613831721, 30.478757664950166, 7.548851218378486, 36.89355138064294, 13.838760439471159, 36.995092477813614, 9.269624230658708, 18.14342820109356, 18.94035499157825, 27.290742092500796, 13.556654642560288, 19.914228736117202, 83.76349501726288, 24.016596285044937, 37.92281038497696, 58.40377690812113, 29.67960241824101, 64.40072507844384, 64.5512520999942, 84.15836558134926, 34.882875332927064, 23.240196115569578, 19.0346909936939, 24.621997549303295, 19.91976049042742, 15.754897066472468, 33.11537808225156, 43.10673207616479, 62.84763095864432, 30.58484347849163, 6.216285729484269, 11.057967310983734, 26.870573568608673, 106.66378576174041, 9.810793491116097, 30.371941512846963, 5.735143387666929, 17.400822684757653]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.302337310069205, "mean_inference_ms": 8.686172838060834, "mean_action_processing_ms": 1.3972866380265896, "mean_env_wait_ms": 1.1573196664965906, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03804457187652588, "StateBufferConnector_ms": 0.036843299865722656, "ViewRequirementAgentConnector_ms": 0.753334641456604}, "num_episodes": 18, "episode_return_max": 346.3227705597111, "episode_return_min": -1.8320856423872431, "episode_return_mean": 139.24399075180693, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 166.09834051509407, "num_env_steps_trained_throughput_per_sec": 166.09834051509407, "timesteps_total": 32000, "num_env_steps_sampled_lifetime": 32000, "num_agent_steps_sampled_lifetime": 128000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 128000, "timers": {"training_iteration_time_ms": 29031.361, "restore_workers_time_ms": 0.038, "training_step_time_ms": 29031.27, "sample_time_ms": 6895.283, "learn_time_ms": 22093.885, "learn_throughput": 181.046, "synch_weights_time_ms": 40.284}, "counters": {"num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000}, "done": false, "training_iteration": 8, "trial_id": "d163c_00000", "date": "2024-08-16_12-53-31", "timestamp": 1723793011, "time_this_iter_s": 24.089026927947998, "time_total_s": 232.330979347229, "pid": 81201, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16af661f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 232.330979347229, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 36.93142857142857, "ram_util_percent": 71.08285714285715}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.5269616230770393, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.203632721825252, "policy_loss": -0.015020900704681124, "vf_loss": 5.214369242279618, "vf_explained_var": 0.16113475797668336, "kl": 0.021421947231032634, "entropy": 1.54342595382973, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 16065.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.9731087376516334, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.866612644296474, "policy_loss": -0.013337138061850239, "vf_loss": 8.876800874175219, "vf_explained_var": -0.0661266995170129, "kl": 0.015744377734796304, "entropy": 1.4963895064182382, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 16065.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "env_runners": {"episode_reward_max": 273.3996462314408, "episode_reward_min": -1.8081627801817621, "episode_reward_mean": 142.3292687072891, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -233.67712016981162, "predator_policy": 0.6682319124365603}, "policy_reward_max": {"prey_policy": 172.6798423710514, "predator_policy": 268.34736926003666}, "policy_reward_mean": {"prey_policy": 12.64199779808299, "predator_policy": 58.52263655556158}, "custom_metrics": {}, "hist_stats": {"episode_reward": [175.2683581771854, -0.8195020789212758, -1.8081627801817621, 166.99071404812622, 59.67125824262954, 76.82948042988154, 174.18888011454564, 87.27072324149846, 71.15865750141634, 240.20340408556672, 138.5123207308659, 102.14809349554328, 89.83335364178404, 54.01511787314227, 41.397865609185715, 216.56407781114706, 79.95562859336859, 52.192666600231334, 227.9324704580984, 36.59734642298447, 203.79331143374358, 152.83452129224338, 34.10718752439209, 60.65518321216435, 13.614241886854213, 95.55676382902661, 114.57164727159585, 56.182147434231446, 62.39310548094526, 76.10133476461019, 59.73705215654936, 149.76487451696798, 103.68106379764245, 129.36385138033828, 31.48521601864673, 134.8006005656791, 49.42272262547815, 98.69941068659821, 42.12265649731054, 185.13714291774414, 52.80175713448232, 26.07994329238659, 73.22779793977836, 35.21638451200704, 57.357927957957294, 154.25107399466108, 152.79708850644425, 174.54823191243634, 166.17550713961725, 239.12563312260835, 168.57911358918687, 188.62416970036782, 135.32145467500877, 249.48753363641438, 234.8256009352209, 188.43343228482013, 134.82528714757052, 72.69392845845012, 62.325600546870405, 178.27712302776445, 250.67033636274323, 205.4770084646234, 120.70042298861105, 228.4866935768813, 195.01637856223635, 150.23432003267368, 104.37560925520205, 243.1267112244898, 120.02130000453153, 199.3002561136577, 166.62956846626236, 273.3996462314408, 141.1451207488679, 132.28909046192445, 200.3645173678317, 165.41487021860502, 177.64391652229043, 105.82804239835977, 247.46716424447578, 179.31140486817864, 215.87358904048574, 198.57467917857323, 204.53231296579094, 129.85361590419197, 218.35051901128577, 239.2038395037363, 62.36366470597117, 154.25396016029444, 226.47537552030118, 234.61256618950583, 193.30224268602444, 210.22894031030924, 216.30279324506947, 237.60673047927725, 256.5894653874567, 135.43807588515722, 196.84727275650562, 143.65879550944496, 220.57282658252268, 244.28185056820556], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [62.07402610304553, 30.758802508234236, -94.79353913645294, -135.35565521181968, -88.76184826179096, -80.96138938284177, 14.386996549416208, 76.47155093812194, -13.612889392198305, -122.35302705753213, -0.16202308037781396, -20.516482865840654, 56.265971146608855, 26.053095065096745, 37.195155658502834, -24.665784931642825, -150.21614467396998, -32.99839124318969, 116.50908005200912, 95.15808734307858, 43.34370167547634, -10.290502210750736, -69.58329921587037, -47.17620989814615, -36.60275394223992, 32.93547783966996, -95.9665350094167, -73.52550251366065, -66.31601004713696, 2.4660072556275656, 59.05631471992825, 82.64356209073617, -27.935095105653993, -121.79521137494184, -41.768568345570195, -14.102082680059027, 105.36897326623873, 19.193010178396545, -40.31886248510505, -90.5506245426412, 68.87705947235968, 86.39977291397037, 111.61242778910831, -53.17012207694648, -163.76094217264227, -233.67712016981162, -90.75886958007575, -81.78961152017801, -90.89953258666806, -131.0931765807004, -94.9457846892016, -51.981995706071025, -45.056943757107476, 4.600491204887753, -60.72364697962941, -33.697866852679695, -113.72703204435817, -0.6007273482513997, -8.412010148263692, -78.5159811627724, -58.368992748286516, -148.76346501016718, -8.4896050204922, 25.0059750693068, -61.25472457423789, 15.530428893374221, 31.32562422856198, -71.93842792386603, -85.75517652378088, -146.09581381454356, -117.99331641880313, 47.689013678444915, -96.87007110720108, -47.93833142600691, -101.54293690148121, 23.729566687358204, -23.65897700541834, -119.88673649395534, 62.07933960199722, 10.374333268516432, -159.97965578730538, -103.72928599631972, -210.58773914096443, -72.28877167403483, -2.368389060964577, -3.983993282928015, -68.17171847345375, -122.64741868077078, -69.13178946366281, -34.76712585243909, -143.70598557890142, 99.06638471445106, -172.8863629509204, 107.12133937998941, 71.82173932244177, 89.75559933438747, 137.79076588561827, 13.696445615052097, 135.00654819422732, 37.942466631679096, 92.28771023808271, -4.227654315700393, 17.680005584468095, 51.48148597896345, -173.71004916670867, 77.12223929351524, 161.72206630783165, -42.08373789502647, -88.74328457135351, 160.6763907344173, 98.7290668099135, 43.18864705373125, 55.74320673049983, -94.21043945116932, -6.42779867635406, 23.61913171304544, -63.85902022170458, -0.5271168621781834, 15.060978691397414, 69.37980053309936, 112.1579337637219, 94.07, 43.094680035751026, 111.54847551158777, 92.753268633154, 0.5341019237044257, 50.538310156067574, 131.71728633673473, 97.00258996099245, 64.54290522256687, -31.832856843087544, 74.2870855734538, -21.2187642184642, 29.267786180567967, 135.48173658975568, 13.56464713804911, -52.829909906171196, 24.141592229358928, 78.10967049119847, 63.06751417396268, 48.52999999999998, 74.44287992326505, 150.85388485877561, 86.87110381576551, 81.20000000000059, -16.276989409548783, 3.981570157836506, 34.875045866951986, 70.6095430504791, 112.48072127688468, 72.18524721524074, -40.30473632698494, 62.59250067825055, 74.8686808400766, 59.39571066867546, 23.296365657259603, 119.29572806716517, 70.88316437838401, 80.07323399493369, 29.299680310255944, 93.28237725605877, 65.10696617819285, 8.045752651444861, 142.7733783680664, 78.3228397433288, 87.3840248615888, -28.15412064813744, 99.06996289468239, 56.47217666429688, 109.77753059927439, 172.6798423710514, 26.403807686694154, 38.211916667516434, -67.17581372654561, 19.773999181823278, 6.336708389422117, 97.14065115579075, 111.22291358519138, 118.12303246390145, 76.61298920797473, 87.33943566762672, 26.280164602956745, 29.054491723466626, 103.93664494564602, 97.4394109822689, 88.9680855849358, 91.51295841452863, 126.4061904321599, 132.60410353038753, 60.969329583825136, 94.38769585998705, 8.6867147707184, 1.5520440881965991, 122.6192546697305, 50.486546631616214, 29.626027976423952, 161.39000000000001, 33.66188108172217, 81.7781192388821, 132.87598041375344], "policy_predator_policy_reward": [60.45240268481196, 21.983126881093806, 110.63971566905094, 118.68997660030044, 82.06768678034098, 85.8473880841099, 28.66053086280806, 47.47163569777992, 85.79023772285002, 109.84693696950993, 70.6501174035976, 26.857868972502505, 14.93199294577385, 76.93782095706618, 36.809954967564934, 37.93139754707346, 109.56637966274806, 144.8068137558277, 23.862911238543845, 4.673325451935331, 84.27471325633655, 21.184408009803807, 121.10955373878036, 97.79804887077948, 23.413711750581907, 70.08691799377212, 118.7501071030953, 104.75704829312456, 16.792510071514798, 88.45535832918026, 67.37025662794457, 7.493944372538317, 93.76297366214618, 135.9229614118182, 40.525046097645465, 67.53827152821519, 14.682489434869721, 88.68799757859338, 76.90997711197909, 90.55685633875171, 10.223673839442592, 38.29280520797112, 44.62533976525213, 49.76687581482907, 268.34736926003666, 163.19788060680926, 64.61309931488985, 168.59056499752833, 113.4762792596094, 122.13067179461328, 137.77420531334764, 104.71033891095166, 66.78598027471915, 88.24211954909629, 107.55039972431982, 43.05326154222071, 125.84055007189792, 50.880314801656844, 72.77277184027537, 90.25655423537081, 92.29847586177036, 174.57103405323264, 79.30330190406838, 53.9452025640849, 80.2207326031968, 69.18462687530933, 93.27410740565897, 76.70254766998318, 158.8240737834159, 104.51213257355526, 135.98214302539293, 69.1227602806444, 72.93446347467317, 121.29666168401288, 80.77068971108054, 95.74209118964066, 96.53014131868099, 89.13822867800317, 87.64066701271413, 25.0428030345165, 139.65692525154537, 176.85377366656203, 236.63880809963166, 72.3176460077544, 66.075792264987, 13.504388018683589, 136.07083062899753, 89.96469103723399, 129.0374843096204, 32.21935896443888, 109.92675465016585, 88.96392020894591, 140.47600170831967, 78.0861103690557, 12.302661343171293, 0.6682319124365603, 7.450894335081724, 7.237401303864901, 38.26831111636444, 27.908307180337843, 37.8638615883268, 42.655196078477886, 87.7134289538745, 31.749249183061966, 178.90291068910653, 53.00635385909569, 97.58384127269308, 32.26536395091607, 48.53650414051405, 114.35599063164337, 5.663039947798175, 40.852678473377054, 78.68739357275376, 94.60512629548651, 25.376397623126437, 30.12619779863218, 80.99907384613054, 45.71266378462271, 63.35758613831721, 30.478757664950166, 7.548851218378486, 36.89355138064294, 13.838760439471159, 36.995092477813614, 9.269624230658708, 18.14342820109356, 18.94035499157825, 27.290742092500796, 13.556654642560288, 19.914228736117202, 83.76349501726288, 24.016596285044937, 37.92281038497696, 58.40377690812113, 29.67960241824101, 64.40072507844384, 64.5512520999942, 84.15836558134926, 34.882875332927064, 23.240196115569578, 19.0346909936939, 24.621997549303295, 19.91976049042742, 15.754897066472468, 33.11537808225156, 43.10673207616479, 62.84763095864432, 30.58484347849163, 6.216285729484269, 11.057967310983734, 26.870573568608673, 106.66378576174041, 9.810793491116097, 30.371941512846963, 5.735143387666929, 17.400822684757653, 39.85836762416158, 17.42990417476514, 33.168239441914736, 36.77025112107445, 18.095242183510056, 39.38900342272524, 21.27161849784195, 26.483929661219726, 5.846962731258414, 32.97848562961516, 29.618382274080343, 29.31939138356672, 28.26577192204485, 23.8350398256697, 12.102756365032914, 28.017433080957815, 34.6801740722839, 56.6473876927165, 63.45652957680027, 64.68672301224878, 11.782622037730556, 6.329188741589505, 29.502987589244704, 10.373556928385462, 44.44117487095947, 35.24146754448124, 48.29671441508584, 28.941089226111, 17.73721519726997, 12.158081480595087, 0.7571348945389164, 18.93044673804994, 21.132445588531112, 41.883586684712924, 12.527613445921608, 19.83605180852987, 58.434471106323414, 14.241502892255534, 15.591968031829612, 47.954252869575214, 13.562814699781361, 11.958130801019161, 18.62722781566596, 11.000523099904267]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.3568859296172446, "mean_inference_ms": 8.855976140442191, "mean_action_processing_ms": 1.4231395950035943, "mean_env_wait_ms": 1.1747545338896621, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03418076038360596, "StateBufferConnector_ms": 0.03682661056518555, "ViewRequirementAgentConnector_ms": 0.8323711156845093}, "num_episodes": 22, "episode_return_max": 273.3996462314408, "episode_return_min": -1.8081627801817621, "episode_return_mean": 142.3292687072891, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 196.483746288397, "num_env_steps_trained_throughput_per_sec": 196.483746288397, "timesteps_total": 36000, "num_env_steps_sampled_lifetime": 36000, "num_agent_steps_sampled_lifetime": 144000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 144000, "timers": {"training_iteration_time_ms": 28067.647, "restore_workers_time_ms": 0.036, "training_step_time_ms": 28067.56, "sample_time_ms": 6939.522, "learn_time_ms": 21088.299, "learn_throughput": 189.679, "synch_weights_time_ms": 37.993}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "done": false, "training_iteration": 9, "trial_id": "d163c_00000", "date": "2024-08-16_12-53-51", "timestamp": 1723793031, "time_this_iter_s": 20.363627195358276, "time_total_s": 252.69460654258728, "pid": 81201, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16afbdf70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 252.69460654258728, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 36.57241379310344, "ram_util_percent": 71.64827586206897}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.317609049876531, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.725801545602304, "policy_loss": -0.017742011008449098, "vf_loss": 5.737836567056242, "vf_explained_var": 0.12699676458797757, "kl": 0.019023242391886644, "entropy": 1.5194210981565808, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 17955.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.9532615504252218, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.892165982534015, "policy_loss": -0.007202768087801006, "vf_loss": 8.897267072667521, "vf_explained_var": -0.01132066085855797, "kl": 0.010508568696618798, "entropy": 1.4422178718778822, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 17955.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000}, "env_runners": {"episode_reward_max": 273.3996462314408, "episode_reward_min": 13.614241886854213, "episode_reward_mean": 152.36166711481997, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -210.58773914096443, "predator_policy": 0.6682319124365603}, "policy_reward_max": {"prey_policy": 172.6798423710514, "predator_policy": 236.63880809963166}, "policy_reward_mean": {"prey_policy": 26.841372870943868, "predator_policy": 49.33946068646614}, "custom_metrics": {}, "hist_stats": {"episode_reward": [60.65518321216435, 13.614241886854213, 95.55676382902661, 114.57164727159585, 56.182147434231446, 62.39310548094526, 76.10133476461019, 59.73705215654936, 149.76487451696798, 103.68106379764245, 129.36385138033828, 31.48521601864673, 134.8006005656791, 49.42272262547815, 98.69941068659821, 42.12265649731054, 185.13714291774414, 52.80175713448232, 26.07994329238659, 73.22779793977836, 35.21638451200704, 57.357927957957294, 154.25107399466108, 152.79708850644425, 174.54823191243634, 166.17550713961725, 239.12563312260835, 168.57911358918687, 188.62416970036782, 135.32145467500877, 249.48753363641438, 234.8256009352209, 188.43343228482013, 134.82528714757052, 72.69392845845012, 62.325600546870405, 178.27712302776445, 250.67033636274323, 205.4770084646234, 120.70042298861105, 228.4866935768813, 195.01637856223635, 150.23432003267368, 104.37560925520205, 243.1267112244898, 120.02130000453153, 199.3002561136577, 166.62956846626236, 273.3996462314408, 141.1451207488679, 132.28909046192445, 200.3645173678317, 165.41487021860502, 177.64391652229043, 105.82804239835977, 247.46716424447578, 179.31140486817864, 215.87358904048574, 198.57467917857323, 204.53231296579094, 129.85361590419197, 218.35051901128577, 239.2038395037363, 62.36366470597117, 154.25396016029444, 226.47537552030118, 234.61256618950583, 193.30224268602444, 210.22894031030924, 216.30279324506947, 237.60673047927725, 256.5894653874567, 135.43807588515722, 196.84727275650562, 143.65879550944496, 220.57282658252268, 244.28185056820556, 46.931321046522385, 76.95619990406978, 185.2563269000287, 88.22255056101898, 242.8600289356589, 31.430005755064393, 84.42800842400104, 184.30265573998847, 126.18499255439652, 161.3415313677304, 115.76642854437264, 232.65469407374985, 127.51069620612425, 205.558691853541, 205.5509273797345, 125.03096497412882, 263.13188089001807, 222.8949245987314, 207.49448293354618, 161.14740107662615, 178.00775162474352, 181.02285113677135, 28.39229674099559], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-90.75886958007575, -81.78961152017801, -90.89953258666806, -131.0931765807004, -94.9457846892016, -51.981995706071025, -45.056943757107476, 4.600491204887753, -60.72364697962941, -33.697866852679695, -113.72703204435817, -0.6007273482513997, -8.412010148263692, -78.5159811627724, -58.368992748286516, -148.76346501016718, -8.4896050204922, 25.0059750693068, -61.25472457423789, 15.530428893374221, 31.32562422856198, -71.93842792386603, -85.75517652378088, -146.09581381454356, -117.99331641880313, 47.689013678444915, -96.87007110720108, -47.93833142600691, -101.54293690148121, 23.729566687358204, -23.65897700541834, -119.88673649395534, 62.07933960199722, 10.374333268516432, -159.97965578730538, -103.72928599631972, -210.58773914096443, -72.28877167403483, -2.368389060964577, -3.983993282928015, -68.17171847345375, -122.64741868077078, -69.13178946366281, -34.76712585243909, -143.70598557890142, 99.06638471445106, -172.8863629509204, 107.12133937998941, 71.82173932244177, 89.75559933438747, 137.79076588561827, 13.696445615052097, 135.00654819422732, 37.942466631679096, 92.28771023808271, -4.227654315700393, 17.680005584468095, 51.48148597896345, -173.71004916670867, 77.12223929351524, 161.72206630783165, -42.08373789502647, -88.74328457135351, 160.6763907344173, 98.7290668099135, 43.18864705373125, 55.74320673049983, -94.21043945116932, -6.42779867635406, 23.61913171304544, -63.85902022170458, -0.5271168621781834, 15.060978691397414, 69.37980053309936, 112.1579337637219, 94.07, 43.094680035751026, 111.54847551158777, 92.753268633154, 0.5341019237044257, 50.538310156067574, 131.71728633673473, 97.00258996099245, 64.54290522256687, -31.832856843087544, 74.2870855734538, -21.2187642184642, 29.267786180567967, 135.48173658975568, 13.56464713804911, -52.829909906171196, 24.141592229358928, 78.10967049119847, 63.06751417396268, 48.52999999999998, 74.44287992326505, 150.85388485877561, 86.87110381576551, 81.20000000000059, -16.276989409548783, 3.981570157836506, 34.875045866951986, 70.6095430504791, 112.48072127688468, 72.18524721524074, -40.30473632698494, 62.59250067825055, 74.8686808400766, 59.39571066867546, 23.296365657259603, 119.29572806716517, 70.88316437838401, 80.07323399493369, 29.299680310255944, 93.28237725605877, 65.10696617819285, 8.045752651444861, 142.7733783680664, 78.3228397433288, 87.3840248615888, -28.15412064813744, 99.06996289468239, 56.47217666429688, 109.77753059927439, 172.6798423710514, 26.403807686694154, 38.211916667516434, -67.17581372654561, 19.773999181823278, 6.336708389422117, 97.14065115579075, 111.22291358519138, 118.12303246390145, 76.61298920797473, 87.33943566762672, 26.280164602956745, 29.054491723466626, 103.93664494564602, 97.4394109822689, 88.9680855849358, 91.51295841452863, 126.4061904321599, 132.60410353038753, 60.969329583825136, 94.38769585998705, 8.6867147707184, 1.5520440881965991, 122.6192546697305, 50.486546631616214, 29.626027976423952, 161.39000000000001, 33.66188108172217, 81.7781192388821, 132.87598041375344, 4.6649465542931745, -24.614640563009456, 2.1372183822655515, 24.09727270060734, 93.59911299560221, 11.388287595140321, 15.563993204123435, 14.842381838850015, 95.1642072789139, 118.46782236152195, -63.644641739930734, -18.138531579235362, 21.088874417702307, -25.109866618839977, 14.0064019072459, 97.76330089707663, 21.603076458300052, 50.979645797754415, -10.548885379931741, 66.28604865434524, 32.28684937753127, 27.48939308632299, 74.35286816841081, 134.41889274969392, 16.46784908929756, -9.087809108233266, 69.96178024451818, 102.62025077946369, 111.66193189818206, 39.17685844188128, 1.9343936237758825, -4.3250829567940094, 101.21821134022785, 132.34639742400893, 46.60035547859158, 134.22702203200544, 59.70410742252842, 101.66407700250703, 30.355091687988534, 91.0427934142315, 44.0680582178247, 56.842586571509656, 68.16593222482494, 69.91844062170668, -18.728580289506162, -8.271223595742393], "policy_predator_policy_reward": [64.61309931488985, 168.59056499752833, 113.4762792596094, 122.13067179461328, 137.77420531334764, 104.71033891095166, 66.78598027471915, 88.24211954909629, 107.55039972431982, 43.05326154222071, 125.84055007189792, 50.880314801656844, 72.77277184027537, 90.25655423537081, 92.29847586177036, 174.57103405323264, 79.30330190406838, 53.9452025640849, 80.2207326031968, 69.18462687530933, 93.27410740565897, 76.70254766998318, 158.8240737834159, 104.51213257355526, 135.98214302539293, 69.1227602806444, 72.93446347467317, 121.29666168401288, 80.77068971108054, 95.74209118964066, 96.53014131868099, 89.13822867800317, 87.64066701271413, 25.0428030345165, 139.65692525154537, 176.85377366656203, 236.63880809963166, 72.3176460077544, 66.075792264987, 13.504388018683589, 136.07083062899753, 89.96469103723399, 129.0374843096204, 32.21935896443888, 109.92675465016585, 88.96392020894591, 140.47600170831967, 78.0861103690557, 12.302661343171293, 0.6682319124365603, 7.450894335081724, 7.237401303864901, 38.26831111636444, 27.908307180337843, 37.8638615883268, 42.655196078477886, 87.7134289538745, 31.749249183061966, 178.90291068910653, 53.00635385909569, 97.58384127269308, 32.26536395091607, 48.53650414051405, 114.35599063164337, 5.663039947798175, 40.852678473377054, 78.68739357275376, 94.60512629548651, 25.376397623126437, 30.12619779863218, 80.99907384613054, 45.71266378462271, 63.35758613831721, 30.478757664950166, 7.548851218378486, 36.89355138064294, 13.838760439471159, 36.995092477813614, 9.269624230658708, 18.14342820109356, 18.94035499157825, 27.290742092500796, 13.556654642560288, 19.914228736117202, 83.76349501726288, 24.016596285044937, 37.92281038497696, 58.40377690812113, 29.67960241824101, 64.40072507844384, 64.5512520999942, 84.15836558134926, 34.882875332927064, 23.240196115569578, 19.0346909936939, 24.621997549303295, 19.91976049042742, 15.754897066472468, 33.11537808225156, 43.10673207616479, 62.84763095864432, 30.58484347849163, 6.216285729484269, 11.057967310983734, 26.870573568608673, 106.66378576174041, 9.810793491116097, 30.371941512846963, 5.735143387666929, 17.400822684757653, 39.85836762416158, 17.42990417476514, 33.168239441914736, 36.77025112107445, 18.095242183510056, 39.38900342272524, 21.27161849784195, 26.483929661219726, 5.846962731258414, 32.97848562961516, 29.618382274080343, 29.31939138356672, 28.26577192204485, 23.8350398256697, 12.102756365032914, 28.017433080957815, 34.6801740722839, 56.6473876927165, 63.45652957680027, 64.68672301224878, 11.782622037730556, 6.329188741589505, 29.502987589244704, 10.373556928385462, 44.44117487095947, 35.24146754448124, 48.29671441508584, 28.941089226111, 17.73721519726997, 12.158081480595087, 0.7571348945389164, 18.93044673804994, 21.132445588531112, 41.883586684712924, 12.527613445921608, 19.83605180852987, 58.434471106323414, 14.241502892255534, 15.591968031829612, 47.954252869575214, 13.562814699781361, 11.958130801019161, 18.62722781566596, 11.000523099904267, 47.83654783510129, 19.04446722013742, 41.74879078645384, 8.972918034743083, 23.735585417576406, 56.53334089170975, 18.488049895093265, 39.32812562295232, 8.882169461544366, 20.345829833679126, 47.290351323275736, 65.92282775095474, 72.93358903341365, 15.515411591725035, 68.5170136020915, 4.015939333574349, 15.93077039652833, 37.671499901813384, 74.94222680180688, 30.662141291510178, 48.70463177895304, 7.285554301565205, 14.486327789632199, 9.396605366013395, 61.93754206533535, 58.19311415972461, 20.135712936625076, 12.840947892933967, 24.0162235301708, 30.695913509500485, 34.83394400779263, 92.58771029935424, 9.153939624793287, 20.413332500988112, 10.94868502758409, 31.118862060550324, 17.396287709641186, 28.730010798869436, 22.167771841385854, 17.58174413302026, 20.137624143157236, 56.95948269225208, 15.474298268026029, 27.464180022213675, 39.64385644822226, 15.748244178021894]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.3889230755316673, "mean_inference_ms": 9.010592723336275, "mean_action_processing_ms": 1.444492936566407, "mean_env_wait_ms": 1.185321559607836, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0257493257522583, "StateBufferConnector_ms": 0.02273380756378174, "ViewRequirementAgentConnector_ms": 0.7380250692367554}, "num_episodes": 23, "episode_return_max": 273.3996462314408, "episode_return_min": 13.614241886854213, "episode_return_mean": 152.36166711481997, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 157.28904048976722, "num_env_steps_trained_throughput_per_sec": 157.28904048976722, "timesteps_total": 40000, "num_env_steps_sampled_lifetime": 40000, "num_agent_steps_sampled_lifetime": 160000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 160000, "timers": {"training_iteration_time_ms": 27803.972, "restore_workers_time_ms": 0.034, "training_step_time_ms": 27803.889, "sample_time_ms": 6898.376, "learn_time_ms": 20868.212, "learn_throughput": 191.679, "synch_weights_time_ms": 35.659}, "counters": {"num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000}, "done": false, "training_iteration": 10, "trial_id": "d163c_00000", "date": "2024-08-16_12-54-17", "timestamp": 1723793057, "time_this_iter_s": 25.4352707862854, "time_total_s": 278.1298773288727, "pid": 81201, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16b857e50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 278.1298773288727, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 36.727777777777774, "ram_util_percent": 71.53055555555555}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.5571160519564593, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.43512345016318, "policy_loss": -0.010366116066478075, "vf_loss": 8.442220611925478, "vf_explained_var": 0.042740512304205114, "kl": 0.010896548414585937, "entropy": 1.4981566625297384, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 19845.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.483181461076888, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.34659435837357, "policy_loss": -0.007978066138395912, "vf_loss": 9.352050512303752, "vf_explained_var": -0.1274361079962796, "kl": 0.012609755746811778, "entropy": 1.4100089465499555, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 19845.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000}, "env_runners": {"episode_reward_max": 273.3996462314408, "episode_reward_min": -8.855645797079896, "episode_reward_mean": 144.5649161728714, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -210.58773914096443, "predator_policy": 0.6682319124365603}, "policy_reward_max": {"prey_policy": 172.6798423710514, "predator_policy": 236.63880809963166}, "policy_reward_mean": {"prey_policy": 25.880672108707824, "predator_policy": 46.40178597772788}, "custom_metrics": {}, "hist_stats": {"episode_reward": [26.07994329238659, 73.22779793977836, 35.21638451200704, 57.357927957957294, 154.25107399466108, 152.79708850644425, 174.54823191243634, 166.17550713961725, 239.12563312260835, 168.57911358918687, 188.62416970036782, 135.32145467500877, 249.48753363641438, 234.8256009352209, 188.43343228482013, 134.82528714757052, 72.69392845845012, 62.325600546870405, 178.27712302776445, 250.67033636274323, 205.4770084646234, 120.70042298861105, 228.4866935768813, 195.01637856223635, 150.23432003267368, 104.37560925520205, 243.1267112244898, 120.02130000453153, 199.3002561136577, 166.62956846626236, 273.3996462314408, 141.1451207488679, 132.28909046192445, 200.3645173678317, 165.41487021860502, 177.64391652229043, 105.82804239835977, 247.46716424447578, 179.31140486817864, 215.87358904048574, 198.57467917857323, 204.53231296579094, 129.85361590419197, 218.35051901128577, 239.2038395037363, 62.36366470597117, 154.25396016029444, 226.47537552030118, 234.61256618950583, 193.30224268602444, 210.22894031030924, 216.30279324506947, 237.60673047927725, 256.5894653874567, 135.43807588515722, 196.84727275650562, 143.65879550944496, 220.57282658252268, 244.28185056820556, 46.931321046522385, 76.95619990406978, 185.2563269000287, 88.22255056101898, 242.8600289356589, 31.430005755064393, 84.42800842400104, 184.30265573998847, 126.18499255439652, 161.3415313677304, 115.76642854437264, 232.65469407374985, 127.51069620612425, 205.558691853541, 205.5509273797345, 125.03096497412882, 263.13188089001807, 222.8949245987314, 207.49448293354618, 161.14740107662615, 178.00775162474352, 181.02285113677135, 28.39229674099559, -2.4077506321983932, 26.578698614098943, 45.17720856154383, 67.48542736179832, 36.440620527651724, -2.3139184923163763, 102.06298953140981, 34.58596119551058, 3.3777687438951904, 81.73140415440551, 9.647690695317214, 49.84132735814753, 24.807416461134917, 106.66331297360428, 52.98962145940245, 80.84984906108294, 27.75369620459947, -8.855645797079896], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-210.58773914096443, -72.28877167403483, -2.368389060964577, -3.983993282928015, -68.17171847345375, -122.64741868077078, -69.13178946366281, -34.76712585243909, -143.70598557890142, 99.06638471445106, -172.8863629509204, 107.12133937998941, 71.82173932244177, 89.75559933438747, 137.79076588561827, 13.696445615052097, 135.00654819422732, 37.942466631679096, 92.28771023808271, -4.227654315700393, 17.680005584468095, 51.48148597896345, -173.71004916670867, 77.12223929351524, 161.72206630783165, -42.08373789502647, -88.74328457135351, 160.6763907344173, 98.7290668099135, 43.18864705373125, 55.74320673049983, -94.21043945116932, -6.42779867635406, 23.61913171304544, -63.85902022170458, -0.5271168621781834, 15.060978691397414, 69.37980053309936, 112.1579337637219, 94.07, 43.094680035751026, 111.54847551158777, 92.753268633154, 0.5341019237044257, 50.538310156067574, 131.71728633673473, 97.00258996099245, 64.54290522256687, -31.832856843087544, 74.2870855734538, -21.2187642184642, 29.267786180567967, 135.48173658975568, 13.56464713804911, -52.829909906171196, 24.141592229358928, 78.10967049119847, 63.06751417396268, 48.52999999999998, 74.44287992326505, 150.85388485877561, 86.87110381576551, 81.20000000000059, -16.276989409548783, 3.981570157836506, 34.875045866951986, 70.6095430504791, 112.48072127688468, 72.18524721524074, -40.30473632698494, 62.59250067825055, 74.8686808400766, 59.39571066867546, 23.296365657259603, 119.29572806716517, 70.88316437838401, 80.07323399493369, 29.299680310255944, 93.28237725605877, 65.10696617819285, 8.045752651444861, 142.7733783680664, 78.3228397433288, 87.3840248615888, -28.15412064813744, 99.06996289468239, 56.47217666429688, 109.77753059927439, 172.6798423710514, 26.403807686694154, 38.211916667516434, -67.17581372654561, 19.773999181823278, 6.336708389422117, 97.14065115579075, 111.22291358519138, 118.12303246390145, 76.61298920797473, 87.33943566762672, 26.280164602956745, 29.054491723466626, 103.93664494564602, 97.4394109822689, 88.9680855849358, 91.51295841452863, 126.4061904321599, 132.60410353038753, 60.969329583825136, 94.38769585998705, 8.6867147707184, 1.5520440881965991, 122.6192546697305, 50.486546631616214, 29.626027976423952, 161.39000000000001, 33.66188108172217, 81.7781192388821, 132.87598041375344, 4.6649465542931745, -24.614640563009456, 2.1372183822655515, 24.09727270060734, 93.59911299560221, 11.388287595140321, 15.563993204123435, 14.842381838850015, 95.1642072789139, 118.46782236152195, -63.644641739930734, -18.138531579235362, 21.088874417702307, -25.109866618839977, 14.0064019072459, 97.76330089707663, 21.603076458300052, 50.979645797754415, -10.548885379931741, 66.28604865434524, 32.28684937753127, 27.48939308632299, 74.35286816841081, 134.41889274969392, 16.46784908929756, -9.087809108233266, 69.96178024451818, 102.62025077946369, 111.66193189818206, 39.17685844188128, 1.9343936237758825, -4.3250829567940094, 101.21821134022785, 132.34639742400893, 46.60035547859158, 134.22702203200544, 59.70410742252842, 101.66407700250703, 30.355091687988534, 91.0427934142315, 44.0680582178247, 56.842586571509656, 68.16593222482494, 69.91844062170668, -18.728580289506162, -8.271223595742393, -37.64515957195467, -108.70706752500837, -98.52445636796492, -63.04431183784774, -100.08608690942023, -18.49567611819856, -2.632790117546496, -161.85636321612168, -110.84350818229301, -61.870989804766566, -80.43145042658543, -85.09537116574066, -18.42943466449998, 12.079693651031047, -66.49194372719198, -99.55757831356706, -95.57913153340748, -103.54286351081248, -30.282911500971224, -47.39067171286239, -41.79197917801382, -97.14934857476848, -39.104131107008165, 1.3656219687490132, -88.52039079638288, -52.21566990456262, -3.9770394046029756, 21.58411493664936, 13.006899574394268, -80.37353652881812, -49.55752663592481, 1.126850338878765, -40.04255259263322, -118.24948601877601, -122.62895132162879, -131.3188777224053], "policy_predator_policy_reward": [236.63880809963166, 72.3176460077544, 66.075792264987, 13.504388018683589, 136.07083062899753, 89.96469103723399, 129.0374843096204, 32.21935896443888, 109.92675465016585, 88.96392020894591, 140.47600170831967, 78.0861103690557, 12.302661343171293, 0.6682319124365603, 7.450894335081724, 7.237401303864901, 38.26831111636444, 27.908307180337843, 37.8638615883268, 42.655196078477886, 87.7134289538745, 31.749249183061966, 178.90291068910653, 53.00635385909569, 97.58384127269308, 32.26536395091607, 48.53650414051405, 114.35599063164337, 5.663039947798175, 40.852678473377054, 78.68739357275376, 94.60512629548651, 25.376397623126437, 30.12619779863218, 80.99907384613054, 45.71266378462271, 63.35758613831721, 30.478757664950166, 7.548851218378486, 36.89355138064294, 13.838760439471159, 36.995092477813614, 9.269624230658708, 18.14342820109356, 18.94035499157825, 27.290742092500796, 13.556654642560288, 19.914228736117202, 83.76349501726288, 24.016596285044937, 37.92281038497696, 58.40377690812113, 29.67960241824101, 64.40072507844384, 64.5512520999942, 84.15836558134926, 34.882875332927064, 23.240196115569578, 19.0346909936939, 24.621997549303295, 19.91976049042742, 15.754897066472468, 33.11537808225156, 43.10673207616479, 62.84763095864432, 30.58484347849163, 6.216285729484269, 11.057967310983734, 26.870573568608673, 106.66378576174041, 9.810793491116097, 30.371941512846963, 5.735143387666929, 17.400822684757653, 39.85836762416158, 17.42990417476514, 33.168239441914736, 36.77025112107445, 18.095242183510056, 39.38900342272524, 21.27161849784195, 26.483929661219726, 5.846962731258414, 32.97848562961516, 29.618382274080343, 29.31939138356672, 28.26577192204485, 23.8350398256697, 12.102756365032914, 28.017433080957815, 34.6801740722839, 56.6473876927165, 63.45652957680027, 64.68672301224878, 11.782622037730556, 6.329188741589505, 29.502987589244704, 10.373556928385462, 44.44117487095947, 35.24146754448124, 48.29671441508584, 28.941089226111, 17.73721519726997, 12.158081480595087, 0.7571348945389164, 18.93044673804994, 21.132445588531112, 41.883586684712924, 12.527613445921608, 19.83605180852987, 58.434471106323414, 14.241502892255534, 15.591968031829612, 47.954252869575214, 13.562814699781361, 11.958130801019161, 18.62722781566596, 11.000523099904267, 47.83654783510129, 19.04446722013742, 41.74879078645384, 8.972918034743083, 23.735585417576406, 56.53334089170975, 18.488049895093265, 39.32812562295232, 8.882169461544366, 20.345829833679126, 47.290351323275736, 65.92282775095474, 72.93358903341365, 15.515411591725035, 68.5170136020915, 4.015939333574349, 15.93077039652833, 37.671499901813384, 74.94222680180688, 30.662141291510178, 48.70463177895304, 7.285554301565205, 14.486327789632199, 9.396605366013395, 61.93754206533535, 58.19311415972461, 20.135712936625076, 12.840947892933967, 24.0162235301708, 30.695913509500485, 34.83394400779263, 92.58771029935424, 9.153939624793287, 20.413332500988112, 10.94868502758409, 31.118862060550324, 17.396287709641186, 28.730010798869436, 22.167771841385854, 17.58174413302026, 20.137624143157236, 56.95948269225208, 15.474298268026029, 27.464180022213675, 39.64385644822226, 15.748244178021894, 137.74863671630783, 6.19583974845678, 96.0504686458264, 92.09699817408517, 74.56300152016762, 89.19597006899492, 105.31553955789393, 126.65904113757263, 125.40169606129861, 83.75342245341267, 70.8628761221322, 92.3500269778775, 45.33275343877791, 63.07997710610086, 120.49359011176755, 80.14189312450195, 118.10553592231507, 84.39422786580013, 63.961775703641415, 95.44321166459774, 119.55593207600852, 29.033086372091063, 42.837750371838446, 44.74208612456829, 130.39417235721697, 35.14930480486339, 41.79054807569487, 47.26568936586292, 67.6258154028744, 52.730443010951866, 73.98915076716908, 55.29137459095963, 88.61213656427938, 97.43359825172935, 137.34934076855984, 107.74284247839428]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.3880177019587756, "mean_inference_ms": 9.02768789079131, "mean_action_processing_ms": 1.4473721826303807, "mean_env_wait_ms": 1.1866616256284144, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023067235946655273, "StateBufferConnector_ms": 0.01980757713317871, "ViewRequirementAgentConnector_ms": 0.712820291519165}, "num_episodes": 18, "episode_return_max": 273.3996462314408, "episode_return_min": -8.855645797079896, "episode_return_mean": 144.5649161728714, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 232.23356828851794, "num_env_steps_trained_throughput_per_sec": 232.23356828851794, "timesteps_total": 44000, "num_env_steps_sampled_lifetime": 44000, "num_agent_steps_sampled_lifetime": 176000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 176000, "timers": {"training_iteration_time_ms": 26253.573, "restore_workers_time_ms": 0.033, "training_step_time_ms": 26253.491, "sample_time_ms": 6971.458, "learn_time_ms": 19256.166, "learn_throughput": 207.726, "synch_weights_time_ms": 24.261}, "counters": {"num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000}, "done": false, "training_iteration": 11, "trial_id": "d163c_00000", "date": "2024-08-16_12-54-34", "timestamp": 1723793074, "time_this_iter_s": 17.22905683517456, "time_total_s": 295.35893416404724, "pid": 81201, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16b85ad30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 295.35893416404724, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 31.616666666666664, "ram_util_percent": 70.83749999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.1754835522048688, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.051944961245098, "policy_loss": -0.00867085452696614, "vf_loss": 9.057804680375195, "vf_explained_var": 0.04565834939164459, "kl": 0.009370253326188677, "entropy": 1.516120043885771, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 21735.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.0441143405815914, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.338329170368336, "policy_loss": -0.004085728275298914, "vf_loss": 9.340484424369045, "vf_explained_var": -0.018480144669769934, "kl": 0.009652420356415923, "entropy": 1.374769180224686, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 21735.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000}, "env_runners": {"episode_reward_max": 273.3996462314408, "episode_reward_min": -8.855645797079896, "episode_reward_mean": 130.0344805627323, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -268.006180713676, "predator_policy": 0.7571348945389164}, "policy_reward_max": {"prey_policy": 172.6798423710514, "predator_policy": 284.45867829941795}, "policy_reward_mean": {"prey_policy": 9.839919827948458, "predator_policy": 55.17732045341772}, "custom_metrics": {}, "hist_stats": {"episode_reward": [178.27712302776445, 250.67033636274323, 205.4770084646234, 120.70042298861105, 228.4866935768813, 195.01637856223635, 150.23432003267368, 104.37560925520205, 243.1267112244898, 120.02130000453153, 199.3002561136577, 166.62956846626236, 273.3996462314408, 141.1451207488679, 132.28909046192445, 200.3645173678317, 165.41487021860502, 177.64391652229043, 105.82804239835977, 247.46716424447578, 179.31140486817864, 215.87358904048574, 198.57467917857323, 204.53231296579094, 129.85361590419197, 218.35051901128577, 239.2038395037363, 62.36366470597117, 154.25396016029444, 226.47537552030118, 234.61256618950583, 193.30224268602444, 210.22894031030924, 216.30279324506947, 237.60673047927725, 256.5894653874567, 135.43807588515722, 196.84727275650562, 143.65879550944496, 220.57282658252268, 244.28185056820556, 46.931321046522385, 76.95619990406978, 185.2563269000287, 88.22255056101898, 242.8600289356589, 31.430005755064393, 84.42800842400104, 184.30265573998847, 126.18499255439652, 161.3415313677304, 115.76642854437264, 232.65469407374985, 127.51069620612425, 205.558691853541, 205.5509273797345, 125.03096497412882, 263.13188089001807, 222.8949245987314, 207.49448293354618, 161.14740107662615, 178.00775162474352, 181.02285113677135, 28.39229674099559, -2.4077506321983932, 26.578698614098943, 45.17720856154383, 67.48542736179832, 36.440620527651724, -2.3139184923163763, 102.06298953140981, 34.58596119551058, 3.3777687438951904, 81.73140415440551, 9.647690695317214, 49.84132735814753, 24.807416461134917, 106.66331297360428, 52.98962145940245, 80.84984906108294, 27.75369620459947, -8.855645797079896, 67.36569001182332, 20.175978112082024, 110.90240531754505, -2.2027696466094424, 42.17004760825959, 32.16663563513738, 86.48744278454409, 1.7489209844395983, 162.89154457777732, 48.732308367535474, 94.86527155477687, 23.702782982431824, 20.918734867902646, 25.561697153071574, 60.55488497078166, 200.46472741482563, 23.651795569693412, 40.69405007188249], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [15.060978691397414, 69.37980053309936, 112.1579337637219, 94.07, 43.094680035751026, 111.54847551158777, 92.753268633154, 0.5341019237044257, 50.538310156067574, 131.71728633673473, 97.00258996099245, 64.54290522256687, -31.832856843087544, 74.2870855734538, -21.2187642184642, 29.267786180567967, 135.48173658975568, 13.56464713804911, -52.829909906171196, 24.141592229358928, 78.10967049119847, 63.06751417396268, 48.52999999999998, 74.44287992326505, 150.85388485877561, 86.87110381576551, 81.20000000000059, -16.276989409548783, 3.981570157836506, 34.875045866951986, 70.6095430504791, 112.48072127688468, 72.18524721524074, -40.30473632698494, 62.59250067825055, 74.8686808400766, 59.39571066867546, 23.296365657259603, 119.29572806716517, 70.88316437838401, 80.07323399493369, 29.299680310255944, 93.28237725605877, 65.10696617819285, 8.045752651444861, 142.7733783680664, 78.3228397433288, 87.3840248615888, -28.15412064813744, 99.06996289468239, 56.47217666429688, 109.77753059927439, 172.6798423710514, 26.403807686694154, 38.211916667516434, -67.17581372654561, 19.773999181823278, 6.336708389422117, 97.14065115579075, 111.22291358519138, 118.12303246390145, 76.61298920797473, 87.33943566762672, 26.280164602956745, 29.054491723466626, 103.93664494564602, 97.4394109822689, 88.9680855849358, 91.51295841452863, 126.4061904321599, 132.60410353038753, 60.969329583825136, 94.38769585998705, 8.6867147707184, 1.5520440881965991, 122.6192546697305, 50.486546631616214, 29.626027976423952, 161.39000000000001, 33.66188108172217, 81.7781192388821, 132.87598041375344, 4.6649465542931745, -24.614640563009456, 2.1372183822655515, 24.09727270060734, 93.59911299560221, 11.388287595140321, 15.563993204123435, 14.842381838850015, 95.1642072789139, 118.46782236152195, -63.644641739930734, -18.138531579235362, 21.088874417702307, -25.109866618839977, 14.0064019072459, 97.76330089707663, 21.603076458300052, 50.979645797754415, -10.548885379931741, 66.28604865434524, 32.28684937753127, 27.48939308632299, 74.35286816841081, 134.41889274969392, 16.46784908929756, -9.087809108233266, 69.96178024451818, 102.62025077946369, 111.66193189818206, 39.17685844188128, 1.9343936237758825, -4.3250829567940094, 101.21821134022785, 132.34639742400893, 46.60035547859158, 134.22702203200544, 59.70410742252842, 101.66407700250703, 30.355091687988534, 91.0427934142315, 44.0680582178247, 56.842586571509656, 68.16593222482494, 69.91844062170668, -18.728580289506162, -8.271223595742393, -37.64515957195467, -108.70706752500837, -98.52445636796492, -63.04431183784774, -100.08608690942023, -18.49567611819856, -2.632790117546496, -161.85636321612168, -110.84350818229301, -61.870989804766566, -80.43145042658543, -85.09537116574066, -18.42943466449998, 12.079693651031047, -66.49194372719198, -99.55757831356706, -95.57913153340748, -103.54286351081248, -30.282911500971224, -47.39067171286239, -41.79197917801382, -97.14934857476848, -39.104131107008165, 1.3656219687490132, -88.52039079638288, -52.21566990456262, -3.9770394046029756, 21.58411493664936, 13.006899574394268, -80.37353652881812, -49.55752663592481, 1.126850338878765, -40.04255259263322, -118.24948601877601, -122.62895132162879, -131.3188777224053, -3.103338671057046, -23.64791146230394, -83.56644234796991, -196.85148788557845, -24.548457260463024, 6.696124398564119, -167.9125121502735, -101.55098851641108, -30.440793636745536, -243.22950364753825, -178.7295538305946, -268.006180713676, -26.93262583852857, -34.57495841073717, -243.71383253082396, -90.55236539562775, 6.69761572656888, -11.90460850723909, -31.68729484072572, -92.63698764070777, -64.95741847395718, -68.2154411137543, -177.84275271642457, -98.26287736860323, -61.34653447149946, -107.5958738620631, -75.9540148718504, -34.50736250637506, -3.598391600348986, -180.00559717274098, 103.27706987916913, -62.733267947989546, -140.5091393398684, -137.54150232039214, -108.74440863971324, -49.293996260513836], "policy_predator_policy_reward": [63.35758613831721, 30.478757664950166, 7.548851218378486, 36.89355138064294, 13.838760439471159, 36.995092477813614, 9.269624230658708, 18.14342820109356, 18.94035499157825, 27.290742092500796, 13.556654642560288, 19.914228736117202, 83.76349501726288, 24.016596285044937, 37.92281038497696, 58.40377690812113, 29.67960241824101, 64.40072507844384, 64.5512520999942, 84.15836558134926, 34.882875332927064, 23.240196115569578, 19.0346909936939, 24.621997549303295, 19.91976049042742, 15.754897066472468, 33.11537808225156, 43.10673207616479, 62.84763095864432, 30.58484347849163, 6.216285729484269, 11.057967310983734, 26.870573568608673, 106.66378576174041, 9.810793491116097, 30.371941512846963, 5.735143387666929, 17.400822684757653, 39.85836762416158, 17.42990417476514, 33.168239441914736, 36.77025112107445, 18.095242183510056, 39.38900342272524, 21.27161849784195, 26.483929661219726, 5.846962731258414, 32.97848562961516, 29.618382274080343, 29.31939138356672, 28.26577192204485, 23.8350398256697, 12.102756365032914, 28.017433080957815, 34.6801740722839, 56.6473876927165, 63.45652957680027, 64.68672301224878, 11.782622037730556, 6.329188741589505, 29.502987589244704, 10.373556928385462, 44.44117487095947, 35.24146754448124, 48.29671441508584, 28.941089226111, 17.73721519726997, 12.158081480595087, 0.7571348945389164, 18.93044673804994, 21.132445588531112, 41.883586684712924, 12.527613445921608, 19.83605180852987, 58.434471106323414, 14.241502892255534, 15.591968031829612, 47.954252869575214, 13.562814699781361, 11.958130801019161, 18.62722781566596, 11.000523099904267, 47.83654783510129, 19.04446722013742, 41.74879078645384, 8.972918034743083, 23.735585417576406, 56.53334089170975, 18.488049895093265, 39.32812562295232, 8.882169461544366, 20.345829833679126, 47.290351323275736, 65.92282775095474, 72.93358903341365, 15.515411591725035, 68.5170136020915, 4.015939333574349, 15.93077039652833, 37.671499901813384, 74.94222680180688, 30.662141291510178, 48.70463177895304, 7.285554301565205, 14.486327789632199, 9.396605366013395, 61.93754206533535, 58.19311415972461, 20.135712936625076, 12.840947892933967, 24.0162235301708, 30.695913509500485, 34.83394400779263, 92.58771029935424, 9.153939624793287, 20.413332500988112, 10.94868502758409, 31.118862060550324, 17.396287709641186, 28.730010798869436, 22.167771841385854, 17.58174413302026, 20.137624143157236, 56.95948269225208, 15.474298268026029, 27.464180022213675, 39.64385644822226, 15.748244178021894, 137.74863671630783, 6.19583974845678, 96.0504686458264, 92.09699817408517, 74.56300152016762, 89.19597006899492, 105.31553955789393, 126.65904113757263, 125.40169606129861, 83.75342245341267, 70.8628761221322, 92.3500269778775, 45.33275343877791, 63.07997710610086, 120.49359011176755, 80.14189312450195, 118.10553592231507, 84.39422786580013, 63.961775703641415, 95.44321166459774, 119.55593207600852, 29.033086372091063, 42.837750371838446, 44.74208612456829, 130.39417235721697, 35.14930480486339, 41.79054807569487, 47.26568936586292, 67.6258154028744, 52.730443010951866, 73.98915076716908, 55.29137459095963, 88.61213656427938, 97.43359825172935, 137.34934076855984, 107.74284247839428, 64.98269436563768, 29.1342457795467, 97.68221492107767, 202.91169342455277, 64.69394089103834, 64.06079728840548, 171.01732940996106, 96.24340161011415, 174.23805189870345, 141.60229299383988, 194.44369187999007, 284.45867829941795, 77.93361092054211, 70.06141611326775, 183.5846177696422, 152.4305011412487, 82.53390103087044, 85.56463632757719, 68.70154436352948, 104.35504648543957, 89.38114759100779, 138.65698355148038, 141.04504534454583, 158.76336772291387, 94.73726385094538, 95.12387935051981, 56.90533656959873, 79.11773796169837, 148.06100786176066, 96.09786588211085, 74.36875695698849, 85.55216852665762, 129.94818856057879, 171.75424866937522, 76.83062315130589, 121.90183182080374]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.34774603644453, "mean_inference_ms": 8.942191872527248, "mean_action_processing_ms": 1.432155302107553, "mean_env_wait_ms": 1.175622851231212, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01237785816192627, "StateBufferConnector_ms": 0.01961815357208252, "ViewRequirementAgentConnector_ms": 0.6612714529037476}, "num_episodes": 18, "episode_return_max": 273.3996462314408, "episode_return_min": -8.855645797079896, "episode_return_mean": 130.0344805627323, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 258.2778390275959, "num_env_steps_trained_throughput_per_sec": 258.2778390275959, "timesteps_total": 48000, "num_env_steps_sampled_lifetime": 48000, "num_agent_steps_sampled_lifetime": 192000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 192000, "timers": {"training_iteration_time_ms": 24740.153, "restore_workers_time_ms": 0.018, "training_step_time_ms": 24740.105, "sample_time_ms": 6592.71, "learn_time_ms": 18127.398, "learn_throughput": 220.66, "synch_weights_time_ms": 18.982}, "counters": {"num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000}, "done": false, "training_iteration": 12, "trial_id": "d163c_00000", "date": "2024-08-16_12-54-50", "timestamp": 1723793090, "time_this_iter_s": 15.491222858428955, "time_total_s": 310.8501570224762, "pid": 81201, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16b85af70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 310.8501570224762, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 28.21363636363636, "ram_util_percent": 70.87272727272726}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.1988456433727626, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.658741238003685, "policy_loss": -0.0049882910295670465, "vf_loss": 8.660870610847676, "vf_explained_var": 0.009551471156418008, "kl": 0.00952972823923145, "entropy": 1.5209172891561316, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 23625.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.103872159612242, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.246598627201465, "policy_loss": -0.012166871314020777, "vf_loss": 9.256343672515223, "vf_explained_var": -0.022748561416353497, "kl": 0.012109100650413604, "entropy": 1.394996073447838, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 23625.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 208000, "num_agent_steps_trained": 208000}, "env_runners": {"episode_reward_max": 263.13188089001807, "episode_reward_min": -8.855645797079896, "episode_reward_mean": 108.95536746870071, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -268.006180713676, "predator_policy": 0.7571348945389164}, "policy_reward_max": {"prey_policy": 172.6798423710514, "predator_policy": 284.45867829941795}, "policy_reward_mean": {"prey_policy": -18.11908269683275, "predator_policy": 72.59676643118313}, "custom_metrics": {}, "hist_stats": {"episode_reward": [105.82804239835977, 247.46716424447578, 179.31140486817864, 215.87358904048574, 198.57467917857323, 204.53231296579094, 129.85361590419197, 218.35051901128577, 239.2038395037363, 62.36366470597117, 154.25396016029444, 226.47537552030118, 234.61256618950583, 193.30224268602444, 210.22894031030924, 216.30279324506947, 237.60673047927725, 256.5894653874567, 135.43807588515722, 196.84727275650562, 143.65879550944496, 220.57282658252268, 244.28185056820556, 46.931321046522385, 76.95619990406978, 185.2563269000287, 88.22255056101898, 242.8600289356589, 31.430005755064393, 84.42800842400104, 184.30265573998847, 126.18499255439652, 161.3415313677304, 115.76642854437264, 232.65469407374985, 127.51069620612425, 205.558691853541, 205.5509273797345, 125.03096497412882, 263.13188089001807, 222.8949245987314, 207.49448293354618, 161.14740107662615, 178.00775162474352, 181.02285113677135, 28.39229674099559, -2.4077506321983932, 26.578698614098943, 45.17720856154383, 67.48542736179832, 36.440620527651724, -2.3139184923163763, 102.06298953140981, 34.58596119551058, 3.3777687438951904, 81.73140415440551, 9.647690695317214, 49.84132735814753, 24.807416461134917, 106.66331297360428, 52.98962145940245, 80.84984906108294, 27.75369620459947, -8.855645797079896, 67.36569001182332, 20.175978112082024, 110.90240531754505, -2.2027696466094424, 42.17004760825959, 32.16663563513738, 86.48744278454409, 1.7489209844395983, 162.89154457777732, 48.732308367535474, 94.86527155477687, 23.702782982431824, 20.918734867902646, 25.561697153071574, 60.55488497078166, 200.46472741482563, 23.651795569693412, 40.69405007188249, 57.1495904492, 27.292457732922717, 63.928565713011885, 66.01606626645967, 51.48127543135584, 114.90923744545685, 112.69879809331859, 24.077605567331393, -4.926406872442323, 152.9607297823895, 15.447713582937682, 97.41410752817964, 28.274468532150184, 49.901176059411426, 4.072705314204755, 86.18531759548692, 46.14895511641908, 151.62921688968015], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [59.39571066867546, 23.296365657259603, 119.29572806716517, 70.88316437838401, 80.07323399493369, 29.299680310255944, 93.28237725605877, 65.10696617819285, 8.045752651444861, 142.7733783680664, 78.3228397433288, 87.3840248615888, -28.15412064813744, 99.06996289468239, 56.47217666429688, 109.77753059927439, 172.6798423710514, 26.403807686694154, 38.211916667516434, -67.17581372654561, 19.773999181823278, 6.336708389422117, 97.14065115579075, 111.22291358519138, 118.12303246390145, 76.61298920797473, 87.33943566762672, 26.280164602956745, 29.054491723466626, 103.93664494564602, 97.4394109822689, 88.9680855849358, 91.51295841452863, 126.4061904321599, 132.60410353038753, 60.969329583825136, 94.38769585998705, 8.6867147707184, 1.5520440881965991, 122.6192546697305, 50.486546631616214, 29.626027976423952, 161.39000000000001, 33.66188108172217, 81.7781192388821, 132.87598041375344, 4.6649465542931745, -24.614640563009456, 2.1372183822655515, 24.09727270060734, 93.59911299560221, 11.388287595140321, 15.563993204123435, 14.842381838850015, 95.1642072789139, 118.46782236152195, -63.644641739930734, -18.138531579235362, 21.088874417702307, -25.109866618839977, 14.0064019072459, 97.76330089707663, 21.603076458300052, 50.979645797754415, -10.548885379931741, 66.28604865434524, 32.28684937753127, 27.48939308632299, 74.35286816841081, 134.41889274969392, 16.46784908929756, -9.087809108233266, 69.96178024451818, 102.62025077946369, 111.66193189818206, 39.17685844188128, 1.9343936237758825, -4.3250829567940094, 101.21821134022785, 132.34639742400893, 46.60035547859158, 134.22702203200544, 59.70410742252842, 101.66407700250703, 30.355091687988534, 91.0427934142315, 44.0680582178247, 56.842586571509656, 68.16593222482494, 69.91844062170668, -18.728580289506162, -8.271223595742393, -37.64515957195467, -108.70706752500837, -98.52445636796492, -63.04431183784774, -100.08608690942023, -18.49567611819856, -2.632790117546496, -161.85636321612168, -110.84350818229301, -61.870989804766566, -80.43145042658543, -85.09537116574066, -18.42943466449998, 12.079693651031047, -66.49194372719198, -99.55757831356706, -95.57913153340748, -103.54286351081248, -30.282911500971224, -47.39067171286239, -41.79197917801382, -97.14934857476848, -39.104131107008165, 1.3656219687490132, -88.52039079638288, -52.21566990456262, -3.9770394046029756, 21.58411493664936, 13.006899574394268, -80.37353652881812, -49.55752663592481, 1.126850338878765, -40.04255259263322, -118.24948601877601, -122.62895132162879, -131.3188777224053, -3.103338671057046, -23.64791146230394, -83.56644234796991, -196.85148788557845, -24.548457260463024, 6.696124398564119, -167.9125121502735, -101.55098851641108, -30.440793636745536, -243.22950364753825, -178.7295538305946, -268.006180713676, -26.93262583852857, -34.57495841073717, -243.71383253082396, -90.55236539562775, 6.69761572656888, -11.90460850723909, -31.68729484072572, -92.63698764070777, -64.95741847395718, -68.2154411137543, -177.84275271642457, -98.26287736860323, -61.34653447149946, -107.5958738620631, -75.9540148718504, -34.50736250637506, -3.598391600348986, -180.00559717274098, 103.27706987916913, -62.733267947989546, -140.5091393398684, -137.54150232039214, -108.74440863971324, -49.293996260513836, -103.4039342556437, -110.90770747169934, -74.4156946607467, -166.60459809276824, -108.93692631248096, -33.574132364885, -123.45230553920106, -60.912371919223766, -109.57697012911709, -129.83358067348797, -131.36577892922125, -106.15744137310656, -83.79635810065734, 73.54535761723295, -184.8479770479153, -127.32352248408303, -235.7948323158357, -140.65124727309635, 102.41552063636763, -131.5460842070523, -75.85119925146918, -198.70558587672645, -124.00811690924107, 31.247148322900788, -81.67801273652987, -158.70909878267304, -92.35599596415295, -115.32235508345032, -229.86388464916786, -139.83773113926586, -18.30228419018627, -55.29966921879677, -71.57141423983235, -145.7683713468838, 40.18867367408675, -157.47373854383943], "policy_predator_policy_reward": [5.735143387666929, 17.400822684757653, 39.85836762416158, 17.42990417476514, 33.168239441914736, 36.77025112107445, 18.095242183510056, 39.38900342272524, 21.27161849784195, 26.483929661219726, 5.846962731258414, 32.97848562961516, 29.618382274080343, 29.31939138356672, 28.26577192204485, 23.8350398256697, 12.102756365032914, 28.017433080957815, 34.6801740722839, 56.6473876927165, 63.45652957680027, 64.68672301224878, 11.782622037730556, 6.329188741589505, 29.502987589244704, 10.373556928385462, 44.44117487095947, 35.24146754448124, 48.29671441508584, 28.941089226111, 17.73721519726997, 12.158081480595087, 0.7571348945389164, 18.93044673804994, 21.132445588531112, 41.883586684712924, 12.527613445921608, 19.83605180852987, 58.434471106323414, 14.241502892255534, 15.591968031829612, 47.954252869575214, 13.562814699781361, 11.958130801019161, 18.62722781566596, 11.000523099904267, 47.83654783510129, 19.04446722013742, 41.74879078645384, 8.972918034743083, 23.735585417576406, 56.53334089170975, 18.488049895093265, 39.32812562295232, 8.882169461544366, 20.345829833679126, 47.290351323275736, 65.92282775095474, 72.93358903341365, 15.515411591725035, 68.5170136020915, 4.015939333574349, 15.93077039652833, 37.671499901813384, 74.94222680180688, 30.662141291510178, 48.70463177895304, 7.285554301565205, 14.486327789632199, 9.396605366013395, 61.93754206533535, 58.19311415972461, 20.135712936625076, 12.840947892933967, 24.0162235301708, 30.695913509500485, 34.83394400779263, 92.58771029935424, 9.153939624793287, 20.413332500988112, 10.94868502758409, 31.118862060550324, 17.396287709641186, 28.730010798869436, 22.167771841385854, 17.58174413302026, 20.137624143157236, 56.95948269225208, 15.474298268026029, 27.464180022213675, 39.64385644822226, 15.748244178021894, 137.74863671630783, 6.19583974845678, 96.0504686458264, 92.09699817408517, 74.56300152016762, 89.19597006899492, 105.31553955789393, 126.65904113757263, 125.40169606129861, 83.75342245341267, 70.8628761221322, 92.3500269778775, 45.33275343877791, 63.07997710610086, 120.49359011176755, 80.14189312450195, 118.10553592231507, 84.39422786580013, 63.961775703641415, 95.44321166459774, 119.55593207600852, 29.033086372091063, 42.837750371838446, 44.74208612456829, 130.39417235721697, 35.14930480486339, 41.79054807569487, 47.26568936586292, 67.6258154028744, 52.730443010951866, 73.98915076716908, 55.29137459095963, 88.61213656427938, 97.43359825172935, 137.34934076855984, 107.74284247839428, 64.98269436563768, 29.1342457795467, 97.68221492107767, 202.91169342455277, 64.69394089103834, 64.06079728840548, 171.01732940996106, 96.24340161011415, 174.23805189870345, 141.60229299383988, 194.44369187999007, 284.45867829941795, 77.93361092054211, 70.06141611326775, 183.5846177696422, 152.4305011412487, 82.53390103087044, 85.56463632757719, 68.70154436352948, 104.35504648543957, 89.38114759100779, 138.65698355148038, 141.04504534454583, 158.76336772291387, 94.73726385094538, 95.12387935051981, 56.90533656959873, 79.11773796169837, 148.06100786176066, 96.09786588211085, 74.36875695698849, 85.55216852665762, 129.94818856057879, 171.75424866937522, 76.83062315130589, 121.90183182080374, 209.2167342958944, 62.24449788064889, 157.8784335460005, 110.43431694043734, 120.2600556852227, 86.17956870515549, 121.39683119783427, 128.9839125270501, 159.1441661735522, 131.7476600604087, 110.8315985125803, 241.60085923520455, 51.245535703582924, 71.70426287316005, 185.60716578532774, 150.64193931400183, 193.81301714464868, 177.70665557184125, 74.80510367823473, 107.28618967483945, 221.4617376910851, 68.54276102004829, 94.09845826296691, 96.07661785155294, 65.55489693129856, 203.10668312005473, 152.39882903927216, 105.1806980677426, 124.6981298326123, 249.07619127002613, 119.25324898076173, 40.534022023707976, 151.8644187663117, 111.6243219368234, 128.65170346814688, 140.2625782912858]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.2966486146133804, "mean_inference_ms": 8.817939680186637, "mean_action_processing_ms": 1.4111177187046127, "mean_env_wait_ms": 1.1593808583155882, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010767936706542969, "StateBufferConnector_ms": 0.022833704948425293, "ViewRequirementAgentConnector_ms": 0.525293231010437}, "num_episodes": 18, "episode_return_max": 263.13188089001807, "episode_return_min": -8.855645797079896, "episode_return_mean": 108.95536746870071, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 208000, "num_agent_steps_trained": 208000, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 259.476468384057, "num_env_steps_trained_throughput_per_sec": 259.476468384057, "timesteps_total": 52000, "num_env_steps_sampled_lifetime": 52000, "num_agent_steps_sampled_lifetime": 208000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 208000, "timers": {"training_iteration_time_ms": 23885.72, "restore_workers_time_ms": 0.017, "training_step_time_ms": 23885.674, "sample_time_ms": 6313.075, "learn_time_ms": 17553.235, "learn_throughput": 227.878, "synch_weights_time_ms": 18.404}, "counters": {"num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 208000, "num_agent_steps_trained": 208000}, "done": false, "training_iteration": 13, "trial_id": "d163c_00000", "date": "2024-08-16_12-55-05", "timestamp": 1723793105, "time_this_iter_s": 15.419159889221191, "time_total_s": 326.2693169116974, "pid": 81201, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16b8575e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 326.2693169116974, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 27.463636363636365, "ram_util_percent": 69.85454545454546}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.5490523655578574, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.892768239974975, "policy_loss": -0.0018011641381899752, "vf_loss": 7.891611313693738, "vf_explained_var": 0.002727725486906748, "kl": 0.009860309519910003, "entropy": 1.5035761992767374, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 25515.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.7155135083450843, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.997128534569311, "policy_loss": -0.012470973428048036, "vf_loss": 9.007217833604763, "vf_explained_var": 0.031452428506164955, "kl": 0.011908406409222956, "entropy": 1.3739221079639656, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 25515.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 224000}, "env_runners": {"episode_reward_max": 263.13188089001807, "episode_reward_min": -8.855645797079896, "episode_reward_mean": 96.2355750591822, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -306.58120232085224, "predator_policy": 4.015939333574349}, "policy_reward_max": {"prey_policy": 144.19073575262104, "predator_policy": 285.81703766790395}, "policy_reward_mean": {"prey_policy": -41.362021737330764, "predator_policy": 89.47980926692188}, "custom_metrics": {}, "hist_stats": {"episode_reward": [242.8600289356589, 31.430005755064393, 84.42800842400104, 184.30265573998847, 126.18499255439652, 161.3415313677304, 115.76642854437264, 232.65469407374985, 127.51069620612425, 205.558691853541, 205.5509273797345, 125.03096497412882, 263.13188089001807, 222.8949245987314, 207.49448293354618, 161.14740107662615, 178.00775162474352, 181.02285113677135, 28.39229674099559, -2.4077506321983932, 26.578698614098943, 45.17720856154383, 67.48542736179832, 36.440620527651724, -2.3139184923163763, 102.06298953140981, 34.58596119551058, 3.3777687438951904, 81.73140415440551, 9.647690695317214, 49.84132735814753, 24.807416461134917, 106.66331297360428, 52.98962145940245, 80.84984906108294, 27.75369620459947, -8.855645797079896, 67.36569001182332, 20.175978112082024, 110.90240531754505, -2.2027696466094424, 42.17004760825959, 32.16663563513738, 86.48744278454409, 1.7489209844395983, 162.89154457777732, 48.732308367535474, 94.86527155477687, 23.702782982431824, 20.918734867902646, 25.561697153071574, 60.55488497078166, 200.46472741482563, 23.651795569693412, 40.69405007188249, 57.1495904492, 27.292457732922717, 63.928565713011885, 66.01606626645967, 51.48127543135584, 114.90923744545685, 112.69879809331859, 24.077605567331393, -4.926406872442323, 152.9607297823895, 15.447713582937682, 97.41410752817964, 28.274468532150184, 49.901176059411426, 4.072705314204755, 86.18531759548692, 46.14895511641908, 151.62921688968015, 122.36593430189555, 99.9822163641164, 236.85341456268168, 16.929933059143607, 206.78967576168222, 182.6454184251875, 148.63707060455448, 260.23320014695577, 109.63982691887298, 44.442885500364724, 180.82730459980473, 163.82030974939596, 81.21753071004554, 78.1197814208165, 128.61389962657273, 199.70231544434617, 94.46076845106393, 227.43971386819075, 40.10750886965848, 128.35654820249, 105.22050773463195, 160.71504508205481, 73.75185727247516, 196.60708691787391, 51.78610726661848, 158.08433989004956, 99.5666838093709], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [95.1642072789139, 118.46782236152195, -63.644641739930734, -18.138531579235362, 21.088874417702307, -25.109866618839977, 14.0064019072459, 97.76330089707663, 21.603076458300052, 50.979645797754415, -10.548885379931741, 66.28604865434524, 32.28684937753127, 27.48939308632299, 74.35286816841081, 134.41889274969392, 16.46784908929756, -9.087809108233266, 69.96178024451818, 102.62025077946369, 111.66193189818206, 39.17685844188128, 1.9343936237758825, -4.3250829567940094, 101.21821134022785, 132.34639742400893, 46.60035547859158, 134.22702203200544, 59.70410742252842, 101.66407700250703, 30.355091687988534, 91.0427934142315, 44.0680582178247, 56.842586571509656, 68.16593222482494, 69.91844062170668, -18.728580289506162, -8.271223595742393, -37.64515957195467, -108.70706752500837, -98.52445636796492, -63.04431183784774, -100.08608690942023, -18.49567611819856, -2.632790117546496, -161.85636321612168, -110.84350818229301, -61.870989804766566, -80.43145042658543, -85.09537116574066, -18.42943466449998, 12.079693651031047, -66.49194372719198, -99.55757831356706, -95.57913153340748, -103.54286351081248, -30.282911500971224, -47.39067171286239, -41.79197917801382, -97.14934857476848, -39.104131107008165, 1.3656219687490132, -88.52039079638288, -52.21566990456262, -3.9770394046029756, 21.58411493664936, 13.006899574394268, -80.37353652881812, -49.55752663592481, 1.126850338878765, -40.04255259263322, -118.24948601877601, -122.62895132162879, -131.3188777224053, -3.103338671057046, -23.64791146230394, -83.56644234796991, -196.85148788557845, -24.548457260463024, 6.696124398564119, -167.9125121502735, -101.55098851641108, -30.440793636745536, -243.22950364753825, -178.7295538305946, -268.006180713676, -26.93262583852857, -34.57495841073717, -243.71383253082396, -90.55236539562775, 6.69761572656888, -11.90460850723909, -31.68729484072572, -92.63698764070777, -64.95741847395718, -68.2154411137543, -177.84275271642457, -98.26287736860323, -61.34653447149946, -107.5958738620631, -75.9540148718504, -34.50736250637506, -3.598391600348986, -180.00559717274098, 103.27706987916913, -62.733267947989546, -140.5091393398684, -137.54150232039214, -108.74440863971324, -49.293996260513836, -103.4039342556437, -110.90770747169934, -74.4156946607467, -166.60459809276824, -108.93692631248096, -33.574132364885, -123.45230553920106, -60.912371919223766, -109.57697012911709, -129.83358067348797, -131.36577892922125, -106.15744137310656, -83.79635810065734, 73.54535761723295, -184.8479770479153, -127.32352248408303, -235.7948323158357, -140.65124727309635, 102.41552063636763, -131.5460842070523, -75.85119925146918, -198.70558587672645, -124.00811690924107, 31.247148322900788, -81.67801273652987, -158.70909878267304, -92.35599596415295, -115.32235508345032, -229.86388464916786, -139.83773113926586, -18.30228419018627, -55.29966921879677, -71.57141423983235, -145.7683713468838, 40.18867367408675, -157.47373854383943, 50.88880246046976, -49.11582796988466, -193.32610883067903, -23.328670609568526, 126.21073481891025, 82.00285070779681, -142.816431008652, -162.04517236766887, -132.8662557783706, 144.19073575262104, 90.09645715943866, -46.08901769304027, 66.67051590989107, -69.6794546439016, 136.7087469652195, 59.439076153506775, -123.16258492479531, 28.449336073710324, -115.07348376800185, -54.26398814627144, 142.6688502563077, -68.01893580864377, -40.40677569281223, 9.36894604411894, -142.95862338768418, 8.081944404161266, -20.833889563996895, -203.7627285616651, 31.39438068869748, -167.0403387698289, 26.67182604895238, 58.83318588755685, 22.820625001064734, -116.65496480039815, 122.13081071532228, 31.569683219815087, -50.1860663437624, -46.762080920060086, 80.04784807550075, -80.8847130133333, -15.1271944674096, -34.71110995276544, 44.28116845488918, 27.993410319130493, -29.31091181212243, -184.85376519048265, 32.58806499399414, 66.28437332155306, -26.63750127726762, -108.49704552667431, 142.86905804326256, -75.76032940073772, -53.18559548916705, -306.58120232085224], "policy_predator_policy_reward": [8.882169461544366, 20.345829833679126, 47.290351323275736, 65.92282775095474, 72.93358903341365, 15.515411591725035, 68.5170136020915, 4.015939333574349, 15.93077039652833, 37.671499901813384, 74.94222680180688, 30.662141291510178, 48.70463177895304, 7.285554301565205, 14.486327789632199, 9.396605366013395, 61.93754206533535, 58.19311415972461, 20.135712936625076, 12.840947892933967, 24.0162235301708, 30.695913509500485, 34.83394400779263, 92.58771029935424, 9.153939624793287, 20.413332500988112, 10.94868502758409, 31.118862060550324, 17.396287709641186, 28.730010798869436, 22.167771841385854, 17.58174413302026, 20.137624143157236, 56.95948269225208, 15.474298268026029, 27.464180022213675, 39.64385644822226, 15.748244178021894, 137.74863671630783, 6.19583974845678, 96.0504686458264, 92.09699817408517, 74.56300152016762, 89.19597006899492, 105.31553955789393, 126.65904113757263, 125.40169606129861, 83.75342245341267, 70.8628761221322, 92.3500269778775, 45.33275343877791, 63.07997710610086, 120.49359011176755, 80.14189312450195, 118.10553592231507, 84.39422786580013, 63.961775703641415, 95.44321166459774, 119.55593207600852, 29.033086372091063, 42.837750371838446, 44.74208612456829, 130.39417235721697, 35.14930480486339, 41.79054807569487, 47.26568936586292, 67.6258154028744, 52.730443010951866, 73.98915076716908, 55.29137459095963, 88.61213656427938, 97.43359825172935, 137.34934076855984, 107.74284247839428, 64.98269436563768, 29.1342457795467, 97.68221492107767, 202.91169342455277, 64.69394089103834, 64.06079728840548, 171.01732940996106, 96.24340161011415, 174.23805189870345, 141.60229299383988, 194.44369187999007, 284.45867829941795, 77.93361092054211, 70.06141611326775, 183.5846177696422, 152.4305011412487, 82.53390103087044, 85.56463632757719, 68.70154436352948, 104.35504648543957, 89.38114759100779, 138.65698355148038, 141.04504534454583, 158.76336772291387, 94.73726385094538, 95.12387935051981, 56.90533656959873, 79.11773796169837, 148.06100786176066, 96.09786588211085, 74.36875695698849, 85.55216852665762, 129.94818856057879, 171.75424866937522, 76.83062315130589, 121.90183182080374, 209.2167342958944, 62.24449788064889, 157.8784335460005, 110.43431694043734, 120.2600556852227, 86.17956870515549, 121.39683119783427, 128.9839125270501, 159.1441661735522, 131.7476600604087, 110.8315985125803, 241.60085923520455, 51.245535703582924, 71.70426287316005, 185.60716578532774, 150.64193931400183, 193.81301714464868, 177.70665557184125, 74.80510367823473, 107.28618967483945, 221.4617376910851, 68.54276102004829, 94.09845826296691, 96.07661785155294, 65.55489693129856, 203.10668312005473, 152.39882903927216, 105.1806980677426, 124.6981298326123, 249.07619127002613, 119.25324898076173, 40.534022023707976, 151.8644187663117, 111.6243219368234, 128.65170346814688, 140.2625782912858, 44.230576794506476, 76.36238301680402, 154.60792177608266, 162.02907402828123, 6.4869814590656825, 22.152847576909135, 185.0482868766281, 136.74324955883623, 109.88164878431247, 85.5835470031194, 52.28803029914964, 86.34994865963958, 73.90106624075177, 77.74494309781323, 39.38315465403858, 24.70222237419109, 103.15935800948209, 101.19371776047583, 107.75613061558423, 106.02422679905385, 67.79542856415252, 38.381961587988314, 162.57235953892837, 32.28577985916088, 47.520423644252915, 168.57378604931543, 114.36830589679903, 188.3480936496795, 124.13369659209634, 140.1261611156077, 57.7910712430642, 56.40623226477274, 75.14202982662017, 113.15307842377725, 42.68531039439872, 31.05390953865454, 60.425353550425086, 76.63030258305581, 65.98884462893334, 63.204568511389, 97.4895883895016, 57.569223765305296, 59.065267974322936, 29.375198333712095, 169.83380507344478, 118.08272920163549, 69.43846104278995, 28.296187559536758, 51.51964154689578, 135.40101252366466, 66.6159072166639, 24.359704030860513, 173.51644395148614, 285.81703766790395]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.197274846686372, "mean_inference_ms": 8.5561348336306, "mean_action_processing_ms": 1.3675111532783077, "mean_env_wait_ms": 1.128070021931667, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008597970008850098, "StateBufferConnector_ms": 0.015560507774353027, "ViewRequirementAgentConnector_ms": 0.3403146266937256}, "num_episodes": 27, "episode_return_max": 263.13188089001807, "episode_return_min": -8.855645797079896, "episode_return_mean": 96.2355750591822, "episodes_this_iter": 27}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 224000, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 241.4452183294641, "num_env_steps_trained_throughput_per_sec": 241.4452183294641, "timesteps_total": 56000, "num_env_steps_sampled_lifetime": 56000, "num_agent_steps_sampled_lifetime": 224000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 224000, "timers": {"training_iteration_time_ms": 23151.019, "restore_workers_time_ms": 0.016, "training_step_time_ms": 23150.973, "sample_time_ms": 6102.067, "learn_time_ms": 17030.227, "learn_throughput": 234.876, "synch_weights_time_ms": 17.696}, "counters": {"num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 224000}, "done": false, "training_iteration": 14, "trial_id": "d163c_00000", "date": "2024-08-16_12-55-22", "timestamp": 1723793122, "time_this_iter_s": 16.57082986831665, "time_total_s": 342.84014678001404, "pid": 81201, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16b857ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 342.84014678001404, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 29.395833333333332, "ram_util_percent": 70.03750000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1581744878065017, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.435227893647694, "policy_loss": -0.006342534000231397, "vf_loss": 7.438672950280407, "vf_explained_var": 0.011704806802134034, "kl": 0.009658208200742936, "entropy": 1.4883571067815105, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 27405.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.6278921805046225, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.28247161542297, "policy_loss": -0.01624445421239312, "vf_loss": 9.295369361695789, "vf_explained_var": 0.07240347587873065, "kl": 0.016733557868238727, "entropy": 1.4009358541675345, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 27405.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000}, "env_runners": {"episode_reward_max": 363.31999999999994, "episode_reward_min": -8.855645797079896, "episode_reward_mean": 114.4558701634988, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -306.58120232085224, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 190.27552961419462, "predator_policy": 285.81703766790395}, "policy_reward_mean": {"prey_policy": -31.907869734583887, "predator_policy": 89.1358048163333}, "custom_metrics": {}, "hist_stats": {"episode_reward": [28.39229674099559, -2.4077506321983932, 26.578698614098943, 45.17720856154383, 67.48542736179832, 36.440620527651724, -2.3139184923163763, 102.06298953140981, 34.58596119551058, 3.3777687438951904, 81.73140415440551, 9.647690695317214, 49.84132735814753, 24.807416461134917, 106.66331297360428, 52.98962145940245, 80.84984906108294, 27.75369620459947, -8.855645797079896, 67.36569001182332, 20.175978112082024, 110.90240531754505, -2.2027696466094424, 42.17004760825959, 32.16663563513738, 86.48744278454409, 1.7489209844395983, 162.89154457777732, 48.732308367535474, 94.86527155477687, 23.702782982431824, 20.918734867902646, 25.561697153071574, 60.55488497078166, 200.46472741482563, 23.651795569693412, 40.69405007188249, 57.1495904492, 27.292457732922717, 63.928565713011885, 66.01606626645967, 51.48127543135584, 114.90923744545685, 112.69879809331859, 24.077605567331393, -4.926406872442323, 152.9607297823895, 15.447713582937682, 97.41410752817964, 28.274468532150184, 49.901176059411426, 4.072705314204755, 86.18531759548692, 46.14895511641908, 151.62921688968015, 122.36593430189555, 99.9822163641164, 236.85341456268168, 16.929933059143607, 206.78967576168222, 182.6454184251875, 148.63707060455448, 260.23320014695577, 109.63982691887298, 44.442885500364724, 180.82730459980473, 163.82030974939596, 81.21753071004554, 78.1197814208165, 128.61389962657273, 199.70231544434617, 94.46076845106393, 227.43971386819075, 40.10750886965848, 128.35654820249, 105.22050773463195, 160.71504508205481, 73.75185727247516, 196.60708691787391, 51.78610726661848, 158.08433989004956, 99.5666838093709, 261.52151054152, 252.8218017348666, 300.5402313061944, 357.04168969693615, 251.08915772742964, 322.97299008884113, 280.4795722353579, 220.93014055966734, 281.65273423060455, 204.29005942761228, 228.65105301848845, 292.3264918945445, 218.63652598880995, 363.31999999999994, 246.09075706892952, 253.82338838584246, 201.56000000000034, 340.60032459494573], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-18.728580289506162, -8.271223595742393, -37.64515957195467, -108.70706752500837, -98.52445636796492, -63.04431183784774, -100.08608690942023, -18.49567611819856, -2.632790117546496, -161.85636321612168, -110.84350818229301, -61.870989804766566, -80.43145042658543, -85.09537116574066, -18.42943466449998, 12.079693651031047, -66.49194372719198, -99.55757831356706, -95.57913153340748, -103.54286351081248, -30.282911500971224, -47.39067171286239, -41.79197917801382, -97.14934857476848, -39.104131107008165, 1.3656219687490132, -88.52039079638288, -52.21566990456262, -3.9770394046029756, 21.58411493664936, 13.006899574394268, -80.37353652881812, -49.55752663592481, 1.126850338878765, -40.04255259263322, -118.24948601877601, -122.62895132162879, -131.3188777224053, -3.103338671057046, -23.64791146230394, -83.56644234796991, -196.85148788557845, -24.548457260463024, 6.696124398564119, -167.9125121502735, -101.55098851641108, -30.440793636745536, -243.22950364753825, -178.7295538305946, -268.006180713676, -26.93262583852857, -34.57495841073717, -243.71383253082396, -90.55236539562775, 6.69761572656888, -11.90460850723909, -31.68729484072572, -92.63698764070777, -64.95741847395718, -68.2154411137543, -177.84275271642457, -98.26287736860323, -61.34653447149946, -107.5958738620631, -75.9540148718504, -34.50736250637506, -3.598391600348986, -180.00559717274098, 103.27706987916913, -62.733267947989546, -140.5091393398684, -137.54150232039214, -108.74440863971324, -49.293996260513836, -103.4039342556437, -110.90770747169934, -74.4156946607467, -166.60459809276824, -108.93692631248096, -33.574132364885, -123.45230553920106, -60.912371919223766, -109.57697012911709, -129.83358067348797, -131.36577892922125, -106.15744137310656, -83.79635810065734, 73.54535761723295, -184.8479770479153, -127.32352248408303, -235.7948323158357, -140.65124727309635, 102.41552063636763, -131.5460842070523, -75.85119925146918, -198.70558587672645, -124.00811690924107, 31.247148322900788, -81.67801273652987, -158.70909878267304, -92.35599596415295, -115.32235508345032, -229.86388464916786, -139.83773113926586, -18.30228419018627, -55.29966921879677, -71.57141423983235, -145.7683713468838, 40.18867367408675, -157.47373854383943, 50.88880246046976, -49.11582796988466, -193.32610883067903, -23.328670609568526, 126.21073481891025, 82.00285070779681, -142.816431008652, -162.04517236766887, -132.8662557783706, 144.19073575262104, 90.09645715943866, -46.08901769304027, 66.67051590989107, -69.6794546439016, 136.7087469652195, 59.439076153506775, -123.16258492479531, 28.449336073710324, -115.07348376800185, -54.26398814627144, 142.6688502563077, -68.01893580864377, -40.40677569281223, 9.36894604411894, -142.95862338768418, 8.081944404161266, -20.833889563996895, -203.7627285616651, 31.39438068869748, -167.0403387698289, 26.67182604895238, 58.83318588755685, 22.820625001064734, -116.65496480039815, 122.13081071532228, 31.569683219815087, -50.1860663437624, -46.762080920060086, 80.04784807550075, -80.8847130133333, -15.1271944674096, -34.71110995276544, 44.28116845488918, 27.993410319130493, -29.31091181212243, -184.85376519048265, 32.58806499399414, 66.28437332155306, -26.63750127726762, -108.49704552667431, 142.86905804326256, -75.76032940073772, -53.18559548916705, -306.58120232085224, 95.02617400841226, 55.799483380624594, 166.6118076987217, -0.09507663695059243, 151.95036033819474, 134.99723761394898, 184.64690264034837, 163.75571133995786, 20.54326873673728, 139.16478105609167, 190.27552961419462, 93.8860542080862, 140.15120444478447, 113.86111479474997, 168.6127267436461, 46.55, 163.1370189282009, 97.50782548663474, 61.269368797430275, 112.93650084281552, -31.77617467278163, 130.30799683656056, 65.32836284735575, 176.89197381907422, 11.713144430032742, 109.79542822488787, 187.51529792915287, 174.80604319309248, -34.74314402687472, 152.75543272851496, 117.32277940840707, -84.5923095630105, 51.611358505687875, 138.68956548167748, 163.27050580791712, 162.37484684997952], "policy_predator_policy_reward": [39.64385644822226, 15.748244178021894, 137.74863671630783, 6.19583974845678, 96.0504686458264, 92.09699817408517, 74.56300152016762, 89.19597006899492, 105.31553955789393, 126.65904113757263, 125.40169606129861, 83.75342245341267, 70.8628761221322, 92.3500269778775, 45.33275343877791, 63.07997710610086, 120.49359011176755, 80.14189312450195, 118.10553592231507, 84.39422786580013, 63.961775703641415, 95.44321166459774, 119.55593207600852, 29.033086372091063, 42.837750371838446, 44.74208612456829, 130.39417235721697, 35.14930480486339, 41.79054807569487, 47.26568936586292, 67.6258154028744, 52.730443010951866, 73.98915076716908, 55.29137459095963, 88.61213656427938, 97.43359825172935, 137.34934076855984, 107.74284247839428, 64.98269436563768, 29.1342457795467, 97.68221492107767, 202.91169342455277, 64.69394089103834, 64.06079728840548, 171.01732940996106, 96.24340161011415, 174.23805189870345, 141.60229299383988, 194.44369187999007, 284.45867829941795, 77.93361092054211, 70.06141611326775, 183.5846177696422, 152.4305011412487, 82.53390103087044, 85.56463632757719, 68.70154436352948, 104.35504648543957, 89.38114759100779, 138.65698355148038, 141.04504534454583, 158.76336772291387, 94.73726385094538, 95.12387935051981, 56.90533656959873, 79.11773796169837, 148.06100786176066, 96.09786588211085, 74.36875695698849, 85.55216852665762, 129.94818856057879, 171.75424866937522, 76.83062315130589, 121.90183182080374, 209.2167342958944, 62.24449788064889, 157.8784335460005, 110.43431694043734, 120.2600556852227, 86.17956870515549, 121.39683119783427, 128.9839125270501, 159.1441661735522, 131.7476600604087, 110.8315985125803, 241.60085923520455, 51.245535703582924, 71.70426287316005, 185.60716578532774, 150.64193931400183, 193.81301714464868, 177.70665557184125, 74.80510367823473, 107.28618967483945, 221.4617376910851, 68.54276102004829, 94.09845826296691, 96.07661785155294, 65.55489693129856, 203.10668312005473, 152.39882903927216, 105.1806980677426, 124.6981298326123, 249.07619127002613, 119.25324898076173, 40.534022023707976, 151.8644187663117, 111.6243219368234, 128.65170346814688, 140.2625782912858, 44.230576794506476, 76.36238301680402, 154.60792177608266, 162.02907402828123, 6.4869814590656825, 22.152847576909135, 185.0482868766281, 136.74324955883623, 109.88164878431247, 85.5835470031194, 52.28803029914964, 86.34994865963958, 73.90106624075177, 77.74494309781323, 39.38315465403858, 24.70222237419109, 103.15935800948209, 101.19371776047583, 107.75613061558423, 106.02422679905385, 67.79542856415252, 38.381961587988314, 162.57235953892837, 32.28577985916088, 47.520423644252915, 168.57378604931543, 114.36830589679903, 188.3480936496795, 124.13369659209634, 140.1261611156077, 57.7910712430642, 56.40623226477274, 75.14202982662017, 113.15307842377725, 42.68531039439872, 31.05390953865454, 60.425353550425086, 76.63030258305581, 65.98884462893334, 63.204568511389, 97.4895883895016, 57.569223765305296, 59.065267974322936, 29.375198333712095, 169.83380507344478, 118.08272920163549, 69.43846104278995, 28.296187559536758, 51.51964154689578, 135.40101252366466, 66.6159072166639, 24.359704030860513, 173.51644395148614, 285.81703766790395, 15.769894192288826, 94.92595896019448, 18.78671168290849, 67.51835899018704, 10.376731482808616, 3.215901871242039, 4.715893585156066, 3.923182131473881, 60.5198455293678, 30.861262405233077, 11.59481009938456, 27.21659616717584, 20.940427116499308, 5.526825879324192, 2.4720376339717616, 3.295376182049246, 14.045554260068007, 6.96233555570112, 10.460385358044656, 19.623804429321797, 62.89649858568478, 67.22273226902466, 16.61984916372305, 33.48630606439145, 34.507599537334684, 62.62035379655463, 0.9986588777546033, 0.0, 40.849632538162616, 87.22883582912674, 125.03362661937744, 96.0592919210685, 2.4994148358431825, 8.759661176791418, 7.643886822444839, 7.311085114604229]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.1224648106669997, "mean_inference_ms": 8.351330253198427, "mean_action_processing_ms": 1.3352453605792953, "mean_env_wait_ms": 1.104174656502672, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021353602409362793, "StateBufferConnector_ms": 0.014892101287841797, "ViewRequirementAgentConnector_ms": 0.34949755668640137}, "num_episodes": 18, "episode_return_max": 363.31999999999994, "episode_return_min": -8.855645797079896, "episode_return_mean": 114.4558701634988, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 252.47667216764873, "num_env_steps_trained_throughput_per_sec": 252.47667216764873, "timesteps_total": 60000, "num_env_steps_sampled_lifetime": 60000, "num_agent_steps_sampled_lifetime": 240000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 240000, "timers": {"training_iteration_time_ms": 21808.102, "restore_workers_time_ms": 0.015, "training_step_time_ms": 21808.056, "sample_time_ms": 5830.552, "learn_time_ms": 15959.396, "learn_throughput": 250.636, "synch_weights_time_ms": 17.098}, "counters": {"num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000}, "done": false, "training_iteration": 15, "trial_id": "d163c_00000", "date": "2024-08-16_12-55-38", "timestamp": 1723793138, "time_this_iter_s": 15.847686290740967, "time_total_s": 358.687833070755, "pid": 81201, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16aff7700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 358.687833070755, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 28.5090909090909, "ram_util_percent": 70.61363636363636}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.661687547630734, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.863309673026756, "policy_loss": -0.005031613689458008, "vf_loss": 5.866251467396974, "vf_explained_var": -0.007243168259423877, "kl": 0.006966004675575686, "entropy": 1.5181268520456142, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 29295.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.194161024263927, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.515307054570112, "policy_loss": -0.005805023525910521, "vf_loss": 9.519339445911386, "vf_explained_var": -0.024136509844865747, "kl": 0.008863234274411021, "entropy": 1.4046125094095865, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 29295.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 256000, "num_agent_steps_trained": 256000}, "env_runners": {"episode_reward_max": 363.31999999999994, "episode_reward_min": -8.855645797079896, "episode_reward_mean": 158.10053716995165, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -306.58120232085224, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 190.27552961419462, "predator_policy": 285.81703766790395}, "policy_reward_mean": {"prey_policy": 0.7302157347194589, "predator_policy": 78.32005285025637}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8.855645797079896, 67.36569001182332, 20.175978112082024, 110.90240531754505, -2.2027696466094424, 42.17004760825959, 32.16663563513738, 86.48744278454409, 1.7489209844395983, 162.89154457777732, 48.732308367535474, 94.86527155477687, 23.702782982431824, 20.918734867902646, 25.561697153071574, 60.55488497078166, 200.46472741482563, 23.651795569693412, 40.69405007188249, 57.1495904492, 27.292457732922717, 63.928565713011885, 66.01606626645967, 51.48127543135584, 114.90923744545685, 112.69879809331859, 24.077605567331393, -4.926406872442323, 152.9607297823895, 15.447713582937682, 97.41410752817964, 28.274468532150184, 49.901176059411426, 4.072705314204755, 86.18531759548692, 46.14895511641908, 151.62921688968015, 122.36593430189555, 99.9822163641164, 236.85341456268168, 16.929933059143607, 206.78967576168222, 182.6454184251875, 148.63707060455448, 260.23320014695577, 109.63982691887298, 44.442885500364724, 180.82730459980473, 163.82030974939596, 81.21753071004554, 78.1197814208165, 128.61389962657273, 199.70231544434617, 94.46076845106393, 227.43971386819075, 40.10750886965848, 128.35654820249, 105.22050773463195, 160.71504508205481, 73.75185727247516, 196.60708691787391, 51.78610726661848, 158.08433989004956, 99.5666838093709, 261.52151054152, 252.8218017348666, 300.5402313061944, 357.04168969693615, 251.08915772742964, 322.97299008884113, 280.4795722353579, 220.93014055966734, 281.65273423060455, 204.29005942761228, 228.65105301848845, 292.3264918945445, 218.63652598880995, 363.31999999999994, 246.09075706892952, 253.82338838584246, 201.56000000000034, 340.60032459494573, 294.28689675143096, 250.8286176835727, 169.22006338343294, 360.92713001468513, 300.5669305542374, 262.0145740511109, 353.2025388618548, 311.8880727138753, 200.1388528422351, 263.17061793175895, 294.68000000000006, 325.43635747489395, 280.3341066394224, 268.622980437806, 324.0761981799027, 335.61517936208804, 244.73385904947557, 298.3873452335802], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-122.62895132162879, -131.3188777224053, -3.103338671057046, -23.64791146230394, -83.56644234796991, -196.85148788557845, -24.548457260463024, 6.696124398564119, -167.9125121502735, -101.55098851641108, -30.440793636745536, -243.22950364753825, -178.7295538305946, -268.006180713676, -26.93262583852857, -34.57495841073717, -243.71383253082396, -90.55236539562775, 6.69761572656888, -11.90460850723909, -31.68729484072572, -92.63698764070777, -64.95741847395718, -68.2154411137543, -177.84275271642457, -98.26287736860323, -61.34653447149946, -107.5958738620631, -75.9540148718504, -34.50736250637506, -3.598391600348986, -180.00559717274098, 103.27706987916913, -62.733267947989546, -140.5091393398684, -137.54150232039214, -108.74440863971324, -49.293996260513836, -103.4039342556437, -110.90770747169934, -74.4156946607467, -166.60459809276824, -108.93692631248096, -33.574132364885, -123.45230553920106, -60.912371919223766, -109.57697012911709, -129.83358067348797, -131.36577892922125, -106.15744137310656, -83.79635810065734, 73.54535761723295, -184.8479770479153, -127.32352248408303, -235.7948323158357, -140.65124727309635, 102.41552063636763, -131.5460842070523, -75.85119925146918, -198.70558587672645, -124.00811690924107, 31.247148322900788, -81.67801273652987, -158.70909878267304, -92.35599596415295, -115.32235508345032, -229.86388464916786, -139.83773113926586, -18.30228419018627, -55.29966921879677, -71.57141423983235, -145.7683713468838, 40.18867367408675, -157.47373854383943, 50.88880246046976, -49.11582796988466, -193.32610883067903, -23.328670609568526, 126.21073481891025, 82.00285070779681, -142.816431008652, -162.04517236766887, -132.8662557783706, 144.19073575262104, 90.09645715943866, -46.08901769304027, 66.67051590989107, -69.6794546439016, 136.7087469652195, 59.439076153506775, -123.16258492479531, 28.449336073710324, -115.07348376800185, -54.26398814627144, 142.6688502563077, -68.01893580864377, -40.40677569281223, 9.36894604411894, -142.95862338768418, 8.081944404161266, -20.833889563996895, -203.7627285616651, 31.39438068869748, -167.0403387698289, 26.67182604895238, 58.83318588755685, 22.820625001064734, -116.65496480039815, 122.13081071532228, 31.569683219815087, -50.1860663437624, -46.762080920060086, 80.04784807550075, -80.8847130133333, -15.1271944674096, -34.71110995276544, 44.28116845488918, 27.993410319130493, -29.31091181212243, -184.85376519048265, 32.58806499399414, 66.28437332155306, -26.63750127726762, -108.49704552667431, 142.86905804326256, -75.76032940073772, -53.18559548916705, -306.58120232085224, 95.02617400841226, 55.799483380624594, 166.6118076987217, -0.09507663695059243, 151.95036033819474, 134.99723761394898, 184.64690264034837, 163.75571133995786, 20.54326873673728, 139.16478105609167, 190.27552961419462, 93.8860542080862, 140.15120444478447, 113.86111479474997, 168.6127267436461, 46.55, 163.1370189282009, 97.50782548663474, 61.269368797430275, 112.93650084281552, -31.77617467278163, 130.30799683656056, 65.32836284735575, 176.89197381907422, 11.713144430032742, 109.79542822488787, 187.51529792915287, 174.80604319309248, -34.74314402687472, 152.75543272851496, 117.32277940840707, -84.5923095630105, 51.611358505687875, 138.68956548167748, 163.27050580791712, 162.37484684997952, 164.23084891122016, 99.92676805292322, 163.71148488887644, 34.71990945562656, 0.27647983585842084, 115.33154994869408, 160.52138487709917, 186.72197634576304, 152.32667527489622, 124.14021823092985, 111.25778309513265, 125.2530985125137, 163.86427121083415, 184.2890243326843, 159.90302607484585, 120.20220691827308, 115.48407478280069, 68.11966922530813, 88.33539839456037, 129.75806450207955, 152.30295053982888, 132.5056911171576, 97.24643614964046, 170.43701477885247, 113.7625284037777, 115.24726754622054, 64.40720946600501, 139.25588905843347, 130.3187661237469, 177.6068887830056, 156.00897914664253, 169.85591422752393, 37.58717075706453, 133.72809996611159, 148.57905281658614, 141.067271745354], "policy_predator_policy_reward": [137.34934076855984, 107.74284247839428, 64.98269436563768, 29.1342457795467, 97.68221492107767, 202.91169342455277, 64.69394089103834, 64.06079728840548, 171.01732940996106, 96.24340161011415, 174.23805189870345, 141.60229299383988, 194.44369187999007, 284.45867829941795, 77.93361092054211, 70.06141611326775, 183.5846177696422, 152.4305011412487, 82.53390103087044, 85.56463632757719, 68.70154436352948, 104.35504648543957, 89.38114759100779, 138.65698355148038, 141.04504534454583, 158.76336772291387, 94.73726385094538, 95.12387935051981, 56.90533656959873, 79.11773796169837, 148.06100786176066, 96.09786588211085, 74.36875695698849, 85.55216852665762, 129.94818856057879, 171.75424866937522, 76.83062315130589, 121.90183182080374, 209.2167342958944, 62.24449788064889, 157.8784335460005, 110.43431694043734, 120.2600556852227, 86.17956870515549, 121.39683119783427, 128.9839125270501, 159.1441661735522, 131.7476600604087, 110.8315985125803, 241.60085923520455, 51.245535703582924, 71.70426287316005, 185.60716578532774, 150.64193931400183, 193.81301714464868, 177.70665557184125, 74.80510367823473, 107.28618967483945, 221.4617376910851, 68.54276102004829, 94.09845826296691, 96.07661785155294, 65.55489693129856, 203.10668312005473, 152.39882903927216, 105.1806980677426, 124.6981298326123, 249.07619127002613, 119.25324898076173, 40.534022023707976, 151.8644187663117, 111.6243219368234, 128.65170346814688, 140.2625782912858, 44.230576794506476, 76.36238301680402, 154.60792177608266, 162.02907402828123, 6.4869814590656825, 22.152847576909135, 185.0482868766281, 136.74324955883623, 109.88164878431247, 85.5835470031194, 52.28803029914964, 86.34994865963958, 73.90106624075177, 77.74494309781323, 39.38315465403858, 24.70222237419109, 103.15935800948209, 101.19371776047583, 107.75613061558423, 106.02422679905385, 67.79542856415252, 38.381961587988314, 162.57235953892837, 32.28577985916088, 47.520423644252915, 168.57378604931543, 114.36830589679903, 188.3480936496795, 124.13369659209634, 140.1261611156077, 57.7910712430642, 56.40623226477274, 75.14202982662017, 113.15307842377725, 42.68531039439872, 31.05390953865454, 60.425353550425086, 76.63030258305581, 65.98884462893334, 63.204568511389, 97.4895883895016, 57.569223765305296, 59.065267974322936, 29.375198333712095, 169.83380507344478, 118.08272920163549, 69.43846104278995, 28.296187559536758, 51.51964154689578, 135.40101252366466, 66.6159072166639, 24.359704030860513, 173.51644395148614, 285.81703766790395, 15.769894192288826, 94.92595896019448, 18.78671168290849, 67.51835899018704, 10.376731482808616, 3.215901871242039, 4.715893585156066, 3.923182131473881, 60.5198455293678, 30.861262405233077, 11.59481009938456, 27.21659616717584, 20.940427116499308, 5.526825879324192, 2.4720376339717616, 3.295376182049246, 14.045554260068007, 6.96233555570112, 10.460385358044656, 19.623804429321797, 62.89649858568478, 67.22273226902466, 16.61984916372305, 33.48630606439145, 34.507599537334684, 62.62035379655463, 0.9986588777546033, 0.0, 40.849632538162616, 87.22883582912674, 125.03362661937744, 96.0592919210685, 2.4994148358431825, 8.759661176791418, 7.643886822444839, 7.311085114604229, 17.06885878157297, 13.060421005714657, 35.1858394051902, 17.21138393387949, 34.18047304695579, 19.4315605519246, 8.64350471207388, 5.040264079749128, 12.072860388257585, 12.02717666015398, 10.523187898813296, 14.980504544651158, 1.5239306936466983, 3.525312624689678, 15.114206761806235, 16.668632958950237, 10.405215968645967, 6.129892865480317, 30.973399875201512, 14.103755159917478, 6.600063726242659, 3.271294616770899, 39.44128721317771, 18.311619333223508, 24.046169767243345, 27.27814092218079, 26.1757303008226, 38.78415161254487, 8.560951875999882, 7.589591397150304, 3.11452497866973, 6.63576100925186, 23.741213311506417, 49.67737501479308, 4.801665883626939, 3.939354788013393]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.0482642015230375, "mean_inference_ms": 8.135085702925346, "mean_action_processing_ms": 1.3027233442256472, "mean_env_wait_ms": 1.0768197362983836, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02121114730834961, "StateBufferConnector_ms": 0.01384890079498291, "ViewRequirementAgentConnector_ms": 0.35691535472869873}, "num_episodes": 18, "episode_return_max": 363.31999999999994, "episode_return_min": -8.855645797079896, "episode_return_mean": 158.10053716995165, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 256000, "num_agent_steps_trained": 256000, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 236.8577143706955, "num_env_steps_trained_throughput_per_sec": 236.8577143706955, "timesteps_total": 64000, "num_env_steps_sampled_lifetime": 64000, "num_agent_steps_sampled_lifetime": 256000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 256000, "timers": {"training_iteration_time_ms": 19611.742, "restore_workers_time_ms": 0.015, "training_step_time_ms": 19611.696, "sample_time_ms": 5407.686, "learn_time_ms": 14184.817, "learn_throughput": 281.992, "synch_weights_time_ms": 18.136}, "counters": {"num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 256000, "num_agent_steps_trained": 256000}, "done": false, "training_iteration": 16, "trial_id": "d163c_00000", "date": "2024-08-16_12-55-54", "timestamp": 1723793154, "time_this_iter_s": 16.8958683013916, "time_total_s": 375.5837013721466, "pid": 81201, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16af90820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 375.5837013721466, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 30.120833333333337, "ram_util_percent": 70.54583333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.299205044148461, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.995640068710166, "policy_loss": -0.010154728990457164, "vf_loss": 4.00284259243617, "vf_explained_var": 0.0867534287392147, "kl": 0.009840670717390322, "entropy": 1.5074709589519197, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 31185.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.167738685059169, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.232917384495812, "policy_loss": -0.004050144576344383, "vf_loss": 9.23540345852968, "vf_explained_var": 0.01167615983221266, "kl": 0.007820352141557305, "entropy": 1.4129445382526942, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 31185.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 272000, "num_agent_steps_trained": 272000}, "env_runners": {"episode_reward_max": 363.31999999999994, "episode_reward_min": -4.926406872442323, "episode_reward_mean": 199.3438337193243, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -306.58120232085224, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 190.27552961419462, "predator_policy": 285.81703766790395}, "policy_reward_mean": {"prey_policy": 39.50679156429444, "predator_policy": 60.16512529536771}, "custom_metrics": {}, "hist_stats": {"episode_reward": [40.69405007188249, 57.1495904492, 27.292457732922717, 63.928565713011885, 66.01606626645967, 51.48127543135584, 114.90923744545685, 112.69879809331859, 24.077605567331393, -4.926406872442323, 152.9607297823895, 15.447713582937682, 97.41410752817964, 28.274468532150184, 49.901176059411426, 4.072705314204755, 86.18531759548692, 46.14895511641908, 151.62921688968015, 122.36593430189555, 99.9822163641164, 236.85341456268168, 16.929933059143607, 206.78967576168222, 182.6454184251875, 148.63707060455448, 260.23320014695577, 109.63982691887298, 44.442885500364724, 180.82730459980473, 163.82030974939596, 81.21753071004554, 78.1197814208165, 128.61389962657273, 199.70231544434617, 94.46076845106393, 227.43971386819075, 40.10750886965848, 128.35654820249, 105.22050773463195, 160.71504508205481, 73.75185727247516, 196.60708691787391, 51.78610726661848, 158.08433989004956, 99.5666838093709, 261.52151054152, 252.8218017348666, 300.5402313061944, 357.04168969693615, 251.08915772742964, 322.97299008884113, 280.4795722353579, 220.93014055966734, 281.65273423060455, 204.29005942761228, 228.65105301848845, 292.3264918945445, 218.63652598880995, 363.31999999999994, 246.09075706892952, 253.82338838584246, 201.56000000000034, 340.60032459494573, 294.28689675143096, 250.8286176835727, 169.22006338343294, 360.92713001468513, 300.5669305542374, 262.0145740511109, 353.2025388618548, 311.8880727138753, 200.1388528422351, 263.17061793175895, 294.68000000000006, 325.43635747489395, 280.3341066394224, 268.622980437806, 324.0761981799027, 335.61517936208804, 244.73385904947557, 298.3873452335802, 338.5361030107809, 335.44213570697127, 320.6810840202648, 146.53039787110703, 279.5647088241603, 323.4659950930604, 327.0866863243612, 224.8289470763269, 348.14892790402865, 310.36, 279.44853186278004, 194.66971003875557, 295.05357558473884, 244.12512696203302, 308.2294251088979, 283.3201099378622, 321.8785773807611, 254.2620646993112], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-108.74440863971324, -49.293996260513836, -103.4039342556437, -110.90770747169934, -74.4156946607467, -166.60459809276824, -108.93692631248096, -33.574132364885, -123.45230553920106, -60.912371919223766, -109.57697012911709, -129.83358067348797, -131.36577892922125, -106.15744137310656, -83.79635810065734, 73.54535761723295, -184.8479770479153, -127.32352248408303, -235.7948323158357, -140.65124727309635, 102.41552063636763, -131.5460842070523, -75.85119925146918, -198.70558587672645, -124.00811690924107, 31.247148322900788, -81.67801273652987, -158.70909878267304, -92.35599596415295, -115.32235508345032, -229.86388464916786, -139.83773113926586, -18.30228419018627, -55.29966921879677, -71.57141423983235, -145.7683713468838, 40.18867367408675, -157.47373854383943, 50.88880246046976, -49.11582796988466, -193.32610883067903, -23.328670609568526, 126.21073481891025, 82.00285070779681, -142.816431008652, -162.04517236766887, -132.8662557783706, 144.19073575262104, 90.09645715943866, -46.08901769304027, 66.67051590989107, -69.6794546439016, 136.7087469652195, 59.439076153506775, -123.16258492479531, 28.449336073710324, -115.07348376800185, -54.26398814627144, 142.6688502563077, -68.01893580864377, -40.40677569281223, 9.36894604411894, -142.95862338768418, 8.081944404161266, -20.833889563996895, -203.7627285616651, 31.39438068869748, -167.0403387698289, 26.67182604895238, 58.83318588755685, 22.820625001064734, -116.65496480039815, 122.13081071532228, 31.569683219815087, -50.1860663437624, -46.762080920060086, 80.04784807550075, -80.8847130133333, -15.1271944674096, -34.71110995276544, 44.28116845488918, 27.993410319130493, -29.31091181212243, -184.85376519048265, 32.58806499399414, 66.28437332155306, -26.63750127726762, -108.49704552667431, 142.86905804326256, -75.76032940073772, -53.18559548916705, -306.58120232085224, 95.02617400841226, 55.799483380624594, 166.6118076987217, -0.09507663695059243, 151.95036033819474, 134.99723761394898, 184.64690264034837, 163.75571133995786, 20.54326873673728, 139.16478105609167, 190.27552961419462, 93.8860542080862, 140.15120444478447, 113.86111479474997, 168.6127267436461, 46.55, 163.1370189282009, 97.50782548663474, 61.269368797430275, 112.93650084281552, -31.77617467278163, 130.30799683656056, 65.32836284735575, 176.89197381907422, 11.713144430032742, 109.79542822488787, 187.51529792915287, 174.80604319309248, -34.74314402687472, 152.75543272851496, 117.32277940840707, -84.5923095630105, 51.611358505687875, 138.68956548167748, 163.27050580791712, 162.37484684997952, 164.23084891122016, 99.92676805292322, 163.71148488887644, 34.71990945562656, 0.27647983585842084, 115.33154994869408, 160.52138487709917, 186.72197634576304, 152.32667527489622, 124.14021823092985, 111.25778309513265, 125.2530985125137, 163.86427121083415, 184.2890243326843, 159.90302607484585, 120.20220691827308, 115.48407478280069, 68.11966922530813, 88.33539839456037, 129.75806450207955, 152.30295053982888, 132.5056911171576, 97.24643614964046, 170.43701477885247, 113.7625284037777, 115.24726754622054, 64.40720946600501, 139.25588905843347, 130.3187661237469, 177.6068887830056, 156.00897914664253, 169.85591422752393, 37.58717075706453, 133.72809996611159, 148.57905281658614, 141.067271745354, 149.80539813911523, 165.398571919917, 175.80066431773753, 143.76852298497715, 144.34719415571078, 161.98333116401693, 1.7892743210093456, 116.28411360550774, 151.7836654966067, 115.41375793089257, 136.32335495820988, 166.76593222488412, 168.6464088830253, 133.28014944542196, 92.62598898514399, 104.81960342222084, 165.57099727398196, 160.64035456102107, 121.97816205929558, 155.46392379237741, 96.87715455398899, 156.34951863071478, 64.02381152341195, 71.32555294553582, 105.07988530029937, 148.32762179618354, 90.13033840635336, 84.63331416353535, 162.76597623967547, 45.36551594586416, 113.80060005028712, 129.47758603793494, 152.43631085264857, 167.39044142857844, 88.4307154281894, 142.47441687812318], "policy_predator_policy_reward": [76.83062315130589, 121.90183182080374, 209.2167342958944, 62.24449788064889, 157.8784335460005, 110.43431694043734, 120.2600556852227, 86.17956870515549, 121.39683119783427, 128.9839125270501, 159.1441661735522, 131.7476600604087, 110.8315985125803, 241.60085923520455, 51.245535703582924, 71.70426287316005, 185.60716578532774, 150.64193931400183, 193.81301714464868, 177.70665557184125, 74.80510367823473, 107.28618967483945, 221.4617376910851, 68.54276102004829, 94.09845826296691, 96.07661785155294, 65.55489693129856, 203.10668312005473, 152.39882903927216, 105.1806980677426, 124.6981298326123, 249.07619127002613, 119.25324898076173, 40.534022023707976, 151.8644187663117, 111.6243219368234, 128.65170346814688, 140.2625782912858, 44.230576794506476, 76.36238301680402, 154.60792177608266, 162.02907402828123, 6.4869814590656825, 22.152847576909135, 185.0482868766281, 136.74324955883623, 109.88164878431247, 85.5835470031194, 52.28803029914964, 86.34994865963958, 73.90106624075177, 77.74494309781323, 39.38315465403858, 24.70222237419109, 103.15935800948209, 101.19371776047583, 107.75613061558423, 106.02422679905385, 67.79542856415252, 38.381961587988314, 162.57235953892837, 32.28577985916088, 47.520423644252915, 168.57378604931543, 114.36830589679903, 188.3480936496795, 124.13369659209634, 140.1261611156077, 57.7910712430642, 56.40623226477274, 75.14202982662017, 113.15307842377725, 42.68531039439872, 31.05390953865454, 60.425353550425086, 76.63030258305581, 65.98884462893334, 63.204568511389, 97.4895883895016, 57.569223765305296, 59.065267974322936, 29.375198333712095, 169.83380507344478, 118.08272920163549, 69.43846104278995, 28.296187559536758, 51.51964154689578, 135.40101252366466, 66.6159072166639, 24.359704030860513, 173.51644395148614, 285.81703766790395, 15.769894192288826, 94.92595896019448, 18.78671168290849, 67.51835899018704, 10.376731482808616, 3.215901871242039, 4.715893585156066, 3.923182131473881, 60.5198455293678, 30.861262405233077, 11.59481009938456, 27.21659616717584, 20.940427116499308, 5.526825879324192, 2.4720376339717616, 3.295376182049246, 14.045554260068007, 6.96233555570112, 10.460385358044656, 19.623804429321797, 62.89649858568478, 67.22273226902466, 16.61984916372305, 33.48630606439145, 34.507599537334684, 62.62035379655463, 0.9986588777546033, 0.0, 40.849632538162616, 87.22883582912674, 125.03362661937744, 96.0592919210685, 2.4994148358431825, 8.759661176791418, 7.643886822444839, 7.311085114604229, 17.06885878157297, 13.060421005714657, 35.1858394051902, 17.21138393387949, 34.18047304695579, 19.4315605519246, 8.64350471207388, 5.040264079749128, 12.072860388257585, 12.02717666015398, 10.523187898813296, 14.980504544651158, 1.5239306936466983, 3.525312624689678, 15.114206761806235, 16.668632958950237, 10.405215968645967, 6.129892865480317, 30.973399875201512, 14.103755159917478, 6.600063726242659, 3.271294616770899, 39.44128721317771, 18.311619333223508, 24.046169767243345, 27.27814092218079, 26.1757303008226, 38.78415161254487, 8.560951875999882, 7.589591397150304, 3.11452497866973, 6.63576100925186, 23.741213311506417, 49.67737501479308, 4.801665883626939, 3.939354788013393, 14.230035318527701, 9.102097633221003, 4.5471604282940445, 11.325787975962536, 7.7549593669220815, 6.595599333615025, 17.028771914694055, 11.428238029895676, 9.067981765774483, 3.2993036308867243, 7.497865213820344, 12.878842696146224, 15.607974129137375, 9.552153866776898, 21.87722696369903, 5.506127705263413, 11.178359576919839, 10.75921649210579, 6.493643843109804, 26.424270305217256, 12.258636056313396, 13.963222621763135, 45.834447054464206, 13.485898515343848, 2.555756188022819, 39.09031230023303, 10.968281452414859, 58.39319293972965, 94.3698715618722, 5.728061361485992, 12.122986521410146, 27.918937328230424, 0.20226652811273974, 1.8495585714215608, 11.314164209732457, 12.042768183266396]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.9847353386757054, "mean_inference_ms": 7.95656817197296, "mean_action_processing_ms": 1.2758704646199237, "mean_env_wait_ms": 1.0531961922447919, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0216141939163208, "StateBufferConnector_ms": 0.013560652732849121, "ViewRequirementAgentConnector_ms": 0.36811256408691406}, "num_episodes": 18, "episode_return_max": 363.31999999999994, "episode_return_min": -4.926406872442323, "episode_return_mean": 199.3438337193243, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 272000, "num_agent_steps_trained": 272000, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 254.10169331751746, "num_env_steps_trained_throughput_per_sec": 254.10169331751746, "timesteps_total": 68000, "num_env_steps_sampled_lifetime": 68000, "num_agent_steps_sampled_lifetime": 272000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 272000, "timers": {"training_iteration_time_ms": 18303.738, "restore_workers_time_ms": 0.015, "training_step_time_ms": 18303.69, "sample_time_ms": 5044.897, "learn_time_ms": 13240.136, "learn_throughput": 302.112, "synch_weights_time_ms": 17.596}, "counters": {"num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 272000, "num_agent_steps_trained": 272000}, "done": false, "training_iteration": 17, "trial_id": "d163c_00000", "date": "2024-08-16_12-56-10", "timestamp": 1723793170, "time_this_iter_s": 15.745733976364136, "time_total_s": 391.32943534851074, "pid": 81201, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16b86d700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 391.32943534851074, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 28.87391304347826, "ram_util_percent": 70.20869565217392}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.681185716295999, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.5445132578491534, "policy_loss": -0.012588133952437491, "vf_loss": 3.552795565569842, "vf_explained_var": 0.06389157781525263, "kl": 0.014352768439751272, "entropy": 1.4964948777799254, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 33075.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.2270002869071153, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.20976280131668, "policy_loss": -0.004344054977483456, "vf_loss": 9.212064117855496, "vf_explained_var": -0.018349651022562904, "kl": 0.010213857963480698, "entropy": 1.3737536667515993, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 33075.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000}, "env_runners": {"episode_reward_max": 363.31999999999994, "episode_reward_min": 16.929933059143607, "episode_reward_mean": 243.70171832668265, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -306.58120232085224, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 190.27552961419462, "predator_policy": 285.81703766790395}, "policy_reward_mean": {"prey_policy": 83.96033474473768, "predator_policy": 37.890524418603654}, "custom_metrics": {}, "hist_stats": {"episode_reward": [16.929933059143607, 206.78967576168222, 182.6454184251875, 148.63707060455448, 260.23320014695577, 109.63982691887298, 44.442885500364724, 180.82730459980473, 163.82030974939596, 81.21753071004554, 78.1197814208165, 128.61389962657273, 199.70231544434617, 94.46076845106393, 227.43971386819075, 40.10750886965848, 128.35654820249, 105.22050773463195, 160.71504508205481, 73.75185727247516, 196.60708691787391, 51.78610726661848, 158.08433989004956, 99.5666838093709, 261.52151054152, 252.8218017348666, 300.5402313061944, 357.04168969693615, 251.08915772742964, 322.97299008884113, 280.4795722353579, 220.93014055966734, 281.65273423060455, 204.29005942761228, 228.65105301848845, 292.3264918945445, 218.63652598880995, 363.31999999999994, 246.09075706892952, 253.82338838584246, 201.56000000000034, 340.60032459494573, 294.28689675143096, 250.8286176835727, 169.22006338343294, 360.92713001468513, 300.5669305542374, 262.0145740511109, 353.2025388618548, 311.8880727138753, 200.1388528422351, 263.17061793175895, 294.68000000000006, 325.43635747489395, 280.3341066394224, 268.622980437806, 324.0761981799027, 335.61517936208804, 244.73385904947557, 298.3873452335802, 338.5361030107809, 335.44213570697127, 320.6810840202648, 146.53039787110703, 279.5647088241603, 323.4659950930604, 327.0866863243612, 224.8289470763269, 348.14892790402865, 310.36, 279.44853186278004, 194.66971003875557, 295.05357558473884, 244.12512696203302, 308.2294251088979, 283.3201099378622, 321.8785773807611, 254.2620646993112, 334.13753864103734, 256.6239840004597, 253.28044552274005, 206.4468203324605, 321.31413075423063, 236.53413566264908, 361.23418041500923, 227.35103424787536, 251.22144924261875, 182.87824595423075, 238.22698107151837, 339.2493631705841, 284.4086181477332, 264.22549474316713, 323.9073417345721, 278.68138711784786, 301.47587869860615, 305.34337017669014, 314.0424345381505, 292.0209314904264, 297.4746344274938, 210.2672561737868], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-142.816431008652, -162.04517236766887, -132.8662557783706, 144.19073575262104, 90.09645715943866, -46.08901769304027, 66.67051590989107, -69.6794546439016, 136.7087469652195, 59.439076153506775, -123.16258492479531, 28.449336073710324, -115.07348376800185, -54.26398814627144, 142.6688502563077, -68.01893580864377, -40.40677569281223, 9.36894604411894, -142.95862338768418, 8.081944404161266, -20.833889563996895, -203.7627285616651, 31.39438068869748, -167.0403387698289, 26.67182604895238, 58.83318588755685, 22.820625001064734, -116.65496480039815, 122.13081071532228, 31.569683219815087, -50.1860663437624, -46.762080920060086, 80.04784807550075, -80.8847130133333, -15.1271944674096, -34.71110995276544, 44.28116845488918, 27.993410319130493, -29.31091181212243, -184.85376519048265, 32.58806499399414, 66.28437332155306, -26.63750127726762, -108.49704552667431, 142.86905804326256, -75.76032940073772, -53.18559548916705, -306.58120232085224, 95.02617400841226, 55.799483380624594, 166.6118076987217, -0.09507663695059243, 151.95036033819474, 134.99723761394898, 184.64690264034837, 163.75571133995786, 20.54326873673728, 139.16478105609167, 190.27552961419462, 93.8860542080862, 140.15120444478447, 113.86111479474997, 168.6127267436461, 46.55, 163.1370189282009, 97.50782548663474, 61.269368797430275, 112.93650084281552, -31.77617467278163, 130.30799683656056, 65.32836284735575, 176.89197381907422, 11.713144430032742, 109.79542822488787, 187.51529792915287, 174.80604319309248, -34.74314402687472, 152.75543272851496, 117.32277940840707, -84.5923095630105, 51.611358505687875, 138.68956548167748, 163.27050580791712, 162.37484684997952, 164.23084891122016, 99.92676805292322, 163.71148488887644, 34.71990945562656, 0.27647983585842084, 115.33154994869408, 160.52138487709917, 186.72197634576304, 152.32667527489622, 124.14021823092985, 111.25778309513265, 125.2530985125137, 163.86427121083415, 184.2890243326843, 159.90302607484585, 120.20220691827308, 115.48407478280069, 68.11966922530813, 88.33539839456037, 129.75806450207955, 152.30295053982888, 132.5056911171576, 97.24643614964046, 170.43701477885247, 113.7625284037777, 115.24726754622054, 64.40720946600501, 139.25588905843347, 130.3187661237469, 177.6068887830056, 156.00897914664253, 169.85591422752393, 37.58717075706453, 133.72809996611159, 148.57905281658614, 141.067271745354, 149.80539813911523, 165.398571919917, 175.80066431773753, 143.76852298497715, 144.34719415571078, 161.98333116401693, 1.7892743210093456, 116.28411360550774, 151.7836654966067, 115.41375793089257, 136.32335495820988, 166.76593222488412, 168.6464088830253, 133.28014944542196, 92.62598898514399, 104.81960342222084, 165.57099727398196, 160.64035456102107, 121.97816205929558, 155.46392379237741, 96.87715455398899, 156.34951863071478, 64.02381152341195, 71.32555294553582, 105.07988530029937, 148.32762179618354, 90.13033840635336, 84.63331416353535, 162.76597623967547, 45.36551594586416, 113.80060005028712, 129.47758603793494, 152.43631085264857, 167.39044142857844, 88.4307154281894, 142.47441687812318, 127.52661386672578, 188.22226007175408, 89.3070590727099, 105.03071834375956, 120.57183451469592, 117.97638110676702, 78.00645444428763, 98.6566930865826, 141.39412799155735, 168.96591172153813, 115.8907046208967, 91.68845640964363, 180.92759537409984, 174.8603054436166, 54.686447632950134, 85.66015503613963, 90.81886351749955, 130.65517043643447, 81.30299284940833, 57.28161892654982, 130.96155879052316, 76.82496680652451, 119.27197475165828, 179.20623632412833, 123.2349531303775, 136.15118385612482, 22.156501250787148, 141.70799779223557, 64.71206298245585, 184.53075688811734, 105.2328118980948, 143.47769985180912, 121.37246262623869, 134.0193797998199, 108.86020143454287, 174.79263559763515, 149.6278806178832, 147.55321308473893, 96.83012412564028, 121.20590935390237, 157.80487276963268, 80.31102821331322, 65.6057304029086, 60.66728411690586], "policy_predator_policy_reward": [185.0482868766281, 136.74324955883623, 109.88164878431247, 85.5835470031194, 52.28803029914964, 86.34994865963958, 73.90106624075177, 77.74494309781323, 39.38315465403858, 24.70222237419109, 103.15935800948209, 101.19371776047583, 107.75613061558423, 106.02422679905385, 67.79542856415252, 38.381961587988314, 162.57235953892837, 32.28577985916088, 47.520423644252915, 168.57378604931543, 114.36830589679903, 188.3480936496795, 124.13369659209634, 140.1261611156077, 57.7910712430642, 56.40623226477274, 75.14202982662017, 113.15307842377725, 42.68531039439872, 31.05390953865454, 60.425353550425086, 76.63030258305581, 65.98884462893334, 63.204568511389, 97.4895883895016, 57.569223765305296, 59.065267974322936, 29.375198333712095, 169.83380507344478, 118.08272920163549, 69.43846104278995, 28.296187559536758, 51.51964154689578, 135.40101252366466, 66.6159072166639, 24.359704030860513, 173.51644395148614, 285.81703766790395, 15.769894192288826, 94.92595896019448, 18.78671168290849, 67.51835899018704, 10.376731482808616, 3.215901871242039, 4.715893585156066, 3.923182131473881, 60.5198455293678, 30.861262405233077, 11.59481009938456, 27.21659616717584, 20.940427116499308, 5.526825879324192, 2.4720376339717616, 3.295376182049246, 14.045554260068007, 6.96233555570112, 10.460385358044656, 19.623804429321797, 62.89649858568478, 67.22273226902466, 16.61984916372305, 33.48630606439145, 34.507599537334684, 62.62035379655463, 0.9986588777546033, 0.0, 40.849632538162616, 87.22883582912674, 125.03362661937744, 96.0592919210685, 2.4994148358431825, 8.759661176791418, 7.643886822444839, 7.311085114604229, 17.06885878157297, 13.060421005714657, 35.1858394051902, 17.21138393387949, 34.18047304695579, 19.4315605519246, 8.64350471207388, 5.040264079749128, 12.072860388257585, 12.02717666015398, 10.523187898813296, 14.980504544651158, 1.5239306936466983, 3.525312624689678, 15.114206761806235, 16.668632958950237, 10.405215968645967, 6.129892865480317, 30.973399875201512, 14.103755159917478, 6.600063726242659, 3.271294616770899, 39.44128721317771, 18.311619333223508, 24.046169767243345, 27.27814092218079, 26.1757303008226, 38.78415161254487, 8.560951875999882, 7.589591397150304, 3.11452497866973, 6.63576100925186, 23.741213311506417, 49.67737501479308, 4.801665883626939, 3.939354788013393, 14.230035318527701, 9.102097633221003, 4.5471604282940445, 11.325787975962536, 7.7549593669220815, 6.595599333615025, 17.028771914694055, 11.428238029895676, 9.067981765774483, 3.2993036308867243, 7.497865213820344, 12.878842696146224, 15.607974129137375, 9.552153866776898, 21.87722696369903, 5.506127705263413, 11.178359576919839, 10.75921649210579, 6.493643843109804, 26.424270305217256, 12.258636056313396, 13.963222621763135, 45.834447054464206, 13.485898515343848, 2.555756188022819, 39.09031230023303, 10.968281452414859, 58.39319293972965, 94.3698715618722, 5.728061361485992, 12.122986521410146, 27.918937328230424, 0.20226652811273974, 1.8495585714215608, 11.314164209732457, 12.042768183266396, 14.995734902754588, 3.3929297998029013, 56.30433936560773, 5.9818672183825035, 0.8262189802041255, 13.906010921072959, 16.664961962407755, 13.118710839182476, 3.728709741516644, 7.2253812996187685, 11.5470187615413, 17.407955870567495, 1.8363928638396265, 3.60988673345327, 63.55051271515431, 23.453918863631344, 7.7792307442931765, 21.968184544391434, 6.6108641454761345, 37.68277003279686, 19.457844456176776, 10.982611018293797, 1.5524825380734433, 39.218669556724166, 11.209191547941694, 13.813289613289278, 92.2045480074219, 8.156447692722466, 24.74623174512551, 49.91829011887348, 22.351141226822282, 7.619734141121674, 28.138603920278623, 17.94543235226904, 12.869978996325422, 8.820554148186721, 7.286379569417473, 9.574961266110963, 44.018952506381446, 29.965945504502294, 42.00914232773229, 17.349591116815617, 29.246677824411094, 54.7475638295613]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.9202326100111717, "mean_inference_ms": 7.771531143803095, "mean_action_processing_ms": 1.2490295503009652, "mean_env_wait_ms": 1.0300885456191589, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02148735523223877, "StateBufferConnector_ms": 0.007013440132141113, "ViewRequirementAgentConnector_ms": 0.37916553020477295}, "num_episodes": 22, "episode_return_max": 363.31999999999994, "episode_return_min": 16.929933059143607, "episode_return_mean": 243.70171832668265, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 239.4681748223916, "num_env_steps_trained_throughput_per_sec": 239.4681748223916, "timesteps_total": 72000, "num_env_steps_sampled_lifetime": 72000, "num_agent_steps_sampled_lifetime": 288000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 288000, "timers": {"training_iteration_time_ms": 17565.894, "restore_workers_time_ms": 0.015, "training_step_time_ms": 17565.847, "sample_time_ms": 4792.284, "learn_time_ms": 12756.162, "learn_throughput": 313.574, "synch_weights_time_ms": 16.408}, "counters": {"num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000}, "done": false, "training_iteration": 18, "trial_id": "d163c_00000", "date": "2024-08-16_12-56-27", "timestamp": 1723793187, "time_this_iter_s": 16.707417011260986, "time_total_s": 408.03685235977173, "pid": 81201, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16af06ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 408.03685235977173, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 30.886956521739133, "ram_util_percent": 70.27826086956522}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.318982473157701, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.434016128570314, "policy_loss": -0.014673319866969473, "vf_loss": 6.4443320145682685, "vf_explained_var": 0.09790871439787446, "kl": 0.01452475327363831, "entropy": 1.484383762072003, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 34965.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.816818008000258, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.140521880558559, "policy_loss": -0.00537908133464279, "vf_loss": 9.14417450768607, "vf_explained_var": -0.015145936970988278, "kl": 0.008632213296221302, "entropy": 1.3455656517750372, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 34965.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 304000, "num_agent_steps_trained": 304000}, "env_runners": {"episode_reward_max": 363.31999999999994, "episode_reward_min": -22.652968635536674, "episode_reward_mean": 245.14079349574516, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -306.58120232085224, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 190.27552961419462, "predator_policy": 285.81703766790395}, "policy_reward_mean": {"prey_policy": 90.69879161966973, "predator_policy": 31.871605128202862}, "custom_metrics": {}, "hist_stats": {"episode_reward": [99.5666838093709, 261.52151054152, 252.8218017348666, 300.5402313061944, 357.04168969693615, 251.08915772742964, 322.97299008884113, 280.4795722353579, 220.93014055966734, 281.65273423060455, 204.29005942761228, 228.65105301848845, 292.3264918945445, 218.63652598880995, 363.31999999999994, 246.09075706892952, 253.82338838584246, 201.56000000000034, 340.60032459494573, 294.28689675143096, 250.8286176835727, 169.22006338343294, 360.92713001468513, 300.5669305542374, 262.0145740511109, 353.2025388618548, 311.8880727138753, 200.1388528422351, 263.17061793175895, 294.68000000000006, 325.43635747489395, 280.3341066394224, 268.622980437806, 324.0761981799027, 335.61517936208804, 244.73385904947557, 298.3873452335802, 338.5361030107809, 335.44213570697127, 320.6810840202648, 146.53039787110703, 279.5647088241603, 323.4659950930604, 327.0866863243612, 224.8289470763269, 348.14892790402865, 310.36, 279.44853186278004, 194.66971003875557, 295.05357558473884, 244.12512696203302, 308.2294251088979, 283.3201099378622, 321.8785773807611, 254.2620646993112, 334.13753864103734, 256.6239840004597, 253.28044552274005, 206.4468203324605, 321.31413075423063, 236.53413566264908, 361.23418041500923, 227.35103424787536, 251.22144924261875, 182.87824595423075, 238.22698107151837, 339.2493631705841, 284.4086181477332, 264.22549474316713, 323.9073417345721, 278.68138711784786, 301.47587869860615, 305.34337017669014, 314.0424345381505, 292.0209314904264, 297.4746344274938, 210.2672561737868, 8.114278129501939, 100.3285284188501, 303.6745685556778, 98.21930115219712, 169.97705155921403, 12.703440888871633, 150.36959470406583, 214.72717226485122, 235.74526975245584, -22.652968635536674, 115.06727128248284, 235.94779358550227, 22.284943143047883, 4.987401010302648, 224.8645709204016, 43.039691792957925, 35.672157423755586, 332.9592321055971, 163.74660643107936, 334.8019135065811, 172.50737917044356, 2.738587907756188, 222.23236735904302], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-53.18559548916705, -306.58120232085224, 95.02617400841226, 55.799483380624594, 166.6118076987217, -0.09507663695059243, 151.95036033819474, 134.99723761394898, 184.64690264034837, 163.75571133995786, 20.54326873673728, 139.16478105609167, 190.27552961419462, 93.8860542080862, 140.15120444478447, 113.86111479474997, 168.6127267436461, 46.55, 163.1370189282009, 97.50782548663474, 61.269368797430275, 112.93650084281552, -31.77617467278163, 130.30799683656056, 65.32836284735575, 176.89197381907422, 11.713144430032742, 109.79542822488787, 187.51529792915287, 174.80604319309248, -34.74314402687472, 152.75543272851496, 117.32277940840707, -84.5923095630105, 51.611358505687875, 138.68956548167748, 163.27050580791712, 162.37484684997952, 164.23084891122016, 99.92676805292322, 163.71148488887644, 34.71990945562656, 0.27647983585842084, 115.33154994869408, 160.52138487709917, 186.72197634576304, 152.32667527489622, 124.14021823092985, 111.25778309513265, 125.2530985125137, 163.86427121083415, 184.2890243326843, 159.90302607484585, 120.20220691827308, 115.48407478280069, 68.11966922530813, 88.33539839456037, 129.75806450207955, 152.30295053982888, 132.5056911171576, 97.24643614964046, 170.43701477885247, 113.7625284037777, 115.24726754622054, 64.40720946600501, 139.25588905843347, 130.3187661237469, 177.6068887830056, 156.00897914664253, 169.85591422752393, 37.58717075706453, 133.72809996611159, 148.57905281658614, 141.067271745354, 149.80539813911523, 165.398571919917, 175.80066431773753, 143.76852298497715, 144.34719415571078, 161.98333116401693, 1.7892743210093456, 116.28411360550774, 151.7836654966067, 115.41375793089257, 136.32335495820988, 166.76593222488412, 168.6464088830253, 133.28014944542196, 92.62598898514399, 104.81960342222084, 165.57099727398196, 160.64035456102107, 121.97816205929558, 155.46392379237741, 96.87715455398899, 156.34951863071478, 64.02381152341195, 71.32555294553582, 105.07988530029937, 148.32762179618354, 90.13033840635336, 84.63331416353535, 162.76597623967547, 45.36551594586416, 113.80060005028712, 129.47758603793494, 152.43631085264857, 167.39044142857844, 88.4307154281894, 142.47441687812318, 127.52661386672578, 188.22226007175408, 89.3070590727099, 105.03071834375956, 120.57183451469592, 117.97638110676702, 78.00645444428763, 98.6566930865826, 141.39412799155735, 168.96591172153813, 115.8907046208967, 91.68845640964363, 180.92759537409984, 174.8603054436166, 54.686447632950134, 85.66015503613963, 90.81886351749955, 130.65517043643447, 81.30299284940833, 57.28161892654982, 130.96155879052316, 76.82496680652451, 119.27197475165828, 179.20623632412833, 123.2349531303775, 136.15118385612482, 22.156501250787148, 141.70799779223557, 64.71206298245585, 184.53075688811734, 105.2328118980948, 143.47769985180912, 121.37246262623869, 134.0193797998199, 108.86020143454287, 174.79263559763515, 149.6278806178832, 147.55321308473893, 96.83012412564028, 121.20590935390237, 157.80487276963268, 80.31102821331322, 65.6057304029086, 60.66728411690586, -75.52872242173713, -67.7445522905204, 30.07650580351934, -29.082318875651413, 136.7493259086576, 151.3920173766149, 18.91172771322692, -50.514476373843294, 61.94671795353367, 66.22832087599886, -156.8490627170045, -24.079550335387793, 62.28281963496385, 34.6805087401342, 42.14338923578848, 100.72943203771304, 70.39244268782973, 109.36226086014783, -195.31972382935442, -94.38659935708736, 59.06364822867128, -15.525934538808777, 90.70589721940368, 103.04539775957545, -118.9010458937202, -87.87131253938914, -87.76451116055905, -149.4306535695532, 118.16933477211123, 49.57923947125917, -154.30483583378577, -16.77438049958716, -146.501781360655, -51.21855091347189, 177.9300433034874, 123.19951704687904, 28.87242867674311, 59.6276766947378, 168.21225189439758, 153.8653400637711, -25.824185522229936, 49.727683947412565, -59.57107480671618, -153.06375768627584, 100.00992648529713, 55.80023178824378], "policy_predator_policy_reward": [173.51644395148614, 285.81703766790395, 15.769894192288826, 94.92595896019448, 18.78671168290849, 67.51835899018704, 10.376731482808616, 3.215901871242039, 4.715893585156066, 3.923182131473881, 60.5198455293678, 30.861262405233077, 11.59481009938456, 27.21659616717584, 20.940427116499308, 5.526825879324192, 2.4720376339717616, 3.295376182049246, 14.045554260068007, 6.96233555570112, 10.460385358044656, 19.623804429321797, 62.89649858568478, 67.22273226902466, 16.61984916372305, 33.48630606439145, 34.507599537334684, 62.62035379655463, 0.9986588777546033, 0.0, 40.849632538162616, 87.22883582912674, 125.03362661937744, 96.0592919210685, 2.4994148358431825, 8.759661176791418, 7.643886822444839, 7.311085114604229, 17.06885878157297, 13.060421005714657, 35.1858394051902, 17.21138393387949, 34.18047304695579, 19.4315605519246, 8.64350471207388, 5.040264079749128, 12.072860388257585, 12.02717666015398, 10.523187898813296, 14.980504544651158, 1.5239306936466983, 3.525312624689678, 15.114206761806235, 16.668632958950237, 10.405215968645967, 6.129892865480317, 30.973399875201512, 14.103755159917478, 6.600063726242659, 3.271294616770899, 39.44128721317771, 18.311619333223508, 24.046169767243345, 27.27814092218079, 26.1757303008226, 38.78415161254487, 8.560951875999882, 7.589591397150304, 3.11452497866973, 6.63576100925186, 23.741213311506417, 49.67737501479308, 4.801665883626939, 3.939354788013393, 14.230035318527701, 9.102097633221003, 4.5471604282940445, 11.325787975962536, 7.7549593669220815, 6.595599333615025, 17.028771914694055, 11.428238029895676, 9.067981765774483, 3.2993036308867243, 7.497865213820344, 12.878842696146224, 15.607974129137375, 9.552153866776898, 21.87722696369903, 5.506127705263413, 11.178359576919839, 10.75921649210579, 6.493643843109804, 26.424270305217256, 12.258636056313396, 13.963222621763135, 45.834447054464206, 13.485898515343848, 2.555756188022819, 39.09031230023303, 10.968281452414859, 58.39319293972965, 94.3698715618722, 5.728061361485992, 12.122986521410146, 27.918937328230424, 0.20226652811273974, 1.8495585714215608, 11.314164209732457, 12.042768183266396, 14.995734902754588, 3.3929297998029013, 56.30433936560773, 5.9818672183825035, 0.8262189802041255, 13.906010921072959, 16.664961962407755, 13.118710839182476, 3.728709741516644, 7.2253812996187685, 11.5470187615413, 17.407955870567495, 1.8363928638396265, 3.60988673345327, 63.55051271515431, 23.453918863631344, 7.7792307442931765, 21.968184544391434, 6.6108641454761345, 37.68277003279686, 19.457844456176776, 10.982611018293797, 1.5524825380734433, 39.218669556724166, 11.209191547941694, 13.813289613289278, 92.2045480074219, 8.156447692722466, 24.74623174512551, 49.91829011887348, 22.351141226822282, 7.619734141121674, 28.138603920278623, 17.94543235226904, 12.869978996325422, 8.820554148186721, 7.286379569417473, 9.574961266110963, 44.018952506381446, 29.965945504502294, 42.00914232773229, 17.349591116815617, 29.246677824411094, 54.7475638295613, 115.4809940971701, 35.90655874458941, 52.3888753963786, 46.94546609460343, 5.690354309098995, 9.842870961306321, 100.07305185830423, 29.748997954509324, 38.30168899808936, 3.500323731592213, 17.901095354520443, 175.73095858674364, 50.900600523841725, 2.505665805126033, 7.172971338358739, 64.68137965299108, 26.59474891167327, 29.395817292805418, 74.6637534458031, 192.3896011051021, 36.13641964254787, 35.393137950072415, 15.398975242264049, 26.797523364259174, 119.86813995081253, 109.18916162534472, 198.93984920764927, 43.242716532765925, 2.5665056713043777, 54.54949100572699, 24.307272528907895, 189.81163559742288, 109.26709281108872, 124.12539688679357, 16.18101468877949, 15.648657066451369, 42.68394472330078, 32.56255633629806, 6.813230161139784, 5.91109138727276, 47.76872364049222, 100.83515710476884, 88.55354947738252, 126.81987092336577, 61.96574573509697, 4.456463350405214]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.8606951539545338, "mean_inference_ms": 7.606512565945479, "mean_action_processing_ms": 1.222016487133019, "mean_env_wait_ms": 1.0053933838188234, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021723628044128418, "StateBufferConnector_ms": 0.007239699363708496, "ViewRequirementAgentConnector_ms": 0.3997666835784912}, "num_episodes": 23, "episode_return_max": 363.31999999999994, "episode_return_min": -22.652968635536674, "episode_return_mean": 245.14079349574516, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 304000, "num_agent_steps_trained": 304000, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 267.1369524274494, "num_env_steps_trained_throughput_per_sec": 267.1369524274494, "timesteps_total": 76000, "num_env_steps_sampled_lifetime": 76000, "num_agent_steps_sampled_lifetime": 304000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 304000, "timers": {"training_iteration_time_ms": 17027.461, "restore_workers_time_ms": 0.015, "training_step_time_ms": 17027.414, "sample_time_ms": 4469.684, "learn_time_ms": 12540.775, "learn_throughput": 318.96, "synch_weights_time_ms": 15.979}, "counters": {"num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 304000, "num_agent_steps_trained": 304000}, "done": false, "training_iteration": 19, "trial_id": "d163c_00000", "date": "2024-08-16_12-56-42", "timestamp": 1723793202, "time_this_iter_s": 14.979266166687012, "time_total_s": 423.01611852645874, "pid": 81201, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16aff7790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 423.01611852645874, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 27.33636363636364, "ram_util_percent": 70.00909090909092}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.307025140050858, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.97118759861699, "policy_loss": -0.01501919081010831, "vf_loss": 8.981386170563875, "vf_explained_var": 0.05204705340521676, "kl": 0.016068713020326687, "entropy": 1.4527405747660884, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 36855.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.5608534345551144, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.54499436232148, "policy_loss": -0.004999607054408265, "vf_loss": 9.547873562101334, "vf_explained_var": 0.0011365312117117422, "kl": 0.010602179559618796, "entropy": 1.362944241554018, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 36855.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000}, "env_runners": {"episode_reward_max": 361.23418041500923, "episode_reward_min": -25.260021000302917, "episode_reward_mean": 205.03098023521758, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -277.8186756404772, "predator_policy": 0.20226652811273974}, "policy_reward_max": {"prey_policy": 188.22226007175408, "predator_policy": 251.64806344908894}, "policy_reward_mean": {"prey_policy": 57.470230805908834, "predator_policy": 45.0452593117}, "custom_metrics": {}, "hist_stats": {"episode_reward": [340.60032459494573, 294.28689675143096, 250.8286176835727, 169.22006338343294, 360.92713001468513, 300.5669305542374, 262.0145740511109, 353.2025388618548, 311.8880727138753, 200.1388528422351, 263.17061793175895, 294.68000000000006, 325.43635747489395, 280.3341066394224, 268.622980437806, 324.0761981799027, 335.61517936208804, 244.73385904947557, 298.3873452335802, 338.5361030107809, 335.44213570697127, 320.6810840202648, 146.53039787110703, 279.5647088241603, 323.4659950930604, 327.0866863243612, 224.8289470763269, 348.14892790402865, 310.36, 279.44853186278004, 194.66971003875557, 295.05357558473884, 244.12512696203302, 308.2294251088979, 283.3201099378622, 321.8785773807611, 254.2620646993112, 334.13753864103734, 256.6239840004597, 253.28044552274005, 206.4468203324605, 321.31413075423063, 236.53413566264908, 361.23418041500923, 227.35103424787536, 251.22144924261875, 182.87824595423075, 238.22698107151837, 339.2493631705841, 284.4086181477332, 264.22549474316713, 323.9073417345721, 278.68138711784786, 301.47587869860615, 305.34337017669014, 314.0424345381505, 292.0209314904264, 297.4746344274938, 210.2672561737868, 8.114278129501939, 100.3285284188501, 303.6745685556778, 98.21930115219712, 169.97705155921403, 12.703440888871633, 150.36959470406583, 214.72717226485122, 235.74526975245584, -22.652968635536674, 115.06727128248284, 235.94779358550227, 22.284943143047883, 4.987401010302648, 224.8645709204016, 43.039691792957925, 35.672157423755586, 332.9592321055971, 163.74660643107936, 334.8019135065811, 172.50737917044356, 2.738587907756188, 222.23236735904302, 34.34701999014514, 12.201909973853912, 28.84480993374853, 18.809271862324856, 32.28586069128312, 70.30442360778848, 128.37046750393756, -12.255921575423216, 127.23202323900286, 82.37449593567023, 55.92153088710457, -18.347388073353034, -25.260021000302917, -5.472567348554964, 97.45430681761808, -11.089971197560176, 20.614037201721445, -10.000826786742214], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [163.27050580791712, 162.37484684997952, 164.23084891122016, 99.92676805292322, 163.71148488887644, 34.71990945562656, 0.27647983585842084, 115.33154994869408, 160.52138487709917, 186.72197634576304, 152.32667527489622, 124.14021823092985, 111.25778309513265, 125.2530985125137, 163.86427121083415, 184.2890243326843, 159.90302607484585, 120.20220691827308, 115.48407478280069, 68.11966922530813, 88.33539839456037, 129.75806450207955, 152.30295053982888, 132.5056911171576, 97.24643614964046, 170.43701477885247, 113.7625284037777, 115.24726754622054, 64.40720946600501, 139.25588905843347, 130.3187661237469, 177.6068887830056, 156.00897914664253, 169.85591422752393, 37.58717075706453, 133.72809996611159, 148.57905281658614, 141.067271745354, 149.80539813911523, 165.398571919917, 175.80066431773753, 143.76852298497715, 144.34719415571078, 161.98333116401693, 1.7892743210093456, 116.28411360550774, 151.7836654966067, 115.41375793089257, 136.32335495820988, 166.76593222488412, 168.6464088830253, 133.28014944542196, 92.62598898514399, 104.81960342222084, 165.57099727398196, 160.64035456102107, 121.97816205929558, 155.46392379237741, 96.87715455398899, 156.34951863071478, 64.02381152341195, 71.32555294553582, 105.07988530029937, 148.32762179618354, 90.13033840635336, 84.63331416353535, 162.76597623967547, 45.36551594586416, 113.80060005028712, 129.47758603793494, 152.43631085264857, 167.39044142857844, 88.4307154281894, 142.47441687812318, 127.52661386672578, 188.22226007175408, 89.3070590727099, 105.03071834375956, 120.57183451469592, 117.97638110676702, 78.00645444428763, 98.6566930865826, 141.39412799155735, 168.96591172153813, 115.8907046208967, 91.68845640964363, 180.92759537409984, 174.8603054436166, 54.686447632950134, 85.66015503613963, 90.81886351749955, 130.65517043643447, 81.30299284940833, 57.28161892654982, 130.96155879052316, 76.82496680652451, 119.27197475165828, 179.20623632412833, 123.2349531303775, 136.15118385612482, 22.156501250787148, 141.70799779223557, 64.71206298245585, 184.53075688811734, 105.2328118980948, 143.47769985180912, 121.37246262623869, 134.0193797998199, 108.86020143454287, 174.79263559763515, 149.6278806178832, 147.55321308473893, 96.83012412564028, 121.20590935390237, 157.80487276963268, 80.31102821331322, 65.6057304029086, 60.66728411690586, -75.52872242173713, -67.7445522905204, 30.07650580351934, -29.082318875651413, 136.7493259086576, 151.3920173766149, 18.91172771322692, -50.514476373843294, 61.94671795353367, 66.22832087599886, -156.8490627170045, -24.079550335387793, 62.28281963496385, 34.6805087401342, 42.14338923578848, 100.72943203771304, 70.39244268782973, 109.36226086014783, -195.31972382935442, -94.38659935708736, 59.06364822867128, -15.525934538808777, 90.70589721940368, 103.04539775957545, -118.9010458937202, -87.87131253938914, -87.76451116055905, -149.4306535695532, 118.16933477211123, 49.57923947125917, -154.30483583378577, -16.77438049958716, -146.501781360655, -51.21855091347189, 177.9300433034874, 123.19951704687904, 28.87242867674311, 59.6276766947378, 168.21225189439758, 153.8653400637711, -25.824185522229936, 49.727683947412565, -59.57107480671618, -153.06375768627584, 100.00992648529713, 55.80023178824378, -69.92464365627089, -64.3206563916074, -73.83305092379592, -51.234345126100266, -103.07009845897116, -35.84271736784405, -92.6376162026277, -163.71599692419238, -69.57035435578189, -63.721481394521106, -18.357824419718398, -45.40327434846975, 34.6771334814493, -15.091486345423158, -179.05278493727116, -158.28860310608096, -44.97127449281956, 22.631720948136042, -53.55057031627254, -55.2755725710657, -90.87845019572669, -101.29203669231323, -89.89829500826504, -103.297231782644, -135.45129637899888, -88.60339242735253, -207.25975250747763, -79.04815614124452, -122.70133940993493, -3.6297737115578355, -183.269285310843, -159.9573123166859, -144.75510885709414, -243.89228781941205, -206.95932027451738, -277.8186756404772], "policy_predator_policy_reward": [7.643886822444839, 7.311085114604229, 17.06885878157297, 13.060421005714657, 35.1858394051902, 17.21138393387949, 34.18047304695579, 19.4315605519246, 8.64350471207388, 5.040264079749128, 12.072860388257585, 12.02717666015398, 10.523187898813296, 14.980504544651158, 1.5239306936466983, 3.525312624689678, 15.114206761806235, 16.668632958950237, 10.405215968645967, 6.129892865480317, 30.973399875201512, 14.103755159917478, 6.600063726242659, 3.271294616770899, 39.44128721317771, 18.311619333223508, 24.046169767243345, 27.27814092218079, 26.1757303008226, 38.78415161254487, 8.560951875999882, 7.589591397150304, 3.11452497866973, 6.63576100925186, 23.741213311506417, 49.67737501479308, 4.801665883626939, 3.939354788013393, 14.230035318527701, 9.102097633221003, 4.5471604282940445, 11.325787975962536, 7.7549593669220815, 6.595599333615025, 17.028771914694055, 11.428238029895676, 9.067981765774483, 3.2993036308867243, 7.497865213820344, 12.878842696146224, 15.607974129137375, 9.552153866776898, 21.87722696369903, 5.506127705263413, 11.178359576919839, 10.75921649210579, 6.493643843109804, 26.424270305217256, 12.258636056313396, 13.963222621763135, 45.834447054464206, 13.485898515343848, 2.555756188022819, 39.09031230023303, 10.968281452414859, 58.39319293972965, 94.3698715618722, 5.728061361485992, 12.122986521410146, 27.918937328230424, 0.20226652811273974, 1.8495585714215608, 11.314164209732457, 12.042768183266396, 14.995734902754588, 3.3929297998029013, 56.30433936560773, 5.9818672183825035, 0.8262189802041255, 13.906010921072959, 16.664961962407755, 13.118710839182476, 3.728709741516644, 7.2253812996187685, 11.5470187615413, 17.407955870567495, 1.8363928638396265, 3.60988673345327, 63.55051271515431, 23.453918863631344, 7.7792307442931765, 21.968184544391434, 6.6108641454761345, 37.68277003279686, 19.457844456176776, 10.982611018293797, 1.5524825380734433, 39.218669556724166, 11.209191547941694, 13.813289613289278, 92.2045480074219, 8.156447692722466, 24.74623174512551, 49.91829011887348, 22.351141226822282, 7.619734141121674, 28.138603920278623, 17.94543235226904, 12.869978996325422, 8.820554148186721, 7.286379569417473, 9.574961266110963, 44.018952506381446, 29.965945504502294, 42.00914232773229, 17.349591116815617, 29.246677824411094, 54.7475638295613, 115.4809940971701, 35.90655874458941, 52.3888753963786, 46.94546609460343, 5.690354309098995, 9.842870961306321, 100.07305185830423, 29.748997954509324, 38.30168899808936, 3.500323731592213, 17.901095354520443, 175.73095858674364, 50.900600523841725, 2.505665805126033, 7.172971338358739, 64.68137965299108, 26.59474891167327, 29.395817292805418, 74.6637534458031, 192.3896011051021, 36.13641964254787, 35.393137950072415, 15.398975242264049, 26.797523364259174, 119.86813995081253, 109.18916162534472, 198.93984920764927, 43.242716532765925, 2.5665056713043777, 54.54949100572699, 24.307272528907895, 189.81163559742288, 109.26709281108872, 124.12539688679357, 16.18101468877949, 15.648657066451369, 42.68394472330078, 32.56255633629806, 6.813230161139784, 5.91109138727276, 47.76872364049222, 100.83515710476884, 88.55354947738252, 126.81987092336577, 61.96574573509697, 4.456463350405214, 88.83916484465978, 79.75315519336374, 69.31808007240568, 67.95122595134437, 115.47773350649345, 52.27989225407024, 121.09144686696574, 154.07143812217916, 84.13144248867994, 81.44625395290615, 100.52411530482951, 33.54140707114706, 13.111326420187329, 95.67349394772425, 116.78613781417319, 208.29932865375588, 85.96049302806385, 63.61108375562267, 94.6425941465901, 96.55804467641843, 94.76887314147676, 153.32314463366757, 114.91873983482579, 59.92939888273025, 58.53836082032657, 140.256306985722, 210.91090670412504, 69.92443459604215, 113.31790269678372, 110.46751724232716, 155.9826549200859, 176.1539715098827, 179.010088327656, 230.25134555057167, 223.12910567916325, 251.64806344908894]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.818031866377629, "mean_inference_ms": 7.485675957779981, "mean_action_processing_ms": 1.2035207420768586, "mean_env_wait_ms": 0.9889890122468035, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008993268013000488, "StateBufferConnector_ms": 0.007290959358215332, "ViewRequirementAgentConnector_ms": 0.41447949409484863}, "num_episodes": 18, "episode_return_max": 361.23418041500923, "episode_return_min": -25.260021000302917, "episode_return_mean": 205.03098023521758, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 259.30408945738355, "num_env_steps_trained_throughput_per_sec": 259.30408945738355, "timesteps_total": 80000, "num_env_steps_sampled_lifetime": 80000, "num_agent_steps_sampled_lifetime": 320000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 320000, "timers": {"training_iteration_time_ms": 16026.963, "restore_workers_time_ms": 0.014, "training_step_time_ms": 16026.916, "sample_time_ms": 4221.1, "learn_time_ms": 11788.937, "learn_throughput": 339.301, "synch_weights_time_ms": 15.906}, "counters": {"num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000}, "done": false, "training_iteration": 20, "trial_id": "d163c_00000", "date": "2024-08-16_12-56-57", "timestamp": 1723793217, "time_this_iter_s": 15.429808855056763, "time_total_s": 438.4459273815155, "pid": 81201, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16b8570d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 438.4459273815155, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 27.440909090909088, "ram_util_percent": 69.5590909090909}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.8125720592560592, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.316669752736571, "policy_loss": -0.007559317351619481, "vf_loss": 9.321870669107588, "vf_explained_var": 0.004183698804290206, "kl": 0.007861392268204908, "entropy": 1.4568935487636183, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 38745.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.503721235195796, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.626435157735513, "policy_loss": -0.004349119377090896, "vf_loss": 9.62959929975883, "vf_explained_var": -0.01897204243947589, "kl": 0.005924938478835779, "entropy": 1.3820952157494883, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 38745.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000}, "env_runners": {"episode_reward_max": 361.23418041500923, "episode_reward_min": -25.260021000302917, "episode_reward_mean": 157.60189066815522, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -296.697328710637, "predator_policy": 0.20226652811273974}, "policy_reward_max": {"prey_policy": 188.22226007175408, "predator_policy": 357.7741146958226}, "policy_reward_mean": {"prey_policy": 7.966615857670486, "predator_policy": 70.83432947640716}, "custom_metrics": {}, "hist_stats": {"episode_reward": [298.3873452335802, 338.5361030107809, 335.44213570697127, 320.6810840202648, 146.53039787110703, 279.5647088241603, 323.4659950930604, 327.0866863243612, 224.8289470763269, 348.14892790402865, 310.36, 279.44853186278004, 194.66971003875557, 295.05357558473884, 244.12512696203302, 308.2294251088979, 283.3201099378622, 321.8785773807611, 254.2620646993112, 334.13753864103734, 256.6239840004597, 253.28044552274005, 206.4468203324605, 321.31413075423063, 236.53413566264908, 361.23418041500923, 227.35103424787536, 251.22144924261875, 182.87824595423075, 238.22698107151837, 339.2493631705841, 284.4086181477332, 264.22549474316713, 323.9073417345721, 278.68138711784786, 301.47587869860615, 305.34337017669014, 314.0424345381505, 292.0209314904264, 297.4746344274938, 210.2672561737868, 8.114278129501939, 100.3285284188501, 303.6745685556778, 98.21930115219712, 169.97705155921403, 12.703440888871633, 150.36959470406583, 214.72717226485122, 235.74526975245584, -22.652968635536674, 115.06727128248284, 235.94779358550227, 22.284943143047883, 4.987401010302648, 224.8645709204016, 43.039691792957925, 35.672157423755586, 332.9592321055971, 163.74660643107936, 334.8019135065811, 172.50737917044356, 2.738587907756188, 222.23236735904302, 34.34701999014514, 12.201909973853912, 28.84480993374853, 18.809271862324856, 32.28586069128312, 70.30442360778848, 128.37046750393756, -12.255921575423216, 127.23202323900286, 82.37449593567023, 55.92153088710457, -18.347388073353034, -25.260021000302917, -5.472567348554964, 97.45430681761808, -11.089971197560176, 20.614037201721445, -10.000826786742214, -9.100591435065521, 31.87467131071368, 213.3006665651555, -10.242872943327969, 27.42069997794071, -13.375762290784396, 4.994866684681007, 22.24201034311754, 128.05121668379277, -0.496760237671094, -4.762121166463025, 45.62839237431287, 15.376990004919914, -20.736716563867684, -1.216813927935831, 21.800103461570934, -8.42981816710371, -4.893816853494712], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [148.57905281658614, 141.067271745354, 149.80539813911523, 165.398571919917, 175.80066431773753, 143.76852298497715, 144.34719415571078, 161.98333116401693, 1.7892743210093456, 116.28411360550774, 151.7836654966067, 115.41375793089257, 136.32335495820988, 166.76593222488412, 168.6464088830253, 133.28014944542196, 92.62598898514399, 104.81960342222084, 165.57099727398196, 160.64035456102107, 121.97816205929558, 155.46392379237741, 96.87715455398899, 156.34951863071478, 64.02381152341195, 71.32555294553582, 105.07988530029937, 148.32762179618354, 90.13033840635336, 84.63331416353535, 162.76597623967547, 45.36551594586416, 113.80060005028712, 129.47758603793494, 152.43631085264857, 167.39044142857844, 88.4307154281894, 142.47441687812318, 127.52661386672578, 188.22226007175408, 89.3070590727099, 105.03071834375956, 120.57183451469592, 117.97638110676702, 78.00645444428763, 98.6566930865826, 141.39412799155735, 168.96591172153813, 115.8907046208967, 91.68845640964363, 180.92759537409984, 174.8603054436166, 54.686447632950134, 85.66015503613963, 90.81886351749955, 130.65517043643447, 81.30299284940833, 57.28161892654982, 130.96155879052316, 76.82496680652451, 119.27197475165828, 179.20623632412833, 123.2349531303775, 136.15118385612482, 22.156501250787148, 141.70799779223557, 64.71206298245585, 184.53075688811734, 105.2328118980948, 143.47769985180912, 121.37246262623869, 134.0193797998199, 108.86020143454287, 174.79263559763515, 149.6278806178832, 147.55321308473893, 96.83012412564028, 121.20590935390237, 157.80487276963268, 80.31102821331322, 65.6057304029086, 60.66728411690586, -75.52872242173713, -67.7445522905204, 30.07650580351934, -29.082318875651413, 136.7493259086576, 151.3920173766149, 18.91172771322692, -50.514476373843294, 61.94671795353367, 66.22832087599886, -156.8490627170045, -24.079550335387793, 62.28281963496385, 34.6805087401342, 42.14338923578848, 100.72943203771304, 70.39244268782973, 109.36226086014783, -195.31972382935442, -94.38659935708736, 59.06364822867128, -15.525934538808777, 90.70589721940368, 103.04539775957545, -118.9010458937202, -87.87131253938914, -87.76451116055905, -149.4306535695532, 118.16933477211123, 49.57923947125917, -154.30483583378577, -16.77438049958716, -146.501781360655, -51.21855091347189, 177.9300433034874, 123.19951704687904, 28.87242867674311, 59.6276766947378, 168.21225189439758, 153.8653400637711, -25.824185522229936, 49.727683947412565, -59.57107480671618, -153.06375768627584, 100.00992648529713, 55.80023178824378, -69.92464365627089, -64.3206563916074, -73.83305092379592, -51.234345126100266, -103.07009845897116, -35.84271736784405, -92.6376162026277, -163.71599692419238, -69.57035435578189, -63.721481394521106, -18.357824419718398, -45.40327434846975, 34.6771334814493, -15.091486345423158, -179.05278493727116, -158.28860310608096, -44.97127449281956, 22.631720948136042, -53.55057031627254, -55.2755725710657, -90.87845019572669, -101.29203669231323, -89.89829500826504, -103.297231782644, -135.45129637899888, -88.60339242735253, -207.25975250747763, -79.04815614124452, -122.70133940993493, -3.6297737115578355, -183.269285310843, -159.9573123166859, -144.75510885709414, -243.89228781941205, -206.95932027451738, -277.8186756404772, -252.07343696255904, -235.91472015835296, -263.9234668885381, -163.71662755719777, -227.02879034787347, 142.28397758148813, -156.50039633310703, -145.6913155091758, -71.15539336499116, -135.06336163040808, -137.27234800463043, -109.09835046516625, -236.85779270076705, -105.08435716879326, -72.37223132127043, -19.733697752461197, -10.708801360196341, -28.430705022935054, -164.7376516572578, -147.7265980069607, -113.98160555152518, -285.4609818103724, -126.3447047093755, -96.0012789716098, -230.7976442799877, -188.58954684071313, -255.92325291466972, -180.23010563487418, -140.90863048122162, -77.96934465811421, -281.44085931858604, -122.11454749253652, -89.64565446084266, -136.7693800778335, -152.75198751079023, -296.697328710637], "policy_predator_policy_reward": [4.801665883626939, 3.939354788013393, 14.230035318527701, 9.102097633221003, 4.5471604282940445, 11.325787975962536, 7.7549593669220815, 6.595599333615025, 17.028771914694055, 11.428238029895676, 9.067981765774483, 3.2993036308867243, 7.497865213820344, 12.878842696146224, 15.607974129137375, 9.552153866776898, 21.87722696369903, 5.506127705263413, 11.178359576919839, 10.75921649210579, 6.493643843109804, 26.424270305217256, 12.258636056313396, 13.963222621763135, 45.834447054464206, 13.485898515343848, 2.555756188022819, 39.09031230023303, 10.968281452414859, 58.39319293972965, 94.3698715618722, 5.728061361485992, 12.122986521410146, 27.918937328230424, 0.20226652811273974, 1.8495585714215608, 11.314164209732457, 12.042768183266396, 14.995734902754588, 3.3929297998029013, 56.30433936560773, 5.9818672183825035, 0.8262189802041255, 13.906010921072959, 16.664961962407755, 13.118710839182476, 3.728709741516644, 7.2253812996187685, 11.5470187615413, 17.407955870567495, 1.8363928638396265, 3.60988673345327, 63.55051271515431, 23.453918863631344, 7.7792307442931765, 21.968184544391434, 6.6108641454761345, 37.68277003279686, 19.457844456176776, 10.982611018293797, 1.5524825380734433, 39.218669556724166, 11.209191547941694, 13.813289613289278, 92.2045480074219, 8.156447692722466, 24.74623174512551, 49.91829011887348, 22.351141226822282, 7.619734141121674, 28.138603920278623, 17.94543235226904, 12.869978996325422, 8.820554148186721, 7.286379569417473, 9.574961266110963, 44.018952506381446, 29.965945504502294, 42.00914232773229, 17.349591116815617, 29.246677824411094, 54.7475638295613, 115.4809940971701, 35.90655874458941, 52.3888753963786, 46.94546609460343, 5.690354309098995, 9.842870961306321, 100.07305185830423, 29.748997954509324, 38.30168899808936, 3.500323731592213, 17.901095354520443, 175.73095858674364, 50.900600523841725, 2.505665805126033, 7.172971338358739, 64.68137965299108, 26.59474891167327, 29.395817292805418, 74.6637534458031, 192.3896011051021, 36.13641964254787, 35.393137950072415, 15.398975242264049, 26.797523364259174, 119.86813995081253, 109.18916162534472, 198.93984920764927, 43.242716532765925, 2.5665056713043777, 54.54949100572699, 24.307272528907895, 189.81163559742288, 109.26709281108872, 124.12539688679357, 16.18101468877949, 15.648657066451369, 42.68394472330078, 32.56255633629806, 6.813230161139784, 5.91109138727276, 47.76872364049222, 100.83515710476884, 88.55354947738252, 126.81987092336577, 61.96574573509697, 4.456463350405214, 88.83916484465978, 79.75315519336374, 69.31808007240568, 67.95122595134437, 115.47773350649345, 52.27989225407024, 121.09144686696574, 154.07143812217916, 84.13144248867994, 81.44625395290615, 100.52411530482951, 33.54140707114706, 13.111326420187329, 95.67349394772425, 116.78613781417319, 208.29932865375588, 85.96049302806385, 63.61108375562267, 94.6425941465901, 96.55804467641843, 94.76887314147676, 153.32314463366757, 114.91873983482579, 59.92939888273025, 58.53836082032657, 140.256306985722, 210.91090670412504, 69.92443459604215, 113.31790269678372, 110.46751724232716, 155.9826549200859, 176.1539715098827, 179.010088327656, 230.25134555057167, 223.12910567916325, 251.64806344908894, 202.126455299818, 276.7611103860285, 101.74065106062619, 357.7741146958226, 152.68348996910223, 145.36198936243895, 137.22639183788962, 154.7224470610654, 48.62692329989606, 185.0125316734437, 104.24509957153012, 128.7498366074821, 132.92612005193843, 214.01089650230287, 46.89881322121803, 67.44912619563118, 95.65215117735478, 71.53857188956937, 102.65720138537978, 209.31028804116738, 138.97655925972154, 255.7039069357131, 82.39723055257035, 185.577145502728, 171.79403594200986, 262.97014518361107, 251.78993837926458, 163.6267036064114, 154.2115796022364, 63.44958160916338, 141.72129042823437, 283.634219844459, 108.39801546198416, 109.58720090958826, 235.91341972046126, 208.6420796474714]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.7798850198150746, "mean_inference_ms": 7.378359668407063, "mean_action_processing_ms": 1.1863199783280989, "mean_env_wait_ms": 0.9746710653103162, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00899505615234375, "StateBufferConnector_ms": 0.007369399070739746, "ViewRequirementAgentConnector_ms": 0.3996192216873169}, "num_episodes": 18, "episode_return_max": 361.23418041500923, "episode_return_min": -25.260021000302917, "episode_return_mean": 157.60189066815522, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 253.72955487800775, "num_env_steps_trained_throughput_per_sec": 253.72955487800775, "timesteps_total": 84000, "num_env_steps_sampled_lifetime": 84000, "num_agent_steps_sampled_lifetime": 336000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 336000, "timers": {"training_iteration_time_ms": 15881.041, "restore_workers_time_ms": 0.014, "training_step_time_ms": 15880.994, "sample_time_ms": 4035.164, "learn_time_ms": 11828.942, "learn_throughput": 338.154, "synch_weights_time_ms": 15.899}, "counters": {"num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000}, "done": false, "training_iteration": 21, "trial_id": "d163c_00000", "date": "2024-08-16_12-57-13", "timestamp": 1723793233, "time_this_iter_s": 15.76908802986145, "time_total_s": 454.21501541137695, "pid": 81201, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16b857550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 454.21501541137695, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 27.599999999999998, "ram_util_percent": 69.22727272727273}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5925118566505492, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.536058140305615, "policy_loss": -0.00516160390538129, "vf_loss": 9.539458436309976, "vf_explained_var": -0.010660836999378507, "kl": 0.005870949366229255, "entropy": 1.4412770032882691, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 40635.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.1061227296395275, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.699130642098725, "policy_loss": -0.004550827763205956, "vf_loss": 9.702146833409708, "vf_explained_var": 0.003142922359799582, "kl": 0.007673215896153201, "entropy": 1.384500226015767, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 40635.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 352000, "num_agent_steps_trained": 352000}, "env_runners": {"episode_reward_max": 361.23418041500923, "episode_reward_min": -55.220078776865314, "episode_reward_mean": 108.04092126425854, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -345.3551833756164, "predator_policy": 0.8262189802041255}, "policy_reward_max": {"prey_policy": 188.22226007175408, "predator_policy": 357.7741146958226}, "policy_reward_mean": {"prey_policy": -50.595569704136594, "predator_policy": 104.61603033626588}, "custom_metrics": {}, "hist_stats": {"episode_reward": [254.2620646993112, 334.13753864103734, 256.6239840004597, 253.28044552274005, 206.4468203324605, 321.31413075423063, 236.53413566264908, 361.23418041500923, 227.35103424787536, 251.22144924261875, 182.87824595423075, 238.22698107151837, 339.2493631705841, 284.4086181477332, 264.22549474316713, 323.9073417345721, 278.68138711784786, 301.47587869860615, 305.34337017669014, 314.0424345381505, 292.0209314904264, 297.4746344274938, 210.2672561737868, 8.114278129501939, 100.3285284188501, 303.6745685556778, 98.21930115219712, 169.97705155921403, 12.703440888871633, 150.36959470406583, 214.72717226485122, 235.74526975245584, -22.652968635536674, 115.06727128248284, 235.94779358550227, 22.284943143047883, 4.987401010302648, 224.8645709204016, 43.039691792957925, 35.672157423755586, 332.9592321055971, 163.74660643107936, 334.8019135065811, 172.50737917044356, 2.738587907756188, 222.23236735904302, 34.34701999014514, 12.201909973853912, 28.84480993374853, 18.809271862324856, 32.28586069128312, 70.30442360778848, 128.37046750393756, -12.255921575423216, 127.23202323900286, 82.37449593567023, 55.92153088710457, -18.347388073353034, -25.260021000302917, -5.472567348554964, 97.45430681761808, -11.089971197560176, 20.614037201721445, -10.000826786742214, -9.100591435065521, 31.87467131071368, 213.3006665651555, -10.242872943327969, 27.42069997794071, -13.375762290784396, 4.994866684681007, 22.24201034311754, 128.05121668379277, -0.496760237671094, -4.762121166463025, 45.62839237431287, 15.376990004919914, -20.736716563867684, -1.216813927935831, 21.800103461570934, -8.42981816710371, -4.893816853494712, -0.17533147727081488, -27.301718570499233, 81.72316019234025, 15.919235951442436, 95.22034746148509, -55.220078776865314, 35.86771784609195, 7.032088066546601, 29.498702483563346, -8.610839698588821, 14.632166773705537, 14.943564511652326, 29.3395194152312, -6.442242089240318, 29.821013545406316, -9.735582640872387, -13.90063406939351, -8.9506413739311], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [88.4307154281894, 142.47441687812318, 127.52661386672578, 188.22226007175408, 89.3070590727099, 105.03071834375956, 120.57183451469592, 117.97638110676702, 78.00645444428763, 98.6566930865826, 141.39412799155735, 168.96591172153813, 115.8907046208967, 91.68845640964363, 180.92759537409984, 174.8603054436166, 54.686447632950134, 85.66015503613963, 90.81886351749955, 130.65517043643447, 81.30299284940833, 57.28161892654982, 130.96155879052316, 76.82496680652451, 119.27197475165828, 179.20623632412833, 123.2349531303775, 136.15118385612482, 22.156501250787148, 141.70799779223557, 64.71206298245585, 184.53075688811734, 105.2328118980948, 143.47769985180912, 121.37246262623869, 134.0193797998199, 108.86020143454287, 174.79263559763515, 149.6278806178832, 147.55321308473893, 96.83012412564028, 121.20590935390237, 157.80487276963268, 80.31102821331322, 65.6057304029086, 60.66728411690586, -75.52872242173713, -67.7445522905204, 30.07650580351934, -29.082318875651413, 136.7493259086576, 151.3920173766149, 18.91172771322692, -50.514476373843294, 61.94671795353367, 66.22832087599886, -156.8490627170045, -24.079550335387793, 62.28281963496385, 34.6805087401342, 42.14338923578848, 100.72943203771304, 70.39244268782973, 109.36226086014783, -195.31972382935442, -94.38659935708736, 59.06364822867128, -15.525934538808777, 90.70589721940368, 103.04539775957545, -118.9010458937202, -87.87131253938914, -87.76451116055905, -149.4306535695532, 118.16933477211123, 49.57923947125917, -154.30483583378577, -16.77438049958716, -146.501781360655, -51.21855091347189, 177.9300433034874, 123.19951704687904, 28.87242867674311, 59.6276766947378, 168.21225189439758, 153.8653400637711, -25.824185522229936, 49.727683947412565, -59.57107480671618, -153.06375768627584, 100.00992648529713, 55.80023178824378, -69.92464365627089, -64.3206563916074, -73.83305092379592, -51.234345126100266, -103.07009845897116, -35.84271736784405, -92.6376162026277, -163.71599692419238, -69.57035435578189, -63.721481394521106, -18.357824419718398, -45.40327434846975, 34.6771334814493, -15.091486345423158, -179.05278493727116, -158.28860310608096, -44.97127449281956, 22.631720948136042, -53.55057031627254, -55.2755725710657, -90.87845019572669, -101.29203669231323, -89.89829500826504, -103.297231782644, -135.45129637899888, -88.60339242735253, -207.25975250747763, -79.04815614124452, -122.70133940993493, -3.6297737115578355, -183.269285310843, -159.9573123166859, -144.75510885709414, -243.89228781941205, -206.95932027451738, -277.8186756404772, -252.07343696255904, -235.91472015835296, -263.9234668885381, -163.71662755719777, -227.02879034787347, 142.28397758148813, -156.50039633310703, -145.6913155091758, -71.15539336499116, -135.06336163040808, -137.27234800463043, -109.09835046516625, -236.85779270076705, -105.08435716879326, -72.37223132127043, -19.733697752461197, -10.708801360196341, -28.430705022935054, -164.7376516572578, -147.7265980069607, -113.98160555152518, -285.4609818103724, -126.3447047093755, -96.0012789716098, -230.7976442799877, -188.58954684071313, -255.92325291466972, -180.23010563487418, -140.90863048122162, -77.96934465811421, -281.44085931858604, -122.11454749253652, -89.64565446084266, -136.7693800778335, -152.75198751079023, -296.697328710637, -286.7769110601572, -147.80741826702655, -254.962573756616, -239.05269872814046, -171.86729087228636, -187.53967238526175, -238.3326092358707, -210.53541631738204, -345.3551833756164, -161.96087032490843, -185.45207783200905, -149.02799554640706, -227.6287857932322, -147.47993226774284, -140.19823608535188, -323.5962653770658, -250.11956483792488, -232.2528376173444, -110.2226976203164, -153.41622492731463, -215.33160606098056, -121.70695585041376, -78.66977670749492, -161.851008128488, -122.40654287375708, -225.78969984306525, -270.19469943635295, -198.68444382616832, -190.62370115969762, -122.5431878251547, -297.6016609326875, -200.07548546063842, -193.79818157401237, -102.11540417725004, -199.8804476759938, -237.4597265232578], "policy_predator_policy_reward": [11.314164209732457, 12.042768183266396, 14.995734902754588, 3.3929297998029013, 56.30433936560773, 5.9818672183825035, 0.8262189802041255, 13.906010921072959, 16.664961962407755, 13.118710839182476, 3.728709741516644, 7.2253812996187685, 11.5470187615413, 17.407955870567495, 1.8363928638396265, 3.60988673345327, 63.55051271515431, 23.453918863631344, 7.7792307442931765, 21.968184544391434, 6.6108641454761345, 37.68277003279686, 19.457844456176776, 10.982611018293797, 1.5524825380734433, 39.218669556724166, 11.209191547941694, 13.813289613289278, 92.2045480074219, 8.156447692722466, 24.74623174512551, 49.91829011887348, 22.351141226822282, 7.619734141121674, 28.138603920278623, 17.94543235226904, 12.869978996325422, 8.820554148186721, 7.286379569417473, 9.574961266110963, 44.018952506381446, 29.965945504502294, 42.00914232773229, 17.349591116815617, 29.246677824411094, 54.7475638295613, 115.4809940971701, 35.90655874458941, 52.3888753963786, 46.94546609460343, 5.690354309098995, 9.842870961306321, 100.07305185830423, 29.748997954509324, 38.30168899808936, 3.500323731592213, 17.901095354520443, 175.73095858674364, 50.900600523841725, 2.505665805126033, 7.172971338358739, 64.68137965299108, 26.59474891167327, 29.395817292805418, 74.6637534458031, 192.3896011051021, 36.13641964254787, 35.393137950072415, 15.398975242264049, 26.797523364259174, 119.86813995081253, 109.18916162534472, 198.93984920764927, 43.242716532765925, 2.5665056713043777, 54.54949100572699, 24.307272528907895, 189.81163559742288, 109.26709281108872, 124.12539688679357, 16.18101468877949, 15.648657066451369, 42.68394472330078, 32.56255633629806, 6.813230161139784, 5.91109138727276, 47.76872364049222, 100.83515710476884, 88.55354947738252, 126.81987092336577, 61.96574573509697, 4.456463350405214, 88.83916484465978, 79.75315519336374, 69.31808007240568, 67.95122595134437, 115.47773350649345, 52.27989225407024, 121.09144686696574, 154.07143812217916, 84.13144248867994, 81.44625395290615, 100.52411530482951, 33.54140707114706, 13.111326420187329, 95.67349394772425, 116.78613781417319, 208.29932865375588, 85.96049302806385, 63.61108375562267, 94.6425941465901, 96.55804467641843, 94.76887314147676, 153.32314463366757, 114.91873983482579, 59.92939888273025, 58.53836082032657, 140.256306985722, 210.91090670412504, 69.92443459604215, 113.31790269678372, 110.46751724232716, 155.9826549200859, 176.1539715098827, 179.010088327656, 230.25134555057167, 223.12910567916325, 251.64806344908894, 202.126455299818, 276.7611103860285, 101.74065106062619, 357.7741146958226, 152.68348996910223, 145.36198936243895, 137.22639183788962, 154.7224470610654, 48.62692329989606, 185.0125316734437, 104.24509957153012, 128.7498366074821, 132.92612005193843, 214.01089650230287, 46.89881322121803, 67.44912619563118, 95.65215117735478, 71.53857188956937, 102.65720138537978, 209.31028804116738, 138.97655925972154, 255.7039069357131, 82.39723055257035, 185.577145502728, 171.79403594200986, 262.97014518361107, 251.78993837926458, 163.6267036064114, 154.2115796022364, 63.44958160916338, 141.72129042823437, 283.634219844459, 108.39801546198416, 109.58720090958826, 235.91341972046126, 208.6420796474714, 238.28382128026394, 196.12517656964894, 222.49590292013158, 244.21765099412542, 208.17538209228124, 232.9547413576069, 210.87871604295628, 253.90854546173887, 260.27989429281695, 342.25650686919283, 180.8509137584845, 98.4090808430662, 206.26020445557833, 204.71623145148845, 252.22246661146582, 218.60412291749864, 285.40620755156357, 226.46489738726936, 132.3924666087347, 122.63561624030773, 227.43357400164143, 124.23715468345841, 84.04864253905326, 171.41570680858194, 162.58801645441847, 214.9477456776352, 248.2275910853691, 214.209310087912, 191.19754318741008, 151.7903593428487, 306.07323199400884, 181.86833175844473, 184.7521566233151, 97.2607950585537, 223.5817710274918, 204.807761797829]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.7456705480324413, "mean_inference_ms": 7.272526919380454, "mean_action_processing_ms": 1.169397679245519, "mean_env_wait_ms": 0.9611454886099886, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008264780044555664, "StateBufferConnector_ms": 0.007265448570251465, "ViewRequirementAgentConnector_ms": 0.3862016201019287}, "num_episodes": 18, "episode_return_max": 361.23418041500923, "episode_return_min": -55.220078776865314, "episode_return_mean": 108.04092126425854, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 352000, "num_agent_steps_trained": 352000, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 231.23774248656196, "num_env_steps_trained_throughput_per_sec": 231.23774248656196, "timesteps_total": 88000, "num_env_steps_sampled_lifetime": 88000, "num_agent_steps_sampled_lifetime": 352000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 352000, "timers": {"training_iteration_time_ms": 16062.142, "restore_workers_time_ms": 0.014, "training_step_time_ms": 16062.096, "sample_time_ms": 4034.603, "learn_time_ms": 12010.826, "learn_throughput": 333.033, "synch_weights_time_ms": 15.682}, "counters": {"num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 352000, "num_agent_steps_trained": 352000}, "done": false, "training_iteration": 22, "trial_id": "d163c_00000", "date": "2024-08-16_12-57-31", "timestamp": 1723793251, "time_this_iter_s": 17.302546739578247, "time_total_s": 471.5175621509552, "pid": 81201, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16b879ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 471.5175621509552, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 29.224000000000004, "ram_util_percent": 69.904}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6798086824555876, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.356825396623561, "policy_loss": -0.006484465143598971, "vf_loss": 9.360640891140731, "vf_explained_var": -0.0162814303365334, "kl": 0.008896565960704868, "entropy": 1.4060684489825415, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 42525.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.0140325692911, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.449061648555533, "policy_loss": -0.008172983439422394, "vf_loss": 9.455291861074942, "vf_explained_var": 0.0007751442452587148, "kl": 0.00971388039446749, "entropy": 1.4055011291983266, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 42525.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 368000, "num_agent_steps_trained": 368000}, "env_runners": {"episode_reward_max": 334.8019135065811, "episode_reward_min": -55.220078776865314, "episode_reward_mean": 49.185433981679346, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -439.17637443321695, "predator_policy": 2.505665805126033}, "policy_reward_max": {"prey_policy": 177.9300433034874, "predator_policy": 433.27589795189095}, "policy_reward_mean": {"prey_policy": -139.34163875364612, "predator_policy": 163.9343557444858}, "custom_metrics": {}, "hist_stats": {"episode_reward": [169.97705155921403, 12.703440888871633, 150.36959470406583, 214.72717226485122, 235.74526975245584, -22.652968635536674, 115.06727128248284, 235.94779358550227, 22.284943143047883, 4.987401010302648, 224.8645709204016, 43.039691792957925, 35.672157423755586, 332.9592321055971, 163.74660643107936, 334.8019135065811, 172.50737917044356, 2.738587907756188, 222.23236735904302, 34.34701999014514, 12.201909973853912, 28.84480993374853, 18.809271862324856, 32.28586069128312, 70.30442360778848, 128.37046750393756, -12.255921575423216, 127.23202323900286, 82.37449593567023, 55.92153088710457, -18.347388073353034, -25.260021000302917, -5.472567348554964, 97.45430681761808, -11.089971197560176, 20.614037201721445, -10.000826786742214, -9.100591435065521, 31.87467131071368, 213.3006665651555, -10.242872943327969, 27.42069997794071, -13.375762290784396, 4.994866684681007, 22.24201034311754, 128.05121668379277, -0.496760237671094, -4.762121166463025, 45.62839237431287, 15.376990004919914, -20.736716563867684, -1.216813927935831, 21.800103461570934, -8.42981816710371, -4.893816853494712, -0.17533147727081488, -27.301718570499233, 81.72316019234025, 15.919235951442436, 95.22034746148509, -55.220078776865314, 35.86771784609195, 7.032088066546601, 29.498702483563346, -8.610839698588821, 14.632166773705537, 14.943564511652326, 29.3395194152312, -6.442242089240318, 29.821013545406316, -9.735582640872387, -13.90063406939351, -8.9506413739311, 20.36614453247006, 20.86947047463135, 27.923193331751, 1.6352230802790488, 40.74698348085871, 1.9062038473793592, -2.398694293625624, 8.692166561096942, 85.86039525446195, -15.135584651571627, 23.131367105883776, 116.82469580172595, 26.09207357115738, 13.378662116234844, 66.15589252452222, 177.52736117893215, 81.63142362175945, 13.010000000000005, 34.19540475614631, 23.010320388918657, 17.425864736347368, 37.01874441786715, 12.175370007954662, 70.25737267361185, 35.79178854890205, 6.806683393554063, 14.497142500255844], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [61.94671795353367, 66.22832087599886, -156.8490627170045, -24.079550335387793, 62.28281963496385, 34.6805087401342, 42.14338923578848, 100.72943203771304, 70.39244268782973, 109.36226086014783, -195.31972382935442, -94.38659935708736, 59.06364822867128, -15.525934538808777, 90.70589721940368, 103.04539775957545, -118.9010458937202, -87.87131253938914, -87.76451116055905, -149.4306535695532, 118.16933477211123, 49.57923947125917, -154.30483583378577, -16.77438049958716, -146.501781360655, -51.21855091347189, 177.9300433034874, 123.19951704687904, 28.87242867674311, 59.6276766947378, 168.21225189439758, 153.8653400637711, -25.824185522229936, 49.727683947412565, -59.57107480671618, -153.06375768627584, 100.00992648529713, 55.80023178824378, -69.92464365627089, -64.3206563916074, -73.83305092379592, -51.234345126100266, -103.07009845897116, -35.84271736784405, -92.6376162026277, -163.71599692419238, -69.57035435578189, -63.721481394521106, -18.357824419718398, -45.40327434846975, 34.6771334814493, -15.091486345423158, -179.05278493727116, -158.28860310608096, -44.97127449281956, 22.631720948136042, -53.55057031627254, -55.2755725710657, -90.87845019572669, -101.29203669231323, -89.89829500826504, -103.297231782644, -135.45129637899888, -88.60339242735253, -207.25975250747763, -79.04815614124452, -122.70133940993493, -3.6297737115578355, -183.269285310843, -159.9573123166859, -144.75510885709414, -243.89228781941205, -206.95932027451738, -277.8186756404772, -252.07343696255904, -235.91472015835296, -263.9234668885381, -163.71662755719777, -227.02879034787347, 142.28397758148813, -156.50039633310703, -145.6913155091758, -71.15539336499116, -135.06336163040808, -137.27234800463043, -109.09835046516625, -236.85779270076705, -105.08435716879326, -72.37223132127043, -19.733697752461197, -10.708801360196341, -28.430705022935054, -164.7376516572578, -147.7265980069607, -113.98160555152518, -285.4609818103724, -126.3447047093755, -96.0012789716098, -230.7976442799877, -188.58954684071313, -255.92325291466972, -180.23010563487418, -140.90863048122162, -77.96934465811421, -281.44085931858604, -122.11454749253652, -89.64565446084266, -136.7693800778335, -152.75198751079023, -296.697328710637, -286.7769110601572, -147.80741826702655, -254.962573756616, -239.05269872814046, -171.86729087228636, -187.53967238526175, -238.3326092358707, -210.53541631738204, -345.3551833756164, -161.96087032490843, -185.45207783200905, -149.02799554640706, -227.6287857932322, -147.47993226774284, -140.19823608535188, -323.5962653770658, -250.11956483792488, -232.2528376173444, -110.2226976203164, -153.41622492731463, -215.33160606098056, -121.70695585041376, -78.66977670749492, -161.851008128488, -122.40654287375708, -225.78969984306525, -270.19469943635295, -198.68444382616832, -190.62370115969762, -122.5431878251547, -297.6016609326875, -200.07548546063842, -193.79818157401237, -102.11540417725004, -199.8804476759938, -237.4597265232578, -221.5588548810905, -255.83194440022785, -392.6985816404194, -119.5887149462912, -149.3052409551865, -214.20921568549318, -335.1996090933988, -124.56454640763668, -323.10925520631264, -239.96844165403195, -136.8196401494788, -140.5579799352641, -234.35043426906782, -187.40254606063044, -261.38931528507015, -154.47464267154731, -267.7186048522578, -226.33780696703053, -252.93145526739912, -234.25767946305092, -192.89503004154204, -163.64444894630046, -359.10430066838956, -13.86024278373466, -347.24359109861126, -357.6425671380642, -319.40441137206153, -369.61445308075525, -137.0047311928902, -86.13908735762557, 54.270308896779554, -292.69646625638705, -311.3849151070723, -105.2114117726448, -288.2656399822814, -172.2851378097004, -128.91854217574212, -439.17637443321695, -157.5440333274301, -147.26033610278867, -220.81364643426875, -290.9149887596605, -99.72593324549271, -360.56492310344936, -168.61882554230104, -258.85052022705486, -112.82538621048954, -408.1777143874107, -225.04361758741365, -188.16876518406872, -250.8488558032719, -327.0010563086281, -306.36959204447277, -233.27563344238513], "policy_predator_policy_reward": [38.30168899808936, 3.500323731592213, 17.901095354520443, 175.73095858674364, 50.900600523841725, 2.505665805126033, 7.172971338358739, 64.68137965299108, 26.59474891167327, 29.395817292805418, 74.6637534458031, 192.3896011051021, 36.13641964254787, 35.393137950072415, 15.398975242264049, 26.797523364259174, 119.86813995081253, 109.18916162534472, 198.93984920764927, 43.242716532765925, 2.5665056713043777, 54.54949100572699, 24.307272528907895, 189.81163559742288, 109.26709281108872, 124.12539688679357, 16.18101468877949, 15.648657066451369, 42.68394472330078, 32.56255633629806, 6.813230161139784, 5.91109138727276, 47.76872364049222, 100.83515710476884, 88.55354947738252, 126.81987092336577, 61.96574573509697, 4.456463350405214, 88.83916484465978, 79.75315519336374, 69.31808007240568, 67.95122595134437, 115.47773350649345, 52.27989225407024, 121.09144686696574, 154.07143812217916, 84.13144248867994, 81.44625395290615, 100.52411530482951, 33.54140707114706, 13.111326420187329, 95.67349394772425, 116.78613781417319, 208.29932865375588, 85.96049302806385, 63.61108375562267, 94.6425941465901, 96.55804467641843, 94.76887314147676, 153.32314463366757, 114.91873983482579, 59.92939888273025, 58.53836082032657, 140.256306985722, 210.91090670412504, 69.92443459604215, 113.31790269678372, 110.46751724232716, 155.9826549200859, 176.1539715098827, 179.010088327656, 230.25134555057167, 223.12910567916325, 251.64806344908894, 202.126455299818, 276.7611103860285, 101.74065106062619, 357.7741146958226, 152.68348996910223, 145.36198936243895, 137.22639183788962, 154.7224470610654, 48.62692329989606, 185.0125316734437, 104.24509957153012, 128.7498366074821, 132.92612005193843, 214.01089650230287, 46.89881322121803, 67.44912619563118, 95.65215117735478, 71.53857188956937, 102.65720138537978, 209.31028804116738, 138.97655925972154, 255.7039069357131, 82.39723055257035, 185.577145502728, 171.79403594200986, 262.97014518361107, 251.78993837926458, 163.6267036064114, 154.2115796022364, 63.44958160916338, 141.72129042823437, 283.634219844459, 108.39801546198416, 109.58720090958826, 235.91341972046126, 208.6420796474714, 238.28382128026394, 196.12517656964894, 222.49590292013158, 244.21765099412542, 208.17538209228124, 232.9547413576069, 210.87871604295628, 253.90854546173887, 260.27989429281695, 342.25650686919283, 180.8509137584845, 98.4090808430662, 206.26020445557833, 204.71623145148845, 252.22246661146582, 218.60412291749864, 285.40620755156357, 226.46489738726936, 132.3924666087347, 122.63561624030773, 227.43357400164143, 124.23715468345841, 84.04864253905326, 171.41570680858194, 162.58801645441847, 214.9477456776352, 248.2275910853691, 214.209310087912, 191.19754318741008, 151.7903593428487, 306.07323199400884, 181.86833175844473, 184.7521566233151, 97.2607950585537, 223.5817710274918, 204.807761797829, 217.1954711964996, 280.56147261728876, 277.62935782865804, 255.52740923268323, 178.4801979811466, 212.95745199128424, 252.56211341085194, 208.83726517046264, 301.99865885504056, 301.82602148616303, 164.89292512070625, 114.39089881141598, 182.26807292861415, 237.08621310745855, 222.71854179332374, 201.8375827243907, 286.4183052946266, 293.4985017791243, 249.45573872636564, 222.59781135251265, 200.78616349621333, 178.88468259751306, 247.8867975751401, 241.9024416787098, 433.27589795189095, 297.70233385594156, 384.87518035320613, 317.5223462158455, 118.66064842634036, 170.6390626486977, 191.5519328357343, 224.40158570280616, 296.4338097866896, 201.7939407147867, 288.2756399822814, 185.28513780970036, 226.8393066540861, 375.45101471101947, 163.9215495040754, 163.89314031506208, 180.69406688258948, 348.4604330476873, 265.9500789432925, 231.35952182351645, 196.56790013880024, 243.07681563851014, 321.1803258164534, 270.0801474550582, 268.91346904538153, 180.0907022750029, 246.40173662012515, 338.25485888532904, 307.32964617438324, 246.81272181273047]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.7020996095072847, "mean_inference_ms": 7.144580881056, "mean_action_processing_ms": 1.1480129559051526, "mean_env_wait_ms": 0.9457066298709647, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008620977401733398, "StateBufferConnector_ms": 0.0072470903396606445, "ViewRequirementAgentConnector_ms": 0.3619283437728882}, "num_episodes": 27, "episode_return_max": 334.8019135065811, "episode_return_min": -55.220078776865314, "episode_return_mean": 49.185433981679346, "episodes_this_iter": 27}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 368000, "num_agent_steps_trained": 368000, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 246.6873130276279, "num_env_steps_trained_throughput_per_sec": 246.6873130276279, "timesteps_total": 92000, "num_env_steps_sampled_lifetime": 92000, "num_agent_steps_sampled_lifetime": 368000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 368000, "timers": {"training_iteration_time_ms": 16142.062, "restore_workers_time_ms": 0.014, "training_step_time_ms": 16142.016, "sample_time_ms": 4068.982, "learn_time_ms": 12056.341, "learn_throughput": 331.776, "synch_weights_time_ms": 15.707}, "counters": {"num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 368000, "num_agent_steps_trained": 368000}, "done": false, "training_iteration": 23, "trial_id": "d163c_00000", "date": "2024-08-16_12-57-47", "timestamp": 1723793267, "time_this_iter_s": 16.21948480606079, "time_total_s": 487.737046957016, "pid": 81201, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16b879f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 487.737046957016, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 28.286956521739132, "ram_util_percent": 70.19565217391305}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.7196912197051224, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.358138818589468, "policy_loss": -0.0027462854508369687, "vf_loss": 9.358738906295212, "vf_explained_var": -0.00609579360674298, "kl": 0.007154014974397431, "entropy": 1.404713291655142, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 44415.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.9419536926758982, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.04248317082723, "policy_loss": -0.008440417325414874, "vf_loss": 9.048507584970464, "vf_explained_var": -0.0009548890212225536, "kl": 0.012079944406621378, "entropy": 1.4465797059119694, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 44415.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000}, "env_runners": {"episode_reward_max": 222.23236735904302, "episode_reward_min": -55.220078776865314, "episode_reward_mean": 30.40642111668619, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -439.17637443321695, "predator_policy": 4.456463350405214}, "policy_reward_max": {"prey_policy": 142.28397758148813, "predator_policy": 433.27589795189095}, "policy_reward_mean": {"prey_policy": -181.25740212550852, "predator_policy": 196.46061268385162}, "custom_metrics": {}, "hist_stats": {"episode_reward": [222.23236735904302, 34.34701999014514, 12.201909973853912, 28.84480993374853, 18.809271862324856, 32.28586069128312, 70.30442360778848, 128.37046750393756, -12.255921575423216, 127.23202323900286, 82.37449593567023, 55.92153088710457, -18.347388073353034, -25.260021000302917, -5.472567348554964, 97.45430681761808, -11.089971197560176, 20.614037201721445, -10.000826786742214, -9.100591435065521, 31.87467131071368, 213.3006665651555, -10.242872943327969, 27.42069997794071, -13.375762290784396, 4.994866684681007, 22.24201034311754, 128.05121668379277, -0.496760237671094, -4.762121166463025, 45.62839237431287, 15.376990004919914, -20.736716563867684, -1.216813927935831, 21.800103461570934, -8.42981816710371, -4.893816853494712, -0.17533147727081488, -27.301718570499233, 81.72316019234025, 15.919235951442436, 95.22034746148509, -55.220078776865314, 35.86771784609195, 7.032088066546601, 29.498702483563346, -8.610839698588821, 14.632166773705537, 14.943564511652326, 29.3395194152312, -6.442242089240318, 29.821013545406316, -9.735582640872387, -13.90063406939351, -8.9506413739311, 20.36614453247006, 20.86947047463135, 27.923193331751, 1.6352230802790488, 40.74698348085871, 1.9062038473793592, -2.398694293625624, 8.692166561096942, 85.86039525446195, -15.135584651571627, 23.131367105883776, 116.82469580172595, 26.09207357115738, 13.378662116234844, 66.15589252452222, 177.52736117893215, 81.63142362175945, 13.010000000000005, 34.19540475614631, 23.010320388918657, 17.425864736347368, 37.01874441786715, 12.175370007954662, 70.25737267361185, 35.79178854890205, 6.806683393554063, 14.497142500255844, 56.709048588454294, 15.110830852768837, 14.496515268836035, 0.9919435448473881, 93.73996708506962, 26.428240716014376, -18.635201514399853, 48.10709383128276, -8.25536228437759, 29.715382802353073, 74.97308329834296, 62.834612874904685, 37.92676536163566, 19.902941987805313, 28.944949178279014, 45.81525305429953, 7.724548220587501, 35.05520944781059], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [100.00992648529713, 55.80023178824378, -69.92464365627089, -64.3206563916074, -73.83305092379592, -51.234345126100266, -103.07009845897116, -35.84271736784405, -92.6376162026277, -163.71599692419238, -69.57035435578189, -63.721481394521106, -18.357824419718398, -45.40327434846975, 34.6771334814493, -15.091486345423158, -179.05278493727116, -158.28860310608096, -44.97127449281956, 22.631720948136042, -53.55057031627254, -55.2755725710657, -90.87845019572669, -101.29203669231323, -89.89829500826504, -103.297231782644, -135.45129637899888, -88.60339242735253, -207.25975250747763, -79.04815614124452, -122.70133940993493, -3.6297737115578355, -183.269285310843, -159.9573123166859, -144.75510885709414, -243.89228781941205, -206.95932027451738, -277.8186756404772, -252.07343696255904, -235.91472015835296, -263.9234668885381, -163.71662755719777, -227.02879034787347, 142.28397758148813, -156.50039633310703, -145.6913155091758, -71.15539336499116, -135.06336163040808, -137.27234800463043, -109.09835046516625, -236.85779270076705, -105.08435716879326, -72.37223132127043, -19.733697752461197, -10.708801360196341, -28.430705022935054, -164.7376516572578, -147.7265980069607, -113.98160555152518, -285.4609818103724, -126.3447047093755, -96.0012789716098, -230.7976442799877, -188.58954684071313, -255.92325291466972, -180.23010563487418, -140.90863048122162, -77.96934465811421, -281.44085931858604, -122.11454749253652, -89.64565446084266, -136.7693800778335, -152.75198751079023, -296.697328710637, -286.7769110601572, -147.80741826702655, -254.962573756616, -239.05269872814046, -171.86729087228636, -187.53967238526175, -238.3326092358707, -210.53541631738204, -345.3551833756164, -161.96087032490843, -185.45207783200905, -149.02799554640706, -227.6287857932322, -147.47993226774284, -140.19823608535188, -323.5962653770658, -250.11956483792488, -232.2528376173444, -110.2226976203164, -153.41622492731463, -215.33160606098056, -121.70695585041376, -78.66977670749492, -161.851008128488, -122.40654287375708, -225.78969984306525, -270.19469943635295, -198.68444382616832, -190.62370115969762, -122.5431878251547, -297.6016609326875, -200.07548546063842, -193.79818157401237, -102.11540417725004, -199.8804476759938, -237.4597265232578, -221.5588548810905, -255.83194440022785, -392.6985816404194, -119.5887149462912, -149.3052409551865, -214.20921568549318, -335.1996090933988, -124.56454640763668, -323.10925520631264, -239.96844165403195, -136.8196401494788, -140.5579799352641, -234.35043426906782, -187.40254606063044, -261.38931528507015, -154.47464267154731, -267.7186048522578, -226.33780696703053, -252.93145526739912, -234.25767946305092, -192.89503004154204, -163.64444894630046, -359.10430066838956, -13.86024278373466, -347.24359109861126, -357.6425671380642, -319.40441137206153, -369.61445308075525, -137.0047311928902, -86.13908735762557, 54.270308896779554, -292.69646625638705, -311.3849151070723, -105.2114117726448, -288.2656399822814, -172.2851378097004, -128.91854217574212, -439.17637443321695, -157.5440333274301, -147.26033610278867, -220.81364643426875, -290.9149887596605, -99.72593324549271, -360.56492310344936, -168.61882554230104, -258.85052022705486, -112.82538621048954, -408.1777143874107, -225.04361758741365, -188.16876518406872, -250.8488558032719, -327.0010563086281, -306.36959204447277, -233.27563344238513, -19.92395404990494, -139.6829979000447, -366.1226568498448, -298.11600304393164, -261.98321390542304, -276.57053574358554, -202.70136568165702, -286.1325628016066, -139.46071098665422, -49.87044731882751, -253.5641654769094, -220.15186774527675, -248.82465495402315, -208.11250675462097, -283.3114214154101, -229.72048535038016, -263.13816051032944, -317.2640457554772, -362.88072768259747, -151.86137233253098, -245.7343723394061, -174.64268563354548, -190.77452223753227, -245.95993745551678, -57.74027553708715, -286.99798463568953, -233.0773212753437, -325.3463969414445, -83.82221252406613, -132.39858190314192, -296.91650940722496, -365.65582085594986, -159.6540089000873, -212.7757709562478, -256.14352651712767, -343.74150045306396], "policy_predator_policy_reward": [61.96574573509697, 4.456463350405214, 88.83916484465978, 79.75315519336374, 69.31808007240568, 67.95122595134437, 115.47773350649345, 52.27989225407024, 121.09144686696574, 154.07143812217916, 84.13144248867994, 81.44625395290615, 100.52411530482951, 33.54140707114706, 13.111326420187329, 95.67349394772425, 116.78613781417319, 208.29932865375588, 85.96049302806385, 63.61108375562267, 94.6425941465901, 96.55804467641843, 94.76887314147676, 153.32314463366757, 114.91873983482579, 59.92939888273025, 58.53836082032657, 140.256306985722, 210.91090670412504, 69.92443459604215, 113.31790269678372, 110.46751724232716, 155.9826549200859, 176.1539715098827, 179.010088327656, 230.25134555057167, 223.12910567916325, 251.64806344908894, 202.126455299818, 276.7611103860285, 101.74065106062619, 357.7741146958226, 152.68348996910223, 145.36198936243895, 137.22639183788962, 154.7224470610654, 48.62692329989606, 185.0125316734437, 104.24509957153012, 128.7498366074821, 132.92612005193843, 214.01089650230287, 46.89881322121803, 67.44912619563118, 95.65215117735478, 71.53857188956937, 102.65720138537978, 209.31028804116738, 138.97655925972154, 255.7039069357131, 82.39723055257035, 185.577145502728, 171.79403594200986, 262.97014518361107, 251.78993837926458, 163.6267036064114, 154.2115796022364, 63.44958160916338, 141.72129042823437, 283.634219844459, 108.39801546198416, 109.58720090958826, 235.91341972046126, 208.6420796474714, 238.28382128026394, 196.12517656964894, 222.49590292013158, 244.21765099412542, 208.17538209228124, 232.9547413576069, 210.87871604295628, 253.90854546173887, 260.27989429281695, 342.25650686919283, 180.8509137584845, 98.4090808430662, 206.26020445557833, 204.71623145148845, 252.22246661146582, 218.60412291749864, 285.40620755156357, 226.46489738726936, 132.3924666087347, 122.63561624030773, 227.43357400164143, 124.23715468345841, 84.04864253905326, 171.41570680858194, 162.58801645441847, 214.9477456776352, 248.2275910853691, 214.209310087912, 191.19754318741008, 151.7903593428487, 306.07323199400884, 181.86833175844473, 184.7521566233151, 97.2607950585537, 223.5817710274918, 204.807761797829, 217.1954711964996, 280.56147261728876, 277.62935782865804, 255.52740923268323, 178.4801979811466, 212.95745199128424, 252.56211341085194, 208.83726517046264, 301.99865885504056, 301.82602148616303, 164.89292512070625, 114.39089881141598, 182.26807292861415, 237.08621310745855, 222.71854179332374, 201.8375827243907, 286.4183052946266, 293.4985017791243, 249.45573872636564, 222.59781135251265, 200.78616349621333, 178.88468259751306, 247.8867975751401, 241.9024416787098, 433.27589795189095, 297.70233385594156, 384.87518035320613, 317.5223462158455, 118.66064842634036, 170.6390626486977, 191.5519328357343, 224.40158570280616, 296.4338097866896, 201.7939407147867, 288.2756399822814, 185.28513780970036, 226.8393066540861, 375.45101471101947, 163.9215495040754, 163.89314031506208, 180.69406688258948, 348.4604330476873, 265.9500789432925, 231.35952182351645, 196.56790013880024, 243.07681563851014, 321.1803258164534, 270.0801474550582, 268.91346904538153, 180.0907022750029, 246.40173662012515, 338.25485888532904, 307.32964617438324, 246.81272181273047, 121.2817174066755, 95.03428313172837, 343.9777425920646, 335.37174815448026, 344.8041788370561, 208.24608608078802, 243.97980157319932, 245.8460704549119, 129.12858453936767, 153.9425408511833, 198.95874803010247, 301.1855259080974, 300.8118769637982, 137.49008323044623, 292.9211598572961, 268.2178407397764, 285.7439136928518, 286.40293028857667, 322.40910890910664, 222.048373908375, 236.85606926572632, 258.49407200556755, 227.47213894132253, 272.0969336266313, 204.19380288896892, 178.47122264544336, 300.1602965134927, 278.1663636911008, 141.25990425768427, 103.90583934780287, 344.84624324039737, 363.5413400770766, 203.09288295013937, 177.0614451267833, 217.09386619626446, 417.84637022173825]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.6768078347686086, "mean_inference_ms": 7.070203441246223, "mean_action_processing_ms": 1.1372377176659016, "mean_env_wait_ms": 0.9367357740872027, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01694667339324951, "StateBufferConnector_ms": 0.008001446723937988, "ViewRequirementAgentConnector_ms": 0.3839060068130493}, "num_episodes": 18, "episode_return_max": 222.23236735904302, "episode_return_min": -55.220078776865314, "episode_return_mean": 30.40642111668619, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 243.53304489087836, "num_env_steps_trained_throughput_per_sec": 243.53304489087836, "timesteps_total": 96000, "num_env_steps_sampled_lifetime": 96000, "num_agent_steps_sampled_lifetime": 384000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 384000, "timers": {"training_iteration_time_ms": 16127.859, "restore_workers_time_ms": 0.014, "training_step_time_ms": 16127.815, "sample_time_ms": 4170.487, "learn_time_ms": 11940.755, "learn_throughput": 334.987, "synch_weights_time_ms": 15.626}, "counters": {"num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000}, "done": false, "training_iteration": 24, "trial_id": "d163c_00000", "date": "2024-08-16_12-58-03", "timestamp": 1723793283, "time_this_iter_s": 16.428941011428833, "time_total_s": 504.1659879684448, "pid": 81201, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16b85a310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 504.1659879684448, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 29.934782608695656, "ram_util_percent": 70.04782608695655}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.845280706929782, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.206655371126043, "policy_loss": -0.0030744789346865324, "vf_loss": 9.208729399322833, "vf_explained_var": -0.018722249906529827, "kl": 0.0033348511169515264, "entropy": 1.413400222069372, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 46305.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.979671068576278, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.889766849538006, "policy_loss": -0.007807500481176826, "vf_loss": 8.895672635174302, "vf_explained_var": 0.01313601435807647, "kl": 0.00950868996024885, "entropy": 1.4399560912576301, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 46305.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 400000, "num_agent_steps_trained": 400000}, "env_runners": {"episode_reward_max": 213.3006665651555, "episode_reward_min": -55.220078776865314, "episode_reward_mean": 25.85394372388579, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -439.17637443321695, "predator_policy": 19.220288860018513}, "policy_reward_max": {"prey_policy": 142.28397758148813, "predator_policy": 433.27589795189095}, "policy_reward_mean": {"prey_policy": -198.17126245154498, "predator_policy": 211.09823431348784}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10.000826786742214, -9.100591435065521, 31.87467131071368, 213.3006665651555, -10.242872943327969, 27.42069997794071, -13.375762290784396, 4.994866684681007, 22.24201034311754, 128.05121668379277, -0.496760237671094, -4.762121166463025, 45.62839237431287, 15.376990004919914, -20.736716563867684, -1.216813927935831, 21.800103461570934, -8.42981816710371, -4.893816853494712, -0.17533147727081488, -27.301718570499233, 81.72316019234025, 15.919235951442436, 95.22034746148509, -55.220078776865314, 35.86771784609195, 7.032088066546601, 29.498702483563346, -8.610839698588821, 14.632166773705537, 14.943564511652326, 29.3395194152312, -6.442242089240318, 29.821013545406316, -9.735582640872387, -13.90063406939351, -8.9506413739311, 20.36614453247006, 20.86947047463135, 27.923193331751, 1.6352230802790488, 40.74698348085871, 1.9062038473793592, -2.398694293625624, 8.692166561096942, 85.86039525446195, -15.135584651571627, 23.131367105883776, 116.82469580172595, 26.09207357115738, 13.378662116234844, 66.15589252452222, 177.52736117893215, 81.63142362175945, 13.010000000000005, 34.19540475614631, 23.010320388918657, 17.425864736347368, 37.01874441786715, 12.175370007954662, 70.25737267361185, 35.79178854890205, 6.806683393554063, 14.497142500255844, 56.709048588454294, 15.110830852768837, 14.496515268836035, 0.9919435448473881, 93.73996708506962, 26.428240716014376, -18.635201514399853, 48.10709383128276, -8.25536228437759, 29.715382802353073, 74.97308329834296, 62.834612874904685, 37.92676536163566, 19.902941987805313, 28.944949178279014, 45.81525305429953, 7.724548220587501, 35.05520944781059, 3.936221497767972, 2.283244763931596, 10.278340127702732, 47.42807543586935, 63.58221423203173, 49.82694135506579, 17.958103439575027, 53.65708734677476, 64.46012610168225, 14.771557011505251, 8.598621587978064, 33.880518991011776, 43.40283243087437, -0.9568965519086077, 27.83311829428122, 11.860356698026663, -11.463152175262683, -38.0183940588994], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-206.95932027451738, -277.8186756404772, -252.07343696255904, -235.91472015835296, -263.9234668885381, -163.71662755719777, -227.02879034787347, 142.28397758148813, -156.50039633310703, -145.6913155091758, -71.15539336499116, -135.06336163040808, -137.27234800463043, -109.09835046516625, -236.85779270076705, -105.08435716879326, -72.37223132127043, -19.733697752461197, -10.708801360196341, -28.430705022935054, -164.7376516572578, -147.7265980069607, -113.98160555152518, -285.4609818103724, -126.3447047093755, -96.0012789716098, -230.7976442799877, -188.58954684071313, -255.92325291466972, -180.23010563487418, -140.90863048122162, -77.96934465811421, -281.44085931858604, -122.11454749253652, -89.64565446084266, -136.7693800778335, -152.75198751079023, -296.697328710637, -286.7769110601572, -147.80741826702655, -254.962573756616, -239.05269872814046, -171.86729087228636, -187.53967238526175, -238.3326092358707, -210.53541631738204, -345.3551833756164, -161.96087032490843, -185.45207783200905, -149.02799554640706, -227.6287857932322, -147.47993226774284, -140.19823608535188, -323.5962653770658, -250.11956483792488, -232.2528376173444, -110.2226976203164, -153.41622492731463, -215.33160606098056, -121.70695585041376, -78.66977670749492, -161.851008128488, -122.40654287375708, -225.78969984306525, -270.19469943635295, -198.68444382616832, -190.62370115969762, -122.5431878251547, -297.6016609326875, -200.07548546063842, -193.79818157401237, -102.11540417725004, -199.8804476759938, -237.4597265232578, -221.5588548810905, -255.83194440022785, -392.6985816404194, -119.5887149462912, -149.3052409551865, -214.20921568549318, -335.1996090933988, -124.56454640763668, -323.10925520631264, -239.96844165403195, -136.8196401494788, -140.5579799352641, -234.35043426906782, -187.40254606063044, -261.38931528507015, -154.47464267154731, -267.7186048522578, -226.33780696703053, -252.93145526739912, -234.25767946305092, -192.89503004154204, -163.64444894630046, -359.10430066838956, -13.86024278373466, -347.24359109861126, -357.6425671380642, -319.40441137206153, -369.61445308075525, -137.0047311928902, -86.13908735762557, 54.270308896779554, -292.69646625638705, -311.3849151070723, -105.2114117726448, -288.2656399822814, -172.2851378097004, -128.91854217574212, -439.17637443321695, -157.5440333274301, -147.26033610278867, -220.81364643426875, -290.9149887596605, -99.72593324549271, -360.56492310344936, -168.61882554230104, -258.85052022705486, -112.82538621048954, -408.1777143874107, -225.04361758741365, -188.16876518406872, -250.8488558032719, -327.0010563086281, -306.36959204447277, -233.27563344238513, -19.92395404990494, -139.6829979000447, -366.1226568498448, -298.11600304393164, -261.98321390542304, -276.57053574358554, -202.70136568165702, -286.1325628016066, -139.46071098665422, -49.87044731882751, -253.5641654769094, -220.15186774527675, -248.82465495402315, -208.11250675462097, -283.3114214154101, -229.72048535038016, -263.13816051032944, -317.2640457554772, -362.88072768259747, -151.86137233253098, -245.7343723394061, -174.64268563354548, -190.77452223753227, -245.95993745551678, -57.74027553708715, -286.99798463568953, -233.0773212753437, -325.3463969414445, -83.82221252406613, -132.39858190314192, -296.91650940722496, -365.65582085594986, -159.6540089000873, -212.7757709562478, -256.14352651712767, -343.74150045306396, -229.45294652670245, -157.95493359703036, -193.98261824948165, -144.95968348195285, -114.15754403684676, -258.0776992669516, -360.25116545404404, -255.55664397240832, -207.56705724465797, -157.14665629282422, -112.7707649509482, -163.9188043264068, -148.1292248029951, -86.06775106228666, -190.48884635282297, -74.63664231576767, -247.8890913427943, -100.82515503440547, -170.65721236472334, -40.060899942798, -131.34972591980252, -90.45617727423152, -156.67903409009688, -185.20538856650518, -305.8324481938645, -107.07152285157302, -142.42541218412157, -247.40728713458984, -202.73513667031375, -179.96046075995312, -302.87533502852074, -302.16640472580934, -72.96772783965486, -123.20029157770132, -182.07159511362315, -134.49383385333877], "policy_predator_policy_reward": [223.12910567916325, 251.64806344908894, 202.126455299818, 276.7611103860285, 101.74065106062619, 357.7741146958226, 152.68348996910223, 145.36198936243895, 137.22639183788962, 154.7224470610654, 48.62692329989606, 185.0125316734437, 104.24509957153012, 128.7498366074821, 132.92612005193843, 214.01089650230287, 46.89881322121803, 67.44912619563118, 95.65215117735478, 71.53857188956937, 102.65720138537978, 209.31028804116738, 138.97655925972154, 255.7039069357131, 82.39723055257035, 185.577145502728, 171.79403594200986, 262.97014518361107, 251.78993837926458, 163.6267036064114, 154.2115796022364, 63.44958160916338, 141.72129042823437, 283.634219844459, 108.39801546198416, 109.58720090958826, 235.91341972046126, 208.6420796474714, 238.28382128026394, 196.12517656964894, 222.49590292013158, 244.21765099412542, 208.17538209228124, 232.9547413576069, 210.87871604295628, 253.90854546173887, 260.27989429281695, 342.25650686919283, 180.8509137584845, 98.4090808430662, 206.26020445557833, 204.71623145148845, 252.22246661146582, 218.60412291749864, 285.40620755156357, 226.46489738726936, 132.3924666087347, 122.63561624030773, 227.43357400164143, 124.23715468345841, 84.04864253905326, 171.41570680858194, 162.58801645441847, 214.9477456776352, 248.2275910853691, 214.209310087912, 191.19754318741008, 151.7903593428487, 306.07323199400884, 181.86833175844473, 184.7521566233151, 97.2607950585537, 223.5817710274918, 204.807761797829, 217.1954711964996, 280.56147261728876, 277.62935782865804, 255.52740923268323, 178.4801979811466, 212.95745199128424, 252.56211341085194, 208.83726517046264, 301.99865885504056, 301.82602148616303, 164.89292512070625, 114.39089881141598, 182.26807292861415, 237.08621310745855, 222.71854179332374, 201.8375827243907, 286.4183052946266, 293.4985017791243, 249.45573872636564, 222.59781135251265, 200.78616349621333, 178.88468259751306, 247.8867975751401, 241.9024416787098, 433.27589795189095, 297.70233385594156, 384.87518035320613, 317.5223462158455, 118.66064842634036, 170.6390626486977, 191.5519328357343, 224.40158570280616, 296.4338097866896, 201.7939407147867, 288.2756399822814, 185.28513780970036, 226.8393066540861, 375.45101471101947, 163.9215495040754, 163.89314031506208, 180.69406688258948, 348.4604330476873, 265.9500789432925, 231.35952182351645, 196.56790013880024, 243.07681563851014, 321.1803258164534, 270.0801474550582, 268.91346904538153, 180.0907022750029, 246.40173662012515, 338.25485888532904, 307.32964617438324, 246.81272181273047, 121.2817174066755, 95.03428313172837, 343.9777425920646, 335.37174815448026, 344.8041788370561, 208.24608608078802, 243.97980157319932, 245.8460704549119, 129.12858453936767, 153.9425408511833, 198.95874803010247, 301.1855259080974, 300.8118769637982, 137.49008323044623, 292.9211598572961, 268.2178407397764, 285.7439136928518, 286.40293028857667, 322.40910890910664, 222.048373908375, 236.85606926572632, 258.49407200556755, 227.47213894132253, 272.0969336266313, 204.19380288896892, 178.47122264544336, 300.1602965134927, 278.1663636911008, 141.25990425768427, 103.90583934780287, 344.84624324039737, 363.5413400770766, 203.09288295013937, 177.0614451267833, 217.09386619626446, 417.84637022173825, 157.9644963380872, 233.37960528341347, 187.19400562064388, 154.03154087472234, 190.78192098209314, 191.73166244940782, 258.6762845019222, 404.5596003603995, 206.29631288558363, 221.99961488392967, 187.94130399945053, 138.57520663297038, 126.62986556995152, 125.52521373490515, 217.59436338166492, 101.18821263370047, 196.85061948705226, 216.3237529918303, 109.5460007410415, 115.94366857798447, 135.21340594372853, 95.19111883828357, 187.39002073747693, 188.374920910137, 148.71619452119361, 307.59060895511857, 197.58751253650212, 191.28829023030025, 184.34695319515586, 226.18176252939233, 322.5669982482531, 294.3350982041035, 19.220288860018513, 165.48457838207503, 104.85189884826487, 173.69513605979765]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.65404901384277, "mean_inference_ms": 7.007947478381824, "mean_action_processing_ms": 1.1387958168918073, "mean_env_wait_ms": 0.9291635302336146, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018309354782104492, "StateBufferConnector_ms": 0.00808727741241455, "ViewRequirementAgentConnector_ms": 0.3722037076950073}, "num_episodes": 18, "episode_return_max": 213.3006665651555, "episode_return_min": -55.220078776865314, "episode_return_mean": 25.85394372388579, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 400000, "num_agent_steps_trained": 400000, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 246.2677962595226, "num_env_steps_trained_throughput_per_sec": 246.2677962595226, "timesteps_total": 100000, "num_env_steps_sampled_lifetime": 100000, "num_agent_steps_sampled_lifetime": 400000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 400000, "timers": {"training_iteration_time_ms": 16167.803, "restore_workers_time_ms": 0.014, "training_step_time_ms": 16167.76, "sample_time_ms": 4260.877, "learn_time_ms": 11890.325, "learn_throughput": 336.408, "synch_weights_time_ms": 15.634}, "counters": {"num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 400000, "num_agent_steps_trained": 400000}, "done": false, "training_iteration": 25, "trial_id": "d163c_00000", "date": "2024-08-16_12-58-20", "timestamp": 1723793300, "time_this_iter_s": 16.246017694473267, "time_total_s": 520.4120056629181, "pid": 81201, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16b857670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 520.4120056629181, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 29.652173913043477, "ram_util_percent": 67.72608695652174}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.226168829265726, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.018181216022956, "policy_loss": -0.005362933929812498, "vf_loss": 9.021929649070458, "vf_explained_var": 0.011033398701400353, "kl": 0.010763455926097343, "entropy": 1.4041554172203023, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 48195.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.0763692341153583, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.613936033955326, "policy_loss": -0.006833721503181748, "vf_loss": 8.619092172794241, "vf_explained_var": 0.027638660820703657, "kl": 0.00838801508712409, "entropy": 1.4391980955840418, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 48195.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 416000, "num_agent_steps_trained": 416000}, "env_runners": {"episode_reward_max": 177.52736117893215, "episode_reward_min": -64.03730754400692, "episode_reward_mean": 23.906897603183168, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -439.17637443321695, "predator_policy": 13.719520946735509}, "policy_reward_max": {"prey_policy": 54.270308896779554, "predator_policy": 433.27589795189095}, "policy_reward_mean": {"prey_policy": -202.2287568024153, "predator_policy": 214.18220560400684}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.893816853494712, -0.17533147727081488, -27.301718570499233, 81.72316019234025, 15.919235951442436, 95.22034746148509, -55.220078776865314, 35.86771784609195, 7.032088066546601, 29.498702483563346, -8.610839698588821, 14.632166773705537, 14.943564511652326, 29.3395194152312, -6.442242089240318, 29.821013545406316, -9.735582640872387, -13.90063406939351, -8.9506413739311, 20.36614453247006, 20.86947047463135, 27.923193331751, 1.6352230802790488, 40.74698348085871, 1.9062038473793592, -2.398694293625624, 8.692166561096942, 85.86039525446195, -15.135584651571627, 23.131367105883776, 116.82469580172595, 26.09207357115738, 13.378662116234844, 66.15589252452222, 177.52736117893215, 81.63142362175945, 13.010000000000005, 34.19540475614631, 23.010320388918657, 17.425864736347368, 37.01874441786715, 12.175370007954662, 70.25737267361185, 35.79178854890205, 6.806683393554063, 14.497142500255844, 56.709048588454294, 15.110830852768837, 14.496515268836035, 0.9919435448473881, 93.73996708506962, 26.428240716014376, -18.635201514399853, 48.10709383128276, -8.25536228437759, 29.715382802353073, 74.97308329834296, 62.834612874904685, 37.92676536163566, 19.902941987805313, 28.944949178279014, 45.81525305429953, 7.724548220587501, 35.05520944781059, 3.936221497767972, 2.283244763931596, 10.278340127702732, 47.42807543586935, 63.58221423203173, 49.82694135506579, 17.958103439575027, 53.65708734677476, 64.46012610168225, 14.771557011505251, 8.598621587978064, 33.880518991011776, 43.40283243087437, -0.9568965519086077, 27.83311829428122, 11.860356698026663, -11.463152175262683, -38.0183940588994, 37.54794893206135, 12.943608910805974, 22.42817554074348, 127.64589750178602, -64.03730754400692, 5.049524703036157, 29.514962927550815, -26.719514699262092, 58.97023315421747, -19.62246925432141, 3.8643683989370197, -47.01294728662443, 10.78534423221577, 12.17377777778162, 0.00019731811774179042, 26.339122318341108, 14.665002703273048, 33.086796182328044], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-152.75198751079023, -296.697328710637, -286.7769110601572, -147.80741826702655, -254.962573756616, -239.05269872814046, -171.86729087228636, -187.53967238526175, -238.3326092358707, -210.53541631738204, -345.3551833756164, -161.96087032490843, -185.45207783200905, -149.02799554640706, -227.6287857932322, -147.47993226774284, -140.19823608535188, -323.5962653770658, -250.11956483792488, -232.2528376173444, -110.2226976203164, -153.41622492731463, -215.33160606098056, -121.70695585041376, -78.66977670749492, -161.851008128488, -122.40654287375708, -225.78969984306525, -270.19469943635295, -198.68444382616832, -190.62370115969762, -122.5431878251547, -297.6016609326875, -200.07548546063842, -193.79818157401237, -102.11540417725004, -199.8804476759938, -237.4597265232578, -221.5588548810905, -255.83194440022785, -392.6985816404194, -119.5887149462912, -149.3052409551865, -214.20921568549318, -335.1996090933988, -124.56454640763668, -323.10925520631264, -239.96844165403195, -136.8196401494788, -140.5579799352641, -234.35043426906782, -187.40254606063044, -261.38931528507015, -154.47464267154731, -267.7186048522578, -226.33780696703053, -252.93145526739912, -234.25767946305092, -192.89503004154204, -163.64444894630046, -359.10430066838956, -13.86024278373466, -347.24359109861126, -357.6425671380642, -319.40441137206153, -369.61445308075525, -137.0047311928902, -86.13908735762557, 54.270308896779554, -292.69646625638705, -311.3849151070723, -105.2114117726448, -288.2656399822814, -172.2851378097004, -128.91854217574212, -439.17637443321695, -157.5440333274301, -147.26033610278867, -220.81364643426875, -290.9149887596605, -99.72593324549271, -360.56492310344936, -168.61882554230104, -258.85052022705486, -112.82538621048954, -408.1777143874107, -225.04361758741365, -188.16876518406872, -250.8488558032719, -327.0010563086281, -306.36959204447277, -233.27563344238513, -19.92395404990494, -139.6829979000447, -366.1226568498448, -298.11600304393164, -261.98321390542304, -276.57053574358554, -202.70136568165702, -286.1325628016066, -139.46071098665422, -49.87044731882751, -253.5641654769094, -220.15186774527675, -248.82465495402315, -208.11250675462097, -283.3114214154101, -229.72048535038016, -263.13816051032944, -317.2640457554772, -362.88072768259747, -151.86137233253098, -245.7343723394061, -174.64268563354548, -190.77452223753227, -245.95993745551678, -57.74027553708715, -286.99798463568953, -233.0773212753437, -325.3463969414445, -83.82221252406613, -132.39858190314192, -296.91650940722496, -365.65582085594986, -159.6540089000873, -212.7757709562478, -256.14352651712767, -343.74150045306396, -229.45294652670245, -157.95493359703036, -193.98261824948165, -144.95968348195285, -114.15754403684676, -258.0776992669516, -360.25116545404404, -255.55664397240832, -207.56705724465797, -157.14665629282422, -112.7707649509482, -163.9188043264068, -148.1292248029951, -86.06775106228666, -190.48884635282297, -74.63664231576767, -247.8890913427943, -100.82515503440547, -170.65721236472334, -40.060899942798, -131.34972591980252, -90.45617727423152, -156.67903409009688, -185.20538856650518, -305.8324481938645, -107.07152285157302, -142.42541218412157, -247.40728713458984, -202.73513667031375, -179.96046075995312, -302.87533502852074, -302.16640472580934, -72.96772783965486, -123.20029157770132, -182.07159511362315, -134.49383385333877, -308.7512672200618, -81.42523060887045, -258.8729596025168, -148.40349175319804, -379.39496167319334, -106.57684740842457, -48.00639976036632, -273.6880196058365, -194.44299821781215, -260.39548680653115, -307.2320730987623, -339.839963703658, -323.6321488400655, -181.69353636193753, -159.1745652411028, -136.06478829948142, -278.7292906002875, -158.91701869551247, -131.3980866792227, -258.5588484678848, -168.38083353674892, -128.11150294424488, -84.66647059501491, -157.51661096361985, -147.91302192268952, -238.92631219178634, -220.514823293469, -206.70948111431602, -74.7607830915774, -34.714759363870094, -55.16759610101191, -211.97629848691, -15.488918088877453, -22.67835963049797, -62.53671395310931, 2.0000000000000013], "policy_predator_policy_reward": [235.91341972046126, 208.6420796474714, 238.28382128026394, 196.12517656964894, 222.49590292013158, 244.21765099412542, 208.17538209228124, 232.9547413576069, 210.87871604295628, 253.90854546173887, 260.27989429281695, 342.25650686919283, 180.8509137584845, 98.4090808430662, 206.26020445557833, 204.71623145148845, 252.22246661146582, 218.60412291749864, 285.40620755156357, 226.46489738726936, 132.3924666087347, 122.63561624030773, 227.43357400164143, 124.23715468345841, 84.04864253905326, 171.41570680858194, 162.58801645441847, 214.9477456776352, 248.2275910853691, 214.209310087912, 191.19754318741008, 151.7903593428487, 306.07323199400884, 181.86833175844473, 184.7521566233151, 97.2607950585537, 223.5817710274918, 204.807761797829, 217.1954711964996, 280.56147261728876, 277.62935782865804, 255.52740923268323, 178.4801979811466, 212.95745199128424, 252.56211341085194, 208.83726517046264, 301.99865885504056, 301.82602148616303, 164.89292512070625, 114.39089881141598, 182.26807292861415, 237.08621310745855, 222.71854179332374, 201.8375827243907, 286.4183052946266, 293.4985017791243, 249.45573872636564, 222.59781135251265, 200.78616349621333, 178.88468259751306, 247.8867975751401, 241.9024416787098, 433.27589795189095, 297.70233385594156, 384.87518035320613, 317.5223462158455, 118.66064842634036, 170.6390626486977, 191.5519328357343, 224.40158570280616, 296.4338097866896, 201.7939407147867, 288.2756399822814, 185.28513780970036, 226.8393066540861, 375.45101471101947, 163.9215495040754, 163.89314031506208, 180.69406688258948, 348.4604330476873, 265.9500789432925, 231.35952182351645, 196.56790013880024, 243.07681563851014, 321.1803258164534, 270.0801474550582, 268.91346904538153, 180.0907022750029, 246.40173662012515, 338.25485888532904, 307.32964617438324, 246.81272181273047, 121.2817174066755, 95.03428313172837, 343.9777425920646, 335.37174815448026, 344.8041788370561, 208.24608608078802, 243.97980157319932, 245.8460704549119, 129.12858453936767, 153.9425408511833, 198.95874803010247, 301.1855259080974, 300.8118769637982, 137.49008323044623, 292.9211598572961, 268.2178407397764, 285.7439136928518, 286.40293028857667, 322.40910890910664, 222.048373908375, 236.85606926572632, 258.49407200556755, 227.47213894132253, 272.0969336266313, 204.19380288896892, 178.47122264544336, 300.1602965134927, 278.1663636911008, 141.25990425768427, 103.90583934780287, 344.84624324039737, 363.5413400770766, 203.09288295013937, 177.0614451267833, 217.09386619626446, 417.84637022173825, 157.9644963380872, 233.37960528341347, 187.19400562064388, 154.03154087472234, 190.78192098209314, 191.73166244940782, 258.6762845019222, 404.5596003603995, 206.29631288558363, 221.99961488392967, 187.94130399945053, 138.57520663297038, 126.62986556995152, 125.52521373490515, 217.59436338166492, 101.18821263370047, 196.85061948705226, 216.3237529918303, 109.5460007410415, 115.94366857798447, 135.21340594372853, 95.19111883828357, 187.39002073747693, 188.374920910137, 148.71619452119361, 307.59060895511857, 197.58751253650212, 191.28829023030025, 184.34695319515586, 226.18176252939233, 322.5669982482531, 294.3350982041035, 19.220288860018513, 165.48457838207503, 104.85189884826487, 173.69513605979765, 201.81297718903684, 225.9114695719566, 269.33467260627145, 150.88538766024942, 236.1145194692645, 272.2854651530968, 206.29409710686065, 243.04621976112836, 38.93226335256408, 351.86891412777203, 384.406216299957, 267.7153452054998, 332.3575846116685, 202.4830635178849, 202.1956475560338, 66.32419128528839, 264.8913656402108, 231.72517680980647, 200.5412596899183, 169.79320620286794, 169.4220777014445, 130.93462717848627, 13.719520946735509, 181.45061332527487, 179.55114986148956, 218.07352848520188, 268.04470980366193, 171.35337238190476, 82.24432225416707, 27.23141751939846, 206.10020124438046, 87.38281566188257, 17.753163104916265, 35.07911731773247, 46.46736180204551, 47.1561483333917]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.6340202697337065, "mean_inference_ms": 6.953651051204037, "mean_action_processing_ms": 1.1413602940279148, "mean_env_wait_ms": 0.92295603852021, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02559661865234375, "StateBufferConnector_ms": 0.00803983211517334, "ViewRequirementAgentConnector_ms": 0.3473778963088989}, "num_episodes": 18, "episode_return_max": 177.52736117893215, "episode_return_min": -64.03730754400692, "episode_return_mean": 23.906897603183168, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 416000, "num_agent_steps_trained": 416000, "num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 258.79342977029535, "num_env_steps_trained_throughput_per_sec": 258.79342977029535, "timesteps_total": 104000, "num_env_steps_sampled_lifetime": 104000, "num_agent_steps_sampled_lifetime": 416000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 416000, "timers": {"training_iteration_time_ms": 16024.659, "restore_workers_time_ms": 0.015, "training_step_time_ms": 16024.617, "sample_time_ms": 4274.11, "learn_time_ms": 11735.645, "learn_throughput": 340.842, "synch_weights_time_ms": 14.004}, "counters": {"num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 416000, "num_agent_steps_trained": 416000}, "done": false, "training_iteration": 26, "trial_id": "d163c_00000", "date": "2024-08-16_12-58-35", "timestamp": 1723793315, "time_this_iter_s": 15.460102796554565, "time_total_s": 535.8721084594727, "pid": 81201, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16af661f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 535.8721084594727, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 27.722727272727273, "ram_util_percent": 67.50454545454548}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.725417524765408, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.38245444852839, "policy_loss": -0.004594828539266788, "vf_loss": 8.384218847940838, "vf_explained_var": 0.14487315517253976, "kl": 0.018869651731828623, "entropy": 1.3842487761583278, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 50085.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.389458447600168, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.280490213979489, "policy_loss": -0.004049872876842206, "vf_loss": 7.283461884342174, "vf_explained_var": 0.008098791579090098, "kl": 0.005391006164756532, "entropy": 1.4159785533077502, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 50085.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 432000}, "env_runners": {"episode_reward_max": 177.52736117893215, "episode_reward_min": -64.75515448539053, "episode_reward_mean": 26.824544741316007, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -464.5031005394712, "predator_policy": 13.719520946735509}, "policy_reward_max": {"prey_policy": 54.270308896779554, "predator_policy": 434.4866781922109}, "policy_reward_mean": {"prey_policy": -191.39636499376812, "predator_policy": 204.8086373644261}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1.6352230802790488, 40.74698348085871, 1.9062038473793592, -2.398694293625624, 8.692166561096942, 85.86039525446195, -15.135584651571627, 23.131367105883776, 116.82469580172595, 26.09207357115738, 13.378662116234844, 66.15589252452222, 177.52736117893215, 81.63142362175945, 13.010000000000005, 34.19540475614631, 23.010320388918657, 17.425864736347368, 37.01874441786715, 12.175370007954662, 70.25737267361185, 35.79178854890205, 6.806683393554063, 14.497142500255844, 56.709048588454294, 15.110830852768837, 14.496515268836035, 0.9919435448473881, 93.73996708506962, 26.428240716014376, -18.635201514399853, 48.10709383128276, -8.25536228437759, 29.715382802353073, 74.97308329834296, 62.834612874904685, 37.92676536163566, 19.902941987805313, 28.944949178279014, 45.81525305429953, 7.724548220587501, 35.05520944781059, 3.936221497767972, 2.283244763931596, 10.278340127702732, 47.42807543586935, 63.58221423203173, 49.82694135506579, 17.958103439575027, 53.65708734677476, 64.46012610168225, 14.771557011505251, 8.598621587978064, 33.880518991011776, 43.40283243087437, -0.9568965519086077, 27.83311829428122, 11.860356698026663, -11.463152175262683, -38.0183940588994, 37.54794893206135, 12.943608910805974, 22.42817554074348, 127.64589750178602, -64.03730754400692, 5.049524703036157, 29.514962927550815, -26.719514699262092, 58.97023315421747, -19.62246925432141, 3.8643683989370197, -47.01294728662443, 10.78534423221577, 12.17377777778162, 0.00019731811774179042, 26.339122318341108, 14.665002703273048, 33.086796182328044, -64.75515448539053, 125.38739072221212, 6.56171588434753, 42.3502510200727, -9.165347248414271, 37.67477677445069, 15.8317464701425, 49.889023832195484, 5.791551222592517, -5.992098578650789, 47.2862043596612, 50.817871074582115, 36.10214511748426, 39.31280696223571, 59.57386580652831, 37.26821126889749, 51.217276226792386, 121.28913233257477, -27.9638023269435, -61.927147646760254, 12.339143780473316, 10.800590280361668], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-335.1996090933988, -124.56454640763668, -323.10925520631264, -239.96844165403195, -136.8196401494788, -140.5579799352641, -234.35043426906782, -187.40254606063044, -261.38931528507015, -154.47464267154731, -267.7186048522578, -226.33780696703053, -252.93145526739912, -234.25767946305092, -192.89503004154204, -163.64444894630046, -359.10430066838956, -13.86024278373466, -347.24359109861126, -357.6425671380642, -319.40441137206153, -369.61445308075525, -137.0047311928902, -86.13908735762557, 54.270308896779554, -292.69646625638705, -311.3849151070723, -105.2114117726448, -288.2656399822814, -172.2851378097004, -128.91854217574212, -439.17637443321695, -157.5440333274301, -147.26033610278867, -220.81364643426875, -290.9149887596605, -99.72593324549271, -360.56492310344936, -168.61882554230104, -258.85052022705486, -112.82538621048954, -408.1777143874107, -225.04361758741365, -188.16876518406872, -250.8488558032719, -327.0010563086281, -306.36959204447277, -233.27563344238513, -19.92395404990494, -139.6829979000447, -366.1226568498448, -298.11600304393164, -261.98321390542304, -276.57053574358554, -202.70136568165702, -286.1325628016066, -139.46071098665422, -49.87044731882751, -253.5641654769094, -220.15186774527675, -248.82465495402315, -208.11250675462097, -283.3114214154101, -229.72048535038016, -263.13816051032944, -317.2640457554772, -362.88072768259747, -151.86137233253098, -245.7343723394061, -174.64268563354548, -190.77452223753227, -245.95993745551678, -57.74027553708715, -286.99798463568953, -233.0773212753437, -325.3463969414445, -83.82221252406613, -132.39858190314192, -296.91650940722496, -365.65582085594986, -159.6540089000873, -212.7757709562478, -256.14352651712767, -343.74150045306396, -229.45294652670245, -157.95493359703036, -193.98261824948165, -144.95968348195285, -114.15754403684676, -258.0776992669516, -360.25116545404404, -255.55664397240832, -207.56705724465797, -157.14665629282422, -112.7707649509482, -163.9188043264068, -148.1292248029951, -86.06775106228666, -190.48884635282297, -74.63664231576767, -247.8890913427943, -100.82515503440547, -170.65721236472334, -40.060899942798, -131.34972591980252, -90.45617727423152, -156.67903409009688, -185.20538856650518, -305.8324481938645, -107.07152285157302, -142.42541218412157, -247.40728713458984, -202.73513667031375, -179.96046075995312, -302.87533502852074, -302.16640472580934, -72.96772783965486, -123.20029157770132, -182.07159511362315, -134.49383385333877, -308.7512672200618, -81.42523060887045, -258.8729596025168, -148.40349175319804, -379.39496167319334, -106.57684740842457, -48.00639976036632, -273.6880196058365, -194.44299821781215, -260.39548680653115, -307.2320730987623, -339.839963703658, -323.6321488400655, -181.69353636193753, -159.1745652411028, -136.06478829948142, -278.7292906002875, -158.91701869551247, -131.3980866792227, -258.5588484678848, -168.38083353674892, -128.11150294424488, -84.66647059501491, -157.51661096361985, -147.91302192268952, -238.92631219178634, -220.514823293469, -206.70948111431602, -74.7607830915774, -34.714759363870094, -55.16759610101191, -211.97629848691, -15.488918088877453, -22.67835963049797, -62.53671395310931, 2.0000000000000013, -211.1478262207767, -199.70563619679754, -442.4773650613851, -77.13689642986022, -231.22249748632237, -340.76107059211716, -146.64371027366695, -172.87338646771283, -78.86197933940709, -37.585451246866896, -28.9266253220477, -16.252659039150434, -70.7756337298744, -173.62500113664439, -464.5031005394712, -261.3085959493325, -32.77540400353393, -57.65528329402137, -187.9777496984685, -89.85365543691822, -34.65682802394493, -96.8039796153457, -97.91100667510095, -37.25839006002451, -258.14313894896003, -319.8807400681891, -60.330981787515604, -131.53790518030692, -174.83687112629525, -72.08753495540263, -1.0506217285563684, -88.52388334977297, -81.47819841032438, -146.397226830481, -107.94401025035819, -429.875915546891, -94.84209412967411, -122.66932903882486, -156.35563314182357, -176.1435153343729, -411.8710702084261, -255.64430891224129, -15.975498751994847, -44.19308774488359], "policy_predator_policy_reward": [252.56211341085194, 208.83726517046264, 301.99865885504056, 301.82602148616303, 164.89292512070625, 114.39089881141598, 182.26807292861415, 237.08621310745855, 222.71854179332374, 201.8375827243907, 286.4183052946266, 293.4985017791243, 249.45573872636564, 222.59781135251265, 200.78616349621333, 178.88468259751306, 247.8867975751401, 241.9024416787098, 433.27589795189095, 297.70233385594156, 384.87518035320613, 317.5223462158455, 118.66064842634036, 170.6390626486977, 191.5519328357343, 224.40158570280616, 296.4338097866896, 201.7939407147867, 288.2756399822814, 185.28513780970036, 226.8393066540861, 375.45101471101947, 163.9215495040754, 163.89314031506208, 180.69406688258948, 348.4604330476873, 265.9500789432925, 231.35952182351645, 196.56790013880024, 243.07681563851014, 321.1803258164534, 270.0801474550582, 268.91346904538153, 180.0907022750029, 246.40173662012515, 338.25485888532904, 307.32964617438324, 246.81272181273047, 121.2817174066755, 95.03428313172837, 343.9777425920646, 335.37174815448026, 344.8041788370561, 208.24608608078802, 243.97980157319932, 245.8460704549119, 129.12858453936767, 153.9425408511833, 198.95874803010247, 301.1855259080974, 300.8118769637982, 137.49008323044623, 292.9211598572961, 268.2178407397764, 285.7439136928518, 286.40293028857667, 322.40910890910664, 222.048373908375, 236.85606926572632, 258.49407200556755, 227.47213894132253, 272.0969336266313, 204.19380288896892, 178.47122264544336, 300.1602965134927, 278.1663636911008, 141.25990425768427, 103.90583934780287, 344.84624324039737, 363.5413400770766, 203.09288295013937, 177.0614451267833, 217.09386619626446, 417.84637022173825, 157.9644963380872, 233.37960528341347, 187.19400562064388, 154.03154087472234, 190.78192098209314, 191.73166244940782, 258.6762845019222, 404.5596003603995, 206.29631288558363, 221.99961488392967, 187.94130399945053, 138.57520663297038, 126.62986556995152, 125.52521373490515, 217.59436338166492, 101.18821263370047, 196.85061948705226, 216.3237529918303, 109.5460007410415, 115.94366857798447, 135.21340594372853, 95.19111883828357, 187.39002073747693, 188.374920910137, 148.71619452119361, 307.59060895511857, 197.58751253650212, 191.28829023030025, 184.34695319515586, 226.18176252939233, 322.5669982482531, 294.3350982041035, 19.220288860018513, 165.48457838207503, 104.85189884826487, 173.69513605979765, 201.81297718903684, 225.9114695719566, 269.33467260627145, 150.88538766024942, 236.1145194692645, 272.2854651530968, 206.29409710686065, 243.04621976112836, 38.93226335256408, 351.86891412777203, 384.406216299957, 267.7153452054998, 332.3575846116685, 202.4830635178849, 202.1956475560338, 66.32419128528839, 264.8913656402108, 231.72517680980647, 200.5412596899183, 169.79320620286794, 169.4220777014445, 130.93462717848627, 13.719520946735509, 181.45061332527487, 179.55114986148956, 218.07352848520188, 268.04470980366193, 171.35337238190476, 82.24432225416707, 27.23141751939846, 206.10020124438046, 87.38281566188257, 17.753163104916265, 35.07911731773247, 46.46736180204551, 47.1561483333917, 29.133402994773615, 316.96490493741044, 284.4041523781592, 360.5974998352979, 223.36211632773237, 355.1831676350547, 188.07018806042174, 173.7971597010298, 21.553199132987515, 85.72888420487224, 44.42384308565283, 38.43021804999656, 95.14615388560567, 165.08622745105515, 341.2140421287879, 434.4866781922109, 28.562300969889428, 67.65993755025822, 136.37274795019133, 135.46655860654417, 102.37296776160744, 76.37404423734505, 75.98522700682791, 110.0020408028802, 412.9392013016008, 201.18682283303264, 88.47486778715063, 142.70682614290772, 124.72656091359634, 181.7717109746299, 37.55708773775642, 89.28562860947106, 157.54507267234717, 121.54762879525101, 352.5102710423101, 306.59878708751444, 155.17689601743103, 34.37072482412432, 17.37517207717281, 253.19682875226334, 333.8952079036382, 345.9593149975022, 24.133415412247455, 46.835761364992464]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.6121885298154113, "mean_inference_ms": 6.896085424033142, "mean_action_processing_ms": 1.1455548881483284, "mean_env_wait_ms": 0.9178724404315176, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026552200317382812, "StateBufferConnector_ms": 0.00797879695892334, "ViewRequirementAgentConnector_ms": 0.3438456058502197}, "num_episodes": 22, "episode_return_max": 177.52736117893215, "episode_return_min": -64.75515448539053, "episode_return_mean": 26.824544741316007, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 432000, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 254.11040669516032, "num_env_steps_trained_throughput_per_sec": 254.11040669516032, "timesteps_total": 108000, "num_env_steps_sampled_lifetime": 108000, "num_agent_steps_sampled_lifetime": 432000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 432000, "timers": {"training_iteration_time_ms": 16024.605, "restore_workers_time_ms": 0.014, "training_step_time_ms": 16024.564, "sample_time_ms": 4227.364, "learn_time_ms": 11782.257, "learn_throughput": 339.494, "synch_weights_time_ms": 14.075}, "counters": {"num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 432000}, "done": false, "training_iteration": 27, "trial_id": "d163c_00000", "date": "2024-08-16_12-58-51", "timestamp": 1723793331, "time_this_iter_s": 15.74477481842041, "time_total_s": 551.6168832778931, "pid": 81201, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16b86dd30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 551.6168832778931, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 27.83636363636363, "ram_util_percent": 67.55000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.000694980381658, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.174131676507374, "policy_loss": -0.004943765872084196, "vf_loss": 9.177211490510002, "vf_explained_var": 0.04382796230770293, "kl": 0.01242646720195866, "entropy": 1.3536198487988225, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 51975.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.779901657596467, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.34856928265284, "policy_loss": -0.012546285129985008, "vf_loss": 9.35852148267958, "vf_explained_var": -0.0017652979603520146, "kl": 0.0129704275245698, "entropy": 1.4233797717977452, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 51975.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000}, "env_runners": {"episode_reward_max": 155.7888701806516, "episode_reward_min": -88.52436560132337, "episode_reward_mean": 24.448457248777636, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -464.5031005394712, "predator_policy": 2.035415452509248}, "policy_reward_max": {"prey_policy": 74.14755625886548, "predator_policy": 434.4866781922109}, "policy_reward_mean": {"prey_policy": -177.01592923525007, "predator_policy": 189.24015785963888}, "custom_metrics": {}, "hist_stats": {"episode_reward": [14.497142500255844, 56.709048588454294, 15.110830852768837, 14.496515268836035, 0.9919435448473881, 93.73996708506962, 26.428240716014376, -18.635201514399853, 48.10709383128276, -8.25536228437759, 29.715382802353073, 74.97308329834296, 62.834612874904685, 37.92676536163566, 19.902941987805313, 28.944949178279014, 45.81525305429953, 7.724548220587501, 35.05520944781059, 3.936221497767972, 2.283244763931596, 10.278340127702732, 47.42807543586935, 63.58221423203173, 49.82694135506579, 17.958103439575027, 53.65708734677476, 64.46012610168225, 14.771557011505251, 8.598621587978064, 33.880518991011776, 43.40283243087437, -0.9568965519086077, 27.83311829428122, 11.860356698026663, -11.463152175262683, -38.0183940588994, 37.54794893206135, 12.943608910805974, 22.42817554074348, 127.64589750178602, -64.03730754400692, 5.049524703036157, 29.514962927550815, -26.719514699262092, 58.97023315421747, -19.62246925432141, 3.8643683989370197, -47.01294728662443, 10.78534423221577, 12.17377777778162, 0.00019731811774179042, 26.339122318341108, 14.665002703273048, 33.086796182328044, -64.75515448539053, 125.38739072221212, 6.56171588434753, 42.3502510200727, -9.165347248414271, 37.67477677445069, 15.8317464701425, 49.889023832195484, 5.791551222592517, -5.992098578650789, 47.2862043596612, 50.817871074582115, 36.10214511748426, 39.31280696223571, 59.57386580652831, 37.26821126889749, 51.217276226792386, 121.28913233257477, -27.9638023269435, -61.927147646760254, 12.339143780473316, 10.800590280361668, -3.3467656742930103, 155.7888701806516, 15.691254657919373, 102.99653912529448, 42.18479591457444, 37.64378559679075, 51.94209670536574, 34.10047891193118, 7.670938691387158, 4.05153229459999, 65.61263659014914, 40.34847059580156, 34.61006842368146, -33.22389494519775, 48.420629263884244, 13.74915641951698, 30.12164401566848, -88.52436560132337, 74.99993384311635, 42.98866464141595, -49.51861175001546, 51.38403102452592, -41.56092005688546], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-306.36959204447277, -233.27563344238513, -19.92395404990494, -139.6829979000447, -366.1226568498448, -298.11600304393164, -261.98321390542304, -276.57053574358554, -202.70136568165702, -286.1325628016066, -139.46071098665422, -49.87044731882751, -253.5641654769094, -220.15186774527675, -248.82465495402315, -208.11250675462097, -283.3114214154101, -229.72048535038016, -263.13816051032944, -317.2640457554772, -362.88072768259747, -151.86137233253098, -245.7343723394061, -174.64268563354548, -190.77452223753227, -245.95993745551678, -57.74027553708715, -286.99798463568953, -233.0773212753437, -325.3463969414445, -83.82221252406613, -132.39858190314192, -296.91650940722496, -365.65582085594986, -159.6540089000873, -212.7757709562478, -256.14352651712767, -343.74150045306396, -229.45294652670245, -157.95493359703036, -193.98261824948165, -144.95968348195285, -114.15754403684676, -258.0776992669516, -360.25116545404404, -255.55664397240832, -207.56705724465797, -157.14665629282422, -112.7707649509482, -163.9188043264068, -148.1292248029951, -86.06775106228666, -190.48884635282297, -74.63664231576767, -247.8890913427943, -100.82515503440547, -170.65721236472334, -40.060899942798, -131.34972591980252, -90.45617727423152, -156.67903409009688, -185.20538856650518, -305.8324481938645, -107.07152285157302, -142.42541218412157, -247.40728713458984, -202.73513667031375, -179.96046075995312, -302.87533502852074, -302.16640472580934, -72.96772783965486, -123.20029157770132, -182.07159511362315, -134.49383385333877, -308.7512672200618, -81.42523060887045, -258.8729596025168, -148.40349175319804, -379.39496167319334, -106.57684740842457, -48.00639976036632, -273.6880196058365, -194.44299821781215, -260.39548680653115, -307.2320730987623, -339.839963703658, -323.6321488400655, -181.69353636193753, -159.1745652411028, -136.06478829948142, -278.7292906002875, -158.91701869551247, -131.3980866792227, -258.5588484678848, -168.38083353674892, -128.11150294424488, -84.66647059501491, -157.51661096361985, -147.91302192268952, -238.92631219178634, -220.514823293469, -206.70948111431602, -74.7607830915774, -34.714759363870094, -55.16759610101191, -211.97629848691, -15.488918088877453, -22.67835963049797, -62.53671395310931, 2.0000000000000013, -211.1478262207767, -199.70563619679754, -442.4773650613851, -77.13689642986022, -231.22249748632237, -340.76107059211716, -146.64371027366695, -172.87338646771283, -78.86197933940709, -37.585451246866896, -28.9266253220477, -16.252659039150434, -70.7756337298744, -173.62500113664439, -464.5031005394712, -261.3085959493325, -32.77540400353393, -57.65528329402137, -187.9777496984685, -89.85365543691822, -34.65682802394493, -96.8039796153457, -97.91100667510095, -37.25839006002451, -258.14313894896003, -319.8807400681891, -60.330981787515604, -131.53790518030692, -174.83687112629525, -72.08753495540263, -1.0506217285563684, -88.52388334977297, -81.47819841032438, -146.397226830481, -107.94401025035819, -429.875915546891, -94.84209412967411, -122.66932903882486, -156.35563314182357, -176.1435153343729, -411.8710702084261, -255.64430891224129, -15.975498751994847, -44.19308774488359, -69.67705720352403, -85.44887632241968, 74.14755625886548, -128.05924367704478, -302.7169447472192, -116.61783591427037, -2.8945668331484686, -169.7627667328629, -123.08427561801629, -298.9341962538205, -207.3214911534931, -275.6846003011993, -251.51415473506526, -179.28499705418747, -161.63567085617547, -259.4463152371783, -26.282840413191195, -47.2342683892558, -308.6577719634604, -185.52156014667318, -19.75116747232878, -256.5754046967813, -8.923859238269568, 4.924857002342516, -230.06855258774445, -221.3417444683397, -219.22605076435516, -82.1698991145254, -5.56935276201754, -122.50389940408012, -161.39868903985808, -199.14535569601532, -123.51610563553358, -157.45952648546833, -314.4177043839865, -191.1145572350827, -168.45867949773563, -171.20618777484347, -287.5104391690063, -231.53725406262265, -176.34760230761353, -185.6701666318894, -178.1542745203085, -343.42423769179624, -120.48803989218976, -192.88867929915887], "policy_predator_policy_reward": [307.32964617438324, 246.81272181273047, 121.2817174066755, 95.03428313172837, 343.9777425920646, 335.37174815448026, 344.8041788370561, 208.24608608078802, 243.97980157319932, 245.8460704549119, 129.12858453936767, 153.9425408511833, 198.95874803010247, 301.1855259080974, 300.8118769637982, 137.49008323044623, 292.9211598572961, 268.2178407397764, 285.7439136928518, 286.40293028857667, 322.40910890910664, 222.048373908375, 236.85606926572632, 258.49407200556755, 227.47213894132253, 272.0969336266313, 204.19380288896892, 178.47122264544336, 300.1602965134927, 278.1663636911008, 141.25990425768427, 103.90583934780287, 344.84624324039737, 363.5413400770766, 203.09288295013937, 177.0614451267833, 217.09386619626446, 417.84637022173825, 157.9644963380872, 233.37960528341347, 187.19400562064388, 154.03154087472234, 190.78192098209314, 191.73166244940782, 258.6762845019222, 404.5596003603995, 206.29631288558363, 221.99961488392967, 187.94130399945053, 138.57520663297038, 126.62986556995152, 125.52521373490515, 217.59436338166492, 101.18821263370047, 196.85061948705226, 216.3237529918303, 109.5460007410415, 115.94366857798447, 135.21340594372853, 95.19111883828357, 187.39002073747693, 188.374920910137, 148.71619452119361, 307.59060895511857, 197.58751253650212, 191.28829023030025, 184.34695319515586, 226.18176252939233, 322.5669982482531, 294.3350982041035, 19.220288860018513, 165.48457838207503, 104.85189884826487, 173.69513605979765, 201.81297718903684, 225.9114695719566, 269.33467260627145, 150.88538766024942, 236.1145194692645, 272.2854651530968, 206.29409710686065, 243.04621976112836, 38.93226335256408, 351.86891412777203, 384.406216299957, 267.7153452054998, 332.3575846116685, 202.4830635178849, 202.1956475560338, 66.32419128528839, 264.8913656402108, 231.72517680980647, 200.5412596899183, 169.79320620286794, 169.4220777014445, 130.93462717848627, 13.719520946735509, 181.45061332527487, 179.55114986148956, 218.07352848520188, 268.04470980366193, 171.35337238190476, 82.24432225416707, 27.23141751939846, 206.10020124438046, 87.38281566188257, 17.753163104916265, 35.07911731773247, 46.46736180204551, 47.1561483333917, 29.133402994773615, 316.96490493741044, 284.4041523781592, 360.5974998352979, 223.36211632773237, 355.1831676350547, 188.07018806042174, 173.7971597010298, 21.553199132987515, 85.72888420487224, 44.42384308565283, 38.43021804999656, 95.14615388560567, 165.08622745105515, 341.2140421287879, 434.4866781922109, 28.562300969889428, 67.65993755025822, 136.37274795019133, 135.46655860654417, 102.37296776160744, 76.37404423734505, 75.98522700682791, 110.0020408028802, 412.9392013016008, 201.18682283303264, 88.47486778715063, 142.70682614290772, 124.72656091359634, 181.7717109746299, 37.55708773775642, 89.28562860947106, 157.54507267234717, 121.54762879525101, 352.5102710423101, 306.59878708751444, 155.17689601743103, 34.37072482412432, 17.37517207717281, 253.19682875226334, 333.8952079036382, 345.9593149975022, 24.133415412247455, 46.835761364992464, 131.94975852183057, 19.829409329820084, 93.3513437801068, 116.34921381872401, 171.0528515622435, 263.9731837571656, 90.3248187400518, 185.32905395125388, 242.33725494789692, 221.86601283851408, 248.19787336172348, 272.45200368975964, 235.12152093505867, 247.61972755955983, 180.18696469025613, 274.9955003150286, 43.0027366774904, 38.18531081634375, 254.22204070475567, 244.0088236999787, 178.62883245404646, 163.31037630521303, 20.854757785478608, 23.492715046250396, 221.18794560087295, 264.8324198788928, 196.74732427211518, 71.42473066156745, 74.3324560810288, 102.16142534895376, 193.19252260675455, 181.1006785486359, 151.53919563989263, 159.5580804967776, 2.035415452509248, 414.9724805652367, 196.4827531611377, 218.18204795455793, 274.03938822718186, 287.99696964586263, 295.8441990873135, 16.6549581021739, 305.96999680009554, 266.99254643653506, 35.67206344688132, 236.14373568758165]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.589371956601783, "mean_inference_ms": 6.838265175665379, "mean_action_processing_ms": 1.1498631733007993, "mean_env_wait_ms": 0.9098659911577184, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02639758586883545, "StateBufferConnector_ms": 0.008059501647949219, "ViewRequirementAgentConnector_ms": 0.3346925973892212}, "num_episodes": 23, "episode_return_max": 155.7888701806516, "episode_return_min": -88.52436560132337, "episode_return_mean": 24.448457248777636, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 253.28445410399698, "num_env_steps_trained_throughput_per_sec": 253.28445410399698, "timesteps_total": 112000, "num_env_steps_sampled_lifetime": 112000, "num_agent_steps_sampled_lifetime": 448000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 448000, "timers": {"training_iteration_time_ms": 15933.489, "restore_workers_time_ms": 0.014, "training_step_time_ms": 15933.447, "sample_time_ms": 4234.788, "learn_time_ms": 11683.684, "learn_throughput": 342.358, "synch_weights_time_ms": 14.091}, "counters": {"num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000}, "done": false, "training_iteration": 28, "trial_id": "d163c_00000", "date": "2024-08-16_12-59-07", "timestamp": 1723793347, "time_this_iter_s": 15.797077894210815, "time_total_s": 567.4139611721039, "pid": 81201, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16af37ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 567.4139611721039, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 27.21739130434782, "ram_util_percent": 67.40000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.7824932554253825, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.4139285158228, "policy_loss": -0.006585539102421275, "vf_loss": 9.41903397544982, "vf_explained_var": 0.0717977608637835, "kl": 0.00986718560757344, "entropy": 1.3344264596227615, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 53865.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.847386813447589, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.426234714064018, "policy_loss": -0.014516120413121171, "vf_loss": 9.437745739164807, "vf_explained_var": -0.05534388930709274, "kl": 0.015025376436906665, "entropy": 1.426674826435311, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 53865.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_agent_steps_sampled": 464000, "num_agent_steps_trained": 464000}, "env_runners": {"episode_reward_max": 188.2898236993648, "episode_reward_min": -88.52436560132337, "episode_reward_mean": 31.638128043718453, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -464.5031005394712, "predator_policy": 2.035415452509248}, "policy_reward_max": {"prey_policy": 106.89112584026074, "predator_policy": 434.4866781922109}, "policy_reward_mean": {"prey_policy": -167.8684049073814, "predator_policy": 183.68746892924065}, "custom_metrics": {}, "hist_stats": {"episode_reward": [35.05520944781059, 3.936221497767972, 2.283244763931596, 10.278340127702732, 47.42807543586935, 63.58221423203173, 49.82694135506579, 17.958103439575027, 53.65708734677476, 64.46012610168225, 14.771557011505251, 8.598621587978064, 33.880518991011776, 43.40283243087437, -0.9568965519086077, 27.83311829428122, 11.860356698026663, -11.463152175262683, -38.0183940588994, 37.54794893206135, 12.943608910805974, 22.42817554074348, 127.64589750178602, -64.03730754400692, 5.049524703036157, 29.514962927550815, -26.719514699262092, 58.97023315421747, -19.62246925432141, 3.8643683989370197, -47.01294728662443, 10.78534423221577, 12.17377777778162, 0.00019731811774179042, 26.339122318341108, 14.665002703273048, 33.086796182328044, -64.75515448539053, 125.38739072221212, 6.56171588434753, 42.3502510200727, -9.165347248414271, 37.67477677445069, 15.8317464701425, 49.889023832195484, 5.791551222592517, -5.992098578650789, 47.2862043596612, 50.817871074582115, 36.10214511748426, 39.31280696223571, 59.57386580652831, 37.26821126889749, 51.217276226792386, 121.28913233257477, -27.9638023269435, -61.927147646760254, 12.339143780473316, 10.800590280361668, -3.3467656742930103, 155.7888701806516, 15.691254657919373, 102.99653912529448, 42.18479591457444, 37.64378559679075, 51.94209670536574, 34.10047891193118, 7.670938691387158, 4.05153229459999, 65.61263659014914, 40.34847059580156, 34.61006842368146, -33.22389494519775, 48.420629263884244, 13.74915641951698, 30.12164401566848, -88.52436560132337, 74.99993384311635, 42.98866464141595, -49.51861175001546, 51.38403102452592, -41.56092005688546, 40.94960352872493, 85.24643798194491, 37.590980154064454, 56.54424811237449, 34.0423393943989, 153.23225502639733, 50.31365656121563, 35.06108302387477, 52.04639852236079, 188.2898236993648, 79.60039867601927, -6.483666384424164, 41.059054307733, 150.31036203079455, 18.450660557138086, 108.05931434621093, -19.34061264955383, 165.02249797240142], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-256.14352651712767, -343.74150045306396, -229.45294652670245, -157.95493359703036, -193.98261824948165, -144.95968348195285, -114.15754403684676, -258.0776992669516, -360.25116545404404, -255.55664397240832, -207.56705724465797, -157.14665629282422, -112.7707649509482, -163.9188043264068, -148.1292248029951, -86.06775106228666, -190.48884635282297, -74.63664231576767, -247.8890913427943, -100.82515503440547, -170.65721236472334, -40.060899942798, -131.34972591980252, -90.45617727423152, -156.67903409009688, -185.20538856650518, -305.8324481938645, -107.07152285157302, -142.42541218412157, -247.40728713458984, -202.73513667031375, -179.96046075995312, -302.87533502852074, -302.16640472580934, -72.96772783965486, -123.20029157770132, -182.07159511362315, -134.49383385333877, -308.7512672200618, -81.42523060887045, -258.8729596025168, -148.40349175319804, -379.39496167319334, -106.57684740842457, -48.00639976036632, -273.6880196058365, -194.44299821781215, -260.39548680653115, -307.2320730987623, -339.839963703658, -323.6321488400655, -181.69353636193753, -159.1745652411028, -136.06478829948142, -278.7292906002875, -158.91701869551247, -131.3980866792227, -258.5588484678848, -168.38083353674892, -128.11150294424488, -84.66647059501491, -157.51661096361985, -147.91302192268952, -238.92631219178634, -220.514823293469, -206.70948111431602, -74.7607830915774, -34.714759363870094, -55.16759610101191, -211.97629848691, -15.488918088877453, -22.67835963049797, -62.53671395310931, 2.0000000000000013, -211.1478262207767, -199.70563619679754, -442.4773650613851, -77.13689642986022, -231.22249748632237, -340.76107059211716, -146.64371027366695, -172.87338646771283, -78.86197933940709, -37.585451246866896, -28.9266253220477, -16.252659039150434, -70.7756337298744, -173.62500113664439, -464.5031005394712, -261.3085959493325, -32.77540400353393, -57.65528329402137, -187.9777496984685, -89.85365543691822, -34.65682802394493, -96.8039796153457, -97.91100667510095, -37.25839006002451, -258.14313894896003, -319.8807400681891, -60.330981787515604, -131.53790518030692, -174.83687112629525, -72.08753495540263, -1.0506217285563684, -88.52388334977297, -81.47819841032438, -146.397226830481, -107.94401025035819, -429.875915546891, -94.84209412967411, -122.66932903882486, -156.35563314182357, -176.1435153343729, -411.8710702084261, -255.64430891224129, -15.975498751994847, -44.19308774488359, -69.67705720352403, -85.44887632241968, 74.14755625886548, -128.05924367704478, -302.7169447472192, -116.61783591427037, -2.8945668331484686, -169.7627667328629, -123.08427561801629, -298.9341962538205, -207.3214911534931, -275.6846003011993, -251.51415473506526, -179.28499705418747, -161.63567085617547, -259.4463152371783, -26.282840413191195, -47.2342683892558, -308.6577719634604, -185.52156014667318, -19.75116747232878, -256.5754046967813, -8.923859238269568, 4.924857002342516, -230.06855258774445, -221.3417444683397, -219.22605076435516, -82.1698991145254, -5.56935276201754, -122.50389940408012, -161.39868903985808, -199.14535569601532, -123.51610563553358, -157.45952648546833, -314.4177043839865, -191.1145572350827, -168.45867949773563, -171.20618777484347, -287.5104391690063, -231.53725406262265, -176.34760230761353, -185.6701666318894, -178.1542745203085, -343.42423769179624, -120.48803989218976, -192.88867929915887, -342.38331401059475, -90.66684305854982, -167.4942926272684, -77.08926202746149, -224.81027157411677, -167.41059625974387, -180.7416679900928, -236.22246772520822, -353.1311722497994, -295.99070073407836, -246.61794557236342, 41.676440266849376, -394.30651303188677, -248.0782781368251, -170.42867093004338, -201.75617841828867, -57.85741667499415, -219.33211183918118, 106.89112584026074, -261.15805537011045, -77.72759645682311, -210.69238098465942, -200.9252648251104, -221.7257606593314, -106.18503594076094, -339.75462966995696, -62.299625419924844, 56.40071452695573, -235.74754592103335, -213.0684421232932, -143.40543373573834, 24.705667267427376, -314.88976359751973, -247.38113728885358, -8.453195612989896, -212.97299420932566], "policy_predator_policy_reward": [217.09386619626446, 417.84637022173825, 157.9644963380872, 233.37960528341347, 187.19400562064388, 154.03154087472234, 190.78192098209314, 191.73166244940782, 258.6762845019222, 404.5596003603995, 206.29631288558363, 221.99961488392967, 187.94130399945053, 138.57520663297038, 126.62986556995152, 125.52521373490515, 217.59436338166492, 101.18821263370047, 196.85061948705226, 216.3237529918303, 109.5460007410415, 115.94366857798447, 135.21340594372853, 95.19111883828357, 187.39002073747693, 188.374920910137, 148.71619452119361, 307.59060895511857, 197.58751253650212, 191.28829023030025, 184.34695319515586, 226.18176252939233, 322.5669982482531, 294.3350982041035, 19.220288860018513, 165.48457838207503, 104.85189884826487, 173.69513605979765, 201.81297718903684, 225.9114695719566, 269.33467260627145, 150.88538766024942, 236.1145194692645, 272.2854651530968, 206.29409710686065, 243.04621976112836, 38.93226335256408, 351.86891412777203, 384.406216299957, 267.7153452054998, 332.3575846116685, 202.4830635178849, 202.1956475560338, 66.32419128528839, 264.8913656402108, 231.72517680980647, 200.5412596899183, 169.79320620286794, 169.4220777014445, 130.93462717848627, 13.719520946735509, 181.45061332527487, 179.55114986148956, 218.07352848520188, 268.04470980366193, 171.35337238190476, 82.24432225416707, 27.23141751939846, 206.10020124438046, 87.38281566188257, 17.753163104916265, 35.07911731773247, 46.46736180204551, 47.1561483333917, 29.133402994773615, 316.96490493741044, 284.4041523781592, 360.5974998352979, 223.36211632773237, 355.1831676350547, 188.07018806042174, 173.7971597010298, 21.553199132987515, 85.72888420487224, 44.42384308565283, 38.43021804999656, 95.14615388560567, 165.08622745105515, 341.2140421287879, 434.4866781922109, 28.562300969889428, 67.65993755025822, 136.37274795019133, 135.46655860654417, 102.37296776160744, 76.37404423734505, 75.98522700682791, 110.0020408028802, 412.9392013016008, 201.18682283303264, 88.47486778715063, 142.70682614290772, 124.72656091359634, 181.7717109746299, 37.55708773775642, 89.28562860947106, 157.54507267234717, 121.54762879525101, 352.5102710423101, 306.59878708751444, 155.17689601743103, 34.37072482412432, 17.37517207717281, 253.19682875226334, 333.8952079036382, 345.9593149975022, 24.133415412247455, 46.835761364992464, 131.94975852183057, 19.829409329820084, 93.3513437801068, 116.34921381872401, 171.0528515622435, 263.9731837571656, 90.3248187400518, 185.32905395125388, 242.33725494789692, 221.86601283851408, 248.19787336172348, 272.45200368975964, 235.12152093505867, 247.61972755955983, 180.18696469025613, 274.9955003150286, 43.0027366774904, 38.18531081634375, 254.22204070475567, 244.0088236999787, 178.62883245404646, 163.31037630521303, 20.854757785478608, 23.492715046250396, 221.18794560087295, 264.8324198788928, 196.74732427211518, 71.42473066156745, 74.3324560810288, 102.16142534895376, 193.19252260675455, 181.1006785486359, 151.53919563989263, 159.5580804967776, 2.035415452509248, 414.9724805652367, 196.4827531611377, 218.18204795455793, 274.03938822718186, 287.99696964586263, 295.8441990873135, 16.6549581021739, 305.96999680009554, 266.99254643653506, 35.67206344688132, 236.14373568758165, 202.8452423611625, 271.1545182367076, 152.0523081752547, 177.77768446142014, 192.1107136717436, 237.70113431618145, 206.62870323489895, 266.8796805927765, 423.5811164797175, 259.58309589855895, 123.23211066045519, 234.9416496714562, 383.47386453887907, 309.2245831910487, 226.5144176972638, 180.73151467494324, 179.2256957120604, 150.01023132447585, 146.49971130300221, 196.0570419262127, 197.01503429745057, 171.0053418200512, 162.43503464464501, 253.73232445537266, 164.5785719301428, 322.42014798830786, 58.478173903695904, 97.7310990200681, 310.81977635218, 156.44687224928447, 114.34319228512634, 112.4158885293958, 271.33277313788903, 271.597515098931, 190.81404577802093, 195.6346420166962]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.5706861481487264, "mean_inference_ms": 6.784234244287002, "mean_action_processing_ms": 1.1523734970494004, "mean_env_wait_ms": 0.9033759438193232, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018454432487487793, "StateBufferConnector_ms": 0.014501690864562988, "ViewRequirementAgentConnector_ms": 0.32679176330566406}, "num_episodes": 18, "episode_return_max": 188.2898236993648, "episode_return_min": -88.52436560132337, "episode_return_mean": 31.638128043718453, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 464000, "num_agent_steps_trained": 464000, "num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 238.97559601579525, "num_env_steps_trained_throughput_per_sec": 238.97559601579525, "timesteps_total": 116000, "num_env_steps_sampled_lifetime": 116000, "num_agent_steps_sampled_lifetime": 464000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 464000, "timers": {"training_iteration_time_ms": 16109.941, "restore_workers_time_ms": 0.014, "training_step_time_ms": 16109.9, "sample_time_ms": 4221.883, "learn_time_ms": 11873.353, "learn_throughput": 336.889, "synch_weights_time_ms": 13.815}, "counters": {"num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_agent_steps_sampled": 464000, "num_agent_steps_trained": 464000}, "done": false, "training_iteration": 29, "trial_id": "d163c_00000", "date": "2024-08-16_12-59-23", "timestamp": 1723793363, "time_this_iter_s": 16.741172075271606, "time_total_s": 584.1551332473755, "pid": 81201, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16af06d30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 584.1551332473755, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 29.745833333333337, "ram_util_percent": 67.3125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.0766932156981612, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.034592316642641, "policy_loss": -0.005888176368174966, "vf_loss": 9.038774467649914, "vf_explained_var": 0.028895589725050345, "kl": 0.011373465916854219, "entropy": 1.3117062339707026, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 55755.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.3336513223471465, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.238711658861272, "policy_loss": -0.00884200713853475, "vf_loss": 9.244357582879445, "vf_explained_var": -0.02374288802424436, "kl": 0.015980333234361096, "entropy": 1.4340060104768744, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 55755.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000}, "env_runners": {"episode_reward_max": 281.3971423850596, "episode_reward_min": -88.52436560132337, "episode_reward_mean": 56.26141064636682, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -464.5031005394712, "predator_policy": 1.6352467701288453}, "policy_reward_max": {"prey_policy": 183.0199540842034, "predator_policy": 434.4866781922109}, "policy_reward_mean": {"prey_policy": -141.85829527460484, "predator_policy": 169.98900059778828}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-38.0183940588994, 37.54794893206135, 12.943608910805974, 22.42817554074348, 127.64589750178602, -64.03730754400692, 5.049524703036157, 29.514962927550815, -26.719514699262092, 58.97023315421747, -19.62246925432141, 3.8643683989370197, -47.01294728662443, 10.78534423221577, 12.17377777778162, 0.00019731811774179042, 26.339122318341108, 14.665002703273048, 33.086796182328044, -64.75515448539053, 125.38739072221212, 6.56171588434753, 42.3502510200727, -9.165347248414271, 37.67477677445069, 15.8317464701425, 49.889023832195484, 5.791551222592517, -5.992098578650789, 47.2862043596612, 50.817871074582115, 36.10214511748426, 39.31280696223571, 59.57386580652831, 37.26821126889749, 51.217276226792386, 121.28913233257477, -27.9638023269435, -61.927147646760254, 12.339143780473316, 10.800590280361668, -3.3467656742930103, 155.7888701806516, 15.691254657919373, 102.99653912529448, 42.18479591457444, 37.64378559679075, 51.94209670536574, 34.10047891193118, 7.670938691387158, 4.05153229459999, 65.61263659014914, 40.34847059580156, 34.61006842368146, -33.22389494519775, 48.420629263884244, 13.74915641951698, 30.12164401566848, -88.52436560132337, 74.99993384311635, 42.98866464141595, -49.51861175001546, 51.38403102452592, -41.56092005688546, 40.94960352872493, 85.24643798194491, 37.590980154064454, 56.54424811237449, 34.0423393943989, 153.23225502639733, 50.31365656121563, 35.06108302387477, 52.04639852236079, 188.2898236993648, 79.60039867601927, -6.483666384424164, 41.059054307733, 150.31036203079455, 18.450660557138086, 108.05931434621093, -19.34061264955383, 165.02249797240142, 26.91636699260173, 226.40214071948105, 234.85251439857365, 216.76689421495624, 24.00355705533617, 281.3971423850596, 126.93702969355162, 111.3561115218154, 44.1074816966413, 263.5442920731873, 166.38063688560672, 174.86785055622153, 141.62617895538048, 182.02807755876646, 90.25751174630742, 249.30263885488534, 178.39435499118377, 199.5800000000002], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-182.07159511362315, -134.49383385333877, -308.7512672200618, -81.42523060887045, -258.8729596025168, -148.40349175319804, -379.39496167319334, -106.57684740842457, -48.00639976036632, -273.6880196058365, -194.44299821781215, -260.39548680653115, -307.2320730987623, -339.839963703658, -323.6321488400655, -181.69353636193753, -159.1745652411028, -136.06478829948142, -278.7292906002875, -158.91701869551247, -131.3980866792227, -258.5588484678848, -168.38083353674892, -128.11150294424488, -84.66647059501491, -157.51661096361985, -147.91302192268952, -238.92631219178634, -220.514823293469, -206.70948111431602, -74.7607830915774, -34.714759363870094, -55.16759610101191, -211.97629848691, -15.488918088877453, -22.67835963049797, -62.53671395310931, 2.0000000000000013, -211.1478262207767, -199.70563619679754, -442.4773650613851, -77.13689642986022, -231.22249748632237, -340.76107059211716, -146.64371027366695, -172.87338646771283, -78.86197933940709, -37.585451246866896, -28.9266253220477, -16.252659039150434, -70.7756337298744, -173.62500113664439, -464.5031005394712, -261.3085959493325, -32.77540400353393, -57.65528329402137, -187.9777496984685, -89.85365543691822, -34.65682802394493, -96.8039796153457, -97.91100667510095, -37.25839006002451, -258.14313894896003, -319.8807400681891, -60.330981787515604, -131.53790518030692, -174.83687112629525, -72.08753495540263, -1.0506217285563684, -88.52388334977297, -81.47819841032438, -146.397226830481, -107.94401025035819, -429.875915546891, -94.84209412967411, -122.66932903882486, -156.35563314182357, -176.1435153343729, -411.8710702084261, -255.64430891224129, -15.975498751994847, -44.19308774488359, -69.67705720352403, -85.44887632241968, 74.14755625886548, -128.05924367704478, -302.7169447472192, -116.61783591427037, -2.8945668331484686, -169.7627667328629, -123.08427561801629, -298.9341962538205, -207.3214911534931, -275.6846003011993, -251.51415473506526, -179.28499705418747, -161.63567085617547, -259.4463152371783, -26.282840413191195, -47.2342683892558, -308.6577719634604, -185.52156014667318, -19.75116747232878, -256.5754046967813, -8.923859238269568, 4.924857002342516, -230.06855258774445, -221.3417444683397, -219.22605076435516, -82.1698991145254, -5.56935276201754, -122.50389940408012, -161.39868903985808, -199.14535569601532, -123.51610563553358, -157.45952648546833, -314.4177043839865, -191.1145572350827, -168.45867949773563, -171.20618777484347, -287.5104391690063, -231.53725406262265, -176.34760230761353, -185.6701666318894, -178.1542745203085, -343.42423769179624, -120.48803989218976, -192.88867929915887, -342.38331401059475, -90.66684305854982, -167.4942926272684, -77.08926202746149, -224.81027157411677, -167.41059625974387, -180.7416679900928, -236.22246772520822, -353.1311722497994, -295.99070073407836, -246.61794557236342, 41.676440266849376, -394.30651303188677, -248.0782781368251, -170.42867093004338, -201.75617841828867, -57.85741667499415, -219.33211183918118, 106.89112584026074, -261.15805537011045, -77.72759645682311, -210.69238098465942, -200.9252648251104, -221.7257606593314, -106.18503594076094, -339.75462966995696, -62.299625419924844, 56.40071452695573, -235.74754592103335, -213.0684421232932, -143.40543373573834, 24.705667267427376, -314.88976359751973, -247.38113728885358, -8.453195612989896, -212.97299420932566, -184.91488204667144, -107.2274090675451, 22.69982516500129, 141.98561661671567, -291.15584486377816, 129.71000000000026, 138.73875919434496, -157.48688201793632, -152.26136597683336, -240.95573376746157, 183.0199540842034, -256.8198884976647, -89.9500429246593, 28.147438190498605, -81.95976676397594, -163.36116671909616, -171.55326007520665, -261.23197701683273, 126.66648479703746, 128.71999999999983, -206.51654020706422, 62.85066917164337, 12.310496720224604, 95.55928132517461, 28.478724173342936, -307.137908300773, -134.19070069983826, 120.39923975431476, -75.35972126983987, 7.083549607205581, 104.25475322987127, 140.8295035680742, 86.26358662868975, -225.63141927341988, 156.5272992729369, 30.722534138849717], "policy_predator_policy_reward": [104.85189884826487, 173.69513605979765, 201.81297718903684, 225.9114695719566, 269.33467260627145, 150.88538766024942, 236.1145194692645, 272.2854651530968, 206.29409710686065, 243.04621976112836, 38.93226335256408, 351.86891412777203, 384.406216299957, 267.7153452054998, 332.3575846116685, 202.4830635178849, 202.1956475560338, 66.32419128528839, 264.8913656402108, 231.72517680980647, 200.5412596899183, 169.79320620286794, 169.4220777014445, 130.93462717848627, 13.719520946735509, 181.45061332527487, 179.55114986148956, 218.07352848520188, 268.04470980366193, 171.35337238190476, 82.24432225416707, 27.23141751939846, 206.10020124438046, 87.38281566188257, 17.753163104916265, 35.07911731773247, 46.46736180204551, 47.1561483333917, 29.133402994773615, 316.96490493741044, 284.4041523781592, 360.5974998352979, 223.36211632773237, 355.1831676350547, 188.07018806042174, 173.7971597010298, 21.553199132987515, 85.72888420487224, 44.42384308565283, 38.43021804999656, 95.14615388560567, 165.08622745105515, 341.2140421287879, 434.4866781922109, 28.562300969889428, 67.65993755025822, 136.37274795019133, 135.46655860654417, 102.37296776160744, 76.37404423734505, 75.98522700682791, 110.0020408028802, 412.9392013016008, 201.18682283303264, 88.47486778715063, 142.70682614290772, 124.72656091359634, 181.7717109746299, 37.55708773775642, 89.28562860947106, 157.54507267234717, 121.54762879525101, 352.5102710423101, 306.59878708751444, 155.17689601743103, 34.37072482412432, 17.37517207717281, 253.19682875226334, 333.8952079036382, 345.9593149975022, 24.133415412247455, 46.835761364992464, 131.94975852183057, 19.829409329820084, 93.3513437801068, 116.34921381872401, 171.0528515622435, 263.9731837571656, 90.3248187400518, 185.32905395125388, 242.33725494789692, 221.86601283851408, 248.19787336172348, 272.45200368975964, 235.12152093505867, 247.61972755955983, 180.18696469025613, 274.9955003150286, 43.0027366774904, 38.18531081634375, 254.22204070475567, 244.0088236999787, 178.62883245404646, 163.31037630521303, 20.854757785478608, 23.492715046250396, 221.18794560087295, 264.8324198788928, 196.74732427211518, 71.42473066156745, 74.3324560810288, 102.16142534895376, 193.19252260675455, 181.1006785486359, 151.53919563989263, 159.5580804967776, 2.035415452509248, 414.9724805652367, 196.4827531611377, 218.18204795455793, 274.03938822718186, 287.99696964586263, 295.8441990873135, 16.6549581021739, 305.96999680009554, 266.99254643653506, 35.67206344688132, 236.14373568758165, 202.8452423611625, 271.1545182367076, 152.0523081752547, 177.77768446142014, 192.1107136717436, 237.70113431618145, 206.62870323489895, 266.8796805927765, 423.5811164797175, 259.58309589855895, 123.23211066045519, 234.9416496714562, 383.47386453887907, 309.2245831910487, 226.5144176972638, 180.73151467494324, 179.2256957120604, 150.01023132447585, 146.49971130300221, 196.0570419262127, 197.01503429745057, 171.0053418200512, 162.43503464464501, 253.73232445537266, 164.5785719301428, 322.42014798830786, 58.478173903695904, 97.7310990200681, 310.81977635218, 156.44687224928447, 114.34319228512634, 112.4158885293958, 271.33277313788903, 271.597515098931, 190.81404577802093, 195.6346420166962, 147.03014145519444, 172.02851665162396, 40.90728736468714, 20.80941157307703, 224.10080053085258, 172.19755873149964, 113.04337179412369, 122.47164524442361, 186.7697659325277, 230.45089086710317, 155.56250541456788, 199.63457138395344, 83.55453390903682, 105.18510051867548, 169.70062141774932, 186.97642358713836, 245.01402062045787, 231.87869816822274, 3.680514861404699, 4.477292414745951, 178.1731028600857, 131.87340506094174, 23.1224354347852, 43.87563707603838, 217.8745424442038, 202.41082063860637, 109.73848432553744, 86.08105417875333, 86.1484959037159, 72.38518750522567, 1.6352467701288453, 2.5831352868116864, 179.22535438590475, 138.53683325000964, 5.592700727063098, 6.737465861150253]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.5527509293148545, "mean_inference_ms": 6.730596654598625, "mean_action_processing_ms": 1.1441213082309885, "mean_env_wait_ms": 0.8971494492040865, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017092227935791016, "StateBufferConnector_ms": 0.014462590217590332, "ViewRequirementAgentConnector_ms": 0.3207359313964844}, "num_episodes": 18, "episode_return_max": 281.3971423850596, "episode_return_min": -88.52436560132337, "episode_return_mean": 56.26141064636682, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 260.8107395744631, "num_env_steps_trained_throughput_per_sec": 260.8107395744631, "timesteps_total": 120000, "num_env_steps_sampled_lifetime": 120000, "num_agent_steps_sampled_lifetime": 480000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 480000, "timers": {"training_iteration_time_ms": 16101.029, "restore_workers_time_ms": 0.014, "training_step_time_ms": 16100.989, "sample_time_ms": 4220.379, "learn_time_ms": 11866.15, "learn_throughput": 337.093, "synch_weights_time_ms": 13.602}, "counters": {"num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000}, "done": false, "training_iteration": 30, "trial_id": "d163c_00000", "date": "2024-08-16_12-59-39", "timestamp": 1723793379, "time_this_iter_s": 15.34110426902771, "time_total_s": 599.4962375164032, "pid": 81201, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16b85adc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 599.4962375164032, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 28.452380952380953, "ram_util_percent": 67.45238095238095}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.3294114320366472, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.741504467858208, "policy_loss": -0.003532847993337012, "vf_loss": 8.743836302732033, "vf_explained_var": -0.019751999113294814, "kl": 0.008006657960276343, "entropy": 1.3245745187713986, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 57645.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.071615677409702, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.43264218537265, "policy_loss": -0.014135053696938687, "vf_loss": 9.443892544034927, "vf_explained_var": 0.06136013294653918, "kl": 0.014423588289951137, "entropy": 1.4472366050437644, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 57645.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_agent_steps_sampled": 496000, "num_agent_steps_trained": 496000}, "env_runners": {"episode_reward_max": 336.5534004840078, "episode_reward_min": -88.52436560132337, "episode_reward_mean": 93.46993824323754, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -464.5031005394712, "predator_policy": 0.1648645219761486}, "policy_reward_max": {"prey_policy": 190.09999999999997, "predator_policy": 434.4866781922109}, "policy_reward_mean": {"prey_policy": -102.87522360810661, "predator_policy": 149.61019272972538}, "custom_metrics": {}, "hist_stats": {"episode_reward": [33.086796182328044, -64.75515448539053, 125.38739072221212, 6.56171588434753, 42.3502510200727, -9.165347248414271, 37.67477677445069, 15.8317464701425, 49.889023832195484, 5.791551222592517, -5.992098578650789, 47.2862043596612, 50.817871074582115, 36.10214511748426, 39.31280696223571, 59.57386580652831, 37.26821126889749, 51.217276226792386, 121.28913233257477, -27.9638023269435, -61.927147646760254, 12.339143780473316, 10.800590280361668, -3.3467656742930103, 155.7888701806516, 15.691254657919373, 102.99653912529448, 42.18479591457444, 37.64378559679075, 51.94209670536574, 34.10047891193118, 7.670938691387158, 4.05153229459999, 65.61263659014914, 40.34847059580156, 34.61006842368146, -33.22389494519775, 48.420629263884244, 13.74915641951698, 30.12164401566848, -88.52436560132337, 74.99993384311635, 42.98866464141595, -49.51861175001546, 51.38403102452592, -41.56092005688546, 40.94960352872493, 85.24643798194491, 37.590980154064454, 56.54424811237449, 34.0423393943989, 153.23225502639733, 50.31365656121563, 35.06108302387477, 52.04639852236079, 188.2898236993648, 79.60039867601927, -6.483666384424164, 41.059054307733, 150.31036203079455, 18.450660557138086, 108.05931434621093, -19.34061264955383, 165.02249797240142, 26.91636699260173, 226.40214071948105, 234.85251439857365, 216.76689421495624, 24.00355705533617, 281.3971423850596, 126.93702969355162, 111.3561115218154, 44.1074816966413, 263.5442920731873, 166.38063688560672, 174.86785055622153, 141.62617895538048, 182.02807755876646, 90.25751174630742, 249.30263885488534, 178.39435499118377, 199.5800000000002, 84.77031760128054, 251.48509305597338, 117.79686391510506, 210.24314180538883, 147.70257634021365, 336.5534004840078, 247.45505947691004, 319.5398122561297, 299.90522601276086, 295.24449075252994, 172.5797657887161, 167.6535740763627, 101.73499066996904, 269.48536538303506, 172.58354812771296, 200.49632261135224, 189.36012197955222, 302.7806209258228], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-62.53671395310931, 2.0000000000000013, -211.1478262207767, -199.70563619679754, -442.4773650613851, -77.13689642986022, -231.22249748632237, -340.76107059211716, -146.64371027366695, -172.87338646771283, -78.86197933940709, -37.585451246866896, -28.9266253220477, -16.252659039150434, -70.7756337298744, -173.62500113664439, -464.5031005394712, -261.3085959493325, -32.77540400353393, -57.65528329402137, -187.9777496984685, -89.85365543691822, -34.65682802394493, -96.8039796153457, -97.91100667510095, -37.25839006002451, -258.14313894896003, -319.8807400681891, -60.330981787515604, -131.53790518030692, -174.83687112629525, -72.08753495540263, -1.0506217285563684, -88.52388334977297, -81.47819841032438, -146.397226830481, -107.94401025035819, -429.875915546891, -94.84209412967411, -122.66932903882486, -156.35563314182357, -176.1435153343729, -411.8710702084261, -255.64430891224129, -15.975498751994847, -44.19308774488359, -69.67705720352403, -85.44887632241968, 74.14755625886548, -128.05924367704478, -302.7169447472192, -116.61783591427037, -2.8945668331484686, -169.7627667328629, -123.08427561801629, -298.9341962538205, -207.3214911534931, -275.6846003011993, -251.51415473506526, -179.28499705418747, -161.63567085617547, -259.4463152371783, -26.282840413191195, -47.2342683892558, -308.6577719634604, -185.52156014667318, -19.75116747232878, -256.5754046967813, -8.923859238269568, 4.924857002342516, -230.06855258774445, -221.3417444683397, -219.22605076435516, -82.1698991145254, -5.56935276201754, -122.50389940408012, -161.39868903985808, -199.14535569601532, -123.51610563553358, -157.45952648546833, -314.4177043839865, -191.1145572350827, -168.45867949773563, -171.20618777484347, -287.5104391690063, -231.53725406262265, -176.34760230761353, -185.6701666318894, -178.1542745203085, -343.42423769179624, -120.48803989218976, -192.88867929915887, -342.38331401059475, -90.66684305854982, -167.4942926272684, -77.08926202746149, -224.81027157411677, -167.41059625974387, -180.7416679900928, -236.22246772520822, -353.1311722497994, -295.99070073407836, -246.61794557236342, 41.676440266849376, -394.30651303188677, -248.0782781368251, -170.42867093004338, -201.75617841828867, -57.85741667499415, -219.33211183918118, 106.89112584026074, -261.15805537011045, -77.72759645682311, -210.69238098465942, -200.9252648251104, -221.7257606593314, -106.18503594076094, -339.75462966995696, -62.299625419924844, 56.40071452695573, -235.74754592103335, -213.0684421232932, -143.40543373573834, 24.705667267427376, -314.88976359751973, -247.38113728885358, -8.453195612989896, -212.97299420932566, -184.91488204667144, -107.2274090675451, 22.69982516500129, 141.98561661671567, -291.15584486377816, 129.71000000000026, 138.73875919434496, -157.48688201793632, -152.26136597683336, -240.95573376746157, 183.0199540842034, -256.8198884976647, -89.9500429246593, 28.147438190498605, -81.95976676397594, -163.36116671909616, -171.55326007520665, -261.23197701683273, 126.66648479703746, 128.71999999999983, -206.51654020706422, 62.85066917164337, 12.310496720224604, 95.55928132517461, 28.478724173342936, -307.137908300773, -134.19070069983826, 120.39923975431476, -75.35972126983987, 7.083549607205581, 104.25475322987127, 140.8295035680742, 86.26358662868975, -225.63141927341988, 156.5272992729369, 30.722534138849717, -210.19198740254672, 1.9331298370367467, 175.85368290807577, -132.56736651379592, -78.18800270209778, -141.29862999527376, 83.82347514213932, 22.406504202179477, 47.56629155877869, 18.42019768876085, 174.01921925887473, 144.75399823569504, 146.9882165343427, -295.56973434372236, 159.3152072049153, 133.76128547066742, 140.22416198992093, 150.19069723388094, 37.14668173536793, 190.09999999999997, 6.200535638845253, -164.18368031728397, -109.56696585146788, 102.43613229476517, -73.71100652376187, 21.97034729834304, 104.27958567838584, 140.7586037726839, 93.6918088836052, -2.0876178034589863, -99.65971669130033, 143.57067172529742, 41.94416994992601, 132.31693743195447, 150.45041574224732, 120.22790109134634], "policy_predator_policy_reward": [46.46736180204551, 47.1561483333917, 29.133402994773615, 316.96490493741044, 284.4041523781592, 360.5974998352979, 223.36211632773237, 355.1831676350547, 188.07018806042174, 173.7971597010298, 21.553199132987515, 85.72888420487224, 44.42384308565283, 38.43021804999656, 95.14615388560567, 165.08622745105515, 341.2140421287879, 434.4866781922109, 28.562300969889428, 67.65993755025822, 136.37274795019133, 135.46655860654417, 102.37296776160744, 76.37404423734505, 75.98522700682791, 110.0020408028802, 412.9392013016008, 201.18682283303264, 88.47486778715063, 142.70682614290772, 124.72656091359634, 181.7717109746299, 37.55708773775642, 89.28562860947106, 157.54507267234717, 121.54762879525101, 352.5102710423101, 306.59878708751444, 155.17689601743103, 34.37072482412432, 17.37517207717281, 253.19682875226334, 333.8952079036382, 345.9593149975022, 24.133415412247455, 46.835761364992464, 131.94975852183057, 19.829409329820084, 93.3513437801068, 116.34921381872401, 171.0528515622435, 263.9731837571656, 90.3248187400518, 185.32905395125388, 242.33725494789692, 221.86601283851408, 248.19787336172348, 272.45200368975964, 235.12152093505867, 247.61972755955983, 180.18696469025613, 274.9955003150286, 43.0027366774904, 38.18531081634375, 254.22204070475567, 244.0088236999787, 178.62883245404646, 163.31037630521303, 20.854757785478608, 23.492715046250396, 221.18794560087295, 264.8324198788928, 196.74732427211518, 71.42473066156745, 74.3324560810288, 102.16142534895376, 193.19252260675455, 181.1006785486359, 151.53919563989263, 159.5580804967776, 2.035415452509248, 414.9724805652367, 196.4827531611377, 218.18204795455793, 274.03938822718186, 287.99696964586263, 295.8441990873135, 16.6549581021739, 305.96999680009554, 266.99254643653506, 35.67206344688132, 236.14373568758165, 202.8452423611625, 271.1545182367076, 152.0523081752547, 177.77768446142014, 192.1107136717436, 237.70113431618145, 206.62870323489895, 266.8796805927765, 423.5811164797175, 259.58309589855895, 123.23211066045519, 234.9416496714562, 383.47386453887907, 309.2245831910487, 226.5144176972638, 180.73151467494324, 179.2256957120604, 150.01023132447585, 146.49971130300221, 196.0570419262127, 197.01503429745057, 171.0053418200512, 162.43503464464501, 253.73232445537266, 164.5785719301428, 322.42014798830786, 58.478173903695904, 97.7310990200681, 310.81977635218, 156.44687224928447, 114.34319228512634, 112.4158885293958, 271.33277313788903, 271.597515098931, 190.81404577802093, 195.6346420166962, 147.03014145519444, 172.02851665162396, 40.90728736468714, 20.80941157307703, 224.10080053085258, 172.19755873149964, 113.04337179412369, 122.47164524442361, 186.7697659325277, 230.45089086710317, 155.56250541456788, 199.63457138395344, 83.55453390903682, 105.18510051867548, 169.70062141774932, 186.97642358713836, 245.01402062045787, 231.87869816822274, 3.680514861404699, 4.477292414745951, 178.1731028600857, 131.87340506094174, 23.1224354347852, 43.87563707603838, 217.8745424442038, 202.41082063860637, 109.73848432553744, 86.08105417875333, 86.1484959037159, 72.38518750522567, 1.6352467701288453, 2.5831352868116864, 179.22535438590475, 138.53683325000964, 5.592700727063098, 6.737465861150253, 87.46157909412506, 205.56759607266517, 114.34402499824454, 93.85475166344894, 124.22201582449821, 213.06148078797807, 30.72470108155576, 73.28846137951457, 50.8914216506154, 30.82466544205825, 17.615318467462114, 0.1648645219761486, 214.44445604348573, 181.5921212428039, 16.066609728555846, 10.396709851991128, 2.905006017765823, 6.5853607711932325, 36.30742229929401, 31.690386717868225, 174.54564373354484, 156.01726673361023, 92.45708685623742, 82.32732077682817, 68.87832901087855, 84.59732088450914, 3.8094378428982996, 20.63773808906704, 58.6581135143982, 22.321243533168413, 62.70418704701294, 93.8811805303422, 8.363116383772851, 6.735898213899602, 25.756192312812487, 6.346111779416784]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.5353268471576236, "mean_inference_ms": 6.681137725211072, "mean_action_processing_ms": 1.1360553674995935, "mean_env_wait_ms": 0.8912695682295415, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014589786529541016, "StateBufferConnector_ms": 0.014319419860839844, "ViewRequirementAgentConnector_ms": 0.3051081895828247}, "num_episodes": 18, "episode_return_max": 336.5534004840078, "episode_return_min": -88.52436560132337, "episode_return_mean": 93.46993824323754, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 496000, "num_agent_steps_trained": 496000, "num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 256.14557101123523, "num_env_steps_trained_throughput_per_sec": 256.14557101123523, "timesteps_total": 124000, "num_env_steps_sampled_lifetime": 124000, "num_agent_steps_sampled_lifetime": 496000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 496000, "timers": {"training_iteration_time_ms": 16086.16, "restore_workers_time_ms": 0.014, "training_step_time_ms": 16086.119, "sample_time_ms": 4244.008, "learn_time_ms": 11827.888, "learn_throughput": 338.184, "synch_weights_time_ms": 13.414}, "counters": {"num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_agent_steps_sampled": 496000, "num_agent_steps_trained": 496000}, "done": false, "training_iteration": 31, "trial_id": "d163c_00000", "date": "2024-08-16_12-59-54", "timestamp": 1723793394, "time_this_iter_s": 15.619889974594116, "time_total_s": 615.1161274909973, "pid": 81201, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16b879a60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 615.1161274909973, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 28.040909090909096, "ram_util_percent": 67.52272727272727}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.015817710773024, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.9681558046391405, "policy_loss": 0.000743666338542151, "vf_loss": 7.965340450074938, "vf_explained_var": -0.3910521625210999, "kl": 0.013811035772570061, "entropy": 1.309406163074352, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 59535.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.1362114127035494, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.445084398259562, "policy_loss": -0.005900568233201744, "vf_loss": 9.449424356127542, "vf_explained_var": 0.006624603460705469, "kl": 0.007803085375076536, "entropy": 1.4486668561501477, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 59535.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 512000, "num_agent_steps_trained": 512000}, "env_runners": {"episode_reward_max": 360.34000000000003, "episode_reward_min": -88.52436560132337, "episode_reward_mean": 159.95311062264958, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -394.30651303188677, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 198.83819340147488, "predator_policy": 423.5811164797175}, "policy_reward_mean": {"prey_policy": -37.972821094006065, "predator_policy": 117.94937640533088}, "custom_metrics": {}, "hist_stats": {"episode_reward": [42.18479591457444, 37.64378559679075, 51.94209670536574, 34.10047891193118, 7.670938691387158, 4.05153229459999, 65.61263659014914, 40.34847059580156, 34.61006842368146, -33.22389494519775, 48.420629263884244, 13.74915641951698, 30.12164401566848, -88.52436560132337, 74.99993384311635, 42.98866464141595, -49.51861175001546, 51.38403102452592, -41.56092005688546, 40.94960352872493, 85.24643798194491, 37.590980154064454, 56.54424811237449, 34.0423393943989, 153.23225502639733, 50.31365656121563, 35.06108302387477, 52.04639852236079, 188.2898236993648, 79.60039867601927, -6.483666384424164, 41.059054307733, 150.31036203079455, 18.450660557138086, 108.05931434621093, -19.34061264955383, 165.02249797240142, 26.91636699260173, 226.40214071948105, 234.85251439857365, 216.76689421495624, 24.00355705533617, 281.3971423850596, 126.93702969355162, 111.3561115218154, 44.1074816966413, 263.5442920731873, 166.38063688560672, 174.86785055622153, 141.62617895538048, 182.02807755876646, 90.25751174630742, 249.30263885488534, 178.39435499118377, 199.5800000000002, 84.77031760128054, 251.48509305597338, 117.79686391510506, 210.24314180538883, 147.70257634021365, 336.5534004840078, 247.45505947691004, 319.5398122561297, 299.90522601276086, 295.24449075252994, 172.5797657887161, 167.6535740763627, 101.73499066996904, 269.48536538303506, 172.58354812771296, 200.49632261135224, 189.36012197955222, 302.7806209258228, 259.94494300735516, 330.31200270749105, 249.2577969883796, 10.522158995023236, 346.8346886247601, 331.90057332987317, 161.1682903791432, 313.29728415351144, 354.3780758752116, 333.07443538244405, 303.0143881120282, 264.20500988348783, 236.21114435054426, 338.4761536230017, 267.712447856765, 278.964779861, 360.34000000000003, 316.01121360937873, 12.221877075211484, 349.09043692144223, 324.65000000000003, 221.54775447643848, 292.70000000000005, 333.68112999322545, 306.0963525833556, 321.40795386579987, 315.2031936076774], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-123.08427561801629, -298.9341962538205, -207.3214911534931, -275.6846003011993, -251.51415473506526, -179.28499705418747, -161.63567085617547, -259.4463152371783, -26.282840413191195, -47.2342683892558, -308.6577719634604, -185.52156014667318, -19.75116747232878, -256.5754046967813, -8.923859238269568, 4.924857002342516, -230.06855258774445, -221.3417444683397, -219.22605076435516, -82.1698991145254, -5.56935276201754, -122.50389940408012, -161.39868903985808, -199.14535569601532, -123.51610563553358, -157.45952648546833, -314.4177043839865, -191.1145572350827, -168.45867949773563, -171.20618777484347, -287.5104391690063, -231.53725406262265, -176.34760230761353, -185.6701666318894, -178.1542745203085, -343.42423769179624, -120.48803989218976, -192.88867929915887, -342.38331401059475, -90.66684305854982, -167.4942926272684, -77.08926202746149, -224.81027157411677, -167.41059625974387, -180.7416679900928, -236.22246772520822, -353.1311722497994, -295.99070073407836, -246.61794557236342, 41.676440266849376, -394.30651303188677, -248.0782781368251, -170.42867093004338, -201.75617841828867, -57.85741667499415, -219.33211183918118, 106.89112584026074, -261.15805537011045, -77.72759645682311, -210.69238098465942, -200.9252648251104, -221.7257606593314, -106.18503594076094, -339.75462966995696, -62.299625419924844, 56.40071452695573, -235.74754592103335, -213.0684421232932, -143.40543373573834, 24.705667267427376, -314.88976359751973, -247.38113728885358, -8.453195612989896, -212.97299420932566, -184.91488204667144, -107.2274090675451, 22.69982516500129, 141.98561661671567, -291.15584486377816, 129.71000000000026, 138.73875919434496, -157.48688201793632, -152.26136597683336, -240.95573376746157, 183.0199540842034, -256.8198884976647, -89.9500429246593, 28.147438190498605, -81.95976676397594, -163.36116671909616, -171.55326007520665, -261.23197701683273, 126.66648479703746, 128.71999999999983, -206.51654020706422, 62.85066917164337, 12.310496720224604, 95.55928132517461, 28.478724173342936, -307.137908300773, -134.19070069983826, 120.39923975431476, -75.35972126983987, 7.083549607205581, 104.25475322987127, 140.8295035680742, 86.26358662868975, -225.63141927341988, 156.5272992729369, 30.722534138849717, -210.19198740254672, 1.9331298370367467, 175.85368290807577, -132.56736651379592, -78.18800270209778, -141.29862999527376, 83.82347514213932, 22.406504202179477, 47.56629155877869, 18.42019768876085, 174.01921925887473, 144.75399823569504, 146.9882165343427, -295.56973434372236, 159.3152072049153, 133.76128547066742, 140.22416198992093, 150.19069723388094, 37.14668173536793, 190.09999999999997, 6.200535638845253, -164.18368031728397, -109.56696585146788, 102.43613229476517, -73.71100652376187, 21.97034729834304, 104.27958567838584, 140.7586037726839, 93.6918088836052, -2.0876178034589863, -99.65971669130033, 143.57067172529742, 41.94416994992601, 132.31693743195447, 150.45041574224732, 120.22790109134634, 119.78753323217614, 75.0406513563081, 172.09542449673359, 119.6560957206858, 21.324977887288988, 159.82053142868608, -118.24982669576076, -278.95929865189413, 181.6807686867725, 143.6749587899464, 149.05767640075686, 162.76032823577563, -23.699664315054896, -3.7456865162489237, 113.07582189088379, 187.28725214678218, 181.18999999999994, 153.43719800815092, 136.10602282724298, 150.19813813491692, 198.83819340147488, 93.08907505617816, 126.13036498949154, 94.57325624287762, -6.137836325562307, 173.5024225381317, 138.70573510989877, 157.43, 151.6313592115131, 52.79525555223848, -278.0804175450887, 190.92626305862655, 166.33999999999997, 192.68284688422227, 124.9416031314678, 164.44778486688364, -201.6770175414292, -161.11710482896902, 165.32643848378842, 173.20309592386704, 145.22579066798863, 176.47413905623813, 136.73252564496545, -83.25532421744262, 148.552221542394, 130.27552474949704, 188.39391680964243, 140.2162265593988, 157.32504812469102, 135.60978472908133, 121.21712093315148, 178.759418529913, 140.34057774090988, 145.47556426709903], "policy_predator_policy_reward": [242.33725494789692, 221.86601283851408, 248.19787336172348, 272.45200368975964, 235.12152093505867, 247.61972755955983, 180.18696469025613, 274.9955003150286, 43.0027366774904, 38.18531081634375, 254.22204070475567, 244.0088236999787, 178.62883245404646, 163.31037630521303, 20.854757785478608, 23.492715046250396, 221.18794560087295, 264.8324198788928, 196.74732427211518, 71.42473066156745, 74.3324560810288, 102.16142534895376, 193.19252260675455, 181.1006785486359, 151.53919563989263, 159.5580804967776, 2.035415452509248, 414.9724805652367, 196.4827531611377, 218.18204795455793, 274.03938822718186, 287.99696964586263, 295.8441990873135, 16.6549581021739, 305.96999680009554, 266.99254643653506, 35.67206344688132, 236.14373568758165, 202.8452423611625, 271.1545182367076, 152.0523081752547, 177.77768446142014, 192.1107136717436, 237.70113431618145, 206.62870323489895, 266.8796805927765, 423.5811164797175, 259.58309589855895, 123.23211066045519, 234.9416496714562, 383.47386453887907, 309.2245831910487, 226.5144176972638, 180.73151467494324, 179.2256957120604, 150.01023132447585, 146.49971130300221, 196.0570419262127, 197.01503429745057, 171.0053418200512, 162.43503464464501, 253.73232445537266, 164.5785719301428, 322.42014798830786, 58.478173903695904, 97.7310990200681, 310.81977635218, 156.44687224928447, 114.34319228512634, 112.4158885293958, 271.33277313788903, 271.597515098931, 190.81404577802093, 195.6346420166962, 147.03014145519444, 172.02851665162396, 40.90728736468714, 20.80941157307703, 224.10080053085258, 172.19755873149964, 113.04337179412369, 122.47164524442361, 186.7697659325277, 230.45089086710317, 155.56250541456788, 199.63457138395344, 83.55453390903682, 105.18510051867548, 169.70062141774932, 186.97642358713836, 245.01402062045787, 231.87869816822274, 3.680514861404699, 4.477292414745951, 178.1731028600857, 131.87340506094174, 23.1224354347852, 43.87563707603838, 217.8745424442038, 202.41082063860637, 109.73848432553744, 86.08105417875333, 86.1484959037159, 72.38518750522567, 1.6352467701288453, 2.5831352868116864, 179.22535438590475, 138.53683325000964, 5.592700727063098, 6.737465861150253, 87.46157909412506, 205.56759607266517, 114.34402499824454, 93.85475166344894, 124.22201582449821, 213.06148078797807, 30.72470108155576, 73.28846137951457, 50.8914216506154, 30.82466544205825, 17.615318467462114, 0.1648645219761486, 214.44445604348573, 181.5921212428039, 16.066609728555846, 10.396709851991128, 2.905006017765823, 6.5853607711932325, 36.30742229929401, 31.690386717868225, 174.54564373354484, 156.01726673361023, 92.45708685623742, 82.32732077682817, 68.87832901087855, 84.59732088450914, 3.8094378428982996, 20.63773808906704, 58.6581135143982, 22.321243533168413, 62.70418704701294, 93.8811805303422, 8.363116383772851, 6.735898213899602, 25.756192312812487, 6.346111779416784, 36.39276426318753, 28.7239941556839, 24.1389898002683, 14.421492689803395, 40.01865522561937, 28.093632446785442, 258.2829171949025, 149.44836714777537, 10.997695046802743, 10.481266101238473, 15.976646901312803, 4.105921792027832, 102.0672562965619, 86.54638491388414, 7.438716887722717, 5.495493228122839, 7.799204680261569, 11.951673186799232, 34.903028313199464, 11.867246107084911, 9.666635177638078, 1.4204844767370275, 21.73315794265511, 21.768230708463495, 33.99805196538246, 34.84850617259261, 37.998019628683096, 4.342398884419868, 36.788791168804, 26.497041924209363, 134.03932505465968, 232.07960929280281, 1.3171531157777367, 0.0, 5.83499104431312, 20.78683456671421, 234.9804866459975, 140.03551279961232, 2.1129380191376517, 8.447964494649101, 0.7258609437618729, 2.224209332011347, 76.94595708895032, 91.12459595996525, 10.242694396815233, 3.629559311293773, 3.0109866858151775, 2.059999938369092, 9.514783390468995, 3.646736339114624, 10.59831304839939, 10.833101354336224, 7.944424029758177, 21.442627569910304]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.512990818718327, "mean_inference_ms": 6.616445265431782, "mean_action_processing_ms": 1.1243255989823586, "mean_env_wait_ms": 0.8823567697989947, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008425712585449219, "StateBufferConnector_ms": 0.017696142196655273, "ViewRequirementAgentConnector_ms": 0.29553771018981934}, "num_episodes": 27, "episode_return_max": 360.34000000000003, "episode_return_min": -88.52436560132337, "episode_return_mean": 159.95311062264958, "episodes_this_iter": 27}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 512000, "num_agent_steps_trained": 512000, "num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 227.3267796170515, "num_env_steps_trained_throughput_per_sec": 227.3267796170515, "timesteps_total": 128000, "num_env_steps_sampled_lifetime": 128000, "num_agent_steps_sampled_lifetime": 512000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 512000, "timers": {"training_iteration_time_ms": 16115.92, "restore_workers_time_ms": 0.014, "training_step_time_ms": 16115.879, "sample_time_ms": 4247.187, "learn_time_ms": 11854.289, "learn_throughput": 337.431, "synch_weights_time_ms": 13.585}, "counters": {"num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 512000, "num_agent_steps_trained": 512000}, "done": false, "training_iteration": 32, "trial_id": "d163c_00000", "date": "2024-08-16_13-00-12", "timestamp": 1723793412, "time_this_iter_s": 17.60016107559204, "time_total_s": 632.7162885665894, "pid": 81201, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16b87c3a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 632.7162885665894, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 30.999999999999996, "ram_util_percent": 67.16000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.556508949130931, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.319482984492388, "policy_loss": -0.001707615837868717, "vf_loss": 7.319946848904645, "vf_explained_var": -0.2595260958822947, "kl": 0.008291583555647903, "entropy": 1.2914083398208416, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 61425.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.9976189944163831, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.510049615082917, "policy_loss": -0.006643341026125998, "vf_loss": 9.51395011629377, "vf_explained_var": -0.02860865731718679, "kl": 0.013714233876112397, "entropy": 1.3945840840617185, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 61425.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 528000, "num_agent_steps_trained": 528000}, "env_runners": {"episode_reward_max": 384.6596330508606, "episode_reward_min": -41.56092005688546, "episode_reward_mean": 214.6669507214627, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -394.30651303188677, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 198.83819340147488, "predator_policy": 423.5811164797175}, "policy_reward_mean": {"prey_policy": 20.95029787190452, "predator_policy": 86.38317748882687}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-41.56092005688546, 40.94960352872493, 85.24643798194491, 37.590980154064454, 56.54424811237449, 34.0423393943989, 153.23225502639733, 50.31365656121563, 35.06108302387477, 52.04639852236079, 188.2898236993648, 79.60039867601927, -6.483666384424164, 41.059054307733, 150.31036203079455, 18.450660557138086, 108.05931434621093, -19.34061264955383, 165.02249797240142, 26.91636699260173, 226.40214071948105, 234.85251439857365, 216.76689421495624, 24.00355705533617, 281.3971423850596, 126.93702969355162, 111.3561115218154, 44.1074816966413, 263.5442920731873, 166.38063688560672, 174.86785055622153, 141.62617895538048, 182.02807755876646, 90.25751174630742, 249.30263885488534, 178.39435499118377, 199.5800000000002, 84.77031760128054, 251.48509305597338, 117.79686391510506, 210.24314180538883, 147.70257634021365, 336.5534004840078, 247.45505947691004, 319.5398122561297, 299.90522601276086, 295.24449075252994, 172.5797657887161, 167.6535740763627, 101.73499066996904, 269.48536538303506, 172.58354812771296, 200.49632261135224, 189.36012197955222, 302.7806209258228, 259.94494300735516, 330.31200270749105, 249.2577969883796, 10.522158995023236, 346.8346886247601, 331.90057332987317, 161.1682903791432, 313.29728415351144, 354.3780758752116, 333.07443538244405, 303.0143881120282, 264.20500988348783, 236.21114435054426, 338.4761536230017, 267.712447856765, 278.964779861, 360.34000000000003, 316.01121360937873, 12.221877075211484, 349.09043692144223, 324.65000000000003, 221.54775447643848, 292.70000000000005, 333.68112999322545, 306.0963525833556, 321.40795386579987, 315.2031936076774, 290.3767277566546, 334.63423509908006, 321.1557911986291, 326.7707146049962, 284.1307306560258, 340.49883635376716, 324.503584808024, 336.5262886806666, 278.85999999999996, 376.9703556660856, 334.1326220577495, 284.7784103476554, 344.1199999999999, 384.6596330508606, 277.58300091408057, 362.2863259309548, 364.538743391961, 313.4199999999999], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-120.48803989218976, -192.88867929915887, -342.38331401059475, -90.66684305854982, -167.4942926272684, -77.08926202746149, -224.81027157411677, -167.41059625974387, -180.7416679900928, -236.22246772520822, -353.1311722497994, -295.99070073407836, -246.61794557236342, 41.676440266849376, -394.30651303188677, -248.0782781368251, -170.42867093004338, -201.75617841828867, -57.85741667499415, -219.33211183918118, 106.89112584026074, -261.15805537011045, -77.72759645682311, -210.69238098465942, -200.9252648251104, -221.7257606593314, -106.18503594076094, -339.75462966995696, -62.299625419924844, 56.40071452695573, -235.74754592103335, -213.0684421232932, -143.40543373573834, 24.705667267427376, -314.88976359751973, -247.38113728885358, -8.453195612989896, -212.97299420932566, -184.91488204667144, -107.2274090675451, 22.69982516500129, 141.98561661671567, -291.15584486377816, 129.71000000000026, 138.73875919434496, -157.48688201793632, -152.26136597683336, -240.95573376746157, 183.0199540842034, -256.8198884976647, -89.9500429246593, 28.147438190498605, -81.95976676397594, -163.36116671909616, -171.55326007520665, -261.23197701683273, 126.66648479703746, 128.71999999999983, -206.51654020706422, 62.85066917164337, 12.310496720224604, 95.55928132517461, 28.478724173342936, -307.137908300773, -134.19070069983826, 120.39923975431476, -75.35972126983987, 7.083549607205581, 104.25475322987127, 140.8295035680742, 86.26358662868975, -225.63141927341988, 156.5272992729369, 30.722534138849717, -210.19198740254672, 1.9331298370367467, 175.85368290807577, -132.56736651379592, -78.18800270209778, -141.29862999527376, 83.82347514213932, 22.406504202179477, 47.56629155877869, 18.42019768876085, 174.01921925887473, 144.75399823569504, 146.9882165343427, -295.56973434372236, 159.3152072049153, 133.76128547066742, 140.22416198992093, 150.19069723388094, 37.14668173536793, 190.09999999999997, 6.200535638845253, -164.18368031728397, -109.56696585146788, 102.43613229476517, -73.71100652376187, 21.97034729834304, 104.27958567838584, 140.7586037726839, 93.6918088836052, -2.0876178034589863, -99.65971669130033, 143.57067172529742, 41.94416994992601, 132.31693743195447, 150.45041574224732, 120.22790109134634, 119.78753323217614, 75.0406513563081, 172.09542449673359, 119.6560957206858, 21.324977887288988, 159.82053142868608, -118.24982669576076, -278.95929865189413, 181.6807686867725, 143.6749587899464, 149.05767640075686, 162.76032823577563, -23.699664315054896, -3.7456865162489237, 113.07582189088379, 187.28725214678218, 181.18999999999994, 153.43719800815092, 136.10602282724298, 150.19813813491692, 198.83819340147488, 93.08907505617816, 126.13036498949154, 94.57325624287762, -6.137836325562307, 173.5024225381317, 138.70573510989877, 157.43, 151.6313592115131, 52.79525555223848, -278.0804175450887, 190.92626305862655, 166.33999999999997, 192.68284688422227, 124.9416031314678, 164.44778486688364, -201.6770175414292, -161.11710482896902, 165.32643848378842, 173.20309592386704, 145.22579066798863, 176.47413905623813, 136.73252564496545, -83.25532421744262, 148.552221542394, 130.27552474949704, 188.39391680964243, 140.2162265593988, 157.32504812469102, 135.60978472908133, 121.21712093315148, 178.759418529913, 140.34057774090988, 145.47556426709903, 174.64075519501625, 93.07155681259339, 178.52811016621223, 128.62452022386634, 83.81515479297848, 165.66525872701376, 152.8362791466992, 106.18630828904253, 139.5068556337795, 115.27025809469225, 111.26466228296339, 184.00328737284553, 150.52371336695361, 154.4676216487938, 152.04902866777633, 173.416702934459, 169.10364645069563, 94.24081850501489, 193.19766617100652, 177.7812202997324, 125.89375316602953, 184.82655289185217, 129.39093415886558, 131.12763072675205, 152.7514011647886, 178.15896243376625, 195.3733768535008, 171.7562843533347, 102.69996283986474, 127.74229763679791, 175.91531703111576, 180.2, 178.768286496955, 185.14999999999986, 143.94725583920368, 147.56035704758244], "policy_predator_policy_reward": [35.67206344688132, 236.14373568758165, 202.8452423611625, 271.1545182367076, 152.0523081752547, 177.77768446142014, 192.1107136717436, 237.70113431618145, 206.62870323489895, 266.8796805927765, 423.5811164797175, 259.58309589855895, 123.23211066045519, 234.9416496714562, 383.47386453887907, 309.2245831910487, 226.5144176972638, 180.73151467494324, 179.2256957120604, 150.01023132447585, 146.49971130300221, 196.0570419262127, 197.01503429745057, 171.0053418200512, 162.43503464464501, 253.73232445537266, 164.5785719301428, 322.42014798830786, 58.478173903695904, 97.7310990200681, 310.81977635218, 156.44687224928447, 114.34319228512634, 112.4158885293958, 271.33277313788903, 271.597515098931, 190.81404577802093, 195.6346420166962, 147.03014145519444, 172.02851665162396, 40.90728736468714, 20.80941157307703, 224.10080053085258, 172.19755873149964, 113.04337179412369, 122.47164524442361, 186.7697659325277, 230.45089086710317, 155.56250541456788, 199.63457138395344, 83.55453390903682, 105.18510051867548, 169.70062141774932, 186.97642358713836, 245.01402062045787, 231.87869816822274, 3.680514861404699, 4.477292414745951, 178.1731028600857, 131.87340506094174, 23.1224354347852, 43.87563707603838, 217.8745424442038, 202.41082063860637, 109.73848432553744, 86.08105417875333, 86.1484959037159, 72.38518750522567, 1.6352467701288453, 2.5831352868116864, 179.22535438590475, 138.53683325000964, 5.592700727063098, 6.737465861150253, 87.46157909412506, 205.56759607266517, 114.34402499824454, 93.85475166344894, 124.22201582449821, 213.06148078797807, 30.72470108155576, 73.28846137951457, 50.8914216506154, 30.82466544205825, 17.615318467462114, 0.1648645219761486, 214.44445604348573, 181.5921212428039, 16.066609728555846, 10.396709851991128, 2.905006017765823, 6.5853607711932325, 36.30742229929401, 31.690386717868225, 174.54564373354484, 156.01726673361023, 92.45708685623742, 82.32732077682817, 68.87832901087855, 84.59732088450914, 3.8094378428982996, 20.63773808906704, 58.6581135143982, 22.321243533168413, 62.70418704701294, 93.8811805303422, 8.363116383772851, 6.735898213899602, 25.756192312812487, 6.346111779416784, 36.39276426318753, 28.7239941556839, 24.1389898002683, 14.421492689803395, 40.01865522561937, 28.093632446785442, 258.2829171949025, 149.44836714777537, 10.997695046802743, 10.481266101238473, 15.976646901312803, 4.105921792027832, 102.0672562965619, 86.54638491388414, 7.438716887722717, 5.495493228122839, 7.799204680261569, 11.951673186799232, 34.903028313199464, 11.867246107084911, 9.666635177638078, 1.4204844767370275, 21.73315794265511, 21.768230708463495, 33.99805196538246, 34.84850617259261, 37.998019628683096, 4.342398884419868, 36.788791168804, 26.497041924209363, 134.03932505465968, 232.07960929280281, 1.3171531157777367, 0.0, 5.83499104431312, 20.78683456671421, 234.9804866459975, 140.03551279961232, 2.1129380191376517, 8.447964494649101, 0.7258609437618729, 2.224209332011347, 76.94595708895032, 91.12459595996525, 10.242694396815233, 3.629559311293773, 3.0109866858151775, 2.059999938369092, 9.514783390468995, 3.646736339114624, 10.59831304839939, 10.833101354336224, 7.944424029758177, 21.442627569910304, 6.617179375386954, 16.04723637365783, 20.56096536591982, 6.920639343081762, 58.139405402340394, 13.535972276296425, 19.26700851172014, 48.48111865753437, 19.167125811482794, 10.186491116071407, 5.83275449048358, 39.39813220747472, 11.004452085733918, 8.50779770654268, 2.221164097665516, 8.839392980765775, 14.31388020378663, 1.2016548405028582, 1.87427589456409, 4.1171933007826125, 3.3426700421176814, 20.069645957750172, 12.786232766081055, 11.473612695957364, 5.909570788085527, 7.300065613359664, 2.8707912593384597, 14.659180584686654, 19.630703277282795, 27.510037160135276, 1.2897243938403284, 4.881284505998681, 0.2121422396857072, 0.40831465532044353, 2.5965791537487246, 19.315807959465214]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4992110388957856, "mean_inference_ms": 6.574959307517895, "mean_action_processing_ms": 1.1171895529098734, "mean_env_wait_ms": 0.8760536206657793, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00849616527557373, "StateBufferConnector_ms": 0.018831253051757812, "ViewRequirementAgentConnector_ms": 0.321014404296875}, "num_episodes": 18, "episode_return_max": 384.6596330508606, "episode_return_min": -41.56092005688546, "episode_return_mean": 214.6669507214627, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 528000, "num_agent_steps_trained": 528000, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 220.9970030836964, "num_env_steps_trained_throughput_per_sec": 220.9970030836964, "timesteps_total": 132000, "num_env_steps_sampled_lifetime": 132000, "num_agent_steps_sampled_lifetime": 528000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 528000, "timers": {"training_iteration_time_ms": 16304.413, "restore_workers_time_ms": 0.014, "training_step_time_ms": 16304.373, "sample_time_ms": 4238.391, "learn_time_ms": 12051.293, "learn_throughput": 331.915, "synch_weights_time_ms": 13.854}, "counters": {"num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 528000, "num_agent_steps_trained": 528000}, "done": false, "training_iteration": 33, "trial_id": "d163c_00000", "date": "2024-08-16_13-00-30", "timestamp": 1723793430, "time_this_iter_s": 18.10475754737854, "time_total_s": 650.8210461139679, "pid": 81201, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16b87c550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 650.8210461139679, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 32.28076923076923, "ram_util_percent": 67.80384615384615}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.735259991852694, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.265863031432742, "policy_loss": -0.006938183055352912, "vf_loss": 4.271238125064386, "vf_explained_var": 0.09926823702438799, "kl": 0.010420549360161296, "entropy": 1.2996822894565643, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 63315.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.804355393074177, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.504722654251825, "policy_loss": -0.00698997782778596, "vf_loss": 9.50974853858746, "vf_explained_var": -0.07184853137485565, "kl": 0.009820458280645407, "entropy": 1.4117904118129185, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 63315.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_agent_steps_sampled": 544000, "num_agent_steps_trained": 544000}, "env_runners": {"episode_reward_max": 384.6596330508606, "episode_reward_min": 10.522158995023236, "episode_reward_mean": 260.5018680216212, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -307.137908300773, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 198.83819340147488, "predator_policy": 258.2829171949025}, "policy_reward_mean": {"prey_policy": 79.56900161712056, "predator_policy": 50.68193239369007}, "custom_metrics": {}, "hist_stats": {"episode_reward": [165.02249797240142, 26.91636699260173, 226.40214071948105, 234.85251439857365, 216.76689421495624, 24.00355705533617, 281.3971423850596, 126.93702969355162, 111.3561115218154, 44.1074816966413, 263.5442920731873, 166.38063688560672, 174.86785055622153, 141.62617895538048, 182.02807755876646, 90.25751174630742, 249.30263885488534, 178.39435499118377, 199.5800000000002, 84.77031760128054, 251.48509305597338, 117.79686391510506, 210.24314180538883, 147.70257634021365, 336.5534004840078, 247.45505947691004, 319.5398122561297, 299.90522601276086, 295.24449075252994, 172.5797657887161, 167.6535740763627, 101.73499066996904, 269.48536538303506, 172.58354812771296, 200.49632261135224, 189.36012197955222, 302.7806209258228, 259.94494300735516, 330.31200270749105, 249.2577969883796, 10.522158995023236, 346.8346886247601, 331.90057332987317, 161.1682903791432, 313.29728415351144, 354.3780758752116, 333.07443538244405, 303.0143881120282, 264.20500988348783, 236.21114435054426, 338.4761536230017, 267.712447856765, 278.964779861, 360.34000000000003, 316.01121360937873, 12.221877075211484, 349.09043692144223, 324.65000000000003, 221.54775447643848, 292.70000000000005, 333.68112999322545, 306.0963525833556, 321.40795386579987, 315.2031936076774, 290.3767277566546, 334.63423509908006, 321.1557911986291, 326.7707146049962, 284.1307306560258, 340.49883635376716, 324.503584808024, 336.5262886806666, 278.85999999999996, 376.9703556660856, 334.1326220577495, 284.7784103476554, 344.1199999999999, 384.6596330508606, 277.58300091408057, 362.2863259309548, 364.538743391961, 313.4199999999999, 347.43535863921306, 364.3299999999999, 139.93296460639047, 345.1015335363687, 319.49999999999994, 302.6799999999996, 340.7597481785271, 342.99399052371166, 327.4, 330.6348973090692, 311.8779013997623, 342.3030187003717, 330.36, 333.63228516392047, 308.6751986367026, 306.16574244085416, 311.7605077127065, 241.36000000000007], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-8.453195612989896, -212.97299420932566, -184.91488204667144, -107.2274090675451, 22.69982516500129, 141.98561661671567, -291.15584486377816, 129.71000000000026, 138.73875919434496, -157.48688201793632, -152.26136597683336, -240.95573376746157, 183.0199540842034, -256.8198884976647, -89.9500429246593, 28.147438190498605, -81.95976676397594, -163.36116671909616, -171.55326007520665, -261.23197701683273, 126.66648479703746, 128.71999999999983, -206.51654020706422, 62.85066917164337, 12.310496720224604, 95.55928132517461, 28.478724173342936, -307.137908300773, -134.19070069983826, 120.39923975431476, -75.35972126983987, 7.083549607205581, 104.25475322987127, 140.8295035680742, 86.26358662868975, -225.63141927341988, 156.5272992729369, 30.722534138849717, -210.19198740254672, 1.9331298370367467, 175.85368290807577, -132.56736651379592, -78.18800270209778, -141.29862999527376, 83.82347514213932, 22.406504202179477, 47.56629155877869, 18.42019768876085, 174.01921925887473, 144.75399823569504, 146.9882165343427, -295.56973434372236, 159.3152072049153, 133.76128547066742, 140.22416198992093, 150.19069723388094, 37.14668173536793, 190.09999999999997, 6.200535638845253, -164.18368031728397, -109.56696585146788, 102.43613229476517, -73.71100652376187, 21.97034729834304, 104.27958567838584, 140.7586037726839, 93.6918088836052, -2.0876178034589863, -99.65971669130033, 143.57067172529742, 41.94416994992601, 132.31693743195447, 150.45041574224732, 120.22790109134634, 119.78753323217614, 75.0406513563081, 172.09542449673359, 119.6560957206858, 21.324977887288988, 159.82053142868608, -118.24982669576076, -278.95929865189413, 181.6807686867725, 143.6749587899464, 149.05767640075686, 162.76032823577563, -23.699664315054896, -3.7456865162489237, 113.07582189088379, 187.28725214678218, 181.18999999999994, 153.43719800815092, 136.10602282724298, 150.19813813491692, 198.83819340147488, 93.08907505617816, 126.13036498949154, 94.57325624287762, -6.137836325562307, 173.5024225381317, 138.70573510989877, 157.43, 151.6313592115131, 52.79525555223848, -278.0804175450887, 190.92626305862655, 166.33999999999997, 192.68284688422227, 124.9416031314678, 164.44778486688364, -201.6770175414292, -161.11710482896902, 165.32643848378842, 173.20309592386704, 145.22579066798863, 176.47413905623813, 136.73252564496545, -83.25532421744262, 148.552221542394, 130.27552474949704, 188.39391680964243, 140.2162265593988, 157.32504812469102, 135.60978472908133, 121.21712093315148, 178.759418529913, 140.34057774090988, 145.47556426709903, 174.64075519501625, 93.07155681259339, 178.52811016621223, 128.62452022386634, 83.81515479297848, 165.66525872701376, 152.8362791466992, 106.18630828904253, 139.5068556337795, 115.27025809469225, 111.26466228296339, 184.00328737284553, 150.52371336695361, 154.4676216487938, 152.04902866777633, 173.416702934459, 169.10364645069563, 94.24081850501489, 193.19766617100652, 177.7812202997324, 125.89375316602953, 184.82655289185217, 129.39093415886558, 131.12763072675205, 152.7514011647886, 178.15896243376625, 195.3733768535008, 171.7562843533347, 102.69996283986474, 127.74229763679791, 175.91531703111576, 180.2, 178.768286496955, 185.14999999999986, 143.94725583920368, 147.56035704758244, 185.15, 145.101131459551, 178.5791034126189, 185.15, -5.384017376968327, 135.36856553298705, 155.75663802753957, 181.32891914436533, 154.45999999999992, 154.765002830027, 142.04056043978034, 142.69304596942987, 185.0016704051706, 105.89433823172149, 164.958353783868, 145.34844649845587, 140.59982066703253, 165.34999999999997, 157.5396520200599, 166.33999999999992, 191.88909705749165, 71.9494245847484, 134.57725794636895, 195.5515897190333, 148.05729620669092, 169.68101755336897, 185.7272782049048, 140.07610555173412, 138.26176762662033, 144.87501625997675, 158.18246887465097, 128.53534432107287, 168.8809360899278, 133.67000000000002, 46.683771857508596, 188.11999999999995], "policy_predator_policy_reward": [190.81404577802093, 195.6346420166962, 147.03014145519444, 172.02851665162396, 40.90728736468714, 20.80941157307703, 224.10080053085258, 172.19755873149964, 113.04337179412369, 122.47164524442361, 186.7697659325277, 230.45089086710317, 155.56250541456788, 199.63457138395344, 83.55453390903682, 105.18510051867548, 169.70062141774932, 186.97642358713836, 245.01402062045787, 231.87869816822274, 3.680514861404699, 4.477292414745951, 178.1731028600857, 131.87340506094174, 23.1224354347852, 43.87563707603838, 217.8745424442038, 202.41082063860637, 109.73848432553744, 86.08105417875333, 86.1484959037159, 72.38518750522567, 1.6352467701288453, 2.5831352868116864, 179.22535438590475, 138.53683325000964, 5.592700727063098, 6.737465861150253, 87.46157909412506, 205.56759607266517, 114.34402499824454, 93.85475166344894, 124.22201582449821, 213.06148078797807, 30.72470108155576, 73.28846137951457, 50.8914216506154, 30.82466544205825, 17.615318467462114, 0.1648645219761486, 214.44445604348573, 181.5921212428039, 16.066609728555846, 10.396709851991128, 2.905006017765823, 6.5853607711932325, 36.30742229929401, 31.690386717868225, 174.54564373354484, 156.01726673361023, 92.45708685623742, 82.32732077682817, 68.87832901087855, 84.59732088450914, 3.8094378428982996, 20.63773808906704, 58.6581135143982, 22.321243533168413, 62.70418704701294, 93.8811805303422, 8.363116383772851, 6.735898213899602, 25.756192312812487, 6.346111779416784, 36.39276426318753, 28.7239941556839, 24.1389898002683, 14.421492689803395, 40.01865522561937, 28.093632446785442, 258.2829171949025, 149.44836714777537, 10.997695046802743, 10.481266101238473, 15.976646901312803, 4.105921792027832, 102.0672562965619, 86.54638491388414, 7.438716887722717, 5.495493228122839, 7.799204680261569, 11.951673186799232, 34.903028313199464, 11.867246107084911, 9.666635177638078, 1.4204844767370275, 21.73315794265511, 21.768230708463495, 33.99805196538246, 34.84850617259261, 37.998019628683096, 4.342398884419868, 36.788791168804, 26.497041924209363, 134.03932505465968, 232.07960929280281, 1.3171531157777367, 0.0, 5.83499104431312, 20.78683456671421, 234.9804866459975, 140.03551279961232, 2.1129380191376517, 8.447964494649101, 0.7258609437618729, 2.224209332011347, 76.94595708895032, 91.12459595996525, 10.242694396815233, 3.629559311293773, 3.0109866858151775, 2.059999938369092, 9.514783390468995, 3.646736339114624, 10.59831304839939, 10.833101354336224, 7.944424029758177, 21.442627569910304, 6.617179375386954, 16.04723637365783, 20.56096536591982, 6.920639343081762, 58.139405402340394, 13.535972276296425, 19.26700851172014, 48.48111865753437, 19.167125811482794, 10.186491116071407, 5.83275449048358, 39.39813220747472, 11.004452085733918, 8.50779770654268, 2.221164097665516, 8.839392980765775, 14.31388020378663, 1.2016548405028582, 1.87427589456409, 4.1171933007826125, 3.3426700421176814, 20.069645957750172, 12.786232766081055, 11.473612695957364, 5.909570788085527, 7.300065613359664, 2.8707912593384597, 14.659180584686654, 19.630703277282795, 27.510037160135276, 1.2897243938403284, 4.881284505998681, 0.2121422396857072, 0.40831465532044353, 2.5965791537487246, 19.315807959465214, 6.444513067644518, 10.739714112017507, 0.0, 0.6008965873811305, 8.083821728647598, 1.8645947217239032, 3.603481749801117, 4.412494614662824, 10.274997169973023, 0.0, 3.92323570642755, 14.023157884362044, 28.44828384876643, 21.415455692868587, 10.186247286172788, 22.500942955214924, 4.725575657590603, 16.724603675376844, 2.2795818714018528, 4.47566341760749, 8.787659154422933, 39.25172060309935, 6.262446792685093, 5.911724242284444, 4.041178125076383, 8.580508114863699, 2.9624178140208786, 4.866483593260678, 16.498507849473334, 9.039906900632197, 1.221554027608545, 18.22637521752175, 3.1418115905583126, 6.067760032220453, 0.0, 6.556228142491365]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.487349765813481, "mean_inference_ms": 6.536753957770749, "mean_action_processing_ms": 1.110142681969466, "mean_env_wait_ms": 0.8699624177544797, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00834643840789795, "StateBufferConnector_ms": 0.01179349422454834, "ViewRequirementAgentConnector_ms": 0.333831787109375}, "num_episodes": 18, "episode_return_max": 384.6596330508606, "episode_return_min": 10.522158995023236, "episode_return_mean": 260.5018680216212, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 544000, "num_agent_steps_trained": 544000, "num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 253.7535554269234, "num_env_steps_trained_throughput_per_sec": 253.7535554269234, "timesteps_total": 136000, "num_env_steps_sampled_lifetime": 136000, "num_agent_steps_sampled_lifetime": 544000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 544000, "timers": {"training_iteration_time_ms": 16238.258, "restore_workers_time_ms": 0.014, "training_step_time_ms": 16238.217, "sample_time_ms": 4139.373, "learn_time_ms": 12084.255, "learn_throughput": 331.009, "synch_weights_time_ms": 13.737}, "counters": {"num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_agent_steps_sampled": 544000, "num_agent_steps_trained": 544000}, "done": false, "training_iteration": 34, "trial_id": "d163c_00000", "date": "2024-08-16_13-00-46", "timestamp": 1723793446, "time_this_iter_s": 15.76732325553894, "time_total_s": 666.5883693695068, "pid": 81201, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16b85af70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 666.5883693695068, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 29.563636363636366, "ram_util_percent": 67.95454545454545}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.791980464117868, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.8102630732551455, "policy_loss": -0.011199900693267525, "vf_loss": 2.819664982513145, "vf_explained_var": 0.12343978894450677, "kl": 0.01198659778632761, "entropy": 1.3143634443560606, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 65205.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.9415309425226595, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.578932742467002, "policy_loss": -0.005312190549793067, "vf_loss": 9.58214615110367, "vf_explained_var": -0.052078595867863405, "kl": 0.010493894762716826, "entropy": 1.421767669884616, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 65205.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_agent_steps_sampled": 560000, "num_agent_steps_trained": 560000}, "env_runners": {"episode_reward_max": 384.6596330508606, "episode_reward_min": 10.522158995023236, "episode_reward_mean": 286.06852136522406, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -295.56973434372236, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 258.2829171949025}, "policy_reward_mean": {"prey_policy": 112.91739158545975, "predator_policy": 30.116869097152275}, "custom_metrics": {}, "hist_stats": {"episode_reward": [199.5800000000002, 84.77031760128054, 251.48509305597338, 117.79686391510506, 210.24314180538883, 147.70257634021365, 336.5534004840078, 247.45505947691004, 319.5398122561297, 299.90522601276086, 295.24449075252994, 172.5797657887161, 167.6535740763627, 101.73499066996904, 269.48536538303506, 172.58354812771296, 200.49632261135224, 189.36012197955222, 302.7806209258228, 259.94494300735516, 330.31200270749105, 249.2577969883796, 10.522158995023236, 346.8346886247601, 331.90057332987317, 161.1682903791432, 313.29728415351144, 354.3780758752116, 333.07443538244405, 303.0143881120282, 264.20500988348783, 236.21114435054426, 338.4761536230017, 267.712447856765, 278.964779861, 360.34000000000003, 316.01121360937873, 12.221877075211484, 349.09043692144223, 324.65000000000003, 221.54775447643848, 292.70000000000005, 333.68112999322545, 306.0963525833556, 321.40795386579987, 315.2031936076774, 290.3767277566546, 334.63423509908006, 321.1557911986291, 326.7707146049962, 284.1307306560258, 340.49883635376716, 324.503584808024, 336.5262886806666, 278.85999999999996, 376.9703556660856, 334.1326220577495, 284.7784103476554, 344.1199999999999, 384.6596330508606, 277.58300091408057, 362.2863259309548, 364.538743391961, 313.4199999999999, 347.43535863921306, 364.3299999999999, 139.93296460639047, 345.1015335363687, 319.49999999999994, 302.6799999999996, 340.7597481785271, 342.99399052371166, 327.4, 330.6348973090692, 311.8779013997623, 342.3030187003717, 330.36, 333.63228516392047, 308.6751986367026, 306.16574244085416, 311.7605077127065, 241.36000000000007, 321.60769133370377, 164.42004932068605, 362.4389316868301, 334.48591093395896, 326.5, 286.04051771372326, 318.3351283309739, 191.45763126634597, 318.93160491733676, 340.31819297146353, 317.10597933380984, 282.8871509766972, 293.3329897109244, 289.7720077075002, 351.5613108263053, 299.333497759279, 314.4361162084328, 347.8639016342729], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [156.5272992729369, 30.722534138849717, -210.19198740254672, 1.9331298370367467, 175.85368290807577, -132.56736651379592, -78.18800270209778, -141.29862999527376, 83.82347514213932, 22.406504202179477, 47.56629155877869, 18.42019768876085, 174.01921925887473, 144.75399823569504, 146.9882165343427, -295.56973434372236, 159.3152072049153, 133.76128547066742, 140.22416198992093, 150.19069723388094, 37.14668173536793, 190.09999999999997, 6.200535638845253, -164.18368031728397, -109.56696585146788, 102.43613229476517, -73.71100652376187, 21.97034729834304, 104.27958567838584, 140.7586037726839, 93.6918088836052, -2.0876178034589863, -99.65971669130033, 143.57067172529742, 41.94416994992601, 132.31693743195447, 150.45041574224732, 120.22790109134634, 119.78753323217614, 75.0406513563081, 172.09542449673359, 119.6560957206858, 21.324977887288988, 159.82053142868608, -118.24982669576076, -278.95929865189413, 181.6807686867725, 143.6749587899464, 149.05767640075686, 162.76032823577563, -23.699664315054896, -3.7456865162489237, 113.07582189088379, 187.28725214678218, 181.18999999999994, 153.43719800815092, 136.10602282724298, 150.19813813491692, 198.83819340147488, 93.08907505617816, 126.13036498949154, 94.57325624287762, -6.137836325562307, 173.5024225381317, 138.70573510989877, 157.43, 151.6313592115131, 52.79525555223848, -278.0804175450887, 190.92626305862655, 166.33999999999997, 192.68284688422227, 124.9416031314678, 164.44778486688364, -201.6770175414292, -161.11710482896902, 165.32643848378842, 173.20309592386704, 145.22579066798863, 176.47413905623813, 136.73252564496545, -83.25532421744262, 148.552221542394, 130.27552474949704, 188.39391680964243, 140.2162265593988, 157.32504812469102, 135.60978472908133, 121.21712093315148, 178.759418529913, 140.34057774090988, 145.47556426709903, 174.64075519501625, 93.07155681259339, 178.52811016621223, 128.62452022386634, 83.81515479297848, 165.66525872701376, 152.8362791466992, 106.18630828904253, 139.5068556337795, 115.27025809469225, 111.26466228296339, 184.00328737284553, 150.52371336695361, 154.4676216487938, 152.04902866777633, 173.416702934459, 169.10364645069563, 94.24081850501489, 193.19766617100652, 177.7812202997324, 125.89375316602953, 184.82655289185217, 129.39093415886558, 131.12763072675205, 152.7514011647886, 178.15896243376625, 195.3733768535008, 171.7562843533347, 102.69996283986474, 127.74229763679791, 175.91531703111576, 180.2, 178.768286496955, 185.14999999999986, 143.94725583920368, 147.56035704758244, 185.15, 145.101131459551, 178.5791034126189, 185.15, -5.384017376968327, 135.36856553298705, 155.75663802753957, 181.32891914436533, 154.45999999999992, 154.765002830027, 142.04056043978034, 142.69304596942987, 185.0016704051706, 105.89433823172149, 164.958353783868, 145.34844649845587, 140.59982066703253, 165.34999999999997, 157.5396520200599, 166.33999999999992, 191.88909705749165, 71.9494245847484, 134.57725794636895, 195.5515897190333, 148.05729620669092, 169.68101755336897, 185.7272782049048, 140.07610555173412, 138.26176762662033, 144.87501625997675, 158.18246887465097, 128.53534432107287, 168.8809360899278, 133.67000000000002, 46.683771857508596, 188.11999999999995, 157.79431613001304, 148.18176729563274, 7.328408998804899, 76.71482445069941, 156.2526720838035, 198.01999999999998, 181.9821838163457, 139.13938143294052, 154.1278128049068, 165.68996314541346, 153.72288244893838, 98.13725384963651, 147.67343093973955, 136.2907809476943, 37.38650149101321, 77.39618732397923, 141.99966920543966, 120.91007868210967, 139.60196010715205, 188.99076817006232, 129.65277295138063, 154.04242149993462, 95.55473010536761, 123.99145672601702, 147.73101631368533, 111.64011454124369, 139.6203283139317, 130.26578356381333, 182.4239320624631, 156.68414664249894, 157.69213423132277, 108.42743843331172, 94.77308624055061, 200.0, 178.66983770166024, 159.74513393176417], "policy_predator_policy_reward": [5.592700727063098, 6.737465861150253, 87.46157909412506, 205.56759607266517, 114.34402499824454, 93.85475166344894, 124.22201582449821, 213.06148078797807, 30.72470108155576, 73.28846137951457, 50.8914216506154, 30.82466544205825, 17.615318467462114, 0.1648645219761486, 214.44445604348573, 181.5921212428039, 16.066609728555846, 10.396709851991128, 2.905006017765823, 6.5853607711932325, 36.30742229929401, 31.690386717868225, 174.54564373354484, 156.01726673361023, 92.45708685623742, 82.32732077682817, 68.87832901087855, 84.59732088450914, 3.8094378428982996, 20.63773808906704, 58.6581135143982, 22.321243533168413, 62.70418704701294, 93.8811805303422, 8.363116383772851, 6.735898213899602, 25.756192312812487, 6.346111779416784, 36.39276426318753, 28.7239941556839, 24.1389898002683, 14.421492689803395, 40.01865522561937, 28.093632446785442, 258.2829171949025, 149.44836714777537, 10.997695046802743, 10.481266101238473, 15.976646901312803, 4.105921792027832, 102.0672562965619, 86.54638491388414, 7.438716887722717, 5.495493228122839, 7.799204680261569, 11.951673186799232, 34.903028313199464, 11.867246107084911, 9.666635177638078, 1.4204844767370275, 21.73315794265511, 21.768230708463495, 33.99805196538246, 34.84850617259261, 37.998019628683096, 4.342398884419868, 36.788791168804, 26.497041924209363, 134.03932505465968, 232.07960929280281, 1.3171531157777367, 0.0, 5.83499104431312, 20.78683456671421, 234.9804866459975, 140.03551279961232, 2.1129380191376517, 8.447964494649101, 0.7258609437618729, 2.224209332011347, 76.94595708895032, 91.12459595996525, 10.242694396815233, 3.629559311293773, 3.0109866858151775, 2.059999938369092, 9.514783390468995, 3.646736339114624, 10.59831304839939, 10.833101354336224, 7.944424029758177, 21.442627569910304, 6.617179375386954, 16.04723637365783, 20.56096536591982, 6.920639343081762, 58.139405402340394, 13.535972276296425, 19.26700851172014, 48.48111865753437, 19.167125811482794, 10.186491116071407, 5.83275449048358, 39.39813220747472, 11.004452085733918, 8.50779770654268, 2.221164097665516, 8.839392980765775, 14.31388020378663, 1.2016548405028582, 1.87427589456409, 4.1171933007826125, 3.3426700421176814, 20.069645957750172, 12.786232766081055, 11.473612695957364, 5.909570788085527, 7.300065613359664, 2.8707912593384597, 14.659180584686654, 19.630703277282795, 27.510037160135276, 1.2897243938403284, 4.881284505998681, 0.2121422396857072, 0.40831465532044353, 2.5965791537487246, 19.315807959465214, 6.444513067644518, 10.739714112017507, 0.0, 0.6008965873811305, 8.083821728647598, 1.8645947217239032, 3.603481749801117, 4.412494614662824, 10.274997169973023, 0.0, 3.92323570642755, 14.023157884362044, 28.44828384876643, 21.415455692868587, 10.186247286172788, 22.500942955214924, 4.725575657590603, 16.724603675376844, 2.2795818714018528, 4.47566341760749, 8.787659154422933, 39.25172060309935, 6.262446792685093, 5.911724242284444, 4.041178125076383, 8.580508114863699, 2.9624178140208786, 4.866483593260678, 16.498507849473334, 9.039906900632197, 1.221554027608545, 18.22637521752175, 3.1418115905583126, 6.067760032220453, 0.0, 6.556228142491365, 1.4976116971078257, 14.13399621095013, 37.701526658946854, 42.67528921223476, 6.310513306064725, 1.8557462969618324, 12.145219631094003, 1.219126053578715, 2.34729103428352, 4.334933015396255, 33.776292235563794, 0.4040891795845535, 22.987493553826052, 11.38342288971404, 33.62429978784398, 43.05064266350952, 20.931935711897086, 35.08992131789033, 2.127424801401288, 9.598039892847998, 27.66752019420291, 5.743264688291653, 32.951088344775954, 30.389875800536654, 14.292357589304295, 19.669501266691167, 16.98647365759941, 2.899422172155903, 10.293975887822372, 2.1592562335208907, 8.8882864819151, 24.325638612729502, 8.4058528057874, 11.257177162094651, 3.034063932612658, 6.414866068235821]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4761838919671817, "mean_inference_ms": 6.5037344693916275, "mean_action_processing_ms": 1.1036695708081972, "mean_env_wait_ms": 0.8642449653756742, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009561896324157715, "StateBufferConnector_ms": 0.011824250221252441, "ViewRequirementAgentConnector_ms": 0.3616257905960083}, "num_episodes": 18, "episode_return_max": 384.6596330508606, "episode_return_min": 10.522158995023236, "episode_return_mean": 286.06852136522406, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 560000, "num_agent_steps_trained": 560000, "num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 252.9876267315677, "num_env_steps_trained_throughput_per_sec": 252.9876267315677, "timesteps_total": 140000, "num_env_steps_sampled_lifetime": 140000, "num_agent_steps_sampled_lifetime": 560000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 560000, "timers": {"training_iteration_time_ms": 16195.115, "restore_workers_time_ms": 0.014, "training_step_time_ms": 16195.073, "sample_time_ms": 4063.54, "learn_time_ms": 12116.878, "learn_throughput": 330.118, "synch_weights_time_ms": 13.812}, "counters": {"num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_agent_steps_sampled": 560000, "num_agent_steps_trained": 560000}, "done": false, "training_iteration": 35, "trial_id": "d163c_00000", "date": "2024-08-16_13-01-02", "timestamp": 1723793462, "time_this_iter_s": 15.815903902053833, "time_total_s": 682.4042732715607, "pid": 81201, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16b857670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 682.4042732715607, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 27.999999999999996, "ram_util_percent": 67.34782608695653}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.036375440428497, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.9399865774881273, "policy_loss": -0.010848818526716618, "vf_loss": 3.9484826192654, "vf_explained_var": 0.3751614102926204, "kl": 0.015685187046991195, "entropy": 1.2798729011621426, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 67095.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.7637401012516527, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.211310779733003, "policy_loss": -0.007200095027428928, "vf_loss": 9.216011436906442, "vf_explained_var": -0.11124339573597782, "kl": 0.012497109489090184, "entropy": 1.414845775990259, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 67095.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 576000}, "env_runners": {"episode_reward_max": 384.6596330508606, "episode_reward_min": 10.522158995023236, "episode_reward_mean": 296.9682341529566, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -278.95929865189413, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 258.2829171949025}, "policy_reward_mean": {"prey_policy": 127.26633999052345, "predator_policy": 21.21777708595487}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.522158995023236, 346.8346886247601, 331.90057332987317, 161.1682903791432, 313.29728415351144, 354.3780758752116, 333.07443538244405, 303.0143881120282, 264.20500988348783, 236.21114435054426, 338.4761536230017, 267.712447856765, 278.964779861, 360.34000000000003, 316.01121360937873, 12.221877075211484, 349.09043692144223, 324.65000000000003, 221.54775447643848, 292.70000000000005, 333.68112999322545, 306.0963525833556, 321.40795386579987, 315.2031936076774, 290.3767277566546, 334.63423509908006, 321.1557911986291, 326.7707146049962, 284.1307306560258, 340.49883635376716, 324.503584808024, 336.5262886806666, 278.85999999999996, 376.9703556660856, 334.1326220577495, 284.7784103476554, 344.1199999999999, 384.6596330508606, 277.58300091408057, 362.2863259309548, 364.538743391961, 313.4199999999999, 347.43535863921306, 364.3299999999999, 139.93296460639047, 345.1015335363687, 319.49999999999994, 302.6799999999996, 340.7597481785271, 342.99399052371166, 327.4, 330.6348973090692, 311.8779013997623, 342.3030187003717, 330.36, 333.63228516392047, 308.6751986367026, 306.16574244085416, 311.7605077127065, 241.36000000000007, 321.60769133370377, 164.42004932068605, 362.4389316868301, 334.48591093395896, 326.5, 286.04051771372326, 318.3351283309739, 191.45763126634597, 318.93160491733676, 340.31819297146353, 317.10597933380984, 282.8871509766972, 293.3329897109244, 289.7720077075002, 351.5613108263053, 299.333497759279, 314.4361162084328, 347.8639016342729, 263.28407697276134, 282.19377044663815, 262.2460504416872, 381.1161317326776, 293.0089277282649, 309.5063234897427, 336.1955991515073, 204.07505106441639, 215.47443474613527, 212.64538679234425, 368.22, 174.99062669153074, 289.53, 166.12469653054737, 313.7328246007074, 287.64722216087574, 299.64, 257.55462694533753, 139.44855202888675, 250.86829694540344, 339.9705916804462, 368.96312258939605], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-118.24982669576076, -278.95929865189413, 181.6807686867725, 143.6749587899464, 149.05767640075686, 162.76032823577563, -23.699664315054896, -3.7456865162489237, 113.07582189088379, 187.28725214678218, 181.18999999999994, 153.43719800815092, 136.10602282724298, 150.19813813491692, 198.83819340147488, 93.08907505617816, 126.13036498949154, 94.57325624287762, -6.137836325562307, 173.5024225381317, 138.70573510989877, 157.43, 151.6313592115131, 52.79525555223848, -278.0804175450887, 190.92626305862655, 166.33999999999997, 192.68284688422227, 124.9416031314678, 164.44778486688364, -201.6770175414292, -161.11710482896902, 165.32643848378842, 173.20309592386704, 145.22579066798863, 176.47413905623813, 136.73252564496545, -83.25532421744262, 148.552221542394, 130.27552474949704, 188.39391680964243, 140.2162265593988, 157.32504812469102, 135.60978472908133, 121.21712093315148, 178.759418529913, 140.34057774090988, 145.47556426709903, 174.64075519501625, 93.07155681259339, 178.52811016621223, 128.62452022386634, 83.81515479297848, 165.66525872701376, 152.8362791466992, 106.18630828904253, 139.5068556337795, 115.27025809469225, 111.26466228296339, 184.00328737284553, 150.52371336695361, 154.4676216487938, 152.04902866777633, 173.416702934459, 169.10364645069563, 94.24081850501489, 193.19766617100652, 177.7812202997324, 125.89375316602953, 184.82655289185217, 129.39093415886558, 131.12763072675205, 152.7514011647886, 178.15896243376625, 195.3733768535008, 171.7562843533347, 102.69996283986474, 127.74229763679791, 175.91531703111576, 180.2, 178.768286496955, 185.14999999999986, 143.94725583920368, 147.56035704758244, 185.15, 145.101131459551, 178.5791034126189, 185.15, -5.384017376968327, 135.36856553298705, 155.75663802753957, 181.32891914436533, 154.45999999999992, 154.765002830027, 142.04056043978034, 142.69304596942987, 185.0016704051706, 105.89433823172149, 164.958353783868, 145.34844649845587, 140.59982066703253, 165.34999999999997, 157.5396520200599, 166.33999999999992, 191.88909705749165, 71.9494245847484, 134.57725794636895, 195.5515897190333, 148.05729620669092, 169.68101755336897, 185.7272782049048, 140.07610555173412, 138.26176762662033, 144.87501625997675, 158.18246887465097, 128.53534432107287, 168.8809360899278, 133.67000000000002, 46.683771857508596, 188.11999999999995, 157.79431613001304, 148.18176729563274, 7.328408998804899, 76.71482445069941, 156.2526720838035, 198.01999999999998, 181.9821838163457, 139.13938143294052, 154.1278128049068, 165.68996314541346, 153.72288244893838, 98.13725384963651, 147.67343093973955, 136.2907809476943, 37.38650149101321, 77.39618732397923, 141.99966920543966, 120.91007868210967, 139.60196010715205, 188.99076817006232, 129.65277295138063, 154.04242149993462, 95.55473010536761, 123.99145672601702, 147.73101631368533, 111.64011454124369, 139.6203283139317, 130.26578356381333, 182.4239320624631, 156.68414664249894, 157.69213423132277, 108.42743843331172, 94.77308624055061, 200.0, 178.66983770166024, 159.74513393176417, 137.53640988917704, 109.90938249293384, 43.260054565681756, 170.7071065938465, 108.91188433811895, 98.15561471705084, 198.8439577139736, 173.70278960531653, 113.3341152458706, 155.56990400841767, 163.37, 136.38569543632855, 164.00227549267044, 159.93339268318707, 104.3818849802788, 59.776862771941154, 140.7706533206777, 9.19826108150594, 76.04706630451922, 41.215256055636445, 176.34202978737562, 189.51883042673023, 13.158873686116129, 36.00726839275359, 146.34893001179347, 119.47915468310379, 4.370552112566301, 89.0477265071021, 144.04818132723688, 142.4406583774412, 107.45558242841685, 152.29788267055773, 160.98748113202726, 128.00997241573086, 111.64753354325498, 97.87118062881456, 44.12435029089163, 18.695195963415024, 32.84931004932939, 137.95926391110186, 167.76767108263533, 157.09967032767318, 183.30371790805242, 176.24629394847642], "policy_predator_policy_reward": [258.2829171949025, 149.44836714777537, 10.997695046802743, 10.481266101238473, 15.976646901312803, 4.105921792027832, 102.0672562965619, 86.54638491388414, 7.438716887722717, 5.495493228122839, 7.799204680261569, 11.951673186799232, 34.903028313199464, 11.867246107084911, 9.666635177638078, 1.4204844767370275, 21.73315794265511, 21.768230708463495, 33.99805196538246, 34.84850617259261, 37.998019628683096, 4.342398884419868, 36.788791168804, 26.497041924209363, 134.03932505465968, 232.07960929280281, 1.3171531157777367, 0.0, 5.83499104431312, 20.78683456671421, 234.9804866459975, 140.03551279961232, 2.1129380191376517, 8.447964494649101, 0.7258609437618729, 2.224209332011347, 76.94595708895032, 91.12459595996525, 10.242694396815233, 3.629559311293773, 3.0109866858151775, 2.059999938369092, 9.514783390468995, 3.646736339114624, 10.59831304839939, 10.833101354336224, 7.944424029758177, 21.442627569910304, 6.617179375386954, 16.04723637365783, 20.56096536591982, 6.920639343081762, 58.139405402340394, 13.535972276296425, 19.26700851172014, 48.48111865753437, 19.167125811482794, 10.186491116071407, 5.83275449048358, 39.39813220747472, 11.004452085733918, 8.50779770654268, 2.221164097665516, 8.839392980765775, 14.31388020378663, 1.2016548405028582, 1.87427589456409, 4.1171933007826125, 3.3426700421176814, 20.069645957750172, 12.786232766081055, 11.473612695957364, 5.909570788085527, 7.300065613359664, 2.8707912593384597, 14.659180584686654, 19.630703277282795, 27.510037160135276, 1.2897243938403284, 4.881284505998681, 0.2121422396857072, 0.40831465532044353, 2.5965791537487246, 19.315807959465214, 6.444513067644518, 10.739714112017507, 0.0, 0.6008965873811305, 8.083821728647598, 1.8645947217239032, 3.603481749801117, 4.412494614662824, 10.274997169973023, 0.0, 3.92323570642755, 14.023157884362044, 28.44828384876643, 21.415455692868587, 10.186247286172788, 22.500942955214924, 4.725575657590603, 16.724603675376844, 2.2795818714018528, 4.47566341760749, 8.787659154422933, 39.25172060309935, 6.262446792685093, 5.911724242284444, 4.041178125076383, 8.580508114863699, 2.9624178140208786, 4.866483593260678, 16.498507849473334, 9.039906900632197, 1.221554027608545, 18.22637521752175, 3.1418115905583126, 6.067760032220453, 0.0, 6.556228142491365, 1.4976116971078257, 14.13399621095013, 37.701526658946854, 42.67528921223476, 6.310513306064725, 1.8557462969618324, 12.145219631094003, 1.219126053578715, 2.34729103428352, 4.334933015396255, 33.776292235563794, 0.4040891795845535, 22.987493553826052, 11.38342288971404, 33.62429978784398, 43.05064266350952, 20.931935711897086, 35.08992131789033, 2.127424801401288, 9.598039892847998, 27.66752019420291, 5.743264688291653, 32.951088344775954, 30.389875800536654, 14.292357589304295, 19.669501266691167, 16.98647365759941, 2.899422172155903, 10.293975887822372, 2.1592562335208907, 8.8882864819151, 24.325638612729502, 8.4058528057874, 11.257177162094651, 3.034063932612658, 6.414866068235821, 15.26764808254362, 0.5706365081069108, 25.631289784143807, 42.595319502966134, 24.038973469844464, 31.13957791667295, 5.468283643718568, 3.1011007696689057, 3.6176547029846096, 20.487253770992105, 5.785911890201084, 3.9647161632130334, 6.621384469403818, 5.638546506245925, 36.994964409334884, 2.9213389028616525, 50.44504315689991, 15.060477187051719, 56.391510358654585, 38.99155407353407, 1.5111695732697825, 0.8479702126243702, 48.093479061385175, 77.73100555127603, 0.18106998820653125, 23.520845316896217, 40.78837444421794, 31.918043466661114, 24.00423397246542, 3.2397509235638813, 22.73617588557684, 5.157581176324275, 2.630027584269127, 8.012518867972739, 23.56375534490626, 24.47215742836176, 26.357538210450944, 50.27146756412911, 28.101031495936276, 51.95869148903577, 6.900664414848491, 8.202585855289147, 8.579988143471198, 0.8331225893960701]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4644571758770577, "mean_inference_ms": 6.4632946691085955, "mean_action_processing_ms": 1.0963162618568196, "mean_env_wait_ms": 0.8584129635719193, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0093611478805542, "StateBufferConnector_ms": 0.01171731948852539, "ViewRequirementAgentConnector_ms": 0.33872246742248535}, "num_episodes": 22, "episode_return_max": 384.6596330508606, "episode_return_min": 10.522158995023236, "episode_return_mean": 296.9682341529566, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 576000, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 264.3450983743592, "num_env_steps_trained_throughput_per_sec": 264.3450983743592, "timesteps_total": 144000, "num_env_steps_sampled_lifetime": 144000, "num_agent_steps_sampled_lifetime": 576000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 576000, "timers": {"training_iteration_time_ms": 16162.654, "restore_workers_time_ms": 0.014, "training_step_time_ms": 16162.613, "sample_time_ms": 4053.506, "learn_time_ms": 12094.344, "learn_throughput": 330.733, "synch_weights_time_ms": 13.878}, "counters": {"num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 576000}, "done": false, "training_iteration": 36, "trial_id": "d163c_00000", "date": "2024-08-16_13-01-17", "timestamp": 1723793477, "time_this_iter_s": 15.136652946472168, "time_total_s": 697.5409262180328, "pid": 81201, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16b8da280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 697.5409262180328, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 27.633333333333336, "ram_util_percent": 67.20476190476191}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.0726726866903755, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.341885379256395, "policy_loss": -0.006837443827291724, "vf_loss": 4.346955940836952, "vf_explained_var": 0.25898867839227907, "kl": 0.011779186865597844, "entropy": 1.2262575809287015, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 68985.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.832261311156409, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.255764575231643, "policy_loss": -0.01623189135801993, "vf_loss": 9.26853281909196, "vf_explained_var": 0.03872468868891398, "kl": 0.017318154267467988, "entropy": 1.4042060628139152, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 68985.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_agent_steps_sampled": 592000, "num_agent_steps_trained": 592000}, "env_runners": {"episode_reward_max": 389.6172110761431, "episode_reward_min": 139.44855202888675, "episode_reward_mean": 293.4682742471666, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -79.935682833103, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 127.25982801210688}, "policy_reward_mean": {"prey_policy": 129.21723599107264, "predator_policy": 17.516901132510682}, "custom_metrics": {}, "hist_stats": {"episode_reward": [315.2031936076774, 290.3767277566546, 334.63423509908006, 321.1557911986291, 326.7707146049962, 284.1307306560258, 340.49883635376716, 324.503584808024, 336.5262886806666, 278.85999999999996, 376.9703556660856, 334.1326220577495, 284.7784103476554, 344.1199999999999, 384.6596330508606, 277.58300091408057, 362.2863259309548, 364.538743391961, 313.4199999999999, 347.43535863921306, 364.3299999999999, 139.93296460639047, 345.1015335363687, 319.49999999999994, 302.6799999999996, 340.7597481785271, 342.99399052371166, 327.4, 330.6348973090692, 311.8779013997623, 342.3030187003717, 330.36, 333.63228516392047, 308.6751986367026, 306.16574244085416, 311.7605077127065, 241.36000000000007, 321.60769133370377, 164.42004932068605, 362.4389316868301, 334.48591093395896, 326.5, 286.04051771372326, 318.3351283309739, 191.45763126634597, 318.93160491733676, 340.31819297146353, 317.10597933380984, 282.8871509766972, 293.3329897109244, 289.7720077075002, 351.5613108263053, 299.333497759279, 314.4361162084328, 347.8639016342729, 263.28407697276134, 282.19377044663815, 262.2460504416872, 381.1161317326776, 293.0089277282649, 309.5063234897427, 336.1955991515073, 204.07505106441639, 215.47443474613527, 212.64538679234425, 368.22, 174.99062669153074, 289.53, 166.12469653054737, 313.7328246007074, 287.64722216087574, 299.64, 257.55462694533753, 139.44855202888675, 250.86829694540344, 339.9705916804462, 368.96312258939605, 237.80234712111212, 277.6542361867953, 267.32757077006994, 278.94542174870355, 246.7602178976103, 140.8976672208556, 344.47131866747117, 230.58885389871037, 196.89002324363145, 202.96488861669954, 201.9594559976882, 346.5588858776954, 346.6531858605615, 313.19, 170.01759670174445, 233.66308620740605, 389.6172110761431, 248.41330780494317, 252.84580073520618, 363.02617229345486, 206.37565410962011, 227.2533221687766, 303.63393416774966], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [140.34057774090988, 145.47556426709903, 174.64075519501625, 93.07155681259339, 178.52811016621223, 128.62452022386634, 83.81515479297848, 165.66525872701376, 152.8362791466992, 106.18630828904253, 139.5068556337795, 115.27025809469225, 111.26466228296339, 184.00328737284553, 150.52371336695361, 154.4676216487938, 152.04902866777633, 173.416702934459, 169.10364645069563, 94.24081850501489, 193.19766617100652, 177.7812202997324, 125.89375316602953, 184.82655289185217, 129.39093415886558, 131.12763072675205, 152.7514011647886, 178.15896243376625, 195.3733768535008, 171.7562843533347, 102.69996283986474, 127.74229763679791, 175.91531703111576, 180.2, 178.768286496955, 185.14999999999986, 143.94725583920368, 147.56035704758244, 185.15, 145.101131459551, 178.5791034126189, 185.15, -5.384017376968327, 135.36856553298705, 155.75663802753957, 181.32891914436533, 154.45999999999992, 154.765002830027, 142.04056043978034, 142.69304596942987, 185.0016704051706, 105.89433823172149, 164.958353783868, 145.34844649845587, 140.59982066703253, 165.34999999999997, 157.5396520200599, 166.33999999999992, 191.88909705749165, 71.9494245847484, 134.57725794636895, 195.5515897190333, 148.05729620669092, 169.68101755336897, 185.7272782049048, 140.07610555173412, 138.26176762662033, 144.87501625997675, 158.18246887465097, 128.53534432107287, 168.8809360899278, 133.67000000000002, 46.683771857508596, 188.11999999999995, 157.79431613001304, 148.18176729563274, 7.328408998804899, 76.71482445069941, 156.2526720838035, 198.01999999999998, 181.9821838163457, 139.13938143294052, 154.1278128049068, 165.68996314541346, 153.72288244893838, 98.13725384963651, 147.67343093973955, 136.2907809476943, 37.38650149101321, 77.39618732397923, 141.99966920543966, 120.91007868210967, 139.60196010715205, 188.99076817006232, 129.65277295138063, 154.04242149993462, 95.55473010536761, 123.99145672601702, 147.73101631368533, 111.64011454124369, 139.6203283139317, 130.26578356381333, 182.4239320624631, 156.68414664249894, 157.69213423132277, 108.42743843331172, 94.77308624055061, 200.0, 178.66983770166024, 159.74513393176417, 137.53640988917704, 109.90938249293384, 43.260054565681756, 170.7071065938465, 108.91188433811895, 98.15561471705084, 198.8439577139736, 173.70278960531653, 113.3341152458706, 155.56990400841767, 163.37, 136.38569543632855, 164.00227549267044, 159.93339268318707, 104.3818849802788, 59.776862771941154, 140.7706533206777, 9.19826108150594, 76.04706630451922, 41.215256055636445, 176.34202978737562, 189.51883042673023, 13.158873686116129, 36.00726839275359, 146.34893001179347, 119.47915468310379, 4.370552112566301, 89.0477265071021, 144.04818132723688, 142.4406583774412, 107.45558242841685, 152.29788267055773, 160.98748113202726, 128.00997241573086, 111.64753354325498, 97.87118062881456, 44.12435029089163, 18.695195963415024, 32.84931004932939, 137.95926391110186, 167.76767108263533, 157.09967032767318, 183.30371790805242, 176.24629394847642, 73.71006034262994, 123.03110797235067, 71.63551413604695, 152.42859085637485, 107.10165917463308, 117.50485911726153, 129.84936179860404, 106.55969258715487, 164.60037269079046, 15.533275728540591, 31.603915680946045, -8.62152428119618, 168.82801230109905, 163.42589134084892, 151.65226643346023, 2.2508281904886114, 71.89225012630136, 60.74486839052211, -21.911103160074475, 135.8377118687128, 29.60974865250174, 123.64805309565614, 143.89947852831142, 185.34265875155467, 170.3, 151.68158223439585, 190.9869567017279, 85.80888445118929, 50.490968182847396, 63.62677836619332, 134.62524032744784, -79.935682833103, 186.6140060252702, 200.0, 100.16925560170301, 91.37880726219949, 33.66078933488741, 147.23695154913582, 165.0332484323299, 193.08324183625353, 58.52860517584846, 94.06296082591834, 83.3299942178858, 121.05822094551165, 119.39724546766254, 155.77499596241566], "policy_predator_policy_reward": [7.944424029758177, 21.442627569910304, 6.617179375386954, 16.04723637365783, 20.56096536591982, 6.920639343081762, 58.139405402340394, 13.535972276296425, 19.26700851172014, 48.48111865753437, 19.167125811482794, 10.186491116071407, 5.83275449048358, 39.39813220747472, 11.004452085733918, 8.50779770654268, 2.221164097665516, 8.839392980765775, 14.31388020378663, 1.2016548405028582, 1.87427589456409, 4.1171933007826125, 3.3426700421176814, 20.069645957750172, 12.786232766081055, 11.473612695957364, 5.909570788085527, 7.300065613359664, 2.8707912593384597, 14.659180584686654, 19.630703277282795, 27.510037160135276, 1.2897243938403284, 4.881284505998681, 0.2121422396857072, 0.40831465532044353, 2.5965791537487246, 19.315807959465214, 6.444513067644518, 10.739714112017507, 0.0, 0.6008965873811305, 8.083821728647598, 1.8645947217239032, 3.603481749801117, 4.412494614662824, 10.274997169973023, 0.0, 3.92323570642755, 14.023157884362044, 28.44828384876643, 21.415455692868587, 10.186247286172788, 22.500942955214924, 4.725575657590603, 16.724603675376844, 2.2795818714018528, 4.47566341760749, 8.787659154422933, 39.25172060309935, 6.262446792685093, 5.911724242284444, 4.041178125076383, 8.580508114863699, 2.9624178140208786, 4.866483593260678, 16.498507849473334, 9.039906900632197, 1.221554027608545, 18.22637521752175, 3.1418115905583126, 6.067760032220453, 0.0, 6.556228142491365, 1.4976116971078257, 14.13399621095013, 37.701526658946854, 42.67528921223476, 6.310513306064725, 1.8557462969618324, 12.145219631094003, 1.219126053578715, 2.34729103428352, 4.334933015396255, 33.776292235563794, 0.4040891795845535, 22.987493553826052, 11.38342288971404, 33.62429978784398, 43.05064266350952, 20.931935711897086, 35.08992131789033, 2.127424801401288, 9.598039892847998, 27.66752019420291, 5.743264688291653, 32.951088344775954, 30.389875800536654, 14.292357589304295, 19.669501266691167, 16.98647365759941, 2.899422172155903, 10.293975887822372, 2.1592562335208907, 8.8882864819151, 24.325638612729502, 8.4058528057874, 11.257177162094651, 3.034063932612658, 6.414866068235821, 15.26764808254362, 0.5706365081069108, 25.631289784143807, 42.595319502966134, 24.038973469844464, 31.13957791667295, 5.468283643718568, 3.1011007696689057, 3.6176547029846096, 20.487253770992105, 5.785911890201084, 3.9647161632130334, 6.621384469403818, 5.638546506245925, 36.994964409334884, 2.9213389028616525, 50.44504315689991, 15.060477187051719, 56.391510358654585, 38.99155407353407, 1.5111695732697825, 0.8479702126243702, 48.093479061385175, 77.73100555127603, 0.18106998820653125, 23.520845316896217, 40.78837444421794, 31.918043466661114, 24.00423397246542, 3.2397509235638813, 22.73617588557684, 5.157581176324275, 2.630027584269127, 8.012518867972739, 23.56375534490626, 24.47215742836176, 26.357538210450944, 50.27146756412911, 28.101031495936276, 51.95869148903577, 6.900664414848491, 8.202585855289147, 8.579988143471198, 0.8331225893960701, 12.300606512694323, 28.760572293437214, 3.035732646442996, 50.55439854793047, 21.690694873665578, 21.030357604509877, 16.321727244809818, 26.21464011813497, 27.817109720882755, 38.80945975739646, 80.17168669710864, 37.74358912399692, 5.214370819669885, 7.00304420585336, 34.94230286762015, 41.74345640714138, 32.890955222254846, 31.361949504553092, 44.58265030098849, 44.455629607072666, 36.310714846115665, 12.390939403414654, 16.29038192262648, 1.026366675202767, 19.958555971329822, 4.713047654835894, 23.489213741818716, 12.90494510526411, 18.546008478571554, 37.3538416741322, 127.25982801210688, 51.71370070095443, 2.3859939747297783, 0.6172110761431411, 15.492539074546096, 41.37270586649468, 49.8921351394901, 22.055924711692832, 0.7629304572013087, 4.146751567670073, 25.091321381362107, 28.692766726491236, 0.8906099880846661, 21.97449701729447, 16.628482194759233, 11.833210542912237]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4534402850253314, "mean_inference_ms": 6.437027051794619, "mean_action_processing_ms": 1.0903588239218316, "mean_env_wait_ms": 0.8528583807505912, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00952613353729248, "StateBufferConnector_ms": 0.009072422981262207, "ViewRequirementAgentConnector_ms": 0.3607121706008911}, "num_episodes": 23, "episode_return_max": 389.6172110761431, "episode_return_min": 139.44855202888675, "episode_return_mean": 293.4682742471666, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 592000, "num_agent_steps_trained": 592000, "num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 239.88080835403005, "num_env_steps_trained_throughput_per_sec": 239.88080835403005, "timesteps_total": 148000, "num_env_steps_sampled_lifetime": 148000, "num_agent_steps_sampled_lifetime": 592000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 592000, "timers": {"training_iteration_time_ms": 16256.03, "restore_workers_time_ms": 0.014, "training_step_time_ms": 16255.988, "sample_time_ms": 4171.309, "learn_time_ms": 12069.848, "learn_throughput": 331.404, "synch_weights_time_ms": 13.964}, "counters": {"num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_agent_steps_sampled": 592000, "num_agent_steps_trained": 592000}, "done": false, "training_iteration": 37, "trial_id": "d163c_00000", "date": "2024-08-16_13-01-34", "timestamp": 1723793494, "time_this_iter_s": 16.67916178703308, "time_total_s": 714.2200880050659, "pid": 81201, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16b8da940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 714.2200880050659, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 30.791666666666668, "ram_util_percent": 67.98750000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.776206604639689, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.9269434184624403, "policy_loss": -0.0037118452886937474, "vf_loss": 2.9293522486611017, "vf_explained_var": 0.2224589605180044, "kl": 0.00868674397188653, "entropy": 1.204625753498582, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 70875.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.197628259974182, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.536513828095936, "policy_loss": -0.005703409585273928, "vf_loss": 9.540687631677699, "vf_explained_var": 0.0010559917442382327, "kl": 0.0076480062030546, "entropy": 1.3782816751293405, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 70875.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_agent_steps_sampled": 608000, "num_agent_steps_trained": 608000}, "env_runners": {"episode_reward_max": 389.6172110761431, "episode_reward_min": 139.44855202888675, "episode_reward_mean": 290.9504173877688, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -79.935682833103, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 127.25982801210688}, "policy_reward_mean": {"prey_policy": 127.43948098690343, "predator_policy": 18.035727706980982}, "custom_metrics": {}, "hist_stats": {"episode_reward": [313.4199999999999, 347.43535863921306, 364.3299999999999, 139.93296460639047, 345.1015335363687, 319.49999999999994, 302.6799999999996, 340.7597481785271, 342.99399052371166, 327.4, 330.6348973090692, 311.8779013997623, 342.3030187003717, 330.36, 333.63228516392047, 308.6751986367026, 306.16574244085416, 311.7605077127065, 241.36000000000007, 321.60769133370377, 164.42004932068605, 362.4389316868301, 334.48591093395896, 326.5, 286.04051771372326, 318.3351283309739, 191.45763126634597, 318.93160491733676, 340.31819297146353, 317.10597933380984, 282.8871509766972, 293.3329897109244, 289.7720077075002, 351.5613108263053, 299.333497759279, 314.4361162084328, 347.8639016342729, 263.28407697276134, 282.19377044663815, 262.2460504416872, 381.1161317326776, 293.0089277282649, 309.5063234897427, 336.1955991515073, 204.07505106441639, 215.47443474613527, 212.64538679234425, 368.22, 174.99062669153074, 289.53, 166.12469653054737, 313.7328246007074, 287.64722216087574, 299.64, 257.55462694533753, 139.44855202888675, 250.86829694540344, 339.9705916804462, 368.96312258939605, 237.80234712111212, 277.6542361867953, 267.32757077006994, 278.94542174870355, 246.7602178976103, 140.8976672208556, 344.47131866747117, 230.58885389871037, 196.89002324363145, 202.96488861669954, 201.9594559976882, 346.5588858776954, 346.6531858605615, 313.19, 170.01759670174445, 233.66308620740605, 389.6172110761431, 248.41330780494317, 252.84580073520618, 363.02617229345486, 206.37565410962011, 227.2533221687766, 303.63393416774966, 273.36662910036296, 251.93998547109095, 336.3117589397461, 340.1080478511013, 286.4007284440455, 328.5409252612419, 332.1346677769263, 340.4044907218084, 339.5844880393809, 317.88316372181293, 299.3949491288397, 327.9376646501811, 332.10336265577286, 307.26, 268.6599733622087, 311.375949827284, 328.9339650848798, 307.60275814840014], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [143.94725583920368, 147.56035704758244, 185.15, 145.101131459551, 178.5791034126189, 185.15, -5.384017376968327, 135.36856553298705, 155.75663802753957, 181.32891914436533, 154.45999999999992, 154.765002830027, 142.04056043978034, 142.69304596942987, 185.0016704051706, 105.89433823172149, 164.958353783868, 145.34844649845587, 140.59982066703253, 165.34999999999997, 157.5396520200599, 166.33999999999992, 191.88909705749165, 71.9494245847484, 134.57725794636895, 195.5515897190333, 148.05729620669092, 169.68101755336897, 185.7272782049048, 140.07610555173412, 138.26176762662033, 144.87501625997675, 158.18246887465097, 128.53534432107287, 168.8809360899278, 133.67000000000002, 46.683771857508596, 188.11999999999995, 157.79431613001304, 148.18176729563274, 7.328408998804899, 76.71482445069941, 156.2526720838035, 198.01999999999998, 181.9821838163457, 139.13938143294052, 154.1278128049068, 165.68996314541346, 153.72288244893838, 98.13725384963651, 147.67343093973955, 136.2907809476943, 37.38650149101321, 77.39618732397923, 141.99966920543966, 120.91007868210967, 139.60196010715205, 188.99076817006232, 129.65277295138063, 154.04242149993462, 95.55473010536761, 123.99145672601702, 147.73101631368533, 111.64011454124369, 139.6203283139317, 130.26578356381333, 182.4239320624631, 156.68414664249894, 157.69213423132277, 108.42743843331172, 94.77308624055061, 200.0, 178.66983770166024, 159.74513393176417, 137.53640988917704, 109.90938249293384, 43.260054565681756, 170.7071065938465, 108.91188433811895, 98.15561471705084, 198.8439577139736, 173.70278960531653, 113.3341152458706, 155.56990400841767, 163.37, 136.38569543632855, 164.00227549267044, 159.93339268318707, 104.3818849802788, 59.776862771941154, 140.7706533206777, 9.19826108150594, 76.04706630451922, 41.215256055636445, 176.34202978737562, 189.51883042673023, 13.158873686116129, 36.00726839275359, 146.34893001179347, 119.47915468310379, 4.370552112566301, 89.0477265071021, 144.04818132723688, 142.4406583774412, 107.45558242841685, 152.29788267055773, 160.98748113202726, 128.00997241573086, 111.64753354325498, 97.87118062881456, 44.12435029089163, 18.695195963415024, 32.84931004932939, 137.95926391110186, 167.76767108263533, 157.09967032767318, 183.30371790805242, 176.24629394847642, 73.71006034262994, 123.03110797235067, 71.63551413604695, 152.42859085637485, 107.10165917463308, 117.50485911726153, 129.84936179860404, 106.55969258715487, 164.60037269079046, 15.533275728540591, 31.603915680946045, -8.62152428119618, 168.82801230109905, 163.42589134084892, 151.65226643346023, 2.2508281904886114, 71.89225012630136, 60.74486839052211, -21.911103160074475, 135.8377118687128, 29.60974865250174, 123.64805309565614, 143.89947852831142, 185.34265875155467, 170.3, 151.68158223439585, 190.9869567017279, 85.80888445118929, 50.490968182847396, 63.62677836619332, 134.62524032744784, -79.935682833103, 186.6140060252702, 200.0, 100.16925560170301, 91.37880726219949, 33.66078933488741, 147.23695154913582, 165.0332484323299, 193.08324183625353, 58.52860517584846, 94.06296082591834, 83.3299942178858, 121.05822094551165, 119.39724546766254, 155.77499596241566, 150.7877324514667, 74.90970918512431, 16.371942514039006, 168.95327071341714, 153.3202845175144, 159.31842743087492, 158.69875931831214, 170.46930915823685, 104.05351588108934, 146.7640937865483, 128.8780418057222, 179.97591209495937, 102.47931122900586, 174.22915158131403, 158.86994050238954, 170.28978392976933, 153.80392030089897, 169.1957898762684, 125.81263979327997, 163.47838959963582, 117.84697200847404, 150.80758836871345, 130.45896403253283, 176.64717247013937, 192.645469560735, 129.9991603453883, 167.96862243667445, 115.73448000637816, 73.15451693449097, 154.60247966999674, 196.3914462683875, 97.75175563088584, 88.39046320057741, 165.7046336602848, 103.8024350332336, 155.6472404131626], "policy_predator_policy_reward": [2.5965791537487246, 19.315807959465214, 6.444513067644518, 10.739714112017507, 0.0, 0.6008965873811305, 8.083821728647598, 1.8645947217239032, 3.603481749801117, 4.412494614662824, 10.274997169973023, 0.0, 3.92323570642755, 14.023157884362044, 28.44828384876643, 21.415455692868587, 10.186247286172788, 22.500942955214924, 4.725575657590603, 16.724603675376844, 2.2795818714018528, 4.47566341760749, 8.787659154422933, 39.25172060309935, 6.262446792685093, 5.911724242284444, 4.041178125076383, 8.580508114863699, 2.9624178140208786, 4.866483593260678, 16.498507849473334, 9.039906900632197, 1.221554027608545, 18.22637521752175, 3.1418115905583126, 6.067760032220453, 0.0, 6.556228142491365, 1.4976116971078257, 14.13399621095013, 37.701526658946854, 42.67528921223476, 6.310513306064725, 1.8557462969618324, 12.145219631094003, 1.219126053578715, 2.34729103428352, 4.334933015396255, 33.776292235563794, 0.4040891795845535, 22.987493553826052, 11.38342288971404, 33.62429978784398, 43.05064266350952, 20.931935711897086, 35.08992131789033, 2.127424801401288, 9.598039892847998, 27.66752019420291, 5.743264688291653, 32.951088344775954, 30.389875800536654, 14.292357589304295, 19.669501266691167, 16.98647365759941, 2.899422172155903, 10.293975887822372, 2.1592562335208907, 8.8882864819151, 24.325638612729502, 8.4058528057874, 11.257177162094651, 3.034063932612658, 6.414866068235821, 15.26764808254362, 0.5706365081069108, 25.631289784143807, 42.595319502966134, 24.038973469844464, 31.13957791667295, 5.468283643718568, 3.1011007696689057, 3.6176547029846096, 20.487253770992105, 5.785911890201084, 3.9647161632130334, 6.621384469403818, 5.638546506245925, 36.994964409334884, 2.9213389028616525, 50.44504315689991, 15.060477187051719, 56.391510358654585, 38.99155407353407, 1.5111695732697825, 0.8479702126243702, 48.093479061385175, 77.73100555127603, 0.18106998820653125, 23.520845316896217, 40.78837444421794, 31.918043466661114, 24.00423397246542, 3.2397509235638813, 22.73617588557684, 5.157581176324275, 2.630027584269127, 8.012518867972739, 23.56375534490626, 24.47215742836176, 26.357538210450944, 50.27146756412911, 28.101031495936276, 51.95869148903577, 6.900664414848491, 8.202585855289147, 8.579988143471198, 0.8331225893960701, 12.300606512694323, 28.760572293437214, 3.035732646442996, 50.55439854793047, 21.690694873665578, 21.030357604509877, 16.321727244809818, 26.21464011813497, 27.817109720882755, 38.80945975739646, 80.17168669710864, 37.74358912399692, 5.214370819669885, 7.00304420585336, 34.94230286762015, 41.74345640714138, 32.890955222254846, 31.361949504553092, 44.58265030098849, 44.455629607072666, 36.310714846115665, 12.390939403414654, 16.29038192262648, 1.026366675202767, 19.958555971329822, 4.713047654835894, 23.489213741818716, 12.90494510526411, 18.546008478571554, 37.3538416741322, 127.25982801210688, 51.71370070095443, 2.3859939747297783, 0.6172110761431411, 15.492539074546096, 41.37270586649468, 49.8921351394901, 22.055924711692832, 0.7629304572013087, 4.146751567670073, 25.091321381362107, 28.692766726491236, 0.8906099880846661, 21.97449701729447, 16.628482194759233, 11.833210542912237, 3.9635835516578637, 43.70560391211422, 37.42572002968696, 29.18905221394798, 4.95980078328398, 18.713246208072754, 7.7762705305189215, 3.163708844033388, 10.552199482698734, 25.03091929370913, 11.671880535465878, 8.015090825094374, 20.058049400204652, 35.36815556640174, 6.966238529889868, 4.2785277597595925, 3.3022231973158496, 13.282554664897642, 17.5432834346663, 11.048850894230817, 7.837301984318609, 22.903086767333622, 15.200187277303092, 5.631340870205768, 6.318840346710427, 3.1398924029390924, 22.265519993621858, 1.2913775633255407, 17.18212608365196, 23.720850674069084, 4.491140249748618, 12.741607678262524, 59.94664217698645, 14.8922260470311, 25.960656625412593, 22.192426076591325]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4450222267157597, "mean_inference_ms": 6.413860159039887, "mean_action_processing_ms": 1.085817940604034, "mean_env_wait_ms": 0.8490992667915177, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010824322700500488, "StateBufferConnector_ms": 0.01065671443939209, "ViewRequirementAgentConnector_ms": 0.33516883850097656}, "num_episodes": 18, "episode_return_max": 389.6172110761431, "episode_return_min": 139.44855202888675, "episode_return_mean": 290.9504173877688, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 608000, "num_agent_steps_trained": 608000, "num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 256.61797254068557, "num_env_steps_trained_throughput_per_sec": 256.61797254068557, "timesteps_total": 152000, "num_env_steps_sampled_lifetime": 152000, "num_agent_steps_sampled_lifetime": 608000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 608000, "timers": {"training_iteration_time_ms": 16235.515, "restore_workers_time_ms": 0.014, "training_step_time_ms": 16235.474, "sample_time_ms": 4172.766, "learn_time_ms": 12048.025, "learn_throughput": 332.005, "synch_weights_time_ms": 13.856}, "counters": {"num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_agent_steps_sampled": 608000, "num_agent_steps_trained": 608000}, "done": false, "training_iteration": 38, "trial_id": "d163c_00000", "date": "2024-08-16_13-01-49", "timestamp": 1723793509, "time_this_iter_s": 15.591456890106201, "time_total_s": 729.8115448951721, "pid": 81201, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16af06ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 729.8115448951721, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 28.118181818181824, "ram_util_percent": 68.33636363636364}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.642482265088924, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.5713363751847909, "policy_loss": -0.00932662713984471, "vf_loss": 1.57903014531842, "vf_explained_var": 0.16703549014828192, "kl": 0.010885697821043193, "entropy": 1.1639848741904768, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 72765.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.15502746776929, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.562237720893174, "policy_loss": -0.006932990475577455, "vf_loss": 9.567029218825082, "vf_explained_var": -0.15268451697611934, "kl": 0.010707333420099458, "entropy": 1.377306501575248, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 72765.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 624000, "num_agent_steps_trained": 624000}, "env_runners": {"episode_reward_max": 389.6172110761431, "episode_reward_min": 139.44855202888675, "episode_reward_mean": 293.50718366241193, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -79.935682833103, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 127.25982801210688}, "policy_reward_mean": {"prey_policy": 128.7426098636354, "predator_policy": 18.01098196757055}, "custom_metrics": {}, "hist_stats": {"episode_reward": [241.36000000000007, 321.60769133370377, 164.42004932068605, 362.4389316868301, 334.48591093395896, 326.5, 286.04051771372326, 318.3351283309739, 191.45763126634597, 318.93160491733676, 340.31819297146353, 317.10597933380984, 282.8871509766972, 293.3329897109244, 289.7720077075002, 351.5613108263053, 299.333497759279, 314.4361162084328, 347.8639016342729, 263.28407697276134, 282.19377044663815, 262.2460504416872, 381.1161317326776, 293.0089277282649, 309.5063234897427, 336.1955991515073, 204.07505106441639, 215.47443474613527, 212.64538679234425, 368.22, 174.99062669153074, 289.53, 166.12469653054737, 313.7328246007074, 287.64722216087574, 299.64, 257.55462694533753, 139.44855202888675, 250.86829694540344, 339.9705916804462, 368.96312258939605, 237.80234712111212, 277.6542361867953, 267.32757077006994, 278.94542174870355, 246.7602178976103, 140.8976672208556, 344.47131866747117, 230.58885389871037, 196.89002324363145, 202.96488861669954, 201.9594559976882, 346.5588858776954, 346.6531858605615, 313.19, 170.01759670174445, 233.66308620740605, 389.6172110761431, 248.41330780494317, 252.84580073520618, 363.02617229345486, 206.37565410962011, 227.2533221687766, 303.63393416774966, 273.36662910036296, 251.93998547109095, 336.3117589397461, 340.1080478511013, 286.4007284440455, 328.5409252612419, 332.1346677769263, 340.4044907218084, 339.5844880393809, 317.88316372181293, 299.3949491288397, 327.9376646501811, 332.10336265577286, 307.26, 268.6599733622087, 311.375949827284, 328.9339650848798, 307.60275814840014, 339.99416981305103, 330.0912871860477, 355.7793915060953, 361.5131800562207, 312.49, 318.802157210602, 342.89031087626523, 334.3494467334482, 375.3996021532563, 329.28999999999996, 369.02, 352.01, 315.88437119643436, 344.3294081283219, 278.6593669349123, 259.7557430460868, 330.7013394711658, 323.67999999999995], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [46.683771857508596, 188.11999999999995, 157.79431613001304, 148.18176729563274, 7.328408998804899, 76.71482445069941, 156.2526720838035, 198.01999999999998, 181.9821838163457, 139.13938143294052, 154.1278128049068, 165.68996314541346, 153.72288244893838, 98.13725384963651, 147.67343093973955, 136.2907809476943, 37.38650149101321, 77.39618732397923, 141.99966920543966, 120.91007868210967, 139.60196010715205, 188.99076817006232, 129.65277295138063, 154.04242149993462, 95.55473010536761, 123.99145672601702, 147.73101631368533, 111.64011454124369, 139.6203283139317, 130.26578356381333, 182.4239320624631, 156.68414664249894, 157.69213423132277, 108.42743843331172, 94.77308624055061, 200.0, 178.66983770166024, 159.74513393176417, 137.53640988917704, 109.90938249293384, 43.260054565681756, 170.7071065938465, 108.91188433811895, 98.15561471705084, 198.8439577139736, 173.70278960531653, 113.3341152458706, 155.56990400841767, 163.37, 136.38569543632855, 164.00227549267044, 159.93339268318707, 104.3818849802788, 59.776862771941154, 140.7706533206777, 9.19826108150594, 76.04706630451922, 41.215256055636445, 176.34202978737562, 189.51883042673023, 13.158873686116129, 36.00726839275359, 146.34893001179347, 119.47915468310379, 4.370552112566301, 89.0477265071021, 144.04818132723688, 142.4406583774412, 107.45558242841685, 152.29788267055773, 160.98748113202726, 128.00997241573086, 111.64753354325498, 97.87118062881456, 44.12435029089163, 18.695195963415024, 32.84931004932939, 137.95926391110186, 167.76767108263533, 157.09967032767318, 183.30371790805242, 176.24629394847642, 73.71006034262994, 123.03110797235067, 71.63551413604695, 152.42859085637485, 107.10165917463308, 117.50485911726153, 129.84936179860404, 106.55969258715487, 164.60037269079046, 15.533275728540591, 31.603915680946045, -8.62152428119618, 168.82801230109905, 163.42589134084892, 151.65226643346023, 2.2508281904886114, 71.89225012630136, 60.74486839052211, -21.911103160074475, 135.8377118687128, 29.60974865250174, 123.64805309565614, 143.89947852831142, 185.34265875155467, 170.3, 151.68158223439585, 190.9869567017279, 85.80888445118929, 50.490968182847396, 63.62677836619332, 134.62524032744784, -79.935682833103, 186.6140060252702, 200.0, 100.16925560170301, 91.37880726219949, 33.66078933488741, 147.23695154913582, 165.0332484323299, 193.08324183625353, 58.52860517584846, 94.06296082591834, 83.3299942178858, 121.05822094551165, 119.39724546766254, 155.77499596241566, 150.7877324514667, 74.90970918512431, 16.371942514039006, 168.95327071341714, 153.3202845175144, 159.31842743087492, 158.69875931831214, 170.46930915823685, 104.05351588108934, 146.7640937865483, 128.8780418057222, 179.97591209495937, 102.47931122900586, 174.22915158131403, 158.86994050238954, 170.28978392976933, 153.80392030089897, 169.1957898762684, 125.81263979327997, 163.47838959963582, 117.84697200847404, 150.80758836871345, 130.45896403253283, 176.64717247013937, 192.645469560735, 129.9991603453883, 167.96862243667445, 115.73448000637816, 73.15451693449097, 154.60247966999674, 196.3914462683875, 97.75175563088584, 88.39046320057741, 165.7046336602848, 103.8024350332336, 155.6472404131626, 179.62329861764988, 156.23448852354318, 144.4930046389867, 161.81389787888216, 184.1708209497262, 155.5494579848804, 171.82019567200655, 183.02620344970245, 176.09481447861788, 125.61644458847329, 162.4272048872225, 147.84830585557256, 199.01, 133.88651989646274, 168.80407854706664, 145.08468110418096, 178.74819282565903, 195.07807379585756, 153.0794016866608, 144.37763066087575, 187.03467629801827, 175.85466473878867, 163.79323395216562, 160.2990610964631, 116.20182296835891, 149.03852221812772, 139.44944381691172, 187.4030478172034, 146.2455900357043, 107.73762821443032, 86.34094588183018, 133.40808801978773, 173.06368883339917, 133.97217449788474, 132.45797698361574, 189.00193786069474], "policy_predator_policy_reward": [0.0, 6.556228142491365, 1.4976116971078257, 14.13399621095013, 37.701526658946854, 42.67528921223476, 6.310513306064725, 1.8557462969618324, 12.145219631094003, 1.219126053578715, 2.34729103428352, 4.334933015396255, 33.776292235563794, 0.4040891795845535, 22.987493553826052, 11.38342288971404, 33.62429978784398, 43.05064266350952, 20.931935711897086, 35.08992131789033, 2.127424801401288, 9.598039892847998, 27.66752019420291, 5.743264688291653, 32.951088344775954, 30.389875800536654, 14.292357589304295, 19.669501266691167, 16.98647365759941, 2.899422172155903, 10.293975887822372, 2.1592562335208907, 8.8882864819151, 24.325638612729502, 8.4058528057874, 11.257177162094651, 3.034063932612658, 6.414866068235821, 15.26764808254362, 0.5706365081069108, 25.631289784143807, 42.595319502966134, 24.038973469844464, 31.13957791667295, 5.468283643718568, 3.1011007696689057, 3.6176547029846096, 20.487253770992105, 5.785911890201084, 3.9647161632130334, 6.621384469403818, 5.638546506245925, 36.994964409334884, 2.9213389028616525, 50.44504315689991, 15.060477187051719, 56.391510358654585, 38.99155407353407, 1.5111695732697825, 0.8479702126243702, 48.093479061385175, 77.73100555127603, 0.18106998820653125, 23.520845316896217, 40.78837444421794, 31.918043466661114, 24.00423397246542, 3.2397509235638813, 22.73617588557684, 5.157581176324275, 2.630027584269127, 8.012518867972739, 23.56375534490626, 24.47215742836176, 26.357538210450944, 50.27146756412911, 28.101031495936276, 51.95869148903577, 6.900664414848491, 8.202585855289147, 8.579988143471198, 0.8331225893960701, 12.300606512694323, 28.760572293437214, 3.035732646442996, 50.55439854793047, 21.690694873665578, 21.030357604509877, 16.321727244809818, 26.21464011813497, 27.817109720882755, 38.80945975739646, 80.17168669710864, 37.74358912399692, 5.214370819669885, 7.00304420585336, 34.94230286762015, 41.74345640714138, 32.890955222254846, 31.361949504553092, 44.58265030098849, 44.455629607072666, 36.310714846115665, 12.390939403414654, 16.29038192262648, 1.026366675202767, 19.958555971329822, 4.713047654835894, 23.489213741818716, 12.90494510526411, 18.546008478571554, 37.3538416741322, 127.25982801210688, 51.71370070095443, 2.3859939747297783, 0.6172110761431411, 15.492539074546096, 41.37270586649468, 49.8921351394901, 22.055924711692832, 0.7629304572013087, 4.146751567670073, 25.091321381362107, 28.692766726491236, 0.8906099880846661, 21.97449701729447, 16.628482194759233, 11.833210542912237, 3.9635835516578637, 43.70560391211422, 37.42572002968696, 29.18905221394798, 4.95980078328398, 18.713246208072754, 7.7762705305189215, 3.163708844033388, 10.552199482698734, 25.03091929370913, 11.671880535465878, 8.015090825094374, 20.058049400204652, 35.36815556640174, 6.966238529889868, 4.2785277597595925, 3.3022231973158496, 13.282554664897642, 17.5432834346663, 11.048850894230817, 7.837301984318609, 22.903086767333622, 15.200187277303092, 5.631340870205768, 6.318840346710427, 3.1398924029390924, 22.265519993621858, 1.2913775633255407, 17.18212608365196, 23.720850674069084, 4.491140249748618, 12.741607678262524, 59.94664217698645, 14.8922260470311, 25.960656625412593, 22.192426076591325, 3.903726858915835, 0.23265581294208942, 9.006280174192812, 14.778104493985985, 9.662780334315622, 6.396332237173148, 4.691143869078744, 1.975637065432963, 6.199545629304359, 4.579195303604527, 5.24256966820418, 3.284076799602737, 9.355772595575335, 0.6380183842271403, 4.893203514490665, 15.56748356770999, 1.363733378483396, 0.2096021532563201, 25.920598313339205, 5.912369339124235, 2.525256291652412, 3.6054026715406584, 8.05450253978924, 19.863202411581995, 45.65672223201912, 4.987303777928553, 8.51072394536021, 8.96619254884659, 12.257548606923079, 12.418600077854757, 31.169684996105982, 8.837024148362973, 10.635612518452408, 13.029863621429419, 0.34614767845274097, 1.8739374772368478]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4371727084592276, "mean_inference_ms": 6.391204796458132, "mean_action_processing_ms": 1.081277224350213, "mean_env_wait_ms": 0.8456685179871536, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01159679889678955, "StateBufferConnector_ms": 0.020812630653381348, "ViewRequirementAgentConnector_ms": 0.3383960723876953}, "num_episodes": 18, "episode_return_max": 389.6172110761431, "episode_return_min": 139.44855202888675, "episode_return_mean": 293.50718366241193, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 624000, "num_agent_steps_trained": 624000, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 263.87563437389724, "num_env_steps_trained_throughput_per_sec": 263.87563437389724, "timesteps_total": 156000, "num_env_steps_sampled_lifetime": 156000, "num_agent_steps_sampled_lifetime": 624000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 624000, "timers": {"training_iteration_time_ms": 16077.57, "restore_workers_time_ms": 0.014, "training_step_time_ms": 16077.528, "sample_time_ms": 4171.344, "learn_time_ms": 11891.451, "learn_throughput": 336.376, "synch_weights_time_ms": 13.795}, "counters": {"num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 624000, "num_agent_steps_trained": 624000}, "done": false, "training_iteration": 39, "trial_id": "d163c_00000", "date": "2024-08-16_13-02-05", "timestamp": 1723793525, "time_this_iter_s": 15.162973880767822, "time_total_s": 744.9745187759399, "pid": 81201, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16b86d280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 744.9745187759399, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 27.757142857142856, "ram_util_percent": 67.6047619047619}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.216802470299302, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.8012948004183946, "policy_loss": -0.006077267015328207, "vf_loss": 0.8064084219081061, "vf_explained_var": 0.35720906932517965, "kl": 0.006424286992459596, "entropy": 1.144984370060068, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 74655.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.936047153466593, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.6015679894301, "policy_loss": -0.006833574116456682, "vf_loss": 9.606457741550667, "vf_explained_var": -0.21144500797387783, "kl": 0.009718956010993395, "entropy": 1.3748045137319616, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 74655.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 640000, "num_agent_steps_trained": 640000}, "env_runners": {"episode_reward_max": 389.6172110761431, "episode_reward_min": 139.44855202888675, "episode_reward_mean": 302.74295782574984, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -79.935682833103, "predator_policy": 0.18106998820653125}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 127.25982801210688}, "policy_reward_mean": {"prey_policy": 135.006156661766, "predator_policy": 16.36532225110893}, "custom_metrics": {}, "hist_stats": {"episode_reward": [381.1161317326776, 293.0089277282649, 309.5063234897427, 336.1955991515073, 204.07505106441639, 215.47443474613527, 212.64538679234425, 368.22, 174.99062669153074, 289.53, 166.12469653054737, 313.7328246007074, 287.64722216087574, 299.64, 257.55462694533753, 139.44855202888675, 250.86829694540344, 339.9705916804462, 368.96312258939605, 237.80234712111212, 277.6542361867953, 267.32757077006994, 278.94542174870355, 246.7602178976103, 140.8976672208556, 344.47131866747117, 230.58885389871037, 196.89002324363145, 202.96488861669954, 201.9594559976882, 346.5588858776954, 346.6531858605615, 313.19, 170.01759670174445, 233.66308620740605, 389.6172110761431, 248.41330780494317, 252.84580073520618, 363.02617229345486, 206.37565410962011, 227.2533221687766, 303.63393416774966, 273.36662910036296, 251.93998547109095, 336.3117589397461, 340.1080478511013, 286.4007284440455, 328.5409252612419, 332.1346677769263, 340.4044907218084, 339.5844880393809, 317.88316372181293, 299.3949491288397, 327.9376646501811, 332.10336265577286, 307.26, 268.6599733622087, 311.375949827284, 328.9339650848798, 307.60275814840014, 339.99416981305103, 330.0912871860477, 355.7793915060953, 361.5131800562207, 312.49, 318.802157210602, 342.89031087626523, 334.3494467334482, 375.3996021532563, 329.28999999999996, 369.02, 352.01, 315.88437119643436, 344.3294081283219, 278.6593669349123, 259.7557430460868, 330.7013394711658, 323.67999999999995, 355.05215174075806, 311.84655583131627, 353.06447362574295, 299.8228767673104, 339.63613602649156, 375.06, 326.91903312766794, 293.1213241463482, 349.37, 357.45834725346936, 371.5215316655344, 316.52000000000004, 350.6605150301416, 366.7325547702665, 294.7778958786846, 306.35768066554647, 358.86840121133514, 345.6345939536558, 362.01, 328.9525312820542, 333.903887253835, 336.19943659696304], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [198.8439577139736, 173.70278960531653, 113.3341152458706, 155.56990400841767, 163.37, 136.38569543632855, 164.00227549267044, 159.93339268318707, 104.3818849802788, 59.776862771941154, 140.7706533206777, 9.19826108150594, 76.04706630451922, 41.215256055636445, 176.34202978737562, 189.51883042673023, 13.158873686116129, 36.00726839275359, 146.34893001179347, 119.47915468310379, 4.370552112566301, 89.0477265071021, 144.04818132723688, 142.4406583774412, 107.45558242841685, 152.29788267055773, 160.98748113202726, 128.00997241573086, 111.64753354325498, 97.87118062881456, 44.12435029089163, 18.695195963415024, 32.84931004932939, 137.95926391110186, 167.76767108263533, 157.09967032767318, 183.30371790805242, 176.24629394847642, 73.71006034262994, 123.03110797235067, 71.63551413604695, 152.42859085637485, 107.10165917463308, 117.50485911726153, 129.84936179860404, 106.55969258715487, 164.60037269079046, 15.533275728540591, 31.603915680946045, -8.62152428119618, 168.82801230109905, 163.42589134084892, 151.65226643346023, 2.2508281904886114, 71.89225012630136, 60.74486839052211, -21.911103160074475, 135.8377118687128, 29.60974865250174, 123.64805309565614, 143.89947852831142, 185.34265875155467, 170.3, 151.68158223439585, 190.9869567017279, 85.80888445118929, 50.490968182847396, 63.62677836619332, 134.62524032744784, -79.935682833103, 186.6140060252702, 200.0, 100.16925560170301, 91.37880726219949, 33.66078933488741, 147.23695154913582, 165.0332484323299, 193.08324183625353, 58.52860517584846, 94.06296082591834, 83.3299942178858, 121.05822094551165, 119.39724546766254, 155.77499596241566, 150.7877324514667, 74.90970918512431, 16.371942514039006, 168.95327071341714, 153.3202845175144, 159.31842743087492, 158.69875931831214, 170.46930915823685, 104.05351588108934, 146.7640937865483, 128.8780418057222, 179.97591209495937, 102.47931122900586, 174.22915158131403, 158.86994050238954, 170.28978392976933, 153.80392030089897, 169.1957898762684, 125.81263979327997, 163.47838959963582, 117.84697200847404, 150.80758836871345, 130.45896403253283, 176.64717247013937, 192.645469560735, 129.9991603453883, 167.96862243667445, 115.73448000637816, 73.15451693449097, 154.60247966999674, 196.3914462683875, 97.75175563088584, 88.39046320057741, 165.7046336602848, 103.8024350332336, 155.6472404131626, 179.62329861764988, 156.23448852354318, 144.4930046389867, 161.81389787888216, 184.1708209497262, 155.5494579848804, 171.82019567200655, 183.02620344970245, 176.09481447861788, 125.61644458847329, 162.4272048872225, 147.84830585557256, 199.01, 133.88651989646274, 168.80407854706664, 145.08468110418096, 178.74819282565903, 195.07807379585756, 153.0794016866608, 144.37763066087575, 187.03467629801827, 175.85466473878867, 163.79323395216562, 160.2990610964631, 116.20182296835891, 149.03852221812772, 139.44944381691172, 187.4030478172034, 146.2455900357043, 107.73762821443032, 86.34094588183018, 133.40808801978773, 173.06368883339917, 133.97217449788474, 132.45797698361574, 189.00193786069474, 200.0, 142.67743751305645, 158.30506997629925, 139.36587455495768, 161.18667655001167, 180.6262001053668, 140.58197354960276, 123.86514190073272, 158.31265036930358, 166.59467956763126, 180.82574463066413, 189.94564507659985, 142.13730067336434, 162.7048958059614, 152.71358208067994, 138.00521566712706, 179.7825623554529, 166.5916726409056, 169.33800743496903, 166.22891855380593, 152.04061142721423, 200.0, 170.13421530486715, 136.5794197499068, 165.93157033692628, 167.54000190382519, 184.94733545493995, 145.51672702749477, 142.30545429768114, 131.82358258280576, 173.75435658530324, 105.04880072490496, 172.7387168221568, 178.85067969628045, 164.83366705042704, 159.59924204090976, 166.19859533383922, 186.2660103922375, 146.48184740028904, 155.57785873711927, 116.06604323187088, 194.06079763265606, 128.19002967702045, 189.9739482465348], "policy_predator_policy_reward": [5.468283643718568, 3.1011007696689057, 3.6176547029846096, 20.487253770992105, 5.785911890201084, 3.9647161632130334, 6.621384469403818, 5.638546506245925, 36.994964409334884, 2.9213389028616525, 50.44504315689991, 15.060477187051719, 56.391510358654585, 38.99155407353407, 1.5111695732697825, 0.8479702126243702, 48.093479061385175, 77.73100555127603, 0.18106998820653125, 23.520845316896217, 40.78837444421794, 31.918043466661114, 24.00423397246542, 3.2397509235638813, 22.73617588557684, 5.157581176324275, 2.630027584269127, 8.012518867972739, 23.56375534490626, 24.47215742836176, 26.357538210450944, 50.27146756412911, 28.101031495936276, 51.95869148903577, 6.900664414848491, 8.202585855289147, 8.579988143471198, 0.8331225893960701, 12.300606512694323, 28.760572293437214, 3.035732646442996, 50.55439854793047, 21.690694873665578, 21.030357604509877, 16.321727244809818, 26.21464011813497, 27.817109720882755, 38.80945975739646, 80.17168669710864, 37.74358912399692, 5.214370819669885, 7.00304420585336, 34.94230286762015, 41.74345640714138, 32.890955222254846, 31.361949504553092, 44.58265030098849, 44.455629607072666, 36.310714846115665, 12.390939403414654, 16.29038192262648, 1.026366675202767, 19.958555971329822, 4.713047654835894, 23.489213741818716, 12.90494510526411, 18.546008478571554, 37.3538416741322, 127.25982801210688, 51.71370070095443, 2.3859939747297783, 0.6172110761431411, 15.492539074546096, 41.37270586649468, 49.8921351394901, 22.055924711692832, 0.7629304572013087, 4.146751567670073, 25.091321381362107, 28.692766726491236, 0.8906099880846661, 21.97449701729447, 16.628482194759233, 11.833210542912237, 3.9635835516578637, 43.70560391211422, 37.42572002968696, 29.18905221394798, 4.95980078328398, 18.713246208072754, 7.7762705305189215, 3.163708844033388, 10.552199482698734, 25.03091929370913, 11.671880535465878, 8.015090825094374, 20.058049400204652, 35.36815556640174, 6.966238529889868, 4.2785277597595925, 3.3022231973158496, 13.282554664897642, 17.5432834346663, 11.048850894230817, 7.837301984318609, 22.903086767333622, 15.200187277303092, 5.631340870205768, 6.318840346710427, 3.1398924029390924, 22.265519993621858, 1.2913775633255407, 17.18212608365196, 23.720850674069084, 4.491140249748618, 12.741607678262524, 59.94664217698645, 14.8922260470311, 25.960656625412593, 22.192426076591325, 3.903726858915835, 0.23265581294208942, 9.006280174192812, 14.778104493985985, 9.662780334315622, 6.396332237173148, 4.691143869078744, 1.975637065432963, 6.199545629304359, 4.579195303604527, 5.24256966820418, 3.284076799602737, 9.355772595575335, 0.6380183842271403, 4.893203514490665, 15.56748356770999, 1.363733378483396, 0.2096021532563201, 25.920598313339205, 5.912369339124235, 2.525256291652412, 3.6054026715406584, 8.05450253978924, 19.863202411581995, 45.65672223201912, 4.987303777928553, 8.51072394536021, 8.96619254884659, 12.257548606923079, 12.418600077854757, 31.169684996105982, 8.837024148362973, 10.635612518452408, 13.029863621429419, 0.34614767845274097, 1.8739374772368478, 5.869978046021277, 6.50473618168035, 13.13291687494496, 1.0426944251143824, 3.4270011234429543, 7.824595846921543, 12.248916430814157, 23.126844886160736, 5.218200319383793, 9.510605770172939, 3.8468667982125675, 0.44174349452345085, 4.064522670319051, 18.012313978023087, 1.4950508576989436, 0.9074755408422591, 0.5644851624646003, 2.4312798411769005, 1.4642384417927963, 20.427182822901568, 10.072751191345075, 9.408169046975097, 8.948181441936526, 0.8581835032894809, 7.227374382552526, 9.961568406837575, 14.740359038644131, 21.528133249187714, 4.26239565552626, 16.386463342671455, 15.286397577640498, 12.268125777697735, 4.229061733950936, 3.0499429589470686, 13.88986654131293, 7.311818321006071, 2.4615723180792073, 7.083821955844103, 9.341338942706743, 17.551486201939124, 2.603089621178906, 21.17395676812912, 3.1610774963706043, 14.874381177037183]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4301632020209474, "mean_inference_ms": 6.360731005257909, "mean_action_processing_ms": 1.0761396455536367, "mean_env_wait_ms": 0.8423543792827093, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010500788688659668, "StateBufferConnector_ms": 0.020808100700378418, "ViewRequirementAgentConnector_ms": 0.3800724744796753}, "num_episodes": 22, "episode_return_max": 389.6172110761431, "episode_return_min": 139.44855202888675, "episode_return_mean": 302.74295782574984, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 640000, "num_agent_steps_trained": 640000, "num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 244.73914617669482, "num_env_steps_trained_throughput_per_sec": 244.73914617669482, "timesteps_total": 160000, "num_env_steps_sampled_lifetime": 160000, "num_agent_steps_sampled_lifetime": 640000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 640000, "timers": {"training_iteration_time_ms": 16178.285, "restore_workers_time_ms": 0.016, "training_step_time_ms": 16178.239, "sample_time_ms": 4178.085, "learn_time_ms": 11985.086, "learn_throughput": 333.748, "synch_weights_time_ms": 14.104}, "counters": {"num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 640000, "num_agent_steps_trained": 640000}, "done": false, "training_iteration": 40, "trial_id": "d163c_00000", "date": "2024-08-16_13-02-21", "timestamp": 1723793541, "time_this_iter_s": 16.34888505935669, "time_total_s": 761.3234038352966, "pid": 81201, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16b87c3a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 761.3234038352966, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 29.96521739130435, "ram_util_percent": 67.74347826086955}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.882595411589537, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.7684607541434979, "policy_loss": -0.008150257866721225, "vf_loss": 0.7748205984237964, "vf_explained_var": 0.2891061102271711, "kl": 0.011936105073187, "entropy": 1.1366667803002413, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 76545.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.9638612590454243, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.453529632911481, "policy_loss": -0.0005328246855507136, "vf_loss": 9.45173480926998, "vf_explained_var": -0.09557659052036427, "kl": 0.011638258385908672, "entropy": 1.4037554566191617, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 76545.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_agent_steps_sampled": 656000, "num_agent_steps_trained": 656000}, "env_runners": {"episode_reward_max": 389.6172110761431, "episode_reward_min": 140.8976672208556, "episode_reward_mean": 320.3156268898634, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -79.935682833103, "predator_policy": 0.2096021532563201}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 127.25982801210688}, "policy_reward_mean": {"prey_policy": 146.05083303042906, "predator_policy": 14.106980414502651}, "custom_metrics": {}, "hist_stats": {"episode_reward": [246.7602178976103, 140.8976672208556, 344.47131866747117, 230.58885389871037, 196.89002324363145, 202.96488861669954, 201.9594559976882, 346.5588858776954, 346.6531858605615, 313.19, 170.01759670174445, 233.66308620740605, 389.6172110761431, 248.41330780494317, 252.84580073520618, 363.02617229345486, 206.37565410962011, 227.2533221687766, 303.63393416774966, 273.36662910036296, 251.93998547109095, 336.3117589397461, 340.1080478511013, 286.4007284440455, 328.5409252612419, 332.1346677769263, 340.4044907218084, 339.5844880393809, 317.88316372181293, 299.3949491288397, 327.9376646501811, 332.10336265577286, 307.26, 268.6599733622087, 311.375949827284, 328.9339650848798, 307.60275814840014, 339.99416981305103, 330.0912871860477, 355.7793915060953, 361.5131800562207, 312.49, 318.802157210602, 342.89031087626523, 334.3494467334482, 375.3996021532563, 329.28999999999996, 369.02, 352.01, 315.88437119643436, 344.3294081283219, 278.6593669349123, 259.7557430460868, 330.7013394711658, 323.67999999999995, 355.05215174075806, 311.84655583131627, 353.06447362574295, 299.8228767673104, 339.63613602649156, 375.06, 326.91903312766794, 293.1213241463482, 349.37, 357.45834725346936, 371.5215316655344, 316.52000000000004, 350.6605150301416, 366.7325547702665, 294.7778958786846, 306.35768066554647, 358.86840121133514, 345.6345939536558, 362.01, 328.9525312820542, 333.903887253835, 336.19943659696304, 365.8615592469232, 333.9887149603619, 315.317110336529, 294.1909457939323, 374.47298787738737, 346.8156935915725, 354.64358046434654, 372.43741905968767, 349.33714350662524, 355.0398117836943, 326.2841368744473, 355.37294020351214, 352.24, 358.8027553591139, 373.8048329356808, 351.12554813874243, 346.02832631498626, 366.20000000000005, 333.71705650345643, 353.51012674264314, 346.52869608790456, 350.94654926841156, 351.04296206629806], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [164.60037269079046, 15.533275728540591, 31.603915680946045, -8.62152428119618, 168.82801230109905, 163.42589134084892, 151.65226643346023, 2.2508281904886114, 71.89225012630136, 60.74486839052211, -21.911103160074475, 135.8377118687128, 29.60974865250174, 123.64805309565614, 143.89947852831142, 185.34265875155467, 170.3, 151.68158223439585, 190.9869567017279, 85.80888445118929, 50.490968182847396, 63.62677836619332, 134.62524032744784, -79.935682833103, 186.6140060252702, 200.0, 100.16925560170301, 91.37880726219949, 33.66078933488741, 147.23695154913582, 165.0332484323299, 193.08324183625353, 58.52860517584846, 94.06296082591834, 83.3299942178858, 121.05822094551165, 119.39724546766254, 155.77499596241566, 150.7877324514667, 74.90970918512431, 16.371942514039006, 168.95327071341714, 153.3202845175144, 159.31842743087492, 158.69875931831214, 170.46930915823685, 104.05351588108934, 146.7640937865483, 128.8780418057222, 179.97591209495937, 102.47931122900586, 174.22915158131403, 158.86994050238954, 170.28978392976933, 153.80392030089897, 169.1957898762684, 125.81263979327997, 163.47838959963582, 117.84697200847404, 150.80758836871345, 130.45896403253283, 176.64717247013937, 192.645469560735, 129.9991603453883, 167.96862243667445, 115.73448000637816, 73.15451693449097, 154.60247966999674, 196.3914462683875, 97.75175563088584, 88.39046320057741, 165.7046336602848, 103.8024350332336, 155.6472404131626, 179.62329861764988, 156.23448852354318, 144.4930046389867, 161.81389787888216, 184.1708209497262, 155.5494579848804, 171.82019567200655, 183.02620344970245, 176.09481447861788, 125.61644458847329, 162.4272048872225, 147.84830585557256, 199.01, 133.88651989646274, 168.80407854706664, 145.08468110418096, 178.74819282565903, 195.07807379585756, 153.0794016866608, 144.37763066087575, 187.03467629801827, 175.85466473878867, 163.79323395216562, 160.2990610964631, 116.20182296835891, 149.03852221812772, 139.44944381691172, 187.4030478172034, 146.2455900357043, 107.73762821443032, 86.34094588183018, 133.40808801978773, 173.06368883339917, 133.97217449788474, 132.45797698361574, 189.00193786069474, 200.0, 142.67743751305645, 158.30506997629925, 139.36587455495768, 161.18667655001167, 180.6262001053668, 140.58197354960276, 123.86514190073272, 158.31265036930358, 166.59467956763126, 180.82574463066413, 189.94564507659985, 142.13730067336434, 162.7048958059614, 152.71358208067994, 138.00521566712706, 179.7825623554529, 166.5916726409056, 169.33800743496903, 166.22891855380593, 152.04061142721423, 200.0, 170.13421530486715, 136.5794197499068, 165.93157033692628, 167.54000190382519, 184.94733545493995, 145.51672702749477, 142.30545429768114, 131.82358258280576, 173.75435658530324, 105.04880072490496, 172.7387168221568, 178.85067969628045, 164.83366705042704, 159.59924204090976, 166.19859533383922, 186.2660103922375, 146.48184740028904, 155.57785873711927, 116.06604323187088, 194.06079763265606, 128.19002967702045, 189.9739482465348, 150.24103309143572, 189.69626163314814, 162.6207763433327, 159.77094830088328, 97.98626068986673, 166.85884725231338, 130.0344554947042, 143.72113563391162, 183.19593768878408, 184.35704173988347, 157.0494650526552, 156.42809529598617, 173.0074544105339, 167.9134815924938, 137.83829296179948, 196.83874630516087, 179.03329338759715, 160.15640073879433, 153.71986584608544, 176.21925713244042, 140.75234697708134, 169.07002888669788, 154.4125593700433, 185.90494998952317, 160.17658317445876, 165.49144446186205, 183.5748570354291, 164.68951978244394, 179.05662065689168, 179.89091173402448, 153.5836244376205, 172.87988401056927, 171.51279658124645, 158.28457958162437, 163.78174329847255, 197.77093267455922, 162.97518774972124, 154.76548329888786, 150.9526988887422, 189.9041373329564, 177.1733020376928, 160.9023571785958, 135.7071605286663, 182.250414530569, 100.57011763740229, 181.64425360299504], "policy_predator_policy_reward": [27.817109720882755, 38.80945975739646, 80.17168669710864, 37.74358912399692, 5.214370819669885, 7.00304420585336, 34.94230286762015, 41.74345640714138, 32.890955222254846, 31.361949504553092, 44.58265030098849, 44.455629607072666, 36.310714846115665, 12.390939403414654, 16.29038192262648, 1.026366675202767, 19.958555971329822, 4.713047654835894, 23.489213741818716, 12.90494510526411, 18.546008478571554, 37.3538416741322, 127.25982801210688, 51.71370070095443, 2.3859939747297783, 0.6172110761431411, 15.492539074546096, 41.37270586649468, 49.8921351394901, 22.055924711692832, 0.7629304572013087, 4.146751567670073, 25.091321381362107, 28.692766726491236, 0.8906099880846661, 21.97449701729447, 16.628482194759233, 11.833210542912237, 3.9635835516578637, 43.70560391211422, 37.42572002968696, 29.18905221394798, 4.95980078328398, 18.713246208072754, 7.7762705305189215, 3.163708844033388, 10.552199482698734, 25.03091929370913, 11.671880535465878, 8.015090825094374, 20.058049400204652, 35.36815556640174, 6.966238529889868, 4.2785277597595925, 3.3022231973158496, 13.282554664897642, 17.5432834346663, 11.048850894230817, 7.837301984318609, 22.903086767333622, 15.200187277303092, 5.631340870205768, 6.318840346710427, 3.1398924029390924, 22.265519993621858, 1.2913775633255407, 17.18212608365196, 23.720850674069084, 4.491140249748618, 12.741607678262524, 59.94664217698645, 14.8922260470311, 25.960656625412593, 22.192426076591325, 3.903726858915835, 0.23265581294208942, 9.006280174192812, 14.778104493985985, 9.662780334315622, 6.396332237173148, 4.691143869078744, 1.975637065432963, 6.199545629304359, 4.579195303604527, 5.24256966820418, 3.284076799602737, 9.355772595575335, 0.6380183842271403, 4.893203514490665, 15.56748356770999, 1.363733378483396, 0.2096021532563201, 25.920598313339205, 5.912369339124235, 2.525256291652412, 3.6054026715406584, 8.05450253978924, 19.863202411581995, 45.65672223201912, 4.987303777928553, 8.51072394536021, 8.96619254884659, 12.257548606923079, 12.418600077854757, 31.169684996105982, 8.837024148362973, 10.635612518452408, 13.029863621429419, 0.34614767845274097, 1.8739374772368478, 5.869978046021277, 6.50473618168035, 13.13291687494496, 1.0426944251143824, 3.4270011234429543, 7.824595846921543, 12.248916430814157, 23.126844886160736, 5.218200319383793, 9.510605770172939, 3.8468667982125675, 0.44174349452345085, 4.064522670319051, 18.012313978023087, 1.4950508576989436, 0.9074755408422591, 0.5644851624646003, 2.4312798411769005, 1.4642384417927963, 20.427182822901568, 10.072751191345075, 9.408169046975097, 8.948181441936526, 0.8581835032894809, 7.227374382552526, 9.961568406837575, 14.740359038644131, 21.528133249187714, 4.26239565552626, 16.386463342671455, 15.286397577640498, 12.268125777697735, 4.229061733950936, 3.0499429589470686, 13.88986654131293, 7.311818321006071, 2.4615723180792073, 7.083821955844103, 9.341338942706743, 17.551486201939124, 2.603089621178906, 21.17395676812912, 3.1610774963706043, 14.874381177037183, 7.56801022634456, 18.356254295994827, 8.92801834410482, 2.6689719720411436, 13.512932027700993, 36.959070366647964, 9.17359556875034, 11.261759096566204, 4.828088193261032, 2.0919202554588052, 25.78047490019882, 7.55765834273234, 6.648548062060513, 7.074096399258319, 31.034806243671945, 6.7255735490553405, 3.895743367791192, 6.251706012442505, 8.143158637432835, 16.957530167735666, 7.996566050569867, 8.46519496009819, 5.376043085735329, 9.679387758210295, 25.05254048682761, 1.5194318768515855, 3.177898323684775, 7.360480217556035, 4.338784255594324, 10.51851628917019, 7.108112470609256, 17.553927219943397, 11.448681360224052, 4.782268791891394, 0.4031931424729487, 4.244130884495234, 14.9588160382459, 1.0175694166014007, 7.855407636795812, 4.797882884148772, 4.789129776165984, 3.6639070954499338, 3.399280505987828, 29.589693703188477, 53.82835291342271, 15.00023791247801]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.423210468342661, "mean_inference_ms": 6.335731314017988, "mean_action_processing_ms": 1.070688697558237, "mean_env_wait_ms": 0.837652752911762, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02385735511779785, "StateBufferConnector_ms": 0.021811485290527344, "ViewRequirementAgentConnector_ms": 0.40577781200408936}, "num_episodes": 23, "episode_return_max": 389.6172110761431, "episode_return_min": 140.8976672208556, "episode_return_mean": 320.3156268898634, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 656000, "num_agent_steps_trained": 656000, "num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 257.3600664264824, "num_env_steps_trained_throughput_per_sec": 257.3600664264824, "timesteps_total": 164000, "num_env_steps_sampled_lifetime": 164000, "num_agent_steps_sampled_lifetime": 656000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 656000, "timers": {"training_iteration_time_ms": 16170.916, "restore_workers_time_ms": 0.016, "training_step_time_ms": 16170.87, "sample_time_ms": 4170.841, "learn_time_ms": 11984.525, "learn_throughput": 333.764, "synch_weights_time_ms": 14.502}, "counters": {"num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_agent_steps_sampled": 656000, "num_agent_steps_trained": 656000}, "done": false, "training_iteration": 41, "trial_id": "d163c_00000", "date": "2024-08-16_13-02-36", "timestamp": 1723793556, "time_this_iter_s": 15.547034978866577, "time_total_s": 776.8704388141632, "pid": 81201, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16b80e550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 776.8704388141632, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 28.122727272727264, "ram_util_percent": 67.90454545454548}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.029324414048876, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.8084662056158459, "policy_loss": -0.006415680837916043, "vf_loss": 0.8137071605081911, "vf_explained_var": 0.318449221874671, "kl": 0.007831514844878582, "entropy": 1.125999487834002, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 78435.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.8919153363143326, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.441803124342016, "policy_loss": -0.0027332340138003465, "vf_loss": 9.442737950723638, "vf_explained_var": 0.03261359091158266, "kl": 0.008992124816665927, "entropy": 1.4041566528971232, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 78435.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 672000, "num_agent_steps_trained": 672000}, "env_runners": {"episode_reward_max": 375.3996021532563, "episode_reward_min": 251.93998547109095, "episode_reward_mean": 337.0815703358092, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 16.371942514039006, "predator_policy": 0.2096021532563201}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 59.94664217698645}, "policy_reward_mean": {"prey_policy": 157.77973764193456, "predator_policy": 10.761047525970016}, "custom_metrics": {}, "hist_stats": {"episode_reward": [303.63393416774966, 273.36662910036296, 251.93998547109095, 336.3117589397461, 340.1080478511013, 286.4007284440455, 328.5409252612419, 332.1346677769263, 340.4044907218084, 339.5844880393809, 317.88316372181293, 299.3949491288397, 327.9376646501811, 332.10336265577286, 307.26, 268.6599733622087, 311.375949827284, 328.9339650848798, 307.60275814840014, 339.99416981305103, 330.0912871860477, 355.7793915060953, 361.5131800562207, 312.49, 318.802157210602, 342.89031087626523, 334.3494467334482, 375.3996021532563, 329.28999999999996, 369.02, 352.01, 315.88437119643436, 344.3294081283219, 278.6593669349123, 259.7557430460868, 330.7013394711658, 323.67999999999995, 355.05215174075806, 311.84655583131627, 353.06447362574295, 299.8228767673104, 339.63613602649156, 375.06, 326.91903312766794, 293.1213241463482, 349.37, 357.45834725346936, 371.5215316655344, 316.52000000000004, 350.6605150301416, 366.7325547702665, 294.7778958786846, 306.35768066554647, 358.86840121133514, 345.6345939536558, 362.01, 328.9525312820542, 333.903887253835, 336.19943659696304, 365.8615592469232, 333.9887149603619, 315.317110336529, 294.1909457939323, 374.47298787738737, 346.8156935915725, 354.64358046434654, 372.43741905968767, 349.33714350662524, 355.0398117836943, 326.2841368744473, 355.37294020351214, 352.24, 358.8027553591139, 373.8048329356808, 351.12554813874243, 346.02832631498626, 366.20000000000005, 333.71705650345643, 353.51012674264314, 346.52869608790456, 350.94654926841156, 351.04296206629806, 360.0321488923351, 323.828021266889, 365.78414144752253, 375.3030983830761, 361.4892885524055, 372.2400837790909, 356.9729966610302, 352.1998039177014, 357.0980590807065, 374.89519816528775, 323.18068201874115, 344.2414765609038, 324.00501604001784, 371.19162263377973, 332.1407340710363, 363.35743813965036, 344.38083673880084, 336.4003466238257], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [119.39724546766254, 155.77499596241566, 150.7877324514667, 74.90970918512431, 16.371942514039006, 168.95327071341714, 153.3202845175144, 159.31842743087492, 158.69875931831214, 170.46930915823685, 104.05351588108934, 146.7640937865483, 128.8780418057222, 179.97591209495937, 102.47931122900586, 174.22915158131403, 158.86994050238954, 170.28978392976933, 153.80392030089897, 169.1957898762684, 125.81263979327997, 163.47838959963582, 117.84697200847404, 150.80758836871345, 130.45896403253283, 176.64717247013937, 192.645469560735, 129.9991603453883, 167.96862243667445, 115.73448000637816, 73.15451693449097, 154.60247966999674, 196.3914462683875, 97.75175563088584, 88.39046320057741, 165.7046336602848, 103.8024350332336, 155.6472404131626, 179.62329861764988, 156.23448852354318, 144.4930046389867, 161.81389787888216, 184.1708209497262, 155.5494579848804, 171.82019567200655, 183.02620344970245, 176.09481447861788, 125.61644458847329, 162.4272048872225, 147.84830585557256, 199.01, 133.88651989646274, 168.80407854706664, 145.08468110418096, 178.74819282565903, 195.07807379585756, 153.0794016866608, 144.37763066087575, 187.03467629801827, 175.85466473878867, 163.79323395216562, 160.2990610964631, 116.20182296835891, 149.03852221812772, 139.44944381691172, 187.4030478172034, 146.2455900357043, 107.73762821443032, 86.34094588183018, 133.40808801978773, 173.06368883339917, 133.97217449788474, 132.45797698361574, 189.00193786069474, 200.0, 142.67743751305645, 158.30506997629925, 139.36587455495768, 161.18667655001167, 180.6262001053668, 140.58197354960276, 123.86514190073272, 158.31265036930358, 166.59467956763126, 180.82574463066413, 189.94564507659985, 142.13730067336434, 162.7048958059614, 152.71358208067994, 138.00521566712706, 179.7825623554529, 166.5916726409056, 169.33800743496903, 166.22891855380593, 152.04061142721423, 200.0, 170.13421530486715, 136.5794197499068, 165.93157033692628, 167.54000190382519, 184.94733545493995, 145.51672702749477, 142.30545429768114, 131.82358258280576, 173.75435658530324, 105.04880072490496, 172.7387168221568, 178.85067969628045, 164.83366705042704, 159.59924204090976, 166.19859533383922, 186.2660103922375, 146.48184740028904, 155.57785873711927, 116.06604323187088, 194.06079763265606, 128.19002967702045, 189.9739482465348, 150.24103309143572, 189.69626163314814, 162.6207763433327, 159.77094830088328, 97.98626068986673, 166.85884725231338, 130.0344554947042, 143.72113563391162, 183.19593768878408, 184.35704173988347, 157.0494650526552, 156.42809529598617, 173.0074544105339, 167.9134815924938, 137.83829296179948, 196.83874630516087, 179.03329338759715, 160.15640073879433, 153.71986584608544, 176.21925713244042, 140.75234697708134, 169.07002888669788, 154.4125593700433, 185.90494998952317, 160.17658317445876, 165.49144446186205, 183.5748570354291, 164.68951978244394, 179.05662065689168, 179.89091173402448, 153.5836244376205, 172.87988401056927, 171.51279658124645, 158.28457958162437, 163.78174329847255, 197.77093267455922, 162.97518774972124, 154.76548329888786, 150.9526988887422, 189.9041373329564, 177.1733020376928, 160.9023571785958, 135.7071605286663, 182.250414530569, 100.57011763740229, 181.64425360299504, 162.5629168668924, 186.63311231812705, 100.21953030428224, 171.28232685688337, 172.45789183399563, 179.6892903934498, 171.5017269517744, 191.52116764862302, 188.8691883229336, 157.8003808440594, 178.56587302915483, 185.08168086872558, 170.64206910449877, 174.56894817720638, 163.60222842679713, 180.84813789699786, 178.3824212112478, 160.15113737687585, 192.511091596287, 171.41511080822727, 160.34202704144445, 143.4146072399663, 171.83564809921705, 158.94347584496026, 137.62808585635904, 144.32147262912417, 184.57838744238154, 179.29140446822174, 157.910395264015, 151.88283755823235, 170.7896917942864, 179.15765080785033, 152.64968015118342, 157.05911055974875, 168.21760391150426, 149.5301257716809], "policy_predator_policy_reward": [16.628482194759233, 11.833210542912237, 3.9635835516578637, 43.70560391211422, 37.42572002968696, 29.18905221394798, 4.95980078328398, 18.713246208072754, 7.7762705305189215, 3.163708844033388, 10.552199482698734, 25.03091929370913, 11.671880535465878, 8.015090825094374, 20.058049400204652, 35.36815556640174, 6.966238529889868, 4.2785277597595925, 3.3022231973158496, 13.282554664897642, 17.5432834346663, 11.048850894230817, 7.837301984318609, 22.903086767333622, 15.200187277303092, 5.631340870205768, 6.318840346710427, 3.1398924029390924, 22.265519993621858, 1.2913775633255407, 17.18212608365196, 23.720850674069084, 4.491140249748618, 12.741607678262524, 59.94664217698645, 14.8922260470311, 25.960656625412593, 22.192426076591325, 3.903726858915835, 0.23265581294208942, 9.006280174192812, 14.778104493985985, 9.662780334315622, 6.396332237173148, 4.691143869078744, 1.975637065432963, 6.199545629304359, 4.579195303604527, 5.24256966820418, 3.284076799602737, 9.355772595575335, 0.6380183842271403, 4.893203514490665, 15.56748356770999, 1.363733378483396, 0.2096021532563201, 25.920598313339205, 5.912369339124235, 2.525256291652412, 3.6054026715406584, 8.05450253978924, 19.863202411581995, 45.65672223201912, 4.987303777928553, 8.51072394536021, 8.96619254884659, 12.257548606923079, 12.418600077854757, 31.169684996105982, 8.837024148362973, 10.635612518452408, 13.029863621429419, 0.34614767845274097, 1.8739374772368478, 5.869978046021277, 6.50473618168035, 13.13291687494496, 1.0426944251143824, 3.4270011234429543, 7.824595846921543, 12.248916430814157, 23.126844886160736, 5.218200319383793, 9.510605770172939, 3.8468667982125675, 0.44174349452345085, 4.064522670319051, 18.012313978023087, 1.4950508576989436, 0.9074755408422591, 0.5644851624646003, 2.4312798411769005, 1.4642384417927963, 20.427182822901568, 10.072751191345075, 9.408169046975097, 8.948181441936526, 0.8581835032894809, 7.227374382552526, 9.961568406837575, 14.740359038644131, 21.528133249187714, 4.26239565552626, 16.386463342671455, 15.286397577640498, 12.268125777697735, 4.229061733950936, 3.0499429589470686, 13.88986654131293, 7.311818321006071, 2.4615723180792073, 7.083821955844103, 9.341338942706743, 17.551486201939124, 2.603089621178906, 21.17395676812912, 3.1610774963706043, 14.874381177037183, 7.56801022634456, 18.356254295994827, 8.92801834410482, 2.6689719720411436, 13.512932027700993, 36.959070366647964, 9.17359556875034, 11.261759096566204, 4.828088193261032, 2.0919202554588052, 25.78047490019882, 7.55765834273234, 6.648548062060513, 7.074096399258319, 31.034806243671945, 6.7255735490553405, 3.895743367791192, 6.251706012442505, 8.143158637432835, 16.957530167735666, 7.996566050569867, 8.46519496009819, 5.376043085735329, 9.679387758210295, 25.05254048682761, 1.5194318768515855, 3.177898323684775, 7.360480217556035, 4.338784255594324, 10.51851628917019, 7.108112470609256, 17.553927219943397, 11.448681360224052, 4.782268791891394, 0.4031931424729487, 4.244130884495234, 14.9588160382459, 1.0175694166014007, 7.855407636795812, 4.797882884148772, 4.789129776165984, 3.6639070954499338, 3.399280505987828, 29.589693703188477, 53.82835291342271, 15.00023791247801, 6.58256772618325, 4.253551981132483, 43.929530339563904, 8.396633766159475, 6.927943548846577, 6.709015671230549, 5.298917103826103, 6.981286678852584, 10.609873035512178, 4.209846349900371, 4.242752004214706, 4.349777876995827, 5.564075234081378, 6.197904145243642, 1.566408493492857, 6.183029100413575, 7.394344821821877, 11.170155670760979, 4.103580879606072, 6.865414881167402, 10.480405817137834, 8.943641920192613, 6.69977659770202, 6.762576019024551, 28.931915458901234, 13.123542095633425, 2.923255924394045, 4.398574798782412, 8.11070304696477, 14.236798201824241, 2.027997239708058, 11.38209829780556, 27.316462543940634, 7.355583483928057, 9.176682378442534, 9.475934562197999]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.413440809598072, "mean_inference_ms": 6.3074668643973135, "mean_action_processing_ms": 1.0665156057785763, "mean_env_wait_ms": 0.8334647183398123, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025470495223999023, "StateBufferConnector_ms": 0.021317243576049805, "ViewRequirementAgentConnector_ms": 0.4281339645385742}, "num_episodes": 18, "episode_return_max": 375.3996021532563, "episode_return_min": 251.93998547109095, "episode_return_mean": 337.0815703358092, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 672000, "num_agent_steps_trained": 672000, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 254.1347449695162, "num_env_steps_trained_throughput_per_sec": 254.1347449695162, "timesteps_total": 168000, "num_env_steps_sampled_lifetime": 168000, "num_agent_steps_sampled_lifetime": 672000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 672000, "timers": {"training_iteration_time_ms": 15985.302, "restore_workers_time_ms": 0.016, "training_step_time_ms": 15985.257, "sample_time_ms": 4167.924, "learn_time_ms": 11801.857, "learn_throughput": 338.93, "synch_weights_time_ms": 14.474}, "counters": {"num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 672000, "num_agent_steps_trained": 672000}, "done": false, "training_iteration": 42, "trial_id": "d163c_00000", "date": "2024-08-16_13-02-52", "timestamp": 1723793572, "time_this_iter_s": 15.74414587020874, "time_total_s": 792.614584684372, "pid": 81201, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16b80e820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 792.614584684372, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 28.552173913043475, "ram_util_percent": 68.08695652173913}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.8682150162401654, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.8954477538192083, "policy_loss": -0.01087786218153914, "vf_loss": 0.9043979253560778, "vf_explained_var": 0.4249752289403683, "kl": 0.012851286869728066, "entropy": 1.0864693207715554, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 80325.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.003002889399175, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.31467544212543, "policy_loss": -0.0016551397745768544, "vf_loss": 9.313626585561762, "vf_explained_var": -0.0026514129033164374, "kl": 0.01351993292753436, "entropy": 1.4353250928026027, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 80325.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_agent_steps_sampled": 688000, "num_agent_steps_trained": 688000}, "env_runners": {"episode_reward_max": 381.50491199055796, "episode_reward_min": 259.7557430460868, "episode_reward_mean": 341.9916994640872, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 86.34094588183018, "predator_policy": 0.2096021532563201}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 53.82835291342271}, "policy_reward_mean": {"prey_policy": 160.94275658550544, "predator_policy": 10.053093146538169}, "custom_metrics": {}, "hist_stats": {"episode_reward": [307.60275814840014, 339.99416981305103, 330.0912871860477, 355.7793915060953, 361.5131800562207, 312.49, 318.802157210602, 342.89031087626523, 334.3494467334482, 375.3996021532563, 329.28999999999996, 369.02, 352.01, 315.88437119643436, 344.3294081283219, 278.6593669349123, 259.7557430460868, 330.7013394711658, 323.67999999999995, 355.05215174075806, 311.84655583131627, 353.06447362574295, 299.8228767673104, 339.63613602649156, 375.06, 326.91903312766794, 293.1213241463482, 349.37, 357.45834725346936, 371.5215316655344, 316.52000000000004, 350.6605150301416, 366.7325547702665, 294.7778958786846, 306.35768066554647, 358.86840121133514, 345.6345939536558, 362.01, 328.9525312820542, 333.903887253835, 336.19943659696304, 365.8615592469232, 333.9887149603619, 315.317110336529, 294.1909457939323, 374.47298787738737, 346.8156935915725, 354.64358046434654, 372.43741905968767, 349.33714350662524, 355.0398117836943, 326.2841368744473, 355.37294020351214, 352.24, 358.8027553591139, 373.8048329356808, 351.12554813874243, 346.02832631498626, 366.20000000000005, 333.71705650345643, 353.51012674264314, 346.52869608790456, 350.94654926841156, 351.04296206629806, 360.0321488923351, 323.828021266889, 365.78414144752253, 375.3030983830761, 361.4892885524055, 372.2400837790909, 356.9729966610302, 352.1998039177014, 357.0980590807065, 374.89519816528775, 323.18068201874115, 344.2414765609038, 324.00501604001784, 371.19162263377973, 332.1407340710363, 363.35743813965036, 344.38083673880084, 336.4003466238257, 310.70908867732476, 352.37880149407107, 339.53761743482005, 327.5386798769871, 333.15, 356.3458553423692, 353.75221084062304, 336.84329352118345, 362.9133222254793, 375.01689081879533, 318.8532436234418, 342.66287099775985, 329.1100118692361, 328.87157649577165, 317.6530368612672, 282.2168033563736, 381.50491199055796, 367.9293816061799], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [103.8024350332336, 155.6472404131626, 179.62329861764988, 156.23448852354318, 144.4930046389867, 161.81389787888216, 184.1708209497262, 155.5494579848804, 171.82019567200655, 183.02620344970245, 176.09481447861788, 125.61644458847329, 162.4272048872225, 147.84830585557256, 199.01, 133.88651989646274, 168.80407854706664, 145.08468110418096, 178.74819282565903, 195.07807379585756, 153.0794016866608, 144.37763066087575, 187.03467629801827, 175.85466473878867, 163.79323395216562, 160.2990610964631, 116.20182296835891, 149.03852221812772, 139.44944381691172, 187.4030478172034, 146.2455900357043, 107.73762821443032, 86.34094588183018, 133.40808801978773, 173.06368883339917, 133.97217449788474, 132.45797698361574, 189.00193786069474, 200.0, 142.67743751305645, 158.30506997629925, 139.36587455495768, 161.18667655001167, 180.6262001053668, 140.58197354960276, 123.86514190073272, 158.31265036930358, 166.59467956763126, 180.82574463066413, 189.94564507659985, 142.13730067336434, 162.7048958059614, 152.71358208067994, 138.00521566712706, 179.7825623554529, 166.5916726409056, 169.33800743496903, 166.22891855380593, 152.04061142721423, 200.0, 170.13421530486715, 136.5794197499068, 165.93157033692628, 167.54000190382519, 184.94733545493995, 145.51672702749477, 142.30545429768114, 131.82358258280576, 173.75435658530324, 105.04880072490496, 172.7387168221568, 178.85067969628045, 164.83366705042704, 159.59924204090976, 166.19859533383922, 186.2660103922375, 146.48184740028904, 155.57785873711927, 116.06604323187088, 194.06079763265606, 128.19002967702045, 189.9739482465348, 150.24103309143572, 189.69626163314814, 162.6207763433327, 159.77094830088328, 97.98626068986673, 166.85884725231338, 130.0344554947042, 143.72113563391162, 183.19593768878408, 184.35704173988347, 157.0494650526552, 156.42809529598617, 173.0074544105339, 167.9134815924938, 137.83829296179948, 196.83874630516087, 179.03329338759715, 160.15640073879433, 153.71986584608544, 176.21925713244042, 140.75234697708134, 169.07002888669788, 154.4125593700433, 185.90494998952317, 160.17658317445876, 165.49144446186205, 183.5748570354291, 164.68951978244394, 179.05662065689168, 179.89091173402448, 153.5836244376205, 172.87988401056927, 171.51279658124645, 158.28457958162437, 163.78174329847255, 197.77093267455922, 162.97518774972124, 154.76548329888786, 150.9526988887422, 189.9041373329564, 177.1733020376928, 160.9023571785958, 135.7071605286663, 182.250414530569, 100.57011763740229, 181.64425360299504, 162.5629168668924, 186.63311231812705, 100.21953030428224, 171.28232685688337, 172.45789183399563, 179.6892903934498, 171.5017269517744, 191.52116764862302, 188.8691883229336, 157.8003808440594, 178.56587302915483, 185.08168086872558, 170.64206910449877, 174.56894817720638, 163.60222842679713, 180.84813789699786, 178.3824212112478, 160.15113737687585, 192.511091596287, 171.41511080822727, 160.34202704144445, 143.4146072399663, 171.83564809921705, 158.94347584496026, 137.62808585635904, 144.32147262912417, 184.57838744238154, 179.29140446822174, 157.910395264015, 151.88283755823235, 170.7896917942864, 179.15765080785033, 152.64968015118342, 157.05911055974875, 168.21760391150426, 149.5301257716809, 145.8861137180216, 152.85448316955112, 111.07925235710238, 200.0, 174.37115790616522, 150.9849511098135, 155.29249675960847, 133.15298110971176, 148.64962933389205, 157.99135355454123, 160.94879210978917, 179.86693850232876, 177.99492213810976, 151.24119828912802, 148.8794957558608, 170.79320327550096, 155.6926507806382, 192.68920200785837, 179.28631472048053, 189.60706804051676, 149.92277643588906, 153.79146258634273, 171.48610441660094, 156.62635490728312, 145.78278945878026, 163.54713647668305, 143.9388749549145, 164.15486208072653, 162.7166816421813, 89.04472326590881, 129.49086195843915, 113.58564660913088, 186.6079645087653, 188.69403507292253, 153.2139977311584, 186.67320366343594], "policy_predator_policy_reward": [25.960656625412593, 22.192426076591325, 3.903726858915835, 0.23265581294208942, 9.006280174192812, 14.778104493985985, 9.662780334315622, 6.396332237173148, 4.691143869078744, 1.975637065432963, 6.199545629304359, 4.579195303604527, 5.24256966820418, 3.284076799602737, 9.355772595575335, 0.6380183842271403, 4.893203514490665, 15.56748356770999, 1.363733378483396, 0.2096021532563201, 25.920598313339205, 5.912369339124235, 2.525256291652412, 3.6054026715406584, 8.05450253978924, 19.863202411581995, 45.65672223201912, 4.987303777928553, 8.51072394536021, 8.96619254884659, 12.257548606923079, 12.418600077854757, 31.169684996105982, 8.837024148362973, 10.635612518452408, 13.029863621429419, 0.34614767845274097, 1.8739374772368478, 5.869978046021277, 6.50473618168035, 13.13291687494496, 1.0426944251143824, 3.4270011234429543, 7.824595846921543, 12.248916430814157, 23.126844886160736, 5.218200319383793, 9.510605770172939, 3.8468667982125675, 0.44174349452345085, 4.064522670319051, 18.012313978023087, 1.4950508576989436, 0.9074755408422591, 0.5644851624646003, 2.4312798411769005, 1.4642384417927963, 20.427182822901568, 10.072751191345075, 9.408169046975097, 8.948181441936526, 0.8581835032894809, 7.227374382552526, 9.961568406837575, 14.740359038644131, 21.528133249187714, 4.26239565552626, 16.386463342671455, 15.286397577640498, 12.268125777697735, 4.229061733950936, 3.0499429589470686, 13.88986654131293, 7.311818321006071, 2.4615723180792073, 7.083821955844103, 9.341338942706743, 17.551486201939124, 2.603089621178906, 21.17395676812912, 3.1610774963706043, 14.874381177037183, 7.56801022634456, 18.356254295994827, 8.92801834410482, 2.6689719720411436, 13.512932027700993, 36.959070366647964, 9.17359556875034, 11.261759096566204, 4.828088193261032, 2.0919202554588052, 25.78047490019882, 7.55765834273234, 6.648548062060513, 7.074096399258319, 31.034806243671945, 6.7255735490553405, 3.895743367791192, 6.251706012442505, 8.143158637432835, 16.957530167735666, 7.996566050569867, 8.46519496009819, 5.376043085735329, 9.679387758210295, 25.05254048682761, 1.5194318768515855, 3.177898323684775, 7.360480217556035, 4.338784255594324, 10.51851628917019, 7.108112470609256, 17.553927219943397, 11.448681360224052, 4.782268791891394, 0.4031931424729487, 4.244130884495234, 14.9588160382459, 1.0175694166014007, 7.855407636795812, 4.797882884148772, 4.789129776165984, 3.6639070954499338, 3.399280505987828, 29.589693703188477, 53.82835291342271, 15.00023791247801, 6.58256772618325, 4.253551981132483, 43.929530339563904, 8.396633766159475, 6.927943548846577, 6.709015671230549, 5.298917103826103, 6.981286678852584, 10.609873035512178, 4.209846349900371, 4.242752004214706, 4.349777876995827, 5.564075234081378, 6.197904145243642, 1.566408493492857, 6.183029100413575, 7.394344821821877, 11.170155670760979, 4.103580879606072, 6.865414881167402, 10.480405817137834, 8.943641920192613, 6.69977659770202, 6.762576019024551, 28.931915458901234, 13.123542095633425, 2.923255924394045, 4.398574798782412, 8.11070304696477, 14.236798201824241, 2.027997239708058, 11.38209829780556, 27.316462543940634, 7.355583483928057, 9.176682378442534, 9.475934562197999, 4.239924501204063, 7.728567288548028, 15.864785242284494, 25.434763894684398, 10.992037982876694, 3.1894704359646178, 20.793628768252315, 18.299573239414574, 8.500370666107964, 18.00864644545876, 8.293000165399985, 7.237124564851248, 13.331634268234751, 11.18445614515053, 7.4169083722209646, 9.753686117600713, 8.785867355705307, 5.745602081277349, 3.495749174365786, 2.627758883432227, 6.604590464650392, 8.534414136559581, 2.9294358544468277, 11.62097581942892, 12.780778661455539, 6.999307272317255, 18.25259001844597, 2.525249441684632, 43.1308279799878, 22.760803973189294, 16.070789955561544, 23.069504833241986, 3.380749378618461, 2.8221630302517116, 24.477047520255013, 3.5651326913305317]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.406234325569022, "mean_inference_ms": 6.2817933672327255, "mean_action_processing_ms": 1.0618747605447316, "mean_env_wait_ms": 0.8292892967645735, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02821063995361328, "StateBufferConnector_ms": 0.018819451332092285, "ViewRequirementAgentConnector_ms": 0.4566636085510254}, "num_episodes": 18, "episode_return_max": 381.50491199055796, "episode_return_min": 259.7557430460868, "episode_return_mean": 341.9916994640872, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 688000, "num_agent_steps_trained": 688000, "num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 263.645237175043, "num_env_steps_trained_throughput_per_sec": 263.645237175043, "timesteps_total": 172000, "num_env_steps_sampled_lifetime": 172000, "num_agent_steps_sampled_lifetime": 688000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 688000, "timers": {"training_iteration_time_ms": 15692.514, "restore_workers_time_ms": 0.016, "training_step_time_ms": 15692.467, "sample_time_ms": 4157.163, "learn_time_ms": 11520.306, "learn_throughput": 347.213, "synch_weights_time_ms": 14.003}, "counters": {"num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_agent_steps_sampled": 688000, "num_agent_steps_trained": 688000}, "done": false, "training_iteration": 43, "trial_id": "d163c_00000", "date": "2024-08-16_13-03-07", "timestamp": 1723793587, "time_this_iter_s": 15.175626039505005, "time_total_s": 807.790210723877, "pid": 81201, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16b87cd30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 807.790210723877, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 27.976190476190474, "ram_util_percent": 68.37142857142857}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.8545114391064517, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.9883595314921525, "policy_loss": -0.008925486061470731, "vf_loss": 0.9957270221104697, "vf_explained_var": 0.33906588330470694, "kl": 0.010386637292254607, "entropy": 1.0847172763612536, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 82215.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.9984085439058838, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.218109886734574, "policy_loss": -0.004289633251490101, "vf_loss": 9.220318369386057, "vf_explained_var": -0.008908069386053338, "kl": 0.010405712946646252, "entropy": 1.3993483144139487, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 82215.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_agent_steps_sampled": 704000, "num_agent_steps_trained": 704000}, "env_runners": {"episode_reward_max": 381.50491199055796, "episode_reward_min": 282.2168033563736, "episode_reward_mean": 343.15290585366614, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 89.04472326590881, "predator_policy": 0.1729667415299886}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 53.82835291342271}, "policy_reward_mean": {"prey_policy": 161.9081267023989, "predator_policy": 9.668326224434162}, "custom_metrics": {}, "hist_stats": {"episode_reward": [323.67999999999995, 355.05215174075806, 311.84655583131627, 353.06447362574295, 299.8228767673104, 339.63613602649156, 375.06, 326.91903312766794, 293.1213241463482, 349.37, 357.45834725346936, 371.5215316655344, 316.52000000000004, 350.6605150301416, 366.7325547702665, 294.7778958786846, 306.35768066554647, 358.86840121133514, 345.6345939536558, 362.01, 328.9525312820542, 333.903887253835, 336.19943659696304, 365.8615592469232, 333.9887149603619, 315.317110336529, 294.1909457939323, 374.47298787738737, 346.8156935915725, 354.64358046434654, 372.43741905968767, 349.33714350662524, 355.0398117836943, 326.2841368744473, 355.37294020351214, 352.24, 358.8027553591139, 373.8048329356808, 351.12554813874243, 346.02832631498626, 366.20000000000005, 333.71705650345643, 353.51012674264314, 346.52869608790456, 350.94654926841156, 351.04296206629806, 360.0321488923351, 323.828021266889, 365.78414144752253, 375.3030983830761, 361.4892885524055, 372.2400837790909, 356.9729966610302, 352.1998039177014, 357.0980590807065, 374.89519816528775, 323.18068201874115, 344.2414765609038, 324.00501604001784, 371.19162263377973, 332.1407340710363, 363.35743813965036, 344.38083673880084, 336.4003466238257, 310.70908867732476, 352.37880149407107, 339.53761743482005, 327.5386798769871, 333.15, 356.3458553423692, 353.75221084062304, 336.84329352118345, 362.9133222254793, 375.01689081879533, 318.8532436234418, 342.66287099775985, 329.1100118692361, 328.87157649577165, 317.6530368612672, 282.2168033563736, 381.50491199055796, 367.9293816061799, 346.9281300788827, 343.13311262344916, 338.4898715950869, 362.70944544621983, 347.52588845048984, 290.7199999999998, 325.3898767802483, 314.55187651724003, 328.9822394793101, 333.23659392752967, 357.43994754094905, 348.9310166381207, 333.47498812649405, 373.21, 351.68636050034155, 341.76577804746023, 342.05595938356305, 294.4520862828073], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [132.45797698361574, 189.00193786069474, 200.0, 142.67743751305645, 158.30506997629925, 139.36587455495768, 161.18667655001167, 180.6262001053668, 140.58197354960276, 123.86514190073272, 158.31265036930358, 166.59467956763126, 180.82574463066413, 189.94564507659985, 142.13730067336434, 162.7048958059614, 152.71358208067994, 138.00521566712706, 179.7825623554529, 166.5916726409056, 169.33800743496903, 166.22891855380593, 152.04061142721423, 200.0, 170.13421530486715, 136.5794197499068, 165.93157033692628, 167.54000190382519, 184.94733545493995, 145.51672702749477, 142.30545429768114, 131.82358258280576, 173.75435658530324, 105.04880072490496, 172.7387168221568, 178.85067969628045, 164.83366705042704, 159.59924204090976, 166.19859533383922, 186.2660103922375, 146.48184740028904, 155.57785873711927, 116.06604323187088, 194.06079763265606, 128.19002967702045, 189.9739482465348, 150.24103309143572, 189.69626163314814, 162.6207763433327, 159.77094830088328, 97.98626068986673, 166.85884725231338, 130.0344554947042, 143.72113563391162, 183.19593768878408, 184.35704173988347, 157.0494650526552, 156.42809529598617, 173.0074544105339, 167.9134815924938, 137.83829296179948, 196.83874630516087, 179.03329338759715, 160.15640073879433, 153.71986584608544, 176.21925713244042, 140.75234697708134, 169.07002888669788, 154.4125593700433, 185.90494998952317, 160.17658317445876, 165.49144446186205, 183.5748570354291, 164.68951978244394, 179.05662065689168, 179.89091173402448, 153.5836244376205, 172.87988401056927, 171.51279658124645, 158.28457958162437, 163.78174329847255, 197.77093267455922, 162.97518774972124, 154.76548329888786, 150.9526988887422, 189.9041373329564, 177.1733020376928, 160.9023571785958, 135.7071605286663, 182.250414530569, 100.57011763740229, 181.64425360299504, 162.5629168668924, 186.63311231812705, 100.21953030428224, 171.28232685688337, 172.45789183399563, 179.6892903934498, 171.5017269517744, 191.52116764862302, 188.8691883229336, 157.8003808440594, 178.56587302915483, 185.08168086872558, 170.64206910449877, 174.56894817720638, 163.60222842679713, 180.84813789699786, 178.3824212112478, 160.15113737687585, 192.511091596287, 171.41511080822727, 160.34202704144445, 143.4146072399663, 171.83564809921705, 158.94347584496026, 137.62808585635904, 144.32147262912417, 184.57838744238154, 179.29140446822174, 157.910395264015, 151.88283755823235, 170.7896917942864, 179.15765080785033, 152.64968015118342, 157.05911055974875, 168.21760391150426, 149.5301257716809, 145.8861137180216, 152.85448316955112, 111.07925235710238, 200.0, 174.37115790616522, 150.9849511098135, 155.29249675960847, 133.15298110971176, 148.64962933389205, 157.99135355454123, 160.94879210978917, 179.86693850232876, 177.99492213810976, 151.24119828912802, 148.8794957558608, 170.79320327550096, 155.6926507806382, 192.68920200785837, 179.28631472048053, 189.60706804051676, 149.92277643588906, 153.79146258634273, 171.48610441660094, 156.62635490728312, 145.78278945878026, 163.54713647668305, 143.9388749549145, 164.15486208072653, 162.7166816421813, 89.04472326590881, 129.49086195843915, 113.58564660913088, 186.6079645087653, 188.69403507292253, 153.2139977311584, 186.67320366343594, 170.06430965325487, 164.06949347692537, 179.6704934022663, 135.66425957975449, 175.46210604371288, 144.967322823254, 179.50693364611482, 177.23279273032438, 175.3008650151047, 157.90072722851582, 100.95021769315703, 177.2114458459542, 177.14030640604605, 123.83664632988322, 142.73107646595702, 154.9732219474461, 195.4170051487038, 131.92401173689328, 126.4573774416467, 179.19404055736436, 155.69590323740823, 184.92248144479237, 179.53901640484594, 151.38935989528923, 161.62540409610827, 156.576269860289, 192.8806576185911, 179.20999999999998, 166.42599287308727, 174.51672136530624, 175.0186987671441, 157.84959628152143, 161.30240244311716, 159.40859935873382, 153.57999177747047, 99.53725466019907], "policy_predator_policy_reward": [0.34614767845274097, 1.8739374772368478, 5.869978046021277, 6.50473618168035, 13.13291687494496, 1.0426944251143824, 3.4270011234429543, 7.824595846921543, 12.248916430814157, 23.126844886160736, 5.218200319383793, 9.510605770172939, 3.8468667982125675, 0.44174349452345085, 4.064522670319051, 18.012313978023087, 1.4950508576989436, 0.9074755408422591, 0.5644851624646003, 2.4312798411769005, 1.4642384417927963, 20.427182822901568, 10.072751191345075, 9.408169046975097, 8.948181441936526, 0.8581835032894809, 7.227374382552526, 9.961568406837575, 14.740359038644131, 21.528133249187714, 4.26239565552626, 16.386463342671455, 15.286397577640498, 12.268125777697735, 4.229061733950936, 3.0499429589470686, 13.88986654131293, 7.311818321006071, 2.4615723180792073, 7.083821955844103, 9.341338942706743, 17.551486201939124, 2.603089621178906, 21.17395676812912, 3.1610774963706043, 14.874381177037183, 7.56801022634456, 18.356254295994827, 8.92801834410482, 2.6689719720411436, 13.512932027700993, 36.959070366647964, 9.17359556875034, 11.261759096566204, 4.828088193261032, 2.0919202554588052, 25.78047490019882, 7.55765834273234, 6.648548062060513, 7.074096399258319, 31.034806243671945, 6.7255735490553405, 3.895743367791192, 6.251706012442505, 8.143158637432835, 16.957530167735666, 7.996566050569867, 8.46519496009819, 5.376043085735329, 9.679387758210295, 25.05254048682761, 1.5194318768515855, 3.177898323684775, 7.360480217556035, 4.338784255594324, 10.51851628917019, 7.108112470609256, 17.553927219943397, 11.448681360224052, 4.782268791891394, 0.4031931424729487, 4.244130884495234, 14.9588160382459, 1.0175694166014007, 7.855407636795812, 4.797882884148772, 4.789129776165984, 3.6639070954499338, 3.399280505987828, 29.589693703188477, 53.82835291342271, 15.00023791247801, 6.58256772618325, 4.253551981132483, 43.929530339563904, 8.396633766159475, 6.927943548846577, 6.709015671230549, 5.298917103826103, 6.981286678852584, 10.609873035512178, 4.209846349900371, 4.242752004214706, 4.349777876995827, 5.564075234081378, 6.197904145243642, 1.566408493492857, 6.183029100413575, 7.394344821821877, 11.170155670760979, 4.103580879606072, 6.865414881167402, 10.480405817137834, 8.943641920192613, 6.69977659770202, 6.762576019024551, 28.931915458901234, 13.123542095633425, 2.923255924394045, 4.398574798782412, 8.11070304696477, 14.236798201824241, 2.027997239708058, 11.38209829780556, 27.316462543940634, 7.355583483928057, 9.176682378442534, 9.475934562197999, 4.239924501204063, 7.728567288548028, 15.864785242284494, 25.434763894684398, 10.992037982876694, 3.1894704359646178, 20.793628768252315, 18.299573239414574, 8.500370666107964, 18.00864644545876, 8.293000165399985, 7.237124564851248, 13.331634268234751, 11.18445614515053, 7.4169083722209646, 9.753686117600713, 8.785867355705307, 5.745602081277349, 3.495749174365786, 2.627758883432227, 6.604590464650392, 8.534414136559581, 2.9294358544468277, 11.62097581942892, 12.780778661455539, 6.999307272317255, 18.25259001844597, 2.525249441684632, 43.1308279799878, 22.760803973189294, 16.070789955561544, 23.069504833241986, 3.380749378618461, 2.8221630302517116, 24.477047520255013, 3.5651326913305317, 6.353234344711361, 6.44109260399113, 12.116313595673091, 15.682046045755277, 12.891779703152027, 5.16866302496801, 0.7127085948341194, 5.257010474946525, 7.972034222273312, 6.3522619845959385, 3.4042481227434576, 9.154088338145181, 14.115787376163318, 10.297136668155703, 4.901493434240326, 11.946084669596575, 0.7159882631067274, 0.9252343306063192, 15.049498286307408, 12.535677642211175, 7.315100515505974, 9.506462343242474, 5.084256969413037, 12.918383368572457, 7.395198343953987, 7.878115826142808, 0.9463756398789175, 0.1729667415299886, 6.592386744594551, 4.151259517353477, 4.376730691182959, 4.520752307611765, 13.719328954346802, 7.625628627365222, 16.397910717893996, 24.93692912724373]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.3993231530303536, "mean_inference_ms": 6.258556724189, "mean_action_processing_ms": 1.0577745952357651, "mean_env_wait_ms": 0.8255551610186083, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027322769165039062, "StateBufferConnector_ms": 0.016643047332763672, "ViewRequirementAgentConnector_ms": 0.45856523513793945}, "num_episodes": 18, "episode_return_max": 381.50491199055796, "episode_return_min": 282.2168033563736, "episode_return_mean": 343.15290585366614, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 704000, "num_agent_steps_trained": 704000, "num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 262.99006369020987, "num_env_steps_trained_throughput_per_sec": 262.99006369020987, "timesteps_total": 176000, "num_env_steps_sampled_lifetime": 176000, "num_agent_steps_sampled_lifetime": 704000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 704000, "timers": {"training_iteration_time_ms": 15637.151, "restore_workers_time_ms": 0.016, "training_step_time_ms": 15637.105, "sample_time_ms": 4162.757, "learn_time_ms": 11459.061, "learn_throughput": 349.069, "synch_weights_time_ms": 14.303}, "counters": {"num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_agent_steps_sampled": 704000, "num_agent_steps_trained": 704000}, "done": false, "training_iteration": 44, "trial_id": "d163c_00000", "date": "2024-08-16_13-03-23", "timestamp": 1723793603, "time_this_iter_s": 15.214040756225586, "time_total_s": 823.0042514801025, "pid": 81201, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16b87c310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 823.0042514801025, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 27.349999999999998, "ram_util_percent": 68.37272727272727}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.176470833480673, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.8402379884290947, "policy_loss": -0.007523777572531746, "vf_loss": 1.8462219659613555, "vf_explained_var": 0.24391659104004107, "kl": 0.010265282630901554, "entropy": 1.0159616378249314, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 84105.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.4461036787146613, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.830248105589044, "policy_loss": -0.006737264720402737, "vf_loss": 8.83412124492504, "vf_explained_var": 0.061220534295632095, "kl": 0.01432056357228455, "entropy": 1.4025284946910919, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 84105.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000}, "env_runners": {"episode_reward_max": 381.50491199055796, "episode_reward_min": 255.17251177045537, "episode_reward_mean": 335.6064446976374, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 5.523976178665379, "predator_policy": 0.1729667415299886}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 89.13121951055525}, "policy_reward_mean": {"prey_policy": 156.16366998264812, "predator_policy": 11.63955236617058}, "custom_metrics": {}, "hist_stats": {"episode_reward": [336.19943659696304, 365.8615592469232, 333.9887149603619, 315.317110336529, 294.1909457939323, 374.47298787738737, 346.8156935915725, 354.64358046434654, 372.43741905968767, 349.33714350662524, 355.0398117836943, 326.2841368744473, 355.37294020351214, 352.24, 358.8027553591139, 373.8048329356808, 351.12554813874243, 346.02832631498626, 366.20000000000005, 333.71705650345643, 353.51012674264314, 346.52869608790456, 350.94654926841156, 351.04296206629806, 360.0321488923351, 323.828021266889, 365.78414144752253, 375.3030983830761, 361.4892885524055, 372.2400837790909, 356.9729966610302, 352.1998039177014, 357.0980590807065, 374.89519816528775, 323.18068201874115, 344.2414765609038, 324.00501604001784, 371.19162263377973, 332.1407340710363, 363.35743813965036, 344.38083673880084, 336.4003466238257, 310.70908867732476, 352.37880149407107, 339.53761743482005, 327.5386798769871, 333.15, 356.3458553423692, 353.75221084062304, 336.84329352118345, 362.9133222254793, 375.01689081879533, 318.8532436234418, 342.66287099775985, 329.1100118692361, 328.87157649577165, 317.6530368612672, 282.2168033563736, 381.50491199055796, 367.9293816061799, 346.9281300788827, 343.13311262344916, 338.4898715950869, 362.70944544621983, 347.52588845048984, 290.7199999999998, 325.3898767802483, 314.55187651724003, 328.9822394793101, 333.23659392752967, 357.43994754094905, 348.9310166381207, 333.47498812649405, 373.21, 351.68636050034155, 341.76577804746023, 342.05595938356305, 294.4520862828073, 343.8620690298332, 278.0850958113248, 290.36553939511646, 350.4556869825262, 304.00194137593735, 367.2, 268.38973395677436, 266.3452823063197, 310.8770744597567, 356.48014077291515, 299.80086187985484, 312.6163347590616, 344.0659424460505, 265.02166120952455, 292.7361878683772, 334.707643588874, 259.5406952152762, 255.17251177045537, 315.99137540681335, 261.5871567826823, 327.51621727712137, 261.50522233268964], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [128.19002967702045, 189.9739482465348, 150.24103309143572, 189.69626163314814, 162.6207763433327, 159.77094830088328, 97.98626068986673, 166.85884725231338, 130.0344554947042, 143.72113563391162, 183.19593768878408, 184.35704173988347, 157.0494650526552, 156.42809529598617, 173.0074544105339, 167.9134815924938, 137.83829296179948, 196.83874630516087, 179.03329338759715, 160.15640073879433, 153.71986584608544, 176.21925713244042, 140.75234697708134, 169.07002888669788, 154.4125593700433, 185.90494998952317, 160.17658317445876, 165.49144446186205, 183.5748570354291, 164.68951978244394, 179.05662065689168, 179.89091173402448, 153.5836244376205, 172.87988401056927, 171.51279658124645, 158.28457958162437, 163.78174329847255, 197.77093267455922, 162.97518774972124, 154.76548329888786, 150.9526988887422, 189.9041373329564, 177.1733020376928, 160.9023571785958, 135.7071605286663, 182.250414530569, 100.57011763740229, 181.64425360299504, 162.5629168668924, 186.63311231812705, 100.21953030428224, 171.28232685688337, 172.45789183399563, 179.6892903934498, 171.5017269517744, 191.52116764862302, 188.8691883229336, 157.8003808440594, 178.56587302915483, 185.08168086872558, 170.64206910449877, 174.56894817720638, 163.60222842679713, 180.84813789699786, 178.3824212112478, 160.15113737687585, 192.511091596287, 171.41511080822727, 160.34202704144445, 143.4146072399663, 171.83564809921705, 158.94347584496026, 137.62808585635904, 144.32147262912417, 184.57838744238154, 179.29140446822174, 157.910395264015, 151.88283755823235, 170.7896917942864, 179.15765080785033, 152.64968015118342, 157.05911055974875, 168.21760391150426, 149.5301257716809, 145.8861137180216, 152.85448316955112, 111.07925235710238, 200.0, 174.37115790616522, 150.9849511098135, 155.29249675960847, 133.15298110971176, 148.64962933389205, 157.99135355454123, 160.94879210978917, 179.86693850232876, 177.99492213810976, 151.24119828912802, 148.8794957558608, 170.79320327550096, 155.6926507806382, 192.68920200785837, 179.28631472048053, 189.60706804051676, 149.92277643588906, 153.79146258634273, 171.48610441660094, 156.62635490728312, 145.78278945878026, 163.54713647668305, 143.9388749549145, 164.15486208072653, 162.7166816421813, 89.04472326590881, 129.49086195843915, 113.58564660913088, 186.6079645087653, 188.69403507292253, 153.2139977311584, 186.67320366343594, 170.06430965325487, 164.06949347692537, 179.6704934022663, 135.66425957975449, 175.46210604371288, 144.967322823254, 179.50693364611482, 177.23279273032438, 175.3008650151047, 157.90072722851582, 100.95021769315703, 177.2114458459542, 177.14030640604605, 123.83664632988322, 142.73107646595702, 154.9732219474461, 195.4170051487038, 131.92401173689328, 126.4573774416467, 179.19404055736436, 155.69590323740823, 184.92248144479237, 179.53901640484594, 151.38935989528923, 161.62540409610827, 156.576269860289, 192.8806576185911, 179.20999999999998, 166.42599287308727, 174.51672136530624, 175.0186987671441, 157.84959628152143, 161.30240244311716, 159.40859935873382, 153.57999177747047, 99.53725466019907, 179.32021680671866, 117.10019175794932, 111.27681637208362, 137.49997817210055, 151.55999312137152, 97.09101629284757, 165.42430393822508, 170.19503340397713, 138.89905865100397, 141.43236632618022, 185.31003128315427, 179.2124860196672, 5.523976178665379, 188.34453281273755, 117.19431319722315, 101.24008437531252, 145.30367555665364, 139.90850366878198, 177.37405969099655, 160.09556079545257, 113.23176062992286, 159.7518040782296, 139.13076597952838, 150.01606083911415, 180.93196626483757, 135.88941254359537, 107.33203256831966, 126.71673373612678, 135.12724179358935, 104.81123662465556, 166.24577901817864, 157.41210549155636, 58.89353263737905, 73.8848202144716, 111.34642282021873, 102.00871762403698, 139.7483005839386, 154.65286942735935, 108.98314131559245, 130.8767592391153, 162.86347794294988, 137.9035447364339, 90.05798729517801, 151.5306818088706], "policy_predator_policy_reward": [3.1610774963706043, 14.874381177037183, 7.56801022634456, 18.356254295994827, 8.92801834410482, 2.6689719720411436, 13.512932027700993, 36.959070366647964, 9.17359556875034, 11.261759096566204, 4.828088193261032, 2.0919202554588052, 25.78047490019882, 7.55765834273234, 6.648548062060513, 7.074096399258319, 31.034806243671945, 6.7255735490553405, 3.895743367791192, 6.251706012442505, 8.143158637432835, 16.957530167735666, 7.996566050569867, 8.46519496009819, 5.376043085735329, 9.679387758210295, 25.05254048682761, 1.5194318768515855, 3.177898323684775, 7.360480217556035, 4.338784255594324, 10.51851628917019, 7.108112470609256, 17.553927219943397, 11.448681360224052, 4.782268791891394, 0.4031931424729487, 4.244130884495234, 14.9588160382459, 1.0175694166014007, 7.855407636795812, 4.797882884148772, 4.789129776165984, 3.6639070954499338, 3.399280505987828, 29.589693703188477, 53.82835291342271, 15.00023791247801, 6.58256772618325, 4.253551981132483, 43.929530339563904, 8.396633766159475, 6.927943548846577, 6.709015671230549, 5.298917103826103, 6.981286678852584, 10.609873035512178, 4.209846349900371, 4.242752004214706, 4.349777876995827, 5.564075234081378, 6.197904145243642, 1.566408493492857, 6.183029100413575, 7.394344821821877, 11.170155670760979, 4.103580879606072, 6.865414881167402, 10.480405817137834, 8.943641920192613, 6.69977659770202, 6.762576019024551, 28.931915458901234, 13.123542095633425, 2.923255924394045, 4.398574798782412, 8.11070304696477, 14.236798201824241, 2.027997239708058, 11.38209829780556, 27.316462543940634, 7.355583483928057, 9.176682378442534, 9.475934562197999, 4.239924501204063, 7.728567288548028, 15.864785242284494, 25.434763894684398, 10.992037982876694, 3.1894704359646178, 20.793628768252315, 18.299573239414574, 8.500370666107964, 18.00864644545876, 8.293000165399985, 7.237124564851248, 13.331634268234751, 11.18445614515053, 7.4169083722209646, 9.753686117600713, 8.785867355705307, 5.745602081277349, 3.495749174365786, 2.627758883432227, 6.604590464650392, 8.534414136559581, 2.9294358544468277, 11.62097581942892, 12.780778661455539, 6.999307272317255, 18.25259001844597, 2.525249441684632, 43.1308279799878, 22.760803973189294, 16.070789955561544, 23.069504833241986, 3.380749378618461, 2.8221630302517116, 24.477047520255013, 3.5651326913305317, 6.353234344711361, 6.44109260399113, 12.116313595673091, 15.682046045755277, 12.891779703152027, 5.16866302496801, 0.7127085948341194, 5.257010474946525, 7.972034222273312, 6.3522619845959385, 3.4042481227434576, 9.154088338145181, 14.115787376163318, 10.297136668155703, 4.901493434240326, 11.946084669596575, 0.7159882631067274, 0.9252343306063192, 15.049498286307408, 12.535677642211175, 7.315100515505974, 9.506462343242474, 5.084256969413037, 12.918383368572457, 7.395198343953987, 7.878115826142808, 0.9463756398789175, 0.1729667415299886, 6.592386744594551, 4.151259517353477, 4.376730691182959, 4.520752307611765, 13.719328954346802, 7.625628627365222, 16.397910717893996, 24.93692912724373, 4.65592118949623, 42.78573927566897, 14.803095789293277, 14.505205477847271, 26.504176907074605, 15.210353073822734, 10.211174232069814, 4.625175408254085, 11.694238836225404, 11.976277562527773, 1.3169507913538643, 1.3605319058246663, 21.245173338915855, 53.27605162645533, 37.347313453078016, 10.563571280705983, 19.627335541905765, 6.037559692415396, 11.93596569275392, 7.074554593712071, 7.721976601637804, 19.095320570064477, 13.804581582010679, 9.664926358408406, 16.89680646803734, 10.347757169580145, 25.492125501186084, 5.480769403892136, 10.712515028921063, 42.085194421211284, 3.754421659205224, 7.295337419933806, 37.631122852870284, 89.13121951055525, 22.477041013150995, 19.34033031304866, 14.975576230184966, 6.6146291653304345, 8.860972248638292, 12.86628397933629, 6.293434944244435, 20.4557596534932, 6.937275355246255, 12.979277873394908]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.3899243225147266, "mean_inference_ms": 6.230557311115099, "mean_action_processing_ms": 1.0526872001550789, "mean_env_wait_ms": 0.8211783130490327, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027030348777770996, "StateBufferConnector_ms": 0.017452716827392578, "ViewRequirementAgentConnector_ms": 0.38043737411499023}, "num_episodes": 22, "episode_return_max": 381.50491199055796, "episode_return_min": 255.17251177045537, "episode_return_mean": 335.6064446976374, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 264.7128437501001, "num_env_steps_trained_throughput_per_sec": 264.7128437501001, "timesteps_total": 180000, "num_env_steps_sampled_lifetime": 180000, "num_agent_steps_sampled_lifetime": 720000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 720000, "timers": {"training_iteration_time_ms": 15567.117, "restore_workers_time_ms": 0.016, "training_step_time_ms": 15567.072, "sample_time_ms": 4124.158, "learn_time_ms": 11427.587, "learn_throughput": 350.03, "synch_weights_time_ms": 14.327}, "counters": {"num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000}, "done": false, "training_iteration": 45, "trial_id": "d163c_00000", "date": "2024-08-16_13-03-38", "timestamp": 1723793618, "time_this_iter_s": 15.11457896232605, "time_total_s": 838.1188304424286, "pid": 81201, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16b86d0d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 838.1188304424286, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 27.657142857142855, "ram_util_percent": 68.29047619047617}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.460868351737028, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.861353520173875, "policy_loss": -0.011959137484830405, "vf_loss": 2.8715670627260965, "vf_explained_var": 0.30446672799095276, "kl": 0.011637276865036435, "entropy": 1.0066488035141476, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 85995.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.7466898922882383, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.403635615141933, "policy_loss": -0.004110091522818914, "vf_loss": 8.405691903734963, "vf_explained_var": 0.10564039743766583, "kl": 0.010269147669676255, "entropy": 1.3808844768811785, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 85995.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_agent_steps_sampled": 736000, "num_agent_steps_trained": 736000}, "env_runners": {"episode_reward_max": 381.50491199055796, "episode_reward_min": 165.34844299752808, "episode_reward_mean": 316.223902442935, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 5.523976178665379, "predator_policy": 0.1729667415299886}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 89.13121951055525}, "policy_reward_mean": {"prey_policy": 144.22276887406775, "predator_policy": 13.889182347399775}, "custom_metrics": {}, "hist_stats": {"episode_reward": [351.04296206629806, 360.0321488923351, 323.828021266889, 365.78414144752253, 375.3030983830761, 361.4892885524055, 372.2400837790909, 356.9729966610302, 352.1998039177014, 357.0980590807065, 374.89519816528775, 323.18068201874115, 344.2414765609038, 324.00501604001784, 371.19162263377973, 332.1407340710363, 363.35743813965036, 344.38083673880084, 336.4003466238257, 310.70908867732476, 352.37880149407107, 339.53761743482005, 327.5386798769871, 333.15, 356.3458553423692, 353.75221084062304, 336.84329352118345, 362.9133222254793, 375.01689081879533, 318.8532436234418, 342.66287099775985, 329.1100118692361, 328.87157649577165, 317.6530368612672, 282.2168033563736, 381.50491199055796, 367.9293816061799, 346.9281300788827, 343.13311262344916, 338.4898715950869, 362.70944544621983, 347.52588845048984, 290.7199999999998, 325.3898767802483, 314.55187651724003, 328.9822394793101, 333.23659392752967, 357.43994754094905, 348.9310166381207, 333.47498812649405, 373.21, 351.68636050034155, 341.76577804746023, 342.05595938356305, 294.4520862828073, 343.8620690298332, 278.0850958113248, 290.36553939511646, 350.4556869825262, 304.00194137593735, 367.2, 268.38973395677436, 266.3452823063197, 310.8770744597567, 356.48014077291515, 299.80086187985484, 312.6163347590616, 344.0659424460505, 265.02166120952455, 292.7361878683772, 334.707643588874, 259.5406952152762, 255.17251177045537, 315.99137540681335, 261.5871567826823, 327.51621727712137, 261.50522233268964, 329.8521170720527, 294.6422478442971, 208.72932470588904, 195.93670351980109, 328.41806794304637, 274.37920879102614, 294.1817232141915, 282.5761877691118, 316.2746396983264, 165.34844299752808, 297.1508193256648, 323.637101410249, 289.65730717458234, 235.2595131844659, 320.5105695908279, 236.9732573645608, 222.432582795588, 271.14076973057604, 232.39902514758194, 295.8694755205693, 282.34180840947715, 165.39603549386774, 211.5042174734017], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [100.57011763740229, 181.64425360299504, 162.5629168668924, 186.63311231812705, 100.21953030428224, 171.28232685688337, 172.45789183399563, 179.6892903934498, 171.5017269517744, 191.52116764862302, 188.8691883229336, 157.8003808440594, 178.56587302915483, 185.08168086872558, 170.64206910449877, 174.56894817720638, 163.60222842679713, 180.84813789699786, 178.3824212112478, 160.15113737687585, 192.511091596287, 171.41511080822727, 160.34202704144445, 143.4146072399663, 171.83564809921705, 158.94347584496026, 137.62808585635904, 144.32147262912417, 184.57838744238154, 179.29140446822174, 157.910395264015, 151.88283755823235, 170.7896917942864, 179.15765080785033, 152.64968015118342, 157.05911055974875, 168.21760391150426, 149.5301257716809, 145.8861137180216, 152.85448316955112, 111.07925235710238, 200.0, 174.37115790616522, 150.9849511098135, 155.29249675960847, 133.15298110971176, 148.64962933389205, 157.99135355454123, 160.94879210978917, 179.86693850232876, 177.99492213810976, 151.24119828912802, 148.8794957558608, 170.79320327550096, 155.6926507806382, 192.68920200785837, 179.28631472048053, 189.60706804051676, 149.92277643588906, 153.79146258634273, 171.48610441660094, 156.62635490728312, 145.78278945878026, 163.54713647668305, 143.9388749549145, 164.15486208072653, 162.7166816421813, 89.04472326590881, 129.49086195843915, 113.58564660913088, 186.6079645087653, 188.69403507292253, 153.2139977311584, 186.67320366343594, 170.06430965325487, 164.06949347692537, 179.6704934022663, 135.66425957975449, 175.46210604371288, 144.967322823254, 179.50693364611482, 177.23279273032438, 175.3008650151047, 157.90072722851582, 100.95021769315703, 177.2114458459542, 177.14030640604605, 123.83664632988322, 142.73107646595702, 154.9732219474461, 195.4170051487038, 131.92401173689328, 126.4573774416467, 179.19404055736436, 155.69590323740823, 184.92248144479237, 179.53901640484594, 151.38935989528923, 161.62540409610827, 156.576269860289, 192.8806576185911, 179.20999999999998, 166.42599287308727, 174.51672136530624, 175.0186987671441, 157.84959628152143, 161.30240244311716, 159.40859935873382, 153.57999177747047, 99.53725466019907, 179.32021680671866, 117.10019175794932, 111.27681637208362, 137.49997817210055, 151.55999312137152, 97.09101629284757, 165.42430393822508, 170.19503340397713, 138.89905865100397, 141.43236632618022, 185.31003128315427, 179.2124860196672, 5.523976178665379, 188.34453281273755, 117.19431319722315, 101.24008437531252, 145.30367555665364, 139.90850366878198, 177.37405969099655, 160.09556079545257, 113.23176062992286, 159.7518040782296, 139.13076597952838, 150.01606083911415, 180.93196626483757, 135.88941254359537, 107.33203256831966, 126.71673373612678, 135.12724179358935, 104.81123662465556, 166.24577901817864, 157.41210549155636, 58.89353263737905, 73.8848202144716, 111.34642282021873, 102.00871762403698, 139.7483005839386, 154.65286942735935, 108.98314131559245, 130.8767592391153, 162.86347794294988, 137.9035447364339, 90.05798729517801, 151.5306818088706, 167.7208932961678, 125.30128587512912, 139.06274410142345, 132.44108969943045, 89.76856547586323, 50.29152340519546, 68.96972842795164, 90.13856074009202, 166.20250533280827, 146.4355555261484, 169.85043578646582, 82.14576382616467, 111.93950416280951, 160.91730981540636, 163.90013341785243, 66.96108351243382, 147.21514417041038, 139.45044145492488, 80.52153803069162, 55.826548000277725, 80.86815671680851, 142.18485165903155, 159.81380124237256, 148.272737455795, 153.8628655251519, 116.41448739093285, 108.69102921564027, 87.43221145734654, 151.32605190575381, 155.87610203342246, 86.79738233550779, 86.72945069829079, 82.89323826801527, 112.9689037401861, 109.12444344750377, 102.784578674431, 97.39989153557781, 107.84801020465657, 125.61221670805311, 145.20828328113552, 38.16859302811305, 152.3865445551677, 47.46421444431163, 42.74707263846533, 55.63139882190015, 118.56805995645071], "policy_predator_policy_reward": [53.82835291342271, 15.00023791247801, 6.58256772618325, 4.253551981132483, 43.929530339563904, 8.396633766159475, 6.927943548846577, 6.709015671230549, 5.298917103826103, 6.981286678852584, 10.609873035512178, 4.209846349900371, 4.242752004214706, 4.349777876995827, 5.564075234081378, 6.197904145243642, 1.566408493492857, 6.183029100413575, 7.394344821821877, 11.170155670760979, 4.103580879606072, 6.865414881167402, 10.480405817137834, 8.943641920192613, 6.69977659770202, 6.762576019024551, 28.931915458901234, 13.123542095633425, 2.923255924394045, 4.398574798782412, 8.11070304696477, 14.236798201824241, 2.027997239708058, 11.38209829780556, 27.316462543940634, 7.355583483928057, 9.176682378442534, 9.475934562197999, 4.239924501204063, 7.728567288548028, 15.864785242284494, 25.434763894684398, 10.992037982876694, 3.1894704359646178, 20.793628768252315, 18.299573239414574, 8.500370666107964, 18.00864644545876, 8.293000165399985, 7.237124564851248, 13.331634268234751, 11.18445614515053, 7.4169083722209646, 9.753686117600713, 8.785867355705307, 5.745602081277349, 3.495749174365786, 2.627758883432227, 6.604590464650392, 8.534414136559581, 2.9294358544468277, 11.62097581942892, 12.780778661455539, 6.999307272317255, 18.25259001844597, 2.525249441684632, 43.1308279799878, 22.760803973189294, 16.070789955561544, 23.069504833241986, 3.380749378618461, 2.8221630302517116, 24.477047520255013, 3.5651326913305317, 6.353234344711361, 6.44109260399113, 12.116313595673091, 15.682046045755277, 12.891779703152027, 5.16866302496801, 0.7127085948341194, 5.257010474946525, 7.972034222273312, 6.3522619845959385, 3.4042481227434576, 9.154088338145181, 14.115787376163318, 10.297136668155703, 4.901493434240326, 11.946084669596575, 0.7159882631067274, 0.9252343306063192, 15.049498286307408, 12.535677642211175, 7.315100515505974, 9.506462343242474, 5.084256969413037, 12.918383368572457, 7.395198343953987, 7.878115826142808, 0.9463756398789175, 0.1729667415299886, 6.592386744594551, 4.151259517353477, 4.376730691182959, 4.520752307611765, 13.719328954346802, 7.625628627365222, 16.397910717893996, 24.93692912724373, 4.65592118949623, 42.78573927566897, 14.803095789293277, 14.505205477847271, 26.504176907074605, 15.210353073822734, 10.211174232069814, 4.625175408254085, 11.694238836225404, 11.976277562527773, 1.3169507913538643, 1.3605319058246663, 21.245173338915855, 53.27605162645533, 37.347313453078016, 10.563571280705983, 19.627335541905765, 6.037559692415396, 11.93596569275392, 7.074554593712071, 7.721976601637804, 19.095320570064477, 13.804581582010679, 9.664926358408406, 16.89680646803734, 10.347757169580145, 25.492125501186084, 5.480769403892136, 10.712515028921063, 42.085194421211284, 3.754421659205224, 7.295337419933806, 37.631122852870284, 89.13121951055525, 22.477041013150995, 19.34033031304866, 14.975576230184966, 6.6146291653304345, 8.860972248638292, 12.86628397933629, 6.293434944244435, 20.4557596534932, 6.937275355246255, 12.979277873394908, 25.06999761863648, 11.75994028211929, 17.241816292574782, 5.896597750868371, 53.941753602656036, 14.72748222217433, 15.422291465380443, 21.406122886378117, 10.931400181433332, 4.8486069026563925, 17.83075176857144, 4.552257409824371, 6.1434920456355115, 15.18141719034015, 43.83159361141904, 7.8833772274065055, 9.906512397696876, 19.70254167529434, 8.982196165502526, 20.01816080105622, 14.718468072997508, 59.37934287682737, 7.797541931368973, 7.753020780712515, 8.491381948288183, 10.888572310209456, 11.101080232648595, 28.035192278830763, 9.566717476448755, 3.741698175202499, 25.912500792908567, 37.53392353785374, 18.715718500315162, 7.8547222870717555, 54.959455880669054, 4.272291727972192, 6.38345706779357, 20.76766633955386, 15.129503361838266, 9.919472169542107, 8.536750742579866, 83.24992008361642, 55.380990008060564, 19.8037584030302, 4.9978959728133825, 32.306862722237454]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.3800084082797075, "mean_inference_ms": 6.202697281826004, "mean_action_processing_ms": 1.0470266091138398, "mean_env_wait_ms": 0.8165680530591918, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015982866287231445, "StateBufferConnector_ms": 0.02908611297607422, "ViewRequirementAgentConnector_ms": 0.3733588457107544}, "num_episodes": 23, "episode_return_max": 381.50491199055796, "episode_return_min": 165.34844299752808, "episode_return_mean": 316.223902442935, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 736000, "num_agent_steps_trained": 736000, "num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 244.8558994808033, "num_env_steps_trained_throughput_per_sec": 244.8558994808033, "timesteps_total": 184000, "num_env_steps_sampled_lifetime": 184000, "num_agent_steps_sampled_lifetime": 736000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 736000, "timers": {"training_iteration_time_ms": 15687.558, "restore_workers_time_ms": 0.016, "training_step_time_ms": 15687.512, "sample_time_ms": 4128.031, "learn_time_ms": 11544.322, "learn_throughput": 346.491, "synch_weights_time_ms": 14.176}, "counters": {"num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_agent_steps_sampled": 736000, "num_agent_steps_trained": 736000}, "done": false, "training_iteration": 46, "trial_id": "d163c_00000", "date": "2024-08-16_13-03-54", "timestamp": 1723793634, "time_this_iter_s": 16.34027624130249, "time_total_s": 854.4591066837311, "pid": 81201, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16af89430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 854.4591066837311, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 31.160869565217393, "ram_util_percent": 68.49130434782606}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.690826430270281, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.383371644297605, "policy_loss": -0.015301863453843724, "vf_loss": 5.396569433666411, "vf_explained_var": 0.21155078439485459, "kl": 0.01402709882392494, "entropy": 0.9627921465212705, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 87885.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.3265718122007986, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.192375305720738, "policy_loss": -0.00249560232466412, "vf_loss": 9.192678978329614, "vf_explained_var": -0.006244634762012139, "kl": 0.010959572677296938, "entropy": 1.3594502707637808, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 87885.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_agent_steps_sampled": 752000, "num_agent_steps_trained": 752000}, "env_runners": {"episode_reward_max": 381.50491199055796, "episode_reward_min": -2.4627309237861015, "episode_reward_mean": 283.0824746923556, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -94.85842028918928, "predator_policy": 0.1729667415299886}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 105.16261434142491}, "policy_reward_mean": {"prey_policy": 122.40128608637468, "predator_policy": 19.13995125980314}, "custom_metrics": {}, "hist_stats": {"episode_reward": [336.4003466238257, 310.70908867732476, 352.37880149407107, 339.53761743482005, 327.5386798769871, 333.15, 356.3458553423692, 353.75221084062304, 336.84329352118345, 362.9133222254793, 375.01689081879533, 318.8532436234418, 342.66287099775985, 329.1100118692361, 328.87157649577165, 317.6530368612672, 282.2168033563736, 381.50491199055796, 367.9293816061799, 346.9281300788827, 343.13311262344916, 338.4898715950869, 362.70944544621983, 347.52588845048984, 290.7199999999998, 325.3898767802483, 314.55187651724003, 328.9822394793101, 333.23659392752967, 357.43994754094905, 348.9310166381207, 333.47498812649405, 373.21, 351.68636050034155, 341.76577804746023, 342.05595938356305, 294.4520862828073, 343.8620690298332, 278.0850958113248, 290.36553939511646, 350.4556869825262, 304.00194137593735, 367.2, 268.38973395677436, 266.3452823063197, 310.8770744597567, 356.48014077291515, 299.80086187985484, 312.6163347590616, 344.0659424460505, 265.02166120952455, 292.7361878683772, 334.707643588874, 259.5406952152762, 255.17251177045537, 315.99137540681335, 261.5871567826823, 327.51621727712137, 261.50522233268964, 329.8521170720527, 294.6422478442971, 208.72932470588904, 195.93670351980109, 328.41806794304637, 274.37920879102614, 294.1817232141915, 282.5761877691118, 316.2746396983264, 165.34844299752808, 297.1508193256648, 323.637101410249, 289.65730717458234, 235.2595131844659, 320.5105695908279, 236.9732573645608, 222.432582795588, 271.14076973057604, 232.39902514758194, 295.8694755205693, 282.34180840947715, 165.39603549386774, 211.5042174734017, 92.87180354858745, 157.6467124006578, 236.60370560457733, 258.97012601684287, 332.86635456693034, 222.26640119750013, 70.90635714700811, 69.39976012982906, 212.18149426387606, 221.8360830136711, 301.7992670700395, 169.79844312655862, 168.2856907639195, 101.94638218605952, 237.75238740035275, -2.4627309237861015, 130.13231425189358, 56.44028159281929], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [168.21760391150426, 149.5301257716809, 145.8861137180216, 152.85448316955112, 111.07925235710238, 200.0, 174.37115790616522, 150.9849511098135, 155.29249675960847, 133.15298110971176, 148.64962933389205, 157.99135355454123, 160.94879210978917, 179.86693850232876, 177.99492213810976, 151.24119828912802, 148.8794957558608, 170.79320327550096, 155.6926507806382, 192.68920200785837, 179.28631472048053, 189.60706804051676, 149.92277643588906, 153.79146258634273, 171.48610441660094, 156.62635490728312, 145.78278945878026, 163.54713647668305, 143.9388749549145, 164.15486208072653, 162.7166816421813, 89.04472326590881, 129.49086195843915, 113.58564660913088, 186.6079645087653, 188.69403507292253, 153.2139977311584, 186.67320366343594, 170.06430965325487, 164.06949347692537, 179.6704934022663, 135.66425957975449, 175.46210604371288, 144.967322823254, 179.50693364611482, 177.23279273032438, 175.3008650151047, 157.90072722851582, 100.95021769315703, 177.2114458459542, 177.14030640604605, 123.83664632988322, 142.73107646595702, 154.9732219474461, 195.4170051487038, 131.92401173689328, 126.4573774416467, 179.19404055736436, 155.69590323740823, 184.92248144479237, 179.53901640484594, 151.38935989528923, 161.62540409610827, 156.576269860289, 192.8806576185911, 179.20999999999998, 166.42599287308727, 174.51672136530624, 175.0186987671441, 157.84959628152143, 161.30240244311716, 159.40859935873382, 153.57999177747047, 99.53725466019907, 179.32021680671866, 117.10019175794932, 111.27681637208362, 137.49997817210055, 151.55999312137152, 97.09101629284757, 165.42430393822508, 170.19503340397713, 138.89905865100397, 141.43236632618022, 185.31003128315427, 179.2124860196672, 5.523976178665379, 188.34453281273755, 117.19431319722315, 101.24008437531252, 145.30367555665364, 139.90850366878198, 177.37405969099655, 160.09556079545257, 113.23176062992286, 159.7518040782296, 139.13076597952838, 150.01606083911415, 180.93196626483757, 135.88941254359537, 107.33203256831966, 126.71673373612678, 135.12724179358935, 104.81123662465556, 166.24577901817864, 157.41210549155636, 58.89353263737905, 73.8848202144716, 111.34642282021873, 102.00871762403698, 139.7483005839386, 154.65286942735935, 108.98314131559245, 130.8767592391153, 162.86347794294988, 137.9035447364339, 90.05798729517801, 151.5306818088706, 167.7208932961678, 125.30128587512912, 139.06274410142345, 132.44108969943045, 89.76856547586323, 50.29152340519546, 68.96972842795164, 90.13856074009202, 166.20250533280827, 146.4355555261484, 169.85043578646582, 82.14576382616467, 111.93950416280951, 160.91730981540636, 163.90013341785243, 66.96108351243382, 147.21514417041038, 139.45044145492488, 80.52153803069162, 55.826548000277725, 80.86815671680851, 142.18485165903155, 159.81380124237256, 148.272737455795, 153.8628655251519, 116.41448739093285, 108.69102921564027, 87.43221145734654, 151.32605190575381, 155.87610203342246, 86.79738233550779, 86.72945069829079, 82.89323826801527, 112.9689037401861, 109.12444344750377, 102.784578674431, 97.39989153557781, 107.84801020465657, 125.61221670805311, 145.20828328113552, 38.16859302811305, 152.3865445551677, 47.46421444431163, 42.74707263846533, 55.63139882190015, 118.56805995645071, -43.71409585702743, -11.413710734606239, 76.78707251617676, -7.169080642783662, 77.5971689535585, 113.07704504452772, 79.75663620150513, 116.53448701296846, 154.01153483114297, 162.8984764272742, 61.699795223839736, 96.04176306672893, -39.208421072561265, -81.80534633099346, -14.61521959093411, -7.940761387561183, 80.11840011958574, 71.55757161461071, 52.504396630747564, 107.88287873476257, 156.2507819517225, 131.13547513421395, 67.16390198631987, 20.61678905096473, 59.397524936145125, 59.13583017818205, 16.179461441251668, 4.803337513743795, 103.76295926282982, 99.738336605521, -63.26773049274025, -48.73736639079177, 49.38369635436568, 8.763510638272013, -8.04015934595511, -94.85842028918928], "policy_predator_policy_reward": [9.176682378442534, 9.475934562197999, 4.239924501204063, 7.728567288548028, 15.864785242284494, 25.434763894684398, 10.992037982876694, 3.1894704359646178, 20.793628768252315, 18.299573239414574, 8.500370666107964, 18.00864644545876, 8.293000165399985, 7.237124564851248, 13.331634268234751, 11.18445614515053, 7.4169083722209646, 9.753686117600713, 8.785867355705307, 5.745602081277349, 3.495749174365786, 2.627758883432227, 6.604590464650392, 8.534414136559581, 2.9294358544468277, 11.62097581942892, 12.780778661455539, 6.999307272317255, 18.25259001844597, 2.525249441684632, 43.1308279799878, 22.760803973189294, 16.070789955561544, 23.069504833241986, 3.380749378618461, 2.8221630302517116, 24.477047520255013, 3.5651326913305317, 6.353234344711361, 6.44109260399113, 12.116313595673091, 15.682046045755277, 12.891779703152027, 5.16866302496801, 0.7127085948341194, 5.257010474946525, 7.972034222273312, 6.3522619845959385, 3.4042481227434576, 9.154088338145181, 14.115787376163318, 10.297136668155703, 4.901493434240326, 11.946084669596575, 0.7159882631067274, 0.9252343306063192, 15.049498286307408, 12.535677642211175, 7.315100515505974, 9.506462343242474, 5.084256969413037, 12.918383368572457, 7.395198343953987, 7.878115826142808, 0.9463756398789175, 0.1729667415299886, 6.592386744594551, 4.151259517353477, 4.376730691182959, 4.520752307611765, 13.719328954346802, 7.625628627365222, 16.397910717893996, 24.93692912724373, 4.65592118949623, 42.78573927566897, 14.803095789293277, 14.505205477847271, 26.504176907074605, 15.210353073822734, 10.211174232069814, 4.625175408254085, 11.694238836225404, 11.976277562527773, 1.3169507913538643, 1.3605319058246663, 21.245173338915855, 53.27605162645533, 37.347313453078016, 10.563571280705983, 19.627335541905765, 6.037559692415396, 11.93596569275392, 7.074554593712071, 7.721976601637804, 19.095320570064477, 13.804581582010679, 9.664926358408406, 16.89680646803734, 10.347757169580145, 25.492125501186084, 5.480769403892136, 10.712515028921063, 42.085194421211284, 3.754421659205224, 7.295337419933806, 37.631122852870284, 89.13121951055525, 22.477041013150995, 19.34033031304866, 14.975576230184966, 6.6146291653304345, 8.860972248638292, 12.86628397933629, 6.293434944244435, 20.4557596534932, 6.937275355246255, 12.979277873394908, 25.06999761863648, 11.75994028211929, 17.241816292574782, 5.896597750868371, 53.941753602656036, 14.72748222217433, 15.422291465380443, 21.406122886378117, 10.931400181433332, 4.8486069026563925, 17.83075176857144, 4.552257409824371, 6.1434920456355115, 15.18141719034015, 43.83159361141904, 7.8833772274065055, 9.906512397696876, 19.70254167529434, 8.982196165502526, 20.01816080105622, 14.718468072997508, 59.37934287682737, 7.797541931368973, 7.753020780712515, 8.491381948288183, 10.888572310209456, 11.101080232648595, 28.035192278830763, 9.566717476448755, 3.741698175202499, 25.912500792908567, 37.53392353785374, 18.715718500315162, 7.8547222870717555, 54.959455880669054, 4.272291727972192, 6.38345706779357, 20.76766633955386, 15.129503361838266, 9.919472169542107, 8.536750742579866, 83.24992008361642, 55.380990008060564, 19.8037584030302, 4.9978959728133825, 32.306862722237454, 103.12315293034628, 44.87645720987467, 22.944965543359725, 65.08375498390495, 26.609517942054854, 19.319973664436297, 43.15939404796224, 19.519608754406953, 5.430525857806275, 10.525817450707049, 7.504321546826528, 57.02052136010488, 86.75751020913795, 105.16261434142491, 37.6832494596333, 54.27249164869113, 30.301372096791148, 30.204150432888394, 12.900211405350468, 48.5485962428103, 8.315438020158078, 6.097571963944984, 60.56650078333068, 21.4512513059433, 22.816856688326215, 26.93547896126601, 49.204497832664, 31.759085398400043, 14.613193741060146, 19.6378977909418, 94.11280967782783, 15.42955628191817, 47.657228153199966, 24.327879106055946, 81.53251247654308, 77.80634875142044]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.3733317702978995, "mean_inference_ms": 6.1829508937710935, "mean_action_processing_ms": 1.0431009570413652, "mean_env_wait_ms": 0.8132515886041267, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015918612480163574, "StateBufferConnector_ms": 0.031427979469299316, "ViewRequirementAgentConnector_ms": 0.3683058023452759}, "num_episodes": 18, "episode_return_max": 381.50491199055796, "episode_return_min": -2.4627309237861015, "episode_return_mean": 283.0824746923556, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 752000, "num_agent_steps_trained": 752000, "num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 261.43129336079494, "num_env_steps_trained_throughput_per_sec": 261.43129336079494, "timesteps_total": 188000, "num_env_steps_sampled_lifetime": 188000, "num_agent_steps_sampled_lifetime": 752000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 752000, "timers": {"training_iteration_time_ms": 15550.101, "restore_workers_time_ms": 0.016, "training_step_time_ms": 15550.056, "sample_time_ms": 4035.116, "learn_time_ms": 11499.774, "learn_throughput": 347.833, "synch_weights_time_ms": 14.134}, "counters": {"num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_agent_steps_sampled": 752000, "num_agent_steps_trained": 752000}, "done": false, "training_iteration": 47, "trial_id": "d163c_00000", "date": "2024-08-16_13-04-09", "timestamp": 1723793649, "time_this_iter_s": 15.304904222488403, "time_total_s": 869.7640109062195, "pid": 81201, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16b819d30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 869.7640109062195, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 27.836363636363636, "ram_util_percent": 68.7818181818182}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.939512893352559, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.127679675218289, "policy_loss": -0.009396078233377979, "vf_loss": 8.135420467992308, "vf_explained_var": 0.061641628590841144, "kl": 0.011035275740373073, "entropy": 0.8748835869251735, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 89775.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.8988462853368628, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.59059210176821, "policy_loss": -0.005795142432445631, "vf_loss": 9.594075448677023, "vf_explained_var": -0.00025651760832973256, "kl": 0.0115591144692994, "entropy": 1.3515630827378975, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 89775.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 768000, "num_agent_steps_trained": 768000}, "env_runners": {"episode_reward_max": 373.21, "episode_reward_min": -2.4627309237861015, "episode_reward_mean": 235.52469795042066, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -113.66738150342735, "predator_policy": 0.1729667415299886}, "policy_reward_max": {"prey_policy": 195.4170051487038, "predator_policy": 161.63713919896503}, "policy_reward_mean": {"prey_policy": 87.83437598581376, "predator_policy": 29.927972989396547}, "custom_metrics": {}, "hist_stats": {"episode_reward": [367.9293816061799, 346.9281300788827, 343.13311262344916, 338.4898715950869, 362.70944544621983, 347.52588845048984, 290.7199999999998, 325.3898767802483, 314.55187651724003, 328.9822394793101, 333.23659392752967, 357.43994754094905, 348.9310166381207, 333.47498812649405, 373.21, 351.68636050034155, 341.76577804746023, 342.05595938356305, 294.4520862828073, 343.8620690298332, 278.0850958113248, 290.36553939511646, 350.4556869825262, 304.00194137593735, 367.2, 268.38973395677436, 266.3452823063197, 310.8770744597567, 356.48014077291515, 299.80086187985484, 312.6163347590616, 344.0659424460505, 265.02166120952455, 292.7361878683772, 334.707643588874, 259.5406952152762, 255.17251177045537, 315.99137540681335, 261.5871567826823, 327.51621727712137, 261.50522233268964, 329.8521170720527, 294.6422478442971, 208.72932470588904, 195.93670351980109, 328.41806794304637, 274.37920879102614, 294.1817232141915, 282.5761877691118, 316.2746396983264, 165.34844299752808, 297.1508193256648, 323.637101410249, 289.65730717458234, 235.2595131844659, 320.5105695908279, 236.9732573645608, 222.432582795588, 271.14076973057604, 232.39902514758194, 295.8694755205693, 282.34180840947715, 165.39603549386774, 211.5042174734017, 92.87180354858745, 157.6467124006578, 236.60370560457733, 258.97012601684287, 332.86635456693034, 222.26640119750013, 70.90635714700811, 69.39976012982906, 212.18149426387606, 221.8360830136711, 301.7992670700395, 169.79844312655862, 168.2856907639195, 101.94638218605952, 237.75238740035275, -2.4627309237861015, 130.13231425189358, 56.44028159281929, 121.35313056703653, 67.60166703185037, 42.02009793477249, 76.43836260860853, 35.543829387955064, 46.35819393912273, 11.858195449030939, 64.6889664194067, 135.66192668545375, 137.85965406863048, 98.56636524181005, 16.623644484103636, 90.15193486438521, 34.463557352492806, 109.2120889395535, 27.522672614981463, 144.64451199884178, 69.11208826835201], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [153.2139977311584, 186.67320366343594, 170.06430965325487, 164.06949347692537, 179.6704934022663, 135.66425957975449, 175.46210604371288, 144.967322823254, 179.50693364611482, 177.23279273032438, 175.3008650151047, 157.90072722851582, 100.95021769315703, 177.2114458459542, 177.14030640604605, 123.83664632988322, 142.73107646595702, 154.9732219474461, 195.4170051487038, 131.92401173689328, 126.4573774416467, 179.19404055736436, 155.69590323740823, 184.92248144479237, 179.53901640484594, 151.38935989528923, 161.62540409610827, 156.576269860289, 192.8806576185911, 179.20999999999998, 166.42599287308727, 174.51672136530624, 175.0186987671441, 157.84959628152143, 161.30240244311716, 159.40859935873382, 153.57999177747047, 99.53725466019907, 179.32021680671866, 117.10019175794932, 111.27681637208362, 137.49997817210055, 151.55999312137152, 97.09101629284757, 165.42430393822508, 170.19503340397713, 138.89905865100397, 141.43236632618022, 185.31003128315427, 179.2124860196672, 5.523976178665379, 188.34453281273755, 117.19431319722315, 101.24008437531252, 145.30367555665364, 139.90850366878198, 177.37405969099655, 160.09556079545257, 113.23176062992286, 159.7518040782296, 139.13076597952838, 150.01606083911415, 180.93196626483757, 135.88941254359537, 107.33203256831966, 126.71673373612678, 135.12724179358935, 104.81123662465556, 166.24577901817864, 157.41210549155636, 58.89353263737905, 73.8848202144716, 111.34642282021873, 102.00871762403698, 139.7483005839386, 154.65286942735935, 108.98314131559245, 130.8767592391153, 162.86347794294988, 137.9035447364339, 90.05798729517801, 151.5306818088706, 167.7208932961678, 125.30128587512912, 139.06274410142345, 132.44108969943045, 89.76856547586323, 50.29152340519546, 68.96972842795164, 90.13856074009202, 166.20250533280827, 146.4355555261484, 169.85043578646582, 82.14576382616467, 111.93950416280951, 160.91730981540636, 163.90013341785243, 66.96108351243382, 147.21514417041038, 139.45044145492488, 80.52153803069162, 55.826548000277725, 80.86815671680851, 142.18485165903155, 159.81380124237256, 148.272737455795, 153.8628655251519, 116.41448739093285, 108.69102921564027, 87.43221145734654, 151.32605190575381, 155.87610203342246, 86.79738233550779, 86.72945069829079, 82.89323826801527, 112.9689037401861, 109.12444344750377, 102.784578674431, 97.39989153557781, 107.84801020465657, 125.61221670805311, 145.20828328113552, 38.16859302811305, 152.3865445551677, 47.46421444431163, 42.74707263846533, 55.63139882190015, 118.56805995645071, -43.71409585702743, -11.413710734606239, 76.78707251617676, -7.169080642783662, 77.5971689535585, 113.07704504452772, 79.75663620150513, 116.53448701296846, 154.01153483114297, 162.8984764272742, 61.699795223839736, 96.04176306672893, -39.208421072561265, -81.80534633099346, -14.61521959093411, -7.940761387561183, 80.11840011958574, 71.55757161461071, 52.504396630747564, 107.88287873476257, 156.2507819517225, 131.13547513421395, 67.16390198631987, 20.61678905096473, 59.397524936145125, 59.13583017818205, 16.179461441251668, 4.803337513743795, 103.76295926282982, 99.738336605521, -63.26773049274025, -48.73736639079177, 49.38369635436568, 8.763510638272013, -8.04015934595511, -94.85842028918928, 22.89442476928069, -9.269495431102428, -30.446093498113857, -70.54367595544772, -16.179009231500217, -68.3673177016312, -5.785323975706019, -46.92868113939084, -91.19709741589145, -54.30151760085392, -113.66738150342735, -52.541180096070605, -77.52601287405125, -96.64695272213544, -82.66691486527475, 16.350461207894305, 30.584474754384704, 16.38968633259298, -12.693509033834935, 10.800382300586802, 9.320730342270672, -22.84799351512494, -82.97098479898902, -41.97355847392747, -11.597237063529057, -4.62550801745216, -90.19083828496586, -26.33705892108093, -72.67814974136878, -25.534007983502114, -66.92990930758596, -104.39733428531389, 29.16985323843685, 31.222085014827027, 11.524961285257298, -38.396127224069986], "policy_predator_policy_reward": [24.477047520255013, 3.5651326913305317, 6.353234344711361, 6.44109260399113, 12.116313595673091, 15.682046045755277, 12.891779703152027, 5.16866302496801, 0.7127085948341194, 5.257010474946525, 7.972034222273312, 6.3522619845959385, 3.4042481227434576, 9.154088338145181, 14.115787376163318, 10.297136668155703, 4.901493434240326, 11.946084669596575, 0.7159882631067274, 0.9252343306063192, 15.049498286307408, 12.535677642211175, 7.315100515505974, 9.506462343242474, 5.084256969413037, 12.918383368572457, 7.395198343953987, 7.878115826142808, 0.9463756398789175, 0.1729667415299886, 6.592386744594551, 4.151259517353477, 4.376730691182959, 4.520752307611765, 13.719328954346802, 7.625628627365222, 16.397910717893996, 24.93692912724373, 4.65592118949623, 42.78573927566897, 14.803095789293277, 14.505205477847271, 26.504176907074605, 15.210353073822734, 10.211174232069814, 4.625175408254085, 11.694238836225404, 11.976277562527773, 1.3169507913538643, 1.3605319058246663, 21.245173338915855, 53.27605162645533, 37.347313453078016, 10.563571280705983, 19.627335541905765, 6.037559692415396, 11.93596569275392, 7.074554593712071, 7.721976601637804, 19.095320570064477, 13.804581582010679, 9.664926358408406, 16.89680646803734, 10.347757169580145, 25.492125501186084, 5.480769403892136, 10.712515028921063, 42.085194421211284, 3.754421659205224, 7.295337419933806, 37.631122852870284, 89.13121951055525, 22.477041013150995, 19.34033031304866, 14.975576230184966, 6.6146291653304345, 8.860972248638292, 12.86628397933629, 6.293434944244435, 20.4557596534932, 6.937275355246255, 12.979277873394908, 25.06999761863648, 11.75994028211929, 17.241816292574782, 5.896597750868371, 53.941753602656036, 14.72748222217433, 15.422291465380443, 21.406122886378117, 10.931400181433332, 4.8486069026563925, 17.83075176857144, 4.552257409824371, 6.1434920456355115, 15.18141719034015, 43.83159361141904, 7.8833772274065055, 9.906512397696876, 19.70254167529434, 8.982196165502526, 20.01816080105622, 14.718468072997508, 59.37934287682737, 7.797541931368973, 7.753020780712515, 8.491381948288183, 10.888572310209456, 11.101080232648595, 28.035192278830763, 9.566717476448755, 3.741698175202499, 25.912500792908567, 37.53392353785374, 18.715718500315162, 7.8547222870717555, 54.959455880669054, 4.272291727972192, 6.38345706779357, 20.76766633955386, 15.129503361838266, 9.919472169542107, 8.536750742579866, 83.24992008361642, 55.380990008060564, 19.8037584030302, 4.9978959728133825, 32.306862722237454, 103.12315293034628, 44.87645720987467, 22.944965543359725, 65.08375498390495, 26.609517942054854, 19.319973664436297, 43.15939404796224, 19.519608754406953, 5.430525857806275, 10.525817450707049, 7.504321546826528, 57.02052136010488, 86.75751020913795, 105.16261434142491, 37.6832494596333, 54.27249164869113, 30.301372096791148, 30.204150432888394, 12.900211405350468, 48.5485962428103, 8.315438020158078, 6.097571963944984, 60.56650078333068, 21.4512513059433, 22.816856688326215, 26.93547896126601, 49.204497832664, 31.759085398400043, 14.613193741060146, 19.6378977909418, 94.11280967782783, 15.42955628191817, 47.657228153199966, 24.327879106055946, 81.53251247654308, 77.80634875142044, 13.969154367888022, 93.7590468609702, 139.95929277087063, 28.63214371454142, 25.189269336474727, 101.37715553142903, 53.77641797357729, 75.37594975012799, 130.73291311992696, 50.30953128477353, 130.28574747785154, 82.28100806076912, 147.67914267835462, 38.35201836686301, 44.10443732659792, 86.90098275018936, 36.38013025790216, 52.30763534057394, 79.44537287710729, 60.30740792477133, 40.62589991987756, 71.46772849478675, 63.1956140296074, 78.37257372741266, 32.524332861894884, 73.8503470834714, 61.19509537939982, 89.79635917913981, 161.63713919896503, 45.78710746545932, 102.55371833423368, 96.2961978736476, 36.66577165038282, 47.58680209519494, 41.02797734079975, 54.95527686636471]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.366413494094665, "mean_inference_ms": 6.162465523601913, "mean_action_processing_ms": 1.0395276850844024, "mean_env_wait_ms": 0.8101781097057429, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013098478317260742, "StateBufferConnector_ms": 0.03673291206359863, "ViewRequirementAgentConnector_ms": 0.3561136722564697}, "num_episodes": 18, "episode_return_max": 373.21, "episode_return_min": -2.4627309237861015, "episode_return_mean": 235.52469795042066, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 768000, "num_agent_steps_trained": 768000, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 236.57297165542022, "num_env_steps_trained_throughput_per_sec": 236.57297165542022, "timesteps_total": 192000, "num_env_steps_sampled_lifetime": 192000, "num_agent_steps_sampled_lifetime": 768000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 768000, "timers": {"training_iteration_time_ms": 15682.174, "restore_workers_time_ms": 0.015, "training_step_time_ms": 15682.129, "sample_time_ms": 4031.072, "learn_time_ms": 11635.994, "learn_throughput": 343.761, "synch_weights_time_ms": 14.0}, "counters": {"num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 768000, "num_agent_steps_trained": 768000}, "done": false, "training_iteration": 48, "trial_id": "d163c_00000", "date": "2024-08-16_13-04-26", "timestamp": 1723793666, "time_this_iter_s": 16.912108898162842, "time_total_s": 886.6761198043823, "pid": 81201, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16b819f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 886.6761198043823, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 30.266666666666666, "ram_util_percent": 68.57083333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.4857606721618186, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.523569207721286, "policy_loss": -0.006685441347188932, "vf_loss": 8.529101276397705, "vf_explained_var": 0.03788616001290619, "kl": 0.007689193580201955, "entropy": 0.7977863873123492, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 91665.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.050981128405011, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.53866216316425, "policy_loss": -0.010372260466178574, "vf_loss": 9.54599413493323, "vf_explained_var": -0.004794889814639217, "kl": 0.015201312789778949, "entropy": 1.343120511183663, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 91665.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_agent_steps_sampled": 784000, "num_agent_steps_trained": 784000}, "env_runners": {"episode_reward_max": 367.2, "episode_reward_min": -6.091044313489103, "episode_reward_mean": 177.0599732913316, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -287.0921282823749, "predator_policy": 1.3169507913538643}, "policy_reward_max": {"prey_policy": 188.34453281273755, "predator_policy": 270.96206154771176}, "policy_reward_mean": {"prey_policy": 39.39766875459666, "predator_policy": 49.13231789106914}, "custom_metrics": {}, "hist_stats": {"episode_reward": [350.4556869825262, 304.00194137593735, 367.2, 268.38973395677436, 266.3452823063197, 310.8770744597567, 356.48014077291515, 299.80086187985484, 312.6163347590616, 344.0659424460505, 265.02166120952455, 292.7361878683772, 334.707643588874, 259.5406952152762, 255.17251177045537, 315.99137540681335, 261.5871567826823, 327.51621727712137, 261.50522233268964, 329.8521170720527, 294.6422478442971, 208.72932470588904, 195.93670351980109, 328.41806794304637, 274.37920879102614, 294.1817232141915, 282.5761877691118, 316.2746396983264, 165.34844299752808, 297.1508193256648, 323.637101410249, 289.65730717458234, 235.2595131844659, 320.5105695908279, 236.9732573645608, 222.432582795588, 271.14076973057604, 232.39902514758194, 295.8694755205693, 282.34180840947715, 165.39603549386774, 211.5042174734017, 92.87180354858745, 157.6467124006578, 236.60370560457733, 258.97012601684287, 332.86635456693034, 222.26640119750013, 70.90635714700811, 69.39976012982906, 212.18149426387606, 221.8360830136711, 301.7992670700395, 169.79844312655862, 168.2856907639195, 101.94638218605952, 237.75238740035275, -2.4627309237861015, 130.13231425189358, 56.44028159281929, 121.35313056703653, 67.60166703185037, 42.02009793477249, 76.43836260860853, 35.543829387955064, 46.35819393912273, 11.858195449030939, 64.6889664194067, 135.66192668545375, 137.85965406863048, 98.56636524181005, 16.623644484103636, 90.15193486438521, 34.463557352492806, 109.2120889395535, 27.522672614981463, 144.64451199884178, 69.11208826835201, 34.08819088771291, 287.5940853732047, 126.80660634079267, 67.98322813744596, -6.091044313489103, 60.66298666955872, 67.18735813645998, 7.291854122921938, 21.77614256844356, 262.5946822928046, 22.72124751326228, 7.1033052820863265, 81.32301296580508, 29.576579892220803, 15.968466399612227, 72.83611615173612, 21.15158804228251, 48.611172878768535, 146.95860622832376, 90.32638694219882, 29.244785093054094, 12.73743374653823], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [165.42430393822508, 170.19503340397713, 138.89905865100397, 141.43236632618022, 185.31003128315427, 179.2124860196672, 5.523976178665379, 188.34453281273755, 117.19431319722315, 101.24008437531252, 145.30367555665364, 139.90850366878198, 177.37405969099655, 160.09556079545257, 113.23176062992286, 159.7518040782296, 139.13076597952838, 150.01606083911415, 180.93196626483757, 135.88941254359537, 107.33203256831966, 126.71673373612678, 135.12724179358935, 104.81123662465556, 166.24577901817864, 157.41210549155636, 58.89353263737905, 73.8848202144716, 111.34642282021873, 102.00871762403698, 139.7483005839386, 154.65286942735935, 108.98314131559245, 130.8767592391153, 162.86347794294988, 137.9035447364339, 90.05798729517801, 151.5306818088706, 167.7208932961678, 125.30128587512912, 139.06274410142345, 132.44108969943045, 89.76856547586323, 50.29152340519546, 68.96972842795164, 90.13856074009202, 166.20250533280827, 146.4355555261484, 169.85043578646582, 82.14576382616467, 111.93950416280951, 160.91730981540636, 163.90013341785243, 66.96108351243382, 147.21514417041038, 139.45044145492488, 80.52153803069162, 55.826548000277725, 80.86815671680851, 142.18485165903155, 159.81380124237256, 148.272737455795, 153.8628655251519, 116.41448739093285, 108.69102921564027, 87.43221145734654, 151.32605190575381, 155.87610203342246, 86.79738233550779, 86.72945069829079, 82.89323826801527, 112.9689037401861, 109.12444344750377, 102.784578674431, 97.39989153557781, 107.84801020465657, 125.61221670805311, 145.20828328113552, 38.16859302811305, 152.3865445551677, 47.46421444431163, 42.74707263846533, 55.63139882190015, 118.56805995645071, -43.71409585702743, -11.413710734606239, 76.78707251617676, -7.169080642783662, 77.5971689535585, 113.07704504452772, 79.75663620150513, 116.53448701296846, 154.01153483114297, 162.8984764272742, 61.699795223839736, 96.04176306672893, -39.208421072561265, -81.80534633099346, -14.61521959093411, -7.940761387561183, 80.11840011958574, 71.55757161461071, 52.504396630747564, 107.88287873476257, 156.2507819517225, 131.13547513421395, 67.16390198631987, 20.61678905096473, 59.397524936145125, 59.13583017818205, 16.179461441251668, 4.803337513743795, 103.76295926282982, 99.738336605521, -63.26773049274025, -48.73736639079177, 49.38369635436568, 8.763510638272013, -8.04015934595511, -94.85842028918928, 22.89442476928069, -9.269495431102428, -30.446093498113857, -70.54367595544772, -16.179009231500217, -68.3673177016312, -5.785323975706019, -46.92868113939084, -91.19709741589145, -54.30151760085392, -113.66738150342735, -52.541180096070605, -77.52601287405125, -96.64695272213544, -82.66691486527475, 16.350461207894305, 30.584474754384704, 16.38968633259298, -12.693509033834935, 10.800382300586802, 9.320730342270672, -22.84799351512494, -82.97098479898902, -41.97355847392747, -11.597237063529057, -4.62550801745216, -90.19083828496586, -26.33705892108093, -72.67814974136878, -25.534007983502114, -66.92990930758596, -104.39733428531389, 29.16985323843685, 31.222085014827027, 11.524961285257298, -38.396127224069986, -158.90853776977278, -153.04604931033091, 56.935478243654636, 156.3195282634032, 57.854117466614916, -35.316530007652105, -5.505037773652195, -132.45986206844535, -81.46745261145301, -287.0921282823749, -103.94774075485259, -90.68170230201444, -5.367063065603266, -75.91202105772918, -73.72861128694085, -114.68180557090288, -27.10375673845232, -102.52340667828554, -76.76615416577103, 184.63025574625473, -71.38942942388127, -54.060853243132726, -107.47577201354467, -87.60091439852147, -150.6164560284132, -206.06195804581768, -118.86424277341499, -68.77004976744273, -167.27105931630027, -42.284072551239916, -28.398880560177826, -35.752235209521515, -35.52119209732136, -124.54027581286621, -78.35636860950493, -54.98004018699291, 5.557251868535579, 47.64752553529846, -40.06372918361011, -24.674915743492758, -60.39869583527117, -59.21052497850746, -75.75439182383576, -66.84326914629092], "policy_predator_policy_reward": [10.211174232069814, 4.625175408254085, 11.694238836225404, 11.976277562527773, 1.3169507913538643, 1.3605319058246663, 21.245173338915855, 53.27605162645533, 37.347313453078016, 10.563571280705983, 19.627335541905765, 6.037559692415396, 11.93596569275392, 7.074554593712071, 7.721976601637804, 19.095320570064477, 13.804581582010679, 9.664926358408406, 16.89680646803734, 10.347757169580145, 25.492125501186084, 5.480769403892136, 10.712515028921063, 42.085194421211284, 3.754421659205224, 7.295337419933806, 37.631122852870284, 89.13121951055525, 22.477041013150995, 19.34033031304866, 14.975576230184966, 6.6146291653304345, 8.860972248638292, 12.86628397933629, 6.293434944244435, 20.4557596534932, 6.937275355246255, 12.979277873394908, 25.06999761863648, 11.75994028211929, 17.241816292574782, 5.896597750868371, 53.941753602656036, 14.72748222217433, 15.422291465380443, 21.406122886378117, 10.931400181433332, 4.8486069026563925, 17.83075176857144, 4.552257409824371, 6.1434920456355115, 15.18141719034015, 43.83159361141904, 7.8833772274065055, 9.906512397696876, 19.70254167529434, 8.982196165502526, 20.01816080105622, 14.718468072997508, 59.37934287682737, 7.797541931368973, 7.753020780712515, 8.491381948288183, 10.888572310209456, 11.101080232648595, 28.035192278830763, 9.566717476448755, 3.741698175202499, 25.912500792908567, 37.53392353785374, 18.715718500315162, 7.8547222870717555, 54.959455880669054, 4.272291727972192, 6.38345706779357, 20.76766633955386, 15.129503361838266, 9.919472169542107, 8.536750742579866, 83.24992008361642, 55.380990008060564, 19.8037584030302, 4.9978959728133825, 32.306862722237454, 103.12315293034628, 44.87645720987467, 22.944965543359725, 65.08375498390495, 26.609517942054854, 19.319973664436297, 43.15939404796224, 19.519608754406953, 5.430525857806275, 10.525817450707049, 7.504321546826528, 57.02052136010488, 86.75751020913795, 105.16261434142491, 37.6832494596333, 54.27249164869113, 30.301372096791148, 30.204150432888394, 12.900211405350468, 48.5485962428103, 8.315438020158078, 6.097571963944984, 60.56650078333068, 21.4512513059433, 22.816856688326215, 26.93547896126601, 49.204497832664, 31.759085398400043, 14.613193741060146, 19.6378977909418, 94.11280967782783, 15.42955628191817, 47.657228153199966, 24.327879106055946, 81.53251247654308, 77.80634875142044, 13.969154367888022, 93.7590468609702, 139.95929277087063, 28.63214371454142, 25.189269336474727, 101.37715553142903, 53.77641797357729, 75.37594975012799, 130.73291311992696, 50.30953128477353, 130.28574747785154, 82.28100806076912, 147.67914267835462, 38.35201836686301, 44.10443732659792, 86.90098275018936, 36.38013025790216, 52.30763534057394, 79.44537287710729, 60.30740792477133, 40.62589991987756, 71.46772849478675, 63.1956140296074, 78.37257372741266, 32.524332861894884, 73.8503470834714, 61.19509537939982, 89.79635917913981, 161.63713919896503, 45.78710746545932, 102.55371833423368, 96.2961978736476, 36.66577165038282, 47.58680209519494, 41.02797734079975, 54.95527686636471, 167.47858709495284, 178.56419087286355, 33.60308585112746, 40.73599301501931, 53.16262216541079, 51.106396716419226, 121.76987373359769, 84.17825424594565, 270.96206154771176, 91.5064750326265, 91.60716009326737, 163.68526963315824, 108.77581400372617, 39.69062825606613, 111.2568383404403, 84.44543264032531, 43.143803067827704, 108.25950291735371, 49.384333682342714, 105.34624702997748, 79.03091644719781, 69.14061373307844, 129.45628524332082, 72.72370645083166, 224.4085960820249, 213.59283095801092, 113.71826460284821, 103.49260783023036, 43.38039637810341, 182.14320188904895, 95.78805257383436, 41.19917934760114, 97.91844844508462, 83.2946075073855, 111.04698104856614, 70.90060062670027, 25.219995303521532, 68.5338335209682, 89.90983529176182, 65.15519657753985, 63.94083036697886, 84.91317553985385, 31.650043146319796, 123.6850515703452]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.3608078663616445, "mean_inference_ms": 6.142762321343932, "mean_action_processing_ms": 1.036192750625109, "mean_env_wait_ms": 0.8079182830989415, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014410614967346191, "StateBufferConnector_ms": 0.02872014045715332, "ViewRequirementAgentConnector_ms": 0.3653916120529175}, "num_episodes": 22, "episode_return_max": 367.2, "episode_return_min": -6.091044313489103, "episode_return_mean": 177.0599732913316, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 784000, "num_agent_steps_trained": 784000, "num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 19.20737492887069, "num_env_steps_trained_throughput_per_sec": 19.20737492887069, "timesteps_total": 196000, "num_env_steps_sampled_lifetime": 196000, "num_agent_steps_sampled_lifetime": 784000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 784000, "timers": {"training_iteration_time_ms": 34991.643, "restore_workers_time_ms": 0.016, "training_step_time_ms": 34991.599, "sample_time_ms": 4127.56, "learn_time_ms": 30849.127, "learn_throughput": 129.663, "synch_weights_time_ms": 13.958}, "counters": {"num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_agent_steps_sampled": 784000, "num_agent_steps_trained": 784000}, "done": false, "training_iteration": 49, "trial_id": "d163c_00000", "date": "2024-08-16_13-07-55", "timestamp": 1723793875, "time_this_iter_s": 208.25655722618103, "time_total_s": 1094.9326770305634, "pid": 81201, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16b86dca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1094.9326770305634, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 38.360869565217385, "ram_util_percent": 68.7608695652174}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.615927386189264, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.279612255096435, "policy_loss": -0.005430042976513505, "vf_loss": 8.283765199701621, "vf_explained_var": 0.020315746466318767, "kl": 0.008513838675714612, "entropy": 0.752239690350477, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 93555.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.9930242961045925, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.589434714544387, "policy_loss": -0.009063613674327455, "vf_loss": 9.596293512980143, "vf_explained_var": 0.0016480430724128844, "kl": 0.011023994758661162, "entropy": 1.3241085756392705, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 93555.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_agent_steps_sampled": 800000, "num_agent_steps_trained": 800000}, "env_runners": {"episode_reward_max": 332.86635456693034, "episode_reward_min": -16.656501488314117, "episode_reward_mean": 117.49958799366894, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -287.0921282823749, "predator_policy": 3.741698175202499}, "policy_reward_max": {"prey_policy": 184.63025574625473, "predator_policy": 270.96206154771176}, "policy_reward_mean": {"prey_policy": -8.230423645941773, "predator_policy": 66.98021764277622}, "custom_metrics": {}, "hist_stats": {"episode_reward": [328.41806794304637, 274.37920879102614, 294.1817232141915, 282.5761877691118, 316.2746396983264, 165.34844299752808, 297.1508193256648, 323.637101410249, 289.65730717458234, 235.2595131844659, 320.5105695908279, 236.9732573645608, 222.432582795588, 271.14076973057604, 232.39902514758194, 295.8694755205693, 282.34180840947715, 165.39603549386774, 211.5042174734017, 92.87180354858745, 157.6467124006578, 236.60370560457733, 258.97012601684287, 332.86635456693034, 222.26640119750013, 70.90635714700811, 69.39976012982906, 212.18149426387606, 221.8360830136711, 301.7992670700395, 169.79844312655862, 168.2856907639195, 101.94638218605952, 237.75238740035275, -2.4627309237861015, 130.13231425189358, 56.44028159281929, 121.35313056703653, 67.60166703185037, 42.02009793477249, 76.43836260860853, 35.543829387955064, 46.35819393912273, 11.858195449030939, 64.6889664194067, 135.66192668545375, 137.85965406863048, 98.56636524181005, 16.623644484103636, 90.15193486438521, 34.463557352492806, 109.2120889395535, 27.522672614981463, 144.64451199884178, 69.11208826835201, 34.08819088771291, 287.5940853732047, 126.80660634079267, 67.98322813744596, -6.091044313489103, 60.66298666955872, 67.18735813645998, 7.291854122921938, 21.77614256844356, 262.5946822928046, 22.72124751326228, 7.1033052820863265, 81.32301296580508, 29.576579892220803, 15.968466399612227, 72.83611615173612, 21.15158804228251, 48.611172878768535, 146.95860622832376, 90.32638694219882, 29.244785093054094, 12.73743374653823, -16.656501488314117, 34.873054293409496, 53.9612943506792, 11.327537171326298, 39.28184186092254, 85.27587678990326, 12.43646292528645, 7.454127401947711, 64.11861049366867, 58.65666214705333, 15.15176519968488, -7.6459670005634015, 41.33880446445603, 24.98239253025796, 108.46293989163287, 108.04962647197137, 80.57090345912727, 24.294387539819944, 24.883853165434974, 14.979036835975142, 31.449448736429655, 2.11490069392645, 7.772475832744477], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [166.20250533280827, 146.4355555261484, 169.85043578646582, 82.14576382616467, 111.93950416280951, 160.91730981540636, 163.90013341785243, 66.96108351243382, 147.21514417041038, 139.45044145492488, 80.52153803069162, 55.826548000277725, 80.86815671680851, 142.18485165903155, 159.81380124237256, 148.272737455795, 153.8628655251519, 116.41448739093285, 108.69102921564027, 87.43221145734654, 151.32605190575381, 155.87610203342246, 86.79738233550779, 86.72945069829079, 82.89323826801527, 112.9689037401861, 109.12444344750377, 102.784578674431, 97.39989153557781, 107.84801020465657, 125.61221670805311, 145.20828328113552, 38.16859302811305, 152.3865445551677, 47.46421444431163, 42.74707263846533, 55.63139882190015, 118.56805995645071, -43.71409585702743, -11.413710734606239, 76.78707251617676, -7.169080642783662, 77.5971689535585, 113.07704504452772, 79.75663620150513, 116.53448701296846, 154.01153483114297, 162.8984764272742, 61.699795223839736, 96.04176306672893, -39.208421072561265, -81.80534633099346, -14.61521959093411, -7.940761387561183, 80.11840011958574, 71.55757161461071, 52.504396630747564, 107.88287873476257, 156.2507819517225, 131.13547513421395, 67.16390198631987, 20.61678905096473, 59.397524936145125, 59.13583017818205, 16.179461441251668, 4.803337513743795, 103.76295926282982, 99.738336605521, -63.26773049274025, -48.73736639079177, 49.38369635436568, 8.763510638272013, -8.04015934595511, -94.85842028918928, 22.89442476928069, -9.269495431102428, -30.446093498113857, -70.54367595544772, -16.179009231500217, -68.3673177016312, -5.785323975706019, -46.92868113939084, -91.19709741589145, -54.30151760085392, -113.66738150342735, -52.541180096070605, -77.52601287405125, -96.64695272213544, -82.66691486527475, 16.350461207894305, 30.584474754384704, 16.38968633259298, -12.693509033834935, 10.800382300586802, 9.320730342270672, -22.84799351512494, -82.97098479898902, -41.97355847392747, -11.597237063529057, -4.62550801745216, -90.19083828496586, -26.33705892108093, -72.67814974136878, -25.534007983502114, -66.92990930758596, -104.39733428531389, 29.16985323843685, 31.222085014827027, 11.524961285257298, -38.396127224069986, -158.90853776977278, -153.04604931033091, 56.935478243654636, 156.3195282634032, 57.854117466614916, -35.316530007652105, -5.505037773652195, -132.45986206844535, -81.46745261145301, -287.0921282823749, -103.94774075485259, -90.68170230201444, -5.367063065603266, -75.91202105772918, -73.72861128694085, -114.68180557090288, -27.10375673845232, -102.52340667828554, -76.76615416577103, 184.63025574625473, -71.38942942388127, -54.060853243132726, -107.47577201354467, -87.60091439852147, -150.6164560284132, -206.06195804581768, -118.86424277341499, -68.77004976744273, -167.27105931630027, -42.284072551239916, -28.398880560177826, -35.752235209521515, -35.52119209732136, -124.54027581286621, -78.35636860950493, -54.98004018699291, 5.557251868535579, 47.64752553529846, -40.06372918361011, -24.674915743492758, -60.39869583527117, -59.21052497850746, -75.75439182383576, -66.84326914629092, -81.14038258622207, -78.29395314053554, -191.9157552579359, -103.84812481950803, -46.34995350659646, -88.33074533010783, -96.04548944649943, -86.46412317999736, -3.0357581629576513, -56.11065130147767, -1.1498474517340722, -74.66138985494304, -47.567600905813876, -48.87624657179326, -83.38416980789354, -63.70645659816622, -5.235467147008954, -90.79282013823072, -88.66713385363359, -105.85316238088011, -100.53028180969036, -119.96474597506136, -66.63292415578788, -74.0921686737665, -56.597818842628065, -111.37156109825945, -82.64846355108861, -215.45186120287883, -149.87568131110584, 49.78848191384063, 45.965017736060574, -0.10839817962852488, -57.48209920163457, -90.92859272569598, -25.25226736622509, -42.97211117392209, -169.53506382069793, -130.64130833460575, -88.16834323775224, -59.19595336381465, -112.98798988407019, -53.18837846980523, -162.7649924344599, -65.89598851831369, -85.63273812638467, -79.52348472589054], "policy_predator_policy_reward": [10.931400181433332, 4.8486069026563925, 17.83075176857144, 4.552257409824371, 6.1434920456355115, 15.18141719034015, 43.83159361141904, 7.8833772274065055, 9.906512397696876, 19.70254167529434, 8.982196165502526, 20.01816080105622, 14.718468072997508, 59.37934287682737, 7.797541931368973, 7.753020780712515, 8.491381948288183, 10.888572310209456, 11.101080232648595, 28.035192278830763, 9.566717476448755, 3.741698175202499, 25.912500792908567, 37.53392353785374, 18.715718500315162, 7.8547222870717555, 54.959455880669054, 4.272291727972192, 6.38345706779357, 20.76766633955386, 15.129503361838266, 9.919472169542107, 8.536750742579866, 83.24992008361642, 55.380990008060564, 19.8037584030302, 4.9978959728133825, 32.306862722237454, 103.12315293034628, 44.87645720987467, 22.944965543359725, 65.08375498390495, 26.609517942054854, 19.319973664436297, 43.15939404796224, 19.519608754406953, 5.430525857806275, 10.525817450707049, 7.504321546826528, 57.02052136010488, 86.75751020913795, 105.16261434142491, 37.6832494596333, 54.27249164869113, 30.301372096791148, 30.204150432888394, 12.900211405350468, 48.5485962428103, 8.315438020158078, 6.097571963944984, 60.56650078333068, 21.4512513059433, 22.816856688326215, 26.93547896126601, 49.204497832664, 31.759085398400043, 14.613193741060146, 19.6378977909418, 94.11280967782783, 15.42955628191817, 47.657228153199966, 24.327879106055946, 81.53251247654308, 77.80634875142044, 13.969154367888022, 93.7590468609702, 139.95929277087063, 28.63214371454142, 25.189269336474727, 101.37715553142903, 53.77641797357729, 75.37594975012799, 130.73291311992696, 50.30953128477353, 130.28574747785154, 82.28100806076912, 147.67914267835462, 38.35201836686301, 44.10443732659792, 86.90098275018936, 36.38013025790216, 52.30763534057394, 79.44537287710729, 60.30740792477133, 40.62589991987756, 71.46772849478675, 63.1956140296074, 78.37257372741266, 32.524332861894884, 73.8503470834714, 61.19509537939982, 89.79635917913981, 161.63713919896503, 45.78710746545932, 102.55371833423368, 96.2961978736476, 36.66577165038282, 47.58680209519494, 41.02797734079975, 54.95527686636471, 167.47858709495284, 178.56419087286355, 33.60308585112746, 40.73599301501931, 53.16262216541079, 51.106396716419226, 121.76987373359769, 84.17825424594565, 270.96206154771176, 91.5064750326265, 91.60716009326737, 163.68526963315824, 108.77581400372617, 39.69062825606613, 111.2568383404403, 84.44543264032531, 43.143803067827704, 108.25950291735371, 49.384333682342714, 105.34624702997748, 79.03091644719781, 69.14061373307844, 129.45628524332082, 72.72370645083166, 224.4085960820249, 213.59283095801092, 113.71826460284821, 103.49260783023036, 43.38039637810341, 182.14320188904895, 95.78805257383436, 41.19917934760114, 97.91844844508462, 83.2946075073855, 111.04698104856614, 70.90060062670027, 25.219995303521532, 68.5338335209682, 89.90983529176182, 65.15519657753985, 63.94083036697886, 84.91317553985385, 31.650043146319796, 123.6850515703452, 122.26890542936076, 20.508928809082782, 186.75020510742024, 143.88672926343324, 88.02527291025962, 100.61672027712389, 78.13939909090948, 115.69775070691382, 47.93552505452457, 50.492726270833266, 116.52598175859558, 44.561132337984795, 44.04301010107661, 64.83730030181705, 66.47278147496849, 88.07197233303903, 102.79623832658316, 57.35065945232526, 59.14516042284688, 194.0317979587202, 130.0478874596339, 105.59890552480265, 61.804869997961994, 71.27425583102898, 92.78888008257053, 116.51930432277304, 192.72537226531185, 130.35734501891372, 112.4832863126227, 96.06685297627523, 21.598307239822347, 40.59469967571701, 82.26850129284674, 146.7130940936111, 53.94047212071888, 38.5782939592483, 204.8439218444962, 120.21630347624257, 62.79151334549867, 99.55182009204339, 71.89940584842779, 125.72641124187724, 90.74910267673238, 140.026778969968, 103.8394093838431, 69.08928930117656]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.354352648564838, "mean_inference_ms": 6.122448971731858, "mean_action_processing_ms": 1.0317091493857744, "mean_env_wait_ms": 0.8046675144053711, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014116525650024414, "StateBufferConnector_ms": 0.027631759643554688, "ViewRequirementAgentConnector_ms": 0.35896730422973633}, "num_episodes": 23, "episode_return_max": 332.86635456693034, "episode_return_min": -16.656501488314117, "episode_return_mean": 117.49958799366894, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 800000, "num_agent_steps_trained": 800000, "num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 224.07980808747135, "num_env_steps_trained_throughput_per_sec": 224.07980808747135, "timesteps_total": 200000, "num_env_steps_sampled_lifetime": 200000, "num_agent_steps_sampled_lifetime": 800000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 800000, "timers": {"training_iteration_time_ms": 35142.327, "restore_workers_time_ms": 0.014, "training_step_time_ms": 35142.286, "sample_time_ms": 4023.355, "learn_time_ms": 31103.858, "learn_throughput": 128.601, "synch_weights_time_ms": 14.117}, "counters": {"num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_agent_steps_sampled": 800000, "num_agent_steps_trained": 800000}, "done": false, "training_iteration": 50, "trial_id": "d163c_00000", "date": "2024-08-16_13-08-13", "timestamp": 1723793893, "time_this_iter_s": 17.85529112815857, "time_total_s": 1112.787968158722, "pid": 81201, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16b87c4c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1112.787968158722, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 25.887999999999998, "ram_util_percent": 68.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.434976397304939, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.858327505323622, "policy_loss": -0.006225771251474581, "vf_loss": 7.863184468203752, "vf_explained_var": 0.12805872912760133, "kl": 0.009125388136968112, "entropy": 0.7451937595372478, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 95445.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.4382702333901927, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.438910290551563, "policy_loss": -0.008343356452813302, "vf_loss": 9.445060166353901, "vf_explained_var": 0.005412183583728851, "kl": 0.010967210990774431, "entropy": 1.2977534516147835, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 95445.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_agent_steps_sampled": 816000, "num_agent_steps_trained": 816000}, "env_runners": {"episode_reward_max": 332.86635456693034, "episode_reward_min": -16.656501488314117, "episode_reward_mean": 89.35573021533975, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -287.0921282823749, "predator_policy": 4.9978959728133825}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 270.96206154771176}, "policy_reward_mean": {"prey_policy": -34.93881095203457, "predator_policy": 79.61667605970445}, "custom_metrics": {}, "hist_stats": {"episode_reward": [211.5042174734017, 92.87180354858745, 157.6467124006578, 236.60370560457733, 258.97012601684287, 332.86635456693034, 222.26640119750013, 70.90635714700811, 69.39976012982906, 212.18149426387606, 221.8360830136711, 301.7992670700395, 169.79844312655862, 168.2856907639195, 101.94638218605952, 237.75238740035275, -2.4627309237861015, 130.13231425189358, 56.44028159281929, 121.35313056703653, 67.60166703185037, 42.02009793477249, 76.43836260860853, 35.543829387955064, 46.35819393912273, 11.858195449030939, 64.6889664194067, 135.66192668545375, 137.85965406863048, 98.56636524181005, 16.623644484103636, 90.15193486438521, 34.463557352492806, 109.2120889395535, 27.522672614981463, 144.64451199884178, 69.11208826835201, 34.08819088771291, 287.5940853732047, 126.80660634079267, 67.98322813744596, -6.091044313489103, 60.66298666955872, 67.18735813645998, 7.291854122921938, 21.77614256844356, 262.5946822928046, 22.72124751326228, 7.1033052820863265, 81.32301296580508, 29.576579892220803, 15.968466399612227, 72.83611615173612, 21.15158804228251, 48.611172878768535, 146.95860622832376, 90.32638694219882, 29.244785093054094, 12.73743374653823, -16.656501488314117, 34.873054293409496, 53.9612943506792, 11.327537171326298, 39.28184186092254, 85.27587678990326, 12.43646292528645, 7.454127401947711, 64.11861049366867, 58.65666214705333, 15.15176519968488, -7.6459670005634015, 41.33880446445603, 24.98239253025796, 108.46293989163287, 108.04962647197137, 80.57090345912727, 24.294387539819944, 24.883853165434974, 14.979036835975142, 31.449448736429655, 2.11490069392645, 7.772475832744477, 116.36276612021383, 56.56001915007211, 52.854672278547056, 178.74512141206384, 92.20497408903977, 99.45611120561237, 237.0467902001985, 218.84904286654577, 11.478698026970427, 86.52862705438844, 95.64296328539425, 40.07696957324709, 313.99771265470577, 133.82423937092017, 12.969588973448362, 103.40243560162882, 24.44066467222266, 145.1193611931044], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [55.63139882190015, 118.56805995645071, -43.71409585702743, -11.413710734606239, 76.78707251617676, -7.169080642783662, 77.5971689535585, 113.07704504452772, 79.75663620150513, 116.53448701296846, 154.01153483114297, 162.8984764272742, 61.699795223839736, 96.04176306672893, -39.208421072561265, -81.80534633099346, -14.61521959093411, -7.940761387561183, 80.11840011958574, 71.55757161461071, 52.504396630747564, 107.88287873476257, 156.2507819517225, 131.13547513421395, 67.16390198631987, 20.61678905096473, 59.397524936145125, 59.13583017818205, 16.179461441251668, 4.803337513743795, 103.76295926282982, 99.738336605521, -63.26773049274025, -48.73736639079177, 49.38369635436568, 8.763510638272013, -8.04015934595511, -94.85842028918928, 22.89442476928069, -9.269495431102428, -30.446093498113857, -70.54367595544772, -16.179009231500217, -68.3673177016312, -5.785323975706019, -46.92868113939084, -91.19709741589145, -54.30151760085392, -113.66738150342735, -52.541180096070605, -77.52601287405125, -96.64695272213544, -82.66691486527475, 16.350461207894305, 30.584474754384704, 16.38968633259298, -12.693509033834935, 10.800382300586802, 9.320730342270672, -22.84799351512494, -82.97098479898902, -41.97355847392747, -11.597237063529057, -4.62550801745216, -90.19083828496586, -26.33705892108093, -72.67814974136878, -25.534007983502114, -66.92990930758596, -104.39733428531389, 29.16985323843685, 31.222085014827027, 11.524961285257298, -38.396127224069986, -158.90853776977278, -153.04604931033091, 56.935478243654636, 156.3195282634032, 57.854117466614916, -35.316530007652105, -5.505037773652195, -132.45986206844535, -81.46745261145301, -287.0921282823749, -103.94774075485259, -90.68170230201444, -5.367063065603266, -75.91202105772918, -73.72861128694085, -114.68180557090288, -27.10375673845232, -102.52340667828554, -76.76615416577103, 184.63025574625473, -71.38942942388127, -54.060853243132726, -107.47577201354467, -87.60091439852147, -150.6164560284132, -206.06195804581768, -118.86424277341499, -68.77004976744273, -167.27105931630027, -42.284072551239916, -28.398880560177826, -35.752235209521515, -35.52119209732136, -124.54027581286621, -78.35636860950493, -54.98004018699291, 5.557251868535579, 47.64752553529846, -40.06372918361011, -24.674915743492758, -60.39869583527117, -59.21052497850746, -75.75439182383576, -66.84326914629092, -81.14038258622207, -78.29395314053554, -191.9157552579359, -103.84812481950803, -46.34995350659646, -88.33074533010783, -96.04548944649943, -86.46412317999736, -3.0357581629576513, -56.11065130147767, -1.1498474517340722, -74.66138985494304, -47.567600905813876, -48.87624657179326, -83.38416980789354, -63.70645659816622, -5.235467147008954, -90.79282013823072, -88.66713385363359, -105.85316238088011, -100.53028180969036, -119.96474597506136, -66.63292415578788, -74.0921686737665, -56.597818842628065, -111.37156109825945, -82.64846355108861, -215.45186120287883, -149.87568131110584, 49.78848191384063, 45.965017736060574, -0.10839817962852488, -57.48209920163457, -90.92859272569598, -25.25226736622509, -42.97211117392209, -169.53506382069793, -130.64130833460575, -88.16834323775224, -59.19595336381465, -112.98798988407019, -53.18837846980523, -162.7649924344599, -65.89598851831369, -85.63273812638467, -79.52348472589054, 20.907080595093696, -2.782442984883171, -4.72037446024875, -92.65299435512816, -149.1120853348392, -237.00777505906834, 36.69598067022883, 58.96482127269557, -108.81042333601094, -1.955395269029914, -68.66251483584149, -25.312556462314138, 135.52329160690493, -153.3247528718195, 30.814937556957243, 116.43670200391595, -162.99465618680935, -71.79795777205668, -52.5021955712321, -27.66076591204969, -117.93278401131403, 18.380137623849684, -71.62986694523246, -33.57145122160031, 60.02936203841631, 200.0, 1.0842523142983165, 62.66151789639665, -103.28926992636434, -94.84692598908605, 50.08367268689515, -114.88516721063503, -138.35001754779216, -95.31368788802364, 52.00687388273718, -121.90894901750706], "policy_predator_policy_reward": [4.9978959728133825, 32.306862722237454, 103.12315293034628, 44.87645720987467, 22.944965543359725, 65.08375498390495, 26.609517942054854, 19.319973664436297, 43.15939404796224, 19.519608754406953, 5.430525857806275, 10.525817450707049, 7.504321546826528, 57.02052136010488, 86.75751020913795, 105.16261434142491, 37.6832494596333, 54.27249164869113, 30.301372096791148, 30.204150432888394, 12.900211405350468, 48.5485962428103, 8.315438020158078, 6.097571963944984, 60.56650078333068, 21.4512513059433, 22.816856688326215, 26.93547896126601, 49.204497832664, 31.759085398400043, 14.613193741060146, 19.6378977909418, 94.11280967782783, 15.42955628191817, 47.657228153199966, 24.327879106055946, 81.53251247654308, 77.80634875142044, 13.969154367888022, 93.7590468609702, 139.95929277087063, 28.63214371454142, 25.189269336474727, 101.37715553142903, 53.77641797357729, 75.37594975012799, 130.73291311992696, 50.30953128477353, 130.28574747785154, 82.28100806076912, 147.67914267835462, 38.35201836686301, 44.10443732659792, 86.90098275018936, 36.38013025790216, 52.30763534057394, 79.44537287710729, 60.30740792477133, 40.62589991987756, 71.46772849478675, 63.1956140296074, 78.37257372741266, 32.524332861894884, 73.8503470834714, 61.19509537939982, 89.79635917913981, 161.63713919896503, 45.78710746545932, 102.55371833423368, 96.2961978736476, 36.66577165038282, 47.58680209519494, 41.02797734079975, 54.95527686636471, 167.47858709495284, 178.56419087286355, 33.60308585112746, 40.73599301501931, 53.16262216541079, 51.106396716419226, 121.76987373359769, 84.17825424594565, 270.96206154771176, 91.5064750326265, 91.60716009326737, 163.68526963315824, 108.77581400372617, 39.69062825606613, 111.2568383404403, 84.44543264032531, 43.143803067827704, 108.25950291735371, 49.384333682342714, 105.34624702997748, 79.03091644719781, 69.14061373307844, 129.45628524332082, 72.72370645083166, 224.4085960820249, 213.59283095801092, 113.71826460284821, 103.49260783023036, 43.38039637810341, 182.14320188904895, 95.78805257383436, 41.19917934760114, 97.91844844508462, 83.2946075073855, 111.04698104856614, 70.90060062670027, 25.219995303521532, 68.5338335209682, 89.90983529176182, 65.15519657753985, 63.94083036697886, 84.91317553985385, 31.650043146319796, 123.6850515703452, 122.26890542936076, 20.508928809082782, 186.75020510742024, 143.88672926343324, 88.02527291025962, 100.61672027712389, 78.13939909090948, 115.69775070691382, 47.93552505452457, 50.492726270833266, 116.52598175859558, 44.561132337984795, 44.04301010107661, 64.83730030181705, 66.47278147496849, 88.07197233303903, 102.79623832658316, 57.35065945232526, 59.14516042284688, 194.0317979587202, 130.0478874596339, 105.59890552480265, 61.804869997961994, 71.27425583102898, 92.78888008257053, 116.51930432277304, 192.72537226531185, 130.35734501891372, 112.4832863126227, 96.06685297627523, 21.598307239822347, 40.59469967571701, 82.26850129284674, 146.7130940936111, 53.94047212071888, 38.5782939592483, 204.8439218444962, 120.21630347624257, 62.79151334549867, 99.55182009204339, 71.89940584842779, 125.72641124187724, 90.74910267673238, 140.026778969968, 103.8394093838431, 69.08928930117656, 42.73839398942218, 55.49973452058091, 92.26516070373543, 61.668227261713625, 192.48421004400765, 246.4903226284472, 16.625739724459493, 66.45857974468001, 87.376886887204, 115.59390580687673, 118.69349925286646, 74.73768325090145, 176.54205539250043, 78.30619607261265, 34.02702890680081, 37.570374398871856, 99.55227849046368, 146.7190334953727, 45.149801843937, 121.5417866937333, 165.12402270531578, 30.071586967543038, 68.68814245523387, 76.590145284846, 23.473342253937993, 30.49500836235143, 32.05193473478321, 38.026534425442065, 131.52755621712103, 79.57822867177788, 38.26193503221389, 129.9419950931547, 145.15859150023482, 112.94577860780376, 134.9707185499267, 80.05071777794757]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.3475566793343754, "mean_inference_ms": 6.10674903918793, "mean_action_processing_ms": 1.0298558189167277, "mean_env_wait_ms": 0.8025613431465543, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012871026992797852, "StateBufferConnector_ms": 0.019827961921691895, "ViewRequirementAgentConnector_ms": 0.38066303730010986}, "num_episodes": 18, "episode_return_max": 332.86635456693034, "episode_return_min": -16.656501488314117, "episode_return_mean": 89.35573021533975, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 816000, "num_agent_steps_trained": 816000, "num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 218.37475254347277, "num_env_steps_trained_throughput_per_sec": 218.37475254347277, "timesteps_total": 204000, "num_env_steps_sampled_lifetime": 204000, "num_agent_steps_sampled_lifetime": 816000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 816000, "timers": {"training_iteration_time_ms": 35419.798, "restore_workers_time_ms": 0.014, "training_step_time_ms": 35419.756, "sample_time_ms": 4064.031, "learn_time_ms": 31340.463, "learn_throughput": 127.631, "synch_weights_time_ms": 14.315}, "counters": {"num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_agent_steps_sampled": 816000, "num_agent_steps_trained": 816000}, "done": false, "training_iteration": 51, "trial_id": "d163c_00000", "date": "2024-08-16_13-08-31", "timestamp": 1723793911, "time_this_iter_s": 18.32254910469055, "time_total_s": 1131.1105172634125, "pid": 81201, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16b839310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1131.1105172634125, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 26.49230769230769, "ram_util_percent": 68.49615384615385}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.006295153640566, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.206699125602762, "policy_loss": -0.0037786452714403075, "vf_loss": 7.209671021012402, "vf_explained_var": 0.04794045541652296, "kl": 0.005378399231501869, "entropy": 0.6972003657351096, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 97335.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1927783407546855, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.393954654471584, "policy_loss": -0.0072979949567486685, "vf_loss": 9.398714315828192, "vf_explained_var": 0.015712908651462937, "kl": 0.012691607740995444, "entropy": 1.3038430765823081, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 97335.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_agent_steps_sampled": 832000, "num_agent_steps_trained": 832000}, "env_runners": {"episode_reward_max": 313.99771265470577, "episode_reward_min": -16.922156175077305, "episode_reward_mean": 75.99811137904575, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -287.0921282823749, "predator_policy": 1.2154456411376007}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 275.29966442462523}, "policy_reward_mean": {"prey_policy": -52.780230384842426, "predator_policy": 90.77928607436529}, "custom_metrics": {}, "hist_stats": {"episode_reward": [56.44028159281929, 121.35313056703653, 67.60166703185037, 42.02009793477249, 76.43836260860853, 35.543829387955064, 46.35819393912273, 11.858195449030939, 64.6889664194067, 135.66192668545375, 137.85965406863048, 98.56636524181005, 16.623644484103636, 90.15193486438521, 34.463557352492806, 109.2120889395535, 27.522672614981463, 144.64451199884178, 69.11208826835201, 34.08819088771291, 287.5940853732047, 126.80660634079267, 67.98322813744596, -6.091044313489103, 60.66298666955872, 67.18735813645998, 7.291854122921938, 21.77614256844356, 262.5946822928046, 22.72124751326228, 7.1033052820863265, 81.32301296580508, 29.576579892220803, 15.968466399612227, 72.83611615173612, 21.15158804228251, 48.611172878768535, 146.95860622832376, 90.32638694219882, 29.244785093054094, 12.73743374653823, -16.656501488314117, 34.873054293409496, 53.9612943506792, 11.327537171326298, 39.28184186092254, 85.27587678990326, 12.43646292528645, 7.454127401947711, 64.11861049366867, 58.65666214705333, 15.15176519968488, -7.6459670005634015, 41.33880446445603, 24.98239253025796, 108.46293989163287, 108.04962647197137, 80.57090345912727, 24.294387539819944, 24.883853165434974, 14.979036835975142, 31.449448736429655, 2.11490069392645, 7.772475832744477, 116.36276612021383, 56.56001915007211, 52.854672278547056, 178.74512141206384, 92.20497408903977, 99.45611120561237, 237.0467902001985, 218.84904286654577, 11.478698026970427, 86.52862705438844, 95.64296328539425, 40.07696957324709, 313.99771265470577, 133.82423937092017, 12.969588973448362, 103.40243560162882, 24.44066467222266, 145.1193611931044, 61.237903885168784, 181.62180861970688, 74.4997746771282, 162.1228727758639, 108.97423805776555, -15.40690608165841, 144.86464903046527, 106.64411588201405, 86.63823162296131, 78.75689617644389, 168.6115099793194, 69.02791473076606, 18.68488920884738, -16.922156175077305, 234.60432387515604, 224.98653216070343, 56.010835812515396, 113.58545137042847], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-8.04015934595511, -94.85842028918928, 22.89442476928069, -9.269495431102428, -30.446093498113857, -70.54367595544772, -16.179009231500217, -68.3673177016312, -5.785323975706019, -46.92868113939084, -91.19709741589145, -54.30151760085392, -113.66738150342735, -52.541180096070605, -77.52601287405125, -96.64695272213544, -82.66691486527475, 16.350461207894305, 30.584474754384704, 16.38968633259298, -12.693509033834935, 10.800382300586802, 9.320730342270672, -22.84799351512494, -82.97098479898902, -41.97355847392747, -11.597237063529057, -4.62550801745216, -90.19083828496586, -26.33705892108093, -72.67814974136878, -25.534007983502114, -66.92990930758596, -104.39733428531389, 29.16985323843685, 31.222085014827027, 11.524961285257298, -38.396127224069986, -158.90853776977278, -153.04604931033091, 56.935478243654636, 156.3195282634032, 57.854117466614916, -35.316530007652105, -5.505037773652195, -132.45986206844535, -81.46745261145301, -287.0921282823749, -103.94774075485259, -90.68170230201444, -5.367063065603266, -75.91202105772918, -73.72861128694085, -114.68180557090288, -27.10375673845232, -102.52340667828554, -76.76615416577103, 184.63025574625473, -71.38942942388127, -54.060853243132726, -107.47577201354467, -87.60091439852147, -150.6164560284132, -206.06195804581768, -118.86424277341499, -68.77004976744273, -167.27105931630027, -42.284072551239916, -28.398880560177826, -35.752235209521515, -35.52119209732136, -124.54027581286621, -78.35636860950493, -54.98004018699291, 5.557251868535579, 47.64752553529846, -40.06372918361011, -24.674915743492758, -60.39869583527117, -59.21052497850746, -75.75439182383576, -66.84326914629092, -81.14038258622207, -78.29395314053554, -191.9157552579359, -103.84812481950803, -46.34995350659646, -88.33074533010783, -96.04548944649943, -86.46412317999736, -3.0357581629576513, -56.11065130147767, -1.1498474517340722, -74.66138985494304, -47.567600905813876, -48.87624657179326, -83.38416980789354, -63.70645659816622, -5.235467147008954, -90.79282013823072, -88.66713385363359, -105.85316238088011, -100.53028180969036, -119.96474597506136, -66.63292415578788, -74.0921686737665, -56.597818842628065, -111.37156109825945, -82.64846355108861, -215.45186120287883, -149.87568131110584, 49.78848191384063, 45.965017736060574, -0.10839817962852488, -57.48209920163457, -90.92859272569598, -25.25226736622509, -42.97211117392209, -169.53506382069793, -130.64130833460575, -88.16834323775224, -59.19595336381465, -112.98798988407019, -53.18837846980523, -162.7649924344599, -65.89598851831369, -85.63273812638467, -79.52348472589054, 20.907080595093696, -2.782442984883171, -4.72037446024875, -92.65299435512816, -149.1120853348392, -237.00777505906834, 36.69598067022883, 58.96482127269557, -108.81042333601094, -1.955395269029914, -68.66251483584149, -25.312556462314138, 135.52329160690493, -153.3247528718195, 30.814937556957243, 116.43670200391595, -162.99465618680935, -71.79795777205668, -52.5021955712321, -27.66076591204969, -117.93278401131403, 18.380137623849684, -71.62986694523246, -33.57145122160031, 60.02936203841631, 200.0, 1.0842523142983165, 62.66151789639665, -103.28926992636434, -94.84692598908605, 50.08367268689515, -114.88516721063503, -138.35001754779216, -95.31368788802364, 52.00687388273718, -121.90894901750706, -168.58245126969007, -4.197642370590144, -2.4975933726790758, 94.08782895624563, -46.07611206854352, 16.636596105640372, -42.542642611997685, 4.78120297062593, 35.97627296441859, -97.39688413752825, -242.1444313444871, -215.64928356366752, -43.25875467549268, 92.46068142723536, 8.538374560354558, 21.145730129768427, -136.37165071833394, 4.941108189610758, -113.04335813118327, -8.94110903740161, 121.62457297329236, -94.78412156673791, -75.73995937690799, -25.39346901044698, -216.04054149449613, -34.98411651936638, -125.40518359728567, -175.16010545874414, 110.72584938112061, -78.78290364746617, 34.62750799107316, 104.16888732395901, -77.04361254110505, -73.49960890954921, -159.24915213678776, -78.08725426511299], "policy_predator_policy_reward": [81.53251247654308, 77.80634875142044, 13.969154367888022, 93.7590468609702, 139.95929277087063, 28.63214371454142, 25.189269336474727, 101.37715553142903, 53.77641797357729, 75.37594975012799, 130.73291311992696, 50.30953128477353, 130.28574747785154, 82.28100806076912, 147.67914267835462, 38.35201836686301, 44.10443732659792, 86.90098275018936, 36.38013025790216, 52.30763534057394, 79.44537287710729, 60.30740792477133, 40.62589991987756, 71.46772849478675, 63.1956140296074, 78.37257372741266, 32.524332861894884, 73.8503470834714, 61.19509537939982, 89.79635917913981, 161.63713919896503, 45.78710746545932, 102.55371833423368, 96.2961978736476, 36.66577165038282, 47.58680209519494, 41.02797734079975, 54.95527686636471, 167.47858709495284, 178.56419087286355, 33.60308585112746, 40.73599301501931, 53.16262216541079, 51.106396716419226, 121.76987373359769, 84.17825424594565, 270.96206154771176, 91.5064750326265, 91.60716009326737, 163.68526963315824, 108.77581400372617, 39.69062825606613, 111.2568383404403, 84.44543264032531, 43.143803067827704, 108.25950291735371, 49.384333682342714, 105.34624702997748, 79.03091644719781, 69.14061373307844, 129.45628524332082, 72.72370645083166, 224.4085960820249, 213.59283095801092, 113.71826460284821, 103.49260783023036, 43.38039637810341, 182.14320188904895, 95.78805257383436, 41.19917934760114, 97.91844844508462, 83.2946075073855, 111.04698104856614, 70.90060062670027, 25.219995303521532, 68.5338335209682, 89.90983529176182, 65.15519657753985, 63.94083036697886, 84.91317553985385, 31.650043146319796, 123.6850515703452, 122.26890542936076, 20.508928809082782, 186.75020510742024, 143.88672926343324, 88.02527291025962, 100.61672027712389, 78.13939909090948, 115.69775070691382, 47.93552505452457, 50.492726270833266, 116.52598175859558, 44.561132337984795, 44.04301010107661, 64.83730030181705, 66.47278147496849, 88.07197233303903, 102.79623832658316, 57.35065945232526, 59.14516042284688, 194.0317979587202, 130.0478874596339, 105.59890552480265, 61.804869997961994, 71.27425583102898, 92.78888008257053, 116.51930432277304, 192.72537226531185, 130.35734501891372, 112.4832863126227, 96.06685297627523, 21.598307239822347, 40.59469967571701, 82.26850129284674, 146.7130940936111, 53.94047212071888, 38.5782939592483, 204.8439218444962, 120.21630347624257, 62.79151334549867, 99.55182009204339, 71.89940584842779, 125.72641124187724, 90.74910267673238, 140.026778969968, 103.8394093838431, 69.08928930117656, 42.73839398942218, 55.49973452058091, 92.26516070373543, 61.668227261713625, 192.48421004400765, 246.4903226284472, 16.625739724459493, 66.45857974468001, 87.376886887204, 115.59390580687673, 118.69349925286646, 74.73768325090145, 176.54205539250043, 78.30619607261265, 34.02702890680081, 37.570374398871856, 99.55227849046368, 146.7190334953727, 45.149801843937, 121.5417866937333, 165.12402270531578, 30.071586967543038, 68.68814245523387, 76.590145284846, 23.473342253937993, 30.49500836235143, 32.05193473478321, 38.026534425442065, 131.52755621712103, 79.57822867177788, 38.26193503221389, 129.9419950931547, 145.15859150023482, 112.94577860780376, 134.9707185499267, 80.05071777794757, 178.37335051228513, 55.644647013163954, 48.43438753028466, 41.59718550585583, 60.5474244228823, 43.391866217149065, 103.04009984291642, 96.8442125743192, 71.52264221193097, 98.87220701894418, 167.08714440187114, 275.29966442462523, 46.808283895391604, 48.854438383330894, 18.5312070765491, 58.428804115342025, 74.23293060855464, 143.83584354312976, 96.24269067499004, 104.49867267003876, 81.22239049797962, 60.54866807478521, 68.64440019791721, 101.5169429202039, 268.4941015815722, 1.2154456411376007, 85.28799563452748, 198.35513724642513, 145.99869172228594, 56.66268641921583, 43.1265339899828, 43.06360285568854, 102.91234211171458, 103.64171515145517, 224.7826987986784, 126.13915897365109]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.342737016392974, "mean_inference_ms": 6.094584400674568, "mean_action_processing_ms": 1.027399460843279, "mean_env_wait_ms": 0.8011207237708624, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01746213436126709, "StateBufferConnector_ms": 0.018096089363098145, "ViewRequirementAgentConnector_ms": 0.36504149436950684}, "num_episodes": 18, "episode_return_max": 313.99771265470577, "episode_return_min": -16.922156175077305, "episode_return_mean": 75.99811137904575, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 832000, "num_agent_steps_trained": 832000, "num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 15.886766773472399, "num_env_steps_trained_throughput_per_sec": 15.886766773472399, "timesteps_total": 208000, "num_env_steps_sampled_lifetime": 208000, "num_agent_steps_sampled_lifetime": 832000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 832000, "timers": {"training_iteration_time_ms": 59024.018, "restore_workers_time_ms": 0.014, "training_step_time_ms": 59023.975, "sample_time_ms": 4135.874, "learn_time_ms": 54872.191, "learn_throughput": 72.897, "synch_weights_time_ms": 14.95}, "counters": {"num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_agent_steps_sampled": 832000, "num_agent_steps_trained": 832000}, "done": false, "training_iteration": 52, "trial_id": "d163c_00000", "date": "2024-08-16_13-12-43", "timestamp": 1723794163, "time_this_iter_s": 251.7905192375183, "time_total_s": 1382.9010365009308, "pid": 81201, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16b839e50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1382.9010365009308, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 46.724999999999994, "ram_util_percent": 71.32222222222224}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.358822615373702, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.897597476666567, "policy_loss": -0.00699496497547934, "vf_loss": 7.903531942418013, "vf_explained_var": 0.10423616259186357, "kl": 0.007070182450187977, "entropy": 0.663889884412604, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 99225.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1378892653202883, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.35256685933108, "policy_loss": -0.0066730806461126405, "vf_loss": 9.357575328766353, "vf_explained_var": 0.04774513600995301, "kl": 0.008322902691877975, "entropy": 1.2457389649890718, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 99225.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_agent_steps_sampled": 848000, "num_agent_steps_trained": 848000}, "env_runners": {"episode_reward_max": 331.1651539770046, "episode_reward_min": -16.922156175077305, "episode_reward_mean": 87.12725766602735, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -287.0921282823749, "predator_policy": 1.2154456411376007}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 352.4972847251733}, "policy_reward_mean": {"prey_policy": -48.201802552934225, "predator_policy": 91.76543138594792}, "custom_metrics": {}, "hist_stats": {"episode_reward": [69.11208826835201, 34.08819088771291, 287.5940853732047, 126.80660634079267, 67.98322813744596, -6.091044313489103, 60.66298666955872, 67.18735813645998, 7.291854122921938, 21.77614256844356, 262.5946822928046, 22.72124751326228, 7.1033052820863265, 81.32301296580508, 29.576579892220803, 15.968466399612227, 72.83611615173612, 21.15158804228251, 48.611172878768535, 146.95860622832376, 90.32638694219882, 29.244785093054094, 12.73743374653823, -16.656501488314117, 34.873054293409496, 53.9612943506792, 11.327537171326298, 39.28184186092254, 85.27587678990326, 12.43646292528645, 7.454127401947711, 64.11861049366867, 58.65666214705333, 15.15176519968488, -7.6459670005634015, 41.33880446445603, 24.98239253025796, 108.46293989163287, 108.04962647197137, 80.57090345912727, 24.294387539819944, 24.883853165434974, 14.979036835975142, 31.449448736429655, 2.11490069392645, 7.772475832744477, 116.36276612021383, 56.56001915007211, 52.854672278547056, 178.74512141206384, 92.20497408903977, 99.45611120561237, 237.0467902001985, 218.84904286654577, 11.478698026970427, 86.52862705438844, 95.64296328539425, 40.07696957324709, 313.99771265470577, 133.82423937092017, 12.969588973448362, 103.40243560162882, 24.44066467222266, 145.1193611931044, 61.237903885168784, 181.62180861970688, 74.4997746771282, 162.1228727758639, 108.97423805776555, -15.40690608165841, 144.86464903046527, 106.64411588201405, 86.63823162296131, 78.75689617644389, 168.6115099793194, 69.02791473076606, 18.68488920884738, -16.922156175077305, 234.60432387515604, 224.98653216070343, 56.010835812515396, 113.58545137042847, 48.64088856209137, 9.831135571109112, 316.2576647869647, 311.9893699617341, 154.92694840505814, 48.96259529305763, 29.7575948006948, 104.30118877196584, 170.86156686305452, 168.01994385575404, 136.82337153132562, 331.1651539770046, 9.814939520191391, 116.41046831907285, -11.966348294941753, 51.83193747522301, 169.03985143896023, 263.2554390406974], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [11.524961285257298, -38.396127224069986, -158.90853776977278, -153.04604931033091, 56.935478243654636, 156.3195282634032, 57.854117466614916, -35.316530007652105, -5.505037773652195, -132.45986206844535, -81.46745261145301, -287.0921282823749, -103.94774075485259, -90.68170230201444, -5.367063065603266, -75.91202105772918, -73.72861128694085, -114.68180557090288, -27.10375673845232, -102.52340667828554, -76.76615416577103, 184.63025574625473, -71.38942942388127, -54.060853243132726, -107.47577201354467, -87.60091439852147, -150.6164560284132, -206.06195804581768, -118.86424277341499, -68.77004976744273, -167.27105931630027, -42.284072551239916, -28.398880560177826, -35.752235209521515, -35.52119209732136, -124.54027581286621, -78.35636860950493, -54.98004018699291, 5.557251868535579, 47.64752553529846, -40.06372918361011, -24.674915743492758, -60.39869583527117, -59.21052497850746, -75.75439182383576, -66.84326914629092, -81.14038258622207, -78.29395314053554, -191.9157552579359, -103.84812481950803, -46.34995350659646, -88.33074533010783, -96.04548944649943, -86.46412317999736, -3.0357581629576513, -56.11065130147767, -1.1498474517340722, -74.66138985494304, -47.567600905813876, -48.87624657179326, -83.38416980789354, -63.70645659816622, -5.235467147008954, -90.79282013823072, -88.66713385363359, -105.85316238088011, -100.53028180969036, -119.96474597506136, -66.63292415578788, -74.0921686737665, -56.597818842628065, -111.37156109825945, -82.64846355108861, -215.45186120287883, -149.87568131110584, 49.78848191384063, 45.965017736060574, -0.10839817962852488, -57.48209920163457, -90.92859272569598, -25.25226736622509, -42.97211117392209, -169.53506382069793, -130.64130833460575, -88.16834323775224, -59.19595336381465, -112.98798988407019, -53.18837846980523, -162.7649924344599, -65.89598851831369, -85.63273812638467, -79.52348472589054, 20.907080595093696, -2.782442984883171, -4.72037446024875, -92.65299435512816, -149.1120853348392, -237.00777505906834, 36.69598067022883, 58.96482127269557, -108.81042333601094, -1.955395269029914, -68.66251483584149, -25.312556462314138, 135.52329160690493, -153.3247528718195, 30.814937556957243, 116.43670200391595, -162.99465618680935, -71.79795777205668, -52.5021955712321, -27.66076591204969, -117.93278401131403, 18.380137623849684, -71.62986694523246, -33.57145122160031, 60.02936203841631, 200.0, 1.0842523142983165, 62.66151789639665, -103.28926992636434, -94.84692598908605, 50.08367268689515, -114.88516721063503, -138.35001754779216, -95.31368788802364, 52.00687388273718, -121.90894901750706, -168.58245126969007, -4.197642370590144, -2.4975933726790758, 94.08782895624563, -46.07611206854352, 16.636596105640372, -42.542642611997685, 4.78120297062593, 35.97627296441859, -97.39688413752825, -242.1444313444871, -215.64928356366752, -43.25875467549268, 92.46068142723536, 8.538374560354558, 21.145730129768427, -136.37165071833394, 4.941108189610758, -113.04335813118327, -8.94110903740161, 121.62457297329236, -94.78412156673791, -75.73995937690799, -25.39346901044698, -216.04054149449613, -34.98411651936638, -125.40518359728567, -175.16010545874414, 110.72584938112061, -78.78290364746617, 34.62750799107316, 104.16888732395901, -77.04361254110505, -73.49960890954921, -159.24915213678776, -78.08725426511299, -238.6851587501643, -284.84352956947254, -66.7442367919934, -14.72139189147341, 71.19390711923272, 190.1, 174.9363898792464, 111.57605993332746, -77.91187734309932, 104.05534476785145, -2.286824584481433, -48.54569586571361, -70.90385703546269, -52.21107628124055, 2.13506932257092, 22.70151491766875, 41.979060518977846, 57.27265421335241, 84.17426529538787, 16.70479973863199, -168.87850563688778, 65.76364592630375, 85.48384171599321, 195.05, -118.22631203878623, -265.13731318537634, -59.32920029944535, 21.09608416745508, -193.91606955888804, -95.36498740660224, -59.69395018073464, -147.92245295480666, 64.50830186267171, 58.145529101113326, 117.6952669938178, 81.42704517052317], "policy_predator_policy_reward": [41.02797734079975, 54.95527686636471, 167.47858709495284, 178.56419087286355, 33.60308585112746, 40.73599301501931, 53.16262216541079, 51.106396716419226, 121.76987373359769, 84.17825424594565, 270.96206154771176, 91.5064750326265, 91.60716009326737, 163.68526963315824, 108.77581400372617, 39.69062825606613, 111.2568383404403, 84.44543264032531, 43.143803067827704, 108.25950291735371, 49.384333682342714, 105.34624702997748, 79.03091644719781, 69.14061373307844, 129.45628524332082, 72.72370645083166, 224.4085960820249, 213.59283095801092, 113.71826460284821, 103.49260783023036, 43.38039637810341, 182.14320188904895, 95.78805257383436, 41.19917934760114, 97.91844844508462, 83.2946075073855, 111.04698104856614, 70.90060062670027, 25.219995303521532, 68.5338335209682, 89.90983529176182, 65.15519657753985, 63.94083036697886, 84.91317553985385, 31.650043146319796, 123.6850515703452, 122.26890542936076, 20.508928809082782, 186.75020510742024, 143.88672926343324, 88.02527291025962, 100.61672027712389, 78.13939909090948, 115.69775070691382, 47.93552505452457, 50.492726270833266, 116.52598175859558, 44.561132337984795, 44.04301010107661, 64.83730030181705, 66.47278147496849, 88.07197233303903, 102.79623832658316, 57.35065945232526, 59.14516042284688, 194.0317979587202, 130.0478874596339, 105.59890552480265, 61.804869997961994, 71.27425583102898, 92.78888008257053, 116.51930432277304, 192.72537226531185, 130.35734501891372, 112.4832863126227, 96.06685297627523, 21.598307239822347, 40.59469967571701, 82.26850129284674, 146.7130940936111, 53.94047212071888, 38.5782939592483, 204.8439218444962, 120.21630347624257, 62.79151334549867, 99.55182009204339, 71.89940584842779, 125.72641124187724, 90.74910267673238, 140.026778969968, 103.8394093838431, 69.08928930117656, 42.73839398942218, 55.49973452058091, 92.26516070373543, 61.668227261713625, 192.48421004400765, 246.4903226284472, 16.625739724459493, 66.45857974468001, 87.376886887204, 115.59390580687673, 118.69349925286646, 74.73768325090145, 176.54205539250043, 78.30619607261265, 34.02702890680081, 37.570374398871856, 99.55227849046368, 146.7190334953727, 45.149801843937, 121.5417866937333, 165.12402270531578, 30.071586967543038, 68.68814245523387, 76.590145284846, 23.473342253937993, 30.49500836235143, 32.05193473478321, 38.026534425442065, 131.52755621712103, 79.57822867177788, 38.26193503221389, 129.9419950931547, 145.15859150023482, 112.94577860780376, 134.9707185499267, 80.05071777794757, 178.37335051228513, 55.644647013163954, 48.43438753028466, 41.59718550585583, 60.5474244228823, 43.391866217149065, 103.04009984291642, 96.8442125743192, 71.52264221193097, 98.87220701894418, 167.08714440187114, 275.29966442462523, 46.808283895391604, 48.854438383330894, 18.5312070765491, 58.428804115342025, 74.23293060855464, 143.83584354312976, 96.24269067499004, 104.49867267003876, 81.22239049797962, 60.54866807478521, 68.64440019791721, 101.5169429202039, 268.4941015815722, 1.2154456411376007, 85.28799563452748, 198.35513724642513, 145.99869172228594, 56.66268641921583, 43.1265339899828, 43.06360285568854, 102.91234211171458, 103.64171515145517, 224.7826987986784, 126.13915897365109, 219.67229215655476, 352.4972847251733, 89.72103927169192, 1.5757249828840092, 33.30909312955033, 21.654664538181763, 21.1544115436559, 4.322508605504419, 55.32814648518007, 73.45533449512583, 85.09030703755175, 14.70480870570092, 70.56794954557631, 82.30457857182166, 37.937962806030235, 41.52664172569592, 34.39632301801661, 37.21352911270766, 16.231270024302024, 50.90960879743216, 184.58897263985546, 55.349258602054256, 8.98397266162361, 41.64733959938782, 226.77787946254708, 166.40068528180745, 45.22167397849493, 109.4219104725683, 233.14870483131867, 44.16600383922983, 149.8330460100134, 109.61529460075091, 35.98487117173991, 10.401149303435242, 33.04047342344299, 31.092653452913538]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.340457025039427, "mean_inference_ms": 6.088093760470335, "mean_action_processing_ms": 1.025728447274603, "mean_env_wait_ms": 0.8005560700227824, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0168914794921875, "StateBufferConnector_ms": 0.019500732421875, "ViewRequirementAgentConnector_ms": 0.3747594356536865}, "num_episodes": 18, "episode_return_max": 331.1651539770046, "episode_return_min": -16.922156175077305, "episode_return_mean": 87.12725766602735, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 848000, "num_agent_steps_trained": 848000, "num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 223.12241981866526, "num_env_steps_trained_throughput_per_sec": 223.12241981866526, "timesteps_total": 212000, "num_env_steps_sampled_lifetime": 212000, "num_agent_steps_sampled_lifetime": 848000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 848000, "timers": {"training_iteration_time_ms": 59299.565, "restore_workers_time_ms": 0.014, "training_step_time_ms": 59299.522, "sample_time_ms": 4234.606, "learn_time_ms": 55048.821, "learn_throughput": 72.663, "synch_weights_time_ms": 15.158}, "counters": {"num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_agent_steps_sampled": 848000, "num_agent_steps_trained": 848000}, "done": false, "training_iteration": 53, "trial_id": "d163c_00000", "date": "2024-08-16_13-13-01", "timestamp": 1723794181, "time_this_iter_s": 17.931792736053467, "time_total_s": 1400.8328292369843, "pid": 81201, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16b80ea60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1400.8328292369843, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 32.444, "ram_util_percent": 70.63600000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.211379881889101, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.067350197342968, "policy_loss": -0.003849975519601709, "vf_loss": 8.070077308271298, "vf_explained_var": 0.10065829394355653, "kl": 0.00748562659608987, "entropy": 0.6445100229568582, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 101115.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.428998697844763, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.33926532028844, "policy_loss": -0.005538311119501789, "vf_loss": 9.34305804570516, "vf_explained_var": 0.0794616750623814, "kl": 0.008727930328556491, "entropy": 1.2221592212480212, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 101115.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_agent_steps_sampled": 864000, "num_agent_steps_trained": 864000}, "env_runners": {"episode_reward_max": 355.06862592387483, "episode_reward_min": -19.98379495447402, "episode_reward_mean": 104.01112872372579, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -284.84352956947254, "predator_policy": 1.2154456411376007}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 352.4972847251733}, "policy_reward_mean": {"prey_policy": -34.94362677749891, "predator_policy": 86.94919113936184}, "custom_metrics": {}, "hist_stats": {"episode_reward": [12.73743374653823, -16.656501488314117, 34.873054293409496, 53.9612943506792, 11.327537171326298, 39.28184186092254, 85.27587678990326, 12.43646292528645, 7.454127401947711, 64.11861049366867, 58.65666214705333, 15.15176519968488, -7.6459670005634015, 41.33880446445603, 24.98239253025796, 108.46293989163287, 108.04962647197137, 80.57090345912727, 24.294387539819944, 24.883853165434974, 14.979036835975142, 31.449448736429655, 2.11490069392645, 7.772475832744477, 116.36276612021383, 56.56001915007211, 52.854672278547056, 178.74512141206384, 92.20497408903977, 99.45611120561237, 237.0467902001985, 218.84904286654577, 11.478698026970427, 86.52862705438844, 95.64296328539425, 40.07696957324709, 313.99771265470577, 133.82423937092017, 12.969588973448362, 103.40243560162882, 24.44066467222266, 145.1193611931044, 61.237903885168784, 181.62180861970688, 74.4997746771282, 162.1228727758639, 108.97423805776555, -15.40690608165841, 144.86464903046527, 106.64411588201405, 86.63823162296131, 78.75689617644389, 168.6115099793194, 69.02791473076606, 18.68488920884738, -16.922156175077305, 234.60432387515604, 224.98653216070343, 56.010835812515396, 113.58545137042847, 48.64088856209137, 9.831135571109112, 316.2576647869647, 311.9893699617341, 154.92694840505814, 48.96259529305763, 29.7575948006948, 104.30118877196584, 170.86156686305452, 168.01994385575404, 136.82337153132562, 331.1651539770046, 9.814939520191391, 116.41046831907285, -11.966348294941753, 51.83193747522301, 169.03985143896023, 263.2554390406974, 235.70404022537434, 307.84159300500687, 202.01249031918718, 204.23517133674426, -19.98379495447402, 162.86971809302153, 173.28894603511228, 82.26822783966999, 210.55572071535926, 28.766217038149804, 355.06862592387483, 35.36039538202219, 154.18787947537652, 10.478177119085984, 2.1166385078557024, 229.0344449338356, 106.11728149333344, 125.33388059937042, 176.09375731914417, 193.1029732460752, 220.48002522108575, 58.2821427691912], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-75.75439182383576, -66.84326914629092, -81.14038258622207, -78.29395314053554, -191.9157552579359, -103.84812481950803, -46.34995350659646, -88.33074533010783, -96.04548944649943, -86.46412317999736, -3.0357581629576513, -56.11065130147767, -1.1498474517340722, -74.66138985494304, -47.567600905813876, -48.87624657179326, -83.38416980789354, -63.70645659816622, -5.235467147008954, -90.79282013823072, -88.66713385363359, -105.85316238088011, -100.53028180969036, -119.96474597506136, -66.63292415578788, -74.0921686737665, -56.597818842628065, -111.37156109825945, -82.64846355108861, -215.45186120287883, -149.87568131110584, 49.78848191384063, 45.965017736060574, -0.10839817962852488, -57.48209920163457, -90.92859272569598, -25.25226736622509, -42.97211117392209, -169.53506382069793, -130.64130833460575, -88.16834323775224, -59.19595336381465, -112.98798988407019, -53.18837846980523, -162.7649924344599, -65.89598851831369, -85.63273812638467, -79.52348472589054, 20.907080595093696, -2.782442984883171, -4.72037446024875, -92.65299435512816, -149.1120853348392, -237.00777505906834, 36.69598067022883, 58.96482127269557, -108.81042333601094, -1.955395269029914, -68.66251483584149, -25.312556462314138, 135.52329160690493, -153.3247528718195, 30.814937556957243, 116.43670200391595, -162.99465618680935, -71.79795777205668, -52.5021955712321, -27.66076591204969, -117.93278401131403, 18.380137623849684, -71.62986694523246, -33.57145122160031, 60.02936203841631, 200.0, 1.0842523142983165, 62.66151789639665, -103.28926992636434, -94.84692598908605, 50.08367268689515, -114.88516721063503, -138.35001754779216, -95.31368788802364, 52.00687388273718, -121.90894901750706, -168.58245126969007, -4.197642370590144, -2.4975933726790758, 94.08782895624563, -46.07611206854352, 16.636596105640372, -42.542642611997685, 4.78120297062593, 35.97627296441859, -97.39688413752825, -242.1444313444871, -215.64928356366752, -43.25875467549268, 92.46068142723536, 8.538374560354558, 21.145730129768427, -136.37165071833394, 4.941108189610758, -113.04335813118327, -8.94110903740161, 121.62457297329236, -94.78412156673791, -75.73995937690799, -25.39346901044698, -216.04054149449613, -34.98411651936638, -125.40518359728567, -175.16010545874414, 110.72584938112061, -78.78290364746617, 34.62750799107316, 104.16888732395901, -77.04361254110505, -73.49960890954921, -159.24915213678776, -78.08725426511299, -238.6851587501643, -284.84352956947254, -66.7442367919934, -14.72139189147341, 71.19390711923272, 190.1, 174.9363898792464, 111.57605993332746, -77.91187734309932, 104.05534476785145, -2.286824584481433, -48.54569586571361, -70.90385703546269, -52.21107628124055, 2.13506932257092, 22.70151491766875, 41.979060518977846, 57.27265421335241, 84.17426529538787, 16.70479973863199, -168.87850563688778, 65.76364592630375, 85.48384171599321, 195.05, -118.22631203878623, -265.13731318537634, -59.32920029944535, 21.09608416745508, -193.91606955888804, -95.36498740660224, -59.69395018073464, -147.92245295480666, 64.50830186267171, 58.145529101113326, 117.6952669938178, 81.42704517052317, 181.43200892688364, -37.14608257592191, -2.432275246697029, 182.02107980709252, 90.26430709919448, -50.45120141068214, 44.53736935489282, 27.06433885135487, -69.19791565331894, -76.40504026266761, 115.19033124011938, -29.206668883557942, 66.53920122063874, 23.544051755202446, -12.111597966267684, 18.42985377116655, -8.577552064558475, 80.04880625942002, -181.7739881326859, -44.045413501902225, 193.14217272801898, 121.29676774963511, -82.6377119111914, -110.78790798593053, -83.42313904577634, 113.70727134071134, -35.749112125518984, -186.8233358028898, -163.58304787537259, -128.92498604331348, -178.1450955086703, 148.93975854539397, -71.84206501281044, -47.50770903647789, -20.653783729523354, 5.22960089946311, 44.23458762319936, 78.45413230957726, 100.72398749118489, -14.875847145998677, -25.466914180563705, 74.8907779636969, 28.984291465107606, -83.99768425085566], "policy_predator_policy_reward": [31.650043146319796, 123.6850515703452, 122.26890542936076, 20.508928809082782, 186.75020510742024, 143.88672926343324, 88.02527291025962, 100.61672027712389, 78.13939909090948, 115.69775070691382, 47.93552505452457, 50.492726270833266, 116.52598175859558, 44.561132337984795, 44.04301010107661, 64.83730030181705, 66.47278147496849, 88.07197233303903, 102.79623832658316, 57.35065945232526, 59.14516042284688, 194.0317979587202, 130.0478874596339, 105.59890552480265, 61.804869997961994, 71.27425583102898, 92.78888008257053, 116.51930432277304, 192.72537226531185, 130.35734501891372, 112.4832863126227, 96.06685297627523, 21.598307239822347, 40.59469967571701, 82.26850129284674, 146.7130940936111, 53.94047212071888, 38.5782939592483, 204.8439218444962, 120.21630347624257, 62.79151334549867, 99.55182009204339, 71.89940584842779, 125.72641124187724, 90.74910267673238, 140.026778969968, 103.8394093838431, 69.08928930117656, 42.73839398942218, 55.49973452058091, 92.26516070373543, 61.668227261713625, 192.48421004400765, 246.4903226284472, 16.625739724459493, 66.45857974468001, 87.376886887204, 115.59390580687673, 118.69349925286646, 74.73768325090145, 176.54205539250043, 78.30619607261265, 34.02702890680081, 37.570374398871856, 99.55227849046368, 146.7190334953727, 45.149801843937, 121.5417866937333, 165.12402270531578, 30.071586967543038, 68.68814245523387, 76.590145284846, 23.473342253937993, 30.49500836235143, 32.05193473478321, 38.026534425442065, 131.52755621712103, 79.57822867177788, 38.26193503221389, 129.9419950931547, 145.15859150023482, 112.94577860780376, 134.9707185499267, 80.05071777794757, 178.37335051228513, 55.644647013163954, 48.43438753028466, 41.59718550585583, 60.5474244228823, 43.391866217149065, 103.04009984291642, 96.8442125743192, 71.52264221193097, 98.87220701894418, 167.08714440187114, 275.29966442462523, 46.808283895391604, 48.854438383330894, 18.5312070765491, 58.428804115342025, 74.23293060855464, 143.83584354312976, 96.24269067499004, 104.49867267003876, 81.22239049797962, 60.54866807478521, 68.64440019791721, 101.5169429202039, 268.4941015815722, 1.2154456411376007, 85.28799563452748, 198.35513724642513, 145.99869172228594, 56.66268641921583, 43.1265339899828, 43.06360285568854, 102.91234211171458, 103.64171515145517, 224.7826987986784, 126.13915897365109, 219.67229215655476, 352.4972847251733, 89.72103927169192, 1.5757249828840092, 33.30909312955033, 21.654664538181763, 21.1544115436559, 4.322508605504419, 55.32814648518007, 73.45533449512583, 85.09030703755175, 14.70480870570092, 70.56794954557631, 82.30457857182166, 37.937962806030235, 41.52664172569592, 34.39632301801661, 37.21352911270766, 16.231270024302024, 50.90960879743216, 184.58897263985546, 55.349258602054256, 8.98397266162361, 41.64733959938782, 226.77787946254708, 166.40068528180745, 45.22167397849493, 109.4219104725683, 233.14870483131867, 44.16600383922983, 149.8330460100134, 109.61529460075091, 35.98487117173991, 10.401149303435242, 33.04047342344299, 31.092653452913538, 50.86334305714681, 40.55477081726613, 58.35462134240307, 69.8981671022086, 125.1876368947923, 37.011747735882345, 104.92528288006349, 27.70818025043302, 3.1425330832984892, 122.4766278782141, 61.900790908109606, 14.985264828350507, 46.209792140051505, 36.99590091921956, 60.53108550160841, 15.418886533162643, 115.76394154659916, 23.320524973898547, 246.3067532704013, 8.278865402336622, 26.698008377582536, 13.931677068638226, 120.14348824364153, 108.64252703550278, 75.50072169545092, 48.40302548499045, 46.86874791320522, 186.18187713428964, 108.99995513834133, 185.62471728820043, 110.6495114528903, 147.59027044422155, 159.50079811188147, 65.96625743074037, 38.09194760887449, 102.6661158205562, 13.29988185450697, 40.1051555318606, 36.002790903466995, 71.25204199742197, 64.4809878929642, 106.57517354498856, 7.796468622658376, 105.49906693228088]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.3370100480353684, "mean_inference_ms": 6.077257778746194, "mean_action_processing_ms": 1.0232263816149885, "mean_env_wait_ms": 0.7994463641061611, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01542961597442627, "StateBufferConnector_ms": 0.019523024559020996, "ViewRequirementAgentConnector_ms": 0.33640027046203613}, "num_episodes": 22, "episode_return_max": 355.06862592387483, "episode_return_min": -19.98379495447402, "episode_return_mean": 104.01112872372579, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 864000, "num_agent_steps_trained": 864000, "num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 243.62958655254022, "num_env_steps_trained_throughput_per_sec": 243.62958655254022, "timesteps_total": 216000, "num_env_steps_sampled_lifetime": 216000, "num_agent_steps_sampled_lifetime": 864000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 864000, "timers": {"training_iteration_time_ms": 59420.432, "restore_workers_time_ms": 0.014, "training_step_time_ms": 59420.389, "sample_time_ms": 4269.48, "learn_time_ms": 55134.623, "learn_throughput": 72.55, "synch_weights_time_ms": 15.334}, "counters": {"num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_agent_steps_sampled": 864000, "num_agent_steps_trained": 864000}, "done": false, "training_iteration": 54, "trial_id": "d163c_00000", "date": "2024-08-16_13-13-17", "timestamp": 1723794197, "time_this_iter_s": 16.42285394668579, "time_total_s": 1417.25568318367, "pid": 81201, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16b85ad30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1417.25568318367, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 29.778260869565216, "ram_util_percent": 70.59565217391305}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.98978747022215, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.00769648501482, "policy_loss": -0.004982876173274779, "vf_loss": 7.009597842655484, "vf_explained_var": 0.25950336916736827, "kl": 0.02054338434835364, "entropy": 0.7380543556478288, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 103005.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.7010704690501806, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.394350902113334, "policy_loss": -0.008459963901436558, "vf_loss": 9.400449671568694, "vf_explained_var": 0.07186780370101727, "kl": 0.011805929878951233, "entropy": 1.1899671623315762, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 103005.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_agent_steps_sampled": 880000, "num_agent_steps_trained": 880000}, "env_runners": {"episode_reward_max": 376.3110319999096, "episode_reward_min": -48.0508200011476, "episode_reward_mean": 123.397154609879, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -289.5485294303203, "predator_policy": 0.16103199990954825}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 366.23323728378386}, "policy_reward_mean": {"prey_policy": -18.54888077619648, "predator_policy": 80.24745808113599}, "custom_metrics": {}, "hist_stats": {"episode_reward": [7.772475832744477, 116.36276612021383, 56.56001915007211, 52.854672278547056, 178.74512141206384, 92.20497408903977, 99.45611120561237, 237.0467902001985, 218.84904286654577, 11.478698026970427, 86.52862705438844, 95.64296328539425, 40.07696957324709, 313.99771265470577, 133.82423937092017, 12.969588973448362, 103.40243560162882, 24.44066467222266, 145.1193611931044, 61.237903885168784, 181.62180861970688, 74.4997746771282, 162.1228727758639, 108.97423805776555, -15.40690608165841, 144.86464903046527, 106.64411588201405, 86.63823162296131, 78.75689617644389, 168.6115099793194, 69.02791473076606, 18.68488920884738, -16.922156175077305, 234.60432387515604, 224.98653216070343, 56.010835812515396, 113.58545137042847, 48.64088856209137, 9.831135571109112, 316.2576647869647, 311.9893699617341, 154.92694840505814, 48.96259529305763, 29.7575948006948, 104.30118877196584, 170.86156686305452, 168.01994385575404, 136.82337153132562, 331.1651539770046, 9.814939520191391, 116.41046831907285, -11.966348294941753, 51.83193747522301, 169.03985143896023, 263.2554390406974, 235.70404022537434, 307.84159300500687, 202.01249031918718, 204.23517133674426, -19.98379495447402, 162.86971809302153, 173.28894603511228, 82.26822783966999, 210.55572071535926, 28.766217038149804, 355.06862592387483, 35.36039538202219, 154.18787947537652, 10.478177119085984, 2.1166385078557024, 229.0344449338356, 106.11728149333344, 125.33388059937042, 176.09375731914417, 193.1029732460752, 220.48002522108575, 58.2821427691912, -19.325943904072844, 6.112016168363173, 10.538604154602348, 174.68665540866377, 357.96131602015936, 208.6721265932952, -48.0508200011476, 335.9229372992488, 265.93348625676725, 77.27899716620999, 376.3110319999096, 29.037265453644416, 284.1253524497956, 15.382506604292905, 292.7898442976421, 242.63389281515583, 75.15712860108601, 55.13577272878844, -19.021029795382102, 4.864263011815622, 11.945761722834284, 34.47623259248237, -1.8663173482620483], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-85.63273812638467, -79.52348472589054, 20.907080595093696, -2.782442984883171, -4.72037446024875, -92.65299435512816, -149.1120853348392, -237.00777505906834, 36.69598067022883, 58.96482127269557, -108.81042333601094, -1.955395269029914, -68.66251483584149, -25.312556462314138, 135.52329160690493, -153.3247528718195, 30.814937556957243, 116.43670200391595, -162.99465618680935, -71.79795777205668, -52.5021955712321, -27.66076591204969, -117.93278401131403, 18.380137623849684, -71.62986694523246, -33.57145122160031, 60.02936203841631, 200.0, 1.0842523142983165, 62.66151789639665, -103.28926992636434, -94.84692598908605, 50.08367268689515, -114.88516721063503, -138.35001754779216, -95.31368788802364, 52.00687388273718, -121.90894901750706, -168.58245126969007, -4.197642370590144, -2.4975933726790758, 94.08782895624563, -46.07611206854352, 16.636596105640372, -42.542642611997685, 4.78120297062593, 35.97627296441859, -97.39688413752825, -242.1444313444871, -215.64928356366752, -43.25875467549268, 92.46068142723536, 8.538374560354558, 21.145730129768427, -136.37165071833394, 4.941108189610758, -113.04335813118327, -8.94110903740161, 121.62457297329236, -94.78412156673791, -75.73995937690799, -25.39346901044698, -216.04054149449613, -34.98411651936638, -125.40518359728567, -175.16010545874414, 110.72584938112061, -78.78290364746617, 34.62750799107316, 104.16888732395901, -77.04361254110505, -73.49960890954921, -159.24915213678776, -78.08725426511299, -238.6851587501643, -284.84352956947254, -66.7442367919934, -14.72139189147341, 71.19390711923272, 190.1, 174.9363898792464, 111.57605993332746, -77.91187734309932, 104.05534476785145, -2.286824584481433, -48.54569586571361, -70.90385703546269, -52.21107628124055, 2.13506932257092, 22.70151491766875, 41.979060518977846, 57.27265421335241, 84.17426529538787, 16.70479973863199, -168.87850563688778, 65.76364592630375, 85.48384171599321, 195.05, -118.22631203878623, -265.13731318537634, -59.32920029944535, 21.09608416745508, -193.91606955888804, -95.36498740660224, -59.69395018073464, -147.92245295480666, 64.50830186267171, 58.145529101113326, 117.6952669938178, 81.42704517052317, 181.43200892688364, -37.14608257592191, -2.432275246697029, 182.02107980709252, 90.26430709919448, -50.45120141068214, 44.53736935489282, 27.06433885135487, -69.19791565331894, -76.40504026266761, 115.19033124011938, -29.206668883557942, 66.53920122063874, 23.544051755202446, -12.111597966267684, 18.42985377116655, -8.577552064558475, 80.04880625942002, -181.7739881326859, -44.045413501902225, 193.14217272801898, 121.29676774963511, -82.6377119111914, -110.78790798593053, -83.42313904577634, 113.70727134071134, -35.749112125518984, -186.8233358028898, -163.58304787537259, -128.92498604331348, -178.1450955086703, 148.93975854539397, -71.84206501281044, -47.50770903647789, -20.653783729523354, 5.22960089946311, 44.23458762319936, 78.45413230957726, 100.72398749118489, -14.875847145998677, -25.466914180563705, 74.8907779636969, 28.984291465107606, -83.99768425085566, -69.26840428542543, -80.34495315259635, -67.54932430365908, -16.40984451413771, -39.12298902830943, -120.52515768959823, 14.485484815536362, 53.697524478127505, 139.86669948561376, 199.01, 74.04882644427988, 103.43936007124907, -257.89248756922893, -128.1072849140747, 121.2465549547722, 191.09, 133.9214444521598, 100.7587472681002, -27.396932232137694, 35.994431970240036, 188.70098989502992, 185.15, -37.21379957346192, -68.25801360986564, 102.87196557976915, 138.6842758983803, -82.23439121378674, -141.2497136897932, 72.43541072608247, 147.65038727077587, 53.70921661239754, 145.81604708320094, -25.900597142374593, 8.538784291847133, 1.3679604182604674, -12.184197086572993, -151.03004503229087, -133.57985540081478, -77.39751662258399, -89.25478691561347, -289.5485294303203, -280.61078682552767, -37.93383470960746, -13.597148093294518, -95.343806843013, -116.14089767029955], "policy_predator_policy_reward": [103.8394093838431, 69.08928930117656, 42.73839398942218, 55.49973452058091, 92.26516070373543, 61.668227261713625, 192.48421004400765, 246.4903226284472, 16.625739724459493, 66.45857974468001, 87.376886887204, 115.59390580687673, 118.69349925286646, 74.73768325090145, 176.54205539250043, 78.30619607261265, 34.02702890680081, 37.570374398871856, 99.55227849046368, 146.7190334953727, 45.149801843937, 121.5417866937333, 165.12402270531578, 30.071586967543038, 68.68814245523387, 76.590145284846, 23.473342253937993, 30.49500836235143, 32.05193473478321, 38.026534425442065, 131.52755621712103, 79.57822867177788, 38.26193503221389, 129.9419950931547, 145.15859150023482, 112.94577860780376, 134.9707185499267, 80.05071777794757, 178.37335051228513, 55.644647013163954, 48.43438753028466, 41.59718550585583, 60.5474244228823, 43.391866217149065, 103.04009984291642, 96.8442125743192, 71.52264221193097, 98.87220701894418, 167.08714440187114, 275.29966442462523, 46.808283895391604, 48.854438383330894, 18.5312070765491, 58.428804115342025, 74.23293060855464, 143.83584354312976, 96.24269067499004, 104.49867267003876, 81.22239049797962, 60.54866807478521, 68.64440019791721, 101.5169429202039, 268.4941015815722, 1.2154456411376007, 85.28799563452748, 198.35513724642513, 145.99869172228594, 56.66268641921583, 43.1265339899828, 43.06360285568854, 102.91234211171458, 103.64171515145517, 224.7826987986784, 126.13915897365109, 219.67229215655476, 352.4972847251733, 89.72103927169192, 1.5757249828840092, 33.30909312955033, 21.654664538181763, 21.1544115436559, 4.322508605504419, 55.32814648518007, 73.45533449512583, 85.09030703755175, 14.70480870570092, 70.56794954557631, 82.30457857182166, 37.937962806030235, 41.52664172569592, 34.39632301801661, 37.21352911270766, 16.231270024302024, 50.90960879743216, 184.58897263985546, 55.349258602054256, 8.98397266162361, 41.64733959938782, 226.77787946254708, 166.40068528180745, 45.22167397849493, 109.4219104725683, 233.14870483131867, 44.16600383922983, 149.8330460100134, 109.61529460075091, 35.98487117173991, 10.401149303435242, 33.04047342344299, 31.092653452913538, 50.86334305714681, 40.55477081726613, 58.35462134240307, 69.8981671022086, 125.1876368947923, 37.011747735882345, 104.92528288006349, 27.70818025043302, 3.1425330832984892, 122.4766278782141, 61.900790908109606, 14.985264828350507, 46.209792140051505, 36.99590091921956, 60.53108550160841, 15.418886533162643, 115.76394154659916, 23.320524973898547, 246.3067532704013, 8.278865402336622, 26.698008377582536, 13.931677068638226, 120.14348824364153, 108.64252703550278, 75.50072169545092, 48.40302548499045, 46.86874791320522, 186.18187713428964, 108.99995513834133, 185.62471728820043, 110.6495114528903, 147.59027044422155, 159.50079811188147, 65.96625743074037, 38.09194760887449, 102.6661158205562, 13.29988185450697, 40.1051555318606, 36.002790903466995, 71.25204199742197, 64.4809878929642, 106.57517354498856, 7.796468622658376, 105.49906693228088, 23.414802228303984, 106.87261130564501, 67.46027451852618, 22.610910467633797, 161.83779411215843, 8.348956760351333, 101.23814743908771, 5.265498675912154, 8.771898481520356, 10.312718053025305, 2.8520178262861653, 28.331922251479956, 19.57778007080844, 318.37117241134774, 19.7534450452278, 3.832937299248846, 4.053578323014045, 27.199716213493232, 19.401530130013406, 49.27996729809417, 0.16103199990954825, 2.299010104970072, 34.583271192638485, 99.92580744433357, 18.218695439331537, 24.350415532314802, 93.09893931732657, 145.7676721905461, 34.628436877640986, 38.07560942314279, 40.22961914348254, 2.8790099760748484, 70.07346885022994, 22.44547260138356, 48.47994549866149, 17.47206389843951, 151.9533670258032, 113.63550361192054, 19.919156111041005, 151.59741043897196, 366.23323728378386, 215.87184069489828, 56.70192102839147, 29.305294366992957, 68.6965591986622, 140.92182796638826]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.3351098106867196, "mean_inference_ms": 6.073556216782355, "mean_action_processing_ms": 1.021759179970313, "mean_env_wait_ms": 0.7989362088029773, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022283196449279785, "StateBufferConnector_ms": 0.020430445671081543, "ViewRequirementAgentConnector_ms": 0.33642280101776123}, "num_episodes": 23, "episode_return_max": 376.3110319999096, "episode_return_min": -48.0508200011476, "episode_return_mean": 123.397154609879, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 880000, "num_agent_steps_trained": 880000, "num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 239.15492288375813, "num_env_steps_trained_throughput_per_sec": 239.15492288375813, "timesteps_total": 220000, "num_env_steps_sampled_lifetime": 220000, "num_agent_steps_sampled_lifetime": 880000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 880000, "timers": {"training_iteration_time_ms": 59581.917, "restore_workers_time_ms": 0.014, "training_step_time_ms": 59581.873, "sample_time_ms": 4300.952, "learn_time_ms": 55264.508, "learn_throughput": 72.379, "synch_weights_time_ms": 15.492}, "counters": {"num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_agent_steps_sampled": 880000, "num_agent_steps_trained": 880000}, "done": false, "training_iteration": 55, "trial_id": "d163c_00000", "date": "2024-08-16_13-13-34", "timestamp": 1723794214, "time_this_iter_s": 16.730546951293945, "time_total_s": 1433.986230134964, "pid": 81201, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16b839e50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1433.986230134964, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 29.599999999999998, "ram_util_percent": 70.2625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.660359980378832, "cur_kl_coeff": 0.22500000000000006, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.6479470336248, "policy_loss": -0.0070376295685058545, "vf_loss": 7.652558775805923, "vf_explained_var": 0.18220128331865584, "kl": 0.010781787989424444, "entropy": 0.6669409252033032, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 104895.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3225080103785904, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.462932854102402, "policy_loss": -0.005161563285118925, "vf_loss": 9.466362231118339, "vf_explained_var": -0.00022531747817993163, "kl": 0.008660925944757796, "entropy": 1.177801273550306, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 104895.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_agent_steps_sampled": 896000, "num_agent_steps_trained": 896000}, "env_runners": {"episode_reward_max": 377.65078919884104, "episode_reward_min": -48.0508200011476, "episode_reward_mean": 129.28640333936386, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -289.5485294303203, "predator_policy": 0.16103199990954825}, "policy_reward_max": {"prey_policy": 199.01, "predator_policy": 366.23323728378386}, "policy_reward_mean": {"prey_policy": -14.527465050861405, "predator_policy": 79.17066672054337}, "custom_metrics": {}, "hist_stats": {"episode_reward": [145.1193611931044, 61.237903885168784, 181.62180861970688, 74.4997746771282, 162.1228727758639, 108.97423805776555, -15.40690608165841, 144.86464903046527, 106.64411588201405, 86.63823162296131, 78.75689617644389, 168.6115099793194, 69.02791473076606, 18.68488920884738, -16.922156175077305, 234.60432387515604, 224.98653216070343, 56.010835812515396, 113.58545137042847, 48.64088856209137, 9.831135571109112, 316.2576647869647, 311.9893699617341, 154.92694840505814, 48.96259529305763, 29.7575948006948, 104.30118877196584, 170.86156686305452, 168.01994385575404, 136.82337153132562, 331.1651539770046, 9.814939520191391, 116.41046831907285, -11.966348294941753, 51.83193747522301, 169.03985143896023, 263.2554390406974, 235.70404022537434, 307.84159300500687, 202.01249031918718, 204.23517133674426, -19.98379495447402, 162.86971809302153, 173.28894603511228, 82.26822783966999, 210.55572071535926, 28.766217038149804, 355.06862592387483, 35.36039538202219, 154.18787947537652, 10.478177119085984, 2.1166385078557024, 229.0344449338356, 106.11728149333344, 125.33388059937042, 176.09375731914417, 193.1029732460752, 220.48002522108575, 58.2821427691912, -19.325943904072844, 6.112016168363173, 10.538604154602348, 174.68665540866377, 357.96131602015936, 208.6721265932952, -48.0508200011476, 335.9229372992488, 265.93348625676725, 77.27899716620999, 376.3110319999096, 29.037265453644416, 284.1253524497956, 15.382506604292905, 292.7898442976421, 242.63389281515583, 75.15712860108601, 55.13577272878844, -19.021029795382102, 4.864263011815622, 11.945761722834284, 34.47623259248237, -1.8663173482620483, 16.107849985823524, 300.92382896111803, 36.10389938609608, 328.48624237758133, -35.21292441931184, -25.635122841231823, 20.128775852283347, 70.11744430858616, 350.6402849565645, -4.762613718233416, 288.6101106249277, -39.64028338954677, 329.9378267462773, 60.07222958323438, 33.598993510591484, 19.969961560129367, 377.65078919884104, 344.0414526327221], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [52.00687388273718, -121.90894901750706, -168.58245126969007, -4.197642370590144, -2.4975933726790758, 94.08782895624563, -46.07611206854352, 16.636596105640372, -42.542642611997685, 4.78120297062593, 35.97627296441859, -97.39688413752825, -242.1444313444871, -215.64928356366752, -43.25875467549268, 92.46068142723536, 8.538374560354558, 21.145730129768427, -136.37165071833394, 4.941108189610758, -113.04335813118327, -8.94110903740161, 121.62457297329236, -94.78412156673791, -75.73995937690799, -25.39346901044698, -216.04054149449613, -34.98411651936638, -125.40518359728567, -175.16010545874414, 110.72584938112061, -78.78290364746617, 34.62750799107316, 104.16888732395901, -77.04361254110505, -73.49960890954921, -159.24915213678776, -78.08725426511299, -238.6851587501643, -284.84352956947254, -66.7442367919934, -14.72139189147341, 71.19390711923272, 190.1, 174.9363898792464, 111.57605993332746, -77.91187734309932, 104.05534476785145, -2.286824584481433, -48.54569586571361, -70.90385703546269, -52.21107628124055, 2.13506932257092, 22.70151491766875, 41.979060518977846, 57.27265421335241, 84.17426529538787, 16.70479973863199, -168.87850563688778, 65.76364592630375, 85.48384171599321, 195.05, -118.22631203878623, -265.13731318537634, -59.32920029944535, 21.09608416745508, -193.91606955888804, -95.36498740660224, -59.69395018073464, -147.92245295480666, 64.50830186267171, 58.145529101113326, 117.6952669938178, 81.42704517052317, 181.43200892688364, -37.14608257592191, -2.432275246697029, 182.02107980709252, 90.26430709919448, -50.45120141068214, 44.53736935489282, 27.06433885135487, -69.19791565331894, -76.40504026266761, 115.19033124011938, -29.206668883557942, 66.53920122063874, 23.544051755202446, -12.111597966267684, 18.42985377116655, -8.577552064558475, 80.04880625942002, -181.7739881326859, -44.045413501902225, 193.14217272801898, 121.29676774963511, -82.6377119111914, -110.78790798593053, -83.42313904577634, 113.70727134071134, -35.749112125518984, -186.8233358028898, -163.58304787537259, -128.92498604331348, -178.1450955086703, 148.93975854539397, -71.84206501281044, -47.50770903647789, -20.653783729523354, 5.22960089946311, 44.23458762319936, 78.45413230957726, 100.72398749118489, -14.875847145998677, -25.466914180563705, 74.8907779636969, 28.984291465107606, -83.99768425085566, -69.26840428542543, -80.34495315259635, -67.54932430365908, -16.40984451413771, -39.12298902830943, -120.52515768959823, 14.485484815536362, 53.697524478127505, 139.86669948561376, 199.01, 74.04882644427988, 103.43936007124907, -257.89248756922893, -128.1072849140747, 121.2465549547722, 191.09, 133.9214444521598, 100.7587472681002, -27.396932232137694, 35.994431970240036, 188.70098989502992, 185.15, -37.21379957346192, -68.25801360986564, 102.87196557976915, 138.6842758983803, -82.23439121378674, -141.2497136897932, 72.43541072608247, 147.65038727077587, 53.70921661239754, 145.81604708320094, -25.900597142374593, 8.538784291847133, 1.3679604182604674, -12.184197086572993, -151.03004503229087, -133.57985540081478, -77.39751662258399, -89.25478691561347, -289.5485294303203, -280.61078682552767, -37.93383470960746, -13.597148093294518, -95.343806843013, -116.14089767029955, -123.39379072581077, -74.78559821573825, 142.20772762529523, 133.12028805044113, -68.08745273724898, -60.656164518651444, 171.88064329147974, 118.61877372929119, -85.44870630589688, -85.39175425748678, -284.6191549812037, -147.60214035443667, -59.491090025711344, -106.2903697048244, -65.17760303033049, -15.745341978182452, 187.76046921017928, 126.27937580035675, -48.64898965567858, -186.35003728760333, 118.92242178864913, 132.62846911389687, -106.70592098978302, -194.0847510705344, 140.80304613326658, 149.39510746823117, -137.22406449370624, -219.92574789178667, -152.0569582884184, -117.41573080318875, -177.47348559276693, -105.60429815275543, 192.07999999999998, 181.32785456008477, 139.63759161958393, 189.11], "policy_predator_policy_reward": [134.9707185499267, 80.05071777794757, 178.37335051228513, 55.644647013163954, 48.43438753028466, 41.59718550585583, 60.5474244228823, 43.391866217149065, 103.04009984291642, 96.8442125743192, 71.52264221193097, 98.87220701894418, 167.08714440187114, 275.29966442462523, 46.808283895391604, 48.854438383330894, 18.5312070765491, 58.428804115342025, 74.23293060855464, 143.83584354312976, 96.24269067499004, 104.49867267003876, 81.22239049797962, 60.54866807478521, 68.64440019791721, 101.5169429202039, 268.4941015815722, 1.2154456411376007, 85.28799563452748, 198.35513724642513, 145.99869172228594, 56.66268641921583, 43.1265339899828, 43.06360285568854, 102.91234211171458, 103.64171515145517, 224.7826987986784, 126.13915897365109, 219.67229215655476, 352.4972847251733, 89.72103927169192, 1.5757249828840092, 33.30909312955033, 21.654664538181763, 21.1544115436559, 4.322508605504419, 55.32814648518007, 73.45533449512583, 85.09030703755175, 14.70480870570092, 70.56794954557631, 82.30457857182166, 37.937962806030235, 41.52664172569592, 34.39632301801661, 37.21352911270766, 16.231270024302024, 50.90960879743216, 184.58897263985546, 55.349258602054256, 8.98397266162361, 41.64733959938782, 226.77787946254708, 166.40068528180745, 45.22167397849493, 109.4219104725683, 233.14870483131867, 44.16600383922983, 149.8330460100134, 109.61529460075091, 35.98487117173991, 10.401149303435242, 33.04047342344299, 31.092653452913538, 50.86334305714681, 40.55477081726613, 58.35462134240307, 69.8981671022086, 125.1876368947923, 37.011747735882345, 104.92528288006349, 27.70818025043302, 3.1425330832984892, 122.4766278782141, 61.900790908109606, 14.985264828350507, 46.209792140051505, 36.99590091921956, 60.53108550160841, 15.418886533162643, 115.76394154659916, 23.320524973898547, 246.3067532704013, 8.278865402336622, 26.698008377582536, 13.931677068638226, 120.14348824364153, 108.64252703550278, 75.50072169545092, 48.40302548499045, 46.86874791320522, 186.18187713428964, 108.99995513834133, 185.62471728820043, 110.6495114528903, 147.59027044422155, 159.50079811188147, 65.96625743074037, 38.09194760887449, 102.6661158205562, 13.29988185450697, 40.1051555318606, 36.002790903466995, 71.25204199742197, 64.4809878929642, 106.57517354498856, 7.796468622658376, 105.49906693228088, 23.414802228303984, 106.87261130564501, 67.46027451852618, 22.610910467633797, 161.83779411215843, 8.348956760351333, 101.23814743908771, 5.265498675912154, 8.771898481520356, 10.312718053025305, 2.8520178262861653, 28.331922251479956, 19.57778007080844, 318.37117241134774, 19.7534450452278, 3.832937299248846, 4.053578323014045, 27.199716213493232, 19.401530130013406, 49.27996729809417, 0.16103199990954825, 2.299010104970072, 34.583271192638485, 99.92580744433357, 18.218695439331537, 24.350415532314802, 93.09893931732657, 145.7676721905461, 34.628436877640986, 38.07560942314279, 40.22961914348254, 2.8790099760748484, 70.07346885022994, 22.44547260138356, 48.47994549866149, 17.47206389843951, 151.9533670258032, 113.63550361192054, 19.919156111041005, 151.59741043897196, 366.23323728378386, 215.87184069489828, 56.70192102839147, 29.305294366992957, 68.6965591986622, 140.92182796638826, 186.29608389667354, 27.991155030699083, 7.386932064301494, 18.20888122108033, 82.01207613302567, 82.83544050897092, 1.0810820507972994, 36.90574330601309, 120.21617912116132, 15.411357022910455, 333.62791936607204, 72.95825312833657, 102.13162425044254, 83.77861133237649, 70.06507930621734, 80.97531001088203, 26.02647433884365, 10.573965607184851, 55.71229938448738, 174.52411384056114, 19.358815385423554, 17.700404336958208, 25.429851851837224, 235.7205368189333, 27.673302232167504, 12.06637091261207, 225.39387505133027, 191.82816691739725, 149.1983031715006, 153.87337943069784, 110.59920348967741, 192.4485418159746, 3.3534134417377675, 0.8895211970185015, 11.41912229102863, 3.8747387221095364]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.333539118073322, "mean_inference_ms": 6.0686749592215135, "mean_action_processing_ms": 1.020139011569083, "mean_env_wait_ms": 0.7983577360823401, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022449374198913574, "StateBufferConnector_ms": 0.015844225883483887, "ViewRequirementAgentConnector_ms": 0.33243560791015625}, "num_episodes": 18, "episode_return_max": 377.65078919884104, "episode_return_min": -48.0508200011476, "episode_return_mean": 129.28640333936386, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 896000, "num_agent_steps_trained": 896000, "num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 252.75380135196008, "num_env_steps_trained_throughput_per_sec": 252.75380135196008, "timesteps_total": 224000, "num_env_steps_sampled_lifetime": 224000, "num_agent_steps_sampled_lifetime": 896000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 896000, "timers": {"training_iteration_time_ms": 59530.87, "restore_workers_time_ms": 0.014, "training_step_time_ms": 59530.827, "sample_time_ms": 4297.057, "learn_time_ms": 55217.438, "learn_throughput": 72.441, "synch_weights_time_ms": 15.438}, "counters": {"num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_agent_steps_sampled": 896000, "num_agent_steps_trained": 896000}, "done": false, "training_iteration": 56, "trial_id": "d163c_00000", "date": "2024-08-16_13-13-50", "timestamp": 1723794230, "time_this_iter_s": 15.829691886901855, "time_total_s": 1449.8159220218658, "pid": 81201, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16b976550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1449.8159220218658, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 27.8608695652174, "ram_util_percent": 70.17391304347827}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.275242711311925, "cur_kl_coeff": 0.22500000000000006, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.949245618386243, "policy_loss": -0.003541538242999681, "vf_loss": 6.951412227418688, "vf_explained_var": 0.20618913911637807, "kl": 0.006110794670396655, "entropy": 0.663225627071643, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 106785.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.5675262827406486, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.467260721499327, "policy_loss": -0.004640301388057649, "vf_loss": 9.470635944447189, "vf_explained_var": 0.003859652003283223, "kl": 0.006325405491756518, "entropy": 1.1851994622952093, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 106785.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_agent_steps_sampled": 912000, "num_agent_steps_trained": 912000}, "env_runners": {"episode_reward_max": 377.65078919884104, "episode_reward_min": -48.0508200011476, "episode_reward_mean": 137.73239764933106, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -289.5485294303203, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 199.01, "predator_policy": 366.23323728378386}, "policy_reward_mean": {"prey_policy": -2.9629442978289675, "predator_policy": 71.82914312249451}, "custom_metrics": {}, "hist_stats": {"episode_reward": [113.58545137042847, 48.64088856209137, 9.831135571109112, 316.2576647869647, 311.9893699617341, 154.92694840505814, 48.96259529305763, 29.7575948006948, 104.30118877196584, 170.86156686305452, 168.01994385575404, 136.82337153132562, 331.1651539770046, 9.814939520191391, 116.41046831907285, -11.966348294941753, 51.83193747522301, 169.03985143896023, 263.2554390406974, 235.70404022537434, 307.84159300500687, 202.01249031918718, 204.23517133674426, -19.98379495447402, 162.86971809302153, 173.28894603511228, 82.26822783966999, 210.55572071535926, 28.766217038149804, 355.06862592387483, 35.36039538202219, 154.18787947537652, 10.478177119085984, 2.1166385078557024, 229.0344449338356, 106.11728149333344, 125.33388059937042, 176.09375731914417, 193.1029732460752, 220.48002522108575, 58.2821427691912, -19.325943904072844, 6.112016168363173, 10.538604154602348, 174.68665540866377, 357.96131602015936, 208.6721265932952, -48.0508200011476, 335.9229372992488, 265.93348625676725, 77.27899716620999, 376.3110319999096, 29.037265453644416, 284.1253524497956, 15.382506604292905, 292.7898442976421, 242.63389281515583, 75.15712860108601, 55.13577272878844, -19.021029795382102, 4.864263011815622, 11.945761722834284, 34.47623259248237, -1.8663173482620483, 16.107849985823524, 300.92382896111803, 36.10389938609608, 328.48624237758133, -35.21292441931184, -25.635122841231823, 20.128775852283347, 70.11744430858616, 350.6402849565645, -4.762613718233416, 288.6101106249277, -39.64028338954677, 329.9378267462773, 60.07222958323438, 33.598993510591484, 19.969961560129367, 377.65078919884104, 344.0414526327221, -2.072271404304524, 167.6093176665937, 288.3852561371066, 114.68504145830914, 198.7660495519628, 185.27949104938955, 68.98078581047723, 355.206591943793, 9.652762899287877, 215.28582296173383, 40.25523758267082, 329.4209716043871, 279.837031715031, 311.4479018060473, 54.28971871852298, -20.638724648427548, 4.386600810679103, 133.89864076465412], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-159.24915213678776, -78.08725426511299, -238.6851587501643, -284.84352956947254, -66.7442367919934, -14.72139189147341, 71.19390711923272, 190.1, 174.9363898792464, 111.57605993332746, -77.91187734309932, 104.05534476785145, -2.286824584481433, -48.54569586571361, -70.90385703546269, -52.21107628124055, 2.13506932257092, 22.70151491766875, 41.979060518977846, 57.27265421335241, 84.17426529538787, 16.70479973863199, -168.87850563688778, 65.76364592630375, 85.48384171599321, 195.05, -118.22631203878623, -265.13731318537634, -59.32920029944535, 21.09608416745508, -193.91606955888804, -95.36498740660224, -59.69395018073464, -147.92245295480666, 64.50830186267171, 58.145529101113326, 117.6952669938178, 81.42704517052317, 181.43200892688364, -37.14608257592191, -2.432275246697029, 182.02107980709252, 90.26430709919448, -50.45120141068214, 44.53736935489282, 27.06433885135487, -69.19791565331894, -76.40504026266761, 115.19033124011938, -29.206668883557942, 66.53920122063874, 23.544051755202446, -12.111597966267684, 18.42985377116655, -8.577552064558475, 80.04880625942002, -181.7739881326859, -44.045413501902225, 193.14217272801898, 121.29676774963511, -82.6377119111914, -110.78790798593053, -83.42313904577634, 113.70727134071134, -35.749112125518984, -186.8233358028898, -163.58304787537259, -128.92498604331348, -178.1450955086703, 148.93975854539397, -71.84206501281044, -47.50770903647789, -20.653783729523354, 5.22960089946311, 44.23458762319936, 78.45413230957726, 100.72398749118489, -14.875847145998677, -25.466914180563705, 74.8907779636969, 28.984291465107606, -83.99768425085566, -69.26840428542543, -80.34495315259635, -67.54932430365908, -16.40984451413771, -39.12298902830943, -120.52515768959823, 14.485484815536362, 53.697524478127505, 139.86669948561376, 199.01, 74.04882644427988, 103.43936007124907, -257.89248756922893, -128.1072849140747, 121.2465549547722, 191.09, 133.9214444521598, 100.7587472681002, -27.396932232137694, 35.994431970240036, 188.70098989502992, 185.15, -37.21379957346192, -68.25801360986564, 102.87196557976915, 138.6842758983803, -82.23439121378674, -141.2497136897932, 72.43541072608247, 147.65038727077587, 53.70921661239754, 145.81604708320094, -25.900597142374593, 8.538784291847133, 1.3679604182604674, -12.184197086572993, -151.03004503229087, -133.57985540081478, -77.39751662258399, -89.25478691561347, -289.5485294303203, -280.61078682552767, -37.93383470960746, -13.597148093294518, -95.343806843013, -116.14089767029955, -123.39379072581077, -74.78559821573825, 142.20772762529523, 133.12028805044113, -68.08745273724898, -60.656164518651444, 171.88064329147974, 118.61877372929119, -85.44870630589688, -85.39175425748678, -284.6191549812037, -147.60214035443667, -59.491090025711344, -106.2903697048244, -65.17760303033049, -15.745341978182452, 187.76046921017928, 126.27937580035675, -48.64898965567858, -186.35003728760333, 118.92242178864913, 132.62846911389687, -106.70592098978302, -194.0847510705344, 140.80304613326658, 149.39510746823117, -137.22406449370624, -219.92574789178667, -152.0569582884184, -117.41573080318875, -177.47348559276693, -105.60429815275543, 192.07999999999998, 181.32785456008477, 139.63759161958393, 189.11, -81.14469205359862, -94.66182343795478, 60.64030176463645, 63.17347639446797, 172.63733859800354, 82.33450714990275, 17.175657746885893, -82.56522974792499, -10.228593906591886, 91.8580727427924, 28.823041071309227, 108.01032097411124, -10.826800007121003, 9.143442753719011, 185.3118935424777, 149.86713161252192, -74.13346017262901, -81.827973185634, 57.03089481145585, 72.23214527433474, -45.59103245625657, -58.16963107352512, 172.60966660042084, 130.1024351112955, 118.850140362301, 139.12445935037, 107.94842224816175, 170.48793820394792, -118.38641183869697, -20.475927425735925, -210.34304899411427, -143.6607072727316, -45.45252406299012, -99.72218731351798, 22.076344582718285, 12.933565074551751], "policy_predator_policy_reward": [224.7826987986784, 126.13915897365109, 219.67229215655476, 352.4972847251733, 89.72103927169192, 1.5757249828840092, 33.30909312955033, 21.654664538181763, 21.1544115436559, 4.322508605504419, 55.32814648518007, 73.45533449512583, 85.09030703755175, 14.70480870570092, 70.56794954557631, 82.30457857182166, 37.937962806030235, 41.52664172569592, 34.39632301801661, 37.21352911270766, 16.231270024302024, 50.90960879743216, 184.58897263985546, 55.349258602054256, 8.98397266162361, 41.64733959938782, 226.77787946254708, 166.40068528180745, 45.22167397849493, 109.4219104725683, 233.14870483131867, 44.16600383922983, 149.8330460100134, 109.61529460075091, 35.98487117173991, 10.401149303435242, 33.04047342344299, 31.092653452913538, 50.86334305714681, 40.55477081726613, 58.35462134240307, 69.8981671022086, 125.1876368947923, 37.011747735882345, 104.92528288006349, 27.70818025043302, 3.1425330832984892, 122.4766278782141, 61.900790908109606, 14.985264828350507, 46.209792140051505, 36.99590091921956, 60.53108550160841, 15.418886533162643, 115.76394154659916, 23.320524973898547, 246.3067532704013, 8.278865402336622, 26.698008377582536, 13.931677068638226, 120.14348824364153, 108.64252703550278, 75.50072169545092, 48.40302548499045, 46.86874791320522, 186.18187713428964, 108.99995513834133, 185.62471728820043, 110.6495114528903, 147.59027044422155, 159.50079811188147, 65.96625743074037, 38.09194760887449, 102.6661158205562, 13.29988185450697, 40.1051555318606, 36.002790903466995, 71.25204199742197, 64.4809878929642, 106.57517354498856, 7.796468622658376, 105.49906693228088, 23.414802228303984, 106.87261130564501, 67.46027451852618, 22.610910467633797, 161.83779411215843, 8.348956760351333, 101.23814743908771, 5.265498675912154, 8.771898481520356, 10.312718053025305, 2.8520178262861653, 28.331922251479956, 19.57778007080844, 318.37117241134774, 19.7534450452278, 3.832937299248846, 4.053578323014045, 27.199716213493232, 19.401530130013406, 49.27996729809417, 0.16103199990954825, 2.299010104970072, 34.583271192638485, 99.92580744433357, 18.218695439331537, 24.350415532314802, 93.09893931732657, 145.7676721905461, 34.628436877640986, 38.07560942314279, 40.22961914348254, 2.8790099760748484, 70.07346885022994, 22.44547260138356, 48.47994549866149, 17.47206389843951, 151.9533670258032, 113.63550361192054, 19.919156111041005, 151.59741043897196, 366.23323728378386, 215.87184069489828, 56.70192102839147, 29.305294366992957, 68.6965591986622, 140.92182796638826, 186.29608389667354, 27.991155030699083, 7.386932064301494, 18.20888122108033, 82.01207613302567, 82.83544050897092, 1.0810820507972994, 36.90574330601309, 120.21617912116132, 15.411357022910455, 333.62791936607204, 72.95825312833657, 102.13162425044254, 83.77861133237649, 70.06507930621734, 80.97531001088203, 26.02647433884365, 10.573965607184851, 55.71229938448738, 174.52411384056114, 19.358815385423554, 17.700404336958208, 25.429851851837224, 235.7205368189333, 27.673302232167504, 12.06637091261207, 225.39387505133027, 191.82816691739725, 149.1983031715006, 153.87337943069784, 110.59920348967741, 192.4485418159746, 3.3534134417377675, 0.8895211970185015, 11.41912229102863, 3.8747387221095364, 63.983597981502285, 109.75064610574658, 1.1361231099237143, 42.659416397565614, 6.728684819012252, 26.684725570188125, 0.0, 180.07461345934843, 30.953963550864586, 86.18260716489739, 39.25778883439774, 9.188340169571319, 70.66414306387917, 0.0, 7.8937874140365, 12.133779374756847, 98.877281193099, 66.73691506445188, 23.41254330394344, 62.61023957199974, 72.89514720697586, 71.12075390547655, 11.409348468978205, 15.299521423692534, 17.375628153322836, 4.48680384903738, 14.17939299584022, 18.832148358097584, 60.672028534227366, 132.48002944872852, 274.4024832703913, 58.96254834802707, 1.5193001983192835, 148.04201198886778, 51.85641554446761, 47.03231556291645]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.3317585048210723, "mean_inference_ms": 6.06025149167278, "mean_action_processing_ms": 1.0182092413235848, "mean_env_wait_ms": 0.797507504953127, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024265050888061523, "StateBufferConnector_ms": 0.020006418228149414, "ViewRequirementAgentConnector_ms": 0.346513032913208}, "num_episodes": 18, "episode_return_max": 377.65078919884104, "episode_return_min": -48.0508200011476, "episode_return_mean": 137.73239764933106, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 912000, "num_agent_steps_trained": 912000, "num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 255.66228204716762, "num_env_steps_trained_throughput_per_sec": 255.66228204716762, "timesteps_total": 228000, "num_env_steps_sampled_lifetime": 228000, "num_agent_steps_sampled_lifetime": 912000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 912000, "timers": {"training_iteration_time_ms": 59565.396, "restore_workers_time_ms": 0.014, "training_step_time_ms": 59565.353, "sample_time_ms": 4278.192, "learn_time_ms": 55270.789, "learn_throughput": 72.371, "synch_weights_time_ms": 15.519}, "counters": {"num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_agent_steps_sampled": 912000, "num_agent_steps_trained": 912000}, "done": false, "training_iteration": 57, "trial_id": "d163c_00000", "date": "2024-08-16_13-14-05", "timestamp": 1723794245, "time_this_iter_s": 15.649955987930298, "time_total_s": 1465.4658780097961, "pid": 81201, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16b85ad30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1465.4658780097961, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 27.622727272727275, "ram_util_percent": 69.99545454545454}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 12.038545744696622, "cur_kl_coeff": 0.22500000000000006, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.1365337611506225, "policy_loss": -0.002836956859260758, "vf_loss": 7.137960709718169, "vf_explained_var": 0.3253320249615523, "kl": 0.0062667773658225, "entropy": 0.5807750831205378, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 108675.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.108427349158696, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.363859684252866, "policy_loss": -0.005366539700380551, "vf_loss": 9.367557844535384, "vf_explained_var": -0.06809321190945056, "kl": 0.008341834928213304, "entropy": 1.133027912699987, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 108675.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_agent_steps_sampled": 928000, "num_agent_steps_trained": 928000}, "env_runners": {"episode_reward_max": 377.65078919884104, "episode_reward_min": -65.96362805530795, "episode_reward_mean": 125.5837649466802, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -289.5485294303203, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 199.01, "predator_policy": 366.23323728378386}, "policy_reward_mean": {"prey_policy": -7.094592463439162, "predator_policy": 69.88647493677927}, "custom_metrics": {}, "hist_stats": {"episode_reward": [204.23517133674426, -19.98379495447402, 162.86971809302153, 173.28894603511228, 82.26822783966999, 210.55572071535926, 28.766217038149804, 355.06862592387483, 35.36039538202219, 154.18787947537652, 10.478177119085984, 2.1166385078557024, 229.0344449338356, 106.11728149333344, 125.33388059937042, 176.09375731914417, 193.1029732460752, 220.48002522108575, 58.2821427691912, -19.325943904072844, 6.112016168363173, 10.538604154602348, 174.68665540866377, 357.96131602015936, 208.6721265932952, -48.0508200011476, 335.9229372992488, 265.93348625676725, 77.27899716620999, 376.3110319999096, 29.037265453644416, 284.1253524497956, 15.382506604292905, 292.7898442976421, 242.63389281515583, 75.15712860108601, 55.13577272878844, -19.021029795382102, 4.864263011815622, 11.945761722834284, 34.47623259248237, -1.8663173482620483, 16.107849985823524, 300.92382896111803, 36.10389938609608, 328.48624237758133, -35.21292441931184, -25.635122841231823, 20.128775852283347, 70.11744430858616, 350.6402849565645, -4.762613718233416, 288.6101106249277, -39.64028338954677, 329.9378267462773, 60.07222958323438, 33.598993510591484, 19.969961560129367, 377.65078919884104, 344.0414526327221, -2.072271404304524, 167.6093176665937, 288.3852561371066, 114.68504145830914, 198.7660495519628, 185.27949104938955, 68.98078581047723, 355.206591943793, 9.652762899287877, 215.28582296173383, 40.25523758267082, 329.4209716043871, 279.837031715031, 311.4479018060473, 54.28971871852298, -20.638724648427548, 4.386600810679103, 133.89864076465412, 32.589664714355884, 29.960000000000278, 376.9736381723721, -39.89680296142332, 163.11836262708235, -14.833199536195405, -9.734481668772506, 26.929376235848395, 110.196404786845, 333.9503332546128, 360.4431991844848, 18.84793596532645, -57.47259993304425, 49.698851011303375, 368.99333389571143, 46.95357426065635, 359.4489501785986, -30.91839487729091, 22.079345154882603, 23.94055025019338, -31.100398126312523, -65.96362805530795], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [44.53736935489282, 27.06433885135487, -69.19791565331894, -76.40504026266761, 115.19033124011938, -29.206668883557942, 66.53920122063874, 23.544051755202446, -12.111597966267684, 18.42985377116655, -8.577552064558475, 80.04880625942002, -181.7739881326859, -44.045413501902225, 193.14217272801898, 121.29676774963511, -82.6377119111914, -110.78790798593053, -83.42313904577634, 113.70727134071134, -35.749112125518984, -186.8233358028898, -163.58304787537259, -128.92498604331348, -178.1450955086703, 148.93975854539397, -71.84206501281044, -47.50770903647789, -20.653783729523354, 5.22960089946311, 44.23458762319936, 78.45413230957726, 100.72398749118489, -14.875847145998677, -25.466914180563705, 74.8907779636969, 28.984291465107606, -83.99768425085566, -69.26840428542543, -80.34495315259635, -67.54932430365908, -16.40984451413771, -39.12298902830943, -120.52515768959823, 14.485484815536362, 53.697524478127505, 139.86669948561376, 199.01, 74.04882644427988, 103.43936007124907, -257.89248756922893, -128.1072849140747, 121.2465549547722, 191.09, 133.9214444521598, 100.7587472681002, -27.396932232137694, 35.994431970240036, 188.70098989502992, 185.15, -37.21379957346192, -68.25801360986564, 102.87196557976915, 138.6842758983803, -82.23439121378674, -141.2497136897932, 72.43541072608247, 147.65038727077587, 53.70921661239754, 145.81604708320094, -25.900597142374593, 8.538784291847133, 1.3679604182604674, -12.184197086572993, -151.03004503229087, -133.57985540081478, -77.39751662258399, -89.25478691561347, -289.5485294303203, -280.61078682552767, -37.93383470960746, -13.597148093294518, -95.343806843013, -116.14089767029955, -123.39379072581077, -74.78559821573825, 142.20772762529523, 133.12028805044113, -68.08745273724898, -60.656164518651444, 171.88064329147974, 118.61877372929119, -85.44870630589688, -85.39175425748678, -284.6191549812037, -147.60214035443667, -59.491090025711344, -106.2903697048244, -65.17760303033049, -15.745341978182452, 187.76046921017928, 126.27937580035675, -48.64898965567858, -186.35003728760333, 118.92242178864913, 132.62846911389687, -106.70592098978302, -194.0847510705344, 140.80304613326658, 149.39510746823117, -137.22406449370624, -219.92574789178667, -152.0569582884184, -117.41573080318875, -177.47348559276693, -105.60429815275543, 192.07999999999998, 181.32785456008477, 139.63759161958393, 189.11, -81.14469205359862, -94.66182343795478, 60.64030176463645, 63.17347639446797, 172.63733859800354, 82.33450714990275, 17.175657746885893, -82.56522974792499, -10.228593906591886, 91.8580727427924, 28.823041071309227, 108.01032097411124, -10.826800007121003, 9.143442753719011, 185.3118935424777, 149.86713161252192, -74.13346017262901, -81.827973185634, 57.03089481145585, 72.23214527433474, -45.59103245625657, -58.16963107352512, 172.60966660042084, 130.1024351112955, 118.850140362301, 139.12445935037, 107.94842224816175, 170.48793820394792, -118.38641183869697, -20.475927425735925, -210.34304899411427, -143.6607072727316, -45.45252406299012, -99.72218731351798, 22.076344582718285, 12.933565074551751, -74.04421079042267, -70.889367619013, -0.2968049595261075, -36.07087156101785, 192.12966084108487, 169.11313012306897, -86.16292830600342, -132.10818252843416, 137.44908018735973, 2.0000000000000013, -102.9270355916733, -112.38508894213221, -262.0553243917606, -153.47830773143522, -0.7205379830345138, -45.098281480925465, 64.8948884440144, -37.38326117343139, 175.34828609917452, 137.56063197173333, 178.96164567470856, 179.20999999999984, -46.25358701321962, -134.24679098218937, -170.90019473170528, -241.19892962240587, -122.27297499431296, -192.3836792675913, 178.8735368171188, 143.60921441896028, -60.23474240679754, -80.17745696759394, 190.91938811069505, 148.0183697412749, -78.3595631890245, -93.36397997119232, -122.52832864504609, -79.16545734960003, 7.335457505587832, -41.32610929670284, -64.94848277404306, -81.81075532299894, -100.49374436315851, -181.4401716329619], "policy_predator_policy_reward": [104.92528288006349, 27.70818025043302, 3.1425330832984892, 122.4766278782141, 61.900790908109606, 14.985264828350507, 46.209792140051505, 36.99590091921956, 60.53108550160841, 15.418886533162643, 115.76394154659916, 23.320524973898547, 246.3067532704013, 8.278865402336622, 26.698008377582536, 13.931677068638226, 120.14348824364153, 108.64252703550278, 75.50072169545092, 48.40302548499045, 46.86874791320522, 186.18187713428964, 108.99995513834133, 185.62471728820043, 110.6495114528903, 147.59027044422155, 159.50079811188147, 65.96625743074037, 38.09194760887449, 102.6661158205562, 13.29988185450697, 40.1051555318606, 36.002790903466995, 71.25204199742197, 64.4809878929642, 106.57517354498856, 7.796468622658376, 105.49906693228088, 23.414802228303984, 106.87261130564501, 67.46027451852618, 22.610910467633797, 161.83779411215843, 8.348956760351333, 101.23814743908771, 5.265498675912154, 8.771898481520356, 10.312718053025305, 2.8520178262861653, 28.331922251479956, 19.57778007080844, 318.37117241134774, 19.7534450452278, 3.832937299248846, 4.053578323014045, 27.199716213493232, 19.401530130013406, 49.27996729809417, 0.16103199990954825, 2.299010104970072, 34.583271192638485, 99.92580744433357, 18.218695439331537, 24.350415532314802, 93.09893931732657, 145.7676721905461, 34.628436877640986, 38.07560942314279, 40.22961914348254, 2.8790099760748484, 70.07346885022994, 22.44547260138356, 48.47994549866149, 17.47206389843951, 151.9533670258032, 113.63550361192054, 19.919156111041005, 151.59741043897196, 366.23323728378386, 215.87184069489828, 56.70192102839147, 29.305294366992957, 68.6965591986622, 140.92182796638826, 186.29608389667354, 27.991155030699083, 7.386932064301494, 18.20888122108033, 82.01207613302567, 82.83544050897092, 1.0810820507972994, 36.90574330601309, 120.21617912116132, 15.411357022910455, 333.62791936607204, 72.95825312833657, 102.13162425044254, 83.77861133237649, 70.06507930621734, 80.97531001088203, 26.02647433884365, 10.573965607184851, 55.71229938448738, 174.52411384056114, 19.358815385423554, 17.700404336958208, 25.429851851837224, 235.7205368189333, 27.673302232167504, 12.06637091261207, 225.39387505133027, 191.82816691739725, 149.1983031715006, 153.87337943069784, 110.59920348967741, 192.4485418159746, 3.3534134417377675, 0.8895211970185015, 11.41912229102863, 3.8747387221095364, 63.983597981502285, 109.75064610574658, 1.1361231099237143, 42.659416397565614, 6.728684819012252, 26.684725570188125, 0.0, 180.07461345934843, 30.953963550864586, 86.18260716489739, 39.25778883439774, 9.188340169571319, 70.66414306387917, 0.0, 7.8937874140365, 12.133779374756847, 98.877281193099, 66.73691506445188, 23.41254330394344, 62.61023957199974, 72.89514720697586, 71.12075390547655, 11.409348468978205, 15.299521423692534, 17.375628153322836, 4.48680384903738, 14.17939299584022, 18.832148358097584, 60.672028534227366, 132.48002944872852, 274.4024832703913, 58.96254834802707, 1.5193001983192835, 148.04201198886778, 51.85641554446761, 47.03231556291645, 80.68216579509985, 96.84107732869184, 66.32767652054393, 0.0, 8.997611658471843, 6.733235549746397, 176.0638612837261, 2.3104465892881123, 21.269300807505665, 2.399981632217018, 54.35703254531404, 146.12189245229595, 348.9658619846904, 56.833288469733176, 26.838943419124934, 45.90925228068339, 2.573339042650574, 80.11143847361095, 4.491704087449862, 16.549711096255113, 1.7563299970300854, 0.5152235127463038, 63.32127849967555, 136.02703546105965, 310.852073845587, 43.77445057547983, 134.47225038167235, 229.88325489153502, 2.492124333044685, 44.01845832658769, 91.85084256968675, 95.51493106536104, 0.5295620679035353, 19.981630258725094, 19.6130422911741, 121.1921059917518, 84.49969818151415, 139.27343296801467, 2.9507258849155646, 54.980476156392825, 86.53289403292484, 29.125945937804488, 213.05605521238851, 2.9142327284240133]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.328288967277898, "mean_inference_ms": 6.04480518193397, "mean_action_processing_ms": 1.015159907500296, "mean_env_wait_ms": 0.7961278972363454, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02382218837738037, "StateBufferConnector_ms": 0.013337373733520508, "ViewRequirementAgentConnector_ms": 0.3609941005706787}, "num_episodes": 22, "episode_return_max": 377.65078919884104, "episode_return_min": -65.96362805530795, "episode_return_mean": 125.5837649466802, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 928000, "num_agent_steps_trained": 928000, "num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 229.90298388908812, "num_env_steps_trained_throughput_per_sec": 229.90298388908812, "timesteps_total": 232000, "num_env_steps_sampled_lifetime": 232000, "num_agent_steps_sampled_lifetime": 928000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 928000, "timers": {"training_iteration_time_ms": 59614.45, "restore_workers_time_ms": 0.014, "training_step_time_ms": 59614.406, "sample_time_ms": 4307.115, "learn_time_ms": 55290.764, "learn_throughput": 72.345, "synch_weights_time_ms": 15.664}, "counters": {"num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_agent_steps_sampled": 928000, "num_agent_steps_trained": 928000}, "done": false, "training_iteration": 58, "trial_id": "d163c_00000", "date": "2024-08-16_13-14-23", "timestamp": 1723794263, "time_this_iter_s": 17.40329599380493, "time_total_s": 1482.869174003601, "pid": 81201, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16b976160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1482.869174003601, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 30.344000000000005, "ram_util_percent": 69.632}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.503074370237885, "cur_kl_coeff": 0.22500000000000006, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.572880755530464, "policy_loss": -0.002648368385921001, "vf_loss": 6.574136424695373, "vf_explained_var": 0.46166328869799456, "kl": 0.006189730297818926, "entropy": 0.5820567161317856, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 110565.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.00770715058796, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.477397187046273, "policy_loss": -0.004007165981629104, "vf_loss": 9.480299362303718, "vf_explained_var": 0.002693567988733766, "kl": 0.005524898504242885, "entropy": 1.1563891114381255, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 110565.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_agent_steps_sampled": 944000, "num_agent_steps_trained": 944000}, "env_runners": {"episode_reward_max": 377.65078919884104, "episode_reward_min": -65.96362805530795, "episode_reward_mean": 127.31881616591258, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -289.5485294303203, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 199.01, "predator_policy": 366.23323728378386}, "policy_reward_mean": {"prey_policy": -0.7585455491532577, "predator_policy": 64.41795363210957}, "custom_metrics": {}, "hist_stats": {"episode_reward": [58.2821427691912, -19.325943904072844, 6.112016168363173, 10.538604154602348, 174.68665540866377, 357.96131602015936, 208.6721265932952, -48.0508200011476, 335.9229372992488, 265.93348625676725, 77.27899716620999, 376.3110319999096, 29.037265453644416, 284.1253524497956, 15.382506604292905, 292.7898442976421, 242.63389281515583, 75.15712860108601, 55.13577272878844, -19.021029795382102, 4.864263011815622, 11.945761722834284, 34.47623259248237, -1.8663173482620483, 16.107849985823524, 300.92382896111803, 36.10389938609608, 328.48624237758133, -35.21292441931184, -25.635122841231823, 20.128775852283347, 70.11744430858616, 350.6402849565645, -4.762613718233416, 288.6101106249277, -39.64028338954677, 329.9378267462773, 60.07222958323438, 33.598993510591484, 19.969961560129367, 377.65078919884104, 344.0414526327221, -2.072271404304524, 167.6093176665937, 288.3852561371066, 114.68504145830914, 198.7660495519628, 185.27949104938955, 68.98078581047723, 355.206591943793, 9.652762899287877, 215.28582296173383, 40.25523758267082, 329.4209716043871, 279.837031715031, 311.4479018060473, 54.28971871852298, -20.638724648427548, 4.386600810679103, 133.89864076465412, 32.589664714355884, 29.960000000000278, 376.9736381723721, -39.89680296142332, 163.11836262708235, -14.833199536195405, -9.734481668772506, 26.929376235848395, 110.196404786845, 333.9503332546128, 360.4431991844848, 18.84793596532645, -57.47259993304425, 49.698851011303375, 368.99333389571143, 46.95357426065635, 359.4489501785986, -30.91839487729091, 22.079345154882603, 23.94055025019338, -31.100398126312523, -65.96362805530795, 351.4666773281, 0.8073837554443644, 21.912628234708954, 43.84354032281678, 310.8577093994799, 336.02216018278926, 316.45394481117296, -48.6976703862767, 204.3640595784864, 355.41733565075083, -16.296034755250542, 327.4065546303259, 12.576915103063186, 113.67095471313289, 3.4245947995950474, 302.4370677703836, -19.892646678498974, 7.104232787659108], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [28.984291465107606, -83.99768425085566, -69.26840428542543, -80.34495315259635, -67.54932430365908, -16.40984451413771, -39.12298902830943, -120.52515768959823, 14.485484815536362, 53.697524478127505, 139.86669948561376, 199.01, 74.04882644427988, 103.43936007124907, -257.89248756922893, -128.1072849140747, 121.2465549547722, 191.09, 133.9214444521598, 100.7587472681002, -27.396932232137694, 35.994431970240036, 188.70098989502992, 185.15, -37.21379957346192, -68.25801360986564, 102.87196557976915, 138.6842758983803, -82.23439121378674, -141.2497136897932, 72.43541072608247, 147.65038727077587, 53.70921661239754, 145.81604708320094, -25.900597142374593, 8.538784291847133, 1.3679604182604674, -12.184197086572993, -151.03004503229087, -133.57985540081478, -77.39751662258399, -89.25478691561347, -289.5485294303203, -280.61078682552767, -37.93383470960746, -13.597148093294518, -95.343806843013, -116.14089767029955, -123.39379072581077, -74.78559821573825, 142.20772762529523, 133.12028805044113, -68.08745273724898, -60.656164518651444, 171.88064329147974, 118.61877372929119, -85.44870630589688, -85.39175425748678, -284.6191549812037, -147.60214035443667, -59.491090025711344, -106.2903697048244, -65.17760303033049, -15.745341978182452, 187.76046921017928, 126.27937580035675, -48.64898965567858, -186.35003728760333, 118.92242178864913, 132.62846911389687, -106.70592098978302, -194.0847510705344, 140.80304613326658, 149.39510746823117, -137.22406449370624, -219.92574789178667, -152.0569582884184, -117.41573080318875, -177.47348559276693, -105.60429815275543, 192.07999999999998, 181.32785456008477, 139.63759161958393, 189.11, -81.14469205359862, -94.66182343795478, 60.64030176463645, 63.17347639446797, 172.63733859800354, 82.33450714990275, 17.175657746885893, -82.56522974792499, -10.228593906591886, 91.8580727427924, 28.823041071309227, 108.01032097411124, -10.826800007121003, 9.143442753719011, 185.3118935424777, 149.86713161252192, -74.13346017262901, -81.827973185634, 57.03089481145585, 72.23214527433474, -45.59103245625657, -58.16963107352512, 172.60966660042084, 130.1024351112955, 118.850140362301, 139.12445935037, 107.94842224816175, 170.48793820394792, -118.38641183869697, -20.475927425735925, -210.34304899411427, -143.6607072727316, -45.45252406299012, -99.72218731351798, 22.076344582718285, 12.933565074551751, -74.04421079042267, -70.889367619013, -0.2968049595261075, -36.07087156101785, 192.12966084108487, 169.11313012306897, -86.16292830600342, -132.10818252843416, 137.44908018735973, 2.0000000000000013, -102.9270355916733, -112.38508894213221, -262.0553243917606, -153.47830773143522, -0.7205379830345138, -45.098281480925465, 64.8948884440144, -37.38326117343139, 175.34828609917452, 137.56063197173333, 178.96164567470856, 179.20999999999984, -46.25358701321962, -134.24679098218937, -170.90019473170528, -241.19892962240587, -122.27297499431296, -192.3836792675913, 178.8735368171188, 143.60921441896028, -60.23474240679754, -80.17745696759394, 190.91938811069505, 148.0183697412749, -78.3595631890245, -93.36397997119232, -122.52832864504609, -79.16545734960003, 7.335457505587832, -41.32610929670284, -64.94848277404306, -81.81075532299894, -100.49374436315851, -181.4401716329619, 159.77041114622398, 166.17592699184084, -76.04822808603795, -57.22115468742834, -103.70152365938333, -220.90798902010263, -19.689185605517977, -5.134298149541344, 156.12478833409926, 121.3647541264314, 162.5193459918779, 151.06309852190506, 73.7712769004505, 169.55177694816382, -82.59354192188243, -70.63481887417448, 57.83270639547752, 69.61577255607553, 135.54447722042005, 197.6145175293944, -77.38647202497701, -52.97414091283748, 151.660617762177, 166.94465114380543, -116.93083937490134, -121.61435593386702, 33.99910861050506, 29.46084898139544, -0.8801078458095635, 0.07977589280902865, 81.8318084008762, 144.69660393417013, -42.56412296495727, -51.85659743306108, -68.98718601380732, -109.0541447879515], "policy_predator_policy_reward": [7.796468622658376, 105.49906693228088, 23.414802228303984, 106.87261130564501, 67.46027451852618, 22.610910467633797, 161.83779411215843, 8.348956760351333, 101.23814743908771, 5.265498675912154, 8.771898481520356, 10.312718053025305, 2.8520178262861653, 28.331922251479956, 19.57778007080844, 318.37117241134774, 19.7534450452278, 3.832937299248846, 4.053578323014045, 27.199716213493232, 19.401530130013406, 49.27996729809417, 0.16103199990954825, 2.299010104970072, 34.583271192638485, 99.92580744433357, 18.218695439331537, 24.350415532314802, 93.09893931732657, 145.7676721905461, 34.628436877640986, 38.07560942314279, 40.22961914348254, 2.8790099760748484, 70.07346885022994, 22.44547260138356, 48.47994549866149, 17.47206389843951, 151.9533670258032, 113.63550361192054, 19.919156111041005, 151.59741043897196, 366.23323728378386, 215.87184069489828, 56.70192102839147, 29.305294366992957, 68.6965591986622, 140.92182796638826, 186.29608389667354, 27.991155030699083, 7.386932064301494, 18.20888122108033, 82.01207613302567, 82.83544050897092, 1.0810820507972994, 36.90574330601309, 120.21617912116132, 15.411357022910455, 333.62791936607204, 72.95825312833657, 102.13162425044254, 83.77861133237649, 70.06507930621734, 80.97531001088203, 26.02647433884365, 10.573965607184851, 55.71229938448738, 174.52411384056114, 19.358815385423554, 17.700404336958208, 25.429851851837224, 235.7205368189333, 27.673302232167504, 12.06637091261207, 225.39387505133027, 191.82816691739725, 149.1983031715006, 153.87337943069784, 110.59920348967741, 192.4485418159746, 3.3534134417377675, 0.8895211970185015, 11.41912229102863, 3.8747387221095364, 63.983597981502285, 109.75064610574658, 1.1361231099237143, 42.659416397565614, 6.728684819012252, 26.684725570188125, 0.0, 180.07461345934843, 30.953963550864586, 86.18260716489739, 39.25778883439774, 9.188340169571319, 70.66414306387917, 0.0, 7.8937874140365, 12.133779374756847, 98.877281193099, 66.73691506445188, 23.41254330394344, 62.61023957199974, 72.89514720697586, 71.12075390547655, 11.409348468978205, 15.299521423692534, 17.375628153322836, 4.48680384903738, 14.17939299584022, 18.832148358097584, 60.672028534227366, 132.48002944872852, 274.4024832703913, 58.96254834802707, 1.5193001983192835, 148.04201198886778, 51.85641554446761, 47.03231556291645, 80.68216579509985, 96.84107732869184, 66.32767652054393, 0.0, 8.997611658471843, 6.733235549746397, 176.0638612837261, 2.3104465892881123, 21.269300807505665, 2.399981632217018, 54.35703254531404, 146.12189245229595, 348.9658619846904, 56.833288469733176, 26.838943419124934, 45.90925228068339, 2.573339042650574, 80.11143847361095, 4.491704087449862, 16.549711096255113, 1.7563299970300854, 0.5152235127463038, 63.32127849967555, 136.02703546105965, 310.852073845587, 43.77445057547983, 134.47225038167235, 229.88325489153502, 2.492124333044685, 44.01845832658769, 91.85084256968675, 95.51493106536104, 0.5295620679035353, 19.981630258725094, 19.6130422911741, 121.1921059917518, 84.49969818151415, 139.27343296801467, 2.9507258849155646, 54.980476156392825, 86.53289403292484, 29.125945937804488, 213.05605521238851, 2.9142327284240133, 16.214532257211985, 9.30580693282331, 76.57202210102689, 57.504744427883885, 168.00318415908583, 178.51895675510937, 11.2396419745333, 57.427382103342836, 5.436353972428955, 27.931812966520344, 14.888492683076967, 7.551222985929345, 28.527191831351757, 44.6036991312074, 95.46086676613373, 9.069823643646474, 51.11673981288774, 25.798840814045597, 2.792818121356436, 19.465522779579935, 98.99830093049592, 15.066277252067989, 7.3924924783077905, 1.4087932460360744, 143.98731136574065, 107.13479904609069, 7.909890915186719, 42.301106206045745, 1.9742506705159872, 2.2506760820796097, 40.84786711318154, 35.06078832215571, 7.1857332583426, 67.34234046117685, 76.8342781445425, 108.31128544487542]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.3239361473891944, "mean_inference_ms": 6.035632310942922, "mean_action_processing_ms": 1.0124268852850589, "mean_env_wait_ms": 0.794175595055718, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02659320831298828, "StateBufferConnector_ms": 0.013186216354370117, "ViewRequirementAgentConnector_ms": 0.35739779472351074}, "num_episodes": 18, "episode_return_max": 377.65078919884104, "episode_return_min": -65.96362805530795, "episode_return_mean": 127.31881616591258, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 944000, "num_agent_steps_trained": 944000, "num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 248.69454093827505, "num_env_steps_trained_throughput_per_sec": 248.69454093827505, "timesteps_total": 236000, "num_env_steps_sampled_lifetime": 236000, "num_agent_steps_sampled_lifetime": 944000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 944000, "timers": {"training_iteration_time_ms": 40397.515, "restore_workers_time_ms": 0.014, "training_step_time_ms": 40397.471, "sample_time_ms": 4237.491, "learn_time_ms": 36142.768, "learn_throughput": 110.672, "synch_weights_time_ms": 16.328}, "counters": {"num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_agent_steps_sampled": 944000, "num_agent_steps_trained": 944000}, "done": false, "training_iteration": 59, "trial_id": "d163c_00000", "date": "2024-08-16_13-14-39", "timestamp": 1723794279, "time_this_iter_s": 16.08847212791443, "time_total_s": 1498.9576461315155, "pid": 81201, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16b85a160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1498.9576461315155, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 28.234782608695642, "ram_util_percent": 70.21304347826089}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.154521083579493, "cur_kl_coeff": 0.22500000000000006, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.135584209583424, "policy_loss": -0.005366893408440605, "vf_loss": 7.139085308206145, "vf_explained_var": 0.4296623859140608, "kl": 0.00829246319763809, "entropy": 0.54510405615524, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 112455.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.460197314446566, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.38412591792919, "policy_loss": -0.006465063720852846, "vf_loss": 9.388902401797987, "vf_explained_var": -0.057121458917698535, "kl": 0.008442819638742946, "entropy": 1.1290004161299851, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 112455.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_agent_steps_sampled": 960000, "num_agent_steps_trained": 960000}, "env_runners": {"episode_reward_max": 377.65078919884104, "episode_reward_min": -65.96362805530795, "episode_reward_mean": 119.58316503091933, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -284.6191549812037, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 197.6145175293944, "predator_policy": 348.9658619846904}, "policy_reward_mean": {"prey_policy": -6.349415473917457, "predator_policy": 66.14099798937713}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.8663173482620483, 16.107849985823524, 300.92382896111803, 36.10389938609608, 328.48624237758133, -35.21292441931184, -25.635122841231823, 20.128775852283347, 70.11744430858616, 350.6402849565645, -4.762613718233416, 288.6101106249277, -39.64028338954677, 329.9378267462773, 60.07222958323438, 33.598993510591484, 19.969961560129367, 377.65078919884104, 344.0414526327221, -2.072271404304524, 167.6093176665937, 288.3852561371066, 114.68504145830914, 198.7660495519628, 185.27949104938955, 68.98078581047723, 355.206591943793, 9.652762899287877, 215.28582296173383, 40.25523758267082, 329.4209716043871, 279.837031715031, 311.4479018060473, 54.28971871852298, -20.638724648427548, 4.386600810679103, 133.89864076465412, 32.589664714355884, 29.960000000000278, 376.9736381723721, -39.89680296142332, 163.11836262708235, -14.833199536195405, -9.734481668772506, 26.929376235848395, 110.196404786845, 333.9503332546128, 360.4431991844848, 18.84793596532645, -57.47259993304425, 49.698851011303375, 368.99333389571143, 46.95357426065635, 359.4489501785986, -30.91839487729091, 22.079345154882603, 23.94055025019338, -31.100398126312523, -65.96362805530795, 351.4666773281, 0.8073837554443644, 21.912628234708954, 43.84354032281678, 310.8577093994799, 336.02216018278926, 316.45394481117296, -48.6976703862767, 204.3640595784864, 355.41733565075083, -16.296034755250542, 327.4065546303259, 12.576915103063186, 113.67095471313289, 3.4245947995950474, 302.4370677703836, -19.892646678498974, 7.104232787659108, 28.111531796983897, 319.90385645073127, 367.89742331363266, 218.37697161306932, 298.5352228845991, 18.8670736574404, 20.627021731400102, 34.23173921570937, -38.160718340013744, 87.88571539690237, -41.98078050023642, 222.75202906818478, -24.66954272157427, -27.330717978465618, 271.42952371938503, 28.561964712290017, 84.48745118238756, 45.93570997273825, 91.6601480536289, 17.76297603886615, -21.998008506289292, 48.930007294774654, 5.4678288578735454], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-95.343806843013, -116.14089767029955, -123.39379072581077, -74.78559821573825, 142.20772762529523, 133.12028805044113, -68.08745273724898, -60.656164518651444, 171.88064329147974, 118.61877372929119, -85.44870630589688, -85.39175425748678, -284.6191549812037, -147.60214035443667, -59.491090025711344, -106.2903697048244, -65.17760303033049, -15.745341978182452, 187.76046921017928, 126.27937580035675, -48.64898965567858, -186.35003728760333, 118.92242178864913, 132.62846911389687, -106.70592098978302, -194.0847510705344, 140.80304613326658, 149.39510746823117, -137.22406449370624, -219.92574789178667, -152.0569582884184, -117.41573080318875, -177.47348559276693, -105.60429815275543, 192.07999999999998, 181.32785456008477, 139.63759161958393, 189.11, -81.14469205359862, -94.66182343795478, 60.64030176463645, 63.17347639446797, 172.63733859800354, 82.33450714990275, 17.175657746885893, -82.56522974792499, -10.228593906591886, 91.8580727427924, 28.823041071309227, 108.01032097411124, -10.826800007121003, 9.143442753719011, 185.3118935424777, 149.86713161252192, -74.13346017262901, -81.827973185634, 57.03089481145585, 72.23214527433474, -45.59103245625657, -58.16963107352512, 172.60966660042084, 130.1024351112955, 118.850140362301, 139.12445935037, 107.94842224816175, 170.48793820394792, -118.38641183869697, -20.475927425735925, -210.34304899411427, -143.6607072727316, -45.45252406299012, -99.72218731351798, 22.076344582718285, 12.933565074551751, -74.04421079042267, -70.889367619013, -0.2968049595261075, -36.07087156101785, 192.12966084108487, 169.11313012306897, -86.16292830600342, -132.10818252843416, 137.44908018735973, 2.0000000000000013, -102.9270355916733, -112.38508894213221, -262.0553243917606, -153.47830773143522, -0.7205379830345138, -45.098281480925465, 64.8948884440144, -37.38326117343139, 175.34828609917452, 137.56063197173333, 178.96164567470856, 179.20999999999984, -46.25358701321962, -134.24679098218937, -170.90019473170528, -241.19892962240587, -122.27297499431296, -192.3836792675913, 178.8735368171188, 143.60921441896028, -60.23474240679754, -80.17745696759394, 190.91938811069505, 148.0183697412749, -78.3595631890245, -93.36397997119232, -122.52832864504609, -79.16545734960003, 7.335457505587832, -41.32610929670284, -64.94848277404306, -81.81075532299894, -100.49374436315851, -181.4401716329619, 159.77041114622398, 166.17592699184084, -76.04822808603795, -57.22115468742834, -103.70152365938333, -220.90798902010263, -19.689185605517977, -5.134298149541344, 156.12478833409926, 121.3647541264314, 162.5193459918779, 151.06309852190506, 73.7712769004505, 169.55177694816382, -82.59354192188243, -70.63481887417448, 57.83270639547752, 69.61577255607553, 135.54447722042005, 197.6145175293944, -77.38647202497701, -52.97414091283748, 151.660617762177, 166.94465114380543, -116.93083937490134, -121.61435593386702, 33.99910861050506, 29.46084898139544, -0.8801078458095635, 0.07977589280902865, 81.8318084008762, 144.69660393417013, -42.56412296495727, -51.85659743306108, -68.98718601380732, -109.0541447879515, -106.85466715667847, -70.570646915125, 149.11225990398168, 143.20362728505717, 185.98030066390803, 169.24865427247587, 165.47189783567518, -67.76413162782961, 127.43537416322937, 130.18992388534406, -24.871043210695518, -23.370068300320963, -86.6200137162254, -158.47154953242818, -48.808233116296435, -82.10979818311837, -158.58064853604517, -87.69392231562405, -44.64877839124276, 45.32187806501012, -136.7794608885307, -87.18457186416205, 103.39350244510788, 59.91530221934027, -81.9011094979832, -69.54452548959394, -61.728380891302535, -101.57773519798859, 115.14349527663141, 136.3006684529504, -138.87623812481203, 2.0000000000000013, 13.227486332099588, 25.400254590694896, -19.85870296259854, -139.50276475301072, 14.917916033862715, -86.65443766117886, -101.1835311821183, -220.47296161011909, -57.82624269855752, -60.11023795370449, -117.16148279830901, -116.88500158332644, -85.12236029093154, -150.8431540333523], "policy_predator_policy_reward": [68.6965591986622, 140.92182796638826, 186.29608389667354, 27.991155030699083, 7.386932064301494, 18.20888122108033, 82.01207613302567, 82.83544050897092, 1.0810820507972994, 36.90574330601309, 120.21617912116132, 15.411357022910455, 333.62791936607204, 72.95825312833657, 102.13162425044254, 83.77861133237649, 70.06507930621734, 80.97531001088203, 26.02647433884365, 10.573965607184851, 55.71229938448738, 174.52411384056114, 19.358815385423554, 17.700404336958208, 25.429851851837224, 235.7205368189333, 27.673302232167504, 12.06637091261207, 225.39387505133027, 191.82816691739725, 149.1983031715006, 153.87337943069784, 110.59920348967741, 192.4485418159746, 3.3534134417377675, 0.8895211970185015, 11.41912229102863, 3.8747387221095364, 63.983597981502285, 109.75064610574658, 1.1361231099237143, 42.659416397565614, 6.728684819012252, 26.684725570188125, 0.0, 180.07461345934843, 30.953963550864586, 86.18260716489739, 39.25778883439774, 9.188340169571319, 70.66414306387917, 0.0, 7.8937874140365, 12.133779374756847, 98.877281193099, 66.73691506445188, 23.41254330394344, 62.61023957199974, 72.89514720697586, 71.12075390547655, 11.409348468978205, 15.299521423692534, 17.375628153322836, 4.48680384903738, 14.17939299584022, 18.832148358097584, 60.672028534227366, 132.48002944872852, 274.4024832703913, 58.96254834802707, 1.5193001983192835, 148.04201198886778, 51.85641554446761, 47.03231556291645, 80.68216579509985, 96.84107732869184, 66.32767652054393, 0.0, 8.997611658471843, 6.733235549746397, 176.0638612837261, 2.3104465892881123, 21.269300807505665, 2.399981632217018, 54.35703254531404, 146.12189245229595, 348.9658619846904, 56.833288469733176, 26.838943419124934, 45.90925228068339, 2.573339042650574, 80.11143847361095, 4.491704087449862, 16.549711096255113, 1.7563299970300854, 0.5152235127463038, 63.32127849967555, 136.02703546105965, 310.852073845587, 43.77445057547983, 134.47225038167235, 229.88325489153502, 2.492124333044685, 44.01845832658769, 91.85084256968675, 95.51493106536104, 0.5295620679035353, 19.981630258725094, 19.6130422911741, 121.1921059917518, 84.49969818151415, 139.27343296801467, 2.9507258849155646, 54.980476156392825, 86.53289403292484, 29.125945937804488, 213.05605521238851, 2.9142327284240133, 16.214532257211985, 9.30580693282331, 76.57202210102689, 57.504744427883885, 168.00318415908583, 178.51895675510937, 11.2396419745333, 57.427382103342836, 5.436353972428955, 27.931812966520344, 14.888492683076967, 7.551222985929345, 28.527191831351757, 44.6036991312074, 95.46086676613373, 9.069823643646474, 51.11673981288774, 25.798840814045597, 2.792818121356436, 19.465522779579935, 98.99830093049592, 15.066277252067989, 7.3924924783077905, 1.4087932460360744, 143.98731136574065, 107.13479904609069, 7.909890915186719, 42.301106206045745, 1.9742506705159872, 2.2506760820796097, 40.84786711318154, 35.06078832215571, 7.1857332583426, 67.34234046117685, 76.8342781445425, 108.31128544487542, 70.62745928822984, 134.90938658055754, 21.082385554204382, 6.505583707488111, 5.025464847789592, 7.643003529459197, 62.60427079908424, 58.06493460613963, 13.584569137354054, 27.325355698671565, 65.0251908174809, 2.082994350976075, 76.56904753246737, 189.14953744758643, 80.74898237657173, 84.40078813855247, 29.697334900503204, 178.41651761115216, 60.423538124008736, 26.789077599126248, 180.02962492393982, 1.953627328516603, 43.90193706222495, 15.541287341511609, 24.45918551527975, 102.31690675072313, 18.526440233892636, 117.44895787693301, 1.6595237193850145, 18.325836270418172, 35.864403697138805, 129.57379913996334, 1.4264953986464588, 44.433214860946556, 96.56506661224003, 108.73211107610742, 70.58507887338502, 92.81159080756004, 115.21517975852026, 224.20428907258355, 22.938091089598398, 73.00038105637434, 112.4710620238749, 170.5054296525347, 85.25817883038562, 156.17516435177205]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.319001517043319, "mean_inference_ms": 6.021941616547066, "mean_action_processing_ms": 1.00911269308785, "mean_env_wait_ms": 0.7925552504863941, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01934373378753662, "StateBufferConnector_ms": 0.012534737586975098, "ViewRequirementAgentConnector_ms": 0.37630903720855713}, "num_episodes": 23, "episode_return_max": 377.65078919884104, "episode_return_min": -65.96362805530795, "episode_return_mean": 119.58316503091933, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 960000, "num_agent_steps_trained": 960000, "num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 252.99450892719676, "num_env_steps_trained_throughput_per_sec": 252.99450892719676, "timesteps_total": 240000, "num_env_steps_sampled_lifetime": 240000, "num_agent_steps_sampled_lifetime": 960000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 960000, "timers": {"training_iteration_time_ms": 40193.498, "restore_workers_time_ms": 0.014, "training_step_time_ms": 40193.455, "sample_time_ms": 4353.171, "learn_time_ms": 35823.159, "learn_throughput": 111.66, "synch_weights_time_ms": 16.236}, "counters": {"num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_agent_steps_sampled": 960000, "num_agent_steps_trained": 960000}, "done": false, "training_iteration": 60, "trial_id": "d163c_00000", "date": "2024-08-16_13-14-55", "timestamp": 1723794295, "time_this_iter_s": 15.815252780914307, "time_total_s": 1514.7728989124298, "pid": 81201, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16b8191f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1514.7728989124298, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 28.08636363636363, "ram_util_percent": 69.99545454545455}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.734088130224318, "cur_kl_coeff": 0.22500000000000006, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.344110967999413, "policy_loss": -0.005368804689693861, "vf_loss": 7.346684153370125, "vf_explained_var": 0.605018666780815, "kl": 0.01242492485807458, "entropy": 0.5214850929679063, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 114345.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.108237305835441, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.241016469682966, "policy_loss": -0.004662890772694948, "vf_loss": 9.24391145453882, "vf_explained_var": -0.07709390076379928, "kl": 0.008839583273196004, "entropy": 1.1050613970983596, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 114345.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_agent_steps_sampled": 976000, "num_agent_steps_trained": 976000}, "env_runners": {"episode_reward_max": 376.9736381723721, "episode_reward_min": -65.96362805530795, "episode_reward_mean": 119.02636488195176, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -262.0553243917606, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 197.6145175293944, "predator_policy": 348.9658619846904}, "policy_reward_mean": {"prey_policy": -1.0017123494068825, "predator_policy": 60.51489479038277}, "custom_metrics": {}, "hist_stats": {"episode_reward": [344.0414526327221, -2.072271404304524, 167.6093176665937, 288.3852561371066, 114.68504145830914, 198.7660495519628, 185.27949104938955, 68.98078581047723, 355.206591943793, 9.652762899287877, 215.28582296173383, 40.25523758267082, 329.4209716043871, 279.837031715031, 311.4479018060473, 54.28971871852298, -20.638724648427548, 4.386600810679103, 133.89864076465412, 32.589664714355884, 29.960000000000278, 376.9736381723721, -39.89680296142332, 163.11836262708235, -14.833199536195405, -9.734481668772506, 26.929376235848395, 110.196404786845, 333.9503332546128, 360.4431991844848, 18.84793596532645, -57.47259993304425, 49.698851011303375, 368.99333389571143, 46.95357426065635, 359.4489501785986, -30.91839487729091, 22.079345154882603, 23.94055025019338, -31.100398126312523, -65.96362805530795, 351.4666773281, 0.8073837554443644, 21.912628234708954, 43.84354032281678, 310.8577093994799, 336.02216018278926, 316.45394481117296, -48.6976703862767, 204.3640595784864, 355.41733565075083, -16.296034755250542, 327.4065546303259, 12.576915103063186, 113.67095471313289, 3.4245947995950474, 302.4370677703836, -19.892646678498974, 7.104232787659108, 28.111531796983897, 319.90385645073127, 367.89742331363266, 218.37697161306932, 298.5352228845991, 18.8670736574404, 20.627021731400102, 34.23173921570937, -38.160718340013744, 87.88571539690237, -41.98078050023642, 222.75202906818478, -24.66954272157427, -27.330717978465618, 271.42952371938503, 28.561964712290017, 84.48745118238756, 45.93570997273825, 91.6601480536289, 17.76297603886615, -21.998008506289292, 48.930007294774654, 5.4678288578735454, -33.85371257900761, 151.1139356443461, 134.23893634911394, 113.52089637473038, 14.779841647762721, 59.355336353320226, 293.4342730946336, 97.97992539073809, 271.59706839994885, -1.5400012890942052, 25.936736069657233, 21.16117210058199, 124.98123559566547, 309.77006128761406, 17.93162393669246, 181.7827985055685, 37.15092192011144, 250.20991163632988], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [139.63759161958393, 189.11, -81.14469205359862, -94.66182343795478, 60.64030176463645, 63.17347639446797, 172.63733859800354, 82.33450714990275, 17.175657746885893, -82.56522974792499, -10.228593906591886, 91.8580727427924, 28.823041071309227, 108.01032097411124, -10.826800007121003, 9.143442753719011, 185.3118935424777, 149.86713161252192, -74.13346017262901, -81.827973185634, 57.03089481145585, 72.23214527433474, -45.59103245625657, -58.16963107352512, 172.60966660042084, 130.1024351112955, 118.850140362301, 139.12445935037, 107.94842224816175, 170.48793820394792, -118.38641183869697, -20.475927425735925, -210.34304899411427, -143.6607072727316, -45.45252406299012, -99.72218731351798, 22.076344582718285, 12.933565074551751, -74.04421079042267, -70.889367619013, -0.2968049595261075, -36.07087156101785, 192.12966084108487, 169.11313012306897, -86.16292830600342, -132.10818252843416, 137.44908018735973, 2.0000000000000013, -102.9270355916733, -112.38508894213221, -262.0553243917606, -153.47830773143522, -0.7205379830345138, -45.098281480925465, 64.8948884440144, -37.38326117343139, 175.34828609917452, 137.56063197173333, 178.96164567470856, 179.20999999999984, -46.25358701321962, -134.24679098218937, -170.90019473170528, -241.19892962240587, -122.27297499431296, -192.3836792675913, 178.8735368171188, 143.60921441896028, -60.23474240679754, -80.17745696759394, 190.91938811069505, 148.0183697412749, -78.3595631890245, -93.36397997119232, -122.52832864504609, -79.16545734960003, 7.335457505587832, -41.32610929670284, -64.94848277404306, -81.81075532299894, -100.49374436315851, -181.4401716329619, 159.77041114622398, 166.17592699184084, -76.04822808603795, -57.22115468742834, -103.70152365938333, -220.90798902010263, -19.689185605517977, -5.134298149541344, 156.12478833409926, 121.3647541264314, 162.5193459918779, 151.06309852190506, 73.7712769004505, 169.55177694816382, -82.59354192188243, -70.63481887417448, 57.83270639547752, 69.61577255607553, 135.54447722042005, 197.6145175293944, -77.38647202497701, -52.97414091283748, 151.660617762177, 166.94465114380543, -116.93083937490134, -121.61435593386702, 33.99910861050506, 29.46084898139544, -0.8801078458095635, 0.07977589280902865, 81.8318084008762, 144.69660393417013, -42.56412296495727, -51.85659743306108, -68.98718601380732, -109.0541447879515, -106.85466715667847, -70.570646915125, 149.11225990398168, 143.20362728505717, 185.98030066390803, 169.24865427247587, 165.47189783567518, -67.76413162782961, 127.43537416322937, 130.18992388534406, -24.871043210695518, -23.370068300320963, -86.6200137162254, -158.47154953242818, -48.808233116296435, -82.10979818311837, -158.58064853604517, -87.69392231562405, -44.64877839124276, 45.32187806501012, -136.7794608885307, -87.18457186416205, 103.39350244510788, 59.91530221934027, -81.9011094979832, -69.54452548959394, -61.728380891302535, -101.57773519798859, 115.14349527663141, 136.3006684529504, -138.87623812481203, 2.0000000000000013, 13.227486332099588, 25.400254590694896, -19.85870296259854, -139.50276475301072, 14.917916033862715, -86.65443766117886, -101.1835311821183, -220.47296161011909, -57.82624269855752, -60.11023795370449, -117.16148279830901, -116.88500158332644, -85.12236029093154, -150.8431540333523, -87.38526909049781, -74.79458397033417, 58.637360609107986, 54.63719604568299, 2.0000000000000013, 106.95325065404427, 57.16771880266295, -8.482038912529685, -85.30009563315281, 1.4579352098761997, -67.72011830351835, -12.845895290090048, 130.50091188018467, 128.06307285690502, 2.9918737143184573, 18.35854770090129, 95.35396109140956, 135.80230856106806, -48.804232339998514, -71.60272879638426, -91.14102532776194, -83.21153145813271, -71.98308167296703, -108.00867724083787, -28.78709191871233, 7.821309450024208, 152.11608449891827, 134.15430940550806, -130.47990935142678, -128.29068744763336, 58.5402948679963, 51.79594580640678, -142.57637552685955, -145.14974962806988, 114.92741440924911, 106.18454244287318], "policy_predator_policy_reward": [11.41912229102863, 3.8747387221095364, 63.983597981502285, 109.75064610574658, 1.1361231099237143, 42.659416397565614, 6.728684819012252, 26.684725570188125, 0.0, 180.07461345934843, 30.953963550864586, 86.18260716489739, 39.25778883439774, 9.188340169571319, 70.66414306387917, 0.0, 7.8937874140365, 12.133779374756847, 98.877281193099, 66.73691506445188, 23.41254330394344, 62.61023957199974, 72.89514720697586, 71.12075390547655, 11.409348468978205, 15.299521423692534, 17.375628153322836, 4.48680384903738, 14.17939299584022, 18.832148358097584, 60.672028534227366, 132.48002944872852, 274.4024832703913, 58.96254834802707, 1.5193001983192835, 148.04201198886778, 51.85641554446761, 47.03231556291645, 80.68216579509985, 96.84107732869184, 66.32767652054393, 0.0, 8.997611658471843, 6.733235549746397, 176.0638612837261, 2.3104465892881123, 21.269300807505665, 2.399981632217018, 54.35703254531404, 146.12189245229595, 348.9658619846904, 56.833288469733176, 26.838943419124934, 45.90925228068339, 2.573339042650574, 80.11143847361095, 4.491704087449862, 16.549711096255113, 1.7563299970300854, 0.5152235127463038, 63.32127849967555, 136.02703546105965, 310.852073845587, 43.77445057547983, 134.47225038167235, 229.88325489153502, 2.492124333044685, 44.01845832658769, 91.85084256968675, 95.51493106536104, 0.5295620679035353, 19.981630258725094, 19.6130422911741, 121.1921059917518, 84.49969818151415, 139.27343296801467, 2.9507258849155646, 54.980476156392825, 86.53289403292484, 29.125945937804488, 213.05605521238851, 2.9142327284240133, 16.214532257211985, 9.30580693282331, 76.57202210102689, 57.504744427883885, 168.00318415908583, 178.51895675510937, 11.2396419745333, 57.427382103342836, 5.436353972428955, 27.931812966520344, 14.888492683076967, 7.551222985929345, 28.527191831351757, 44.6036991312074, 95.46086676613373, 9.069823643646474, 51.11673981288774, 25.798840814045597, 2.792818121356436, 19.465522779579935, 98.99830093049592, 15.066277252067989, 7.3924924783077905, 1.4087932460360744, 143.98731136574065, 107.13479904609069, 7.909890915186719, 42.301106206045745, 1.9742506705159872, 2.2506760820796097, 40.84786711318154, 35.06078832215571, 7.1857332583426, 67.34234046117685, 76.8342781445425, 108.31128544487542, 70.62745928822984, 134.90938658055754, 21.082385554204382, 6.505583707488111, 5.025464847789592, 7.643003529459197, 62.60427079908424, 58.06493460613963, 13.584569137354054, 27.325355698671565, 65.0251908174809, 2.082994350976075, 76.56904753246737, 189.14953744758643, 80.74898237657173, 84.40078813855247, 29.697334900503204, 178.41651761115216, 60.423538124008736, 26.789077599126248, 180.02962492393982, 1.953627328516603, 43.90193706222495, 15.541287341511609, 24.45918551527975, 102.31690675072313, 18.526440233892636, 117.44895787693301, 1.6595237193850145, 18.325836270418172, 35.864403697138805, 129.57379913996334, 1.4264953986464588, 44.433214860946556, 96.56506661224003, 108.73211107610742, 70.58507887338502, 92.81159080756004, 115.21517975852026, 224.20428907258355, 22.938091089598398, 73.00038105637434, 112.4710620238749, 170.5054296525347, 85.25817883038562, 156.17516435177205, 10.338303858689526, 117.98783662313468, 7.775796003078567, 30.06358298647643, 2.198936349113819, 23.08674934595575, 12.59886924601519, 52.23634723858175, 94.26062148832774, 4.36138058271161, 76.68715819287594, 63.23419175405263, 14.059377532473336, 20.81091082507029, 25.2518747814963, 51.37762919402195, 31.78468679882639, 8.656111948644913, 30.172690457922517, 88.69426938936604, 110.61578443050398, 89.67350842504783, 95.25964852595568, 105.89328248843148, 86.06747708070199, 59.8795409836516, 9.53385008378029, 13.965817299407634, 182.89574908862556, 93.80647164712684, 24.766902834133333, 46.6796549970321, 183.78616805054918, 141.09087902449164, 26.813660826959964, 2.2842939572476144]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.3154424337291846, "mean_inference_ms": 6.011492377340371, "mean_action_processing_ms": 1.0065786611902876, "mean_env_wait_ms": 0.7914870252376595, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.019365787506103516, "StateBufferConnector_ms": 0.012499213218688965, "ViewRequirementAgentConnector_ms": 0.36033499240875244}, "num_episodes": 18, "episode_return_max": 376.9736381723721, "episode_return_min": -65.96362805530795, "episode_return_mean": 119.02636488195176, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 976000, "num_agent_steps_trained": 976000, "num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 235.5310454054826, "num_env_steps_trained_throughput_per_sec": 235.5310454054826, "timesteps_total": 244000, "num_env_steps_sampled_lifetime": 244000, "num_agent_steps_sampled_lifetime": 976000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 976000, "timers": {"training_iteration_time_ms": 40060.075, "restore_workers_time_ms": 0.014, "training_step_time_ms": 40060.032, "sample_time_ms": 4308.063, "learn_time_ms": 35734.884, "learn_throughput": 111.935, "synch_weights_time_ms": 16.192}, "counters": {"num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_agent_steps_sampled": 976000, "num_agent_steps_trained": 976000}, "done": false, "training_iteration": 61, "trial_id": "d163c_00000", "date": "2024-08-16_13-15-12", "timestamp": 1723794312, "time_this_iter_s": 16.987558841705322, "time_total_s": 1531.7604577541351, "pid": 81201, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16b8144c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1531.7604577541351, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 30.629166666666666, "ram_util_percent": 69.61666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.803111490875326, "cur_kl_coeff": 0.22500000000000006, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.4370785062275235, "policy_loss": -0.0036094896232945813, "vf_loss": 7.439538367589315, "vf_explained_var": 0.33546447892668385, "kl": 0.005109503647766148, "entropy": 0.5361488044104248, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 116235.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.399685404792664, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.463691645829135, "policy_loss": -0.005133721064628353, "vf_loss": 9.467089034388305, "vf_explained_var": -0.001622520363520062, "kl": 0.008681724705942365, "entropy": 1.1068192801147543, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 116235.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_agent_steps_sampled": 992000, "num_agent_steps_trained": 992000}, "env_runners": {"episode_reward_max": 376.9736381723721, "episode_reward_min": -65.96362805530795, "episode_reward_mean": 99.84159973861311, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -262.0553243917606, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 197.6145175293944, "predator_policy": 348.9658619846904}, "policy_reward_mean": {"prey_policy": -16.348891797598366, "predator_policy": 66.2696916669049}, "custom_metrics": {}, "hist_stats": {"episode_reward": [133.89864076465412, 32.589664714355884, 29.960000000000278, 376.9736381723721, -39.89680296142332, 163.11836262708235, -14.833199536195405, -9.734481668772506, 26.929376235848395, 110.196404786845, 333.9503332546128, 360.4431991844848, 18.84793596532645, -57.47259993304425, 49.698851011303375, 368.99333389571143, 46.95357426065635, 359.4489501785986, -30.91839487729091, 22.079345154882603, 23.94055025019338, -31.100398126312523, -65.96362805530795, 351.4666773281, 0.8073837554443644, 21.912628234708954, 43.84354032281678, 310.8577093994799, 336.02216018278926, 316.45394481117296, -48.6976703862767, 204.3640595784864, 355.41733565075083, -16.296034755250542, 327.4065546303259, 12.576915103063186, 113.67095471313289, 3.4245947995950474, 302.4370677703836, -19.892646678498974, 7.104232787659108, 28.111531796983897, 319.90385645073127, 367.89742331363266, 218.37697161306932, 298.5352228845991, 18.8670736574404, 20.627021731400102, 34.23173921570937, -38.160718340013744, 87.88571539690237, -41.98078050023642, 222.75202906818478, -24.66954272157427, -27.330717978465618, 271.42952371938503, 28.561964712290017, 84.48745118238756, 45.93570997273825, 91.6601480536289, 17.76297603886615, -21.998008506289292, 48.930007294774654, 5.4678288578735454, -33.85371257900761, 151.1139356443461, 134.23893634911394, 113.52089637473038, 14.779841647762721, 59.355336353320226, 293.4342730946336, 97.97992539073809, 271.59706839994885, -1.5400012890942052, 25.936736069657233, 21.16117210058199, 124.98123559566547, 309.77006128761406, 17.93162393669246, 181.7827985055685, 37.15092192011144, 250.20991163632988, 21.117892800826585, 79.74257263605891, 16.25967890148399, 42.20915031313714, 50.069594281707786, 111.78429355732251, 38.472017088099996, 80.5851249687432, 15.182257961057354, 33.8568273476345, 280.70903994304666, 13.176853819049471, 1.081878915378318, -18.6784917750527, 242.95466128588686, -14.567465329754397, 43.77577904124647, -11.389141793758382], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [22.076344582718285, 12.933565074551751, -74.04421079042267, -70.889367619013, -0.2968049595261075, -36.07087156101785, 192.12966084108487, 169.11313012306897, -86.16292830600342, -132.10818252843416, 137.44908018735973, 2.0000000000000013, -102.9270355916733, -112.38508894213221, -262.0553243917606, -153.47830773143522, -0.7205379830345138, -45.098281480925465, 64.8948884440144, -37.38326117343139, 175.34828609917452, 137.56063197173333, 178.96164567470856, 179.20999999999984, -46.25358701321962, -134.24679098218937, -170.90019473170528, -241.19892962240587, -122.27297499431296, -192.3836792675913, 178.8735368171188, 143.60921441896028, -60.23474240679754, -80.17745696759394, 190.91938811069505, 148.0183697412749, -78.3595631890245, -93.36397997119232, -122.52832864504609, -79.16545734960003, 7.335457505587832, -41.32610929670284, -64.94848277404306, -81.81075532299894, -100.49374436315851, -181.4401716329619, 159.77041114622398, 166.17592699184084, -76.04822808603795, -57.22115468742834, -103.70152365938333, -220.90798902010263, -19.689185605517977, -5.134298149541344, 156.12478833409926, 121.3647541264314, 162.5193459918779, 151.06309852190506, 73.7712769004505, 169.55177694816382, -82.59354192188243, -70.63481887417448, 57.83270639547752, 69.61577255607553, 135.54447722042005, 197.6145175293944, -77.38647202497701, -52.97414091283748, 151.660617762177, 166.94465114380543, -116.93083937490134, -121.61435593386702, 33.99910861050506, 29.46084898139544, -0.8801078458095635, 0.07977589280902865, 81.8318084008762, 144.69660393417013, -42.56412296495727, -51.85659743306108, -68.98718601380732, -109.0541447879515, -106.85466715667847, -70.570646915125, 149.11225990398168, 143.20362728505717, 185.98030066390803, 169.24865427247587, 165.47189783567518, -67.76413162782961, 127.43537416322937, 130.18992388534406, -24.871043210695518, -23.370068300320963, -86.6200137162254, -158.47154953242818, -48.808233116296435, -82.10979818311837, -158.58064853604517, -87.69392231562405, -44.64877839124276, 45.32187806501012, -136.7794608885307, -87.18457186416205, 103.39350244510788, 59.91530221934027, -81.9011094979832, -69.54452548959394, -61.728380891302535, -101.57773519798859, 115.14349527663141, 136.3006684529504, -138.87623812481203, 2.0000000000000013, 13.227486332099588, 25.400254590694896, -19.85870296259854, -139.50276475301072, 14.917916033862715, -86.65443766117886, -101.1835311821183, -220.47296161011909, -57.82624269855752, -60.11023795370449, -117.16148279830901, -116.88500158332644, -85.12236029093154, -150.8431540333523, -87.38526909049781, -74.79458397033417, 58.637360609107986, 54.63719604568299, 2.0000000000000013, 106.95325065404427, 57.16771880266295, -8.482038912529685, -85.30009563315281, 1.4579352098761997, -67.72011830351835, -12.845895290090048, 130.50091188018467, 128.06307285690502, 2.9918737143184573, 18.35854770090129, 95.35396109140956, 135.80230856106806, -48.804232339998514, -71.60272879638426, -91.14102532776194, -83.21153145813271, -71.98308167296703, -108.00867724083787, -28.78709191871233, 7.821309450024208, 152.11608449891827, 134.15430940550806, -130.47990935142678, -128.29068744763336, 58.5402948679963, 51.79594580640678, -142.57637552685955, -145.14974962806988, 114.92741440924911, 106.18454244287318, -158.85449250349214, -107.41778235693101, 19.957407082276003, 18.189573572247394, -86.78348592197676, -182.87988372066565, -36.67055724774818, -30.860905615152337, -94.89458576079153, -47.01913018102301, -77.6472653261378, 44.68414071873948, -92.9095719785004, -84.33759614283342, -60.457344122356325, 1.3881431442820213, -100.2541680232829, -71.42146747055116, -25.78815792759182, -46.92887735784193, 157.25594395693412, 98.82637595565338, -51.78893152361508, -197.4352866782183, -107.2709427033496, -116.70773433150217, -62.914613688540385, -46.26562987122367, 84.78065289732324, 96.72546974584688, -93.67489354745429, -114.14012967935747, -43.94001871195353, -1.6427137404056518, -172.4282093236607, -188.9903862717655], "policy_predator_policy_reward": [51.85641554446761, 47.03231556291645, 80.68216579509985, 96.84107732869184, 66.32767652054393, 0.0, 8.997611658471843, 6.733235549746397, 176.0638612837261, 2.3104465892881123, 21.269300807505665, 2.399981632217018, 54.35703254531404, 146.12189245229595, 348.9658619846904, 56.833288469733176, 26.838943419124934, 45.90925228068339, 2.573339042650574, 80.11143847361095, 4.491704087449862, 16.549711096255113, 1.7563299970300854, 0.5152235127463038, 63.32127849967555, 136.02703546105965, 310.852073845587, 43.77445057547983, 134.47225038167235, 229.88325489153502, 2.492124333044685, 44.01845832658769, 91.85084256968675, 95.51493106536104, 0.5295620679035353, 19.981630258725094, 19.6130422911741, 121.1921059917518, 84.49969818151415, 139.27343296801467, 2.9507258849155646, 54.980476156392825, 86.53289403292484, 29.125945937804488, 213.05605521238851, 2.9142327284240133, 16.214532257211985, 9.30580693282331, 76.57202210102689, 57.504744427883885, 168.00318415908583, 178.51895675510937, 11.2396419745333, 57.427382103342836, 5.436353972428955, 27.931812966520344, 14.888492683076967, 7.551222985929345, 28.527191831351757, 44.6036991312074, 95.46086676613373, 9.069823643646474, 51.11673981288774, 25.798840814045597, 2.792818121356436, 19.465522779579935, 98.99830093049592, 15.066277252067989, 7.3924924783077905, 1.4087932460360744, 143.98731136574065, 107.13479904609069, 7.909890915186719, 42.301106206045745, 1.9742506705159872, 2.2506760820796097, 40.84786711318154, 35.06078832215571, 7.1857332583426, 67.34234046117685, 76.8342781445425, 108.31128544487542, 70.62745928822984, 134.90938658055754, 21.082385554204382, 6.505583707488111, 5.025464847789592, 7.643003529459197, 62.60427079908424, 58.06493460613963, 13.584569137354054, 27.325355698671565, 65.0251908174809, 2.082994350976075, 76.56904753246737, 189.14953744758643, 80.74898237657173, 84.40078813855247, 29.697334900503204, 178.41651761115216, 60.423538124008736, 26.789077599126248, 180.02962492393982, 1.953627328516603, 43.90193706222495, 15.541287341511609, 24.45918551527975, 102.31690675072313, 18.526440233892636, 117.44895787693301, 1.6595237193850145, 18.325836270418172, 35.864403697138805, 129.57379913996334, 1.4264953986464588, 44.433214860946556, 96.56506661224003, 108.73211107610742, 70.58507887338502, 92.81159080756004, 115.21517975852026, 224.20428907258355, 22.938091089598398, 73.00038105637434, 112.4710620238749, 170.5054296525347, 85.25817883038562, 156.17516435177205, 10.338303858689526, 117.98783662313468, 7.775796003078567, 30.06358298647643, 2.198936349113819, 23.08674934595575, 12.59886924601519, 52.23634723858175, 94.26062148832774, 4.36138058271161, 76.68715819287594, 63.23419175405263, 14.059377532473336, 20.81091082507029, 25.2518747814963, 51.37762919402195, 31.78468679882639, 8.656111948644913, 30.172690457922517, 88.69426938936604, 110.61578443050398, 89.67350842504783, 95.25964852595568, 105.89328248843148, 86.06747708070199, 59.8795409836516, 9.53385008378029, 13.965817299407634, 182.89574908862556, 93.80647164712684, 24.766902834133333, 46.6796549970321, 183.78616805054918, 141.09087902449164, 26.813660826959964, 2.2842939572476144, 166.00050100682967, 121.38966665442011, 4.622605613213705, 36.97298636832184, 193.7207161943083, 92.20233234981808, 10.07787299644108, 99.66274017959654, 53.93057821667636, 138.05273200684607, 61.80255478900136, 82.94486337571958, 72.25003867800528, 143.46914653142858, 77.11821714287713, 62.53610880394027, 119.43912887528502, 67.41876457960636, 59.93132211075839, 46.64254052230982, 19.019905410159293, 5.606814620299785, 83.50213333636243, 178.89893868452054, 122.34020188024756, 102.72035406998246, 15.73357026454149, 74.76818152016983, 37.6790259934811, 23.769512649235743, 52.95973214414833, 140.28782575290893, 24.88505929661139, 64.47345219699427, 304.49349664376217, 45.53595715790546]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.3121829877224216, "mean_inference_ms": 6.002568887396182, "mean_action_processing_ms": 1.004356559833433, "mean_env_wait_ms": 0.7907138639322782, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011484861373901367, "StateBufferConnector_ms": 0.01595020294189453, "ViewRequirementAgentConnector_ms": 0.3677746057510376}, "num_episodes": 18, "episode_return_max": 376.9736381723721, "episode_return_min": -65.96362805530795, "episode_return_mean": 99.84159973861311, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 992000, "num_agent_steps_trained": 992000, "num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 210.76224840839618, "num_env_steps_trained_throughput_per_sec": 210.76224840839618, "timesteps_total": 248000, "num_env_steps_sampled_lifetime": 248000, "num_agent_steps_sampled_lifetime": 992000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 992000, "timers": {"training_iteration_time_ms": 16779.76, "restore_workers_time_ms": 0.014, "training_step_time_ms": 16779.717, "sample_time_ms": 4277.435, "learn_time_ms": 12485.729, "learn_throughput": 320.366, "synch_weights_time_ms": 15.654}, "counters": {"num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_agent_steps_sampled": 992000, "num_agent_steps_trained": 992000}, "done": false, "training_iteration": 62, "trial_id": "d163c_00000", "date": "2024-08-16_13-15-31", "timestamp": 1723794331, "time_this_iter_s": 18.983030080795288, "time_total_s": 1550.7434878349304, "pid": 81201, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16b814ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1550.7434878349304, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 33.288888888888884, "ram_util_percent": 70.0037037037037}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.74717105885662, "cur_kl_coeff": 0.22500000000000006, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.3440081344079715, "policy_loss": -0.004353113233471516, "vf_loss": 7.346934699255323, "vf_explained_var": 0.39668823546833465, "kl": 0.006340171493139592, "entropy": 0.5356802176230799, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 118125.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.74533852017115, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.164580500567402, "policy_loss": -0.0068037497894789176, "vf_loss": 9.16973287794325, "vf_explained_var": -0.10000723408012793, "kl": 0.008256787891052369, "entropy": 1.0842516369289823, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 118125.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_agent_steps_sampled": 1008000, "num_agent_steps_trained": 1008000}, "env_runners": {"episode_reward_max": 367.89742331363266, "episode_reward_min": -65.96362805530795, "episode_reward_mean": 87.85193407038295, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -220.90798902010263, "predator_policy": 1.4087932460360744}, "policy_reward_max": {"prey_policy": 197.6145175293944, "predator_policy": 304.49349664376217}, "policy_reward_mean": {"prey_policy": -24.797169612658664, "predator_policy": 68.72313664785015}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-65.96362805530795, 351.4666773281, 0.8073837554443644, 21.912628234708954, 43.84354032281678, 310.8577093994799, 336.02216018278926, 316.45394481117296, -48.6976703862767, 204.3640595784864, 355.41733565075083, -16.296034755250542, 327.4065546303259, 12.576915103063186, 113.67095471313289, 3.4245947995950474, 302.4370677703836, -19.892646678498974, 7.104232787659108, 28.111531796983897, 319.90385645073127, 367.89742331363266, 218.37697161306932, 298.5352228845991, 18.8670736574404, 20.627021731400102, 34.23173921570937, -38.160718340013744, 87.88571539690237, -41.98078050023642, 222.75202906818478, -24.66954272157427, -27.330717978465618, 271.42952371938503, 28.561964712290017, 84.48745118238756, 45.93570997273825, 91.6601480536289, 17.76297603886615, -21.998008506289292, 48.930007294774654, 5.4678288578735454, -33.85371257900761, 151.1139356443461, 134.23893634911394, 113.52089637473038, 14.779841647762721, 59.355336353320226, 293.4342730946336, 97.97992539073809, 271.59706839994885, -1.5400012890942052, 25.936736069657233, 21.16117210058199, 124.98123559566547, 309.77006128761406, 17.93162393669246, 181.7827985055685, 37.15092192011144, 250.20991163632988, 21.117892800826585, 79.74257263605891, 16.25967890148399, 42.20915031313714, 50.069594281707786, 111.78429355732251, 38.472017088099996, 80.5851249687432, 15.182257961057354, 33.8568273476345, 280.70903994304666, 13.176853819049471, 1.081878915378318, -18.6784917750527, 242.95466128588686, -14.567465329754397, 43.77577904124647, -11.389141793758382, -10.696834527494191, 2.1299984052945797, 16.391246166511298, -11.143123408289556, 146.29326543367517, 13.009879295521666, 3.9540192497958047, -1.9695640749272105, 48.99619912914672, 10.19005244247902, 2.460435865878153, 134.0459788136968, -19.040003437413848, 95.895392634554, -24.552829369557568, 10.251754990308909, -5.148147379769767, 102.92456400930985, 174.88932175448033, 68.3705258715935, 146.87298672186236, 170.97459794421988], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-100.49374436315851, -181.4401716329619, 159.77041114622398, 166.17592699184084, -76.04822808603795, -57.22115468742834, -103.70152365938333, -220.90798902010263, -19.689185605517977, -5.134298149541344, 156.12478833409926, 121.3647541264314, 162.5193459918779, 151.06309852190506, 73.7712769004505, 169.55177694816382, -82.59354192188243, -70.63481887417448, 57.83270639547752, 69.61577255607553, 135.54447722042005, 197.6145175293944, -77.38647202497701, -52.97414091283748, 151.660617762177, 166.94465114380543, -116.93083937490134, -121.61435593386702, 33.99910861050506, 29.46084898139544, -0.8801078458095635, 0.07977589280902865, 81.8318084008762, 144.69660393417013, -42.56412296495727, -51.85659743306108, -68.98718601380732, -109.0541447879515, -106.85466715667847, -70.570646915125, 149.11225990398168, 143.20362728505717, 185.98030066390803, 169.24865427247587, 165.47189783567518, -67.76413162782961, 127.43537416322937, 130.18992388534406, -24.871043210695518, -23.370068300320963, -86.6200137162254, -158.47154953242818, -48.808233116296435, -82.10979818311837, -158.58064853604517, -87.69392231562405, -44.64877839124276, 45.32187806501012, -136.7794608885307, -87.18457186416205, 103.39350244510788, 59.91530221934027, -81.9011094979832, -69.54452548959394, -61.728380891302535, -101.57773519798859, 115.14349527663141, 136.3006684529504, -138.87623812481203, 2.0000000000000013, 13.227486332099588, 25.400254590694896, -19.85870296259854, -139.50276475301072, 14.917916033862715, -86.65443766117886, -101.1835311821183, -220.47296161011909, -57.82624269855752, -60.11023795370449, -117.16148279830901, -116.88500158332644, -85.12236029093154, -150.8431540333523, -87.38526909049781, -74.79458397033417, 58.637360609107986, 54.63719604568299, 2.0000000000000013, 106.95325065404427, 57.16771880266295, -8.482038912529685, -85.30009563315281, 1.4579352098761997, -67.72011830351835, -12.845895290090048, 130.50091188018467, 128.06307285690502, 2.9918737143184573, 18.35854770090129, 95.35396109140956, 135.80230856106806, -48.804232339998514, -71.60272879638426, -91.14102532776194, -83.21153145813271, -71.98308167296703, -108.00867724083787, -28.78709191871233, 7.821309450024208, 152.11608449891827, 134.15430940550806, -130.47990935142678, -128.29068744763336, 58.5402948679963, 51.79594580640678, -142.57637552685955, -145.14974962806988, 114.92741440924911, 106.18454244287318, -158.85449250349214, -107.41778235693101, 19.957407082276003, 18.189573572247394, -86.78348592197676, -182.87988372066565, -36.67055724774818, -30.860905615152337, -94.89458576079153, -47.01913018102301, -77.6472653261378, 44.68414071873948, -92.9095719785004, -84.33759614283342, -60.457344122356325, 1.3881431442820213, -100.2541680232829, -71.42146747055116, -25.78815792759182, -46.92887735784193, 157.25594395693412, 98.82637595565338, -51.78893152361508, -197.4352866782183, -107.2709427033496, -116.70773433150217, -62.914613688540385, -46.26562987122367, 84.78065289732324, 96.72546974584688, -93.67489354745429, -114.14012967935747, -43.94001871195353, -1.6427137404056518, -172.4282093236607, -188.9903862717655, -154.77029698770048, -110.27714431591951, -56.29023149355955, -80.52949958496177, -93.47791704660357, -121.23580795844315, -62.353985911654064, -82.94603423072093, 13.48397467177394, 36.620893549958254, -129.77606836044583, -88.39086516433234, -63.95800193648007, -91.71137375542668, -65.26561200557826, -80.04383274912078, -103.70826157311369, -40.289637379378455, -83.05570717309094, -155.32849663944864, -82.2655661805906, -70.15041719508119, 21.17443951601417, 36.475137887864484, -78.52429539055613, -81.79137089586355, -9.75159572483499, 37.75725514622846, -197.5734538899991, -103.38251141034077, -104.36317360325242, -72.59630584935122, -136.00402932021476, -67.70047045921766, -8.833098402388169, -121.54668507381359, 66.64053605692322, 29.946968414958498, 21.166492630918096, -52.044465358124654, 50.19135097547798, 54.30871638484782, 119.08484025142882, -108.92799148002861], "policy_predator_policy_reward": [213.05605521238851, 2.9142327284240133, 16.214532257211985, 9.30580693282331, 76.57202210102689, 57.504744427883885, 168.00318415908583, 178.51895675510937, 11.2396419745333, 57.427382103342836, 5.436353972428955, 27.931812966520344, 14.888492683076967, 7.551222985929345, 28.527191831351757, 44.6036991312074, 95.46086676613373, 9.069823643646474, 51.11673981288774, 25.798840814045597, 2.792818121356436, 19.465522779579935, 98.99830093049592, 15.066277252067989, 7.3924924783077905, 1.4087932460360744, 143.98731136574065, 107.13479904609069, 7.909890915186719, 42.301106206045745, 1.9742506705159872, 2.2506760820796097, 40.84786711318154, 35.06078832215571, 7.1857332583426, 67.34234046117685, 76.8342781445425, 108.31128544487542, 70.62745928822984, 134.90938658055754, 21.082385554204382, 6.505583707488111, 5.025464847789592, 7.643003529459197, 62.60427079908424, 58.06493460613963, 13.584569137354054, 27.325355698671565, 65.0251908174809, 2.082994350976075, 76.56904753246737, 189.14953744758643, 80.74898237657173, 84.40078813855247, 29.697334900503204, 178.41651761115216, 60.423538124008736, 26.789077599126248, 180.02962492393982, 1.953627328516603, 43.90193706222495, 15.541287341511609, 24.45918551527975, 102.31690675072313, 18.526440233892636, 117.44895787693301, 1.6595237193850145, 18.325836270418172, 35.864403697138805, 129.57379913996334, 1.4264953986464588, 44.433214860946556, 96.56506661224003, 108.73211107610742, 70.58507887338502, 92.81159080756004, 115.21517975852026, 224.20428907258355, 22.938091089598398, 73.00038105637434, 112.4710620238749, 170.5054296525347, 85.25817883038562, 156.17516435177205, 10.338303858689526, 117.98783662313468, 7.775796003078567, 30.06358298647643, 2.198936349113819, 23.08674934595575, 12.59886924601519, 52.23634723858175, 94.26062148832774, 4.36138058271161, 76.68715819287594, 63.23419175405263, 14.059377532473336, 20.81091082507029, 25.2518747814963, 51.37762919402195, 31.78468679882639, 8.656111948644913, 30.172690457922517, 88.69426938936604, 110.61578443050398, 89.67350842504783, 95.25964852595568, 105.89328248843148, 86.06747708070199, 59.8795409836516, 9.53385008378029, 13.965817299407634, 182.89574908862556, 93.80647164712684, 24.766902834133333, 46.6796549970321, 183.78616805054918, 141.09087902449164, 26.813660826959964, 2.2842939572476144, 166.00050100682967, 121.38966665442011, 4.622605613213705, 36.97298636832184, 193.7207161943083, 92.20233234981808, 10.07787299644108, 99.66274017959654, 53.93057821667636, 138.05273200684607, 61.80255478900136, 82.94486337571958, 72.25003867800528, 143.46914653142858, 77.11821714287713, 62.53610880394027, 119.43912887528502, 67.41876457960636, 59.93132211075839, 46.64254052230982, 19.019905410159293, 5.606814620299785, 83.50213333636243, 178.89893868452054, 122.34020188024756, 102.72035406998246, 15.73357026454149, 74.76818152016983, 37.6790259934811, 23.769512649235743, 52.95973214414833, 140.28782575290893, 24.88505929661139, 64.47345219699427, 304.49349664376217, 45.53595715790546, 63.47834428050542, 190.8722624956203, 135.15853849856384, 3.7911909852521215, 79.4563584446316, 151.6486127269263, 95.07113398977971, 39.08576274430584, 52.87226643466701, 43.316130777276, 91.20710036072138, 139.96971245957852, 54.18700706705555, 105.43638787464705, 80.05174657135308, 63.288134108418745, 28.34961385105386, 164.64448423058494, 220.7872417145319, 27.787014540486446, 55.98432303246868, 98.89209620908132, 16.392938210609188, 60.00346319920899, 41.043837655651416, 100.23182519335427, 10.85497651710866, 57.03475669605203, 214.35069051546628, 62.052445415315894, 73.37039279277846, 113.84084165013414, 169.20753868093917, 29.34881371872343, 93.56889457809145, 139.73545290742007, 14.432462546330774, 63.869354736267645, 83.28464498876409, 15.963853610035908, 8.200741174671608, 34.1721781868654, 104.28547755064963, 56.53227162217016]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.3079811866768862, "mean_inference_ms": 5.991694173936994, "mean_action_processing_ms": 1.0015560224111786, "mean_env_wait_ms": 0.7901945515889236, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011367321014404297, "StateBufferConnector_ms": 0.015944957733154297, "ViewRequirementAgentConnector_ms": 0.35208022594451904}, "num_episodes": 22, "episode_return_max": 367.89742331363266, "episode_return_min": -65.96362805530795, "episode_return_mean": 87.85193407038295, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1008000, "num_agent_steps_trained": 1008000, "num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 248.3282721021158, "num_env_steps_trained_throughput_per_sec": 248.3282721021158, "timesteps_total": 252000, "num_env_steps_sampled_lifetime": 252000, "num_agent_steps_sampled_lifetime": 1008000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1008000, "timers": {"training_iteration_time_ms": 16597.793, "restore_workers_time_ms": 0.014, "training_step_time_ms": 16597.751, "sample_time_ms": 4188.815, "learn_time_ms": 12392.484, "learn_throughput": 322.776, "synch_weights_time_ms": 15.529}, "counters": {"num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_agent_steps_sampled": 1008000, "num_agent_steps_trained": 1008000}, "done": false, "training_iteration": 63, "trial_id": "d163c_00000", "date": "2024-08-16_13-15-47", "timestamp": 1723794347, "time_this_iter_s": 16.11157488822937, "time_total_s": 1566.8550627231598, "pid": 81201, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16b85a670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1566.8550627231598, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 29.217391304347824, "ram_util_percent": 70.00434782608697}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.29357834890406, "cur_kl_coeff": 0.22500000000000006, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.501268161289276, "policy_loss": -0.0040513399766669385, "vf_loss": 7.504461352030436, "vf_explained_var": 0.3037499321516229, "kl": 0.003813987348253063, "entropy": 0.4610393910338639, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 120015.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.053690387143029, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.393463053022112, "policy_loss": -0.005627743848205283, "vf_loss": 8.396822010524689, "vf_explained_var": -0.08262254709289188, "kl": 0.011343956569613203, "entropy": 1.0757772562365053, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 120015.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 256000, "num_env_steps_trained": 256000, "num_agent_steps_sampled": 1024000, "num_agent_steps_trained": 1024000}, "env_runners": {"episode_reward_max": 309.77006128761406, "episode_reward_min": -41.98078050023642, "episode_reward_mean": 65.82794822877108, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -220.47296161011909, "predator_policy": 1.4264953986464588}, "policy_reward_max": {"prey_policy": 157.25594395693412, "predator_policy": 304.49349664376217}, "policy_reward_mean": {"prey_policy": -41.68902605249751, "predator_policy": 74.60300016688305}, "custom_metrics": {}, "hist_stats": {"episode_reward": [298.5352228845991, 18.8670736574404, 20.627021731400102, 34.23173921570937, -38.160718340013744, 87.88571539690237, -41.98078050023642, 222.75202906818478, -24.66954272157427, -27.330717978465618, 271.42952371938503, 28.561964712290017, 84.48745118238756, 45.93570997273825, 91.6601480536289, 17.76297603886615, -21.998008506289292, 48.930007294774654, 5.4678288578735454, -33.85371257900761, 151.1139356443461, 134.23893634911394, 113.52089637473038, 14.779841647762721, 59.355336353320226, 293.4342730946336, 97.97992539073809, 271.59706839994885, -1.5400012890942052, 25.936736069657233, 21.16117210058199, 124.98123559566547, 309.77006128761406, 17.93162393669246, 181.7827985055685, 37.15092192011144, 250.20991163632988, 21.117892800826585, 79.74257263605891, 16.25967890148399, 42.20915031313714, 50.069594281707786, 111.78429355732251, 38.472017088099996, 80.5851249687432, 15.182257961057354, 33.8568273476345, 280.70903994304666, 13.176853819049471, 1.081878915378318, -18.6784917750527, 242.95466128588686, -14.567465329754397, 43.77577904124647, -11.389141793758382, -10.696834527494191, 2.1299984052945797, 16.391246166511298, -11.143123408289556, 146.29326543367517, 13.009879295521666, 3.9540192497958047, -1.9695640749272105, 48.99619912914672, 10.19005244247902, 2.460435865878153, 134.0459788136968, -19.040003437413848, 95.895392634554, -24.552829369557568, 10.251754990308909, -5.148147379769767, 102.92456400930985, 174.88932175448033, 68.3705258715935, 146.87298672186236, 170.97459794421988, 67.84550184231028, 71.54994387111356, 7.3093390422992695, 156.92142871031834, 60.14308742174342, 26.086427015656565, 66.01830039478422, -9.575639039638647, 52.55995173418105, 58.72879160562752, 37.658810772261006, 90.74716554168576, 36.53242053851499, 32.7532553246306, 22.054758223662986, 75.0680691097257, 66.21290179476331, 99.18282809539915, 53.78330970713052, 91.88847600601628, 50.002564888296405, 25.105126351522774, 50.23015925379809], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [127.43537416322937, 130.18992388534406, -24.871043210695518, -23.370068300320963, -86.6200137162254, -158.47154953242818, -48.808233116296435, -82.10979818311837, -158.58064853604517, -87.69392231562405, -44.64877839124276, 45.32187806501012, -136.7794608885307, -87.18457186416205, 103.39350244510788, 59.91530221934027, -81.9011094979832, -69.54452548959394, -61.728380891302535, -101.57773519798859, 115.14349527663141, 136.3006684529504, -138.87623812481203, 2.0000000000000013, 13.227486332099588, 25.400254590694896, -19.85870296259854, -139.50276475301072, 14.917916033862715, -86.65443766117886, -101.1835311821183, -220.47296161011909, -57.82624269855752, -60.11023795370449, -117.16148279830901, -116.88500158332644, -85.12236029093154, -150.8431540333523, -87.38526909049781, -74.79458397033417, 58.637360609107986, 54.63719604568299, 2.0000000000000013, 106.95325065404427, 57.16771880266295, -8.482038912529685, -85.30009563315281, 1.4579352098761997, -67.72011830351835, -12.845895290090048, 130.50091188018467, 128.06307285690502, 2.9918737143184573, 18.35854770090129, 95.35396109140956, 135.80230856106806, -48.804232339998514, -71.60272879638426, -91.14102532776194, -83.21153145813271, -71.98308167296703, -108.00867724083787, -28.78709191871233, 7.821309450024208, 152.11608449891827, 134.15430940550806, -130.47990935142678, -128.29068744763336, 58.5402948679963, 51.79594580640678, -142.57637552685955, -145.14974962806988, 114.92741440924911, 106.18454244287318, -158.85449250349214, -107.41778235693101, 19.957407082276003, 18.189573572247394, -86.78348592197676, -182.87988372066565, -36.67055724774818, -30.860905615152337, -94.89458576079153, -47.01913018102301, -77.6472653261378, 44.68414071873948, -92.9095719785004, -84.33759614283342, -60.457344122356325, 1.3881431442820213, -100.2541680232829, -71.42146747055116, -25.78815792759182, -46.92887735784193, 157.25594395693412, 98.82637595565338, -51.78893152361508, -197.4352866782183, -107.2709427033496, -116.70773433150217, -62.914613688540385, -46.26562987122367, 84.78065289732324, 96.72546974584688, -93.67489354745429, -114.14012967935747, -43.94001871195353, -1.6427137404056518, -172.4282093236607, -188.9903862717655, -154.77029698770048, -110.27714431591951, -56.29023149355955, -80.52949958496177, -93.47791704660357, -121.23580795844315, -62.353985911654064, -82.94603423072093, 13.48397467177394, 36.620893549958254, -129.77606836044583, -88.39086516433234, -63.95800193648007, -91.71137375542668, -65.26561200557826, -80.04383274912078, -103.70826157311369, -40.289637379378455, -83.05570717309094, -155.32849663944864, -82.2655661805906, -70.15041719508119, 21.17443951601417, 36.475137887864484, -78.52429539055613, -81.79137089586355, -9.75159572483499, 37.75725514622846, -197.5734538899991, -103.38251141034077, -104.36317360325242, -72.59630584935122, -136.00402932021476, -67.70047045921766, -8.833098402388169, -121.54668507381359, 66.64053605692322, 29.946968414958498, 21.166492630918096, -52.044465358124654, 50.19135097547798, 54.30871638484782, 119.08484025142882, -108.92799148002861, -49.06704487604065, 2.0000000000000013, 4.056671076120629, -47.52945553924362, -139.42559499435262, -80.05990820926299, 58.12563705177645, 28.133944424830855, 6.071633633774463, -140.45530473409448, -41.874539514770944, 2.0000000000000013, -2.5854780136651487, -6.744640172606521, -36.646022455737764, -45.23499475876358, -39.622071488380854, 2.0000000000000013, -101.99349596740944, -154.92843075032778, -43.1736806994691, -60.57231593351933, -61.96148036681718, -86.60473986632755, -71.16886598275863, 2.0000000000000013, -124.43466862644155, -5.875235414412078, -65.79163053000107, -84.31098933046685, -94.69360738440294, -197.3071021555998, 7.211321327182255, -63.36291805633522, 34.7180887428452, -2.218763235960391, -73.43320234167447, -2.8811078791649427, 2.3859018308661755, 2.218887802740499, -25.386398688646015, -16.588482097880235, -98.74817897998399, -181.43658942792405, 11.86703266385875, -57.70652969211711], "policy_predator_policy_reward": [13.584569137354054, 27.325355698671565, 65.0251908174809, 2.082994350976075, 76.56904753246737, 189.14953744758643, 80.74898237657173, 84.40078813855247, 29.697334900503204, 178.41651761115216, 60.423538124008736, 26.789077599126248, 180.02962492393982, 1.953627328516603, 43.90193706222495, 15.541287341511609, 24.45918551527975, 102.31690675072313, 18.526440233892636, 117.44895787693301, 1.6595237193850145, 18.325836270418172, 35.864403697138805, 129.57379913996334, 1.4264953986464588, 44.433214860946556, 96.56506661224003, 108.73211107610742, 70.58507887338502, 92.81159080756004, 115.21517975852026, 224.20428907258355, 22.938091089598398, 73.00038105637434, 112.4710620238749, 170.5054296525347, 85.25817883038562, 156.17516435177205, 10.338303858689526, 117.98783662313468, 7.775796003078567, 30.06358298647643, 2.198936349113819, 23.08674934595575, 12.59886924601519, 52.23634723858175, 94.26062148832774, 4.36138058271161, 76.68715819287594, 63.23419175405263, 14.059377532473336, 20.81091082507029, 25.2518747814963, 51.37762919402195, 31.78468679882639, 8.656111948644913, 30.172690457922517, 88.69426938936604, 110.61578443050398, 89.67350842504783, 95.25964852595568, 105.89328248843148, 86.06747708070199, 59.8795409836516, 9.53385008378029, 13.965817299407634, 182.89574908862556, 93.80647164712684, 24.766902834133333, 46.6796549970321, 183.78616805054918, 141.09087902449164, 26.813660826959964, 2.2842939572476144, 166.00050100682967, 121.38966665442011, 4.622605613213705, 36.97298636832184, 193.7207161943083, 92.20233234981808, 10.07787299644108, 99.66274017959654, 53.93057821667636, 138.05273200684607, 61.80255478900136, 82.94486337571958, 72.25003867800528, 143.46914653142858, 77.11821714287713, 62.53610880394027, 119.43912887528502, 67.41876457960636, 59.93132211075839, 46.64254052230982, 19.019905410159293, 5.606814620299785, 83.50213333636243, 178.89893868452054, 122.34020188024756, 102.72035406998246, 15.73357026454149, 74.76818152016983, 37.6790259934811, 23.769512649235743, 52.95973214414833, 140.28782575290893, 24.88505929661139, 64.47345219699427, 304.49349664376217, 45.53595715790546, 63.47834428050542, 190.8722624956203, 135.15853849856384, 3.7911909852521215, 79.4563584446316, 151.6486127269263, 95.07113398977971, 39.08576274430584, 52.87226643466701, 43.316130777276, 91.20710036072138, 139.96971245957852, 54.18700706705555, 105.43638787464705, 80.05174657135308, 63.288134108418745, 28.34961385105386, 164.64448423058494, 220.7872417145319, 27.787014540486446, 55.98432303246868, 98.89209620908132, 16.392938210609188, 60.00346319920899, 41.043837655651416, 100.23182519335427, 10.85497651710866, 57.03475669605203, 214.35069051546628, 62.052445415315894, 73.37039279277846, 113.84084165013414, 169.20753868093917, 29.34881371872343, 93.56889457809145, 139.73545290742007, 14.432462546330774, 63.869354736267645, 83.28464498876409, 15.963853610035908, 8.200741174671608, 34.1721781868654, 104.28547755064963, 56.53227162217016, 70.9459878951867, 43.96655882316445, 50.60444506336967, 64.41828327086697, 115.95169067136344, 110.84315157455137, 22.015780479011358, 48.64606675469987, 114.97275054376334, 79.55400797830022, 35.18693560393819, 30.774030926489242, 58.17071139847248, 17.17770718258338, 59.337407494848534, 12.967970680013712, 20.609954292103286, 69.57206893045867, 187.69633895274575, 127.95437937061915, 91.13102146794147, 50.273785937308006, 141.4181202324492, 97.89526554238142, 66.28099344694195, 39.420293074331646, 39.87146682323327, 123.19169254225083, 104.45316782071532, 67.70421026341558, 202.7605954710175, 164.30818317871075, 55.79203128382953, 66.57246724008677, 54.00303043882851, 12.680472149685617, 87.56570123948941, 42.53191868848054, 45.47682861445782, 41.806857757951335, 30.179635247286996, 61.79781042753618, 80.33719687627777, 224.95269788315315, 46.51670439442322, 49.55295188763326]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.3055265459953924, "mean_inference_ms": 5.98211478704447, "mean_action_processing_ms": 0.9986620943622297, "mean_env_wait_ms": 0.7901706999301932, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008340835571289062, "StateBufferConnector_ms": 0.01641368865966797, "ViewRequirementAgentConnector_ms": 0.3478902578353882}, "num_episodes": 23, "episode_return_max": 309.77006128761406, "episode_return_min": -41.98078050023642, "episode_return_mean": 65.82794822877108, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1024000, "num_agent_steps_trained": 1024000, "num_env_steps_sampled": 256000, "num_env_steps_trained": 256000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 246.64276432039995, "num_env_steps_trained_throughput_per_sec": 246.64276432039995, "timesteps_total": 256000, "num_env_steps_sampled_lifetime": 256000, "num_agent_steps_sampled_lifetime": 1024000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1024000, "timers": {"training_iteration_time_ms": 16577.735, "restore_workers_time_ms": 0.014, "training_step_time_ms": 16577.693, "sample_time_ms": 4196.509, "learn_time_ms": 12365.053, "learn_throughput": 323.492, "synch_weights_time_ms": 15.212}, "counters": {"num_env_steps_sampled": 256000, "num_env_steps_trained": 256000, "num_agent_steps_sampled": 1024000, "num_agent_steps_trained": 1024000}, "done": false, "training_iteration": 64, "trial_id": "d163c_00000", "date": "2024-08-16_13-16-03", "timestamp": 1723794363, "time_this_iter_s": 16.222000122070312, "time_total_s": 1583.07706284523, "pid": 81201, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16b976430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1583.07706284523, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 29.165217391304346, "ram_util_percent": 69.22608695652173}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.9009017406317295, "cur_kl_coeff": 0.11250000000000003, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.713393699807464, "policy_loss": -0.0031702248192338085, "vf_loss": 7.716140791474196, "vf_explained_var": 0.10488176153450415, "kl": 0.003761198870388735, "entropy": 0.46698524844709527, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 121905.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.192788228849885, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.340595980548354, "policy_loss": -0.008513443505640324, "vf_loss": 8.346909794227155, "vf_explained_var": -0.06924572725775381, "kl": 0.010998059460660884, "entropy": 1.085605985273129, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 121905.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 260000, "num_env_steps_trained": 260000, "num_agent_steps_sampled": 1040000, "num_agent_steps_trained": 1040000}, "env_runners": {"episode_reward_max": 309.77006128761406, "episode_reward_min": -33.85371257900761, "episode_reward_mean": 66.5467033705792, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -311.21478942247813, "predator_policy": 2.198936349113819}, "policy_reward_max": {"prey_policy": 157.25594395693412, "predator_policy": 346.5082792248236}, "policy_reward_mean": {"prey_policy": -41.03604895447747, "predator_policy": 74.30940063976706}, "custom_metrics": {}, "hist_stats": {"episode_reward": [5.4678288578735454, -33.85371257900761, 151.1139356443461, 134.23893634911394, 113.52089637473038, 14.779841647762721, 59.355336353320226, 293.4342730946336, 97.97992539073809, 271.59706839994885, -1.5400012890942052, 25.936736069657233, 21.16117210058199, 124.98123559566547, 309.77006128761406, 17.93162393669246, 181.7827985055685, 37.15092192011144, 250.20991163632988, 21.117892800826585, 79.74257263605891, 16.25967890148399, 42.20915031313714, 50.069594281707786, 111.78429355732251, 38.472017088099996, 80.5851249687432, 15.182257961057354, 33.8568273476345, 280.70903994304666, 13.176853819049471, 1.081878915378318, -18.6784917750527, 242.95466128588686, -14.567465329754397, 43.77577904124647, -11.389141793758382, -10.696834527494191, 2.1299984052945797, 16.391246166511298, -11.143123408289556, 146.29326543367517, 13.009879295521666, 3.9540192497958047, -1.9695640749272105, 48.99619912914672, 10.19005244247902, 2.460435865878153, 134.0459788136968, -19.040003437413848, 95.895392634554, -24.552829369557568, 10.251754990308909, -5.148147379769767, 102.92456400930985, 174.88932175448033, 68.3705258715935, 146.87298672186236, 170.97459794421988, 67.84550184231028, 71.54994387111356, 7.3093390422992695, 156.92142871031834, 60.14308742174342, 26.086427015656565, 66.01830039478422, -9.575639039638647, 52.55995173418105, 58.72879160562752, 37.658810772261006, 90.74716554168576, 36.53242053851499, 32.7532553246306, 22.054758223662986, 75.0680691097257, 66.21290179476331, 99.18282809539915, 53.78330970713052, 91.88847600601628, 50.002564888296405, 25.105126351522774, 50.23015925379809, 47.26243608468418, 83.77194564805664, 75.38284809847615, 47.06668156593026, 53.86704545936378, 61.7806358585723, 63.39101873938707, 102.925832507812, 77.96412730533898, 19.01466724989109, 43.473287339664736, 103.7979457101207, 79.59287683436848, 38.45452644850491, 80.12608568951553, 129.07897268807855, 47.83394636246384, 34.617449472310824], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-85.12236029093154, -150.8431540333523, -87.38526909049781, -74.79458397033417, 58.637360609107986, 54.63719604568299, 2.0000000000000013, 106.95325065404427, 57.16771880266295, -8.482038912529685, -85.30009563315281, 1.4579352098761997, -67.72011830351835, -12.845895290090048, 130.50091188018467, 128.06307285690502, 2.9918737143184573, 18.35854770090129, 95.35396109140956, 135.80230856106806, -48.804232339998514, -71.60272879638426, -91.14102532776194, -83.21153145813271, -71.98308167296703, -108.00867724083787, -28.78709191871233, 7.821309450024208, 152.11608449891827, 134.15430940550806, -130.47990935142678, -128.29068744763336, 58.5402948679963, 51.79594580640678, -142.57637552685955, -145.14974962806988, 114.92741440924911, 106.18454244287318, -158.85449250349214, -107.41778235693101, 19.957407082276003, 18.189573572247394, -86.78348592197676, -182.87988372066565, -36.67055724774818, -30.860905615152337, -94.89458576079153, -47.01913018102301, -77.6472653261378, 44.68414071873948, -92.9095719785004, -84.33759614283342, -60.457344122356325, 1.3881431442820213, -100.2541680232829, -71.42146747055116, -25.78815792759182, -46.92887735784193, 157.25594395693412, 98.82637595565338, -51.78893152361508, -197.4352866782183, -107.2709427033496, -116.70773433150217, -62.914613688540385, -46.26562987122367, 84.78065289732324, 96.72546974584688, -93.67489354745429, -114.14012967935747, -43.94001871195353, -1.6427137404056518, -172.4282093236607, -188.9903862717655, -154.77029698770048, -110.27714431591951, -56.29023149355955, -80.52949958496177, -93.47791704660357, -121.23580795844315, -62.353985911654064, -82.94603423072093, 13.48397467177394, 36.620893549958254, -129.77606836044583, -88.39086516433234, -63.95800193648007, -91.71137375542668, -65.26561200557826, -80.04383274912078, -103.70826157311369, -40.289637379378455, -83.05570717309094, -155.32849663944864, -82.2655661805906, -70.15041719508119, 21.17443951601417, 36.475137887864484, -78.52429539055613, -81.79137089586355, -9.75159572483499, 37.75725514622846, -197.5734538899991, -103.38251141034077, -104.36317360325242, -72.59630584935122, -136.00402932021476, -67.70047045921766, -8.833098402388169, -121.54668507381359, 66.64053605692322, 29.946968414958498, 21.166492630918096, -52.044465358124654, 50.19135097547798, 54.30871638484782, 119.08484025142882, -108.92799148002861, -49.06704487604065, 2.0000000000000013, 4.056671076120629, -47.52945553924362, -139.42559499435262, -80.05990820926299, 58.12563705177645, 28.133944424830855, 6.071633633774463, -140.45530473409448, -41.874539514770944, 2.0000000000000013, -2.5854780136651487, -6.744640172606521, -36.646022455737764, -45.23499475876358, -39.622071488380854, 2.0000000000000013, -101.99349596740944, -154.92843075032778, -43.1736806994691, -60.57231593351933, -61.96148036681718, -86.60473986632755, -71.16886598275863, 2.0000000000000013, -124.43466862644155, -5.875235414412078, -65.79163053000107, -84.31098933046685, -94.69360738440294, -197.3071021555998, 7.211321327182255, -63.36291805633522, 34.7180887428452, -2.218763235960391, -73.43320234167447, -2.8811078791649427, 2.3859018308661755, 2.218887802740499, -25.386398688646015, -16.588482097880235, -98.74817897998399, -181.43658942792405, 11.86703266385875, -57.70652969211711, 2.0000000000000013, -24.542682070337555, -40.9603757163966, -28.21555352095561, 21.798194599372813, -44.65862626790934, -25.618803631640066, -73.41945133535543, -24.7863128265943, -18.79872584286067, -136.25771971254568, -12.685758620981328, -20.016403183850926, -42.54817839220191, 49.314839626639014, -43.42946102412525, -19.040049081949654, -45.35685492806854, 2.0000000000000013, -36.28047466959621, -13.645741952556172, -117.25768624747597, -12.560332183666702, -8.695109568444556, -48.378131731702055, -311.21478942247813, -107.99617613107782, -22.172171353423604, 39.12231556548138, -74.04002994063089, -12.950430009286157, 26.305284157747522, 12.896553286374496, -35.35367341897645, -20.626965554769683, -140.5107382867739], "policy_predator_policy_reward": [85.25817883038562, 156.17516435177205, 10.338303858689526, 117.98783662313468, 7.775796003078567, 30.06358298647643, 2.198936349113819, 23.08674934595575, 12.59886924601519, 52.23634723858175, 94.26062148832774, 4.36138058271161, 76.68715819287594, 63.23419175405263, 14.059377532473336, 20.81091082507029, 25.2518747814963, 51.37762919402195, 31.78468679882639, 8.656111948644913, 30.172690457922517, 88.69426938936604, 110.61578443050398, 89.67350842504783, 95.25964852595568, 105.89328248843148, 86.06747708070199, 59.8795409836516, 9.53385008378029, 13.965817299407634, 182.89574908862556, 93.80647164712684, 24.766902834133333, 46.6796549970321, 183.78616805054918, 141.09087902449164, 26.813660826959964, 2.2842939572476144, 166.00050100682967, 121.38966665442011, 4.622605613213705, 36.97298636832184, 193.7207161943083, 92.20233234981808, 10.07787299644108, 99.66274017959654, 53.93057821667636, 138.05273200684607, 61.80255478900136, 82.94486337571958, 72.25003867800528, 143.46914653142858, 77.11821714287713, 62.53610880394027, 119.43912887528502, 67.41876457960636, 59.93132211075839, 46.64254052230982, 19.019905410159293, 5.606814620299785, 83.50213333636243, 178.89893868452054, 122.34020188024756, 102.72035406998246, 15.73357026454149, 74.76818152016983, 37.6790259934811, 23.769512649235743, 52.95973214414833, 140.28782575290893, 24.88505929661139, 64.47345219699427, 304.49349664376217, 45.53595715790546, 63.47834428050542, 190.8722624956203, 135.15853849856384, 3.7911909852521215, 79.4563584446316, 151.6486127269263, 95.07113398977971, 39.08576274430584, 52.87226643466701, 43.316130777276, 91.20710036072138, 139.96971245957852, 54.18700706705555, 105.43638787464705, 80.05174657135308, 63.288134108418745, 28.34961385105386, 164.64448423058494, 220.7872417145319, 27.787014540486446, 55.98432303246868, 98.89209620908132, 16.392938210609188, 60.00346319920899, 41.043837655651416, 100.23182519335427, 10.85497651710866, 57.03475669605203, 214.35069051546628, 62.052445415315894, 73.37039279277846, 113.84084165013414, 169.20753868093917, 29.34881371872343, 93.56889457809145, 139.73545290742007, 14.432462546330774, 63.869354736267645, 83.28464498876409, 15.963853610035908, 8.200741174671608, 34.1721781868654, 104.28547755064963, 56.53227162217016, 70.9459878951867, 43.96655882316445, 50.60444506336967, 64.41828327086697, 115.95169067136344, 110.84315157455137, 22.015780479011358, 48.64606675469987, 114.97275054376334, 79.55400797830022, 35.18693560393819, 30.774030926489242, 58.17071139847248, 17.17770718258338, 59.337407494848534, 12.967970680013712, 20.609954292103286, 69.57206893045867, 187.69633895274575, 127.95437937061915, 91.13102146794147, 50.273785937308006, 141.4181202324492, 97.89526554238142, 66.28099344694195, 39.420293074331646, 39.87146682323327, 123.19169254225083, 104.45316782071532, 67.70421026341558, 202.7605954710175, 164.30818317871075, 55.79203128382953, 66.57246724008677, 54.00303043882851, 12.680472149685617, 87.56570123948941, 42.53191868848054, 45.47682861445782, 41.806857757951335, 30.179635247286996, 61.79781042753618, 80.33719687627777, 224.95269788315315, 46.51670439442322, 49.55295188763326, 41.881249915878094, 27.92386823914383, 78.9781199401242, 73.96975494528473, 53.07469624919045, 45.16858351782217, 56.77912324098763, 89.32581329193818, 31.42024816599727, 66.03183596282148, 92.48406007537507, 118.24005411672442, 68.51287635988189, 57.44272395555805, 43.899785755400764, 53.14066814989696, 78.76821003119903, 63.59282128415793, 31.74992394955204, 21.54521796993481, 114.70193719196118, 59.67477834773571, 88.20377026737037, 36.849617194861366, 346.5082792248236, 92.67751876372529, 42.07149423604678, 126.55137969695964, 56.9947067027835, 58.04909336188176, 72.38631420645629, 43.33780433316053, 26.43784155466463, 43.853224940401425, 69.47084466644105, 126.28430864741294]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.3017657042758186, "mean_inference_ms": 5.974877180319422, "mean_action_processing_ms": 0.9974537817074236, "mean_env_wait_ms": 0.7897777206869532, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00847935676574707, "StateBufferConnector_ms": 0.01651167869567871, "ViewRequirementAgentConnector_ms": 0.34573090076446533}, "num_episodes": 18, "episode_return_max": 309.77006128761406, "episode_return_min": -33.85371257900761, "episode_return_mean": 66.5467033705792, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1040000, "num_agent_steps_trained": 1040000, "num_env_steps_sampled": 260000, "num_env_steps_trained": 260000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 231.70908739960606, "num_env_steps_trained_throughput_per_sec": 231.70908739960606, "timesteps_total": 260000, "num_env_steps_sampled_lifetime": 260000, "num_agent_steps_sampled_lifetime": 1040000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1040000, "timers": {"training_iteration_time_ms": 16631.482, "restore_workers_time_ms": 0.014, "training_step_time_ms": 16631.44, "sample_time_ms": 4201.595, "learn_time_ms": 12413.581, "learn_throughput": 322.228, "synch_weights_time_ms": 15.286}, "counters": {"num_env_steps_sampled": 260000, "num_env_steps_trained": 260000, "num_agent_steps_sampled": 1040000, "num_agent_steps_trained": 1040000}, "done": false, "training_iteration": 65, "trial_id": "d163c_00000", "date": "2024-08-16_13-16-21", "timestamp": 1723794381, "time_this_iter_s": 17.26821279525757, "time_total_s": 1600.3452756404877, "pid": 81201, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16b839160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1600.3452756404877, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 30.575999999999993, "ram_util_percent": 69.36}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.6254867101472525, "cur_kl_coeff": 0.056250000000000015, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.959796272257648, "policy_loss": -0.0030592247438444584, "vf_loss": 7.962567502228671, "vf_explained_var": -0.0011878543429904515, "kl": 0.005120031280215198, "entropy": 0.45751628081003826, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 123795.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.562385472229549, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.028217337623475, "policy_loss": -0.011571289801837078, "vf_loss": 6.037624508489377, "vf_explained_var": -0.32410042708512965, "kl": 0.0108206015270068, "entropy": 1.0509875473522006, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 123795.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_agent_steps_sampled": 1056000, "num_agent_steps_trained": 1056000}, "env_runners": {"episode_reward_max": 280.70903994304666, "episode_reward_min": -24.552829369557568, "episode_reward_mean": 56.12854034175124, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -311.21478942247813, "predator_policy": 1.2399962092900547}, "policy_reward_max": {"prey_policy": 157.25594395693412, "predator_policy": 346.5082792248236}, "policy_reward_mean": {"prey_policy": -43.93099723181129, "predator_policy": 71.99526740268692}, "custom_metrics": {}, "hist_stats": {"episode_reward": [250.20991163632988, 21.117892800826585, 79.74257263605891, 16.25967890148399, 42.20915031313714, 50.069594281707786, 111.78429355732251, 38.472017088099996, 80.5851249687432, 15.182257961057354, 33.8568273476345, 280.70903994304666, 13.176853819049471, 1.081878915378318, -18.6784917750527, 242.95466128588686, -14.567465329754397, 43.77577904124647, -11.389141793758382, -10.696834527494191, 2.1299984052945797, 16.391246166511298, -11.143123408289556, 146.29326543367517, 13.009879295521666, 3.9540192497958047, -1.9695640749272105, 48.99619912914672, 10.19005244247902, 2.460435865878153, 134.0459788136968, -19.040003437413848, 95.895392634554, -24.552829369557568, 10.251754990308909, -5.148147379769767, 102.92456400930985, 174.88932175448033, 68.3705258715935, 146.87298672186236, 170.97459794421988, 67.84550184231028, 71.54994387111356, 7.3093390422992695, 156.92142871031834, 60.14308742174342, 26.086427015656565, 66.01830039478422, -9.575639039638647, 52.55995173418105, 58.72879160562752, 37.658810772261006, 90.74716554168576, 36.53242053851499, 32.7532553246306, 22.054758223662986, 75.0680691097257, 66.21290179476331, 99.18282809539915, 53.78330970713052, 91.88847600601628, 50.002564888296405, 25.105126351522774, 50.23015925379809, 47.26243608468418, 83.77194564805664, 75.38284809847615, 47.06668156593026, 53.86704545936378, 61.7806358585723, 63.39101873938707, 102.925832507812, 77.96412730533898, 19.01466724989109, 43.473287339664736, 103.7979457101207, 79.59287683436848, 38.45452644850491, 80.12608568951553, 129.07897268807855, 47.83394636246384, 34.617449472310824, 61.74768285229476, -19.603561003552652, 33.21805393489681, 9.469597891322426, 47.18135072987235, 64.3050554943187, 80.38137090681016, 55.53746526812746, 14.501101077526624, 25.4466753016831, 87.39372105515294, 26.276814163080083, 58.239759433820545, 9.554069595051805, 41.33999999999943, 64.1952110031532, 54.70791011499935, 69.10029695890488], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [114.92741440924911, 106.18454244287318, -158.85449250349214, -107.41778235693101, 19.957407082276003, 18.189573572247394, -86.78348592197676, -182.87988372066565, -36.67055724774818, -30.860905615152337, -94.89458576079153, -47.01913018102301, -77.6472653261378, 44.68414071873948, -92.9095719785004, -84.33759614283342, -60.457344122356325, 1.3881431442820213, -100.2541680232829, -71.42146747055116, -25.78815792759182, -46.92887735784193, 157.25594395693412, 98.82637595565338, -51.78893152361508, -197.4352866782183, -107.2709427033496, -116.70773433150217, -62.914613688540385, -46.26562987122367, 84.78065289732324, 96.72546974584688, -93.67489354745429, -114.14012967935747, -43.94001871195353, -1.6427137404056518, -172.4282093236607, -188.9903862717655, -154.77029698770048, -110.27714431591951, -56.29023149355955, -80.52949958496177, -93.47791704660357, -121.23580795844315, -62.353985911654064, -82.94603423072093, 13.48397467177394, 36.620893549958254, -129.77606836044583, -88.39086516433234, -63.95800193648007, -91.71137375542668, -65.26561200557826, -80.04383274912078, -103.70826157311369, -40.289637379378455, -83.05570717309094, -155.32849663944864, -82.2655661805906, -70.15041719508119, 21.17443951601417, 36.475137887864484, -78.52429539055613, -81.79137089586355, -9.75159572483499, 37.75725514622846, -197.5734538899991, -103.38251141034077, -104.36317360325242, -72.59630584935122, -136.00402932021476, -67.70047045921766, -8.833098402388169, -121.54668507381359, 66.64053605692322, 29.946968414958498, 21.166492630918096, -52.044465358124654, 50.19135097547798, 54.30871638484782, 119.08484025142882, -108.92799148002861, -49.06704487604065, 2.0000000000000013, 4.056671076120629, -47.52945553924362, -139.42559499435262, -80.05990820926299, 58.12563705177645, 28.133944424830855, 6.071633633774463, -140.45530473409448, -41.874539514770944, 2.0000000000000013, -2.5854780136651487, -6.744640172606521, -36.646022455737764, -45.23499475876358, -39.622071488380854, 2.0000000000000013, -101.99349596740944, -154.92843075032778, -43.1736806994691, -60.57231593351933, -61.96148036681718, -86.60473986632755, -71.16886598275863, 2.0000000000000013, -124.43466862644155, -5.875235414412078, -65.79163053000107, -84.31098933046685, -94.69360738440294, -197.3071021555998, 7.211321327182255, -63.36291805633522, 34.7180887428452, -2.218763235960391, -73.43320234167447, -2.8811078791649427, 2.3859018308661755, 2.218887802740499, -25.386398688646015, -16.588482097880235, -98.74817897998399, -181.43658942792405, 11.86703266385875, -57.70652969211711, 2.0000000000000013, -24.542682070337555, -40.9603757163966, -28.21555352095561, 21.798194599372813, -44.65862626790934, -25.618803631640066, -73.41945133535543, -24.7863128265943, -18.79872584286067, -136.25771971254568, -12.685758620981328, -20.016403183850926, -42.54817839220191, 49.314839626639014, -43.42946102412525, -19.040049081949654, -45.35685492806854, 2.0000000000000013, -36.28047466959621, -13.645741952556172, -117.25768624747597, -12.560332183666702, -8.695109568444556, -48.378131731702055, -311.21478942247813, -107.99617613107782, -22.172171353423604, 39.12231556548138, -74.04002994063089, -12.950430009286157, 26.305284157747522, 12.896553286374496, -35.35367341897645, -20.626965554769683, -140.5107382867739, -172.92312843391568, -6.1853484146561675, -65.94247488912849, -36.849971896370135, -171.58742681028, -140.13937801490496, 2.0000000000000013, -44.53390760455073, -104.47902459041777, -13.946655861389942, -3.453845970557267, -3.997158961720315, -21.68745121946977, -29.534643459883014, -36.51353299832595, -28.08788661124402, -57.34703476835409, -8.952721437193292, -13.404238506844502, -69.87187291526219, 23.1148318891037, -17.662651679534704, -28.807197330117617, -5.6938170754664, -12.223781807809123, 25.64292600594583, -8.191373179953528, -25.309279937608444, -2.692096518013445, 37.15151345503439, -0.6542533630047156, 13.87999999999996, 14.700828876350963, 14.098959581881047, -13.273443572887555, 8.190357475609137], "policy_predator_policy_reward": [26.813660826959964, 2.2842939572476144, 166.00050100682967, 121.38966665442011, 4.622605613213705, 36.97298636832184, 193.7207161943083, 92.20233234981808, 10.07787299644108, 99.66274017959654, 53.93057821667636, 138.05273200684607, 61.80255478900136, 82.94486337571958, 72.25003867800528, 143.46914653142858, 77.11821714287713, 62.53610880394027, 119.43912887528502, 67.41876457960636, 59.93132211075839, 46.64254052230982, 19.019905410159293, 5.606814620299785, 83.50213333636243, 178.89893868452054, 122.34020188024756, 102.72035406998246, 15.73357026454149, 74.76818152016983, 37.6790259934811, 23.769512649235743, 52.95973214414833, 140.28782575290893, 24.88505929661139, 64.47345219699427, 304.49349664376217, 45.53595715790546, 63.47834428050542, 190.8722624956203, 135.15853849856384, 3.7911909852521215, 79.4563584446316, 151.6486127269263, 95.07113398977971, 39.08576274430584, 52.87226643466701, 43.316130777276, 91.20710036072138, 139.96971245957852, 54.18700706705555, 105.43638787464705, 80.05174657135308, 63.288134108418745, 28.34961385105386, 164.64448423058494, 220.7872417145319, 27.787014540486446, 55.98432303246868, 98.89209620908132, 16.392938210609188, 60.00346319920899, 41.043837655651416, 100.23182519335427, 10.85497651710866, 57.03475669605203, 214.35069051546628, 62.052445415315894, 73.37039279277846, 113.84084165013414, 169.20753868093917, 29.34881371872343, 93.56889457809145, 139.73545290742007, 14.432462546330774, 63.869354736267645, 83.28464498876409, 15.963853610035908, 8.200741174671608, 34.1721781868654, 104.28547755064963, 56.53227162217016, 70.9459878951867, 43.96655882316445, 50.60444506336967, 64.41828327086697, 115.95169067136344, 110.84315157455137, 22.015780479011358, 48.64606675469987, 114.97275054376334, 79.55400797830022, 35.18693560393819, 30.774030926489242, 58.17071139847248, 17.17770718258338, 59.337407494848534, 12.967970680013712, 20.609954292103286, 69.57206893045867, 187.69633895274575, 127.95437937061915, 91.13102146794147, 50.273785937308006, 141.4181202324492, 97.89526554238142, 66.28099344694195, 39.420293074331646, 39.87146682323327, 123.19169254225083, 104.45316782071532, 67.70421026341558, 202.7605954710175, 164.30818317871075, 55.79203128382953, 66.57246724008677, 54.00303043882851, 12.680472149685617, 87.56570123948941, 42.53191868848054, 45.47682861445782, 41.806857757951335, 30.179635247286996, 61.79781042753618, 80.33719687627777, 224.95269788315315, 46.51670439442322, 49.55295188763326, 41.881249915878094, 27.92386823914383, 78.9781199401242, 73.96975494528473, 53.07469624919045, 45.16858351782217, 56.77912324098763, 89.32581329193818, 31.42024816599727, 66.03183596282148, 92.48406007537507, 118.24005411672442, 68.51287635988189, 57.44272395555805, 43.899785755400764, 53.14066814989696, 78.76821003119903, 63.59282128415793, 31.74992394955204, 21.54521796993481, 114.70193719196118, 59.67477834773571, 88.20377026737037, 36.849617194861366, 346.5082792248236, 92.67751876372529, 42.07149423604678, 126.55137969695964, 56.9947067027835, 58.04909336188176, 72.38631420645629, 43.33780433316053, 26.43784155466463, 43.853224940401425, 69.47084466644105, 126.28430864741294, 54.16627885063779, 186.68988085022877, 76.72874670179151, 6.4601390801543035, 182.94982136339436, 161.99503739668634, 1.3064587549822875, 50.69704674089064, 74.54991059228755, 91.05712058939262, 45.264468862362925, 26.49159156423333, 62.970290066911076, 68.63317551925171, 40.51289431940694, 79.62599055829072, 65.03318260919929, 15.767674673874568, 53.86205373159422, 54.86073299219593, 52.563874655337465, 29.37766619024637, 10.59377619186339, 50.18405237680058, 7.131055321633652, 37.689559914050704, 5.366194830515168, 37.6885278820988, 5.640586853688664, 1.2399962092900547, 32.04240259817102, 18.92706176798693, 7.570796162763005, 18.337325494004862, 44.27794990739466, 29.90543314878875]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.299258750088731, "mean_inference_ms": 5.968373566399394, "mean_action_processing_ms": 0.9959094297404044, "mean_env_wait_ms": 0.7894385971248132, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008517742156982422, "StateBufferConnector_ms": 0.016558408737182617, "ViewRequirementAgentConnector_ms": 0.3719679117202759}, "num_episodes": 18, "episode_return_max": 280.70903994304666, "episode_return_min": -24.552829369557568, "episode_return_mean": 56.12854034175124, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1056000, "num_agent_steps_trained": 1056000, "num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 260.08504486994474, "num_env_steps_trained_throughput_per_sec": 260.08504486994474, "timesteps_total": 264000, "num_env_steps_sampled_lifetime": 264000, "num_agent_steps_sampled_lifetime": 1056000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1056000, "timers": {"training_iteration_time_ms": 16586.873, "restore_workers_time_ms": 0.014, "training_step_time_ms": 16586.83, "sample_time_ms": 4213.407, "learn_time_ms": 12356.833, "learn_throughput": 323.708, "synch_weights_time_ms": 15.569}, "counters": {"num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_agent_steps_sampled": 1056000, "num_agent_steps_trained": 1056000}, "done": false, "training_iteration": 66, "trial_id": "d163c_00000", "date": "2024-08-16_13-16-36", "timestamp": 1723794396, "time_this_iter_s": 15.384954690933228, "time_total_s": 1615.730230331421, "pid": 81201, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16b85a670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1615.730230331421, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 27.63636363636364, "ram_util_percent": 70.11363636363636}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.483074248593951, "cur_kl_coeff": 0.056250000000000015, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.8949662301906205, "policy_loss": -0.0007348452059049455, "vf_loss": 7.895357024985016, "vf_explained_var": -0.04828836965182471, "kl": 0.006116450338938961, "entropy": 0.46516352562361923, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 125685.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.8148054990188154, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.8113899251140615, "policy_loss": -0.00498936167134652, "vf_loss": 3.8152830073442408, "vf_explained_var": -0.5310915605416373, "kl": 0.005481425053570988, "entropy": 1.0309730149450755, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 125685.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 268000, "num_env_steps_trained": 268000, "num_agent_steps_sampled": 1072000, "num_agent_steps_trained": 1072000}, "env_runners": {"episode_reward_max": 174.88932175448033, "episode_reward_min": -24.552829369557568, "episode_reward_mean": 50.046762110730306, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -311.21478942247813, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 119.08484025142882, "predator_policy": 346.5082792248236}, "policy_reward_mean": {"prey_policy": -34.595987041660926, "predator_policy": 59.61936809702607}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11.143123408289556, 146.29326543367517, 13.009879295521666, 3.9540192497958047, -1.9695640749272105, 48.99619912914672, 10.19005244247902, 2.460435865878153, 134.0459788136968, -19.040003437413848, 95.895392634554, -24.552829369557568, 10.251754990308909, -5.148147379769767, 102.92456400930985, 174.88932175448033, 68.3705258715935, 146.87298672186236, 170.97459794421988, 67.84550184231028, 71.54994387111356, 7.3093390422992695, 156.92142871031834, 60.14308742174342, 26.086427015656565, 66.01830039478422, -9.575639039638647, 52.55995173418105, 58.72879160562752, 37.658810772261006, 90.74716554168576, 36.53242053851499, 32.7532553246306, 22.054758223662986, 75.0680691097257, 66.21290179476331, 99.18282809539915, 53.78330970713052, 91.88847600601628, 50.002564888296405, 25.105126351522774, 50.23015925379809, 47.26243608468418, 83.77194564805664, 75.38284809847615, 47.06668156593026, 53.86704545936378, 61.7806358585723, 63.39101873938707, 102.925832507812, 77.96412730533898, 19.01466724989109, 43.473287339664736, 103.7979457101207, 79.59287683436848, 38.45452644850491, 80.12608568951553, 129.07897268807855, 47.83394636246384, 34.617449472310824, 61.74768285229476, -19.603561003552652, 33.21805393489681, 9.469597891322426, 47.18135072987235, 64.3050554943187, 80.38137090681016, 55.53746526812746, 14.501101077526624, 25.4466753016831, 87.39372105515294, 26.276814163080083, 58.239759433820545, 9.554069595051805, 41.33999999999943, 64.1952110031532, 54.70791011499935, 69.10029695890488, 18.56273856947722, 11.722762066063671, 15.5698595008668, 11.811901361119684, 24.25665418866268, 51.893897768502036, 81.30298627197335, 9.677955001449115, 77.67739310295097, 28.07490093866014, 7.269849993671048, 64.45959004931822, 23.803879899851776, 25.579228385878736, 3.989999999999959, 24.71508035359298, 84.27207443294023, 2.9593869969316136, 20.884468212583577, 5.299330213603064, 71.7832688405412, 10.631816392023115], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-62.353985911654064, -82.94603423072093, 13.48397467177394, 36.620893549958254, -129.77606836044583, -88.39086516433234, -63.95800193648007, -91.71137375542668, -65.26561200557826, -80.04383274912078, -103.70826157311369, -40.289637379378455, -83.05570717309094, -155.32849663944864, -82.2655661805906, -70.15041719508119, 21.17443951601417, 36.475137887864484, -78.52429539055613, -81.79137089586355, -9.75159572483499, 37.75725514622846, -197.5734538899991, -103.38251141034077, -104.36317360325242, -72.59630584935122, -136.00402932021476, -67.70047045921766, -8.833098402388169, -121.54668507381359, 66.64053605692322, 29.946968414958498, 21.166492630918096, -52.044465358124654, 50.19135097547798, 54.30871638484782, 119.08484025142882, -108.92799148002861, -49.06704487604065, 2.0000000000000013, 4.056671076120629, -47.52945553924362, -139.42559499435262, -80.05990820926299, 58.12563705177645, 28.133944424830855, 6.071633633774463, -140.45530473409448, -41.874539514770944, 2.0000000000000013, -2.5854780136651487, -6.744640172606521, -36.646022455737764, -45.23499475876358, -39.622071488380854, 2.0000000000000013, -101.99349596740944, -154.92843075032778, -43.1736806994691, -60.57231593351933, -61.96148036681718, -86.60473986632755, -71.16886598275863, 2.0000000000000013, -124.43466862644155, -5.875235414412078, -65.79163053000107, -84.31098933046685, -94.69360738440294, -197.3071021555998, 7.211321327182255, -63.36291805633522, 34.7180887428452, -2.218763235960391, -73.43320234167447, -2.8811078791649427, 2.3859018308661755, 2.218887802740499, -25.386398688646015, -16.588482097880235, -98.74817897998399, -181.43658942792405, 11.86703266385875, -57.70652969211711, 2.0000000000000013, -24.542682070337555, -40.9603757163966, -28.21555352095561, 21.798194599372813, -44.65862626790934, -25.618803631640066, -73.41945133535543, -24.7863128265943, -18.79872584286067, -136.25771971254568, -12.685758620981328, -20.016403183850926, -42.54817839220191, 49.314839626639014, -43.42946102412525, -19.040049081949654, -45.35685492806854, 2.0000000000000013, -36.28047466959621, -13.645741952556172, -117.25768624747597, -12.560332183666702, -8.695109568444556, -48.378131731702055, -311.21478942247813, -107.99617613107782, -22.172171353423604, 39.12231556548138, -74.04002994063089, -12.950430009286157, 26.305284157747522, 12.896553286374496, -35.35367341897645, -20.626965554769683, -140.5107382867739, -172.92312843391568, -6.1853484146561675, -65.94247488912849, -36.849971896370135, -171.58742681028, -140.13937801490496, 2.0000000000000013, -44.53390760455073, -104.47902459041777, -13.946655861389942, -3.453845970557267, -3.997158961720315, -21.68745121946977, -29.534643459883014, -36.51353299832595, -28.08788661124402, -57.34703476835409, -8.952721437193292, -13.404238506844502, -69.87187291526219, 23.1148318891037, -17.662651679534704, -28.807197330117617, -5.6938170754664, -12.223781807809123, 25.64292600594583, -8.191373179953528, -25.309279937608444, -2.692096518013445, 37.15151345503439, -0.6542533630047156, 13.87999999999996, 14.700828876350963, 14.098959581881047, -13.273443572887555, 8.190357475609137, -5.946598338674685, -20.674602432620674, -13.305851146563267, -19.534754498989226, 0.019352382423362194, 2.0000000000000013, -67.71061784312403, -45.575906800969975, 2.0000000000000013, 13.484021067931149, 31.451018443553604, 2.9508119091962532, 35.343896290632834, -19.941547083785373, -46.44004927359662, -6.991650423576611, 20.43318013627274, -6.360801506777108, -38.4350618393898, -19.05330172533767, -6.372587752174912, -21.153490383118804, 31.884824556938344, -34.105878611892884, 12.226009873170021, -9.348409043306429, 2.0000000000000013, -19.645586707516212, 1.8154111343167116, 2.0000000000000013, -1.432706384242483, -25.98059567785739, 5.016487285014144, 2.742087151176988, -22.248041665051236, -22.06754367708749, -18.339357726047385, -1.7500268145019786, -1.3741492295266207, -77.44282158595232, -47.57857656354673, -4.156004405118592, -25.74043286343045, -25.644105386461394], "policy_predator_policy_reward": [95.07113398977971, 39.08576274430584, 52.87226643466701, 43.316130777276, 91.20710036072138, 139.96971245957852, 54.18700706705555, 105.43638787464705, 80.05174657135308, 63.288134108418745, 28.34961385105386, 164.64448423058494, 220.7872417145319, 27.787014540486446, 55.98432303246868, 98.89209620908132, 16.392938210609188, 60.00346319920899, 41.043837655651416, 100.23182519335427, 10.85497651710866, 57.03475669605203, 214.35069051546628, 62.052445415315894, 73.37039279277846, 113.84084165013414, 169.20753868093917, 29.34881371872343, 93.56889457809145, 139.73545290742007, 14.432462546330774, 63.869354736267645, 83.28464498876409, 15.963853610035908, 8.200741174671608, 34.1721781868654, 104.28547755064963, 56.53227162217016, 70.9459878951867, 43.96655882316445, 50.60444506336967, 64.41828327086697, 115.95169067136344, 110.84315157455137, 22.015780479011358, 48.64606675469987, 114.97275054376334, 79.55400797830022, 35.18693560393819, 30.774030926489242, 58.17071139847248, 17.17770718258338, 59.337407494848534, 12.967970680013712, 20.609954292103286, 69.57206893045867, 187.69633895274575, 127.95437937061915, 91.13102146794147, 50.273785937308006, 141.4181202324492, 97.89526554238142, 66.28099344694195, 39.420293074331646, 39.87146682323327, 123.19169254225083, 104.45316782071532, 67.70421026341558, 202.7605954710175, 164.30818317871075, 55.79203128382953, 66.57246724008677, 54.00303043882851, 12.680472149685617, 87.56570123948941, 42.53191868848054, 45.47682861445782, 41.806857757951335, 30.179635247286996, 61.79781042753618, 80.33719687627777, 224.95269788315315, 46.51670439442322, 49.55295188763326, 41.881249915878094, 27.92386823914383, 78.9781199401242, 73.96975494528473, 53.07469624919045, 45.16858351782217, 56.77912324098763, 89.32581329193818, 31.42024816599727, 66.03183596282148, 92.48406007537507, 118.24005411672442, 68.51287635988189, 57.44272395555805, 43.899785755400764, 53.14066814989696, 78.76821003119903, 63.59282128415793, 31.74992394955204, 21.54521796993481, 114.70193719196118, 59.67477834773571, 88.20377026737037, 36.849617194861366, 346.5082792248236, 92.67751876372529, 42.07149423604678, 126.55137969695964, 56.9947067027835, 58.04909336188176, 72.38631420645629, 43.33780433316053, 26.43784155466463, 43.853224940401425, 69.47084466644105, 126.28430864741294, 54.16627885063779, 186.68988085022877, 76.72874670179151, 6.4601390801543035, 182.94982136339436, 161.99503739668634, 1.3064587549822875, 50.69704674089064, 74.54991059228755, 91.05712058939262, 45.264468862362925, 26.49159156423333, 62.970290066911076, 68.63317551925171, 40.51289431940694, 79.62599055829072, 65.03318260919929, 15.767674673874568, 53.86205373159422, 54.86073299219593, 52.563874655337465, 29.37766619024637, 10.59377619186339, 50.18405237680058, 7.131055321633652, 37.689559914050704, 5.366194830515168, 37.6885278820988, 5.640586853688664, 1.2399962092900547, 32.04240259817102, 18.92706176798693, 7.570796162763005, 18.337325494004862, 44.27794990739466, 29.90543314878875, 10.254692545543659, 34.92924679522881, 28.030877960757223, 16.5324897508592, 6.630820793481834, 6.919686324961672, 45.8981581366042, 79.20026786860961, 5.836710155243654, 2.935922965487396, 2.713670331576241, 14.778397084176694, 35.23322846950142, 30.667408595623684, 43.50637621637477, 19.60327848224742, 50.29743224885755, 13.307582224598214, 20.223301725337837, 65.33996277804955, 30.23124258303354, 4.564685545931306, 32.8556802961539, 33.82496380811895, 11.737741508458837, 9.188537561528737, 15.654333204063365, 27.57048188933141, 0.1745888656832898, 0.0, 28.771693134564433, 23.35668928112819, 24.02406045776173, 52.48943953898714, 37.38283658445218, 9.892135754618554, 17.346914101606952, 23.626938651526125, 78.95548162416166, 5.160819404920773, 88.04798682450863, 35.46986298469708, 36.64242006728539, 25.373934574629907]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.296885044037931, "mean_inference_ms": 5.957289342236943, "mean_action_processing_ms": 0.9941165900256647, "mean_env_wait_ms": 0.7889514839025256, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01203608512878418, "StateBufferConnector_ms": 0.008160233497619629, "ViewRequirementAgentConnector_ms": 0.3525189161300659}, "num_episodes": 22, "episode_return_max": 174.88932175448033, "episode_return_min": -24.552829369557568, "episode_return_mean": 50.046762110730306, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1072000, "num_agent_steps_trained": 1072000, "num_env_steps_sampled": 268000, "num_env_steps_trained": 268000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 251.2024532447836, "num_env_steps_trained_throughput_per_sec": 251.2024532447836, "timesteps_total": 268000, "num_env_steps_sampled_lifetime": 268000, "num_agent_steps_sampled_lifetime": 1072000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1072000, "timers": {"training_iteration_time_ms": 16614.65, "restore_workers_time_ms": 0.014, "training_step_time_ms": 16614.608, "sample_time_ms": 4207.487, "learn_time_ms": 12390.485, "learn_throughput": 322.828, "synch_weights_time_ms": 15.634}, "counters": {"num_env_steps_sampled": 268000, "num_env_steps_trained": 268000, "num_agent_steps_sampled": 1072000, "num_agent_steps_trained": 1072000}, "done": false, "training_iteration": 67, "trial_id": "d163c_00000", "date": "2024-08-16_13-16-52", "timestamp": 1723794412, "time_this_iter_s": 15.928316831588745, "time_total_s": 1631.6585471630096, "pid": 81201, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16b893280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1631.6585471630096, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 29.065217391304348, "ram_util_percent": 70.15217391304347}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.084052086948717, "cur_kl_coeff": 0.056250000000000015, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.593101436877377, "policy_loss": -0.0013088783733398906, "vf_loss": 7.593965835419912, "vf_explained_var": -0.0077668628680012215, "kl": 0.007901808185567256, "entropy": 0.40956675025521133, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 127575.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.7479119710505953, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.992360217104514, "policy_loss": -0.01279563836891342, "vf_loss": 5.002574012771485, "vf_explained_var": -0.06279881580796821, "kl": 0.012909174967311268, "entropy": 1.0391727270272675, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 127575.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 272000, "num_env_steps_trained": 272000, "num_agent_steps_sampled": 1088000, "num_agent_steps_trained": 1088000}, "env_runners": {"episode_reward_max": 170.97459794421988, "episode_reward_min": -19.603561003552652, "episode_reward_mean": 50.804127476055626, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -311.21478942247813, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 119.08484025142882, "predator_policy": 346.5082792248236}, "policy_reward_mean": {"prey_policy": -30.470378015062323, "predator_policy": 55.872441753090136}, "custom_metrics": {}, "hist_stats": {"episode_reward": [170.97459794421988, 67.84550184231028, 71.54994387111356, 7.3093390422992695, 156.92142871031834, 60.14308742174342, 26.086427015656565, 66.01830039478422, -9.575639039638647, 52.55995173418105, 58.72879160562752, 37.658810772261006, 90.74716554168576, 36.53242053851499, 32.7532553246306, 22.054758223662986, 75.0680691097257, 66.21290179476331, 99.18282809539915, 53.78330970713052, 91.88847600601628, 50.002564888296405, 25.105126351522774, 50.23015925379809, 47.26243608468418, 83.77194564805664, 75.38284809847615, 47.06668156593026, 53.86704545936378, 61.7806358585723, 63.39101873938707, 102.925832507812, 77.96412730533898, 19.01466724989109, 43.473287339664736, 103.7979457101207, 79.59287683436848, 38.45452644850491, 80.12608568951553, 129.07897268807855, 47.83394636246384, 34.617449472310824, 61.74768285229476, -19.603561003552652, 33.21805393489681, 9.469597891322426, 47.18135072987235, 64.3050554943187, 80.38137090681016, 55.53746526812746, 14.501101077526624, 25.4466753016831, 87.39372105515294, 26.276814163080083, 58.239759433820545, 9.554069595051805, 41.33999999999943, 64.1952110031532, 54.70791011499935, 69.10029695890488, 18.56273856947722, 11.722762066063671, 15.5698595008668, 11.811901361119684, 24.25665418866268, 51.893897768502036, 81.30298627197335, 9.677955001449115, 77.67739310295097, 28.07490093866014, 7.269849993671048, 64.45959004931822, 23.803879899851776, 25.579228385878736, 3.989999999999959, 24.71508035359298, 84.27207443294023, 2.9593869969316136, 20.884468212583577, 5.299330213603064, 71.7832688405412, 10.631816392023115, 134.04985002758977, 46.71157307435242, 16.98949903245358, 54.39967154056085, 70.10487086571177, 22.846161603399985, 74.29641799880484, 64.61216074366956, 21.95220787275069, 84.5360425970202, 90.68795246314963, 46.97065392699017, 2.4290623443149855, 24.435987795895233, 31.807402323937747, 41.603919749538605, 58.45372483861414, 85.15008627612262], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [119.08484025142882, -108.92799148002861, -49.06704487604065, 2.0000000000000013, 4.056671076120629, -47.52945553924362, -139.42559499435262, -80.05990820926299, 58.12563705177645, 28.133944424830855, 6.071633633774463, -140.45530473409448, -41.874539514770944, 2.0000000000000013, -2.5854780136651487, -6.744640172606521, -36.646022455737764, -45.23499475876358, -39.622071488380854, 2.0000000000000013, -101.99349596740944, -154.92843075032778, -43.1736806994691, -60.57231593351933, -61.96148036681718, -86.60473986632755, -71.16886598275863, 2.0000000000000013, -124.43466862644155, -5.875235414412078, -65.79163053000107, -84.31098933046685, -94.69360738440294, -197.3071021555998, 7.211321327182255, -63.36291805633522, 34.7180887428452, -2.218763235960391, -73.43320234167447, -2.8811078791649427, 2.3859018308661755, 2.218887802740499, -25.386398688646015, -16.588482097880235, -98.74817897998399, -181.43658942792405, 11.86703266385875, -57.70652969211711, 2.0000000000000013, -24.542682070337555, -40.9603757163966, -28.21555352095561, 21.798194599372813, -44.65862626790934, -25.618803631640066, -73.41945133535543, -24.7863128265943, -18.79872584286067, -136.25771971254568, -12.685758620981328, -20.016403183850926, -42.54817839220191, 49.314839626639014, -43.42946102412525, -19.040049081949654, -45.35685492806854, 2.0000000000000013, -36.28047466959621, -13.645741952556172, -117.25768624747597, -12.560332183666702, -8.695109568444556, -48.378131731702055, -311.21478942247813, -107.99617613107782, -22.172171353423604, 39.12231556548138, -74.04002994063089, -12.950430009286157, 26.305284157747522, 12.896553286374496, -35.35367341897645, -20.626965554769683, -140.5107382867739, -172.92312843391568, -6.1853484146561675, -65.94247488912849, -36.849971896370135, -171.58742681028, -140.13937801490496, 2.0000000000000013, -44.53390760455073, -104.47902459041777, -13.946655861389942, -3.453845970557267, -3.997158961720315, -21.68745121946977, -29.534643459883014, -36.51353299832595, -28.08788661124402, -57.34703476835409, -8.952721437193292, -13.404238506844502, -69.87187291526219, 23.1148318891037, -17.662651679534704, -28.807197330117617, -5.6938170754664, -12.223781807809123, 25.64292600594583, -8.191373179953528, -25.309279937608444, -2.692096518013445, 37.15151345503439, -0.6542533630047156, 13.87999999999996, 14.700828876350963, 14.098959581881047, -13.273443572887555, 8.190357475609137, -5.946598338674685, -20.674602432620674, -13.305851146563267, -19.534754498989226, 0.019352382423362194, 2.0000000000000013, -67.71061784312403, -45.575906800969975, 2.0000000000000013, 13.484021067931149, 31.451018443553604, 2.9508119091962532, 35.343896290632834, -19.941547083785373, -46.44004927359662, -6.991650423576611, 20.43318013627274, -6.360801506777108, -38.4350618393898, -19.05330172533767, -6.372587752174912, -21.153490383118804, 31.884824556938344, -34.105878611892884, 12.226009873170021, -9.348409043306429, 2.0000000000000013, -19.645586707516212, 1.8154111343167116, 2.0000000000000013, -1.432706384242483, -25.98059567785739, 5.016487285014144, 2.742087151176988, -22.248041665051236, -22.06754367708749, -18.339357726047385, -1.7500268145019786, -1.3741492295266207, -77.44282158595232, -47.57857656354673, -4.156004405118592, -25.74043286343045, -25.644105386461394, -13.088316870958817, -39.695938716047344, 26.750000000000274, -7.161848537482726, -21.18596283645982, 2.0000000000000013, -5.463006381681129, -8.934911592437912, -70.10846101258696, -54.83481449711924, -160.21508456711848, -58.7212652486197, -77.7069854960162, -46.58439106216478, 21.429289455575148, -17.489506407887035, -8.130717368409234, -47.78767651500627, -80.4136823335733, 28.303875279828894, 33.36411107194573, 16.897605984542672, -47.7275362107939, -19.7330333846332, -10.637365052446867, -21.526154479473536, -47.8345263372428, -93.62027618360854, -15.90038391535461, -16.759284913517288, -67.77080008811735, -15.970931796403837, 27.406012355288404, -20.754323218110276, 15.687145157721604, -116.54859935936506], "policy_predator_policy_reward": [104.28547755064963, 56.53227162217016, 70.9459878951867, 43.96655882316445, 50.60444506336967, 64.41828327086697, 115.95169067136344, 110.84315157455137, 22.015780479011358, 48.64606675469987, 114.97275054376334, 79.55400797830022, 35.18693560393819, 30.774030926489242, 58.17071139847248, 17.17770718258338, 59.337407494848534, 12.967970680013712, 20.609954292103286, 69.57206893045867, 187.69633895274575, 127.95437937061915, 91.13102146794147, 50.273785937308006, 141.4181202324492, 97.89526554238142, 66.28099344694195, 39.420293074331646, 39.87146682323327, 123.19169254225083, 104.45316782071532, 67.70421026341558, 202.7605954710175, 164.30818317871075, 55.79203128382953, 66.57246724008677, 54.00303043882851, 12.680472149685617, 87.56570123948941, 42.53191868848054, 45.47682861445782, 41.806857757951335, 30.179635247286996, 61.79781042753618, 80.33719687627777, 224.95269788315315, 46.51670439442322, 49.55295188763326, 41.881249915878094, 27.92386823914383, 78.9781199401242, 73.96975494528473, 53.07469624919045, 45.16858351782217, 56.77912324098763, 89.32581329193818, 31.42024816599727, 66.03183596282148, 92.48406007537507, 118.24005411672442, 68.51287635988189, 57.44272395555805, 43.899785755400764, 53.14066814989696, 78.76821003119903, 63.59282128415793, 31.74992394955204, 21.54521796993481, 114.70193719196118, 59.67477834773571, 88.20377026737037, 36.849617194861366, 346.5082792248236, 92.67751876372529, 42.07149423604678, 126.55137969695964, 56.9947067027835, 58.04909336188176, 72.38631420645629, 43.33780433316053, 26.43784155466463, 43.853224940401425, 69.47084466644105, 126.28430864741294, 54.16627885063779, 186.68988085022877, 76.72874670179151, 6.4601390801543035, 182.94982136339436, 161.99503739668634, 1.3064587549822875, 50.69704674089064, 74.54991059228755, 91.05712058939262, 45.264468862362925, 26.49159156423333, 62.970290066911076, 68.63317551925171, 40.51289431940694, 79.62599055829072, 65.03318260919929, 15.767674673874568, 53.86205373159422, 54.86073299219593, 52.563874655337465, 29.37766619024637, 10.59377619186339, 50.18405237680058, 7.131055321633652, 37.689559914050704, 5.366194830515168, 37.6885278820988, 5.640586853688664, 1.2399962092900547, 32.04240259817102, 18.92706176798693, 7.570796162763005, 18.337325494004862, 44.27794990739466, 29.90543314878875, 10.254692545543659, 34.92924679522881, 28.030877960757223, 16.5324897508592, 6.630820793481834, 6.919686324961672, 45.8981581366042, 79.20026786860961, 5.836710155243654, 2.935922965487396, 2.713670331576241, 14.778397084176694, 35.23322846950142, 30.667408595623684, 43.50637621637477, 19.60327848224742, 50.29743224885755, 13.307582224598214, 20.223301725337837, 65.33996277804955, 30.23124258303354, 4.564685545931306, 32.8556802961539, 33.82496380811895, 11.737741508458837, 9.188537561528737, 15.654333204063365, 27.57048188933141, 0.1745888656832898, 0.0, 28.771693134564433, 23.35668928112819, 24.02406045776173, 52.48943953898714, 37.38283658445218, 9.892135754618554, 17.346914101606952, 23.626938651526125, 78.95548162416166, 5.160819404920773, 88.04798682450863, 35.46986298469708, 36.64242006728539, 25.373934574629907, 131.58233092542343, 55.251774689172315, 21.441848537482716, 5.681573074352999, 22.109738310742742, 14.0657235581708, 31.423146458062927, 37.37444305661744, 131.65518202735777, 63.392964348059905, 221.34643876216015, 20.436072656977508, 62.488983683785605, 136.09881087320008, 37.89457292424336, 22.777804771738484, 56.82000918135913, 21.05059257480647, 58.13911508786272, 78.50673456290262, 18.726275030395698, 21.699960376264812, 28.282217413920915, 86.1490061084965, 5.085226347937936, 29.507355528297616, 81.45934555111505, 84.43144476563133, 24.223110277953353, 40.24396087485627, 34.69895052711115, 90.6467011069491, 19.458576696638875, 32.343459004797914, 115.02286668651777, 70.98867379124874]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.294074392047286, "mean_inference_ms": 5.951204708817804, "mean_action_processing_ms": 0.9925825158772312, "mean_env_wait_ms": 0.7876284200447452, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023142337799072266, "StateBufferConnector_ms": 0.008193135261535645, "ViewRequirementAgentConnector_ms": 0.34787940979003906}, "num_episodes": 18, "episode_return_max": 170.97459794421988, "episode_return_min": -19.603561003552652, "episode_return_mean": 50.804127476055626, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1088000, "num_agent_steps_trained": 1088000, "num_env_steps_sampled": 272000, "num_env_steps_trained": 272000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 255.61629083490806, "num_env_steps_trained_throughput_per_sec": 255.61629083490806, "timesteps_total": 272000, "num_env_steps_sampled_lifetime": 272000, "num_agent_steps_sampled_lifetime": 1088000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1088000, "timers": {"training_iteration_time_ms": 16439.631, "restore_workers_time_ms": 0.014, "training_step_time_ms": 16439.589, "sample_time_ms": 4202.451, "learn_time_ms": 12220.543, "learn_throughput": 327.318, "synch_weights_time_ms": 15.616}, "counters": {"num_env_steps_sampled": 272000, "num_env_steps_trained": 272000, "num_agent_steps_sampled": 1088000, "num_agent_steps_trained": 1088000}, "done": false, "training_iteration": 68, "trial_id": "d163c_00000", "date": "2024-08-16_13-17-08", "timestamp": 1723794428, "time_this_iter_s": 15.652836084365845, "time_total_s": 1647.3113832473755, "pid": 81201, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16b8da8b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1647.3113832473755, "iterations_since_restore": 68, "perf": {"cpu_util_percent": 27.422727272727272, "ram_util_percent": 69.72272727272728}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.5042712472734, "cur_kl_coeff": 0.056250000000000015, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.027455513817923, "policy_loss": -0.00319330591718277, "vf_loss": 7.03036783208292, "vf_explained_var": 0.058872438297069896, "kl": 0.004995644088052727, "entropy": 0.46106271570321744, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 129465.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.0416566568707664, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.780570929264896, "policy_loss": -0.008360023973337202, "vf_loss": 4.787453841153907, "vf_explained_var": -0.06301148666275871, "kl": 0.007385557335606004, "entropy": 1.0256470259535249, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 129465.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_agent_steps_sampled": 1104000, "num_agent_steps_trained": 1104000}, "env_runners": {"episode_reward_max": 134.04985002758977, "episode_reward_min": -19.603561003552652, "episode_reward_mean": 50.11559064275924, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -311.21478942247813, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 98.54646437156623, "predator_policy": 346.5082792248236}, "policy_reward_mean": {"prey_policy": -22.112507400114538, "predator_policy": 47.17030272149414}, "custom_metrics": {}, "hist_stats": {"episode_reward": [50.23015925379809, 47.26243608468418, 83.77194564805664, 75.38284809847615, 47.06668156593026, 53.86704545936378, 61.7806358585723, 63.39101873938707, 102.925832507812, 77.96412730533898, 19.01466724989109, 43.473287339664736, 103.7979457101207, 79.59287683436848, 38.45452644850491, 80.12608568951553, 129.07897268807855, 47.83394636246384, 34.617449472310824, 61.74768285229476, -19.603561003552652, 33.21805393489681, 9.469597891322426, 47.18135072987235, 64.3050554943187, 80.38137090681016, 55.53746526812746, 14.501101077526624, 25.4466753016831, 87.39372105515294, 26.276814163080083, 58.239759433820545, 9.554069595051805, 41.33999999999943, 64.1952110031532, 54.70791011499935, 69.10029695890488, 18.56273856947722, 11.722762066063671, 15.5698595008668, 11.811901361119684, 24.25665418866268, 51.893897768502036, 81.30298627197335, 9.677955001449115, 77.67739310295097, 28.07490093866014, 7.269849993671048, 64.45959004931822, 23.803879899851776, 25.579228385878736, 3.989999999999959, 24.71508035359298, 84.27207443294023, 2.9593869969316136, 20.884468212583577, 5.299330213603064, 71.7832688405412, 10.631816392023115, 134.04985002758977, 46.71157307435242, 16.98949903245358, 54.39967154056085, 70.10487086571177, 22.846161603399985, 74.29641799880484, 64.61216074366956, 21.95220787275069, 84.5360425970202, 90.68795246314963, 46.97065392699017, 2.4290623443149855, 24.435987795895233, 31.807402323937747, 41.603919749538605, 58.45372483861414, 85.15008627612262, 88.35762091539428, 112.95700268487982, 62.12139902113888, 62.73476590164707, 21.269879861785054, 55.583577220178874, 76.80640822074831, 74.39597319209524, 53.128716978013564, 93.2324260033014, 17.68931638351037, 116.93866567732928, 33.785621565271455, 81.7145016212974, 48.18765359290598, 34.98222653519082, 14.777340678707597, 99.12524130542018, 19.788506864065784, 4.90995184633457, 39.703773548298344, 30.117176733350544, 98.3899872157208], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [11.86703266385875, -57.70652969211711, 2.0000000000000013, -24.542682070337555, -40.9603757163966, -28.21555352095561, 21.798194599372813, -44.65862626790934, -25.618803631640066, -73.41945133535543, -24.7863128265943, -18.79872584286067, -136.25771971254568, -12.685758620981328, -20.016403183850926, -42.54817839220191, 49.314839626639014, -43.42946102412525, -19.040049081949654, -45.35685492806854, 2.0000000000000013, -36.28047466959621, -13.645741952556172, -117.25768624747597, -12.560332183666702, -8.695109568444556, -48.378131731702055, -311.21478942247813, -107.99617613107782, -22.172171353423604, 39.12231556548138, -74.04002994063089, -12.950430009286157, 26.305284157747522, 12.896553286374496, -35.35367341897645, -20.626965554769683, -140.5107382867739, -172.92312843391568, -6.1853484146561675, -65.94247488912849, -36.849971896370135, -171.58742681028, -140.13937801490496, 2.0000000000000013, -44.53390760455073, -104.47902459041777, -13.946655861389942, -3.453845970557267, -3.997158961720315, -21.68745121946977, -29.534643459883014, -36.51353299832595, -28.08788661124402, -57.34703476835409, -8.952721437193292, -13.404238506844502, -69.87187291526219, 23.1148318891037, -17.662651679534704, -28.807197330117617, -5.6938170754664, -12.223781807809123, 25.64292600594583, -8.191373179953528, -25.309279937608444, -2.692096518013445, 37.15151345503439, -0.6542533630047156, 13.87999999999996, 14.700828876350963, 14.098959581881047, -13.273443572887555, 8.190357475609137, -5.946598338674685, -20.674602432620674, -13.305851146563267, -19.534754498989226, 0.019352382423362194, 2.0000000000000013, -67.71061784312403, -45.575906800969975, 2.0000000000000013, 13.484021067931149, 31.451018443553604, 2.9508119091962532, 35.343896290632834, -19.941547083785373, -46.44004927359662, -6.991650423576611, 20.43318013627274, -6.360801506777108, -38.4350618393898, -19.05330172533767, -6.372587752174912, -21.153490383118804, 31.884824556938344, -34.105878611892884, 12.226009873170021, -9.348409043306429, 2.0000000000000013, -19.645586707516212, 1.8154111343167116, 2.0000000000000013, -1.432706384242483, -25.98059567785739, 5.016487285014144, 2.742087151176988, -22.248041665051236, -22.06754367708749, -18.339357726047385, -1.7500268145019786, -1.3741492295266207, -77.44282158595232, -47.57857656354673, -4.156004405118592, -25.74043286343045, -25.644105386461394, -13.088316870958817, -39.695938716047344, 26.750000000000274, -7.161848537482726, -21.18596283645982, 2.0000000000000013, -5.463006381681129, -8.934911592437912, -70.10846101258696, -54.83481449711924, -160.21508456711848, -58.7212652486197, -77.7069854960162, -46.58439106216478, 21.429289455575148, -17.489506407887035, -8.130717368409234, -47.78767651500627, -80.4136823335733, 28.303875279828894, 33.36411107194573, 16.897605984542672, -47.7275362107939, -19.7330333846332, -10.637365052446867, -21.526154479473536, -47.8345263372428, -93.62027618360854, -15.90038391535461, -16.759284913517288, -67.77080008811735, -15.970931796403837, 27.406012355288404, -20.754323218110276, 15.687145157721604, -116.54859935936506, -13.667264282013395, -109.16959177947892, -19.773176490751176, 98.54646437156623, 48.882998912754815, 1.0189298423798847, 58.03424750606805, -0.33181757811589985, 2.0000000000000013, -13.546970600761426, -118.56924282710693, 2.0000000000000013, -3.2022547442863853, 34.89400819480228, -24.12532218544235, 31.62871358702735, -45.16702705059415, 4.41986999920406, 32.60106558927902, -57.63282806261215, 3.7879155477484137, -40.523125390090314, -4.578998851483324, -40.60723064745794, 12.983384636618226, -5.451554137041144, 53.39885725665691, -6.269695363031392, 19.82000000000028, -36.66429582639138, -24.039489384892995, 11.36741606334818, -13.01483602442589, -21.97431238350918, -36.19997096759126, 39.59422535813506, -52.787644789941325, -33.36971204069432, -14.487477774659286, -18.46250304384718, 2.2734154909150317, 25.574038529879388, 5.613662250424221, -128.5051615753646, 3.311573542241645, -23.093163698813118], "policy_predator_policy_reward": [46.51670439442322, 49.55295188763326, 41.881249915878094, 27.92386823914383, 78.9781199401242, 73.96975494528473, 53.07469624919045, 45.16858351782217, 56.77912324098763, 89.32581329193818, 31.42024816599727, 66.03183596282148, 92.48406007537507, 118.24005411672442, 68.51287635988189, 57.44272395555805, 43.899785755400764, 53.14066814989696, 78.76821003119903, 63.59282128415793, 31.74992394955204, 21.54521796993481, 114.70193719196118, 59.67477834773571, 88.20377026737037, 36.849617194861366, 346.5082792248236, 92.67751876372529, 42.07149423604678, 126.55137969695964, 56.9947067027835, 58.04909336188176, 72.38631420645629, 43.33780433316053, 26.43784155466463, 43.853224940401425, 69.47084466644105, 126.28430864741294, 54.16627885063779, 186.68988085022877, 76.72874670179151, 6.4601390801543035, 182.94982136339436, 161.99503739668634, 1.3064587549822875, 50.69704674089064, 74.54991059228755, 91.05712058939262, 45.264468862362925, 26.49159156423333, 62.970290066911076, 68.63317551925171, 40.51289431940694, 79.62599055829072, 65.03318260919929, 15.767674673874568, 53.86205373159422, 54.86073299219593, 52.563874655337465, 29.37766619024637, 10.59377619186339, 50.18405237680058, 7.131055321633652, 37.689559914050704, 5.366194830515168, 37.6885278820988, 5.640586853688664, 1.2399962092900547, 32.04240259817102, 18.92706176798693, 7.570796162763005, 18.337325494004862, 44.27794990739466, 29.90543314878875, 10.254692545543659, 34.92924679522881, 28.030877960757223, 16.5324897508592, 6.630820793481834, 6.919686324961672, 45.8981581366042, 79.20026786860961, 5.836710155243654, 2.935922965487396, 2.713670331576241, 14.778397084176694, 35.23322846950142, 30.667408595623684, 43.50637621637477, 19.60327848224742, 50.29743224885755, 13.307582224598214, 20.223301725337837, 65.33996277804955, 30.23124258303354, 4.564685545931306, 32.8556802961539, 33.82496380811895, 11.737741508458837, 9.188537561528737, 15.654333204063365, 27.57048188933141, 0.1745888656832898, 0.0, 28.771693134564433, 23.35668928112819, 24.02406045776173, 52.48943953898714, 37.38283658445218, 9.892135754618554, 17.346914101606952, 23.626938651526125, 78.95548162416166, 5.160819404920773, 88.04798682450863, 35.46986298469708, 36.64242006728539, 25.373934574629907, 131.58233092542343, 55.251774689172315, 21.441848537482716, 5.681573074352999, 22.109738310742742, 14.0657235581708, 31.423146458062927, 37.37444305661744, 131.65518202735777, 63.392964348059905, 221.34643876216015, 20.436072656977508, 62.488983683785605, 136.09881087320008, 37.89457292424336, 22.777804771738484, 56.82000918135913, 21.05059257480647, 58.13911508786272, 78.50673456290262, 18.726275030395698, 21.699960376264812, 28.282217413920915, 86.1490061084965, 5.085226347937936, 29.507355528297616, 81.45934555111505, 84.43144476563133, 24.223110277953353, 40.24396087485627, 34.69895052711115, 90.6467011069491, 19.458576696638875, 32.343459004797914, 115.02286668651777, 70.98867379124874, 43.65073563951097, 167.54374133737474, 9.739806780551001, 24.443908023513817, 8.885468740272445, 3.334001525732033, 2.1007111691016798, 2.9316248045935382, 0.8098798617847047, 32.006970600761385, 101.59778514831663, 70.55503489896964, 11.185203152281103, 33.929451617950576, 49.73676321881919, 17.155818571691306, 51.20584284120094, 42.67003118820289, 66.54766026167982, 51.71652821495511, 32.36118279825916, 22.06334342759264, 114.74753431016337, 47.377360866106436, 18.868614900911176, 7.385176164783293, 23.995770017619737, 10.589569710051041, 33.25790337574202, 31.77404604355559, 24.29588696884349, 23.358412887892293, 46.021604307478015, 3.7448847791648174, 41.737713320777914, 53.99327359409806, 90.93218444360629, 15.013679251094574, 32.675358077566784, 5.184574587274537, 11.192978078700564, 0.6633414488037681, 130.30883563014828, 22.69984042814112, 94.46696892159117, 23.704608450700796]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.29068374921397, "mean_inference_ms": 5.940246604375404, "mean_action_processing_ms": 0.9905703921985157, "mean_env_wait_ms": 0.7859209814432961, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02540457248687744, "StateBufferConnector_ms": 0.007720947265625, "ViewRequirementAgentConnector_ms": 0.3785172700881958}, "num_episodes": 23, "episode_return_max": 134.04985002758977, "episode_return_min": -19.603561003552652, "episode_return_mean": 50.11559064275924, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1104000, "num_agent_steps_trained": 1104000, "num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 230.3687520901229, "num_env_steps_trained_throughput_per_sec": 230.3687520901229, "timesteps_total": 276000, "num_env_steps_sampled_lifetime": 276000, "num_agent_steps_sampled_lifetime": 1104000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1104000, "timers": {"training_iteration_time_ms": 16567.579, "restore_workers_time_ms": 0.014, "training_step_time_ms": 16567.536, "sample_time_ms": 4197.586, "learn_time_ms": 12353.675, "learn_throughput": 323.79, "synch_weights_time_ms": 15.31}, "counters": {"num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_agent_steps_sampled": 1104000, "num_agent_steps_trained": 1104000}, "done": false, "training_iteration": 69, "trial_id": "d163c_00000", "date": "2024-08-16_13-17-25", "timestamp": 1723794445, "time_this_iter_s": 17.36747717857361, "time_total_s": 1664.678860425949, "pid": 81201, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16b839160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1664.678860425949, "iterations_since_restore": 69, "perf": {"cpu_util_percent": 30.90833333333333, "ram_util_percent": 70.04583333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.242992585676689, "cur_kl_coeff": 0.028125000000000008, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.484521306759466, "policy_loss": -0.0033049040015727753, "vf_loss": 5.487658022068165, "vf_explained_var": 0.12568654692362224, "kl": 0.005980056100133232, "entropy": 0.39638314707569344, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 131355.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.268139453697457, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.879678339302225, "policy_loss": -0.0077391490237984474, "vf_loss": 4.886073605597965, "vf_explained_var": -0.06958369451855856, "kl": 0.006719426907516256, "entropy": 1.0088414669352235, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 131355.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 280000, "num_env_steps_trained": 280000, "num_agent_steps_sampled": 1120000, "num_agent_steps_trained": 1120000}, "env_runners": {"episode_reward_max": 157.44321996434482, "episode_reward_min": -19.603561003552652, "episode_reward_mean": 50.92730932318142, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -172.92312843391568, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 100.97075890905437, "predator_policy": 221.34643876216015}, "policy_reward_mean": {"prey_policy": -13.431299318592664, "predator_policy": 38.89495398018335}, "custom_metrics": {}, "hist_stats": {"episode_reward": [34.617449472310824, 61.74768285229476, -19.603561003552652, 33.21805393489681, 9.469597891322426, 47.18135072987235, 64.3050554943187, 80.38137090681016, 55.53746526812746, 14.501101077526624, 25.4466753016831, 87.39372105515294, 26.276814163080083, 58.239759433820545, 9.554069595051805, 41.33999999999943, 64.1952110031532, 54.70791011499935, 69.10029695890488, 18.56273856947722, 11.722762066063671, 15.5698595008668, 11.811901361119684, 24.25665418866268, 51.893897768502036, 81.30298627197335, 9.677955001449115, 77.67739310295097, 28.07490093866014, 7.269849993671048, 64.45959004931822, 23.803879899851776, 25.579228385878736, 3.989999999999959, 24.71508035359298, 84.27207443294023, 2.9593869969316136, 20.884468212583577, 5.299330213603064, 71.7832688405412, 10.631816392023115, 134.04985002758977, 46.71157307435242, 16.98949903245358, 54.39967154056085, 70.10487086571177, 22.846161603399985, 74.29641799880484, 64.61216074366956, 21.95220787275069, 84.5360425970202, 90.68795246314963, 46.97065392699017, 2.4290623443149855, 24.435987795895233, 31.807402323937747, 41.603919749538605, 58.45372483861414, 85.15008627612262, 88.35762091539428, 112.95700268487982, 62.12139902113888, 62.73476590164707, 21.269879861785054, 55.583577220178874, 76.80640822074831, 74.39597319209524, 53.128716978013564, 93.2324260033014, 17.68931638351037, 116.93866567732928, 33.785621565271455, 81.7145016212974, 48.18765359290598, 34.98222653519082, 14.777340678707597, 99.12524130542018, 19.788506864065784, 4.90995184633457, 39.703773548298344, 30.117176733350544, 98.3899872157208, 96.81267601779969, 157.44321996434482, 17.294071833401016, 69.48445139569027, 89.16222399426574, 145.70496918077913, 62.93576296987978, 66.3743219347873, 6.516561416816073, 72.11889275718394, 25.563607776613384, -4.8482111432251065, 42.743889171988634, 56.24417486412, 125.2612129040929, 108.30498846366964, 69.65889403879525, 79.41119934524306], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-20.626965554769683, -140.5107382867739, -172.92312843391568, -6.1853484146561675, -65.94247488912849, -36.849971896370135, -171.58742681028, -140.13937801490496, 2.0000000000000013, -44.53390760455073, -104.47902459041777, -13.946655861389942, -3.453845970557267, -3.997158961720315, -21.68745121946977, -29.534643459883014, -36.51353299832595, -28.08788661124402, -57.34703476835409, -8.952721437193292, -13.404238506844502, -69.87187291526219, 23.1148318891037, -17.662651679534704, -28.807197330117617, -5.6938170754664, -12.223781807809123, 25.64292600594583, -8.191373179953528, -25.309279937608444, -2.692096518013445, 37.15151345503439, -0.6542533630047156, 13.87999999999996, 14.700828876350963, 14.098959581881047, -13.273443572887555, 8.190357475609137, -5.946598338674685, -20.674602432620674, -13.305851146563267, -19.534754498989226, 0.019352382423362194, 2.0000000000000013, -67.71061784312403, -45.575906800969975, 2.0000000000000013, 13.484021067931149, 31.451018443553604, 2.9508119091962532, 35.343896290632834, -19.941547083785373, -46.44004927359662, -6.991650423576611, 20.43318013627274, -6.360801506777108, -38.4350618393898, -19.05330172533767, -6.372587752174912, -21.153490383118804, 31.884824556938344, -34.105878611892884, 12.226009873170021, -9.348409043306429, 2.0000000000000013, -19.645586707516212, 1.8154111343167116, 2.0000000000000013, -1.432706384242483, -25.98059567785739, 5.016487285014144, 2.742087151176988, -22.248041665051236, -22.06754367708749, -18.339357726047385, -1.7500268145019786, -1.3741492295266207, -77.44282158595232, -47.57857656354673, -4.156004405118592, -25.74043286343045, -25.644105386461394, -13.088316870958817, -39.695938716047344, 26.750000000000274, -7.161848537482726, -21.18596283645982, 2.0000000000000013, -5.463006381681129, -8.934911592437912, -70.10846101258696, -54.83481449711924, -160.21508456711848, -58.7212652486197, -77.7069854960162, -46.58439106216478, 21.429289455575148, -17.489506407887035, -8.130717368409234, -47.78767651500627, -80.4136823335733, 28.303875279828894, 33.36411107194573, 16.897605984542672, -47.7275362107939, -19.7330333846332, -10.637365052446867, -21.526154479473536, -47.8345263372428, -93.62027618360854, -15.90038391535461, -16.759284913517288, -67.77080008811735, -15.970931796403837, 27.406012355288404, -20.754323218110276, 15.687145157721604, -116.54859935936506, -13.667264282013395, -109.16959177947892, -19.773176490751176, 98.54646437156623, 48.882998912754815, 1.0189298423798847, 58.03424750606805, -0.33181757811589985, 2.0000000000000013, -13.546970600761426, -118.56924282710693, 2.0000000000000013, -3.2022547442863853, 34.89400819480228, -24.12532218544235, 31.62871358702735, -45.16702705059415, 4.41986999920406, 32.60106558927902, -57.63282806261215, 3.7879155477484137, -40.523125390090314, -4.578998851483324, -40.60723064745794, 12.983384636618226, -5.451554137041144, 53.39885725665691, -6.269695363031392, 19.82000000000028, -36.66429582639138, -24.039489384892995, 11.36741606334818, -13.01483602442589, -21.97431238350918, -36.19997096759126, 39.59422535813506, -52.787644789941325, -33.36971204069432, -14.487477774659286, -18.46250304384718, 2.2734154909150317, 25.574038529879388, 5.613662250424221, -128.5051615753646, 3.311573542241645, -23.093163698813118, 39.49261972627763, 21.022879898180378, 19.681429042809516, 36.587102381236114, -49.19629181246788, -0.01783842518749846, -17.512391394045284, 32.311427590209796, -18.704565397775223, 75.62452482204695, 65.2174666459392, 14.582609713386807, 2.0000000000000013, 37.51601115205621, 46.32107716220956, 2.0000000000000013, -20.303157628529807, -18.087391093861633, 10.486329589488683, -12.78404245536878, -4.045902499765728, -5.0455237251705505, -44.545784370014076, -20.48440695309037, -7.064025795649387, 3.4723557721351432, 17.441975486165973, -15.64844962691972, -17.389242435134122, 100.97075890905437, 2.0000000000000013, 93.41896954190784, 13.88656203967507, 15.66961910074149, 54.07258856513931, -9.987689799035739], "policy_predator_policy_reward": [69.47084466644105, 126.28430864741294, 54.16627885063779, 186.68988085022877, 76.72874670179151, 6.4601390801543035, 182.94982136339436, 161.99503739668634, 1.3064587549822875, 50.69704674089064, 74.54991059228755, 91.05712058939262, 45.264468862362925, 26.49159156423333, 62.970290066911076, 68.63317551925171, 40.51289431940694, 79.62599055829072, 65.03318260919929, 15.767674673874568, 53.86205373159422, 54.86073299219593, 52.563874655337465, 29.37766619024637, 10.59377619186339, 50.18405237680058, 7.131055321633652, 37.689559914050704, 5.366194830515168, 37.6885278820988, 5.640586853688664, 1.2399962092900547, 32.04240259817102, 18.92706176798693, 7.570796162763005, 18.337325494004862, 44.27794990739466, 29.90543314878875, 10.254692545543659, 34.92924679522881, 28.030877960757223, 16.5324897508592, 6.630820793481834, 6.919686324961672, 45.8981581366042, 79.20026786860961, 5.836710155243654, 2.935922965487396, 2.713670331576241, 14.778397084176694, 35.23322846950142, 30.667408595623684, 43.50637621637477, 19.60327848224742, 50.29743224885755, 13.307582224598214, 20.223301725337837, 65.33996277804955, 30.23124258303354, 4.564685545931306, 32.8556802961539, 33.82496380811895, 11.737741508458837, 9.188537561528737, 15.654333204063365, 27.57048188933141, 0.1745888656832898, 0.0, 28.771693134564433, 23.35668928112819, 24.02406045776173, 52.48943953898714, 37.38283658445218, 9.892135754618554, 17.346914101606952, 23.626938651526125, 78.95548162416166, 5.160819404920773, 88.04798682450863, 35.46986298469708, 36.64242006728539, 25.373934574629907, 131.58233092542343, 55.251774689172315, 21.441848537482716, 5.681573074352999, 22.109738310742742, 14.0657235581708, 31.423146458062927, 37.37444305661744, 131.65518202735777, 63.392964348059905, 221.34643876216015, 20.436072656977508, 62.488983683785605, 136.09881087320008, 37.89457292424336, 22.777804771738484, 56.82000918135913, 21.05059257480647, 58.13911508786272, 78.50673456290262, 18.726275030395698, 21.699960376264812, 28.282217413920915, 86.1490061084965, 5.085226347937936, 29.507355528297616, 81.45934555111505, 84.43144476563133, 24.223110277953353, 40.24396087485627, 34.69895052711115, 90.6467011069491, 19.458576696638875, 32.343459004797914, 115.02286668651777, 70.98867379124874, 43.65073563951097, 167.54374133737474, 9.739806780551001, 24.443908023513817, 8.885468740272445, 3.334001525732033, 2.1007111691016798, 2.9316248045935382, 0.8098798617847047, 32.006970600761385, 101.59778514831663, 70.55503489896964, 11.185203152281103, 33.929451617950576, 49.73676321881919, 17.155818571691306, 51.20584284120094, 42.67003118820289, 66.54766026167982, 51.71652821495511, 32.36118279825916, 22.06334342759264, 114.74753431016337, 47.377360866106436, 18.868614900911176, 7.385176164783293, 23.995770017619737, 10.589569710051041, 33.25790337574202, 31.77404604355559, 24.29588696884349, 23.358412887892293, 46.021604307478015, 3.7448847791648174, 41.737713320777914, 53.99327359409806, 90.93218444360629, 15.013679251094574, 32.675358077566784, 5.184574587274537, 11.192978078700564, 0.6633414488037681, 130.30883563014828, 22.69984042814112, 94.46696892159117, 23.704608450700796, 23.2716179813476, 13.025558411993245, 37.363912279785836, 63.810776260513194, 5.384424957879592, 61.12377711317672, 23.220920649142283, 31.464494550383865, 20.235644603251007, 12.006619966742475, 24.930472098187128, 40.97442072326612, 15.560919626079475, 7.858832191744433, 4.199612114963795, 13.853632657613824, 3.415595724480288, 41.4915144147277, 58.1236704105113, 16.29293521255285, 12.510659296853122, 22.144374704696485, 4.769747545053801, 55.41223263482559, 7.8462888099006305, 38.489270385602474, 29.54389007518282, 24.906758929691595, 15.695032126476246, 25.98466430369603, 6.713390252690034, 6.172628669071256, 6.9907655456181255, 33.11194735276023, 21.33550494758048, 13.990795631558937]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.288771450269157, "mean_inference_ms": 5.933758570663687, "mean_action_processing_ms": 0.9894997949589992, "mean_env_wait_ms": 0.7846355306270997, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030048847198486328, "StateBufferConnector_ms": 0.02258312702178955, "ViewRequirementAgentConnector_ms": 0.39349687099456787}, "num_episodes": 18, "episode_return_max": 157.44321996434482, "episode_return_min": -19.603561003552652, "episode_return_mean": 50.92730932318142, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1120000, "num_agent_steps_trained": 1120000, "num_env_steps_sampled": 280000, "num_env_steps_trained": 280000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 217.87040517789617, "num_env_steps_trained_throughput_per_sec": 217.87040517789617, "timesteps_total": 280000, "num_env_steps_sampled_lifetime": 280000, "num_agent_steps_sampled_lifetime": 1120000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1120000, "timers": {"training_iteration_time_ms": 16822.47, "restore_workers_time_ms": 0.014, "training_step_time_ms": 16822.429, "sample_time_ms": 4258.318, "learn_time_ms": 12547.952, "learn_throughput": 318.777, "synch_weights_time_ms": 15.216}, "counters": {"num_env_steps_sampled": 280000, "num_env_steps_trained": 280000, "num_agent_steps_sampled": 1120000, "num_agent_steps_trained": 1120000}, "done": false, "training_iteration": 70, "trial_id": "d163c_00000", "date": "2024-08-16_13-17-43", "timestamp": 1723794463, "time_this_iter_s": 18.364653825759888, "time_total_s": 1683.043514251709, "pid": 81201, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16b85a0d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1683.043514251709, "iterations_since_restore": 70, "perf": {"cpu_util_percent": 31.342307692307692, "ram_util_percent": 70.66923076923077}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.0471005262521205, "cur_kl_coeff": 0.028125000000000008, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.097285570795574, "policy_loss": -0.004355448279308067, "vf_loss": 5.101541410930573, "vf_explained_var": 0.11354957967208176, "kl": 0.0035412623083620172, "entropy": 0.3377292975546822, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 133245.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1625264456032447, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.300918986053063, "policy_loss": -0.007086911067248337, "vf_loss": 6.306395493108759, "vf_explained_var": -0.014014046974283047, "kl": 0.008051983349016441, "entropy": 0.961296848645286, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 133245.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 284000, "num_env_steps_trained": 284000, "num_agent_steps_sampled": 1136000, "num_agent_steps_trained": 1136000}, "env_runners": {"episode_reward_max": 176.834702068979, "episode_reward_min": -4.8482111432251065, "episode_reward_mean": 58.64270215362149, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -160.21508456711848, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 100.97075890905437, "predator_policy": 221.34643876216015}, "policy_reward_mean": {"prey_policy": -5.742969387231678, "predator_policy": 35.0643204640424}, "custom_metrics": {}, "hist_stats": {"episode_reward": [69.10029695890488, 18.56273856947722, 11.722762066063671, 15.5698595008668, 11.811901361119684, 24.25665418866268, 51.893897768502036, 81.30298627197335, 9.677955001449115, 77.67739310295097, 28.07490093866014, 7.269849993671048, 64.45959004931822, 23.803879899851776, 25.579228385878736, 3.989999999999959, 24.71508035359298, 84.27207443294023, 2.9593869969316136, 20.884468212583577, 5.299330213603064, 71.7832688405412, 10.631816392023115, 134.04985002758977, 46.71157307435242, 16.98949903245358, 54.39967154056085, 70.10487086571177, 22.846161603399985, 74.29641799880484, 64.61216074366956, 21.95220787275069, 84.5360425970202, 90.68795246314963, 46.97065392699017, 2.4290623443149855, 24.435987795895233, 31.807402323937747, 41.603919749538605, 58.45372483861414, 85.15008627612262, 88.35762091539428, 112.95700268487982, 62.12139902113888, 62.73476590164707, 21.269879861785054, 55.583577220178874, 76.80640822074831, 74.39597319209524, 53.128716978013564, 93.2324260033014, 17.68931638351037, 116.93866567732928, 33.785621565271455, 81.7145016212974, 48.18765359290598, 34.98222653519082, 14.777340678707597, 99.12524130542018, 19.788506864065784, 4.90995184633457, 39.703773548298344, 30.117176733350544, 98.3899872157208, 96.81267601779969, 157.44321996434482, 17.294071833401016, 69.48445139569027, 89.16222399426574, 145.70496918077913, 62.93576296987978, 66.3743219347873, 6.516561416816073, 72.11889275718394, 25.563607776613384, -4.8482111432251065, 42.743889171988634, 56.24417486412, 125.2612129040929, 108.30498846366964, 69.65889403879525, 79.41119934524306, 40.740894827701965, 176.834702068979, 45.395144235244196, 70.20845080379506, 96.58720018456548, 145.46027502420418, 5.57618149616052, 129.021638867839, 14.882064300291493, 112.46495989230351, 129.78202039285776, 130.31041308966527, 96.94852065908283, 31.12997996018511, 13.425250951831293, 100.47659828473404, 88.28471529543367, 92.52000000000037], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-13.273443572887555, 8.190357475609137, -5.946598338674685, -20.674602432620674, -13.305851146563267, -19.534754498989226, 0.019352382423362194, 2.0000000000000013, -67.71061784312403, -45.575906800969975, 2.0000000000000013, 13.484021067931149, 31.451018443553604, 2.9508119091962532, 35.343896290632834, -19.941547083785373, -46.44004927359662, -6.991650423576611, 20.43318013627274, -6.360801506777108, -38.4350618393898, -19.05330172533767, -6.372587752174912, -21.153490383118804, 31.884824556938344, -34.105878611892884, 12.226009873170021, -9.348409043306429, 2.0000000000000013, -19.645586707516212, 1.8154111343167116, 2.0000000000000013, -1.432706384242483, -25.98059567785739, 5.016487285014144, 2.742087151176988, -22.248041665051236, -22.06754367708749, -18.339357726047385, -1.7500268145019786, -1.3741492295266207, -77.44282158595232, -47.57857656354673, -4.156004405118592, -25.74043286343045, -25.644105386461394, -13.088316870958817, -39.695938716047344, 26.750000000000274, -7.161848537482726, -21.18596283645982, 2.0000000000000013, -5.463006381681129, -8.934911592437912, -70.10846101258696, -54.83481449711924, -160.21508456711848, -58.7212652486197, -77.7069854960162, -46.58439106216478, 21.429289455575148, -17.489506407887035, -8.130717368409234, -47.78767651500627, -80.4136823335733, 28.303875279828894, 33.36411107194573, 16.897605984542672, -47.7275362107939, -19.7330333846332, -10.637365052446867, -21.526154479473536, -47.8345263372428, -93.62027618360854, -15.90038391535461, -16.759284913517288, -67.77080008811735, -15.970931796403837, 27.406012355288404, -20.754323218110276, 15.687145157721604, -116.54859935936506, -13.667264282013395, -109.16959177947892, -19.773176490751176, 98.54646437156623, 48.882998912754815, 1.0189298423798847, 58.03424750606805, -0.33181757811589985, 2.0000000000000013, -13.546970600761426, -118.56924282710693, 2.0000000000000013, -3.2022547442863853, 34.89400819480228, -24.12532218544235, 31.62871358702735, -45.16702705059415, 4.41986999920406, 32.60106558927902, -57.63282806261215, 3.7879155477484137, -40.523125390090314, -4.578998851483324, -40.60723064745794, 12.983384636618226, -5.451554137041144, 53.39885725665691, -6.269695363031392, 19.82000000000028, -36.66429582639138, -24.039489384892995, 11.36741606334818, -13.01483602442589, -21.97431238350918, -36.19997096759126, 39.59422535813506, -52.787644789941325, -33.36971204069432, -14.487477774659286, -18.46250304384718, 2.2734154909150317, 25.574038529879388, 5.613662250424221, -128.5051615753646, 3.311573542241645, -23.093163698813118, 39.49261972627763, 21.022879898180378, 19.681429042809516, 36.587102381236114, -49.19629181246788, -0.01783842518749846, -17.512391394045284, 32.311427590209796, -18.704565397775223, 75.62452482204695, 65.2174666459392, 14.582609713386807, 2.0000000000000013, 37.51601115205621, 46.32107716220956, 2.0000000000000013, -20.303157628529807, -18.087391093861633, 10.486329589488683, -12.78404245536878, -4.045902499765728, -5.0455237251705505, -44.545784370014076, -20.48440695309037, -7.064025795649387, 3.4723557721351432, 17.441975486165973, -15.64844962691972, -17.389242435134122, 100.97075890905437, 2.0000000000000013, 93.41896954190784, 13.88656203967507, 15.66961910074149, 54.07258856513931, -9.987689799035739, 8.946288778749425, 25.878404758278073, 54.96300624245182, 83.77841542792865, 2.0000000000000013, 38.04609732524887, -10.903908441953156, 1.4013203192897978, 18.86506707410139, 5.752243111564875, 100.605904252093, 2.0000000000000013, -144.24230870413535, 0.8165906285457726, -7.658274692003523, 54.85475984985399, -3.467772283494984, -94.58461474451533, 30.8738274130149, 48.94961183515577, 59.94569456825956, 31.76359959461251, 49.64087972196127, 32.450856505116455, 14.957576088236582, 12.135171841578927, -25.955922477049892, 2.0000000000000013, -65.59102660116848, -36.175002859642056, 30.030488354369627, -89.34375631030807, 77.92772588124288, -5.4376413567435415, 89.34939488993622, -18.127508007583554], "policy_predator_policy_reward": [44.27794990739466, 29.90543314878875, 10.254692545543659, 34.92924679522881, 28.030877960757223, 16.5324897508592, 6.630820793481834, 6.919686324961672, 45.8981581366042, 79.20026786860961, 5.836710155243654, 2.935922965487396, 2.713670331576241, 14.778397084176694, 35.23322846950142, 30.667408595623684, 43.50637621637477, 19.60327848224742, 50.29743224885755, 13.307582224598214, 20.223301725337837, 65.33996277804955, 30.23124258303354, 4.564685545931306, 32.8556802961539, 33.82496380811895, 11.737741508458837, 9.188537561528737, 15.654333204063365, 27.57048188933141, 0.1745888656832898, 0.0, 28.771693134564433, 23.35668928112819, 24.02406045776173, 52.48943953898714, 37.38283658445218, 9.892135754618554, 17.346914101606952, 23.626938651526125, 78.95548162416166, 5.160819404920773, 88.04798682450863, 35.46986298469708, 36.64242006728539, 25.373934574629907, 131.58233092542343, 55.251774689172315, 21.441848537482716, 5.681573074352999, 22.109738310742742, 14.0657235581708, 31.423146458062927, 37.37444305661744, 131.65518202735777, 63.392964348059905, 221.34643876216015, 20.436072656977508, 62.488983683785605, 136.09881087320008, 37.89457292424336, 22.777804771738484, 56.82000918135913, 21.05059257480647, 58.13911508786272, 78.50673456290262, 18.726275030395698, 21.699960376264812, 28.282217413920915, 86.1490061084965, 5.085226347937936, 29.507355528297616, 81.45934555111505, 84.43144476563133, 24.223110277953353, 40.24396087485627, 34.69895052711115, 90.6467011069491, 19.458576696638875, 32.343459004797914, 115.02286668651777, 70.98867379124874, 43.65073563951097, 167.54374133737474, 9.739806780551001, 24.443908023513817, 8.885468740272445, 3.334001525732033, 2.1007111691016798, 2.9316248045935382, 0.8098798617847047, 32.006970600761385, 101.59778514831663, 70.55503489896964, 11.185203152281103, 33.929451617950576, 49.73676321881919, 17.155818571691306, 51.20584284120094, 42.67003118820289, 66.54766026167982, 51.71652821495511, 32.36118279825916, 22.06334342759264, 114.74753431016337, 47.377360866106436, 18.868614900911176, 7.385176164783293, 23.995770017619737, 10.589569710051041, 33.25790337574202, 31.77404604355559, 24.29588696884349, 23.358412887892293, 46.021604307478015, 3.7448847791648174, 41.737713320777914, 53.99327359409806, 90.93218444360629, 15.013679251094574, 32.675358077566784, 5.184574587274537, 11.192978078700564, 0.6633414488037681, 130.30883563014828, 22.69984042814112, 94.46696892159117, 23.704608450700796, 23.2716179813476, 13.025558411993245, 37.363912279785836, 63.810776260513194, 5.384424957879592, 61.12377711317672, 23.220920649142283, 31.464494550383865, 20.235644603251007, 12.006619966742475, 24.930472098187128, 40.97442072326612, 15.560919626079475, 7.858832191744433, 4.199612114963795, 13.853632657613824, 3.415595724480288, 41.4915144147277, 58.1236704105113, 16.29293521255285, 12.510659296853122, 22.144374704696485, 4.769747545053801, 55.41223263482559, 7.8462888099006305, 38.489270385602474, 29.54389007518282, 24.906758929691595, 15.695032126476246, 25.98466430369603, 6.713390252690034, 6.172628669071256, 6.9907655456181255, 33.11194735276023, 21.33550494758048, 13.990795631558937, 0.8900098175706196, 5.0261914731033785, 20.09663397553507, 17.99664642306358, 1.961184444167525, 3.3878624658280527, 11.718871898856339, 67.992167027602, 55.386472430139534, 16.58341756875924, 9.791120500573786, 33.063250271537456, 21.554920773928632, 127.44697879782102, 43.644863090986355, 38.180290619001916, 86.40277094019159, 26.531680388110267, 15.069810999310484, 17.57170964482204, 5.870534106853447, 32.20219212313223, 19.480083694723703, 28.738593167863584, 22.086744126900538, 47.76902860236641, 18.873771494237314, 36.21213094299786, 62.20060558065396, 52.99067483198794, 122.40129903508323, 37.38856720559005, 7.315535880017548, 8.479094890916585, 19.62750800758379, 1.6706051100639439]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.2870463160923715, "mean_inference_ms": 5.927436367486664, "mean_action_processing_ms": 0.9885356233869929, "mean_env_wait_ms": 0.7833458298797353, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03192460536956787, "StateBufferConnector_ms": 0.022757411003112793, "ViewRequirementAgentConnector_ms": 0.3859628438949585}, "num_episodes": 18, "episode_return_max": 176.834702068979, "episode_return_min": -4.8482111432251065, "episode_return_mean": 58.64270215362149, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1136000, "num_agent_steps_trained": 1136000, "num_env_steps_sampled": 284000, "num_env_steps_trained": 284000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 253.20062935777696, "num_env_steps_trained_throughput_per_sec": 253.20062935777696, "timesteps_total": 284000, "num_env_steps_sampled_lifetime": 284000, "num_agent_steps_sampled_lifetime": 1136000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1136000, "timers": {"training_iteration_time_ms": 16703.955, "restore_workers_time_ms": 0.014, "training_step_time_ms": 16703.914, "sample_time_ms": 4270.333, "learn_time_ms": 12417.884, "learn_throughput": 322.116, "synch_weights_time_ms": 14.789}, "counters": {"num_env_steps_sampled": 284000, "num_env_steps_trained": 284000, "num_agent_steps_sampled": 1136000, "num_agent_steps_trained": 1136000}, "done": false, "training_iteration": 71, "trial_id": "d163c_00000", "date": "2024-08-16_13-17-59", "timestamp": 1723794479, "time_this_iter_s": 15.801594257354736, "time_total_s": 1698.8451085090637, "pid": 81201, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16b893940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1698.8451085090637, "iterations_since_restore": 71, "perf": {"cpu_util_percent": 27.28260869565217, "ram_util_percent": 70.61304347826085}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.519396678732816, "cur_kl_coeff": 0.014062500000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.9384528701267545, "policy_loss": -0.006569421844847658, "vf_loss": 3.9446992283775693, "vf_explained_var": -0.10704446359286232, "kl": 0.02297357265969651, "entropy": 0.4225412253191862, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 135135.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.9246065485729744, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.471777672994705, "policy_loss": -0.009627055427029966, "vf_loss": 7.479745554545569, "vf_explained_var": 0.08123195515107856, "kl": 0.008295864900837677, "entropy": 0.9085114814301647, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 135135.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_agent_steps_sampled": 1152000, "num_agent_steps_trained": 1152000}, "env_runners": {"episode_reward_max": 275.3867613090291, "episode_reward_min": -19.330871613056043, "episode_reward_mean": 84.75399618537455, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -186.13707522322068, "predator_policy": 0.16902161108050182}, "policy_reward_max": {"prey_policy": 144.4379480460109, "predator_policy": 222.45949206650883}, "policy_reward_mean": {"prey_policy": 6.7295179421256375, "predator_policy": 35.64748015056164}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.631816392023115, 134.04985002758977, 46.71157307435242, 16.98949903245358, 54.39967154056085, 70.10487086571177, 22.846161603399985, 74.29641799880484, 64.61216074366956, 21.95220787275069, 84.5360425970202, 90.68795246314963, 46.97065392699017, 2.4290623443149855, 24.435987795895233, 31.807402323937747, 41.603919749538605, 58.45372483861414, 85.15008627612262, 88.35762091539428, 112.95700268487982, 62.12139902113888, 62.73476590164707, 21.269879861785054, 55.583577220178874, 76.80640822074831, 74.39597319209524, 53.128716978013564, 93.2324260033014, 17.68931638351037, 116.93866567732928, 33.785621565271455, 81.7145016212974, 48.18765359290598, 34.98222653519082, 14.777340678707597, 99.12524130542018, 19.788506864065784, 4.90995184633457, 39.703773548298344, 30.117176733350544, 98.3899872157208, 96.81267601779969, 157.44321996434482, 17.294071833401016, 69.48445139569027, 89.16222399426574, 145.70496918077913, 62.93576296987978, 66.3743219347873, 6.516561416816073, 72.11889275718394, 25.563607776613384, -4.8482111432251065, 42.743889171988634, 56.24417486412, 125.2612129040929, 108.30498846366964, 69.65889403879525, 79.41119934524306, 40.740894827701965, 176.834702068979, 45.395144235244196, 70.20845080379506, 96.58720018456548, 145.46027502420418, 5.57618149616052, 129.021638867839, 14.882064300291493, 112.46495989230351, 129.78202039285776, 130.31041308966527, 96.94852065908283, 31.12997996018511, 13.425250951831293, 100.47659828473404, 88.28471529543367, 92.52000000000037, 182.11781011978167, 3.839999999999962, 271.3214969098057, 53.707872758456936, 213.0150674159263, 101.71281625305872, 2.182318993030077, 151.74780222735848, 219.43580682867915, 66.8779905641727, 224.85281273424619, 78.74449141451102, 235.49705509147645, 257.9870006772617, 208.79006843886188, 233.31549294962244, 232.98990391745778, 275.3867613090291, 76.7191380464033, 70.40570255641843, -19.330871613056043, 204.48036869034715], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-25.74043286343045, -25.644105386461394, -13.088316870958817, -39.695938716047344, 26.750000000000274, -7.161848537482726, -21.18596283645982, 2.0000000000000013, -5.463006381681129, -8.934911592437912, -70.10846101258696, -54.83481449711924, -160.21508456711848, -58.7212652486197, -77.7069854960162, -46.58439106216478, 21.429289455575148, -17.489506407887035, -8.130717368409234, -47.78767651500627, -80.4136823335733, 28.303875279828894, 33.36411107194573, 16.897605984542672, -47.7275362107939, -19.7330333846332, -10.637365052446867, -21.526154479473536, -47.8345263372428, -93.62027618360854, -15.90038391535461, -16.759284913517288, -67.77080008811735, -15.970931796403837, 27.406012355288404, -20.754323218110276, 15.687145157721604, -116.54859935936506, -13.667264282013395, -109.16959177947892, -19.773176490751176, 98.54646437156623, 48.882998912754815, 1.0189298423798847, 58.03424750606805, -0.33181757811589985, 2.0000000000000013, -13.546970600761426, -118.56924282710693, 2.0000000000000013, -3.2022547442863853, 34.89400819480228, -24.12532218544235, 31.62871358702735, -45.16702705059415, 4.41986999920406, 32.60106558927902, -57.63282806261215, 3.7879155477484137, -40.523125390090314, -4.578998851483324, -40.60723064745794, 12.983384636618226, -5.451554137041144, 53.39885725665691, -6.269695363031392, 19.82000000000028, -36.66429582639138, -24.039489384892995, 11.36741606334818, -13.01483602442589, -21.97431238350918, -36.19997096759126, 39.59422535813506, -52.787644789941325, -33.36971204069432, -14.487477774659286, -18.46250304384718, 2.2734154909150317, 25.574038529879388, 5.613662250424221, -128.5051615753646, 3.311573542241645, -23.093163698813118, 39.49261972627763, 21.022879898180378, 19.681429042809516, 36.587102381236114, -49.19629181246788, -0.01783842518749846, -17.512391394045284, 32.311427590209796, -18.704565397775223, 75.62452482204695, 65.2174666459392, 14.582609713386807, 2.0000000000000013, 37.51601115205621, 46.32107716220956, 2.0000000000000013, -20.303157628529807, -18.087391093861633, 10.486329589488683, -12.78404245536878, -4.045902499765728, -5.0455237251705505, -44.545784370014076, -20.48440695309037, -7.064025795649387, 3.4723557721351432, 17.441975486165973, -15.64844962691972, -17.389242435134122, 100.97075890905437, 2.0000000000000013, 93.41896954190784, 13.88656203967507, 15.66961910074149, 54.07258856513931, -9.987689799035739, 8.946288778749425, 25.878404758278073, 54.96300624245182, 83.77841542792865, 2.0000000000000013, 38.04609732524887, -10.903908441953156, 1.4013203192897978, 18.86506707410139, 5.752243111564875, 100.605904252093, 2.0000000000000013, -144.24230870413535, 0.8165906285457726, -7.658274692003523, 54.85475984985399, -3.467772283494984, -94.58461474451533, 30.8738274130149, 48.94961183515577, 59.94569456825956, 31.76359959461251, 49.64087972196127, 32.450856505116455, 14.957576088236582, 12.135171841578927, -25.955922477049892, 2.0000000000000013, -65.59102660116848, -36.175002859642056, 30.030488354369627, -89.34375631030807, 77.92772588124288, -5.4376413567435415, 89.34939488993622, -18.127508007583554, -13.547210159334687, 112.94918404439089, 1.653963843647777, -1.9027969235104831, 113.85810253800587, 133.2651344538031, 17.383095262898443, -0.5533729173731803, 87.3167255554912, 60.70267353229408, -2.988950231526986, 91.00448272107624, -2.3245838202499653, -2.960960360467806, 132.227672348969, 2.0000000000000013, -46.20245156436524, 118.74587482612506, -6.433481002072741, -50.2643001104632, 79.46237037745915, 99.46248544603158, -8.838092143938796, 16.606047224574688, 119.55614412113898, 26.226050660281082, 98.73519637496692, 143.43445018649777, 54.950989577226174, 132.5558003165205, 100.09128135982081, 91.36024650629919, 87.78740616992764, 56.71869699080579, 144.4379480460109, 117.30868495288752, -14.042987363991001, 16.567507167385727, -14.049631913662466, 58.91348359458607, -186.13707522322068, -77.16670101615907, 38.35521227881483, 105.59064513686418], "policy_predator_policy_reward": [36.64242006728539, 25.373934574629907, 131.58233092542343, 55.251774689172315, 21.441848537482716, 5.681573074352999, 22.109738310742742, 14.0657235581708, 31.423146458062927, 37.37444305661744, 131.65518202735777, 63.392964348059905, 221.34643876216015, 20.436072656977508, 62.488983683785605, 136.09881087320008, 37.89457292424336, 22.777804771738484, 56.82000918135913, 21.05059257480647, 58.13911508786272, 78.50673456290262, 18.726275030395698, 21.699960376264812, 28.282217413920915, 86.1490061084965, 5.085226347937936, 29.507355528297616, 81.45934555111505, 84.43144476563133, 24.223110277953353, 40.24396087485627, 34.69895052711115, 90.6467011069491, 19.458576696638875, 32.343459004797914, 115.02286668651777, 70.98867379124874, 43.65073563951097, 167.54374133737474, 9.739806780551001, 24.443908023513817, 8.885468740272445, 3.334001525732033, 2.1007111691016798, 2.9316248045935382, 0.8098798617847047, 32.006970600761385, 101.59778514831663, 70.55503489896964, 11.185203152281103, 33.929451617950576, 49.73676321881919, 17.155818571691306, 51.20584284120094, 42.67003118820289, 66.54766026167982, 51.71652821495511, 32.36118279825916, 22.06334342759264, 114.74753431016337, 47.377360866106436, 18.868614900911176, 7.385176164783293, 23.995770017619737, 10.589569710051041, 33.25790337574202, 31.77404604355559, 24.29588696884349, 23.358412887892293, 46.021604307478015, 3.7448847791648174, 41.737713320777914, 53.99327359409806, 90.93218444360629, 15.013679251094574, 32.675358077566784, 5.184574587274537, 11.192978078700564, 0.6633414488037681, 130.30883563014828, 22.69984042814112, 94.46696892159117, 23.704608450700796, 23.2716179813476, 13.025558411993245, 37.363912279785836, 63.810776260513194, 5.384424957879592, 61.12377711317672, 23.220920649142283, 31.464494550383865, 20.235644603251007, 12.006619966742475, 24.930472098187128, 40.97442072326612, 15.560919626079475, 7.858832191744433, 4.199612114963795, 13.853632657613824, 3.415595724480288, 41.4915144147277, 58.1236704105113, 16.29293521255285, 12.510659296853122, 22.144374704696485, 4.769747545053801, 55.41223263482559, 7.8462888099006305, 38.489270385602474, 29.54389007518282, 24.906758929691595, 15.695032126476246, 25.98466430369603, 6.713390252690034, 6.172628669071256, 6.9907655456181255, 33.11194735276023, 21.33550494758048, 13.990795631558937, 0.8900098175706196, 5.0261914731033785, 20.09663397553507, 17.99664642306358, 1.961184444167525, 3.3878624658280527, 11.718871898856339, 67.992167027602, 55.386472430139534, 16.58341756875924, 9.791120500573786, 33.063250271537456, 21.554920773928632, 127.44697879782102, 43.644863090986355, 38.180290619001916, 86.40277094019159, 26.531680388110267, 15.069810999310484, 17.57170964482204, 5.870534106853447, 32.20219212313223, 19.480083694723703, 28.738593167863584, 22.086744126900538, 47.76902860236641, 18.873771494237314, 36.21213094299786, 62.20060558065396, 52.99067483198794, 122.40129903508323, 37.38856720559005, 7.315535880017548, 8.479094890916585, 19.62750800758379, 1.6706051100639439, 19.555671089791026, 63.16016514493493, 0.16902161108050182, 3.9198114687821684, 12.573629211013934, 11.624630706983522, 4.804057401287866, 32.074093011644095, 27.685570678035486, 37.310097650106364, 5.0117664845853716, 8.68551727892379, 5.761192655180692, 1.7066705185670805, 4.75334179928814, 12.76678807910118, 118.92754526420399, 27.96483830271561, 50.91014953470683, 72.66562214200204, 32.281749494437015, 13.646207416319521, 55.25182037073187, 15.724715963143199, 65.02205290333633, 24.692807406720455, 5.798492043606319, 10.018862072191187, 15.559422220536884, 5.723856324578121, 23.339364881667944, 18.524600201834364, 36.367724108761834, 52.11607664796258, 7.083916361049707, 6.556211949081651, 33.430688091533725, 40.76393015147448, 15.591038672505087, 9.95081220298989, 21.513412559814952, 222.45949206650883, 47.737944275453344, 12.796566999215354]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.2851216765766003, "mean_inference_ms": 5.921482999151542, "mean_action_processing_ms": 0.9876214493475126, "mean_env_wait_ms": 0.781920297547442, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030754923820495605, "StateBufferConnector_ms": 0.02402818202972412, "ViewRequirementAgentConnector_ms": 0.4231160879135132}, "num_episodes": 22, "episode_return_max": 275.3867613090291, "episode_return_min": -19.330871613056043, "episode_return_mean": 84.75399618537455, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1152000, "num_agent_steps_trained": 1152000, "num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 255.61842896013928, "num_env_steps_trained_throughput_per_sec": 255.61842896013928, "timesteps_total": 288000, "num_env_steps_sampled_lifetime": 288000, "num_agent_steps_sampled_lifetime": 1152000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1152000, "timers": {"training_iteration_time_ms": 16370.915, "restore_workers_time_ms": 0.014, "training_step_time_ms": 16370.873, "sample_time_ms": 4256.639, "learn_time_ms": 12098.854, "learn_throughput": 330.61, "synch_weights_time_ms": 14.494}, "counters": {"num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_agent_steps_sampled": 1152000, "num_agent_steps_trained": 1152000}, "done": false, "training_iteration": 72, "trial_id": "d163c_00000", "date": "2024-08-16_13-18-15", "timestamp": 1723794495, "time_this_iter_s": 15.652169942855835, "time_total_s": 1714.4972784519196, "pid": 81201, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16b8939d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1714.4972784519196, "iterations_since_restore": 72, "perf": {"cpu_util_percent": 28.118181818181824, "ram_util_percent": 70.32727272727273}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.645784277512283, "cur_kl_coeff": 0.02109375, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.6470614835698765, "policy_loss": -0.006236871057953784, "vf_loss": 4.6529513741296435, "vf_explained_var": 0.06467311584129536, "kl": 0.016449151812913523, "entropy": 0.4114464984999763, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 137025.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.8604834910107666, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.762027780088798, "policy_loss": -0.0013571367061958111, "vf_loss": 6.762595746883009, "vf_explained_var": 0.056827735648584114, "kl": 0.003945897394811697, "entropy": 0.9037405314268889, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 137025.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 292000, "num_env_steps_trained": 292000, "num_agent_steps_sampled": 1168000, "num_agent_steps_trained": 1168000}, "env_runners": {"episode_reward_max": 313.5685336916874, "episode_reward_min": -19.330871613056043, "episode_reward_mean": 105.1290312074021, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -193.3966866371198, "predator_policy": 0.16902161108050182}, "policy_reward_max": {"prey_policy": 163.60333381894802, "predator_policy": 222.45949206650883}, "policy_reward_mean": {"prey_policy": 20.24948837656749, "predator_policy": 32.315027227133584}, "custom_metrics": {}, "hist_stats": {"episode_reward": [21.269879861785054, 55.583577220178874, 76.80640822074831, 74.39597319209524, 53.128716978013564, 93.2324260033014, 17.68931638351037, 116.93866567732928, 33.785621565271455, 81.7145016212974, 48.18765359290598, 34.98222653519082, 14.777340678707597, 99.12524130542018, 19.788506864065784, 4.90995184633457, 39.703773548298344, 30.117176733350544, 98.3899872157208, 96.81267601779969, 157.44321996434482, 17.294071833401016, 69.48445139569027, 89.16222399426574, 145.70496918077913, 62.93576296987978, 66.3743219347873, 6.516561416816073, 72.11889275718394, 25.563607776613384, -4.8482111432251065, 42.743889171988634, 56.24417486412, 125.2612129040929, 108.30498846366964, 69.65889403879525, 79.41119934524306, 40.740894827701965, 176.834702068979, 45.395144235244196, 70.20845080379506, 96.58720018456548, 145.46027502420418, 5.57618149616052, 129.021638867839, 14.882064300291493, 112.46495989230351, 129.78202039285776, 130.31041308966527, 96.94852065908283, 31.12997996018511, 13.425250951831293, 100.47659828473404, 88.28471529543367, 92.52000000000037, 182.11781011978167, 3.839999999999962, 271.3214969098057, 53.707872758456936, 213.0150674159263, 101.71281625305872, 2.182318993030077, 151.74780222735848, 219.43580682867915, 66.8779905641727, 224.85281273424619, 78.74449141451102, 235.49705509147645, 257.9870006772617, 208.79006843886188, 233.31549294962244, 232.98990391745778, 275.3867613090291, 76.7191380464033, 70.40570255641843, -19.330871613056043, 204.48036869034715, 274.7174521505823, 3.6283224836427794, 231.21581365909836, 17.494221776670383, 270.3486130497748, 131.88000000000045, 241.02894493267615, 71.00328666336095, 186.95084828783865, 7.114024948321643, 73.59850193428414, 251.59674754698014, 17.616292138247957, 41.437289659621726, 243.2794934131448, 216.61762124095668, 35.25238414927241, 178.82056464652186, 57.44016891955915, 166.48796987143217, 69.84351910848673, 313.5685336916874, 245.40273792055459], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [2.0000000000000013, -13.546970600761426, -118.56924282710693, 2.0000000000000013, -3.2022547442863853, 34.89400819480228, -24.12532218544235, 31.62871358702735, -45.16702705059415, 4.41986999920406, 32.60106558927902, -57.63282806261215, 3.7879155477484137, -40.523125390090314, -4.578998851483324, -40.60723064745794, 12.983384636618226, -5.451554137041144, 53.39885725665691, -6.269695363031392, 19.82000000000028, -36.66429582639138, -24.039489384892995, 11.36741606334818, -13.01483602442589, -21.97431238350918, -36.19997096759126, 39.59422535813506, -52.787644789941325, -33.36971204069432, -14.487477774659286, -18.46250304384718, 2.2734154909150317, 25.574038529879388, 5.613662250424221, -128.5051615753646, 3.311573542241645, -23.093163698813118, 39.49261972627763, 21.022879898180378, 19.681429042809516, 36.587102381236114, -49.19629181246788, -0.01783842518749846, -17.512391394045284, 32.311427590209796, -18.704565397775223, 75.62452482204695, 65.2174666459392, 14.582609713386807, 2.0000000000000013, 37.51601115205621, 46.32107716220956, 2.0000000000000013, -20.303157628529807, -18.087391093861633, 10.486329589488683, -12.78404245536878, -4.045902499765728, -5.0455237251705505, -44.545784370014076, -20.48440695309037, -7.064025795649387, 3.4723557721351432, 17.441975486165973, -15.64844962691972, -17.389242435134122, 100.97075890905437, 2.0000000000000013, 93.41896954190784, 13.88656203967507, 15.66961910074149, 54.07258856513931, -9.987689799035739, 8.946288778749425, 25.878404758278073, 54.96300624245182, 83.77841542792865, 2.0000000000000013, 38.04609732524887, -10.903908441953156, 1.4013203192897978, 18.86506707410139, 5.752243111564875, 100.605904252093, 2.0000000000000013, -144.24230870413535, 0.8165906285457726, -7.658274692003523, 54.85475984985399, -3.467772283494984, -94.58461474451533, 30.8738274130149, 48.94961183515577, 59.94569456825956, 31.76359959461251, 49.64087972196127, 32.450856505116455, 14.957576088236582, 12.135171841578927, -25.955922477049892, 2.0000000000000013, -65.59102660116848, -36.175002859642056, 30.030488354369627, -89.34375631030807, 77.92772588124288, -5.4376413567435415, 89.34939488993622, -18.127508007583554, -13.547210159334687, 112.94918404439089, 1.653963843647777, -1.9027969235104831, 113.85810253800587, 133.2651344538031, 17.383095262898443, -0.5533729173731803, 87.3167255554912, 60.70267353229408, -2.988950231526986, 91.00448272107624, -2.3245838202499653, -2.960960360467806, 132.227672348969, 2.0000000000000013, -46.20245156436524, 118.74587482612506, -6.433481002072741, -50.2643001104632, 79.46237037745915, 99.46248544603158, -8.838092143938796, 16.606047224574688, 119.55614412113898, 26.226050660281082, 98.73519637496692, 143.43445018649777, 54.950989577226174, 132.5558003165205, 100.09128135982081, 91.36024650629919, 87.78740616992764, 56.71869699080579, 144.4379480460109, 117.30868495288752, -14.042987363991001, 16.567507167385727, -14.049631913662466, 58.91348359458607, -186.13707522322068, -77.16670101615907, 38.35521227881483, 105.59064513686418, 116.35566061332325, 121.17755879117084, 0.793039090521758, -2.5495688543459503, 68.75955081238547, 83.81947412286534, -176.61019202013094, 2.0000000000000013, 82.7155817719971, 148.7192146100306, 112.21786109979146, -9.769697668374766, 67.92529581423966, 127.73978165724773, 14.033211410426418, -3.363054563617374, 75.33153176103635, 44.84101952907275, 2.0000000000000013, -1.7219061753959881, -23.047319072174766, -5.670203897473321, 63.10128733166364, 122.084881562866, -89.9868566222454, -20.871596711309856, -42.01058056336315, -29.88914892814019, 100.24844894607918, 109.3533510253838, 125.2994161310363, 34.76882043577224, -14.629874034643045, -51.09039067167019, 105.5638861690313, 18.730155896841246, -193.3966866371198, -0.6166164013272992, 74.02097739219494, 61.7447661670483, -15.416644765600594, 0.943705731259645, 134.87756112773155, 163.60333381894802, 86.40072443736878, 87.15283439275275], "policy_predator_policy_reward": [0.8098798617847047, 32.006970600761385, 101.59778514831663, 70.55503489896964, 11.185203152281103, 33.929451617950576, 49.73676321881919, 17.155818571691306, 51.20584284120094, 42.67003118820289, 66.54766026167982, 51.71652821495511, 32.36118279825916, 22.06334342759264, 114.74753431016337, 47.377360866106436, 18.868614900911176, 7.385176164783293, 23.995770017619737, 10.589569710051041, 33.25790337574202, 31.77404604355559, 24.29588696884349, 23.358412887892293, 46.021604307478015, 3.7448847791648174, 41.737713320777914, 53.99327359409806, 90.93218444360629, 15.013679251094574, 32.675358077566784, 5.184574587274537, 11.192978078700564, 0.6633414488037681, 130.30883563014828, 22.69984042814112, 94.46696892159117, 23.704608450700796, 23.2716179813476, 13.025558411993245, 37.363912279785836, 63.810776260513194, 5.384424957879592, 61.12377711317672, 23.220920649142283, 31.464494550383865, 20.235644603251007, 12.006619966742475, 24.930472098187128, 40.97442072326612, 15.560919626079475, 7.858832191744433, 4.199612114963795, 13.853632657613824, 3.415595724480288, 41.4915144147277, 58.1236704105113, 16.29293521255285, 12.510659296853122, 22.144374704696485, 4.769747545053801, 55.41223263482559, 7.8462888099006305, 38.489270385602474, 29.54389007518282, 24.906758929691595, 15.695032126476246, 25.98466430369603, 6.713390252690034, 6.172628669071256, 6.9907655456181255, 33.11194735276023, 21.33550494758048, 13.990795631558937, 0.8900098175706196, 5.0261914731033785, 20.09663397553507, 17.99664642306358, 1.961184444167525, 3.3878624658280527, 11.718871898856339, 67.992167027602, 55.386472430139534, 16.58341756875924, 9.791120500573786, 33.063250271537456, 21.554920773928632, 127.44697879782102, 43.644863090986355, 38.180290619001916, 86.40277094019159, 26.531680388110267, 15.069810999310484, 17.57170964482204, 5.870534106853447, 32.20219212313223, 19.480083694723703, 28.738593167863584, 22.086744126900538, 47.76902860236641, 18.873771494237314, 36.21213094299786, 62.20060558065396, 52.99067483198794, 122.40129903508323, 37.38856720559005, 7.315535880017548, 8.479094890916585, 19.62750800758379, 1.6706051100639439, 19.555671089791026, 63.16016514493493, 0.16902161108050182, 3.9198114687821684, 12.573629211013934, 11.624630706983522, 4.804057401287866, 32.074093011644095, 27.685570678035486, 37.310097650106364, 5.0117664845853716, 8.68551727892379, 5.761192655180692, 1.7066705185670805, 4.75334179928814, 12.76678807910118, 118.92754526420399, 27.96483830271561, 50.91014953470683, 72.66562214200204, 32.281749494437015, 13.646207416319521, 55.25182037073187, 15.724715963143199, 65.02205290333633, 24.692807406720455, 5.798492043606319, 10.018862072191187, 15.559422220536884, 5.723856324578121, 23.339364881667944, 18.524600201834364, 36.367724108761834, 52.11607664796258, 7.083916361049707, 6.556211949081651, 33.430688091533725, 40.76393015147448, 15.591038672505087, 9.95081220298989, 21.513412559814952, 222.45949206650883, 47.737944275453344, 12.796566999215354, 11.75911533442411, 25.425117411664566, 4.4595688543459095, 0.9252833931210558, 42.09425785380492, 36.542530870042604, 6.028148115820489, 186.07626568098098, 24.19906010334534, 14.714756564402306, 17.655712825612657, 11.776123742970666, 22.60076896301864, 22.763098498170603, 3.955104130121767, 56.37802568643016, 32.39830327052379, 34.379993727206, 3.5193573533828957, 3.316573770334783, 56.389612905622506, 45.92641199830981, 34.431427480818535, 31.979151171632076, 36.69308880558874, 91.78165666621469, 99.85050821953655, 13.486510931588267, 6.91024234863721, 26.767451093045036, 41.61927423092801, 14.930110443220332, 68.31357579684477, 32.65907305874091, 30.645684931089555, 23.88083764955971, 175.50911632070597, 75.9443556373005, 21.99419407412348, 8.7280322380658, 41.933933752113035, 42.382524390714536, 4.110248820881021, 10.97738992412716, 47.36514898128133, 24.48403010915193]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.284114002159876, "mean_inference_ms": 5.916015198308119, "mean_action_processing_ms": 0.9864255315850404, "mean_env_wait_ms": 0.7806786475912909, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.019407153129577637, "StateBufferConnector_ms": 0.023802995681762695, "ViewRequirementAgentConnector_ms": 0.4338247776031494}, "num_episodes": 23, "episode_return_max": 313.5685336916874, "episode_return_min": -19.330871613056043, "episode_return_mean": 105.1290312074021, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1168000, "num_agent_steps_trained": 1168000, "num_env_steps_sampled": 292000, "num_env_steps_trained": 292000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 252.83185894186295, "num_env_steps_trained_throughput_per_sec": 252.83185894186295, "timesteps_total": 292000, "num_env_steps_sampled_lifetime": 292000, "num_agent_steps_sampled_lifetime": 1168000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1168000, "timers": {"training_iteration_time_ms": 16342.222, "restore_workers_time_ms": 0.014, "training_step_time_ms": 16342.182, "sample_time_ms": 4249.823, "learn_time_ms": 12076.852, "learn_throughput": 331.212, "synch_weights_time_ms": 14.643}, "counters": {"num_env_steps_sampled": 292000, "num_env_steps_trained": 292000, "num_agent_steps_sampled": 1168000, "num_agent_steps_trained": 1168000}, "done": false, "training_iteration": 73, "trial_id": "d163c_00000", "date": "2024-08-16_13-18-31", "timestamp": 1723794511, "time_this_iter_s": 15.825291872024536, "time_total_s": 1730.322570323944, "pid": 81201, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16b87caf0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1730.322570323944, "iterations_since_restore": 73, "perf": {"cpu_util_percent": 28.609090909090913, "ram_util_percent": 70.25454545454546}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.642687735166499, "cur_kl_coeff": 0.02109375, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.912454156270103, "policy_loss": -0.0036937912284253686, "vf_loss": 4.916055059559131, "vf_explained_var": 0.033371139739556285, "kl": 0.0044038081037147455, "entropy": 0.4318621313130414, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 138915.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.97827741238806, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.075959352715306, "policy_loss": -0.004206158271645782, "vf_loss": 7.079471886347211, "vf_explained_var": 0.02240914260899579, "kl": 0.0069361891753804425, "entropy": 0.877470004400879, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 138915.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 296000, "num_env_steps_trained": 296000, "num_agent_steps_sampled": 1184000, "num_agent_steps_trained": 1184000}, "env_runners": {"episode_reward_max": 313.5685336916874, "episode_reward_min": -94.88611166974651, "episode_reward_mean": 116.2854756975262, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -216.4148277200133, "predator_policy": 0.16902161108050182}, "policy_reward_max": {"prey_policy": 165.96405084574997, "predator_policy": 222.45949206650883}, "policy_reward_mean": {"prey_policy": 23.9771908804094, "predator_policy": 34.16554696835373}, "custom_metrics": {}, "hist_stats": {"episode_reward": [98.3899872157208, 96.81267601779969, 157.44321996434482, 17.294071833401016, 69.48445139569027, 89.16222399426574, 145.70496918077913, 62.93576296987978, 66.3743219347873, 6.516561416816073, 72.11889275718394, 25.563607776613384, -4.8482111432251065, 42.743889171988634, 56.24417486412, 125.2612129040929, 108.30498846366964, 69.65889403879525, 79.41119934524306, 40.740894827701965, 176.834702068979, 45.395144235244196, 70.20845080379506, 96.58720018456548, 145.46027502420418, 5.57618149616052, 129.021638867839, 14.882064300291493, 112.46495989230351, 129.78202039285776, 130.31041308966527, 96.94852065908283, 31.12997996018511, 13.425250951831293, 100.47659828473404, 88.28471529543367, 92.52000000000037, 182.11781011978167, 3.839999999999962, 271.3214969098057, 53.707872758456936, 213.0150674159263, 101.71281625305872, 2.182318993030077, 151.74780222735848, 219.43580682867915, 66.8779905641727, 224.85281273424619, 78.74449141451102, 235.49705509147645, 257.9870006772617, 208.79006843886188, 233.31549294962244, 232.98990391745778, 275.3867613090291, 76.7191380464033, 70.40570255641843, -19.330871613056043, 204.48036869034715, 274.7174521505823, 3.6283224836427794, 231.21581365909836, 17.494221776670383, 270.3486130497748, 131.88000000000045, 241.02894493267615, 71.00328666336095, 186.95084828783865, 7.114024948321643, 73.59850193428414, 251.59674754698014, 17.616292138247957, 41.437289659621726, 243.2794934131448, 216.61762124095668, 35.25238414927241, 178.82056464652186, 57.44016891955915, 166.48796987143217, 69.84351910848673, 313.5685336916874, 245.40273792055459, 3.7534790431130074, 57.5362483467586, 96.97072192565871, 62.68538370662381, 215.75863083028915, 129.52843209928483, 83.17793076032187, -37.11530206597885, 300.0834820789443, 5.278073656808999, 264.0412231140647, 242.02299682627827, 48.88923279220452, -94.88611166974651, 272.12539993987946, 159.11885031204775, 78.99083808612471, 143.82189705753575], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [3.311573542241645, -23.093163698813118, 39.49261972627763, 21.022879898180378, 19.681429042809516, 36.587102381236114, -49.19629181246788, -0.01783842518749846, -17.512391394045284, 32.311427590209796, -18.704565397775223, 75.62452482204695, 65.2174666459392, 14.582609713386807, 2.0000000000000013, 37.51601115205621, 46.32107716220956, 2.0000000000000013, -20.303157628529807, -18.087391093861633, 10.486329589488683, -12.78404245536878, -4.045902499765728, -5.0455237251705505, -44.545784370014076, -20.48440695309037, -7.064025795649387, 3.4723557721351432, 17.441975486165973, -15.64844962691972, -17.389242435134122, 100.97075890905437, 2.0000000000000013, 93.41896954190784, 13.88656203967507, 15.66961910074149, 54.07258856513931, -9.987689799035739, 8.946288778749425, 25.878404758278073, 54.96300624245182, 83.77841542792865, 2.0000000000000013, 38.04609732524887, -10.903908441953156, 1.4013203192897978, 18.86506707410139, 5.752243111564875, 100.605904252093, 2.0000000000000013, -144.24230870413535, 0.8165906285457726, -7.658274692003523, 54.85475984985399, -3.467772283494984, -94.58461474451533, 30.8738274130149, 48.94961183515577, 59.94569456825956, 31.76359959461251, 49.64087972196127, 32.450856505116455, 14.957576088236582, 12.135171841578927, -25.955922477049892, 2.0000000000000013, -65.59102660116848, -36.175002859642056, 30.030488354369627, -89.34375631030807, 77.92772588124288, -5.4376413567435415, 89.34939488993622, -18.127508007583554, -13.547210159334687, 112.94918404439089, 1.653963843647777, -1.9027969235104831, 113.85810253800587, 133.2651344538031, 17.383095262898443, -0.5533729173731803, 87.3167255554912, 60.70267353229408, -2.988950231526986, 91.00448272107624, -2.3245838202499653, -2.960960360467806, 132.227672348969, 2.0000000000000013, -46.20245156436524, 118.74587482612506, -6.433481002072741, -50.2643001104632, 79.46237037745915, 99.46248544603158, -8.838092143938796, 16.606047224574688, 119.55614412113898, 26.226050660281082, 98.73519637496692, 143.43445018649777, 54.950989577226174, 132.5558003165205, 100.09128135982081, 91.36024650629919, 87.78740616992764, 56.71869699080579, 144.4379480460109, 117.30868495288752, -14.042987363991001, 16.567507167385727, -14.049631913662466, 58.91348359458607, -186.13707522322068, -77.16670101615907, 38.35521227881483, 105.59064513686418, 116.35566061332325, 121.17755879117084, 0.793039090521758, -2.5495688543459503, 68.75955081238547, 83.81947412286534, -176.61019202013094, 2.0000000000000013, 82.7155817719971, 148.7192146100306, 112.21786109979146, -9.769697668374766, 67.92529581423966, 127.73978165724773, 14.033211410426418, -3.363054563617374, 75.33153176103635, 44.84101952907275, 2.0000000000000013, -1.7219061753959881, -23.047319072174766, -5.670203897473321, 63.10128733166364, 122.084881562866, -89.9868566222454, -20.871596711309856, -42.01058056336315, -29.88914892814019, 100.24844894607918, 109.3533510253838, 125.2994161310363, 34.76882043577224, -14.629874034643045, -51.09039067167019, 105.5638861690313, 18.730155896841246, -193.3966866371198, -0.6166164013272992, 74.02097739219494, 61.7447661670483, -15.416644765600594, 0.943705731259645, 134.87756112773155, 163.60333381894802, 86.40072443736878, 87.15283439275275, -63.148586175505145, 2.0000000000000013, 36.75861691094452, -39.827874966967876, 23.210085511068563, -24.320758001404155, -42.02099387189839, 1.7753683542480088, 112.75057247061153, -3.9923146583600158, 4.973877349923161, 54.900375018256184, 22.007138413074294, -14.680760868682174, -82.35006276011698, -97.75510113083388, 165.96405084574997, 89.95683778777429, -1.0284633649265982, -216.4148277200133, 133.80091554125875, 94.94087783349367, 68.34636598643618, 113.52803972637145, -44.83154482719992, 0.1990294502245062, -151.05275718795346, -141.30948676859796, 113.91385154640389, 148.5026406895428, 67.17175984370384, 26.15060069358399, -179.0280059293388, 1.581169817011115, 117.28613860642253, -9.63935456310831], "policy_predator_policy_reward": [94.46696892159117, 23.704608450700796, 23.2716179813476, 13.025558411993245, 37.363912279785836, 63.810776260513194, 5.384424957879592, 61.12377711317672, 23.220920649142283, 31.464494550383865, 20.235644603251007, 12.006619966742475, 24.930472098187128, 40.97442072326612, 15.560919626079475, 7.858832191744433, 4.199612114963795, 13.853632657613824, 3.415595724480288, 41.4915144147277, 58.1236704105113, 16.29293521255285, 12.510659296853122, 22.144374704696485, 4.769747545053801, 55.41223263482559, 7.8462888099006305, 38.489270385602474, 29.54389007518282, 24.906758929691595, 15.695032126476246, 25.98466430369603, 6.713390252690034, 6.172628669071256, 6.9907655456181255, 33.11194735276023, 21.33550494758048, 13.990795631558937, 0.8900098175706196, 5.0261914731033785, 20.09663397553507, 17.99664642306358, 1.961184444167525, 3.3878624658280527, 11.718871898856339, 67.992167027602, 55.386472430139534, 16.58341756875924, 9.791120500573786, 33.063250271537456, 21.554920773928632, 127.44697879782102, 43.644863090986355, 38.180290619001916, 86.40277094019159, 26.531680388110267, 15.069810999310484, 17.57170964482204, 5.870534106853447, 32.20219212313223, 19.480083694723703, 28.738593167863584, 22.086744126900538, 47.76902860236641, 18.873771494237314, 36.21213094299786, 62.20060558065396, 52.99067483198794, 122.40129903508323, 37.38856720559005, 7.315535880017548, 8.479094890916585, 19.62750800758379, 1.6706051100639439, 19.555671089791026, 63.16016514493493, 0.16902161108050182, 3.9198114687821684, 12.573629211013934, 11.624630706983522, 4.804057401287866, 32.074093011644095, 27.685570678035486, 37.310097650106364, 5.0117664845853716, 8.68551727892379, 5.761192655180692, 1.7066705185670805, 4.75334179928814, 12.76678807910118, 118.92754526420399, 27.96483830271561, 50.91014953470683, 72.66562214200204, 32.281749494437015, 13.646207416319521, 55.25182037073187, 15.724715963143199, 65.02205290333633, 24.692807406720455, 5.798492043606319, 10.018862072191187, 15.559422220536884, 5.723856324578121, 23.339364881667944, 18.524600201834364, 36.367724108761834, 52.11607664796258, 7.083916361049707, 6.556211949081651, 33.430688091533725, 40.76393015147448, 15.591038672505087, 9.95081220298989, 21.513412559814952, 222.45949206650883, 47.737944275453344, 12.796566999215354, 11.75911533442411, 25.425117411664566, 4.4595688543459095, 0.9252833931210558, 42.09425785380492, 36.542530870042604, 6.028148115820489, 186.07626568098098, 24.19906010334534, 14.714756564402306, 17.655712825612657, 11.776123742970666, 22.60076896301864, 22.763098498170603, 3.955104130121767, 56.37802568643016, 32.39830327052379, 34.379993727206, 3.5193573533828957, 3.316573770334783, 56.389612905622506, 45.92641199830981, 34.431427480818535, 31.979151171632076, 36.69308880558874, 91.78165666621469, 99.85050821953655, 13.486510931588267, 6.91024234863721, 26.767451093045036, 41.61927423092801, 14.930110443220332, 68.31357579684477, 32.65907305874091, 30.645684931089555, 23.88083764955971, 175.50911632070597, 75.9443556373005, 21.99419407412348, 8.7280322380658, 41.933933752113035, 42.382524390714536, 4.110248820881021, 10.97738992412716, 47.36514898128133, 24.48403010915193, 64.70858617550533, 0.1934790431130445, 45.50846698232129, 15.09703942046055, 51.73881706480008, 46.34257735119422, 37.125678173073666, 65.80533105120068, 51.09054581586843, 55.909827202169915, 47.10870514336876, 22.545474587736802, 49.10549840581586, 26.746054810113492, 111.3696836857413, 31.620178139230546, 27.317769085241228, 16.844824360179327, 33.393400982918514, 189.3279637588302, 14.772812406146933, 20.526617333165692, 14.391844138279504, 45.75674697519114, 52.88724991388714, 40.63449825529302, 191.69454429332, 5.781587993484684, 5.411202910900699, 4.2977047930324135, 23.262371527298153, 42.53411824746187, 141.95891544234271, 114.47875875610924, 14.100145388243627, 22.074967625977685]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.282051131301929, "mean_inference_ms": 5.9104866007600325, "mean_action_processing_ms": 0.9859993304939937, "mean_env_wait_ms": 0.7792102029310651, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01884615421295166, "StateBufferConnector_ms": 0.023979902267456055, "ViewRequirementAgentConnector_ms": 0.43727684020996094}, "num_episodes": 18, "episode_return_max": 313.5685336916874, "episode_return_min": -94.88611166974651, "episode_return_mean": 116.2854756975262, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1184000, "num_agent_steps_trained": 1184000, "num_env_steps_sampled": 296000, "num_env_steps_trained": 296000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 254.71031140056348, "num_env_steps_trained_throughput_per_sec": 254.71031140056348, "timesteps_total": 296000, "num_env_steps_sampled_lifetime": 296000, "num_agent_steps_sampled_lifetime": 1184000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1184000, "timers": {"training_iteration_time_ms": 16290.855, "restore_workers_time_ms": 0.014, "training_step_time_ms": 16290.814, "sample_time_ms": 4214.247, "learn_time_ms": 12061.104, "learn_throughput": 331.645, "synch_weights_time_ms": 14.573}, "counters": {"num_env_steps_sampled": 296000, "num_env_steps_trained": 296000, "num_agent_steps_sampled": 1184000, "num_agent_steps_trained": 1184000}, "done": false, "training_iteration": 74, "trial_id": "d163c_00000", "date": "2024-08-16_13-18-47", "timestamp": 1723794527, "time_this_iter_s": 15.70999002456665, "time_total_s": 1746.0325603485107, "pid": 81201, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16b8da8b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1746.0325603485107, "iterations_since_restore": 74, "perf": {"cpu_util_percent": 27.94090909090909, "ram_util_percent": 70.43636363636361}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.41168683754704, "cur_kl_coeff": 0.010546875, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.253644847112989, "policy_loss": -0.002615943318972039, "vf_loss": 6.256168241097183, "vf_explained_var": 0.03268457638523566, "kl": 0.008774386237925083, "entropy": 0.43019712436451485, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 140805.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.881161518797042, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.208363120770328, "policy_loss": -0.0031543188569475972, "vf_loss": 7.210988751164189, "vf_explained_var": 0.009733026305203715, "kl": 0.005286674387164966, "entropy": 0.882462513005292, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 140805.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_agent_steps_sampled": 1200000, "num_agent_steps_trained": 1200000}, "env_runners": {"episode_reward_max": 313.5685336916874, "episode_reward_min": -96.59684479415385, "episode_reward_mean": 122.88320889015709, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -475.0585499832443, "predator_policy": 0.16902161108050182}, "policy_reward_max": {"prey_policy": 165.96405084574997, "predator_policy": 507.97287645845284}, "policy_reward_mean": {"prey_policy": 18.09140213455063, "predator_policy": 43.35020231052795}, "custom_metrics": {}, "hist_stats": {"episode_reward": [79.41119934524306, 40.740894827701965, 176.834702068979, 45.395144235244196, 70.20845080379506, 96.58720018456548, 145.46027502420418, 5.57618149616052, 129.021638867839, 14.882064300291493, 112.46495989230351, 129.78202039285776, 130.31041308966527, 96.94852065908283, 31.12997996018511, 13.425250951831293, 100.47659828473404, 88.28471529543367, 92.52000000000037, 182.11781011978167, 3.839999999999962, 271.3214969098057, 53.707872758456936, 213.0150674159263, 101.71281625305872, 2.182318993030077, 151.74780222735848, 219.43580682867915, 66.8779905641727, 224.85281273424619, 78.74449141451102, 235.49705509147645, 257.9870006772617, 208.79006843886188, 233.31549294962244, 232.98990391745778, 275.3867613090291, 76.7191380464033, 70.40570255641843, -19.330871613056043, 204.48036869034715, 274.7174521505823, 3.6283224836427794, 231.21581365909836, 17.494221776670383, 270.3486130497748, 131.88000000000045, 241.02894493267615, 71.00328666336095, 186.95084828783865, 7.114024948321643, 73.59850193428414, 251.59674754698014, 17.616292138247957, 41.437289659621726, 243.2794934131448, 216.61762124095668, 35.25238414927241, 178.82056464652186, 57.44016891955915, 166.48796987143217, 69.84351910848673, 313.5685336916874, 245.40273792055459, 3.7534790431130074, 57.5362483467586, 96.97072192565871, 62.68538370662381, 215.75863083028915, 129.52843209928483, 83.17793076032187, -37.11530206597885, 300.0834820789443, 5.278073656808999, 264.0412231140647, 242.02299682627827, 48.88923279220452, -94.88611166974651, 272.12539993987946, 159.11885031204775, 78.99083808612471, 143.82189705753575, 228.14830070072205, 209.97564402932085, 235.0485682502616, 189.47234070618765, 186.87469775458356, 133.19543011401913, 33.867410085561595, -17.526724075792504, -96.59684479415385, 20.21797223746682, 52.04771720841386, 196.17515276807586, 68.70368281016157, 168.52618849893338, 195.2187623459078, 177.51094809136634, 14.198261220171101, -30.118493931396902], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [54.07258856513931, -9.987689799035739, 8.946288778749425, 25.878404758278073, 54.96300624245182, 83.77841542792865, 2.0000000000000013, 38.04609732524887, -10.903908441953156, 1.4013203192897978, 18.86506707410139, 5.752243111564875, 100.605904252093, 2.0000000000000013, -144.24230870413535, 0.8165906285457726, -7.658274692003523, 54.85475984985399, -3.467772283494984, -94.58461474451533, 30.8738274130149, 48.94961183515577, 59.94569456825956, 31.76359959461251, 49.64087972196127, 32.450856505116455, 14.957576088236582, 12.135171841578927, -25.955922477049892, 2.0000000000000013, -65.59102660116848, -36.175002859642056, 30.030488354369627, -89.34375631030807, 77.92772588124288, -5.4376413567435415, 89.34939488993622, -18.127508007583554, -13.547210159334687, 112.94918404439089, 1.653963843647777, -1.9027969235104831, 113.85810253800587, 133.2651344538031, 17.383095262898443, -0.5533729173731803, 87.3167255554912, 60.70267353229408, -2.988950231526986, 91.00448272107624, -2.3245838202499653, -2.960960360467806, 132.227672348969, 2.0000000000000013, -46.20245156436524, 118.74587482612506, -6.433481002072741, -50.2643001104632, 79.46237037745915, 99.46248544603158, -8.838092143938796, 16.606047224574688, 119.55614412113898, 26.226050660281082, 98.73519637496692, 143.43445018649777, 54.950989577226174, 132.5558003165205, 100.09128135982081, 91.36024650629919, 87.78740616992764, 56.71869699080579, 144.4379480460109, 117.30868495288752, -14.042987363991001, 16.567507167385727, -14.049631913662466, 58.91348359458607, -186.13707522322068, -77.16670101615907, 38.35521227881483, 105.59064513686418, 116.35566061332325, 121.17755879117084, 0.793039090521758, -2.5495688543459503, 68.75955081238547, 83.81947412286534, -176.61019202013094, 2.0000000000000013, 82.7155817719971, 148.7192146100306, 112.21786109979146, -9.769697668374766, 67.92529581423966, 127.73978165724773, 14.033211410426418, -3.363054563617374, 75.33153176103635, 44.84101952907275, 2.0000000000000013, -1.7219061753959881, -23.047319072174766, -5.670203897473321, 63.10128733166364, 122.084881562866, -89.9868566222454, -20.871596711309856, -42.01058056336315, -29.88914892814019, 100.24844894607918, 109.3533510253838, 125.2994161310363, 34.76882043577224, -14.629874034643045, -51.09039067167019, 105.5638861690313, 18.730155896841246, -193.3966866371198, -0.6166164013272992, 74.02097739219494, 61.7447661670483, -15.416644765600594, 0.943705731259645, 134.87756112773155, 163.60333381894802, 86.40072443736878, 87.15283439275275, -63.148586175505145, 2.0000000000000013, 36.75861691094452, -39.827874966967876, 23.210085511068563, -24.320758001404155, -42.02099387189839, 1.7753683542480088, 112.75057247061153, -3.9923146583600158, 4.973877349923161, 54.900375018256184, 22.007138413074294, -14.680760868682174, -82.35006276011698, -97.75510113083388, 165.96405084574997, 89.95683778777429, -1.0284633649265982, -216.4148277200133, 133.80091554125875, 94.94087783349367, 68.34636598643618, 113.52803972637145, -44.83154482719992, 0.1990294502245062, -151.05275718795346, -141.30948676859796, 113.91385154640389, 148.5026406895428, 67.17175984370384, 26.15060069358399, -179.0280059293388, 1.581169817011115, 117.28613860642253, -9.63935456310831, 68.31577534694686, 95.35602253141654, 81.65926522608514, 65.21018044043274, 51.07431171981331, 108.23088835925444, 80.42300380680031, 32.58805134456705, 51.492502767374695, 62.64678976814517, 19.817629295960803, 66.18856218707081, -92.56994638454225, -1.5118483881967666, -107.98600241570904, -206.21038916790135, -475.0585499832443, -155.43324462051223, -100.90333089653808, 2.0000000000000013, -52.024482708692176, -0.9083498120875184, 48.74078656053002, 75.53913293778545, 0.7272774814029984, -2.858372428965053, 64.68888571112474, 46.702720340054064, 55.21077623097395, 73.33070377107292, 90.42046384690286, -79.53408437650563, -308.0421461419989, -0.646167833649749, -90.91738994758245, -363.8240589353738], "policy_predator_policy_reward": [21.33550494758048, 13.990795631558937, 0.8900098175706196, 5.0261914731033785, 20.09663397553507, 17.99664642306358, 1.961184444167525, 3.3878624658280527, 11.718871898856339, 67.992167027602, 55.386472430139534, 16.58341756875924, 9.791120500573786, 33.063250271537456, 21.554920773928632, 127.44697879782102, 43.644863090986355, 38.180290619001916, 86.40277094019159, 26.531680388110267, 15.069810999310484, 17.57170964482204, 5.870534106853447, 32.20219212313223, 19.480083694723703, 28.738593167863584, 22.086744126900538, 47.76902860236641, 18.873771494237314, 36.21213094299786, 62.20060558065396, 52.99067483198794, 122.40129903508323, 37.38856720559005, 7.315535880017548, 8.479094890916585, 19.62750800758379, 1.6706051100639439, 19.555671089791026, 63.16016514493493, 0.16902161108050182, 3.9198114687821684, 12.573629211013934, 11.624630706983522, 4.804057401287866, 32.074093011644095, 27.685570678035486, 37.310097650106364, 5.0117664845853716, 8.68551727892379, 5.761192655180692, 1.7066705185670805, 4.75334179928814, 12.76678807910118, 118.92754526420399, 27.96483830271561, 50.91014953470683, 72.66562214200204, 32.281749494437015, 13.646207416319521, 55.25182037073187, 15.724715963143199, 65.02205290333633, 24.692807406720455, 5.798492043606319, 10.018862072191187, 15.559422220536884, 5.723856324578121, 23.339364881667944, 18.524600201834364, 36.367724108761834, 52.11607664796258, 7.083916361049707, 6.556211949081651, 33.430688091533725, 40.76393015147448, 15.591038672505087, 9.95081220298989, 21.513412559814952, 222.45949206650883, 47.737944275453344, 12.796566999215354, 11.75911533442411, 25.425117411664566, 4.4595688543459095, 0.9252833931210558, 42.09425785380492, 36.542530870042604, 6.028148115820489, 186.07626568098098, 24.19906010334534, 14.714756564402306, 17.655712825612657, 11.776123742970666, 22.60076896301864, 22.763098498170603, 3.955104130121767, 56.37802568643016, 32.39830327052379, 34.379993727206, 3.5193573533828957, 3.316573770334783, 56.389612905622506, 45.92641199830981, 34.431427480818535, 31.979151171632076, 36.69308880558874, 91.78165666621469, 99.85050821953655, 13.486510931588267, 6.91024234863721, 26.767451093045036, 41.61927423092801, 14.930110443220332, 68.31357579684477, 32.65907305874091, 30.645684931089555, 23.88083764955971, 175.50911632070597, 75.9443556373005, 21.99419407412348, 8.7280322380658, 41.933933752113035, 42.382524390714536, 4.110248820881021, 10.97738992412716, 47.36514898128133, 24.48403010915193, 64.70858617550533, 0.1934790431130445, 45.50846698232129, 15.09703942046055, 51.73881706480008, 46.34257735119422, 37.125678173073666, 65.80533105120068, 51.09054581586843, 55.909827202169915, 47.10870514336876, 22.545474587736802, 49.10549840581586, 26.746054810113492, 111.3696836857413, 31.620178139230546, 27.317769085241228, 16.844824360179327, 33.393400982918514, 189.3279637588302, 14.772812406146933, 20.526617333165692, 14.391844138279504, 45.75674697519114, 52.88724991388714, 40.63449825529302, 191.69454429332, 5.781587993484684, 5.411202910900699, 4.2977047930324135, 23.262371527298153, 42.53411824746187, 141.95891544234271, 114.47875875610924, 14.100145388243627, 22.074967625977685, 40.95672589597468, 23.519776926384054, 38.37574150932245, 24.73045685348095, 36.159254968407346, 39.58411320278633, 20.645646517333304, 55.81563903748767, 45.17819878740189, 27.557206431661992, 31.2223021697489, 15.966936461238388, 37.30494175356266, 90.64426310473792, 258.6706323961623, 37.99903511165527, 25.9220733511491, 507.97287645845284, 101.81818060099295, 17.303122533011837, 26.395361076045212, 78.58518865314866, 16.901913858895526, 54.99331941086481, 53.76497316371948, 17.069804594004275, 35.6109927173584, 21.52358973039638, 23.540194633014448, 43.137087710846764, 76.97924951716931, 89.64531910379989, 42.252584035771896, 280.6339911600478, 85.39899134709371, 339.2239636044657]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.2797638072186697, "mean_inference_ms": 5.9027309108384225, "mean_action_processing_ms": 0.9846505232015049, "mean_env_wait_ms": 0.777672922655014, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013142704963684082, "StateBufferConnector_ms": 0.009084820747375488, "ViewRequirementAgentConnector_ms": 0.4363621473312378}, "num_episodes": 18, "episode_return_max": 313.5685336916874, "episode_return_min": -96.59684479415385, "episode_return_mean": 122.88320889015709, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1200000, "num_agent_steps_trained": 1200000, "num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 255.982255136336, "num_env_steps_trained_throughput_per_sec": 255.982255136336, "timesteps_total": 300000, "num_env_steps_sampled_lifetime": 300000, "num_agent_steps_sampled_lifetime": 1200000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1200000, "timers": {"training_iteration_time_ms": 16127.161, "restore_workers_time_ms": 0.014, "training_step_time_ms": 16127.119, "sample_time_ms": 4186.003, "learn_time_ms": 11926.029, "learn_throughput": 335.401, "synch_weights_time_ms": 14.222}, "counters": {"num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_agent_steps_sampled": 1200000, "num_agent_steps_trained": 1200000}, "done": false, "training_iteration": 75, "trial_id": "d163c_00000", "date": "2024-08-16_13-19-02", "timestamp": 1723794542, "time_this_iter_s": 15.630669116973877, "time_total_s": 1761.6632294654846, "pid": 81201, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16b819f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1761.6632294654846, "iterations_since_restore": 75, "perf": {"cpu_util_percent": 27.831818181818186, "ram_util_percent": 69.77727272727275}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.735052118414925, "cur_kl_coeff": 0.010546875, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.467931760555853, "policy_loss": -0.0021969616280070373, "vf_loss": 8.470088132222493, "vf_explained_var": -0.014372562857531997, "kl": 0.003848808007649933, "entropy": 0.44507896176406314, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 142695.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.133419701788161, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.042578444657503, "policy_loss": -0.006845902184531999, "vf_loss": 6.048229926477664, "vf_explained_var": -0.026174441878757778, "kl": 0.011944169759453498, "entropy": 0.9159360557636886, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 142695.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 304000, "num_env_steps_trained": 304000, "num_agent_steps_sampled": 1216000, "num_agent_steps_trained": 1216000}, "env_runners": {"episode_reward_max": 313.5685336916874, "episode_reward_min": -96.59684479415385, "episode_reward_mean": 118.68902403781802, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -475.0585499832443, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 165.96405084574997, "predator_policy": 507.97287645845284}, "policy_reward_mean": {"prey_policy": 2.871718775817294, "predator_policy": 56.47279324309174}, "custom_metrics": {}, "hist_stats": {"episode_reward": [53.707872758456936, 213.0150674159263, 101.71281625305872, 2.182318993030077, 151.74780222735848, 219.43580682867915, 66.8779905641727, 224.85281273424619, 78.74449141451102, 235.49705509147645, 257.9870006772617, 208.79006843886188, 233.31549294962244, 232.98990391745778, 275.3867613090291, 76.7191380464033, 70.40570255641843, -19.330871613056043, 204.48036869034715, 274.7174521505823, 3.6283224836427794, 231.21581365909836, 17.494221776670383, 270.3486130497748, 131.88000000000045, 241.02894493267615, 71.00328666336095, 186.95084828783865, 7.114024948321643, 73.59850193428414, 251.59674754698014, 17.616292138247957, 41.437289659621726, 243.2794934131448, 216.61762124095668, 35.25238414927241, 178.82056464652186, 57.44016891955915, 166.48796987143217, 69.84351910848673, 313.5685336916874, 245.40273792055459, 3.7534790431130074, 57.5362483467586, 96.97072192565871, 62.68538370662381, 215.75863083028915, 129.52843209928483, 83.17793076032187, -37.11530206597885, 300.0834820789443, 5.278073656808999, 264.0412231140647, 242.02299682627827, 48.88923279220452, -94.88611166974651, 272.12539993987946, 159.11885031204775, 78.99083808612471, 143.82189705753575, 228.14830070072205, 209.97564402932085, 235.0485682502616, 189.47234070618765, 186.87469775458356, 133.19543011401913, 33.867410085561595, -17.526724075792504, -96.59684479415385, 20.21797223746682, 52.04771720841386, 196.17515276807586, 68.70368281016157, 168.52618849893338, 195.2187623459078, 177.51094809136634, 14.198261220171101, -30.118493931396902, 17.380074711168955, 69.03018519440617, 61.66950533311703, 170.23311185455475, 88.23564911632785, -22.208003005636932, 155.29932944685856, 131.0997304939871, 71.51571661918511, 132.9892211667428, 99.01648464973246, 35.00279217829014, 18.917748098583125, 82.39935215635798, 89.76865496916207, 81.7193944788868, 60.74322042100773, 2.801727566036069, 118.85772052928148, 82.66892720864033, 86.31048828911162, 3.8699999999999615], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [17.383095262898443, -0.5533729173731803, 87.3167255554912, 60.70267353229408, -2.988950231526986, 91.00448272107624, -2.3245838202499653, -2.960960360467806, 132.227672348969, 2.0000000000000013, -46.20245156436524, 118.74587482612506, -6.433481002072741, -50.2643001104632, 79.46237037745915, 99.46248544603158, -8.838092143938796, 16.606047224574688, 119.55614412113898, 26.226050660281082, 98.73519637496692, 143.43445018649777, 54.950989577226174, 132.5558003165205, 100.09128135982081, 91.36024650629919, 87.78740616992764, 56.71869699080579, 144.4379480460109, 117.30868495288752, -14.042987363991001, 16.567507167385727, -14.049631913662466, 58.91348359458607, -186.13707522322068, -77.16670101615907, 38.35521227881483, 105.59064513686418, 116.35566061332325, 121.17755879117084, 0.793039090521758, -2.5495688543459503, 68.75955081238547, 83.81947412286534, -176.61019202013094, 2.0000000000000013, 82.7155817719971, 148.7192146100306, 112.21786109979146, -9.769697668374766, 67.92529581423966, 127.73978165724773, 14.033211410426418, -3.363054563617374, 75.33153176103635, 44.84101952907275, 2.0000000000000013, -1.7219061753959881, -23.047319072174766, -5.670203897473321, 63.10128733166364, 122.084881562866, -89.9868566222454, -20.871596711309856, -42.01058056336315, -29.88914892814019, 100.24844894607918, 109.3533510253838, 125.2994161310363, 34.76882043577224, -14.629874034643045, -51.09039067167019, 105.5638861690313, 18.730155896841246, -193.3966866371198, -0.6166164013272992, 74.02097739219494, 61.7447661670483, -15.416644765600594, 0.943705731259645, 134.87756112773155, 163.60333381894802, 86.40072443736878, 87.15283439275275, -63.148586175505145, 2.0000000000000013, 36.75861691094452, -39.827874966967876, 23.210085511068563, -24.320758001404155, -42.02099387189839, 1.7753683542480088, 112.75057247061153, -3.9923146583600158, 4.973877349923161, 54.900375018256184, 22.007138413074294, -14.680760868682174, -82.35006276011698, -97.75510113083388, 165.96405084574997, 89.95683778777429, -1.0284633649265982, -216.4148277200133, 133.80091554125875, 94.94087783349367, 68.34636598643618, 113.52803972637145, -44.83154482719992, 0.1990294502245062, -151.05275718795346, -141.30948676859796, 113.91385154640389, 148.5026406895428, 67.17175984370384, 26.15060069358399, -179.0280059293388, 1.581169817011115, 117.28613860642253, -9.63935456310831, 68.31577534694686, 95.35602253141654, 81.65926522608514, 65.21018044043274, 51.07431171981331, 108.23088835925444, 80.42300380680031, 32.58805134456705, 51.492502767374695, 62.64678976814517, 19.817629295960803, 66.18856218707081, -92.56994638454225, -1.5118483881967666, -107.98600241570904, -206.21038916790135, -475.0585499832443, -155.43324462051223, -100.90333089653808, 2.0000000000000013, -52.024482708692176, -0.9083498120875184, 48.74078656053002, 75.53913293778545, 0.7272774814029984, -2.858372428965053, 64.68888571112474, 46.702720340054064, 55.21077623097395, 73.33070377107292, 90.42046384690286, -79.53408437650563, -308.0421461419989, -0.646167833649749, -90.91738994758245, -363.8240589353738, 1.6463314118358532, -205.62930336666628, -77.73098236469664, 2.0000000000000013, -164.25608897902424, -30.17498822260401, 62.82967126320533, 17.610435620074263, -112.36442611427469, -90.20611314448331, -124.1907597331806, -97.02217543819059, 60.61931563523135, -4.905391595030264, -209.03141466228664, -2.2804325883483054, -98.17359042083025, -51.016208087045214, 19.222788888225892, 38.55567994657916, -35.63244889239646, -37.82273118539492, -29.61072822797506, -219.7349005568835, 2.0000000000000013, -89.80951426920493, -349.23478585268805, -19.010128201253412, 2.0000000000000013, -36.37454806961015, -39.047657627112926, -40.50402920526707, -11.910299222596855, -99.25602905427867, 1.0109348304770225, -2.8883066949694136, -7.5307732340559905, 46.50761237577258, -76.24551213004229, 2.0000000000000013, -2.273654131893477, -170.4967763769752, 0.7137582618712458, 0.517962215417635], "policy_predator_policy_reward": [4.804057401287866, 32.074093011644095, 27.685570678035486, 37.310097650106364, 5.0117664845853716, 8.68551727892379, 5.761192655180692, 1.7066705185670805, 4.75334179928814, 12.76678807910118, 118.92754526420399, 27.96483830271561, 50.91014953470683, 72.66562214200204, 32.281749494437015, 13.646207416319521, 55.25182037073187, 15.724715963143199, 65.02205290333633, 24.692807406720455, 5.798492043606319, 10.018862072191187, 15.559422220536884, 5.723856324578121, 23.339364881667944, 18.524600201834364, 36.367724108761834, 52.11607664796258, 7.083916361049707, 6.556211949081651, 33.430688091533725, 40.76393015147448, 15.591038672505087, 9.95081220298989, 21.513412559814952, 222.45949206650883, 47.737944275453344, 12.796566999215354, 11.75911533442411, 25.425117411664566, 4.4595688543459095, 0.9252833931210558, 42.09425785380492, 36.542530870042604, 6.028148115820489, 186.07626568098098, 24.19906010334534, 14.714756564402306, 17.655712825612657, 11.776123742970666, 22.60076896301864, 22.763098498170603, 3.955104130121767, 56.37802568643016, 32.39830327052379, 34.379993727206, 3.5193573533828957, 3.316573770334783, 56.389612905622506, 45.92641199830981, 34.431427480818535, 31.979151171632076, 36.69308880558874, 91.78165666621469, 99.85050821953655, 13.486510931588267, 6.91024234863721, 26.767451093045036, 41.61927423092801, 14.930110443220332, 68.31357579684477, 32.65907305874091, 30.645684931089555, 23.88083764955971, 175.50911632070597, 75.9443556373005, 21.99419407412348, 8.7280322380658, 41.933933752113035, 42.382524390714536, 4.110248820881021, 10.97738992412716, 47.36514898128133, 24.48403010915193, 64.70858617550533, 0.1934790431130445, 45.50846698232129, 15.09703942046055, 51.73881706480008, 46.34257735119422, 37.125678173073666, 65.80533105120068, 51.09054581586843, 55.909827202169915, 47.10870514336876, 22.545474587736802, 49.10549840581586, 26.746054810113492, 111.3696836857413, 31.620178139230546, 27.317769085241228, 16.844824360179327, 33.393400982918514, 189.3279637588302, 14.772812406146933, 20.526617333165692, 14.391844138279504, 45.75674697519114, 52.88724991388714, 40.63449825529302, 191.69454429332, 5.781587993484684, 5.411202910900699, 4.2977047930324135, 23.262371527298153, 42.53411824746187, 141.95891544234271, 114.47875875610924, 14.100145388243627, 22.074967625977685, 40.95672589597468, 23.519776926384054, 38.37574150932245, 24.73045685348095, 36.159254968407346, 39.58411320278633, 20.645646517333304, 55.81563903748767, 45.17819878740189, 27.557206431661992, 31.2223021697489, 15.966936461238388, 37.30494175356266, 90.64426310473792, 258.6706323961623, 37.99903511165527, 25.9220733511491, 507.97287645845284, 101.81818060099295, 17.303122533011837, 26.395361076045212, 78.58518865314866, 16.901913858895526, 54.99331941086481, 53.76497316371948, 17.069804594004275, 35.6109927173584, 21.52358973039638, 23.540194633014448, 43.137087710846764, 76.97924951716931, 89.64531910379989, 42.252584035771896, 280.6339911600478, 85.39899134709371, 339.2239636044657, 175.06128461825276, 46.30176204774676, 98.05214436875579, 46.709023190347004, 177.7743449890517, 78.32623754569369, 40.23940742588985, 49.553597545385706, 181.70660007524125, 109.09958829984406, 88.76198115422521, 110.24295101150928, 50.164672368711884, 49.42073303794594, 191.07939941182556, 151.33217833279616, 94.983219842894, 125.7222952841665, 16.00041484387142, 59.210337488066095, 78.98004069264954, 93.49162403487391, 211.60856490234443, 72.73985606080429, 36.17438101994152, 70.55288134784657, 266.3508553089801, 184.2934109013192, 41.57071834158481, 82.57248469718682, 59.13899858582361, 102.13208272544328, 120.43567657209398, 51.47387212578957, 0.0, 4.679099430528441, 23.72698567694852, 56.1538957106154, 43.71736153084891, 113.19707780783341, 139.95401535283284, 119.12690344514738, 1.2262417381287556, 1.4120377845823664]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.2767343432221363, "mean_inference_ms": 5.8918435754773375, "mean_action_processing_ms": 0.9829935442077474, "mean_env_wait_ms": 0.7765709944151871, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01109302043914795, "StateBufferConnector_ms": 0.0076982975006103516, "ViewRequirementAgentConnector_ms": 0.42159056663513184}, "num_episodes": 22, "episode_return_max": 313.5685336916874, "episode_return_min": -96.59684479415385, "episode_return_mean": 118.68902403781802, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1216000, "num_agent_steps_trained": 1216000, "num_env_steps_sampled": 304000, "num_env_steps_trained": 304000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 229.44073634525867, "num_env_steps_trained_throughput_per_sec": 229.44073634525867, "timesteps_total": 304000, "num_env_steps_sampled_lifetime": 304000, "num_agent_steps_sampled_lifetime": 1216000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1216000, "timers": {"training_iteration_time_ms": 16332.572, "restore_workers_time_ms": 0.014, "training_step_time_ms": 16332.531, "sample_time_ms": 4175.928, "learn_time_ms": 12140.928, "learn_throughput": 329.464, "synch_weights_time_ms": 14.823}, "counters": {"num_env_steps_sampled": 304000, "num_env_steps_trained": 304000, "num_agent_steps_sampled": 1216000, "num_agent_steps_trained": 1216000}, "done": false, "training_iteration": 76, "trial_id": "d163c_00000", "date": "2024-08-16_13-19-20", "timestamp": 1723794560, "time_this_iter_s": 17.441184997558594, "time_total_s": 1779.1044144630432, "pid": 81201, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16ba08790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1779.1044144630432, "iterations_since_restore": 76, "perf": {"cpu_util_percent": 31.424, "ram_util_percent": 69.656}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.402537350869053, "cur_kl_coeff": 0.0052734375, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.702654112962188, "policy_loss": -0.004375366504038019, "vf_loss": 8.707005401137014, "vf_explained_var": -0.005227585318227293, "kl": 0.0045624485386325875, "entropy": 0.4569974778663544, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 144585.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.135409381370696, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.279999052532135, "policy_loss": -0.0076286423623699836, "vf_loss": 6.286518719335081, "vf_explained_var": 0.020444139948597662, "kl": 0.011089576925605303, "entropy": 0.9396623454712055, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 144585.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 308000, "num_env_steps_trained": 308000, "num_agent_steps_sampled": 1232000, "num_agent_steps_trained": 1232000}, "env_runners": {"episode_reward_max": 313.5685336916874, "episode_reward_min": -96.59684479415385, "episode_reward_mean": 102.97607126284453, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -475.0585499832443, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 165.96405084574997, "predator_policy": 507.97287645845284}, "policy_reward_mean": {"prey_policy": -18.547026807121128, "predator_policy": 70.03506243854343}, "custom_metrics": {}, "hist_stats": {"episode_reward": [204.48036869034715, 274.7174521505823, 3.6283224836427794, 231.21581365909836, 17.494221776670383, 270.3486130497748, 131.88000000000045, 241.02894493267615, 71.00328666336095, 186.95084828783865, 7.114024948321643, 73.59850193428414, 251.59674754698014, 17.616292138247957, 41.437289659621726, 243.2794934131448, 216.61762124095668, 35.25238414927241, 178.82056464652186, 57.44016891955915, 166.48796987143217, 69.84351910848673, 313.5685336916874, 245.40273792055459, 3.7534790431130074, 57.5362483467586, 96.97072192565871, 62.68538370662381, 215.75863083028915, 129.52843209928483, 83.17793076032187, -37.11530206597885, 300.0834820789443, 5.278073656808999, 264.0412231140647, 242.02299682627827, 48.88923279220452, -94.88611166974651, 272.12539993987946, 159.11885031204775, 78.99083808612471, 143.82189705753575, 228.14830070072205, 209.97564402932085, 235.0485682502616, 189.47234070618765, 186.87469775458356, 133.19543011401913, 33.867410085561595, -17.526724075792504, -96.59684479415385, 20.21797223746682, 52.04771720841386, 196.17515276807586, 68.70368281016157, 168.52618849893338, 195.2187623459078, 177.51094809136634, 14.198261220171101, -30.118493931396902, 17.380074711168955, 69.03018519440617, 61.66950533311703, 170.23311185455475, 88.23564911632785, -22.208003005636932, 155.29932944685856, 131.0997304939871, 71.51571661918511, 132.9892211667428, 99.01648464973246, 35.00279217829014, 18.917748098583125, 82.39935215635798, 89.76865496916207, 81.7193944788868, 60.74322042100773, 2.801727566036069, 118.85772052928148, 82.66892720864033, 86.31048828911162, 3.8699999999999615, 58.979480019615664, 5.968728930655861, 61.52006215229489, 99.05571898872866, -4.077338641874663, 36.097319567770676, 65.40346651651467, 35.01420097953608, 37.646268193002044, 61.02405176363056, 105.83083018012019, 4.8059209537961785, 71.609761513417, 117.4634339021263, 57.34663216549503, 123.59388789357773, 129.062688552988, 46.39683943417194], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [38.35521227881483, 105.59064513686418, 116.35566061332325, 121.17755879117084, 0.793039090521758, -2.5495688543459503, 68.75955081238547, 83.81947412286534, -176.61019202013094, 2.0000000000000013, 82.7155817719971, 148.7192146100306, 112.21786109979146, -9.769697668374766, 67.92529581423966, 127.73978165724773, 14.033211410426418, -3.363054563617374, 75.33153176103635, 44.84101952907275, 2.0000000000000013, -1.7219061753959881, -23.047319072174766, -5.670203897473321, 63.10128733166364, 122.084881562866, -89.9868566222454, -20.871596711309856, -42.01058056336315, -29.88914892814019, 100.24844894607918, 109.3533510253838, 125.2994161310363, 34.76882043577224, -14.629874034643045, -51.09039067167019, 105.5638861690313, 18.730155896841246, -193.3966866371198, -0.6166164013272992, 74.02097739219494, 61.7447661670483, -15.416644765600594, 0.943705731259645, 134.87756112773155, 163.60333381894802, 86.40072443736878, 87.15283439275275, -63.148586175505145, 2.0000000000000013, 36.75861691094452, -39.827874966967876, 23.210085511068563, -24.320758001404155, -42.02099387189839, 1.7753683542480088, 112.75057247061153, -3.9923146583600158, 4.973877349923161, 54.900375018256184, 22.007138413074294, -14.680760868682174, -82.35006276011698, -97.75510113083388, 165.96405084574997, 89.95683778777429, -1.0284633649265982, -216.4148277200133, 133.80091554125875, 94.94087783349367, 68.34636598643618, 113.52803972637145, -44.83154482719992, 0.1990294502245062, -151.05275718795346, -141.30948676859796, 113.91385154640389, 148.5026406895428, 67.17175984370384, 26.15060069358399, -179.0280059293388, 1.581169817011115, 117.28613860642253, -9.63935456310831, 68.31577534694686, 95.35602253141654, 81.65926522608514, 65.21018044043274, 51.07431171981331, 108.23088835925444, 80.42300380680031, 32.58805134456705, 51.492502767374695, 62.64678976814517, 19.817629295960803, 66.18856218707081, -92.56994638454225, -1.5118483881967666, -107.98600241570904, -206.21038916790135, -475.0585499832443, -155.43324462051223, -100.90333089653808, 2.0000000000000013, -52.024482708692176, -0.9083498120875184, 48.74078656053002, 75.53913293778545, 0.7272774814029984, -2.858372428965053, 64.68888571112474, 46.702720340054064, 55.21077623097395, 73.33070377107292, 90.42046384690286, -79.53408437650563, -308.0421461419989, -0.646167833649749, -90.91738994758245, -363.8240589353738, 1.6463314118358532, -205.62930336666628, -77.73098236469664, 2.0000000000000013, -164.25608897902424, -30.17498822260401, 62.82967126320533, 17.610435620074263, -112.36442611427469, -90.20611314448331, -124.1907597331806, -97.02217543819059, 60.61931563523135, -4.905391595030264, -209.03141466228664, -2.2804325883483054, -98.17359042083025, -51.016208087045214, 19.222788888225892, 38.55567994657916, -35.63244889239646, -37.82273118539492, -29.61072822797506, -219.7349005568835, 2.0000000000000013, -89.80951426920493, -349.23478585268805, -19.010128201253412, 2.0000000000000013, -36.37454806961015, -39.047657627112926, -40.50402920526707, -11.910299222596855, -99.25602905427867, 1.0109348304770225, -2.8883066949694136, -7.5307732340559905, 46.50761237577258, -76.24551213004229, 2.0000000000000013, -2.273654131893477, -170.4967763769752, 0.7137582618712458, 0.517962215417635, -24.766932732474032, -77.55753638225411, -340.8309367243196, -129.50281020211173, -209.42052473827107, -44.4758753836805, -79.87507253170399, -148.08101330123304, -100.84660953813211, -82.33861229109955, -227.86341483560446, 2.206968730335711, -9.550289071964013, -51.75976453578037, -32.570681014459964, -138.35002548197352, -71.0437335567456, -48.01417042125128, -48.207358501048226, -30.74977301204658, 0.4630047134889243, -174.84673177537314, 2.0000000000000013, -86.72492662917162, -24.703575616762176, -0.2939746439937785, -2.0863814708436395, -21.118274730576314, -13.970424568301729, -151.23740648789166, -66.94804737973082, 3.698112593791221, 2.0000000000000013, -249.3536594432109, -63.83551695045333, -1.6004230210537465], "policy_predator_policy_reward": [47.737944275453344, 12.796566999215354, 11.75911533442411, 25.425117411664566, 4.4595688543459095, 0.9252833931210558, 42.09425785380492, 36.542530870042604, 6.028148115820489, 186.07626568098098, 24.19906010334534, 14.714756564402306, 17.655712825612657, 11.776123742970666, 22.60076896301864, 22.763098498170603, 3.955104130121767, 56.37802568643016, 32.39830327052379, 34.379993727206, 3.5193573533828957, 3.316573770334783, 56.389612905622506, 45.92641199830981, 34.431427480818535, 31.979151171632076, 36.69308880558874, 91.78165666621469, 99.85050821953655, 13.486510931588267, 6.91024234863721, 26.767451093045036, 41.61927423092801, 14.930110443220332, 68.31357579684477, 32.65907305874091, 30.645684931089555, 23.88083764955971, 175.50911632070597, 75.9443556373005, 21.99419407412348, 8.7280322380658, 41.933933752113035, 42.382524390714536, 4.110248820881021, 10.97738992412716, 47.36514898128133, 24.48403010915193, 64.70858617550533, 0.1934790431130445, 45.50846698232129, 15.09703942046055, 51.73881706480008, 46.34257735119422, 37.125678173073666, 65.80533105120068, 51.09054581586843, 55.909827202169915, 47.10870514336876, 22.545474587736802, 49.10549840581586, 26.746054810113492, 111.3696836857413, 31.620178139230546, 27.317769085241228, 16.844824360179327, 33.393400982918514, 189.3279637588302, 14.772812406146933, 20.526617333165692, 14.391844138279504, 45.75674697519114, 52.88724991388714, 40.63449825529302, 191.69454429332, 5.781587993484684, 5.411202910900699, 4.2977047930324135, 23.262371527298153, 42.53411824746187, 141.95891544234271, 114.47875875610924, 14.100145388243627, 22.074967625977685, 40.95672589597468, 23.519776926384054, 38.37574150932245, 24.73045685348095, 36.159254968407346, 39.58411320278633, 20.645646517333304, 55.81563903748767, 45.17819878740189, 27.557206431661992, 31.2223021697489, 15.966936461238388, 37.30494175356266, 90.64426310473792, 258.6706323961623, 37.99903511165527, 25.9220733511491, 507.97287645845284, 101.81818060099295, 17.303122533011837, 26.395361076045212, 78.58518865314866, 16.901913858895526, 54.99331941086481, 53.76497316371948, 17.069804594004275, 35.6109927173584, 21.52358973039638, 23.540194633014448, 43.137087710846764, 76.97924951716931, 89.64531910379989, 42.252584035771896, 280.6339911600478, 85.39899134709371, 339.2239636044657, 175.06128461825276, 46.30176204774676, 98.05214436875579, 46.709023190347004, 177.7743449890517, 78.32623754569369, 40.23940742588985, 49.553597545385706, 181.70660007524125, 109.09958829984406, 88.76198115422521, 110.24295101150928, 50.164672368711884, 49.42073303794594, 191.07939941182556, 151.33217833279616, 94.983219842894, 125.7222952841665, 16.00041484387142, 59.210337488066095, 78.98004069264954, 93.49162403487391, 211.60856490234443, 72.73985606080429, 36.17438101994152, 70.55288134784657, 266.3508553089801, 184.2934109013192, 41.57071834158481, 82.57248469718682, 59.13899858582361, 102.13208272544328, 120.43567657209398, 51.47387212578957, 0.0, 4.679099430528441, 23.72698567694852, 56.1538957106154, 43.71736153084891, 113.19707780783341, 139.95401535283284, 119.12690344514738, 1.2262417381287556, 1.4120377845823664, 91.10912370959818, 70.19482542474562, 200.02174450488369, 276.28073135220336, 178.56838265314738, 136.84807962109892, 107.12646835346644, 219.88533646819948, 149.21072033365792, 29.89716285369941, 234.99200948074653, 26.761756192292836, 88.08830088494095, 38.62521923931822, 120.94054773667993, 84.99435973928941, 110.58919156504167, 46.11498060595721, 63.34274718300638, 76.63843609371914, 136.26076061660845, 143.95379662539577, 87.51492662917202, 2.0159209537962215, 32.771401297775704, 63.835910476397245, 81.43721037165312, 59.23087973189263, 155.46945750394892, 67.08500571773939, 92.01078366942738, 94.83303901008969, 171.1918071353815, 205.22454086081729, 16.470267130990077, 95.36251227468927]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.2760567750003107, "mean_inference_ms": 5.891097595593849, "mean_action_processing_ms": 0.9818644581138636, "mean_env_wait_ms": 0.7754698318669263, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009224295616149902, "StateBufferConnector_ms": 0.011664867401123047, "ViewRequirementAgentConnector_ms": 0.43014395236968994}, "num_episodes": 18, "episode_return_max": 313.5685336916874, "episode_return_min": -96.59684479415385, "episode_return_mean": 102.97607126284453, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1232000, "num_agent_steps_trained": 1232000, "num_env_steps_sampled": 308000, "num_env_steps_trained": 308000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 229.24287302211224, "num_env_steps_trained_throughput_per_sec": 229.24287302211224, "timesteps_total": 308000, "num_env_steps_sampled_lifetime": 308000, "num_agent_steps_sampled_lifetime": 1232000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1232000, "timers": {"training_iteration_time_ms": 16485.106, "restore_workers_time_ms": 0.015, "training_step_time_ms": 16485.062, "sample_time_ms": 4361.962, "learn_time_ms": 12107.374, "learn_throughput": 330.377, "synch_weights_time_ms": 14.864}, "counters": {"num_env_steps_sampled": 308000, "num_env_steps_trained": 308000, "num_agent_steps_sampled": 1232000, "num_agent_steps_trained": 1232000}, "done": false, "training_iteration": 77, "trial_id": "d163c_00000", "date": "2024-08-16_13-19-37", "timestamp": 1723794577, "time_this_iter_s": 17.452395915985107, "time_total_s": 1796.5568103790283, "pid": 81201, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16b8da8b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1796.5568103790283, "iterations_since_restore": 77, "perf": {"cpu_util_percent": 32.46, "ram_util_percent": 70.224}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.818733229460539, "cur_kl_coeff": 0.00263671875, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.759502302654206, "policy_loss": -0.003299545628516368, "vf_loss": 5.762781391446553, "vf_explained_var": 0.0850561674940523, "kl": 0.0077530867469023474, "entropy": 0.4492282472117237, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 146475.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.4726422851363186, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.6161572031873876, "policy_loss": -0.00636708005220585, "vf_loss": 3.621376904230269, "vf_explained_var": 0.0722990059663379, "kl": 0.011473808215211692, "entropy": 1.0143958226713554, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 146475.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_agent_steps_sampled": 1248000, "num_agent_steps_trained": 1248000}, "env_runners": {"episode_reward_max": 300.0834820789443, "episode_reward_min": -96.59684479415385, "episode_reward_mean": 80.98123747258433, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -475.0585499832443, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 165.96405084574997, "predator_policy": 507.97287645845284}, "policy_reward_mean": {"prey_policy": -35.46710345868531, "predator_policy": 75.95772219497746}, "custom_metrics": {}, "hist_stats": {"episode_reward": [245.40273792055459, 3.7534790431130074, 57.5362483467586, 96.97072192565871, 62.68538370662381, 215.75863083028915, 129.52843209928483, 83.17793076032187, -37.11530206597885, 300.0834820789443, 5.278073656808999, 264.0412231140647, 242.02299682627827, 48.88923279220452, -94.88611166974651, 272.12539993987946, 159.11885031204775, 78.99083808612471, 143.82189705753575, 228.14830070072205, 209.97564402932085, 235.0485682502616, 189.47234070618765, 186.87469775458356, 133.19543011401913, 33.867410085561595, -17.526724075792504, -96.59684479415385, 20.21797223746682, 52.04771720841386, 196.17515276807586, 68.70368281016157, 168.52618849893338, 195.2187623459078, 177.51094809136634, 14.198261220171101, -30.118493931396902, 17.380074711168955, 69.03018519440617, 61.66950533311703, 170.23311185455475, 88.23564911632785, -22.208003005636932, 155.29932944685856, 131.0997304939871, 71.51571661918511, 132.9892211667428, 99.01648464973246, 35.00279217829014, 18.917748098583125, 82.39935215635798, 89.76865496916207, 81.7193944788868, 60.74322042100773, 2.801727566036069, 118.85772052928148, 82.66892720864033, 86.31048828911162, 3.8699999999999615, 58.979480019615664, 5.968728930655861, 61.52006215229489, 99.05571898872866, -4.077338641874663, 36.097319567770676, 65.40346651651467, 35.01420097953608, 37.646268193002044, 61.02405176363056, 105.83083018012019, 4.8059209537961785, 71.609761513417, 117.4634339021263, 57.34663216549503, 123.59388789357773, 129.062688552988, 46.39683943417194, 75.22323990249669, 9.92722938402482, 55.03173530514732, 7.9799999999999365, 102.59566867715749, 15.694534525629097, 17.031607349765107, 2.237661703909404, 108.97942551378796, 8.859682074773497, 3.6282070529390547, 49.700196469229375, 7.641893989137456, -0.43254012646141793, 250.86400695036463, 145.6344248090085, -4.61252583849537, 5.543371087256102, 30.26309778710906, -18.96272532862012, 58.01140509110112, 147.01603213713676, 28.08197542008886], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [86.40072443736878, 87.15283439275275, -63.148586175505145, 2.0000000000000013, 36.75861691094452, -39.827874966967876, 23.210085511068563, -24.320758001404155, -42.02099387189839, 1.7753683542480088, 112.75057247061153, -3.9923146583600158, 4.973877349923161, 54.900375018256184, 22.007138413074294, -14.680760868682174, -82.35006276011698, -97.75510113083388, 165.96405084574997, 89.95683778777429, -1.0284633649265982, -216.4148277200133, 133.80091554125875, 94.94087783349367, 68.34636598643618, 113.52803972637145, -44.83154482719992, 0.1990294502245062, -151.05275718795346, -141.30948676859796, 113.91385154640389, 148.5026406895428, 67.17175984370384, 26.15060069358399, -179.0280059293388, 1.581169817011115, 117.28613860642253, -9.63935456310831, 68.31577534694686, 95.35602253141654, 81.65926522608514, 65.21018044043274, 51.07431171981331, 108.23088835925444, 80.42300380680031, 32.58805134456705, 51.492502767374695, 62.64678976814517, 19.817629295960803, 66.18856218707081, -92.56994638454225, -1.5118483881967666, -107.98600241570904, -206.21038916790135, -475.0585499832443, -155.43324462051223, -100.90333089653808, 2.0000000000000013, -52.024482708692176, -0.9083498120875184, 48.74078656053002, 75.53913293778545, 0.7272774814029984, -2.858372428965053, 64.68888571112474, 46.702720340054064, 55.21077623097395, 73.33070377107292, 90.42046384690286, -79.53408437650563, -308.0421461419989, -0.646167833649749, -90.91738994758245, -363.8240589353738, 1.6463314118358532, -205.62930336666628, -77.73098236469664, 2.0000000000000013, -164.25608897902424, -30.17498822260401, 62.82967126320533, 17.610435620074263, -112.36442611427469, -90.20611314448331, -124.1907597331806, -97.02217543819059, 60.61931563523135, -4.905391595030264, -209.03141466228664, -2.2804325883483054, -98.17359042083025, -51.016208087045214, 19.222788888225892, 38.55567994657916, -35.63244889239646, -37.82273118539492, -29.61072822797506, -219.7349005568835, 2.0000000000000013, -89.80951426920493, -349.23478585268805, -19.010128201253412, 2.0000000000000013, -36.37454806961015, -39.047657627112926, -40.50402920526707, -11.910299222596855, -99.25602905427867, 1.0109348304770225, -2.8883066949694136, -7.5307732340559905, 46.50761237577258, -76.24551213004229, 2.0000000000000013, -2.273654131893477, -170.4967763769752, 0.7137582618712458, 0.517962215417635, -24.766932732474032, -77.55753638225411, -340.8309367243196, -129.50281020211173, -209.42052473827107, -44.4758753836805, -79.87507253170399, -148.08101330123304, -100.84660953813211, -82.33861229109955, -227.86341483560446, 2.206968730335711, -9.550289071964013, -51.75976453578037, -32.570681014459964, -138.35002548197352, -71.0437335567456, -48.01417042125128, -48.207358501048226, -30.74977301204658, 0.4630047134889243, -174.84673177537314, 2.0000000000000013, -86.72492662917162, -24.703575616762176, -0.2939746439937785, -2.0863814708436395, -21.118274730576314, -13.970424568301729, -151.23740648789166, -66.94804737973082, 3.698112593791221, 2.0000000000000013, -249.3536594432109, -63.83551695045333, -1.6004230210537465, 2.0000000000000013, -39.29791685645073, -64.97217010245082, -1.7940645843397902, -79.64884664045636, -41.95960603720088, -11.541273530934202, -19.31520387235275, -8.430499735213342, -127.17115118604113, -5.323535345818352, -13.053730084468684, -39.31221675921031, 2.0000000000000013, -35.37241139471048, -7.497237095476189, -174.54511733346126, -3.124822491551371, -36.32516821923577, -53.48612007463261, -44.48254907364615, -22.746458309266057, -53.800236865750406, -110.78421787616527, -5.65075937771037, 2.0000000000000013, -8.36471853879489, -4.494559919220688, 2.0000000000000013, -470.7354795657801, 139.9695360639454, -3.6085579802556698, -81.01557637562206, -21.185745598550575, -34.35190192987997, 1.4932527584462287, -33.03855631867134, -11.835653576737997, -50.81614641736001, -43.91180109647456, -0.7570075063043566, -129.89659357985192, -2.3916315369792684, 139.51784834831744, -4.677637230432293, -126.20419481737504], "policy_predator_policy_reward": [47.36514898128133, 24.48403010915193, 64.70858617550533, 0.1934790431130445, 45.50846698232129, 15.09703942046055, 51.73881706480008, 46.34257735119422, 37.125678173073666, 65.80533105120068, 51.09054581586843, 55.909827202169915, 47.10870514336876, 22.545474587736802, 49.10549840581586, 26.746054810113492, 111.3696836857413, 31.620178139230546, 27.317769085241228, 16.844824360179327, 33.393400982918514, 189.3279637588302, 14.772812406146933, 20.526617333165692, 14.391844138279504, 45.75674697519114, 52.88724991388714, 40.63449825529302, 191.69454429332, 5.781587993484684, 5.411202910900699, 4.2977047930324135, 23.262371527298153, 42.53411824746187, 141.95891544234271, 114.47875875610924, 14.100145388243627, 22.074967625977685, 40.95672589597468, 23.519776926384054, 38.37574150932245, 24.73045685348095, 36.159254968407346, 39.58411320278633, 20.645646517333304, 55.81563903748767, 45.17819878740189, 27.557206431661992, 31.2223021697489, 15.966936461238388, 37.30494175356266, 90.64426310473792, 258.6706323961623, 37.99903511165527, 25.9220733511491, 507.97287645845284, 101.81818060099295, 17.303122533011837, 26.395361076045212, 78.58518865314866, 16.901913858895526, 54.99331941086481, 53.76497316371948, 17.069804594004275, 35.6109927173584, 21.52358973039638, 23.540194633014448, 43.137087710846764, 76.97924951716931, 89.64531910379989, 42.252584035771896, 280.6339911600478, 85.39899134709371, 339.2239636044657, 175.06128461825276, 46.30176204774676, 98.05214436875579, 46.709023190347004, 177.7743449890517, 78.32623754569369, 40.23940742588985, 49.553597545385706, 181.70660007524125, 109.09958829984406, 88.76198115422521, 110.24295101150928, 50.164672368711884, 49.42073303794594, 191.07939941182556, 151.33217833279616, 94.983219842894, 125.7222952841665, 16.00041484387142, 59.210337488066095, 78.98004069264954, 93.49162403487391, 211.60856490234443, 72.73985606080429, 36.17438101994152, 70.55288134784657, 266.3508553089801, 184.2934109013192, 41.57071834158481, 82.57248469718682, 59.13899858582361, 102.13208272544328, 120.43567657209398, 51.47387212578957, 0.0, 4.679099430528441, 23.72698567694852, 56.1538957106154, 43.71736153084891, 113.19707780783341, 139.95401535283284, 119.12690344514738, 1.2262417381287556, 1.4120377845823664, 91.10912370959818, 70.19482542474562, 200.02174450488369, 276.28073135220336, 178.56838265314738, 136.84807962109892, 107.12646835346644, 219.88533646819948, 149.21072033365792, 29.89716285369941, 234.99200948074653, 26.761756192292836, 88.08830088494095, 38.62521923931822, 120.94054773667993, 84.99435973928941, 110.58919156504167, 46.11498060595721, 63.34274718300638, 76.63843609371914, 136.26076061660845, 143.95379662539577, 87.51492662917202, 2.0159209537962215, 32.771401297775704, 63.835910476397245, 81.43721037165312, 59.23087973189263, 155.46945750394892, 67.08500571773939, 92.01078366942738, 94.83303901008969, 171.1918071353815, 205.22454086081729, 16.470267130990077, 95.36251227468927, 59.30557047871682, 53.2155862802308, 72.53217010245105, 4.161293968364625, 71.18819900399072, 105.45198897881387, 32.307138138575134, 6.5293392647120685, 127.01373308420872, 111.18358651420257, 28.20740384295945, 5.86439611295667, 32.707195235705115, 21.636628873269974, 4.486832053827553, 40.620478140268105, 111.92535922058114, 174.72400611821925, 56.738947951809145, 41.932022416832325, 39.55465401883779, 31.302560417013506, 83.24764673373947, 131.0370044774057, 3.8416254754359693, 7.451027891411897, 10.67334882534002, 1.7533895062141065, 299.71058281163147, 419.8889037045144, 6.009021916310405, 3.264424809008044, 16.42713137676544, 81.16166475891234, 22.879814041564558, 15.522206217125127, 30.486331690309882, 44.65097599220788, 68.18207507742675, 7.5831471077878625, 110.97183032636153, 77.69317585089615, 1.796032137136806, 8.09378318866181, 92.13988859727955, 66.82391887061664]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.275058381816878, "mean_inference_ms": 5.888340823422708, "mean_action_processing_ms": 0.9806758060650108, "mean_env_wait_ms": 0.7745796789560093, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009197115898132324, "StateBufferConnector_ms": 0.011614799499511719, "ViewRequirementAgentConnector_ms": 0.4066145420074463}, "num_episodes": 23, "episode_return_max": 300.0834820789443, "episode_return_min": -96.59684479415385, "episode_return_mean": 80.98123747258433, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1248000, "num_agent_steps_trained": 1248000, "num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 265.2729944468738, "num_env_steps_trained_throughput_per_sec": 265.2729944468738, "timesteps_total": 312000, "num_env_steps_sampled_lifetime": 312000, "num_agent_steps_sampled_lifetime": 1248000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1248000, "timers": {"training_iteration_time_ms": 16428.141, "restore_workers_time_ms": 0.015, "training_step_time_ms": 16428.099, "sample_time_ms": 4351.046, "learn_time_ms": 12061.195, "learn_throughput": 331.642, "synch_weights_time_ms": 14.989}, "counters": {"num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_agent_steps_sampled": 1248000, "num_agent_steps_trained": 1248000}, "done": false, "training_iteration": 78, "trial_id": "d163c_00000", "date": "2024-08-16_13-19-52", "timestamp": 1723794592, "time_this_iter_s": 15.084415912628174, "time_total_s": 1811.6412262916565, "pid": 81201, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16b80ef70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1811.6412262916565, "iterations_since_restore": 78, "perf": {"cpu_util_percent": 28.199999999999996, "ram_util_percent": 70.07142857142856}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.527076292984069, "cur_kl_coeff": 0.00263671875, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.136370902969723, "policy_loss": -0.002936449307559068, "vf_loss": 4.1392909944372835, "vf_explained_var": 0.12661889633804402, "kl": 0.006203498771727733, "entropy": 0.3886715551848134, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 148365.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.591430318607855, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.480284384571055, "policy_loss": -0.006876815623657965, "vf_loss": 2.485999214964569, "vf_explained_var": 0.15037373089916492, "kl": 0.011619830150051145, "entropy": 1.0628489970530153, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 148365.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 316000, "num_env_steps_trained": 316000, "num_agent_steps_sampled": 1264000, "num_agent_steps_trained": 1264000}, "env_runners": {"episode_reward_max": 250.86400695036463, "episode_reward_min": -96.59684479415385, "episode_reward_mean": 64.7937149658178, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -475.0585499832443, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 139.9695360639454, "predator_policy": 507.97287645845284}, "policy_reward_mean": {"prey_policy": -41.66854454455559, "predator_policy": 74.06540202746449}, "custom_metrics": {}, "hist_stats": {"episode_reward": [143.82189705753575, 228.14830070072205, 209.97564402932085, 235.0485682502616, 189.47234070618765, 186.87469775458356, 133.19543011401913, 33.867410085561595, -17.526724075792504, -96.59684479415385, 20.21797223746682, 52.04771720841386, 196.17515276807586, 68.70368281016157, 168.52618849893338, 195.2187623459078, 177.51094809136634, 14.198261220171101, -30.118493931396902, 17.380074711168955, 69.03018519440617, 61.66950533311703, 170.23311185455475, 88.23564911632785, -22.208003005636932, 155.29932944685856, 131.0997304939871, 71.51571661918511, 132.9892211667428, 99.01648464973246, 35.00279217829014, 18.917748098583125, 82.39935215635798, 89.76865496916207, 81.7193944788868, 60.74322042100773, 2.801727566036069, 118.85772052928148, 82.66892720864033, 86.31048828911162, 3.8699999999999615, 58.979480019615664, 5.968728930655861, 61.52006215229489, 99.05571898872866, -4.077338641874663, 36.097319567770676, 65.40346651651467, 35.01420097953608, 37.646268193002044, 61.02405176363056, 105.83083018012019, 4.8059209537961785, 71.609761513417, 117.4634339021263, 57.34663216549503, 123.59388789357773, 129.062688552988, 46.39683943417194, 75.22323990249669, 9.92722938402482, 55.03173530514732, 7.9799999999999365, 102.59566867715749, 15.694534525629097, 17.031607349765107, 2.237661703909404, 108.97942551378796, 8.859682074773497, 3.6282070529390547, 49.700196469229375, 7.641893989137456, -0.43254012646141793, 250.86400695036463, 145.6344248090085, -4.61252583849537, 5.543371087256102, 30.26309778710906, -18.96272532862012, 58.01140509110112, 147.01603213713676, 28.08197542008886, 24.45282718255738, 5.83657826982544, 59.75323190282972, 14.352736616820813, 11.011951849962172, 14.577020102800972, 51.37156493734259, 78.45087601553564, -6.653400383893775, 35.15282499344263, 56.79687479218705, 4.034333516640591, 28.286440686795157, 18.38231267168854, 8.956392516954239, 41.43999999999991, 9.886966043596939, 58.520465311495656], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [117.28613860642253, -9.63935456310831, 68.31577534694686, 95.35602253141654, 81.65926522608514, 65.21018044043274, 51.07431171981331, 108.23088835925444, 80.42300380680031, 32.58805134456705, 51.492502767374695, 62.64678976814517, 19.817629295960803, 66.18856218707081, -92.56994638454225, -1.5118483881967666, -107.98600241570904, -206.21038916790135, -475.0585499832443, -155.43324462051223, -100.90333089653808, 2.0000000000000013, -52.024482708692176, -0.9083498120875184, 48.74078656053002, 75.53913293778545, 0.7272774814029984, -2.858372428965053, 64.68888571112474, 46.702720340054064, 55.21077623097395, 73.33070377107292, 90.42046384690286, -79.53408437650563, -308.0421461419989, -0.646167833649749, -90.91738994758245, -363.8240589353738, 1.6463314118358532, -205.62930336666628, -77.73098236469664, 2.0000000000000013, -164.25608897902424, -30.17498822260401, 62.82967126320533, 17.610435620074263, -112.36442611427469, -90.20611314448331, -124.1907597331806, -97.02217543819059, 60.61931563523135, -4.905391595030264, -209.03141466228664, -2.2804325883483054, -98.17359042083025, -51.016208087045214, 19.222788888225892, 38.55567994657916, -35.63244889239646, -37.82273118539492, -29.61072822797506, -219.7349005568835, 2.0000000000000013, -89.80951426920493, -349.23478585268805, -19.010128201253412, 2.0000000000000013, -36.37454806961015, -39.047657627112926, -40.50402920526707, -11.910299222596855, -99.25602905427867, 1.0109348304770225, -2.8883066949694136, -7.5307732340559905, 46.50761237577258, -76.24551213004229, 2.0000000000000013, -2.273654131893477, -170.4967763769752, 0.7137582618712458, 0.517962215417635, -24.766932732474032, -77.55753638225411, -340.8309367243196, -129.50281020211173, -209.42052473827107, -44.4758753836805, -79.87507253170399, -148.08101330123304, -100.84660953813211, -82.33861229109955, -227.86341483560446, 2.206968730335711, -9.550289071964013, -51.75976453578037, -32.570681014459964, -138.35002548197352, -71.0437335567456, -48.01417042125128, -48.207358501048226, -30.74977301204658, 0.4630047134889243, -174.84673177537314, 2.0000000000000013, -86.72492662917162, -24.703575616762176, -0.2939746439937785, -2.0863814708436395, -21.118274730576314, -13.970424568301729, -151.23740648789166, -66.94804737973082, 3.698112593791221, 2.0000000000000013, -249.3536594432109, -63.83551695045333, -1.6004230210537465, 2.0000000000000013, -39.29791685645073, -64.97217010245082, -1.7940645843397902, -79.64884664045636, -41.95960603720088, -11.541273530934202, -19.31520387235275, -8.430499735213342, -127.17115118604113, -5.323535345818352, -13.053730084468684, -39.31221675921031, 2.0000000000000013, -35.37241139471048, -7.497237095476189, -174.54511733346126, -3.124822491551371, -36.32516821923577, -53.48612007463261, -44.48254907364615, -22.746458309266057, -53.800236865750406, -110.78421787616527, -5.65075937771037, 2.0000000000000013, -8.36471853879489, -4.494559919220688, 2.0000000000000013, -470.7354795657801, 139.9695360639454, -3.6085579802556698, -81.01557637562206, -21.185745598550575, -34.35190192987997, 1.4932527584462287, -33.03855631867134, -11.835653576737997, -50.81614641736001, -43.91180109647456, -0.7570075063043566, -129.89659357985192, -2.3916315369792684, 139.51784834831744, -4.677637230432293, -126.20419481737504, -29.04716743069844, -15.78467514932845, -34.785359217859586, -42.76696331014283, 13.243172287173088, -45.436003019387464, -12.090731492813504, -31.809876571501306, 2.0000000000000013, -13.472548760474494, -16.613483794235353, 1.8312671281158635, 1.6495802328169216, -121.11553025092113, -28.41037042330886, -166.04093147675673, -46.76367009971623, -28.138641484733466, 1.5155829603361906, -3.0408891211035263, -29.19059989703716, -40.33179241581474, 2.0000000000000013, -1.7336290974987343, -5.078844277622766, -8.799597419622375, -69.50842159861685, 2.0000000000000013, -37.003924474394104, -39.62317153392733, 9.459404804167747, -2.6390907025524646, 2.0000000000000013, -48.45608679754611, -1.888808790365133, -2.1922215906822644], "policy_predator_policy_reward": [14.100145388243627, 22.074967625977685, 40.95672589597468, 23.519776926384054, 38.37574150932245, 24.73045685348095, 36.159254968407346, 39.58411320278633, 20.645646517333304, 55.81563903748767, 45.17819878740189, 27.557206431661992, 31.2223021697489, 15.966936461238388, 37.30494175356266, 90.64426310473792, 258.6706323961623, 37.99903511165527, 25.9220733511491, 507.97287645845284, 101.81818060099295, 17.303122533011837, 26.395361076045212, 78.58518865314866, 16.901913858895526, 54.99331941086481, 53.76497316371948, 17.069804594004275, 35.6109927173584, 21.52358973039638, 23.540194633014448, 43.137087710846764, 76.97924951716931, 89.64531910379989, 42.252584035771896, 280.6339911600478, 85.39899134709371, 339.2239636044657, 175.06128461825276, 46.30176204774676, 98.05214436875579, 46.709023190347004, 177.7743449890517, 78.32623754569369, 40.23940742588985, 49.553597545385706, 181.70660007524125, 109.09958829984406, 88.76198115422521, 110.24295101150928, 50.164672368711884, 49.42073303794594, 191.07939941182556, 151.33217833279616, 94.983219842894, 125.7222952841665, 16.00041484387142, 59.210337488066095, 78.98004069264954, 93.49162403487391, 211.60856490234443, 72.73985606080429, 36.17438101994152, 70.55288134784657, 266.3508553089801, 184.2934109013192, 41.57071834158481, 82.57248469718682, 59.13899858582361, 102.13208272544328, 120.43567657209398, 51.47387212578957, 0.0, 4.679099430528441, 23.72698567694852, 56.1538957106154, 43.71736153084891, 113.19707780783341, 139.95401535283284, 119.12690344514738, 1.2262417381287556, 1.4120377845823664, 91.10912370959818, 70.19482542474562, 200.02174450488369, 276.28073135220336, 178.56838265314738, 136.84807962109892, 107.12646835346644, 219.88533646819948, 149.21072033365792, 29.89716285369941, 234.99200948074653, 26.761756192292836, 88.08830088494095, 38.62521923931822, 120.94054773667993, 84.99435973928941, 110.58919156504167, 46.11498060595721, 63.34274718300638, 76.63843609371914, 136.26076061660845, 143.95379662539577, 87.51492662917202, 2.0159209537962215, 32.771401297775704, 63.835910476397245, 81.43721037165312, 59.23087973189263, 155.46945750394892, 67.08500571773939, 92.01078366942738, 94.83303901008969, 171.1918071353815, 205.22454086081729, 16.470267130990077, 95.36251227468927, 59.30557047871682, 53.2155862802308, 72.53217010245105, 4.161293968364625, 71.18819900399072, 105.45198897881387, 32.307138138575134, 6.5293392647120685, 127.01373308420872, 111.18358651420257, 28.20740384295945, 5.86439611295667, 32.707195235705115, 21.636628873269974, 4.486832053827553, 40.620478140268105, 111.92535922058114, 174.72400611821925, 56.738947951809145, 41.932022416832325, 39.55465401883779, 31.302560417013506, 83.24764673373947, 131.0370044774057, 3.8416254754359693, 7.451027891411897, 10.67334882534002, 1.7533895062141065, 299.71058281163147, 419.8889037045144, 6.009021916310405, 3.264424809008044, 16.42713137676544, 81.16166475891234, 22.879814041564558, 15.522206217125127, 30.486331690309882, 44.65097599220788, 68.18207507742675, 7.5831471077878625, 110.97183032636153, 77.69317585089615, 1.796032137136806, 8.09378318866181, 92.13988859727955, 66.82391887061664, 36.35822434424423, 32.92644541834007, 50.08797194458668, 33.300928853240784, 59.010717256288125, 32.9353453787563, 26.418209595501846, 31.83513508563362, 8.908938710040847, 13.575561900395865, 10.225521812633875, 19.133714956286873, 98.2882311823483, 72.54928377309936, 140.49284873804018, 132.4093291775614, 45.912166974191315, 22.33674422636465, 15.103793383581744, 21.57433777062845, 102.19686117027929, 24.12240593476018, 3.6036290974987004, 0.16433351664063273, 26.756230870988645, 15.408651513051213, 39.23843628278093, 46.65229798752467, 59.99165380277625, 25.591834722498987, 30.060595195832324, 4.559090702552424, 54.69471129783873, 1.648341543304093, 38.72311232754358, 23.878383364999824]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.2743617287170554, "mean_inference_ms": 5.886269056247033, "mean_action_processing_ms": 0.9798137462397328, "mean_env_wait_ms": 0.7739083741703938, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009186267852783203, "StateBufferConnector_ms": 0.011665582656860352, "ViewRequirementAgentConnector_ms": 0.4292259216308594}, "num_episodes": 18, "episode_return_max": 250.86400695036463, "episode_return_min": -96.59684479415385, "episode_return_mean": 64.7937149658178, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1264000, "num_agent_steps_trained": 1264000, "num_env_steps_sampled": 316000, "num_env_steps_trained": 316000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 261.9877038668541, "num_env_steps_trained_throughput_per_sec": 261.9877038668541, "timesteps_total": 316000, "num_env_steps_sampled_lifetime": 316000, "num_agent_steps_sampled_lifetime": 1264000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1264000, "timers": {"training_iteration_time_ms": 16218.583, "restore_workers_time_ms": 0.015, "training_step_time_ms": 16218.54, "sample_time_ms": 4341.593, "learn_time_ms": 11861.247, "learn_throughput": 337.233, "synch_weights_time_ms": 14.773}, "counters": {"num_env_steps_sampled": 316000, "num_env_steps_trained": 316000, "num_agent_steps_sampled": 1264000, "num_agent_steps_trained": 1264000}, "done": false, "training_iteration": 79, "trial_id": "d163c_00000", "date": "2024-08-16_13-20-08", "timestamp": 1723794608, "time_this_iter_s": 15.272247076034546, "time_total_s": 1826.913473367691, "pid": 81201, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16b879280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1826.913473367691, "iterations_since_restore": 79, "perf": {"cpu_util_percent": 27.527272727272727, "ram_util_percent": 69.23181818181818}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.8941254714809395, "cur_kl_coeff": 0.00263671875, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.2081078294093017, "policy_loss": -0.004939332256640588, "vf_loss": 2.2130229336874825, "vf_explained_var": 0.15402226694046506, "kl": 0.00918900207138784, "entropy": 0.3992625536899718, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 150255.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.793746399816382, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.5749554393941132, "policy_loss": -0.004026132698722736, "vf_loss": 1.5782551628887338, "vf_explained_var": 0.12244094919275354, "kl": 0.007264061896977628, "entropy": 1.0842295176768428, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 150255.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 320000, "num_env_steps_trained": 320000, "num_agent_steps_sampled": 1280000, "num_agent_steps_trained": 1280000}, "env_runners": {"episode_reward_max": 250.86400695036463, "episode_reward_min": -28.08351550139593, "episode_reward_mean": 47.05037361099678, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -470.7354795657801, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 139.9695360639454, "predator_policy": 419.8889037045144}, "policy_reward_mean": {"prey_policy": -39.795530098516785, "predator_policy": 63.320716904015164}, "custom_metrics": {}, "hist_stats": {"episode_reward": [170.23311185455475, 88.23564911632785, -22.208003005636932, 155.29932944685856, 131.0997304939871, 71.51571661918511, 132.9892211667428, 99.01648464973246, 35.00279217829014, 18.917748098583125, 82.39935215635798, 89.76865496916207, 81.7193944788868, 60.74322042100773, 2.801727566036069, 118.85772052928148, 82.66892720864033, 86.31048828911162, 3.8699999999999615, 58.979480019615664, 5.968728930655861, 61.52006215229489, 99.05571898872866, -4.077338641874663, 36.097319567770676, 65.40346651651467, 35.01420097953608, 37.646268193002044, 61.02405176363056, 105.83083018012019, 4.8059209537961785, 71.609761513417, 117.4634339021263, 57.34663216549503, 123.59388789357773, 129.062688552988, 46.39683943417194, 75.22323990249669, 9.92722938402482, 55.03173530514732, 7.9799999999999365, 102.59566867715749, 15.694534525629097, 17.031607349765107, 2.237661703909404, 108.97942551378796, 8.859682074773497, 3.6282070529390547, 49.700196469229375, 7.641893989137456, -0.43254012646141793, 250.86400695036463, 145.6344248090085, -4.61252583849537, 5.543371087256102, 30.26309778710906, -18.96272532862012, 58.01140509110112, 147.01603213713676, 28.08197542008886, 24.45282718255738, 5.83657826982544, 59.75323190282972, 14.352736616820813, 11.011951849962172, 14.577020102800972, 51.37156493734259, 78.45087601553564, -6.653400383893775, 35.15282499344263, 56.79687479218705, 4.034333516640591, 28.286440686795157, 18.38231267168854, 8.956392516954239, 41.43999999999991, 9.886966043596939, 58.520465311495656, 15.552033419469309, 29.68143197772388, 35.60651048256594, 23.761354933367436, 20.590229233784484, 3.391314300502632, 19.45549628851448, 3.3766719784231696, 19.83222817063578, 41.206679365410395, 3.979999999999959, 21.68255314475465, 11.780096574928304, -28.08351550139593, 41.50417202837007, 23.946488244917244, 27.245176545739643, 43.34834295612938, 2.940196319839803, 26.864599106946006, 64.60669804368592, 30.237783219621857], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [62.82967126320533, 17.610435620074263, -112.36442611427469, -90.20611314448331, -124.1907597331806, -97.02217543819059, 60.61931563523135, -4.905391595030264, -209.03141466228664, -2.2804325883483054, -98.17359042083025, -51.016208087045214, 19.222788888225892, 38.55567994657916, -35.63244889239646, -37.82273118539492, -29.61072822797506, -219.7349005568835, 2.0000000000000013, -89.80951426920493, -349.23478585268805, -19.010128201253412, 2.0000000000000013, -36.37454806961015, -39.047657627112926, -40.50402920526707, -11.910299222596855, -99.25602905427867, 1.0109348304770225, -2.8883066949694136, -7.5307732340559905, 46.50761237577258, -76.24551213004229, 2.0000000000000013, -2.273654131893477, -170.4967763769752, 0.7137582618712458, 0.517962215417635, -24.766932732474032, -77.55753638225411, -340.8309367243196, -129.50281020211173, -209.42052473827107, -44.4758753836805, -79.87507253170399, -148.08101330123304, -100.84660953813211, -82.33861229109955, -227.86341483560446, 2.206968730335711, -9.550289071964013, -51.75976453578037, -32.570681014459964, -138.35002548197352, -71.0437335567456, -48.01417042125128, -48.207358501048226, -30.74977301204658, 0.4630047134889243, -174.84673177537314, 2.0000000000000013, -86.72492662917162, -24.703575616762176, -0.2939746439937785, -2.0863814708436395, -21.118274730576314, -13.970424568301729, -151.23740648789166, -66.94804737973082, 3.698112593791221, 2.0000000000000013, -249.3536594432109, -63.83551695045333, -1.6004230210537465, 2.0000000000000013, -39.29791685645073, -64.97217010245082, -1.7940645843397902, -79.64884664045636, -41.95960603720088, -11.541273530934202, -19.31520387235275, -8.430499735213342, -127.17115118604113, -5.323535345818352, -13.053730084468684, -39.31221675921031, 2.0000000000000013, -35.37241139471048, -7.497237095476189, -174.54511733346126, -3.124822491551371, -36.32516821923577, -53.48612007463261, -44.48254907364615, -22.746458309266057, -53.800236865750406, -110.78421787616527, -5.65075937771037, 2.0000000000000013, -8.36471853879489, -4.494559919220688, 2.0000000000000013, -470.7354795657801, 139.9695360639454, -3.6085579802556698, -81.01557637562206, -21.185745598550575, -34.35190192987997, 1.4932527584462287, -33.03855631867134, -11.835653576737997, -50.81614641736001, -43.91180109647456, -0.7570075063043566, -129.89659357985192, -2.3916315369792684, 139.51784834831744, -4.677637230432293, -126.20419481737504, -29.04716743069844, -15.78467514932845, -34.785359217859586, -42.76696331014283, 13.243172287173088, -45.436003019387464, -12.090731492813504, -31.809876571501306, 2.0000000000000013, -13.472548760474494, -16.613483794235353, 1.8312671281158635, 1.6495802328169216, -121.11553025092113, -28.41037042330886, -166.04093147675673, -46.76367009971623, -28.138641484733466, 1.5155829603361906, -3.0408891211035263, -29.19059989703716, -40.33179241581474, 2.0000000000000013, -1.7336290974987343, -5.078844277622766, -8.799597419622375, -69.50842159861685, 2.0000000000000013, -37.003924474394104, -39.62317153392733, 9.459404804167747, -2.6390907025524646, 2.0000000000000013, -48.45608679754611, -1.888808790365133, -2.1922215906822644, -6.962318836169855, -34.76912525110812, 5.13846518223187, -23.878112685277873, -5.797048001539502, 11.84690375969774, -157.95037471509133, -21.188473036678477, -27.4794367094091, -20.78675306451823, -0.3877777978285204, -1.9718331064834655, 2.0000000000000013, -24.8249603979489, -6.559080518145187, 1.0812953438410489, -21.208263124908843, -15.015338246560516, 1.5132639807755757, -23.78960154797303, 1.5962351254059373, 2.0000000000000013, -0.5028089183299156, 0.12112861049519404, 1.5661415782132437, -31.914112244049942, -60.522907753603796, -51.97186920839296, -81.9410849309557, 2.0000000000000013, -50.561908375548015, -1.0016685973663697, -52.104811157836735, -1.6438040990557492, 18.145706117932683, 4.231068778100079, -18.388086405300424, -17.27847077365432, 4.789234890661308, -5.441546310671003, -3.984020789117082, -65.18060682455597, -3.3269151582610474, -7.656317418880409], "policy_predator_policy_reward": [40.23940742588985, 49.553597545385706, 181.70660007524125, 109.09958829984406, 88.76198115422521, 110.24295101150928, 50.164672368711884, 49.42073303794594, 191.07939941182556, 151.33217833279616, 94.983219842894, 125.7222952841665, 16.00041484387142, 59.210337488066095, 78.98004069264954, 93.49162403487391, 211.60856490234443, 72.73985606080429, 36.17438101994152, 70.55288134784657, 266.3508553089801, 184.2934109013192, 41.57071834158481, 82.57248469718682, 59.13899858582361, 102.13208272544328, 120.43567657209398, 51.47387212578957, 0.0, 4.679099430528441, 23.72698567694852, 56.1538957106154, 43.71736153084891, 113.19707780783341, 139.95401535283284, 119.12690344514738, 1.2262417381287556, 1.4120377845823664, 91.10912370959818, 70.19482542474562, 200.02174450488369, 276.28073135220336, 178.56838265314738, 136.84807962109892, 107.12646835346644, 219.88533646819948, 149.21072033365792, 29.89716285369941, 234.99200948074653, 26.761756192292836, 88.08830088494095, 38.62521923931822, 120.94054773667993, 84.99435973928941, 110.58919156504167, 46.11498060595721, 63.34274718300638, 76.63843609371914, 136.26076061660845, 143.95379662539577, 87.51492662917202, 2.0159209537962215, 32.771401297775704, 63.835910476397245, 81.43721037165312, 59.23087973189263, 155.46945750394892, 67.08500571773939, 92.01078366942738, 94.83303901008969, 171.1918071353815, 205.22454086081729, 16.470267130990077, 95.36251227468927, 59.30557047871682, 53.2155862802308, 72.53217010245105, 4.161293968364625, 71.18819900399072, 105.45198897881387, 32.307138138575134, 6.5293392647120685, 127.01373308420872, 111.18358651420257, 28.20740384295945, 5.86439611295667, 32.707195235705115, 21.636628873269974, 4.486832053827553, 40.620478140268105, 111.92535922058114, 174.72400611821925, 56.738947951809145, 41.932022416832325, 39.55465401883779, 31.302560417013506, 83.24764673373947, 131.0370044774057, 3.8416254754359693, 7.451027891411897, 10.67334882534002, 1.7533895062141065, 299.71058281163147, 419.8889037045144, 6.009021916310405, 3.264424809008044, 16.42713137676544, 81.16166475891234, 22.879814041564558, 15.522206217125127, 30.486331690309882, 44.65097599220788, 68.18207507742675, 7.5831471077878625, 110.97183032636153, 77.69317585089615, 1.796032137136806, 8.09378318866181, 92.13988859727955, 66.82391887061664, 36.35822434424423, 32.92644541834007, 50.08797194458668, 33.300928853240784, 59.010717256288125, 32.9353453787563, 26.418209595501846, 31.83513508563362, 8.908938710040847, 13.575561900395865, 10.225521812633875, 19.133714956286873, 98.2882311823483, 72.54928377309936, 140.49284873804018, 132.4093291775614, 45.912166974191315, 22.33674422636465, 15.103793383581744, 21.57433777062845, 102.19686117027929, 24.12240593476018, 3.6036290974987004, 0.16433351664063273, 26.756230870988645, 15.408651513051213, 39.23843628278093, 46.65229798752467, 59.99165380277625, 25.591834722498987, 30.060595195832324, 4.559090702552424, 54.69471129783873, 1.648341543304093, 38.72311232754358, 23.878383364999824, 39.743679206943455, 17.539798299803618, 29.420096486512627, 19.000982994257004, 19.162753293657524, 10.393901430750708, 100.09298219981717, 102.80722048531963, 29.75741924952542, 39.098999758186416, 1.8890920983311756, 3.861833106483426, 18.761526333637864, 23.51893035282531, 0.5153766345821496, 8.339080518145149, 44.14356718055584, 11.912262361549175, 32.96621257710022, 30.516804355508174, 0.3837648745940641, 0.0, 11.315470731848663, 10.748762720740158, 24.674192807547424, 17.4538744332174, 23.546251115979665, 60.86501034462103, 29.095232977662636, 92.3500239816642, 34.720548955647004, 40.78951626218394, 30.03227043371739, 50.96152136891413, 10.292182207932965, 10.679385852164476, 18.448667093494333, 20.1580864053007, 14.511350482928496, 13.005560044026685, 69.4141193384506, 64.35720631890848, 27.29519028330629, 13.925825513456466]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.2735746758347712, "mean_inference_ms": 5.883631586587874, "mean_action_processing_ms": 0.9794299444800604, "mean_env_wait_ms": 0.773746709595358, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008975028991699219, "StateBufferConnector_ms": 0.011580586433410645, "ViewRequirementAgentConnector_ms": 0.39938831329345703}, "num_episodes": 22, "episode_return_max": 250.86400695036463, "episode_return_min": -28.08351550139593, "episode_return_mean": 47.05037361099678, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1280000, "num_agent_steps_trained": 1280000, "num_env_steps_sampled": 320000, "num_env_steps_trained": 320000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 244.16661137563082, "num_env_steps_trained_throughput_per_sec": 244.16661137563082, "timesteps_total": 320000, "num_env_steps_sampled_lifetime": 320000, "num_agent_steps_sampled_lifetime": 1280000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1280000, "timers": {"training_iteration_time_ms": 16020.855, "restore_workers_time_ms": 0.015, "training_step_time_ms": 16020.812, "sample_time_ms": 4272.408, "learn_time_ms": 11732.442, "learn_throughput": 340.935, "synch_weights_time_ms": 15.028}, "counters": {"num_env_steps_sampled": 320000, "num_env_steps_trained": 320000, "num_agent_steps_sampled": 1280000, "num_agent_steps_trained": 1280000}, "done": false, "training_iteration": 80, "trial_id": "d163c_00000", "date": "2024-08-16_13-20-24", "timestamp": 1723794624, "time_this_iter_s": 16.387454986572266, "time_total_s": 1843.3009283542633, "pid": 81201, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16b893af0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1843.3009283542633, "iterations_since_restore": 80, "perf": {"cpu_util_percent": 30.16521739130435, "ram_util_percent": 69.65217391304348}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.058151472434796, "cur_kl_coeff": 0.00263671875, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.5956728570360355, "policy_loss": -0.005371353599099965, "vf_loss": 1.6010332395790745, "vf_explained_var": 0.1567700217640589, "kl": 0.004160640955591152, "entropy": 0.37849714215155, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 152145.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.0482103319395155, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.0901017798002435, "policy_loss": -0.010657429369412875, "vf_loss": 1.1000555704195032, "vf_explained_var": 0.2249648656794634, "kl": 0.007036395960880665, "entropy": 1.0991036114869295, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 152145.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_agent_steps_sampled": 1296000, "num_agent_steps_trained": 1296000}, "env_runners": {"episode_reward_max": 250.86400695036463, "episode_reward_min": -28.08351550139593, "episode_reward_mean": 35.097286254080984, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -470.7354795657801, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 139.9695360639454, "predator_policy": 419.8889037045144}, "policy_reward_mean": {"prey_policy": -33.9387492064331, "predator_policy": 51.48739233347361}, "custom_metrics": {}, "hist_stats": {"episode_reward": [3.8699999999999615, 58.979480019615664, 5.968728930655861, 61.52006215229489, 99.05571898872866, -4.077338641874663, 36.097319567770676, 65.40346651651467, 35.01420097953608, 37.646268193002044, 61.02405176363056, 105.83083018012019, 4.8059209537961785, 71.609761513417, 117.4634339021263, 57.34663216549503, 123.59388789357773, 129.062688552988, 46.39683943417194, 75.22323990249669, 9.92722938402482, 55.03173530514732, 7.9799999999999365, 102.59566867715749, 15.694534525629097, 17.031607349765107, 2.237661703909404, 108.97942551378796, 8.859682074773497, 3.6282070529390547, 49.700196469229375, 7.641893989137456, -0.43254012646141793, 250.86400695036463, 145.6344248090085, -4.61252583849537, 5.543371087256102, 30.26309778710906, -18.96272532862012, 58.01140509110112, 147.01603213713676, 28.08197542008886, 24.45282718255738, 5.83657826982544, 59.75323190282972, 14.352736616820813, 11.011951849962172, 14.577020102800972, 51.37156493734259, 78.45087601553564, -6.653400383893775, 35.15282499344263, 56.79687479218705, 4.034333516640591, 28.286440686795157, 18.38231267168854, 8.956392516954239, 41.43999999999991, 9.886966043596939, 58.520465311495656, 15.552033419469309, 29.68143197772388, 35.60651048256594, 23.761354933367436, 20.590229233784484, 3.391314300502632, 19.45549628851448, 3.3766719784231696, 19.83222817063578, 41.206679365410395, 3.979999999999959, 21.68255314475465, 11.780096574928304, -28.08351550139593, 41.50417202837007, 23.946488244917244, 27.245176545739643, 43.34834295612938, 2.940196319839803, 26.864599106946006, 64.60669804368592, 30.237783219621857, 14.408926491186687, 9.700347555166763, 20.557807523051437, 7.616225860590908, 0.12472635987704624, 8.48904551675506, 41.66229831267831, 7.342528339805998, 8.610263189674543, 5.683623066724021, 10.593592231645571, 34.141466470329924, 9.677966290925118, 6.111488343089647, 3.979999999999959, 18.66190872176289, 52.896987277657544, 29.80332899460931], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.7137582618712458, 0.517962215417635, -24.766932732474032, -77.55753638225411, -340.8309367243196, -129.50281020211173, -209.42052473827107, -44.4758753836805, -79.87507253170399, -148.08101330123304, -100.84660953813211, -82.33861229109955, -227.86341483560446, 2.206968730335711, -9.550289071964013, -51.75976453578037, -32.570681014459964, -138.35002548197352, -71.0437335567456, -48.01417042125128, -48.207358501048226, -30.74977301204658, 0.4630047134889243, -174.84673177537314, 2.0000000000000013, -86.72492662917162, -24.703575616762176, -0.2939746439937785, -2.0863814708436395, -21.118274730576314, -13.970424568301729, -151.23740648789166, -66.94804737973082, 3.698112593791221, 2.0000000000000013, -249.3536594432109, -63.83551695045333, -1.6004230210537465, 2.0000000000000013, -39.29791685645073, -64.97217010245082, -1.7940645843397902, -79.64884664045636, -41.95960603720088, -11.541273530934202, -19.31520387235275, -8.430499735213342, -127.17115118604113, -5.323535345818352, -13.053730084468684, -39.31221675921031, 2.0000000000000013, -35.37241139471048, -7.497237095476189, -174.54511733346126, -3.124822491551371, -36.32516821923577, -53.48612007463261, -44.48254907364615, -22.746458309266057, -53.800236865750406, -110.78421787616527, -5.65075937771037, 2.0000000000000013, -8.36471853879489, -4.494559919220688, 2.0000000000000013, -470.7354795657801, 139.9695360639454, -3.6085579802556698, -81.01557637562206, -21.185745598550575, -34.35190192987997, 1.4932527584462287, -33.03855631867134, -11.835653576737997, -50.81614641736001, -43.91180109647456, -0.7570075063043566, -129.89659357985192, -2.3916315369792684, 139.51784834831744, -4.677637230432293, -126.20419481737504, -29.04716743069844, -15.78467514932845, -34.785359217859586, -42.76696331014283, 13.243172287173088, -45.436003019387464, -12.090731492813504, -31.809876571501306, 2.0000000000000013, -13.472548760474494, -16.613483794235353, 1.8312671281158635, 1.6495802328169216, -121.11553025092113, -28.41037042330886, -166.04093147675673, -46.76367009971623, -28.138641484733466, 1.5155829603361906, -3.0408891211035263, -29.19059989703716, -40.33179241581474, 2.0000000000000013, -1.7336290974987343, -5.078844277622766, -8.799597419622375, -69.50842159861685, 2.0000000000000013, -37.003924474394104, -39.62317153392733, 9.459404804167747, -2.6390907025524646, 2.0000000000000013, -48.45608679754611, -1.888808790365133, -2.1922215906822644, -6.962318836169855, -34.76912525110812, 5.13846518223187, -23.878112685277873, -5.797048001539502, 11.84690375969774, -157.95037471509133, -21.188473036678477, -27.4794367094091, -20.78675306451823, -0.3877777978285204, -1.9718331064834655, 2.0000000000000013, -24.8249603979489, -6.559080518145187, 1.0812953438410489, -21.208263124908843, -15.015338246560516, 1.5132639807755757, -23.78960154797303, 1.5962351254059373, 2.0000000000000013, -0.5028089183299156, 0.12112861049519404, 1.5661415782132437, -31.914112244049942, -60.522907753603796, -51.97186920839296, -81.9410849309557, 2.0000000000000013, -50.561908375548015, -1.0016685973663697, -52.104811157836735, -1.6438040990557492, 18.145706117932683, 4.231068778100079, -18.388086405300424, -17.27847077365432, 4.789234890661308, -5.441546310671003, -3.984020789117082, -65.18060682455597, -3.3269151582610474, -7.656317418880409, -17.624815770996378, 2.0000000000000013, -43.10128748434101, 2.0000000000000013, -41.12065392619643, -22.338546348847842, -89.36192513171297, -14.465390370067352, -4.062271255742597, -12.583217199019737, -5.966398787577818, -1.7932389010928447, 2.0000000000000013, -59.755507512309336, -14.141541696729442, 0.6681254644695312, -6.788213988417898, -21.26273397338783, -17.2784906018976, -3.7296494175663923, -11.3857912972431, -11.88796421170138, 14.860743804782853, -94.22160210799602, -5.202165559297751, 2.0000000000000013, -34.94365837031291, 2.0000000000000013, 1.6369955175994517, 2.0000000000000013, -42.276727772575235, -28.353813698393303, -8.31988009078413, 45.55999999999969, -68.64724971944398, -26.97384733316501], "policy_predator_policy_reward": [1.2262417381287556, 1.4120377845823664, 91.10912370959818, 70.19482542474562, 200.02174450488369, 276.28073135220336, 178.56838265314738, 136.84807962109892, 107.12646835346644, 219.88533646819948, 149.21072033365792, 29.89716285369941, 234.99200948074653, 26.761756192292836, 88.08830088494095, 38.62521923931822, 120.94054773667993, 84.99435973928941, 110.58919156504167, 46.11498060595721, 63.34274718300638, 76.63843609371914, 136.26076061660845, 143.95379662539577, 87.51492662917202, 2.0159209537962215, 32.771401297775704, 63.835910476397245, 81.43721037165312, 59.23087973189263, 155.46945750394892, 67.08500571773939, 92.01078366942738, 94.83303901008969, 171.1918071353815, 205.22454086081729, 16.470267130990077, 95.36251227468927, 59.30557047871682, 53.2155862802308, 72.53217010245105, 4.161293968364625, 71.18819900399072, 105.45198897881387, 32.307138138575134, 6.5293392647120685, 127.01373308420872, 111.18358651420257, 28.20740384295945, 5.86439611295667, 32.707195235705115, 21.636628873269974, 4.486832053827553, 40.620478140268105, 111.92535922058114, 174.72400611821925, 56.738947951809145, 41.932022416832325, 39.55465401883779, 31.302560417013506, 83.24764673373947, 131.0370044774057, 3.8416254754359693, 7.451027891411897, 10.67334882534002, 1.7533895062141065, 299.71058281163147, 419.8889037045144, 6.009021916310405, 3.264424809008044, 16.42713137676544, 81.16166475891234, 22.879814041564558, 15.522206217125127, 30.486331690309882, 44.65097599220788, 68.18207507742675, 7.5831471077878625, 110.97183032636153, 77.69317585089615, 1.796032137136806, 8.09378318866181, 92.13988859727955, 66.82391887061664, 36.35822434424423, 32.92644541834007, 50.08797194458668, 33.300928853240784, 59.010717256288125, 32.9353453787563, 26.418209595501846, 31.83513508563362, 8.908938710040847, 13.575561900395865, 10.225521812633875, 19.133714956286873, 98.2882311823483, 72.54928377309936, 140.49284873804018, 132.4093291775614, 45.912166974191315, 22.33674422636465, 15.103793383581744, 21.57433777062845, 102.19686117027929, 24.12240593476018, 3.6036290974987004, 0.16433351664063273, 26.756230870988645, 15.408651513051213, 39.23843628278093, 46.65229798752467, 59.99165380277625, 25.591834722498987, 30.060595195832324, 4.559090702552424, 54.69471129783873, 1.648341543304093, 38.72311232754358, 23.878383364999824, 39.743679206943455, 17.539798299803618, 29.420096486512627, 19.000982994257004, 19.162753293657524, 10.393901430750708, 100.09298219981717, 102.80722048531963, 29.75741924952542, 39.098999758186416, 1.8890920983311756, 3.861833106483426, 18.761526333637864, 23.51893035282531, 0.5153766345821496, 8.339080518145149, 44.14356718055584, 11.912262361549175, 32.96621257710022, 30.516804355508174, 0.3837648745940641, 0.0, 11.315470731848663, 10.748762720740158, 24.674192807547424, 17.4538744332174, 23.546251115979665, 60.86501034462103, 29.095232977662636, 92.3500239816642, 34.720548955647004, 40.78951626218394, 30.03227043371739, 50.96152136891413, 10.292182207932965, 10.679385852164476, 18.448667093494333, 20.1580864053007, 14.511350482928496, 13.005560044026685, 69.4141193384506, 64.35720631890848, 27.29519028330629, 13.925825513456466, 10.817769547753148, 19.21597271443025, 7.474638771873021, 43.32699626763453, 20.388264052819306, 63.628743745275884, 90.83415500564806, 20.6093863567239, 14.213217199019704, 2.556997615619628, 8.030908541024763, 8.217774664400963, 60.47129313616719, 38.94651268882082, 6.228234090432254, 14.587710481633692, 15.59094514817899, 21.070266003301516, 8.339388248029174, 18.352374838159086, 10.663049687925083, 23.204298052664996, 19.1103769695507, 94.3919478039934, 8.655604332960275, 4.224527517262635, 4.262541055457616, 34.79260565794471, 0.34300448240054965, 0.0, 45.1290813033688, 44.16336888936213, 9.979880090784095, 5.6769872776581805, 95.07373877509427, 30.350687272124357]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.272979188299234, "mean_inference_ms": 5.883095708422111, "mean_action_processing_ms": 0.9786674128256324, "mean_env_wait_ms": 0.7725559767957606, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00894308090209961, "StateBufferConnector_ms": 0.01564764976501465, "ViewRequirementAgentConnector_ms": 0.41010916233062744}, "num_episodes": 18, "episode_return_max": 250.86400695036463, "episode_return_min": -28.08351550139593, "episode_return_mean": 35.097286254080984, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1296000, "num_agent_steps_trained": 1296000, "num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 264.29221252865693, "num_env_steps_trained_throughput_per_sec": 264.29221252865693, "timesteps_total": 324000, "num_env_steps_sampled_lifetime": 324000, "num_agent_steps_sampled_lifetime": 1296000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1296000, "timers": {"training_iteration_time_ms": 15954.557, "restore_workers_time_ms": 0.015, "training_step_time_ms": 15954.512, "sample_time_ms": 4249.999, "learn_time_ms": 11688.315, "learn_throughput": 342.222, "synch_weights_time_ms": 15.23}, "counters": {"num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_agent_steps_sampled": 1296000, "num_agent_steps_trained": 1296000}, "done": false, "training_iteration": 81, "trial_id": "d163c_00000", "date": "2024-08-16_13-20-39", "timestamp": 1723794639, "time_this_iter_s": 15.139116048812866, "time_total_s": 1858.4400444030762, "pid": 81201, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16b80ef70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1858.4400444030762, "iterations_since_restore": 81, "perf": {"cpu_util_percent": 27.842857142857145, "ram_util_percent": 70.20952380952382}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.5062714208055428, "cur_kl_coeff": 0.001318359375, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.6848946540443985, "policy_loss": -0.0031671666217445537, "vf_loss": 1.6880575275925733, "vf_explained_var": 0.12982387949549962, "kl": 0.0032555618789011005, "entropy": 0.37141011486608516, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 154035.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.7308560917617153, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.4774761693187493, "policy_loss": -0.0058125789750308274, "vf_loss": 1.4826999523021556, "vf_explained_var": 0.15950756580741318, "kl": 0.00588797920876694, "entropy": 1.0684278999056136, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 154035.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 328000, "num_env_steps_trained": 328000, "num_agent_steps_sampled": 1312000, "num_agent_steps_trained": 1312000}, "env_runners": {"episode_reward_max": 250.86400695036463, "episode_reward_min": -28.08351550139593, "episode_reward_mean": 25.74239887978711, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -470.7354795657801, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 139.9695360639454, "predator_policy": 419.8889037045144}, "policy_reward_mean": {"prey_policy": -20.863810875624466, "predator_policy": 33.73501031551802}, "custom_metrics": {}, "hist_stats": {"episode_reward": [102.59566867715749, 15.694534525629097, 17.031607349765107, 2.237661703909404, 108.97942551378796, 8.859682074773497, 3.6282070529390547, 49.700196469229375, 7.641893989137456, -0.43254012646141793, 250.86400695036463, 145.6344248090085, -4.61252583849537, 5.543371087256102, 30.26309778710906, -18.96272532862012, 58.01140509110112, 147.01603213713676, 28.08197542008886, 24.45282718255738, 5.83657826982544, 59.75323190282972, 14.352736616820813, 11.011951849962172, 14.577020102800972, 51.37156493734259, 78.45087601553564, -6.653400383893775, 35.15282499344263, 56.79687479218705, 4.034333516640591, 28.286440686795157, 18.38231267168854, 8.956392516954239, 41.43999999999991, 9.886966043596939, 58.520465311495656, 15.552033419469309, 29.68143197772388, 35.60651048256594, 23.761354933367436, 20.590229233784484, 3.391314300502632, 19.45549628851448, 3.3766719784231696, 19.83222817063578, 41.206679365410395, 3.979999999999959, 21.68255314475465, 11.780096574928304, -28.08351550139593, 41.50417202837007, 23.946488244917244, 27.245176545739643, 43.34834295612938, 2.940196319839803, 26.864599106946006, 64.60669804368592, 30.237783219621857, 14.408926491186687, 9.700347555166763, 20.557807523051437, 7.616225860590908, 0.12472635987704624, 8.48904551675506, 41.66229831267831, 7.342528339805998, 8.610263189674543, 5.683623066724021, 10.593592231645571, 34.141466470329924, 9.677966290925118, 6.111488343089647, 3.979999999999959, 18.66190872176289, 52.896987277657544, 29.80332899460931, 11.655040095207946, 27.913855678476963, 24.284630552497863, 3.899999999999961, 1.7933146066960117, 19.938964205762833, 21.97266798051301, 18.150000000000315, 24.83449841971963, 10.827183565649946, 5.670184098254684, 7.959999999999916, 12.223423441295793, 31.2205399080942, 7.500594454225256, 8.362038856924741, 13.43894396294967, 19.36755886235521, 31.364005559068012, 7.7096606565205, 6.5731927696413965, 6.127732838083455, 6.497389715910355], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-8.430499735213342, -127.17115118604113, -5.323535345818352, -13.053730084468684, -39.31221675921031, 2.0000000000000013, -35.37241139471048, -7.497237095476189, -174.54511733346126, -3.124822491551371, -36.32516821923577, -53.48612007463261, -44.48254907364615, -22.746458309266057, -53.800236865750406, -110.78421787616527, -5.65075937771037, 2.0000000000000013, -8.36471853879489, -4.494559919220688, 2.0000000000000013, -470.7354795657801, 139.9695360639454, -3.6085579802556698, -81.01557637562206, -21.185745598550575, -34.35190192987997, 1.4932527584462287, -33.03855631867134, -11.835653576737997, -50.81614641736001, -43.91180109647456, -0.7570075063043566, -129.89659357985192, -2.3916315369792684, 139.51784834831744, -4.677637230432293, -126.20419481737504, -29.04716743069844, -15.78467514932845, -34.785359217859586, -42.76696331014283, 13.243172287173088, -45.436003019387464, -12.090731492813504, -31.809876571501306, 2.0000000000000013, -13.472548760474494, -16.613483794235353, 1.8312671281158635, 1.6495802328169216, -121.11553025092113, -28.41037042330886, -166.04093147675673, -46.76367009971623, -28.138641484733466, 1.5155829603361906, -3.0408891211035263, -29.19059989703716, -40.33179241581474, 2.0000000000000013, -1.7336290974987343, -5.078844277622766, -8.799597419622375, -69.50842159861685, 2.0000000000000013, -37.003924474394104, -39.62317153392733, 9.459404804167747, -2.6390907025524646, 2.0000000000000013, -48.45608679754611, -1.888808790365133, -2.1922215906822644, -6.962318836169855, -34.76912525110812, 5.13846518223187, -23.878112685277873, -5.797048001539502, 11.84690375969774, -157.95037471509133, -21.188473036678477, -27.4794367094091, -20.78675306451823, -0.3877777978285204, -1.9718331064834655, 2.0000000000000013, -24.8249603979489, -6.559080518145187, 1.0812953438410489, -21.208263124908843, -15.015338246560516, 1.5132639807755757, -23.78960154797303, 1.5962351254059373, 2.0000000000000013, -0.5028089183299156, 0.12112861049519404, 1.5661415782132437, -31.914112244049942, -60.522907753603796, -51.97186920839296, -81.9410849309557, 2.0000000000000013, -50.561908375548015, -1.0016685973663697, -52.104811157836735, -1.6438040990557492, 18.145706117932683, 4.231068778100079, -18.388086405300424, -17.27847077365432, 4.789234890661308, -5.441546310671003, -3.984020789117082, -65.18060682455597, -3.3269151582610474, -7.656317418880409, -17.624815770996378, 2.0000000000000013, -43.10128748434101, 2.0000000000000013, -41.12065392619643, -22.338546348847842, -89.36192513171297, -14.465390370067352, -4.062271255742597, -12.583217199019737, -5.966398787577818, -1.7932389010928447, 2.0000000000000013, -59.755507512309336, -14.141541696729442, 0.6681254644695312, -6.788213988417898, -21.26273397338783, -17.2784906018976, -3.7296494175663923, -11.3857912972431, -11.88796421170138, 14.860743804782853, -94.22160210799602, -5.202165559297751, 2.0000000000000013, -34.94365837031291, 2.0000000000000013, 1.6369955175994517, 2.0000000000000013, -42.276727772575235, -28.353813698393303, -8.31988009078413, 45.55999999999969, -68.64724971944398, -26.97384733316501, -11.88329173720441, -17.64728896734272, 5.332123903987776, 2.0000000000000013, -6.089788126865809, 19.19128521155898, -0.11392033700223506, 2.0000000000000013, -15.371260286106287, -10.263249778133106, 2.0000000000000013, -39.16211990225282, -26.876642900122853, -0.014013726482111322, -8.491591739806937, 0.8344517057415021, -15.272572809335122, -4.633008762336535, -69.95612202994361, -96.8864771660972, -29.427481312230928, -3.06122687483362, 5.959999999999958, 2.0000000000000013, 4.969999999999958, -21.43453529930256, -0.036239151840953825, 19.0402783702213, -9.736373412491252, 1.058178277780488, -12.251228365949585, 1.4488657849241664, 2.0000000000000013, -13.847905114623972, 17.17981717941242, 1.5298841638997274, 12.025776997412104, -15.270862990782986, -10.59729318878288, -33.891469858416045, 2.0000000000000013, -4.673165252665866, 1.771609397936964, -7.213038960617094, -2.7061888623784824, 2.0000000000000013], "policy_predator_policy_reward": [127.01373308420872, 111.18358651420257, 28.20740384295945, 5.86439611295667, 32.707195235705115, 21.636628873269974, 4.486832053827553, 40.620478140268105, 111.92535922058114, 174.72400611821925, 56.738947951809145, 41.932022416832325, 39.55465401883779, 31.302560417013506, 83.24764673373947, 131.0370044774057, 3.8416254754359693, 7.451027891411897, 10.67334882534002, 1.7533895062141065, 299.71058281163147, 419.8889037045144, 6.009021916310405, 3.264424809008044, 16.42713137676544, 81.16166475891234, 22.879814041564558, 15.522206217125127, 30.486331690309882, 44.65097599220788, 68.18207507742675, 7.5831471077878625, 110.97183032636153, 77.69317585089615, 1.796032137136806, 8.09378318866181, 92.13988859727955, 66.82391887061664, 36.35822434424423, 32.92644541834007, 50.08797194458668, 33.300928853240784, 59.010717256288125, 32.9353453787563, 26.418209595501846, 31.83513508563362, 8.908938710040847, 13.575561900395865, 10.225521812633875, 19.133714956286873, 98.2882311823483, 72.54928377309936, 140.49284873804018, 132.4093291775614, 45.912166974191315, 22.33674422636465, 15.103793383581744, 21.57433777062845, 102.19686117027929, 24.12240593476018, 3.6036290974987004, 0.16433351664063273, 26.756230870988645, 15.408651513051213, 39.23843628278093, 46.65229798752467, 59.99165380277625, 25.591834722498987, 30.060595195832324, 4.559090702552424, 54.69471129783873, 1.648341543304093, 38.72311232754358, 23.878383364999824, 39.743679206943455, 17.539798299803618, 29.420096486512627, 19.000982994257004, 19.162753293657524, 10.393901430750708, 100.09298219981717, 102.80722048531963, 29.75741924952542, 39.098999758186416, 1.8890920983311756, 3.861833106483426, 18.761526333637864, 23.51893035282531, 0.5153766345821496, 8.339080518145149, 44.14356718055584, 11.912262361549175, 32.96621257710022, 30.516804355508174, 0.3837648745940641, 0.0, 11.315470731848663, 10.748762720740158, 24.674192807547424, 17.4538744332174, 23.546251115979665, 60.86501034462103, 29.095232977662636, 92.3500239816642, 34.720548955647004, 40.78951626218394, 30.03227043371739, 50.96152136891413, 10.292182207932965, 10.679385852164476, 18.448667093494333, 20.1580864053007, 14.511350482928496, 13.005560044026685, 69.4141193384506, 64.35720631890848, 27.29519028330629, 13.925825513456466, 10.817769547753148, 19.21597271443025, 7.474638771873021, 43.32699626763453, 20.388264052819306, 63.628743745275884, 90.83415500564806, 20.6093863567239, 14.213217199019704, 2.556997615619628, 8.030908541024763, 8.217774664400963, 60.47129313616719, 38.94651268882082, 6.228234090432254, 14.587710481633692, 15.59094514817899, 21.070266003301516, 8.339388248029174, 18.352374838159086, 10.663049687925083, 23.204298052664996, 19.1103769695507, 94.3919478039934, 8.655604332960275, 4.224527517262635, 4.262541055457616, 34.79260565794471, 0.34300448240054965, 0.0, 45.1290813033688, 44.16336888936213, 9.979880090784095, 5.6769872776581805, 95.07373877509427, 30.350687272124357, 28.52358928875335, 12.662031511001445, 8.09763410593108, 12.484097668557581, 5.788393989939931, 5.394739477864461, 0.0, 2.013920337002237, 15.292352598396052, 12.135472072539445, 18.45952983695562, 38.64155427105917, 26.63562283743937, 22.227701769678365, 10.241591739806902, 15.5655482942585, 24.95837715341531, 19.78170283797561, 76.57806261816219, 101.09172014352869, 7.9497694761925874, 30.209122809126953, 0.0, 0.0, 20.750865423562313, 7.937093317036358, 6.398381571752147, 5.818119117961441, 7.931777960782617, 8.24701162815344, 13.931228365949549, 5.2331730720006515, 15.199652105984125, 10.087196971589556, 0.0, 0.6578575190427157, 19.187529308329186, 15.421562244109253, 16.88842076087991, 35.31000294283925, 2.93872772791894, 6.307630294388363, 6.820234095891159, 4.748928304872467, 2.6473897159104345, 4.556188862378443]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.2705169631922213, "mean_inference_ms": 5.875015149012777, "mean_action_processing_ms": 0.9770640062985839, "mean_env_wait_ms": 0.7710673921344892, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018703103065490723, "StateBufferConnector_ms": 0.011749505996704102, "ViewRequirementAgentConnector_ms": 0.3507148027420044}, "num_episodes": 23, "episode_return_max": 250.86400695036463, "episode_return_min": -28.08351550139593, "episode_return_mean": 25.74239887978711, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1312000, "num_agent_steps_trained": 1312000, "num_env_steps_sampled": 328000, "num_env_steps_trained": 328000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 259.5047154015311, "num_env_steps_trained_throughput_per_sec": 259.5047154015311, "timesteps_total": 328000, "num_env_steps_sampled_lifetime": 328000, "num_agent_steps_sampled_lifetime": 1312000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1312000, "timers": {"training_iteration_time_ms": 15931.122, "restore_workers_time_ms": 0.014, "training_step_time_ms": 15931.078, "sample_time_ms": 4243.038, "learn_time_ms": 11671.752, "learn_throughput": 342.708, "synch_weights_time_ms": 15.288}, "counters": {"num_env_steps_sampled": 328000, "num_env_steps_trained": 328000, "num_agent_steps_sampled": 1312000, "num_agent_steps_trained": 1312000}, "done": false, "training_iteration": 82, "trial_id": "d163c_00000", "date": "2024-08-16_13-20-55", "timestamp": 1723794655, "time_this_iter_s": 15.418623924255371, "time_total_s": 1873.8586683273315, "pid": 81201, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16ba2a5e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1873.8586683273315, "iterations_since_restore": 82, "perf": {"cpu_util_percent": 29.286363636363635, "ram_util_percent": 70.14545454545453}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.754262775561166, "cur_kl_coeff": 0.0006591796875, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.0758129885430059, "policy_loss": -0.004561584059607297, "vf_loss": 1.080369552764943, "vf_explained_var": 0.34192365754849063, "kl": 0.007618085609534453, "entropy": 0.4102942334281074, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 155925.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.669417199161318, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.9237950667344704, "policy_loss": -0.008393712126139907, "vf_loss": 0.931328336255891, "vf_explained_var": 0.18220994119290954, "kl": 0.008604435360088602, "entropy": 1.0981315532058635, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 155925.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 332000, "num_env_steps_trained": 332000, "num_agent_steps_sampled": 1328000, "num_agent_steps_trained": 1328000}, "env_runners": {"episode_reward_max": 78.45087601553564, "episode_reward_min": -28.08351550139593, "episode_reward_mean": 18.935341839870187, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -166.04093147675673, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 45.55999999999969, "predator_policy": 140.49284873804018}, "policy_reward_mean": {"prey_policy": -15.372421210909387, "predator_policy": 24.840092130844482}, "custom_metrics": {}, "hist_stats": {"episode_reward": [28.08197542008886, 24.45282718255738, 5.83657826982544, 59.75323190282972, 14.352736616820813, 11.011951849962172, 14.577020102800972, 51.37156493734259, 78.45087601553564, -6.653400383893775, 35.15282499344263, 56.79687479218705, 4.034333516640591, 28.286440686795157, 18.38231267168854, 8.956392516954239, 41.43999999999991, 9.886966043596939, 58.520465311495656, 15.552033419469309, 29.68143197772388, 35.60651048256594, 23.761354933367436, 20.590229233784484, 3.391314300502632, 19.45549628851448, 3.3766719784231696, 19.83222817063578, 41.206679365410395, 3.979999999999959, 21.68255314475465, 11.780096574928304, -28.08351550139593, 41.50417202837007, 23.946488244917244, 27.245176545739643, 43.34834295612938, 2.940196319839803, 26.864599106946006, 64.60669804368592, 30.237783219621857, 14.408926491186687, 9.700347555166763, 20.557807523051437, 7.616225860590908, 0.12472635987704624, 8.48904551675506, 41.66229831267831, 7.342528339805998, 8.610263189674543, 5.683623066724021, 10.593592231645571, 34.141466470329924, 9.677966290925118, 6.111488343089647, 3.979999999999959, 18.66190872176289, 52.896987277657544, 29.80332899460931, 11.655040095207946, 27.913855678476963, 24.284630552497863, 3.899999999999961, 1.7933146066960117, 19.938964205762833, 21.97266798051301, 18.150000000000315, 24.83449841971963, 10.827183565649946, 5.670184098254684, 7.959999999999916, 12.223423441295793, 31.2205399080942, 7.500594454225256, 8.362038856924741, 13.43894396294967, 19.36755886235521, 31.364005559068012, 7.7096606565205, 6.5731927696413965, 6.127732838083455, 6.497389715910355, -26.258988322999606, 22.88593736074813, 12.672432988814542, 5.539808085388262, 15.16378074893645, 7.707183187817657, 9.589110333852616, 9.567495040981031, 34.14840183006248, 3.8799999999999613, 12.540524076713137, 13.61966494122474, 22.97762763608867, 21.597417832877213, 31.737348651849107, 4.958323727958341, 32.60999579796562, 14.051656014757185], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-4.677637230432293, -126.20419481737504, -29.04716743069844, -15.78467514932845, -34.785359217859586, -42.76696331014283, 13.243172287173088, -45.436003019387464, -12.090731492813504, -31.809876571501306, 2.0000000000000013, -13.472548760474494, -16.613483794235353, 1.8312671281158635, 1.6495802328169216, -121.11553025092113, -28.41037042330886, -166.04093147675673, -46.76367009971623, -28.138641484733466, 1.5155829603361906, -3.0408891211035263, -29.19059989703716, -40.33179241581474, 2.0000000000000013, -1.7336290974987343, -5.078844277622766, -8.799597419622375, -69.50842159861685, 2.0000000000000013, -37.003924474394104, -39.62317153392733, 9.459404804167747, -2.6390907025524646, 2.0000000000000013, -48.45608679754611, -1.888808790365133, -2.1922215906822644, -6.962318836169855, -34.76912525110812, 5.13846518223187, -23.878112685277873, -5.797048001539502, 11.84690375969774, -157.95037471509133, -21.188473036678477, -27.4794367094091, -20.78675306451823, -0.3877777978285204, -1.9718331064834655, 2.0000000000000013, -24.8249603979489, -6.559080518145187, 1.0812953438410489, -21.208263124908843, -15.015338246560516, 1.5132639807755757, -23.78960154797303, 1.5962351254059373, 2.0000000000000013, -0.5028089183299156, 0.12112861049519404, 1.5661415782132437, -31.914112244049942, -60.522907753603796, -51.97186920839296, -81.9410849309557, 2.0000000000000013, -50.561908375548015, -1.0016685973663697, -52.104811157836735, -1.6438040990557492, 18.145706117932683, 4.231068778100079, -18.388086405300424, -17.27847077365432, 4.789234890661308, -5.441546310671003, -3.984020789117082, -65.18060682455597, -3.3269151582610474, -7.656317418880409, -17.624815770996378, 2.0000000000000013, -43.10128748434101, 2.0000000000000013, -41.12065392619643, -22.338546348847842, -89.36192513171297, -14.465390370067352, -4.062271255742597, -12.583217199019737, -5.966398787577818, -1.7932389010928447, 2.0000000000000013, -59.755507512309336, -14.141541696729442, 0.6681254644695312, -6.788213988417898, -21.26273397338783, -17.2784906018976, -3.7296494175663923, -11.3857912972431, -11.88796421170138, 14.860743804782853, -94.22160210799602, -5.202165559297751, 2.0000000000000013, -34.94365837031291, 2.0000000000000013, 1.6369955175994517, 2.0000000000000013, -42.276727772575235, -28.353813698393303, -8.31988009078413, 45.55999999999969, -68.64724971944398, -26.97384733316501, -11.88329173720441, -17.64728896734272, 5.332123903987776, 2.0000000000000013, -6.089788126865809, 19.19128521155898, -0.11392033700223506, 2.0000000000000013, -15.371260286106287, -10.263249778133106, 2.0000000000000013, -39.16211990225282, -26.876642900122853, -0.014013726482111322, -8.491591739806937, 0.8344517057415021, -15.272572809335122, -4.633008762336535, -69.95612202994361, -96.8864771660972, -29.427481312230928, -3.06122687483362, 5.959999999999958, 2.0000000000000013, 4.969999999999958, -21.43453529930256, -0.036239151840953825, 19.0402783702213, -9.736373412491252, 1.058178277780488, -12.251228365949585, 1.4488657849241664, 2.0000000000000013, -13.847905114623972, 17.17981717941242, 1.5298841638997274, 12.025776997412104, -15.270862990782986, -10.59729318878288, -33.891469858416045, 2.0000000000000013, -4.673165252665866, 1.771609397936964, -7.213038960617094, -2.7061888623784824, 2.0000000000000013, -46.26202001036704, -48.84049132395384, -16.17789862831482, -4.320821393888375, -21.03535772695846, 3.6654260572747717, 1.7823909998282816, -1.4220747606245454, -24.023900130570546, 1.1347371099017134, 1.65205452657184, -5.327150679949399, 2.0000000000000013, -26.23863387169444, -34.359240514946194, -27.73012029945264, 19.820000000000285, -19.559065723775266, 1.18495411707935, -3.744797415661786, -1.6695268892935147, -13.229299909232754, -13.461263222412411, 1.0885024562337955, 16.843421862475587, 2.8338565313596082, 2.0000000000000013, -9.720009242064743, 21.425463611896763, -7.506323382543, -0.41152724132346896, -8.716167705785173, -6.31084018984793, 24.814714665223764, -4.8714309233354784, -7.559151800965436], "policy_predator_policy_reward": [92.13988859727955, 66.82391887061664, 36.35822434424423, 32.92644541834007, 50.08797194458668, 33.300928853240784, 59.010717256288125, 32.9353453787563, 26.418209595501846, 31.83513508563362, 8.908938710040847, 13.575561900395865, 10.225521812633875, 19.133714956286873, 98.2882311823483, 72.54928377309936, 140.49284873804018, 132.4093291775614, 45.912166974191315, 22.33674422636465, 15.103793383581744, 21.57433777062845, 102.19686117027929, 24.12240593476018, 3.6036290974987004, 0.16433351664063273, 26.756230870988645, 15.408651513051213, 39.23843628278093, 46.65229798752467, 59.99165380277625, 25.591834722498987, 30.060595195832324, 4.559090702552424, 54.69471129783873, 1.648341543304093, 38.72311232754358, 23.878383364999824, 39.743679206943455, 17.539798299803618, 29.420096486512627, 19.000982994257004, 19.162753293657524, 10.393901430750708, 100.09298219981717, 102.80722048531963, 29.75741924952542, 39.098999758186416, 1.8890920983311756, 3.861833106483426, 18.761526333637864, 23.51893035282531, 0.5153766345821496, 8.339080518145149, 44.14356718055584, 11.912262361549175, 32.96621257710022, 30.516804355508174, 0.3837648745940641, 0.0, 11.315470731848663, 10.748762720740158, 24.674192807547424, 17.4538744332174, 23.546251115979665, 60.86501034462103, 29.095232977662636, 92.3500239816642, 34.720548955647004, 40.78951626218394, 30.03227043371739, 50.96152136891413, 10.292182207932965, 10.679385852164476, 18.448667093494333, 20.1580864053007, 14.511350482928496, 13.005560044026685, 69.4141193384506, 64.35720631890848, 27.29519028330629, 13.925825513456466, 10.817769547753148, 19.21597271443025, 7.474638771873021, 43.32699626763453, 20.388264052819306, 63.628743745275884, 90.83415500564806, 20.6093863567239, 14.213217199019704, 2.556997615619628, 8.030908541024763, 8.217774664400963, 60.47129313616719, 38.94651268882082, 6.228234090432254, 14.587710481633692, 15.59094514817899, 21.070266003301516, 8.339388248029174, 18.352374838159086, 10.663049687925083, 23.204298052664996, 19.1103769695507, 94.3919478039934, 8.655604332960275, 4.224527517262635, 4.262541055457616, 34.79260565794471, 0.34300448240054965, 0.0, 45.1290813033688, 44.16336888936213, 9.979880090784095, 5.6769872776581805, 95.07373877509427, 30.350687272124357, 28.52358928875335, 12.662031511001445, 8.09763410593108, 12.484097668557581, 5.788393989939931, 5.394739477864461, 0.0, 2.013920337002237, 15.292352598396052, 12.135472072539445, 18.45952983695562, 38.64155427105917, 26.63562283743937, 22.227701769678365, 10.241591739806902, 15.5655482942585, 24.95837715341531, 19.78170283797561, 76.57806261816219, 101.09172014352869, 7.9497694761925874, 30.209122809126953, 0.0, 0.0, 20.750865423562313, 7.937093317036358, 6.398381571752147, 5.818119117961441, 7.931777960782617, 8.24701162815344, 13.931228365949549, 5.2331730720006515, 15.199652105984125, 10.087196971589556, 0.0, 0.6578575190427157, 19.187529308329186, 15.421562244109253, 16.88842076087991, 35.31000294283925, 2.93872772791894, 6.307630294388363, 6.820234095891159, 4.748928304872467, 2.6473897159104345, 4.556188862378443, 57.88514526578232, 10.95837774553898, 10.449769096418732, 32.93488828653232, 3.107584102808767, 26.934780555689734, 2.9206820441635757, 2.2588098020209983, 7.169053133012236, 30.883890636593378, 5.573456284396907, 5.808823056798352, 27.92731297533998, 5.900431230207433, 27.75713712251876, 43.89971873286104, 13.170226795463604, 20.717240758374622, 5.654797415661745, 0.7850458829206513, 12.938827891679876, 14.50052298355953, 22.147059865702253, 3.845365841701131, 1.4237711047284858, 1.8765781375245243, 15.40075176697823, 13.916675307963217, 9.18853244024564, 8.629675982249399, 9.155549702738922, 4.930468972328079, 10.411924243250459, 3.6941970793392307, 13.348375725920954, 13.133863013137145]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.2672886987107286, "mean_inference_ms": 5.867128196677294, "mean_action_processing_ms": 0.9760941630234069, "mean_env_wait_ms": 0.7697065210779516, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02912580966949463, "StateBufferConnector_ms": 0.011966824531555176, "ViewRequirementAgentConnector_ms": 0.35241520404815674}, "num_episodes": 18, "episode_return_max": 78.45087601553564, "episode_return_min": -28.08351550139593, "episode_return_mean": 18.935341839870187, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1328000, "num_agent_steps_trained": 1328000, "num_env_steps_sampled": 332000, "num_env_steps_trained": 332000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 270.47431300940997, "num_env_steps_trained_throughput_per_sec": 270.47431300940997, "timesteps_total": 332000, "num_env_steps_sampled_lifetime": 332000, "num_agent_steps_sampled_lifetime": 1328000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1328000, "timers": {"training_iteration_time_ms": 15827.926, "restore_workers_time_ms": 0.015, "training_step_time_ms": 15827.882, "sample_time_ms": 4219.69, "learn_time_ms": 11591.943, "learn_throughput": 345.067, "synch_weights_time_ms": 15.197}, "counters": {"num_env_steps_sampled": 332000, "num_env_steps_trained": 332000, "num_agent_steps_sampled": 1328000, "num_agent_steps_trained": 1328000}, "done": false, "training_iteration": 83, "trial_id": "d163c_00000", "date": "2024-08-16_13-21-09", "timestamp": 1723794669, "time_this_iter_s": 14.792453050613403, "time_total_s": 1888.651121377945, "pid": 81201, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16ba27e50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1888.651121377945, "iterations_since_restore": 83, "perf": {"cpu_util_percent": 27.576190476190483, "ram_util_percent": 69.6190476190476}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.7256553034618416, "cur_kl_coeff": 0.0006591796875, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.8852052452703, "policy_loss": -0.00134204353979498, "vf_loss": 1.8865450052987962, "vf_explained_var": 0.14579864607916937, "kl": 0.003463071475145586, "entropy": 0.41308020671839435, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 157815.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.4856406628454804, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.5653438321497075, "policy_loss": -0.006242664499829213, "vf_loss": 1.5709925213818827, "vf_explained_var": 0.13620435377908133, "kl": 0.005939779094847379, "entropy": 1.1091568488292594, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 157815.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_agent_steps_sampled": 1344000, "num_agent_steps_trained": 1344000}, "env_runners": {"episode_reward_max": 64.60669804368592, "episode_reward_min": -28.08351550139593, "episode_reward_mean": 16.57949011826529, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -157.95037471509133, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 45.55999999999969, "predator_policy": 102.80722048531963}, "policy_reward_mean": {"prey_policy": -11.662778284060618, "predator_policy": 19.95252334319325}, "custom_metrics": {}, "hist_stats": {"episode_reward": [58.520465311495656, 15.552033419469309, 29.68143197772388, 35.60651048256594, 23.761354933367436, 20.590229233784484, 3.391314300502632, 19.45549628851448, 3.3766719784231696, 19.83222817063578, 41.206679365410395, 3.979999999999959, 21.68255314475465, 11.780096574928304, -28.08351550139593, 41.50417202837007, 23.946488244917244, 27.245176545739643, 43.34834295612938, 2.940196319839803, 26.864599106946006, 64.60669804368592, 30.237783219621857, 14.408926491186687, 9.700347555166763, 20.557807523051437, 7.616225860590908, 0.12472635987704624, 8.48904551675506, 41.66229831267831, 7.342528339805998, 8.610263189674543, 5.683623066724021, 10.593592231645571, 34.141466470329924, 9.677966290925118, 6.111488343089647, 3.979999999999959, 18.66190872176289, 52.896987277657544, 29.80332899460931, 11.655040095207946, 27.913855678476963, 24.284630552497863, 3.899999999999961, 1.7933146066960117, 19.938964205762833, 21.97266798051301, 18.150000000000315, 24.83449841971963, 10.827183565649946, 5.670184098254684, 7.959999999999916, 12.223423441295793, 31.2205399080942, 7.500594454225256, 8.362038856924741, 13.43894396294967, 19.36755886235521, 31.364005559068012, 7.7096606565205, 6.5731927696413965, 6.127732838083455, 6.497389715910355, -26.258988322999606, 22.88593736074813, 12.672432988814542, 5.539808085388262, 15.16378074893645, 7.707183187817657, 9.589110333852616, 9.567495040981031, 34.14840183006248, 3.8799999999999613, 12.540524076713137, 13.61966494122474, 22.97762763608867, 21.597417832877213, 31.737348651849107, 4.958323727958341, 32.60999579796562, 14.051656014757185, 7.103595805143655, 18.754638274327107, 3.533239211912964, 23.950805784011894, 13.255195118605776, 30.19335417314152, 3.9599999999999596, 5.785940122060753, 3.989999999999959, 0.3907107250465454, 4.496833387601783, -7.955500830764439, 20.250556171087574, 16.073065510361694, 36.89461979624596, 16.64217304875011, 27.159217756449852, 24.107890920702463], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-1.888808790365133, -2.1922215906822644, -6.962318836169855, -34.76912525110812, 5.13846518223187, -23.878112685277873, -5.797048001539502, 11.84690375969774, -157.95037471509133, -21.188473036678477, -27.4794367094091, -20.78675306451823, -0.3877777978285204, -1.9718331064834655, 2.0000000000000013, -24.8249603979489, -6.559080518145187, 1.0812953438410489, -21.208263124908843, -15.015338246560516, 1.5132639807755757, -23.78960154797303, 1.5962351254059373, 2.0000000000000013, -0.5028089183299156, 0.12112861049519404, 1.5661415782132437, -31.914112244049942, -60.522907753603796, -51.97186920839296, -81.9410849309557, 2.0000000000000013, -50.561908375548015, -1.0016685973663697, -52.104811157836735, -1.6438040990557492, 18.145706117932683, 4.231068778100079, -18.388086405300424, -17.27847077365432, 4.789234890661308, -5.441546310671003, -3.984020789117082, -65.18060682455597, -3.3269151582610474, -7.656317418880409, -17.624815770996378, 2.0000000000000013, -43.10128748434101, 2.0000000000000013, -41.12065392619643, -22.338546348847842, -89.36192513171297, -14.465390370067352, -4.062271255742597, -12.583217199019737, -5.966398787577818, -1.7932389010928447, 2.0000000000000013, -59.755507512309336, -14.141541696729442, 0.6681254644695312, -6.788213988417898, -21.26273397338783, -17.2784906018976, -3.7296494175663923, -11.3857912972431, -11.88796421170138, 14.860743804782853, -94.22160210799602, -5.202165559297751, 2.0000000000000013, -34.94365837031291, 2.0000000000000013, 1.6369955175994517, 2.0000000000000013, -42.276727772575235, -28.353813698393303, -8.31988009078413, 45.55999999999969, -68.64724971944398, -26.97384733316501, -11.88329173720441, -17.64728896734272, 5.332123903987776, 2.0000000000000013, -6.089788126865809, 19.19128521155898, -0.11392033700223506, 2.0000000000000013, -15.371260286106287, -10.263249778133106, 2.0000000000000013, -39.16211990225282, -26.876642900122853, -0.014013726482111322, -8.491591739806937, 0.8344517057415021, -15.272572809335122, -4.633008762336535, -69.95612202994361, -96.8864771660972, -29.427481312230928, -3.06122687483362, 5.959999999999958, 2.0000000000000013, 4.969999999999958, -21.43453529930256, -0.036239151840953825, 19.0402783702213, -9.736373412491252, 1.058178277780488, -12.251228365949585, 1.4488657849241664, 2.0000000000000013, -13.847905114623972, 17.17981717941242, 1.5298841638997274, 12.025776997412104, -15.270862990782986, -10.59729318878288, -33.891469858416045, 2.0000000000000013, -4.673165252665866, 1.771609397936964, -7.213038960617094, -2.7061888623784824, 2.0000000000000013, -46.26202001036704, -48.84049132395384, -16.17789862831482, -4.320821393888375, -21.03535772695846, 3.6654260572747717, 1.7823909998282816, -1.4220747606245454, -24.023900130570546, 1.1347371099017134, 1.65205452657184, -5.327150679949399, 2.0000000000000013, -26.23863387169444, -34.359240514946194, -27.73012029945264, 19.820000000000285, -19.559065723775266, 1.18495411707935, -3.744797415661786, -1.6695268892935147, -13.229299909232754, -13.461263222412411, 1.0885024562337955, 16.843421862475587, 2.8338565313596082, 2.0000000000000013, -9.720009242064743, 21.425463611896763, -7.506323382543, -0.41152724132346896, -8.716167705785173, -6.31084018984793, 24.814714665223764, -4.8714309233354784, -7.559151800965436, -5.141464746863769, 0.5764164691441905, 12.88999999999996, -4.9689918523670835, -2.302360797309377, -19.79189234550408, 11.89999999999996, -14.0010609930699, -18.39392084847859, 2.0000000000000013, 3.946544832144189, -8.908318573699939, 2.0000000000000013, 0.7528847400458202, -4.157503525240529, 2.0000000000000013, 2.0000000000000013, 1.8179757072804255, -53.48978904724069, -53.35615372109932, 1.1865192245248817, -7.564629928613286, -69.1068844400347, -63.688701427711294, 2.0000000000000013, -2.3750007887557354, 1.4301223057241095, -12.428921868261222, -1.408914937861283, 25.807587973929785, -1.2499784493075703, -9.563714594176473, 6.4362965441475, -7.490343927368391, -0.5425723521788597, 12.250532285143771], "policy_predator_policy_reward": [38.72311232754358, 23.878383364999824, 39.743679206943455, 17.539798299803618, 29.420096486512627, 19.000982994257004, 19.162753293657524, 10.393901430750708, 100.09298219981717, 102.80722048531963, 29.75741924952542, 39.098999758186416, 1.8890920983311756, 3.861833106483426, 18.761526333637864, 23.51893035282531, 0.5153766345821496, 8.339080518145149, 44.14356718055584, 11.912262361549175, 32.96621257710022, 30.516804355508174, 0.3837648745940641, 0.0, 11.315470731848663, 10.748762720740158, 24.674192807547424, 17.4538744332174, 23.546251115979665, 60.86501034462103, 29.095232977662636, 92.3500239816642, 34.720548955647004, 40.78951626218394, 30.03227043371739, 50.96152136891413, 10.292182207932965, 10.679385852164476, 18.448667093494333, 20.1580864053007, 14.511350482928496, 13.005560044026685, 69.4141193384506, 64.35720631890848, 27.29519028330629, 13.925825513456466, 10.817769547753148, 19.21597271443025, 7.474638771873021, 43.32699626763453, 20.388264052819306, 63.628743745275884, 90.83415500564806, 20.6093863567239, 14.213217199019704, 2.556997615619628, 8.030908541024763, 8.217774664400963, 60.47129313616719, 38.94651268882082, 6.228234090432254, 14.587710481633692, 15.59094514817899, 21.070266003301516, 8.339388248029174, 18.352374838159086, 10.663049687925083, 23.204298052664996, 19.1103769695507, 94.3919478039934, 8.655604332960275, 4.224527517262635, 4.262541055457616, 34.79260565794471, 0.34300448240054965, 0.0, 45.1290813033688, 44.16336888936213, 9.979880090784095, 5.6769872776581805, 95.07373877509427, 30.350687272124357, 28.52358928875335, 12.662031511001445, 8.09763410593108, 12.484097668557581, 5.788393989939931, 5.394739477864461, 0.0, 2.013920337002237, 15.292352598396052, 12.135472072539445, 18.45952983695562, 38.64155427105917, 26.63562283743937, 22.227701769678365, 10.241591739806902, 15.5655482942585, 24.95837715341531, 19.78170283797561, 76.57806261816219, 101.09172014352869, 7.9497694761925874, 30.209122809126953, 0.0, 0.0, 20.750865423562313, 7.937093317036358, 6.398381571752147, 5.818119117961441, 7.931777960782617, 8.24701162815344, 13.931228365949549, 5.2331730720006515, 15.199652105984125, 10.087196971589556, 0.0, 0.6578575190427157, 19.187529308329186, 15.421562244109253, 16.88842076087991, 35.31000294283925, 2.93872772791894, 6.307630294388363, 6.820234095891159, 4.748928304872467, 2.6473897159104345, 4.556188862378443, 57.88514526578232, 10.95837774553898, 10.449769096418732, 32.93488828653232, 3.107584102808767, 26.934780555689734, 2.9206820441635757, 2.2588098020209983, 7.169053133012236, 30.883890636593378, 5.573456284396907, 5.808823056798352, 27.92731297533998, 5.900431230207433, 27.75713712251876, 43.89971873286104, 13.170226795463604, 20.717240758374622, 5.654797415661745, 0.7850458829206513, 12.938827891679876, 14.50052298355953, 22.147059865702253, 3.845365841701131, 1.4237711047284858, 1.8765781375245243, 15.40075176697823, 13.916675307963217, 9.18853244024564, 8.629675982249399, 9.155549702738922, 4.930468972328079, 10.411924243250459, 3.6941970793392307, 13.348375725920954, 13.133863013137145, 2.86717933599954, 8.801464746863735, 5.298094182977373, 5.535535943716365, 10.822635637439635, 14.804856717287048, 14.795052158872927, 11.256814618208338, 10.363690405325617, 19.285425561759098, 14.845881168390823, 20.309246746305956, 0.0, 1.2071152599541812, 5.75754834191798, 2.1858953053833403, 0.17202429271957592, 0.0, 34.199139244312676, 73.03751424907398, 1.530314163076955, 9.344629928613248, 82.6298970916669, 42.21018794531471, 12.135706380663207, 8.489850579179553, 6.127270793930175, 20.944594278968655, 6.306694588806379, 6.189252171371831, 12.663990667959368, 14.79187542427469, 17.482197274127504, 10.731067865542693, 6.103715132465197, 6.296215855271781]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.2645933174504806, "mean_inference_ms": 5.859833847785583, "mean_action_processing_ms": 0.9750533537655974, "mean_env_wait_ms": 0.7683879161468852, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.028993606567382812, "StateBufferConnector_ms": 0.012863755226135254, "ViewRequirementAgentConnector_ms": 0.3210943937301636}, "num_episodes": 18, "episode_return_max": 64.60669804368592, "episode_return_min": -28.08351550139593, "episode_return_mean": 16.57949011826529, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1344000, "num_agent_steps_trained": 1344000, "num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 243.69698012097655, "num_env_steps_trained_throughput_per_sec": 243.69698012097655, "timesteps_total": 336000, "num_env_steps_sampled_lifetime": 336000, "num_agent_steps_sampled_lifetime": 1344000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1344000, "timers": {"training_iteration_time_ms": 15898.897, "restore_workers_time_ms": 0.014, "training_step_time_ms": 15898.854, "sample_time_ms": 4213.14, "learn_time_ms": 11669.321, "learn_throughput": 342.779, "synch_weights_time_ms": 15.36}, "counters": {"num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_agent_steps_sampled": 1344000, "num_agent_steps_trained": 1344000}, "done": false, "training_iteration": 84, "trial_id": "d163c_00000", "date": "2024-08-16_13-21-26", "timestamp": 1723794686, "time_this_iter_s": 16.418127298355103, "time_total_s": 1905.0692486763, "pid": 81201, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16b879550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1905.0692486763, "iterations_since_restore": 84, "perf": {"cpu_util_percent": 29.686956521739134, "ram_util_percent": 69.94782608695652}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.177699545830015, "cur_kl_coeff": 0.00032958984375, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.4550150371417798, "policy_loss": -0.0059388729857611, "vf_loss": 1.4609519734584466, "vf_explained_var": 0.16416094252672145, "kl": 0.005872793248746533, "entropy": 0.36507570439230197, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 159705.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.70752308337146, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.7485906444529378, "policy_loss": -0.004786435187986446, "vf_loss": 1.7527151767538969, "vf_explained_var": 0.30785424545328455, "kl": 0.006618990785101389, "entropy": 1.1068820364891536, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 159705.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 340000, "num_env_steps_trained": 340000, "num_agent_steps_sampled": 1360000, "num_agent_steps_trained": 1360000}, "env_runners": {"episode_reward_max": 66.60640733638623, "episode_reward_min": -26.258988322999606, "episode_reward_mean": 15.125795592402257, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -96.8864771660972, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 45.55999999999969, "predator_policy": 101.09172014352869}, "policy_reward_mean": {"prey_policy": -8.113186941573082, "predator_policy": 15.676084737774193}, "custom_metrics": {}, "hist_stats": {"episode_reward": [30.237783219621857, 14.408926491186687, 9.700347555166763, 20.557807523051437, 7.616225860590908, 0.12472635987704624, 8.48904551675506, 41.66229831267831, 7.342528339805998, 8.610263189674543, 5.683623066724021, 10.593592231645571, 34.141466470329924, 9.677966290925118, 6.111488343089647, 3.979999999999959, 18.66190872176289, 52.896987277657544, 29.80332899460931, 11.655040095207946, 27.913855678476963, 24.284630552497863, 3.899999999999961, 1.7933146066960117, 19.938964205762833, 21.97266798051301, 18.150000000000315, 24.83449841971963, 10.827183565649946, 5.670184098254684, 7.959999999999916, 12.223423441295793, 31.2205399080942, 7.500594454225256, 8.362038856924741, 13.43894396294967, 19.36755886235521, 31.364005559068012, 7.7096606565205, 6.5731927696413965, 6.127732838083455, 6.497389715910355, -26.258988322999606, 22.88593736074813, 12.672432988814542, 5.539808085388262, 15.16378074893645, 7.707183187817657, 9.589110333852616, 9.567495040981031, 34.14840183006248, 3.8799999999999613, 12.540524076713137, 13.61966494122474, 22.97762763608867, 21.597417832877213, 31.737348651849107, 4.958323727958341, 32.60999579796562, 14.051656014757185, 7.103595805143655, 18.754638274327107, 3.533239211912964, 23.950805784011894, 13.255195118605776, 30.19335417314152, 3.9599999999999596, 5.785940122060753, 3.989999999999959, 0.3907107250465454, 4.496833387601783, -7.955500830764439, 20.250556171087574, 16.073065510361694, 36.89461979624596, 16.64217304875011, 27.159217756449852, 24.107890920702463, 1.7666222259095201, -23.58344091635487, 42.85550582077098, 3.7564665634648926, 23.169661673307555, 27.855634516201054, 3.704197818018399, 47.02251228652955, -22.602990521147454, 27.938218636799743, 11.839999999999918, 3.3609477540779378, 50.327623059128356, 44.696858172032314, 22.841334654950533, 3.7699999999999645, 4.51314031065465, 0.4970061956219977, 10.898752445510818, 11.132712856424252, 66.60640733638623, 3.052599451218678], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-3.3269151582610474, -7.656317418880409, -17.624815770996378, 2.0000000000000013, -43.10128748434101, 2.0000000000000013, -41.12065392619643, -22.338546348847842, -89.36192513171297, -14.465390370067352, -4.062271255742597, -12.583217199019737, -5.966398787577818, -1.7932389010928447, 2.0000000000000013, -59.755507512309336, -14.141541696729442, 0.6681254644695312, -6.788213988417898, -21.26273397338783, -17.2784906018976, -3.7296494175663923, -11.3857912972431, -11.88796421170138, 14.860743804782853, -94.22160210799602, -5.202165559297751, 2.0000000000000013, -34.94365837031291, 2.0000000000000013, 1.6369955175994517, 2.0000000000000013, -42.276727772575235, -28.353813698393303, -8.31988009078413, 45.55999999999969, -68.64724971944398, -26.97384733316501, -11.88329173720441, -17.64728896734272, 5.332123903987776, 2.0000000000000013, -6.089788126865809, 19.19128521155898, -0.11392033700223506, 2.0000000000000013, -15.371260286106287, -10.263249778133106, 2.0000000000000013, -39.16211990225282, -26.876642900122853, -0.014013726482111322, -8.491591739806937, 0.8344517057415021, -15.272572809335122, -4.633008762336535, -69.95612202994361, -96.8864771660972, -29.427481312230928, -3.06122687483362, 5.959999999999958, 2.0000000000000013, 4.969999999999958, -21.43453529930256, -0.036239151840953825, 19.0402783702213, -9.736373412491252, 1.058178277780488, -12.251228365949585, 1.4488657849241664, 2.0000000000000013, -13.847905114623972, 17.17981717941242, 1.5298841638997274, 12.025776997412104, -15.270862990782986, -10.59729318878288, -33.891469858416045, 2.0000000000000013, -4.673165252665866, 1.771609397936964, -7.213038960617094, -2.7061888623784824, 2.0000000000000013, -46.26202001036704, -48.84049132395384, -16.17789862831482, -4.320821393888375, -21.03535772695846, 3.6654260572747717, 1.7823909998282816, -1.4220747606245454, -24.023900130570546, 1.1347371099017134, 1.65205452657184, -5.327150679949399, 2.0000000000000013, -26.23863387169444, -34.359240514946194, -27.73012029945264, 19.820000000000285, -19.559065723775266, 1.18495411707935, -3.744797415661786, -1.6695268892935147, -13.229299909232754, -13.461263222412411, 1.0885024562337955, 16.843421862475587, 2.8338565313596082, 2.0000000000000013, -9.720009242064743, 21.425463611896763, -7.506323382543, -0.41152724132346896, -8.716167705785173, -6.31084018984793, 24.814714665223764, -4.8714309233354784, -7.559151800965436, -5.141464746863769, 0.5764164691441905, 12.88999999999996, -4.9689918523670835, -2.302360797309377, -19.79189234550408, 11.89999999999996, -14.0010609930699, -18.39392084847859, 2.0000000000000013, 3.946544832144189, -8.908318573699939, 2.0000000000000013, 0.7528847400458202, -4.157503525240529, 2.0000000000000013, 2.0000000000000013, 1.8179757072804255, -53.48978904724069, -53.35615372109932, 1.1865192245248817, -7.564629928613286, -69.1068844400347, -63.688701427711294, 2.0000000000000013, -2.3750007887557354, 1.4301223057241095, -12.428921868261222, -1.408914937861283, 25.807587973929785, -1.2499784493075703, -9.563714594176473, 6.4362965441475, -7.490343927368391, -0.5425723521788597, 12.250532285143771, -1.2984631844155097, -10.411906260008665, -37.85029062762343, -39.434851144007496, -3.6055574225215166, 8.963263847253224, -1.611496454768402, -0.6730731634254583, 11.633543098963441, 2.0000000000000013, -3.286221496898711, 24.770000000000277, -5.881119984984494, -7.4636721255128275, 39.81502602055248, 0.4565747424642245, -32.57118246539091, -40.89596836011974, -27.658477377296816, 15.610091782645693, 1.1321559606106981, 9.110674872372684, 0.43364490541725437, 1.0149730227261424, 26.890669013899664, 2.215752520265791, 17.75536980985459, -8.011581171078227, -4.711337156925903, 5.179066076948307, 2.0000000000000013, -19.90032752249816, 1.7897913921053348, -1.4553795507090979, -2.96687380961587, -3.433896598019741, -6.337238325971079, -4.3887371899416445, -5.838155612078026, 2.0000000000000013, 39.678578491175934, 12.797368651984609, -4.82142709206997, -23.878832057622922], "policy_predator_policy_reward": [27.29519028330629, 13.925825513456466, 10.817769547753148, 19.21597271443025, 7.474638771873021, 43.32699626763453, 20.388264052819306, 63.628743745275884, 90.83415500564806, 20.6093863567239, 14.213217199019704, 2.556997615619628, 8.030908541024763, 8.217774664400963, 60.47129313616719, 38.94651268882082, 6.228234090432254, 14.587710481633692, 15.59094514817899, 21.070266003301516, 8.339388248029174, 18.352374838159086, 10.663049687925083, 23.204298052664996, 19.1103769695507, 94.3919478039934, 8.655604332960275, 4.224527517262635, 4.262541055457616, 34.79260565794471, 0.34300448240054965, 0.0, 45.1290813033688, 44.16336888936213, 9.979880090784095, 5.6769872776581805, 95.07373877509427, 30.350687272124357, 28.52358928875335, 12.662031511001445, 8.09763410593108, 12.484097668557581, 5.788393989939931, 5.394739477864461, 0.0, 2.013920337002237, 15.292352598396052, 12.135472072539445, 18.45952983695562, 38.64155427105917, 26.63562283743937, 22.227701769678365, 10.241591739806902, 15.5655482942585, 24.95837715341531, 19.78170283797561, 76.57806261816219, 101.09172014352869, 7.9497694761925874, 30.209122809126953, 0.0, 0.0, 20.750865423562313, 7.937093317036358, 6.398381571752147, 5.818119117961441, 7.931777960782617, 8.24701162815344, 13.931228365949549, 5.2331730720006515, 15.199652105984125, 10.087196971589556, 0.0, 0.6578575190427157, 19.187529308329186, 15.421562244109253, 16.88842076087991, 35.31000294283925, 2.93872772791894, 6.307630294388363, 6.820234095891159, 4.748928304872467, 2.6473897159104345, 4.556188862378443, 57.88514526578232, 10.95837774553898, 10.449769096418732, 32.93488828653232, 3.107584102808767, 26.934780555689734, 2.9206820441635757, 2.2588098020209983, 7.169053133012236, 30.883890636593378, 5.573456284396907, 5.808823056798352, 27.92731297533998, 5.900431230207433, 27.75713712251876, 43.89971873286104, 13.170226795463604, 20.717240758374622, 5.654797415661745, 0.7850458829206513, 12.938827891679876, 14.50052298355953, 22.147059865702253, 3.845365841701131, 1.4237711047284858, 1.8765781375245243, 15.40075176697823, 13.916675307963217, 9.18853244024564, 8.629675982249399, 9.155549702738922, 4.930468972328079, 10.411924243250459, 3.6941970793392307, 13.348375725920954, 13.133863013137145, 2.86717933599954, 8.801464746863735, 5.298094182977373, 5.535535943716365, 10.822635637439635, 14.804856717287048, 14.795052158872927, 11.256814618208338, 10.363690405325617, 19.285425561759098, 14.845881168390823, 20.309246746305956, 0.0, 1.2071152599541812, 5.75754834191798, 2.1858953053833403, 0.17202429271957592, 0.0, 34.199139244312676, 73.03751424907398, 1.530314163076955, 9.344629928613248, 82.6298970916669, 42.21018794531471, 12.135706380663207, 8.489850579179553, 6.127270793930175, 20.944594278968655, 6.306694588806379, 6.189252171371831, 12.663990667959368, 14.79187542427469, 17.482197274127504, 10.731067865542693, 6.103715132465197, 6.296215855271781, 12.977955851843241, 0.4990358184903818, 47.81388160022481, 5.887819255051217, 7.797196487996895, 29.70060290804286, 1.7641182812874556, 4.276917900371292, 8.956456901036521, 0.57966167330704, 1.4149878317208975, 4.956868181378262, 8.917683495309731, 8.131306433205948, 2.7572017083593283, 3.993709815153827, 0.24187148032234845, 50.62228882404088, 11.596576905692608, 28.390027325757934, 1.5971691670165784, 0.0, 1.516355094582747, 0.3959747313518237, 4.915630040251585, 16.305571484711958, 15.714179665314282, 19.238889867942383, 12.883419165278939, 9.490186569648646, 0.0, 21.670327522498436, 0.8370237786956654, 3.3417046905627754, 0.7546300514706479, 6.143146551786908, 21.155975515912655, 0.4687524455108891, 5.661672227884321, 9.309196240617995, 5.1106031017872295, 9.01985709143696, 12.905447363446157, 18.847411237465668]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.2615116998307716, "mean_inference_ms": 5.8508504389402445, "mean_action_processing_ms": 0.973783584535761, "mean_env_wait_ms": 0.7667079435706101, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029019594192504883, "StateBufferConnector_ms": 0.012864351272583008, "ViewRequirementAgentConnector_ms": 0.3164256811141968}, "num_episodes": 22, "episode_return_max": 66.60640733638623, "episode_return_min": -26.258988322999606, "episode_return_mean": 15.125795592402257, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1360000, "num_agent_steps_trained": 1360000, "num_env_steps_sampled": 340000, "num_env_steps_trained": 340000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 250.0955641351807, "num_env_steps_trained_throughput_per_sec": 250.0955641351807, "timesteps_total": 340000, "num_env_steps_sampled_lifetime": 340000, "num_agent_steps_sampled_lifetime": 1360000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1360000, "timers": {"training_iteration_time_ms": 15935.678, "restore_workers_time_ms": 0.015, "training_step_time_ms": 15935.634, "sample_time_ms": 4227.394, "learn_time_ms": 11691.782, "learn_throughput": 342.121, "synch_weights_time_ms": 15.431}, "counters": {"num_env_steps_sampled": 340000, "num_env_steps_trained": 340000, "num_agent_steps_sampled": 1360000, "num_agent_steps_trained": 1360000}, "done": false, "training_iteration": 85, "trial_id": "d163c_00000", "date": "2024-08-16_13-21-42", "timestamp": 1723794702, "time_this_iter_s": 15.998329877853394, "time_total_s": 1921.0675785541534, "pid": 81201, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16ba08160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1921.0675785541534, "iterations_since_restore": 85, "perf": {"cpu_util_percent": 30.086956521739136, "ram_util_percent": 70.0913043478261}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.560769172572585, "cur_kl_coeff": 0.00032958984375, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.2619740999249554, "policy_loss": -0.005002316017019212, "vf_loss": 1.2669743321560047, "vf_explained_var": 0.2682434223947071, "kl": 0.0063341372011705335, "entropy": 0.37019259759358, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 161595.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.9066446971641016, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.6114396536003346, "policy_loss": -0.00839355532979228, "vf_loss": 1.618528040344753, "vf_explained_var": 0.2691438627306116, "kl": 0.013051669162920896, "entropy": 1.158039538822477, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 161595.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 344000, "num_env_steps_trained": 344000, "num_agent_steps_sampled": 1376000, "num_agent_steps_trained": 1376000}, "env_runners": {"episode_reward_max": 66.60640733638623, "episode_reward_min": -26.258988322999606, "episode_reward_mean": 16.605265460506224, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -96.8864771660972, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 44.43793073883023, "predator_policy": 101.09172014352869}, "policy_reward_mean": {"prey_policy": -5.109836853414321, "predator_policy": 13.412469583667416}, "custom_metrics": {}, "hist_stats": {"episode_reward": [29.80332899460931, 11.655040095207946, 27.913855678476963, 24.284630552497863, 3.899999999999961, 1.7933146066960117, 19.938964205762833, 21.97266798051301, 18.150000000000315, 24.83449841971963, 10.827183565649946, 5.670184098254684, 7.959999999999916, 12.223423441295793, 31.2205399080942, 7.500594454225256, 8.362038856924741, 13.43894396294967, 19.36755886235521, 31.364005559068012, 7.7096606565205, 6.5731927696413965, 6.127732838083455, 6.497389715910355, -26.258988322999606, 22.88593736074813, 12.672432988814542, 5.539808085388262, 15.16378074893645, 7.707183187817657, 9.589110333852616, 9.567495040981031, 34.14840183006248, 3.8799999999999613, 12.540524076713137, 13.61966494122474, 22.97762763608867, 21.597417832877213, 31.737348651849107, 4.958323727958341, 32.60999579796562, 14.051656014757185, 7.103595805143655, 18.754638274327107, 3.533239211912964, 23.950805784011894, 13.255195118605776, 30.19335417314152, 3.9599999999999596, 5.785940122060753, 3.989999999999959, 0.3907107250465454, 4.496833387601783, -7.955500830764439, 20.250556171087574, 16.073065510361694, 36.89461979624596, 16.64217304875011, 27.159217756449852, 24.107890920702463, 1.7666222259095201, -23.58344091635487, 42.85550582077098, 3.7564665634648926, 23.169661673307555, 27.855634516201054, 3.704197818018399, 47.02251228652955, -22.602990521147454, 27.938218636799743, 11.839999999999918, 3.3609477540779378, 50.327623059128356, 44.696858172032314, 22.841334654950533, 3.7699999999999645, 4.51314031065465, 0.4970061956219977, 10.898752445510818, 11.132712856424252, 66.60640733638623, 3.052599451218678, -5.5082409191679, 46.75972428029912, 52.87938876833349, 19.249061756026, 33.128557178309244, 26.10828876736992, 25.663434951081914, 4.907349296417071, 35.19908885718375, 37.31625832142229, 51.787163975549205, 5.458962021809725, 36.27044378630117, 16.342417208586433, 22.599800803926385, 3.729999999999965, 8.02227252749183, 18.530000000000374], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-68.64724971944398, -26.97384733316501, -11.88329173720441, -17.64728896734272, 5.332123903987776, 2.0000000000000013, -6.089788126865809, 19.19128521155898, -0.11392033700223506, 2.0000000000000013, -15.371260286106287, -10.263249778133106, 2.0000000000000013, -39.16211990225282, -26.876642900122853, -0.014013726482111322, -8.491591739806937, 0.8344517057415021, -15.272572809335122, -4.633008762336535, -69.95612202994361, -96.8864771660972, -29.427481312230928, -3.06122687483362, 5.959999999999958, 2.0000000000000013, 4.969999999999958, -21.43453529930256, -0.036239151840953825, 19.0402783702213, -9.736373412491252, 1.058178277780488, -12.251228365949585, 1.4488657849241664, 2.0000000000000013, -13.847905114623972, 17.17981717941242, 1.5298841638997274, 12.025776997412104, -15.270862990782986, -10.59729318878288, -33.891469858416045, 2.0000000000000013, -4.673165252665866, 1.771609397936964, -7.213038960617094, -2.7061888623784824, 2.0000000000000013, -46.26202001036704, -48.84049132395384, -16.17789862831482, -4.320821393888375, -21.03535772695846, 3.6654260572747717, 1.7823909998282816, -1.4220747606245454, -24.023900130570546, 1.1347371099017134, 1.65205452657184, -5.327150679949399, 2.0000000000000013, -26.23863387169444, -34.359240514946194, -27.73012029945264, 19.820000000000285, -19.559065723775266, 1.18495411707935, -3.744797415661786, -1.6695268892935147, -13.229299909232754, -13.461263222412411, 1.0885024562337955, 16.843421862475587, 2.8338565313596082, 2.0000000000000013, -9.720009242064743, 21.425463611896763, -7.506323382543, -0.41152724132346896, -8.716167705785173, -6.31084018984793, 24.814714665223764, -4.8714309233354784, -7.559151800965436, -5.141464746863769, 0.5764164691441905, 12.88999999999996, -4.9689918523670835, -2.302360797309377, -19.79189234550408, 11.89999999999996, -14.0010609930699, -18.39392084847859, 2.0000000000000013, 3.946544832144189, -8.908318573699939, 2.0000000000000013, 0.7528847400458202, -4.157503525240529, 2.0000000000000013, 2.0000000000000013, 1.8179757072804255, -53.48978904724069, -53.35615372109932, 1.1865192245248817, -7.564629928613286, -69.1068844400347, -63.688701427711294, 2.0000000000000013, -2.3750007887557354, 1.4301223057241095, -12.428921868261222, -1.408914937861283, 25.807587973929785, -1.2499784493075703, -9.563714594176473, 6.4362965441475, -7.490343927368391, -0.5425723521788597, 12.250532285143771, -1.2984631844155097, -10.411906260008665, -37.85029062762343, -39.434851144007496, -3.6055574225215166, 8.963263847253224, -1.611496454768402, -0.6730731634254583, 11.633543098963441, 2.0000000000000013, -3.286221496898711, 24.770000000000277, -5.881119984984494, -7.4636721255128275, 39.81502602055248, 0.4565747424642245, -32.57118246539091, -40.89596836011974, -27.658477377296816, 15.610091782645693, 1.1321559606106981, 9.110674872372684, 0.43364490541725437, 1.0149730227261424, 26.890669013899664, 2.215752520265791, 17.75536980985459, -8.011581171078227, -4.711337156925903, 5.179066076948307, 2.0000000000000013, -19.90032752249816, 1.7897913921053348, -1.4553795507090979, -2.96687380961587, -3.433896598019741, -6.337238325971079, -4.3887371899416445, -5.838155612078026, 2.0000000000000013, 39.678578491175934, 12.797368651984609, -4.82142709206997, -23.878832057622922, -30.83153740286462, -49.470256724677284, 27.32966734763669, -5.415651192892471, 44.43793073883023, 2.0000000000000013, -1.1374888940765866, 0.8525004675255514, 11.830390982852585, 9.966873253727496, 2.0000000000000013, -8.234975274894607, -7.031889945524165, 10.505553048802094, 1.4931498015866798, 0.5861014801658017, 29.586975223835477, 0.40257263926304837, 21.891120023250643, -13.206303000806653, 17.06733010962218, -11.61428377386848, 2.0000000000000013, -23.881698918478286, -3.8543977023755103, 20.92403747034085, 4.742407299070861, -19.412773617516983, 18.830000000000286, -4.981693532446554, 2.0000000000000013, -5.559403080623572, -3.9535848985783915, 2.0000000000000013, 11.999876026977724, -1.413383586609197], "policy_predator_policy_reward": [95.07373877509427, 30.350687272124357, 28.52358928875335, 12.662031511001445, 8.09763410593108, 12.484097668557581, 5.788393989939931, 5.394739477864461, 0.0, 2.013920337002237, 15.292352598396052, 12.135472072539445, 18.45952983695562, 38.64155427105917, 26.63562283743937, 22.227701769678365, 10.241591739806902, 15.5655482942585, 24.95837715341531, 19.78170283797561, 76.57806261816219, 101.09172014352869, 7.9497694761925874, 30.209122809126953, 0.0, 0.0, 20.750865423562313, 7.937093317036358, 6.398381571752147, 5.818119117961441, 7.931777960782617, 8.24701162815344, 13.931228365949549, 5.2331730720006515, 15.199652105984125, 10.087196971589556, 0.0, 0.6578575190427157, 19.187529308329186, 15.421562244109253, 16.88842076087991, 35.31000294283925, 2.93872772791894, 6.307630294388363, 6.820234095891159, 4.748928304872467, 2.6473897159104345, 4.556188862378443, 57.88514526578232, 10.95837774553898, 10.449769096418732, 32.93488828653232, 3.107584102808767, 26.934780555689734, 2.9206820441635757, 2.2588098020209983, 7.169053133012236, 30.883890636593378, 5.573456284396907, 5.808823056798352, 27.92731297533998, 5.900431230207433, 27.75713712251876, 43.89971873286104, 13.170226795463604, 20.717240758374622, 5.654797415661745, 0.7850458829206513, 12.938827891679876, 14.50052298355953, 22.147059865702253, 3.845365841701131, 1.4237711047284858, 1.8765781375245243, 15.40075176697823, 13.916675307963217, 9.18853244024564, 8.629675982249399, 9.155549702738922, 4.930468972328079, 10.411924243250459, 3.6941970793392307, 13.348375725920954, 13.133863013137145, 2.86717933599954, 8.801464746863735, 5.298094182977373, 5.535535943716365, 10.822635637439635, 14.804856717287048, 14.795052158872927, 11.256814618208338, 10.363690405325617, 19.285425561759098, 14.845881168390823, 20.309246746305956, 0.0, 1.2071152599541812, 5.75754834191798, 2.1858953053833403, 0.17202429271957592, 0.0, 34.199139244312676, 73.03751424907398, 1.530314163076955, 9.344629928613248, 82.6298970916669, 42.21018794531471, 12.135706380663207, 8.489850579179553, 6.127270793930175, 20.944594278968655, 6.306694588806379, 6.189252171371831, 12.663990667959368, 14.79187542427469, 17.482197274127504, 10.731067865542693, 6.103715132465197, 6.296215855271781, 12.977955851843241, 0.4990358184903818, 47.81388160022481, 5.887819255051217, 7.797196487996895, 29.70060290804286, 1.7641182812874556, 4.276917900371292, 8.956456901036521, 0.57966167330704, 1.4149878317208975, 4.956868181378262, 8.917683495309731, 8.131306433205948, 2.7572017083593283, 3.993709815153827, 0.24187148032234845, 50.62228882404088, 11.596576905692608, 28.390027325757934, 1.5971691670165784, 0.0, 1.516355094582747, 0.3959747313518237, 4.915630040251585, 16.305571484711958, 15.714179665314282, 19.238889867942383, 12.883419165278939, 9.490186569648646, 0.0, 21.670327522498436, 0.8370237786956654, 3.3417046905627754, 0.7546300514706479, 6.143146551786908, 21.155975515912655, 0.4687524455108891, 5.661672227884321, 9.309196240617995, 5.1106031017872295, 9.01985709143696, 12.905447363446157, 18.847411237465668, 55.84471490461281, 18.948838303761136, 12.59952949558107, 12.246178629974377, 4.9320692611695, 1.509388768334037, 14.242414821582063, 5.291635360994446, 2.4620079537535355, 8.86928498797543, 19.641267224664336, 12.701996817599653, 6.580998316924709, 15.60877353087868, 1.8307487182475213, 0.9973492964171324, 1.6171243957981751, 3.592416598287799, 18.428679826815348, 10.202761472163633, 37.525872798038186, 8.808244841757961, 1.6089620218097986, 25.731698918478575, 10.45295240307821, 8.747851615258226, 27.557986108525323, 3.454797418507084, 6.750051271928733, 2.00144306444361, 7.2894030806235355, 0.0, 5.764775447562184, 4.21108197850808, 7.943507559631408, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.2591085937051885, "mean_inference_ms": 5.8438233123719145, "mean_action_processing_ms": 0.972842393576686, "mean_env_wait_ms": 0.7653798115040306, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02892935276031494, "StateBufferConnector_ms": 0.00889289379119873, "ViewRequirementAgentConnector_ms": 0.31967318058013916}, "num_episodes": 18, "episode_return_max": 66.60640733638623, "episode_return_min": -26.258988322999606, "episode_return_mean": 16.605265460506224, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1376000, "num_agent_steps_trained": 1376000, "num_env_steps_sampled": 344000, "num_env_steps_trained": 344000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 264.38684316308553, "num_env_steps_trained_throughput_per_sec": 264.38684316308553, "timesteps_total": 344000, "num_env_steps_sampled_lifetime": 344000, "num_agent_steps_sampled_lifetime": 1376000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1376000, "timers": {"training_iteration_time_ms": 15705.243, "restore_workers_time_ms": 0.015, "training_step_time_ms": 15705.198, "sample_time_ms": 4225.927, "learn_time_ms": 11463.468, "learn_throughput": 348.935, "synch_weights_time_ms": 14.801}, "counters": {"num_env_steps_sampled": 344000, "num_env_steps_trained": 344000, "num_agent_steps_sampled": 1376000, "num_agent_steps_trained": 1376000}, "done": false, "training_iteration": 86, "trial_id": "d163c_00000", "date": "2024-08-16_13-21-57", "timestamp": 1723794717, "time_this_iter_s": 15.133163928985596, "time_total_s": 1936.200742483139, "pid": 81201, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16b80ef70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1936.200742483139, "iterations_since_restore": 86, "perf": {"cpu_util_percent": 27.966666666666665, "ram_util_percent": 69.63809523809525}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.8600433637225438, "cur_kl_coeff": 0.00032958984375, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.516798847503763, "policy_loss": -0.0016218070812996418, "vf_loss": 1.5184195797279398, "vf_explained_var": 0.21492831319097488, "kl": 0.00325392497372902, "entropy": 0.35083128682204656, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 163485.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.8743065700959907, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.7096364607571295, "policy_loss": -0.010113475679065145, "vf_loss": 1.7185418164919293, "vf_explained_var": 0.4729290423569856, "kl": 0.012081198361377147, "entropy": 1.1702018161299368, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 163485.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_agent_steps_sampled": 1392000, "num_agent_steps_trained": 1392000}, "env_runners": {"episode_reward_max": 66.60640733638623, "episode_reward_min": -26.258988322999606, "episode_reward_mean": 18.811605297615486, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -69.1068844400347, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 44.43793073883023, "predator_policy": 82.6298970916669}, "policy_reward_mean": {"prey_policy": -2.117124887581569, "predator_policy": 11.522927536389325}, "custom_metrics": {}, "hist_stats": {"episode_reward": [6.497389715910355, -26.258988322999606, 22.88593736074813, 12.672432988814542, 5.539808085388262, 15.16378074893645, 7.707183187817657, 9.589110333852616, 9.567495040981031, 34.14840183006248, 3.8799999999999613, 12.540524076713137, 13.61966494122474, 22.97762763608867, 21.597417832877213, 31.737348651849107, 4.958323727958341, 32.60999579796562, 14.051656014757185, 7.103595805143655, 18.754638274327107, 3.533239211912964, 23.950805784011894, 13.255195118605776, 30.19335417314152, 3.9599999999999596, 5.785940122060753, 3.989999999999959, 0.3907107250465454, 4.496833387601783, -7.955500830764439, 20.250556171087574, 16.073065510361694, 36.89461979624596, 16.64217304875011, 27.159217756449852, 24.107890920702463, 1.7666222259095201, -23.58344091635487, 42.85550582077098, 3.7564665634648926, 23.169661673307555, 27.855634516201054, 3.704197818018399, 47.02251228652955, -22.602990521147454, 27.938218636799743, 11.839999999999918, 3.3609477540779378, 50.327623059128356, 44.696858172032314, 22.841334654950533, 3.7699999999999645, 4.51314031065465, 0.4970061956219977, 10.898752445510818, 11.132712856424252, 66.60640733638623, 3.052599451218678, -5.5082409191679, 46.75972428029912, 52.87938876833349, 19.249061756026, 33.128557178309244, 26.10828876736992, 25.663434951081914, 4.907349296417071, 35.19908885718375, 37.31625832142229, 51.787163975549205, 5.458962021809725, 36.27044378630117, 16.342417208586433, 22.599800803926385, 3.729999999999965, 8.02227252749183, 18.530000000000374, -24.917794553375398, 37.82071153407011, 36.10164959146592, 13.44386608119185, 51.402126865914816, 24.965926356407717, 25.865547632688237, 43.247897165138376, 55.96494647617082, 55.183476975450056, 24.157335729319975, 21.647126879867635, 48.41351472170788, 10.06798196802755, 3.4080326057163712, 33.3966996686516, 4.19581736183418, 4.083108051451763, 48.58411898450301, 3.989999999999959, 2.5783652275250875, 4.334485546295769, 45.29040234744945], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-2.7061888623784824, 2.0000000000000013, -46.26202001036704, -48.84049132395384, -16.17789862831482, -4.320821393888375, -21.03535772695846, 3.6654260572747717, 1.7823909998282816, -1.4220747606245454, -24.023900130570546, 1.1347371099017134, 1.65205452657184, -5.327150679949399, 2.0000000000000013, -26.23863387169444, -34.359240514946194, -27.73012029945264, 19.820000000000285, -19.559065723775266, 1.18495411707935, -3.744797415661786, -1.6695268892935147, -13.229299909232754, -13.461263222412411, 1.0885024562337955, 16.843421862475587, 2.8338565313596082, 2.0000000000000013, -9.720009242064743, 21.425463611896763, -7.506323382543, -0.41152724132346896, -8.716167705785173, -6.31084018984793, 24.814714665223764, -4.8714309233354784, -7.559151800965436, -5.141464746863769, 0.5764164691441905, 12.88999999999996, -4.9689918523670835, -2.302360797309377, -19.79189234550408, 11.89999999999996, -14.0010609930699, -18.39392084847859, 2.0000000000000013, 3.946544832144189, -8.908318573699939, 2.0000000000000013, 0.7528847400458202, -4.157503525240529, 2.0000000000000013, 2.0000000000000013, 1.8179757072804255, -53.48978904724069, -53.35615372109932, 1.1865192245248817, -7.564629928613286, -69.1068844400347, -63.688701427711294, 2.0000000000000013, -2.3750007887557354, 1.4301223057241095, -12.428921868261222, -1.408914937861283, 25.807587973929785, -1.2499784493075703, -9.563714594176473, 6.4362965441475, -7.490343927368391, -0.5425723521788597, 12.250532285143771, -1.2984631844155097, -10.411906260008665, -37.85029062762343, -39.434851144007496, -3.6055574225215166, 8.963263847253224, -1.611496454768402, -0.6730731634254583, 11.633543098963441, 2.0000000000000013, -3.286221496898711, 24.770000000000277, -5.881119984984494, -7.4636721255128275, 39.81502602055248, 0.4565747424642245, -32.57118246539091, -40.89596836011974, -27.658477377296816, 15.610091782645693, 1.1321559606106981, 9.110674872372684, 0.43364490541725437, 1.0149730227261424, 26.890669013899664, 2.215752520265791, 17.75536980985459, -8.011581171078227, -4.711337156925903, 5.179066076948307, 2.0000000000000013, -19.90032752249816, 1.7897913921053348, -1.4553795507090979, -2.96687380961587, -3.433896598019741, -6.337238325971079, -4.3887371899416445, -5.838155612078026, 2.0000000000000013, 39.678578491175934, 12.797368651984609, -4.82142709206997, -23.878832057622922, -30.83153740286462, -49.470256724677284, 27.32966734763669, -5.415651192892471, 44.43793073883023, 2.0000000000000013, -1.1374888940765866, 0.8525004675255514, 11.830390982852585, 9.966873253727496, 2.0000000000000013, -8.234975274894607, -7.031889945524165, 10.505553048802094, 1.4931498015866798, 0.5861014801658017, 29.586975223835477, 0.40257263926304837, 21.891120023250643, -13.206303000806653, 17.06733010962218, -11.61428377386848, 2.0000000000000013, -23.881698918478286, -3.8543977023755103, 20.92403747034085, 4.742407299070861, -19.412773617516983, 18.830000000000286, -4.981693532446554, 2.0000000000000013, -5.559403080623572, -3.9535848985783915, 2.0000000000000013, 11.999876026977724, -1.413383586609197, -32.94276817412922, -40.72600184965533, 22.147193211079248, -9.52632184082963, 2.0000000000000013, 10.27926114075337, -29.231679105077905, 2.0000000000000013, 28.830944644082717, -0.05885120529145369, 10.367748847954537, 2.0000000000000013, -1.1492908770849173, 13.508625589806119, -8.29723685731591, 9.530944770379818, 38.00828232497156, 0.788033026987421, -8.440859014645829, 44.0550826269218, -0.33939303385289166, -1.9559396001314389, -18.88160027428541, 2.0000000000000013, 33.937308765746856, 8.02442295586574, -0.8563290160538386, 6.949999999999958, -27.21310573325156, 0.035111859331954424, -0.9046144304418209, 28.203839241568957, -3.6302883472384524, -3.3945290992010024, -2.9577532311825205, -4.305894787952761, 29.004493774926267, 2.0000000000000013, 1.7703788863597916, 2.0000000000000013, -6.878894591181952, -8.17728037441585, 1.8040191564304946, -4.761736279430193, 36.03605298845172, 0.5100229662786425], "policy_predator_policy_reward": [2.6473897159104345, 4.556188862378443, 57.88514526578232, 10.95837774553898, 10.449769096418732, 32.93488828653232, 3.107584102808767, 26.934780555689734, 2.9206820441635757, 2.2588098020209983, 7.169053133012236, 30.883890636593378, 5.573456284396907, 5.808823056798352, 27.92731297533998, 5.900431230207433, 27.75713712251876, 43.89971873286104, 13.170226795463604, 20.717240758374622, 5.654797415661745, 0.7850458829206513, 12.938827891679876, 14.50052298355953, 22.147059865702253, 3.845365841701131, 1.4237711047284858, 1.8765781375245243, 15.40075176697823, 13.916675307963217, 9.18853244024564, 8.629675982249399, 9.155549702738922, 4.930468972328079, 10.411924243250459, 3.6941970793392307, 13.348375725920954, 13.133863013137145, 2.86717933599954, 8.801464746863735, 5.298094182977373, 5.535535943716365, 10.822635637439635, 14.804856717287048, 14.795052158872927, 11.256814618208338, 10.363690405325617, 19.285425561759098, 14.845881168390823, 20.309246746305956, 0.0, 1.2071152599541812, 5.75754834191798, 2.1858953053833403, 0.17202429271957592, 0.0, 34.199139244312676, 73.03751424907398, 1.530314163076955, 9.344629928613248, 82.6298970916669, 42.21018794531471, 12.135706380663207, 8.489850579179553, 6.127270793930175, 20.944594278968655, 6.306694588806379, 6.189252171371831, 12.663990667959368, 14.79187542427469, 17.482197274127504, 10.731067865542693, 6.103715132465197, 6.296215855271781, 12.977955851843241, 0.4990358184903818, 47.81388160022481, 5.887819255051217, 7.797196487996895, 29.70060290804286, 1.7641182812874556, 4.276917900371292, 8.956456901036521, 0.57966167330704, 1.4149878317208975, 4.956868181378262, 8.917683495309731, 8.131306433205948, 2.7572017083593283, 3.993709815153827, 0.24187148032234845, 50.62228882404088, 11.596576905692608, 28.390027325757934, 1.5971691670165784, 0.0, 1.516355094582747, 0.3959747313518237, 4.915630040251585, 16.305571484711958, 15.714179665314282, 19.238889867942383, 12.883419165278939, 9.490186569648646, 0.0, 21.670327522498436, 0.8370237786956654, 3.3417046905627754, 0.7546300514706479, 6.143146551786908, 21.155975515912655, 0.4687524455108891, 5.661672227884321, 9.309196240617995, 5.1106031017872295, 9.01985709143696, 12.905447363446157, 18.847411237465668, 55.84471490461281, 18.948838303761136, 12.59952949558107, 12.246178629974377, 4.9320692611695, 1.509388768334037, 14.242414821582063, 5.291635360994446, 2.4620079537535355, 8.86928498797543, 19.641267224664336, 12.701996817599653, 6.580998316924709, 15.60877353087868, 1.8307487182475213, 0.9973492964171324, 1.6171243957981751, 3.592416598287799, 18.428679826815348, 10.202761472163633, 37.525872798038186, 8.808244841757961, 1.6089620218097986, 25.731698918478575, 10.45295240307821, 8.747851615258226, 27.557986108525323, 3.454797418507084, 6.750051271928733, 2.00144306444361, 7.2894030806235355, 0.0, 5.764775447562184, 4.21108197850808, 7.943507559631408, 0.0, 0.0, 48.75097547040918, 13.36519122299994, 11.834648940821275, 12.443535931393662, 11.378852519319183, 11.87623812883415, 28.79930705743595, 14.696665303639904, 7.933368123484274, 4.845634514131901, 7.752542994320744, 7.657855503537825, 5.848357416428701, 11.18144293325274, 30.83274631882217, 7.74960695851968, 9.419024165692454, 9.238175046771827, 10.331078316402467, 8.363851209700394, 18.088817153603475, 22.14343983014139, 16.385287324011415, 1.943514721708371, 4.508268278387112, 2.192784235730415, 1.7815267483510402, 29.31357802346729, 1.2724484561689942, 2.33341398660042, 3.7640608709243177, 6.170956395749801, 5.049678412523801, 5.646408325755955, 5.700347744831056, 9.89258752031458, 7.687037689262869, 0.21962111364020978, 0.0, 9.387436052083197, 8.247104141039625, 2.1355298805108878, 5.156672788784593, 4.577254444664398, 4.167071948054936]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.256059591491627, "mean_inference_ms": 5.834264586630228, "mean_action_processing_ms": 0.9714942412839395, "mean_env_wait_ms": 0.7636291750401165, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018669724464416504, "StateBufferConnector_ms": 0.009305357933044434, "ViewRequirementAgentConnector_ms": 0.3097172975540161}, "num_episodes": 23, "episode_return_max": 66.60640733638623, "episode_return_min": -26.258988322999606, "episode_return_mean": 18.811605297615486, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1392000, "num_agent_steps_trained": 1392000, "num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 269.4847779843939, "num_env_steps_trained_throughput_per_sec": 269.4847779843939, "timesteps_total": 348000, "num_env_steps_sampled_lifetime": 348000, "num_agent_steps_sampled_lifetime": 1392000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1392000, "timers": {"training_iteration_time_ms": 15444.682, "restore_workers_time_ms": 0.014, "training_step_time_ms": 15444.639, "sample_time_ms": 4037.3, "learn_time_ms": 11391.602, "learn_throughput": 351.136, "synch_weights_time_ms": 14.698}, "counters": {"num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_agent_steps_sampled": 1392000, "num_agent_steps_trained": 1392000}, "done": false, "training_iteration": 87, "trial_id": "d163c_00000", "date": "2024-08-16_13-22-12", "timestamp": 1723794732, "time_this_iter_s": 14.84870982170105, "time_total_s": 1951.04945230484, "pid": 81201, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16b97b940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1951.04945230484, "iterations_since_restore": 87, "perf": {"cpu_util_percent": 27.75714285714286, "ram_util_percent": 69.21428571428571}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2459979739138687, "cur_kl_coeff": 0.000164794921875, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.2600825386387962, "policy_loss": -0.0034125497074373973, "vf_loss": 1.2634915959425073, "vf_explained_var": 0.3099030410801923, "kl": 0.021193677711114908, "entropy": 0.4045468757234553, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 165375.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.0311219723767073, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.7901170178380592, "policy_loss": -0.006551426880322791, "vf_loss": 1.7958638471270365, "vf_explained_var": 0.48830383019472556, "kl": 0.008045957780445496, "entropy": 1.168399199291512, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 165375.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 352000, "num_env_steps_trained": 352000, "num_agent_steps_sampled": 1408000, "num_agent_steps_trained": 1408000}, "env_runners": {"episode_reward_max": 82.8525881674526, "episode_reward_min": -47.32663140233925, "episode_reward_mean": 18.054027888719865, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -69.1068844400347, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 44.43793073883023, "predator_policy": 82.6298970916669}, "policy_reward_mean": {"prey_policy": -2.50535208700022, "predator_policy": 11.532366031360159}, "custom_metrics": {}, "hist_stats": {"episode_reward": [14.051656014757185, 7.103595805143655, 18.754638274327107, 3.533239211912964, 23.950805784011894, 13.255195118605776, 30.19335417314152, 3.9599999999999596, 5.785940122060753, 3.989999999999959, 0.3907107250465454, 4.496833387601783, -7.955500830764439, 20.250556171087574, 16.073065510361694, 36.89461979624596, 16.64217304875011, 27.159217756449852, 24.107890920702463, 1.7666222259095201, -23.58344091635487, 42.85550582077098, 3.7564665634648926, 23.169661673307555, 27.855634516201054, 3.704197818018399, 47.02251228652955, -22.602990521147454, 27.938218636799743, 11.839999999999918, 3.3609477540779378, 50.327623059128356, 44.696858172032314, 22.841334654950533, 3.7699999999999645, 4.51314031065465, 0.4970061956219977, 10.898752445510818, 11.132712856424252, 66.60640733638623, 3.052599451218678, -5.5082409191679, 46.75972428029912, 52.87938876833349, 19.249061756026, 33.128557178309244, 26.10828876736992, 25.663434951081914, 4.907349296417071, 35.19908885718375, 37.31625832142229, 51.787163975549205, 5.458962021809725, 36.27044378630117, 16.342417208586433, 22.599800803926385, 3.729999999999965, 8.02227252749183, 18.530000000000374, -24.917794553375398, 37.82071153407011, 36.10164959146592, 13.44386608119185, 51.402126865914816, 24.965926356407717, 25.865547632688237, 43.247897165138376, 55.96494647617082, 55.183476975450056, 24.157335729319975, 21.647126879867635, 48.41351472170788, 10.06798196802755, 3.4080326057163712, 33.3966996686516, 4.19581736183418, 4.083108051451763, 48.58411898450301, 3.989999999999959, 2.5783652275250875, 4.334485546295769, 45.29040234744945, 1.736728456977321, 35.02478657939559, 82.8525881674526, 59.14841762834891, 3.7799999999999634, -24.91365582126939, -47.32663140233925, 11.495494485404391, 6.27362439132548, 8.239727930547703, 7.583456269300935, 4.889999999999939, 10.64671169245785, -36.31299361440722, 3.7299999999999636, 4.600385244958651, 12.259999999999929, 21.967072736473014], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-4.8714309233354784, -7.559151800965436, -5.141464746863769, 0.5764164691441905, 12.88999999999996, -4.9689918523670835, -2.302360797309377, -19.79189234550408, 11.89999999999996, -14.0010609930699, -18.39392084847859, 2.0000000000000013, 3.946544832144189, -8.908318573699939, 2.0000000000000013, 0.7528847400458202, -4.157503525240529, 2.0000000000000013, 2.0000000000000013, 1.8179757072804255, -53.48978904724069, -53.35615372109932, 1.1865192245248817, -7.564629928613286, -69.1068844400347, -63.688701427711294, 2.0000000000000013, -2.3750007887557354, 1.4301223057241095, -12.428921868261222, -1.408914937861283, 25.807587973929785, -1.2499784493075703, -9.563714594176473, 6.4362965441475, -7.490343927368391, -0.5425723521788597, 12.250532285143771, -1.2984631844155097, -10.411906260008665, -37.85029062762343, -39.434851144007496, -3.6055574225215166, 8.963263847253224, -1.611496454768402, -0.6730731634254583, 11.633543098963441, 2.0000000000000013, -3.286221496898711, 24.770000000000277, -5.881119984984494, -7.4636721255128275, 39.81502602055248, 0.4565747424642245, -32.57118246539091, -40.89596836011974, -27.658477377296816, 15.610091782645693, 1.1321559606106981, 9.110674872372684, 0.43364490541725437, 1.0149730227261424, 26.890669013899664, 2.215752520265791, 17.75536980985459, -8.011581171078227, -4.711337156925903, 5.179066076948307, 2.0000000000000013, -19.90032752249816, 1.7897913921053348, -1.4553795507090979, -2.96687380961587, -3.433896598019741, -6.337238325971079, -4.3887371899416445, -5.838155612078026, 2.0000000000000013, 39.678578491175934, 12.797368651984609, -4.82142709206997, -23.878832057622922, -30.83153740286462, -49.470256724677284, 27.32966734763669, -5.415651192892471, 44.43793073883023, 2.0000000000000013, -1.1374888940765866, 0.8525004675255514, 11.830390982852585, 9.966873253727496, 2.0000000000000013, -8.234975274894607, -7.031889945524165, 10.505553048802094, 1.4931498015866798, 0.5861014801658017, 29.586975223835477, 0.40257263926304837, 21.891120023250643, -13.206303000806653, 17.06733010962218, -11.61428377386848, 2.0000000000000013, -23.881698918478286, -3.8543977023755103, 20.92403747034085, 4.742407299070861, -19.412773617516983, 18.830000000000286, -4.981693532446554, 2.0000000000000013, -5.559403080623572, -3.9535848985783915, 2.0000000000000013, 11.999876026977724, -1.413383586609197, -32.94276817412922, -40.72600184965533, 22.147193211079248, -9.52632184082963, 2.0000000000000013, 10.27926114075337, -29.231679105077905, 2.0000000000000013, 28.830944644082717, -0.05885120529145369, 10.367748847954537, 2.0000000000000013, -1.1492908770849173, 13.508625589806119, -8.29723685731591, 9.530944770379818, 38.00828232497156, 0.788033026987421, -8.440859014645829, 44.0550826269218, -0.33939303385289166, -1.9559396001314389, -18.88160027428541, 2.0000000000000013, 33.937308765746856, 8.02442295586574, -0.8563290160538386, 6.949999999999958, -27.21310573325156, 0.035111859331954424, -0.9046144304418209, 28.203839241568957, -3.6302883472384524, -3.3945290992010024, -2.9577532311825205, -4.305894787952761, 29.004493774926267, 2.0000000000000013, 1.7703788863597916, 2.0000000000000013, -6.878894591181952, -8.17728037441585, 1.8040191564304946, -4.761736279430193, 36.03605298845172, 0.5100229662786425, -4.786847935271945, -11.461894329242337, 1.8082790796848622, 17.02505860115298, 38.209114328434616, 31.800672438680532, 42.74425893630837, -9.182156938576558, -5.828110006178351, 1.4031037631536913, -36.05175072834381, -45.11708696824872, -68.55942032233861, -57.16546258175182, 2.0000000000000013, -10.154984516092455, -4.103618057251643, 2.0000000000000013, -3.979034939809778, 2.0000000000000013, -15.252709217940618, -3.7740625325889523, 0.5631703750761942, 2.0000000000000013, -2.566983218881308, 1.3261520396917927, -51.92191613694133, -60.78337428302798, -38.49948400853258, 1.447628519964211, -2.593537558697955, 2.0000000000000013, -3.883363959654142, -4.352399959594852, -1.5837983309106005, -22.898078623194223], "policy_predator_policy_reward": [13.348375725920954, 13.133863013137145, 2.86717933599954, 8.801464746863735, 5.298094182977373, 5.535535943716365, 10.822635637439635, 14.804856717287048, 14.795052158872927, 11.256814618208338, 10.363690405325617, 19.285425561759098, 14.845881168390823, 20.309246746305956, 0.0, 1.2071152599541812, 5.75754834191798, 2.1858953053833403, 0.17202429271957592, 0.0, 34.199139244312676, 73.03751424907398, 1.530314163076955, 9.344629928613248, 82.6298970916669, 42.21018794531471, 12.135706380663207, 8.489850579179553, 6.127270793930175, 20.944594278968655, 6.306694588806379, 6.189252171371831, 12.663990667959368, 14.79187542427469, 17.482197274127504, 10.731067865542693, 6.103715132465197, 6.296215855271781, 12.977955851843241, 0.4990358184903818, 47.81388160022481, 5.887819255051217, 7.797196487996895, 29.70060290804286, 1.7641182812874556, 4.276917900371292, 8.956456901036521, 0.57966167330704, 1.4149878317208975, 4.956868181378262, 8.917683495309731, 8.131306433205948, 2.7572017083593283, 3.993709815153827, 0.24187148032234845, 50.62228882404088, 11.596576905692608, 28.390027325757934, 1.5971691670165784, 0.0, 1.516355094582747, 0.3959747313518237, 4.915630040251585, 16.305571484711958, 15.714179665314282, 19.238889867942383, 12.883419165278939, 9.490186569648646, 0.0, 21.670327522498436, 0.8370237786956654, 3.3417046905627754, 0.7546300514706479, 6.143146551786908, 21.155975515912655, 0.4687524455108891, 5.661672227884321, 9.309196240617995, 5.1106031017872295, 9.01985709143696, 12.905447363446157, 18.847411237465668, 55.84471490461281, 18.948838303761136, 12.59952949558107, 12.246178629974377, 4.9320692611695, 1.509388768334037, 14.242414821582063, 5.291635360994446, 2.4620079537535355, 8.86928498797543, 19.641267224664336, 12.701996817599653, 6.580998316924709, 15.60877353087868, 1.8307487182475213, 0.9973492964171324, 1.6171243957981751, 3.592416598287799, 18.428679826815348, 10.202761472163633, 37.525872798038186, 8.808244841757961, 1.6089620218097986, 25.731698918478575, 10.45295240307821, 8.747851615258226, 27.557986108525323, 3.454797418507084, 6.750051271928733, 2.00144306444361, 7.2894030806235355, 0.0, 5.764775447562184, 4.21108197850808, 7.943507559631408, 0.0, 0.0, 48.75097547040918, 13.36519122299994, 11.834648940821275, 12.443535931393662, 11.378852519319183, 11.87623812883415, 28.79930705743595, 14.696665303639904, 7.933368123484274, 4.845634514131901, 7.752542994320744, 7.657855503537825, 5.848357416428701, 11.18144293325274, 30.83274631882217, 7.74960695851968, 9.419024165692454, 9.238175046771827, 10.331078316402467, 8.363851209700394, 18.088817153603475, 22.14343983014139, 16.385287324011415, 1.943514721708371, 4.508268278387112, 2.192784235730415, 1.7815267483510402, 29.31357802346729, 1.2724484561689942, 2.33341398660042, 3.7640608709243177, 6.170956395749801, 5.049678412523801, 5.646408325755955, 5.700347744831056, 9.89258752031458, 7.687037689262869, 0.21962111364020978, 0.0, 9.387436052083197, 8.247104141039625, 2.1355298805108878, 5.156672788784593, 4.577254444664398, 4.167071948054936, 14.322814473758292, 3.6626562477332376, 9.762613223691657, 6.42883567486667, 9.663079116863694, 3.179722283472336, 15.313174750387033, 10.273140880230322, 7.638110006178312, 0.5668962368463101, 51.268628866458506, 4.986553008864611, 2.4962920895949057, 75.90195941215629, 11.219275738860114, 8.431203262636776, 0.6236243913255529, 7.753618057251608, 5.647080214817753, 4.571682655539768, 10.096953647200415, 16.513274372630267, 0.0, 2.3268296249238074, 2.5404282551408635, 9.34711461650654, 5.485528308461374, 70.90676849710086, 40.249484008532235, 0.5323714800357904, 4.473537558697915, 0.7203852449587054, 5.703363959654103, 14.792399959594821, 30.410134196440595, 16.038815494136983]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.253732125237203, "mean_inference_ms": 5.827023711598649, "mean_action_processing_ms": 0.9704087633114509, "mean_env_wait_ms": 0.7621478540783765, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012375712394714355, "StateBufferConnector_ms": 0.009277582168579102, "ViewRequirementAgentConnector_ms": 0.30942654609680176}, "num_episodes": 18, "episode_return_max": 82.8525881674526, "episode_return_min": -47.32663140233925, "episode_return_mean": 18.054027888719865, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1408000, "num_agent_steps_trained": 1408000, "num_env_steps_sampled": 352000, "num_env_steps_trained": 352000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 239.23048200564193, "num_env_steps_trained_throughput_per_sec": 239.23048200564193, "timesteps_total": 352000, "num_env_steps_sampled_lifetime": 352000, "num_agent_steps_sampled_lifetime": 1408000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1408000, "timers": {"training_iteration_time_ms": 15608.829, "restore_workers_time_ms": 0.014, "training_step_time_ms": 15608.786, "sample_time_ms": 4025.244, "learn_time_ms": 11567.71, "learn_throughput": 345.79, "synch_weights_time_ms": 14.8}, "counters": {"num_env_steps_sampled": 352000, "num_env_steps_trained": 352000, "num_agent_steps_sampled": 1408000, "num_agent_steps_trained": 1408000}, "done": false, "training_iteration": 88, "trial_id": "d163c_00000", "date": "2024-08-16_13-22-29", "timestamp": 1723794749, "time_this_iter_s": 16.72494101524353, "time_total_s": 1967.7743933200836, "pid": 81201, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16ba2ae50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1967.7743933200836, "iterations_since_restore": 88, "perf": {"cpu_util_percent": 29.995833333333337, "ram_util_percent": 70.00833333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.494293490351823, "cur_kl_coeff": 0.00024719238281249993, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.5772495096953458, "policy_loss": -0.00396497968988365, "vf_loss": 1.5812130627808747, "vf_explained_var": 0.4291413263038353, "kl": 0.005770086099525564, "entropy": 0.44916980258686834, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 167265.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.6764093651342646, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.7425427259276154, "policy_loss": -0.008474947454989272, "vf_loss": 1.75025220661567, "vf_explained_var": 0.6486984862221612, "kl": 0.007654667766269096, "entropy": 1.1571267712683904, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 167265.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 356000, "num_env_steps_trained": 356000, "num_agent_steps_sampled": 1424000, "num_agent_steps_trained": 1424000}, "env_runners": {"episode_reward_max": 108.75695065675703, "episode_reward_min": -47.32663140233925, "episode_reward_mean": 23.120013580069482, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -68.55942032233861, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 67.71938158965574, "predator_policy": 75.90195941215629}, "policy_reward_mean": {"prey_policy": 1.1547422736078046, "predator_policy": 10.405264516426923}, "custom_metrics": {}, "hist_stats": {"episode_reward": [3.7564665634648926, 23.169661673307555, 27.855634516201054, 3.704197818018399, 47.02251228652955, -22.602990521147454, 27.938218636799743, 11.839999999999918, 3.3609477540779378, 50.327623059128356, 44.696858172032314, 22.841334654950533, 3.7699999999999645, 4.51314031065465, 0.4970061956219977, 10.898752445510818, 11.132712856424252, 66.60640733638623, 3.052599451218678, -5.5082409191679, 46.75972428029912, 52.87938876833349, 19.249061756026, 33.128557178309244, 26.10828876736992, 25.663434951081914, 4.907349296417071, 35.19908885718375, 37.31625832142229, 51.787163975549205, 5.458962021809725, 36.27044378630117, 16.342417208586433, 22.599800803926385, 3.729999999999965, 8.02227252749183, 18.530000000000374, -24.917794553375398, 37.82071153407011, 36.10164959146592, 13.44386608119185, 51.402126865914816, 24.965926356407717, 25.865547632688237, 43.247897165138376, 55.96494647617082, 55.183476975450056, 24.157335729319975, 21.647126879867635, 48.41351472170788, 10.06798196802755, 3.4080326057163712, 33.3966996686516, 4.19581736183418, 4.083108051451763, 48.58411898450301, 3.989999999999959, 2.5783652275250875, 4.334485546295769, 45.29040234744945, 1.736728456977321, 35.02478657939559, 82.8525881674526, 59.14841762834891, 3.7799999999999634, -24.91365582126939, -47.32663140233925, 11.495494485404391, 6.27362439132548, 8.239727930547703, 7.583456269300935, 4.889999999999939, 10.64671169245785, -36.31299361440722, 3.7299999999999636, 4.600385244958651, 12.259999999999929, 21.967072736473014, 18.959504132901323, 62.15413615150372, 3.9999999999999587, 77.2857351392002, 4.717278125343792, 3.8099999999999627, 9.959191489339705, 69.5045801028991, 72.64369041832862, 3.1150507463992634, 74.42529072712419, 5.074727923253791, 11.872195440634435, 84.86056865088221, 108.75695065675703, 31.957788888385743, 7.8869212695244375, 7.197022877961482, 46.90211971590687, 7.403817226594868, 61.30590853036422, 16.482769041424383], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-1.611496454768402, -0.6730731634254583, 11.633543098963441, 2.0000000000000013, -3.286221496898711, 24.770000000000277, -5.881119984984494, -7.4636721255128275, 39.81502602055248, 0.4565747424642245, -32.57118246539091, -40.89596836011974, -27.658477377296816, 15.610091782645693, 1.1321559606106981, 9.110674872372684, 0.43364490541725437, 1.0149730227261424, 26.890669013899664, 2.215752520265791, 17.75536980985459, -8.011581171078227, -4.711337156925903, 5.179066076948307, 2.0000000000000013, -19.90032752249816, 1.7897913921053348, -1.4553795507090979, -2.96687380961587, -3.433896598019741, -6.337238325971079, -4.3887371899416445, -5.838155612078026, 2.0000000000000013, 39.678578491175934, 12.797368651984609, -4.82142709206997, -23.878832057622922, -30.83153740286462, -49.470256724677284, 27.32966734763669, -5.415651192892471, 44.43793073883023, 2.0000000000000013, -1.1374888940765866, 0.8525004675255514, 11.830390982852585, 9.966873253727496, 2.0000000000000013, -8.234975274894607, -7.031889945524165, 10.505553048802094, 1.4931498015866798, 0.5861014801658017, 29.586975223835477, 0.40257263926304837, 21.891120023250643, -13.206303000806653, 17.06733010962218, -11.61428377386848, 2.0000000000000013, -23.881698918478286, -3.8543977023755103, 20.92403747034085, 4.742407299070861, -19.412773617516983, 18.830000000000286, -4.981693532446554, 2.0000000000000013, -5.559403080623572, -3.9535848985783915, 2.0000000000000013, 11.999876026977724, -1.413383586609197, -32.94276817412922, -40.72600184965533, 22.147193211079248, -9.52632184082963, 2.0000000000000013, 10.27926114075337, -29.231679105077905, 2.0000000000000013, 28.830944644082717, -0.05885120529145369, 10.367748847954537, 2.0000000000000013, -1.1492908770849173, 13.508625589806119, -8.29723685731591, 9.530944770379818, 38.00828232497156, 0.788033026987421, -8.440859014645829, 44.0550826269218, -0.33939303385289166, -1.9559396001314389, -18.88160027428541, 2.0000000000000013, 33.937308765746856, 8.02442295586574, -0.8563290160538386, 6.949999999999958, -27.21310573325156, 0.035111859331954424, -0.9046144304418209, 28.203839241568957, -3.6302883472384524, -3.3945290992010024, -2.9577532311825205, -4.305894787952761, 29.004493774926267, 2.0000000000000013, 1.7703788863597916, 2.0000000000000013, -6.878894591181952, -8.17728037441585, 1.8040191564304946, -4.761736279430193, 36.03605298845172, 0.5100229662786425, -4.786847935271945, -11.461894329242337, 1.8082790796848622, 17.02505860115298, 38.209114328434616, 31.800672438680532, 42.74425893630837, -9.182156938576558, -5.828110006178351, 1.4031037631536913, -36.05175072834381, -45.11708696824872, -68.55942032233861, -57.16546258175182, 2.0000000000000013, -10.154984516092455, -4.103618057251643, 2.0000000000000013, -3.979034939809778, 2.0000000000000013, -15.252709217940618, -3.7740625325889523, 0.5631703750761942, 2.0000000000000013, -2.566983218881308, 1.3261520396917927, -51.92191613694133, -60.78337428302798, -38.49948400853258, 1.447628519964211, -2.593537558697955, 2.0000000000000013, -3.883363959654142, -4.352399959594852, -1.5837983309106005, -22.898078623194223, -0.01006035638005444, -0.8839555803997268, 9.744354651464635, 46.30757651434087, 2.0000000000000013, 2.0000000000000013, -19.489760519336667, 63.520533757780555, 2.0000000000000013, -1.399396783812391, 0.7498000346076098, -1.616299418154645, 2.0000000000000013, -5.717396357803522, 51.25770853375119, -2.29985493071389, 2.0000000000000013, 58.11030558432777, -32.42156796661838, -7.7448173152935915, -5.432758347596216, 67.71938158965574, -5.07454366266738, 1.472970001986064, -4.704137831888415, 3.716153065009917, -6.0798267304643305, 65.49712233043667, 23.34160074746942, 66.39332978723606, 19.376207058311472, -37.57150622328025, -5.072671856135371, 2.0000000000000013, -16.552661841905977, 2.0000000000000013, -21.641972035717203, 40.038156037187726, 0.5761564010479784, -9.97091097860408, 53.404921355528295, -4.551128969776803, -33.976804220669884, 2.0000000000000013], "policy_predator_policy_reward": [1.7641182812874556, 4.276917900371292, 8.956456901036521, 0.57966167330704, 1.4149878317208975, 4.956868181378262, 8.917683495309731, 8.131306433205948, 2.7572017083593283, 3.993709815153827, 0.24187148032234845, 50.62228882404088, 11.596576905692608, 28.390027325757934, 1.5971691670165784, 0.0, 1.516355094582747, 0.3959747313518237, 4.915630040251585, 16.305571484711958, 15.714179665314282, 19.238889867942383, 12.883419165278939, 9.490186569648646, 0.0, 21.670327522498436, 0.8370237786956654, 3.3417046905627754, 0.7546300514706479, 6.143146551786908, 21.155975515912655, 0.4687524455108891, 5.661672227884321, 9.309196240617995, 5.1106031017872295, 9.01985709143696, 12.905447363446157, 18.847411237465668, 55.84471490461281, 18.948838303761136, 12.59952949558107, 12.246178629974377, 4.9320692611695, 1.509388768334037, 14.242414821582063, 5.291635360994446, 2.4620079537535355, 8.86928498797543, 19.641267224664336, 12.701996817599653, 6.580998316924709, 15.60877353087868, 1.8307487182475213, 0.9973492964171324, 1.6171243957981751, 3.592416598287799, 18.428679826815348, 10.202761472163633, 37.525872798038186, 8.808244841757961, 1.6089620218097986, 25.731698918478575, 10.45295240307821, 8.747851615258226, 27.557986108525323, 3.454797418507084, 6.750051271928733, 2.00144306444361, 7.2894030806235355, 0.0, 5.764775447562184, 4.21108197850808, 7.943507559631408, 0.0, 0.0, 48.75097547040918, 13.36519122299994, 11.834648940821275, 12.443535931393662, 11.378852519319183, 11.87623812883415, 28.79930705743595, 14.696665303639904, 7.933368123484274, 4.845634514131901, 7.752542994320744, 7.657855503537825, 5.848357416428701, 11.18144293325274, 30.83274631882217, 7.74960695851968, 9.419024165692454, 9.238175046771827, 10.331078316402467, 8.363851209700394, 18.088817153603475, 22.14343983014139, 16.385287324011415, 1.943514721708371, 4.508268278387112, 2.192784235730415, 1.7815267483510402, 29.31357802346729, 1.2724484561689942, 2.33341398660042, 3.7640608709243177, 6.170956395749801, 5.049678412523801, 5.646408325755955, 5.700347744831056, 9.89258752031458, 7.687037689262869, 0.21962111364020978, 0.0, 9.387436052083197, 8.247104141039625, 2.1355298805108878, 5.156672788784593, 4.577254444664398, 4.167071948054936, 14.322814473758292, 3.6626562477332376, 9.762613223691657, 6.42883567486667, 9.663079116863694, 3.179722283472336, 15.313174750387033, 10.273140880230322, 7.638110006178312, 0.5668962368463101, 51.268628866458506, 4.986553008864611, 2.4962920895949057, 75.90195941215629, 11.219275738860114, 8.431203262636776, 0.6236243913255529, 7.753618057251608, 5.647080214817753, 4.571682655539768, 10.096953647200415, 16.513274372630267, 0.0, 2.3268296249238074, 2.5404282551408635, 9.34711461650654, 5.485528308461374, 70.90676849710086, 40.249484008532235, 0.5323714800357904, 4.473537558697915, 0.7203852449587054, 5.703363959654103, 14.792399959594821, 30.410134196440595, 16.038815494136983, 13.296927833796483, 6.556592235884161, 3.2046775752745917, 2.897527410423875, 0.0, 0.0, 21.73982902786349, 11.5151328728916, 0.8596650109570554, 3.257009898199158, 3.476299418154614, 1.2001999653923916, 8.199389894601328, 5.477197952541941, 11.30542309411397, 9.241303405746278, 6.8478723026728066, 5.6855125313268475, 34.11156796661805, 9.16986806169284, 8.187882036329661, 3.9507854487343614, 2.2689798022856427, 6.407321781649493, 5.786177527545758, 7.074002679967177, 10.431894867844912, 15.011378183064483, 3.6528809082787457, 15.369139213772398, 44.83080390227978, 5.322284151074898, 4.091330731629123, 6.868262394030727, 3.453237583644033, 18.29644713622378, 4.987891973264879, 23.518043741172, 2.3308864355807946, 14.467685368570214, 5.801434041162127, 6.650682103450864, 15.714585669699652, 32.7449875923943]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.2514825667641496, "mean_inference_ms": 5.819790085101589, "mean_action_processing_ms": 0.9693846103392088, "mean_env_wait_ms": 0.7609177342888518, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012514233589172363, "StateBufferConnector_ms": 0.013187527656555176, "ViewRequirementAgentConnector_ms": 0.33635735511779785}, "num_episodes": 22, "episode_return_max": 108.75695065675703, "episode_return_min": -47.32663140233925, "episode_return_mean": 23.120013580069482, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1424000, "num_agent_steps_trained": 1424000, "num_env_steps_sampled": 356000, "num_env_steps_trained": 356000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 228.71821267436215, "num_env_steps_trained_throughput_per_sec": 228.71821267436215, "timesteps_total": 356000, "num_env_steps_sampled_lifetime": 356000, "num_agent_steps_sampled_lifetime": 1424000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1424000, "timers": {"training_iteration_time_ms": 15830.917, "restore_workers_time_ms": 0.014, "training_step_time_ms": 15830.875, "sample_time_ms": 4062.986, "learn_time_ms": 11752.066, "learn_throughput": 340.366, "synch_weights_time_ms": 14.854}, "counters": {"num_env_steps_sampled": 356000, "num_env_steps_trained": 356000, "num_agent_steps_sampled": 1424000, "num_agent_steps_trained": 1424000}, "done": false, "training_iteration": 89, "trial_id": "d163c_00000", "date": "2024-08-16_13-22-46", "timestamp": 1723794766, "time_this_iter_s": 17.492103338241577, "time_total_s": 1985.2664966583252, "pid": 81201, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16b976f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1985.2664966583252, "iterations_since_restore": 89, "perf": {"cpu_util_percent": 33.099999999999994, "ram_util_percent": 70.75833333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.636507835716166, "cur_kl_coeff": 0.00024719238281249993, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.1196693709287695, "policy_loss": -0.003019776968679652, "vf_loss": 2.1226882701828367, "vf_explained_var": 0.36670545254434855, "kl": 0.003563332659793711, "entropy": 0.3570833779832043, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 169155.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.5381729141744986, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.3539097406246046, "policy_loss": -0.005297431882185044, "vf_loss": 2.358808912202795, "vf_explained_var": 0.6732287858844435, "kl": 0.003982583814182431, "entropy": 1.1732332092744333, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 169155.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_agent_steps_sampled": 1440000, "num_agent_steps_trained": 1440000}, "env_runners": {"episode_reward_max": 140.07643194251267, "episode_reward_min": -47.32663140233925, "episode_reward_mean": 27.165707221982487, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -68.55942032233861, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 123.56799227374619, "predator_policy": 75.90195941215629}, "policy_reward_mean": {"prey_policy": 2.3724248275932878, "predator_policy": 11.210428783397944}, "custom_metrics": {}, "hist_stats": {"episode_reward": [3.052599451218678, -5.5082409191679, 46.75972428029912, 52.87938876833349, 19.249061756026, 33.128557178309244, 26.10828876736992, 25.663434951081914, 4.907349296417071, 35.19908885718375, 37.31625832142229, 51.787163975549205, 5.458962021809725, 36.27044378630117, 16.342417208586433, 22.599800803926385, 3.729999999999965, 8.02227252749183, 18.530000000000374, -24.917794553375398, 37.82071153407011, 36.10164959146592, 13.44386608119185, 51.402126865914816, 24.965926356407717, 25.865547632688237, 43.247897165138376, 55.96494647617082, 55.183476975450056, 24.157335729319975, 21.647126879867635, 48.41351472170788, 10.06798196802755, 3.4080326057163712, 33.3966996686516, 4.19581736183418, 4.083108051451763, 48.58411898450301, 3.989999999999959, 2.5783652275250875, 4.334485546295769, 45.29040234744945, 1.736728456977321, 35.02478657939559, 82.8525881674526, 59.14841762834891, 3.7799999999999634, -24.91365582126939, -47.32663140233925, 11.495494485404391, 6.27362439132548, 8.239727930547703, 7.583456269300935, 4.889999999999939, 10.64671169245785, -36.31299361440722, 3.7299999999999636, 4.600385244958651, 12.259999999999929, 21.967072736473014, 18.959504132901323, 62.15413615150372, 3.9999999999999587, 77.2857351392002, 4.717278125343792, 3.8099999999999627, 9.959191489339705, 69.5045801028991, 72.64369041832862, 3.1150507463992634, 74.42529072712419, 5.074727923253791, 11.872195440634435, 84.86056865088221, 108.75695065675703, 31.957788888385743, 7.8869212695244375, 7.197022877961482, 46.90211971590687, 7.403817226594868, 61.30590853036422, 16.482769041424383, 6.2686678941202585, 82.83000000000081, 140.07643194251267, -39.578533224602154, 9.485235712154292, 4.4225918254106515, 3.6599999999999664, 98.85000000000086, -43.02229455053663, 80.47428421434402, 87.6610476591365, 5.740963911207202, 24.77590820376821, 50.29853290798474, 57.601669432000634, 61.693186012142746, 29.08948726740963, 85.5706687422073], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-4.82142709206997, -23.878832057622922, -30.83153740286462, -49.470256724677284, 27.32966734763669, -5.415651192892471, 44.43793073883023, 2.0000000000000013, -1.1374888940765866, 0.8525004675255514, 11.830390982852585, 9.966873253727496, 2.0000000000000013, -8.234975274894607, -7.031889945524165, 10.505553048802094, 1.4931498015866798, 0.5861014801658017, 29.586975223835477, 0.40257263926304837, 21.891120023250643, -13.206303000806653, 17.06733010962218, -11.61428377386848, 2.0000000000000013, -23.881698918478286, -3.8543977023755103, 20.92403747034085, 4.742407299070861, -19.412773617516983, 18.830000000000286, -4.981693532446554, 2.0000000000000013, -5.559403080623572, -3.9535848985783915, 2.0000000000000013, 11.999876026977724, -1.413383586609197, -32.94276817412922, -40.72600184965533, 22.147193211079248, -9.52632184082963, 2.0000000000000013, 10.27926114075337, -29.231679105077905, 2.0000000000000013, 28.830944644082717, -0.05885120529145369, 10.367748847954537, 2.0000000000000013, -1.1492908770849173, 13.508625589806119, -8.29723685731591, 9.530944770379818, 38.00828232497156, 0.788033026987421, -8.440859014645829, 44.0550826269218, -0.33939303385289166, -1.9559396001314389, -18.88160027428541, 2.0000000000000013, 33.937308765746856, 8.02442295586574, -0.8563290160538386, 6.949999999999958, -27.21310573325156, 0.035111859331954424, -0.9046144304418209, 28.203839241568957, -3.6302883472384524, -3.3945290992010024, -2.9577532311825205, -4.305894787952761, 29.004493774926267, 2.0000000000000013, 1.7703788863597916, 2.0000000000000013, -6.878894591181952, -8.17728037441585, 1.8040191564304946, -4.761736279430193, 36.03605298845172, 0.5100229662786425, -4.786847935271945, -11.461894329242337, 1.8082790796848622, 17.02505860115298, 38.209114328434616, 31.800672438680532, 42.74425893630837, -9.182156938576558, -5.828110006178351, 1.4031037631536913, -36.05175072834381, -45.11708696824872, -68.55942032233861, -57.16546258175182, 2.0000000000000013, -10.154984516092455, -4.103618057251643, 2.0000000000000013, -3.979034939809778, 2.0000000000000013, -15.252709217940618, -3.7740625325889523, 0.5631703750761942, 2.0000000000000013, -2.566983218881308, 1.3261520396917927, -51.92191613694133, -60.78337428302798, -38.49948400853258, 1.447628519964211, -2.593537558697955, 2.0000000000000013, -3.883363959654142, -4.352399959594852, -1.5837983309106005, -22.898078623194223, -0.01006035638005444, -0.8839555803997268, 9.744354651464635, 46.30757651434087, 2.0000000000000013, 2.0000000000000013, -19.489760519336667, 63.520533757780555, 2.0000000000000013, -1.399396783812391, 0.7498000346076098, -1.616299418154645, 2.0000000000000013, -5.717396357803522, 51.25770853375119, -2.29985493071389, 2.0000000000000013, 58.11030558432777, -32.42156796661838, -7.7448173152935915, -5.432758347596216, 67.71938158965574, -5.07454366266738, 1.472970001986064, -4.704137831888415, 3.716153065009917, -6.0798267304643305, 65.49712233043667, 23.34160074746942, 66.39332978723606, 19.376207058311472, -37.57150622328025, -5.072671856135371, 2.0000000000000013, -16.552661841905977, 2.0000000000000013, -21.641972035717203, 40.038156037187726, 0.5761564010479784, -9.97091097860408, 53.404921355528295, -4.551128969776803, -33.976804220669884, 2.0000000000000013, -11.823062145365881, 2.0000000000000013, 74.26799561011039, -13.757161162170906, -1.5608408126913593, 123.56799227374619, -49.82961693099917, -54.845498464743166, 2.0000000000000013, -6.443857457368093, 1.2587810164167719, -1.7779723714988969, 0.49404506161691425, -7.075044148288772, -0.8528408504891096, 94.76464696726357, -63.14704287057476, -51.09432375417601, 62.083234400193426, 2.0000000000000013, 19.392123810051196, 31.54684451424438, 1.6770337652705556, -13.544387215589241, -43.19612339365305, 17.604271969729844, 2.0000000000000013, 32.75291676003324, 47.289545550294505, 0.20782633667927514, -25.3569194982737, 30.822097344432006, 0.24923689405818855, 17.796032133324303, 70.95270235864237, -7.6875828963763215], "policy_predator_policy_reward": [12.905447363446157, 18.847411237465668, 55.84471490461281, 18.948838303761136, 12.59952949558107, 12.246178629974377, 4.9320692611695, 1.509388768334037, 14.242414821582063, 5.291635360994446, 2.4620079537535355, 8.86928498797543, 19.641267224664336, 12.701996817599653, 6.580998316924709, 15.60877353087868, 1.8307487182475213, 0.9973492964171324, 1.6171243957981751, 3.592416598287799, 18.428679826815348, 10.202761472163633, 37.525872798038186, 8.808244841757961, 1.6089620218097986, 25.731698918478575, 10.45295240307821, 8.747851615258226, 27.557986108525323, 3.454797418507084, 6.750051271928733, 2.00144306444361, 7.2894030806235355, 0.0, 5.764775447562184, 4.21108197850808, 7.943507559631408, 0.0, 0.0, 48.75097547040918, 13.36519122299994, 11.834648940821275, 12.443535931393662, 11.378852519319183, 11.87623812883415, 28.79930705743595, 14.696665303639904, 7.933368123484274, 4.845634514131901, 7.752542994320744, 7.657855503537825, 5.848357416428701, 11.18144293325274, 30.83274631882217, 7.74960695851968, 9.419024165692454, 9.238175046771827, 10.331078316402467, 8.363851209700394, 18.088817153603475, 22.14343983014139, 16.385287324011415, 1.943514721708371, 4.508268278387112, 2.192784235730415, 1.7815267483510402, 29.31357802346729, 1.2724484561689942, 2.33341398660042, 3.7640608709243177, 6.170956395749801, 5.049678412523801, 5.646408325755955, 5.700347744831056, 9.89258752031458, 7.687037689262869, 0.21962111364020978, 0.0, 9.387436052083197, 8.247104141039625, 2.1355298805108878, 5.156672788784593, 4.577254444664398, 4.167071948054936, 14.322814473758292, 3.6626562477332376, 9.762613223691657, 6.42883567486667, 9.663079116863694, 3.179722283472336, 15.313174750387033, 10.273140880230322, 7.638110006178312, 0.5668962368463101, 51.268628866458506, 4.986553008864611, 2.4962920895949057, 75.90195941215629, 11.219275738860114, 8.431203262636776, 0.6236243913255529, 7.753618057251608, 5.647080214817753, 4.571682655539768, 10.096953647200415, 16.513274372630267, 0.0, 2.3268296249238074, 2.5404282551408635, 9.34711461650654, 5.485528308461374, 70.90676849710086, 40.249484008532235, 0.5323714800357904, 4.473537558697915, 0.7203852449587054, 5.703363959654103, 14.792399959594821, 30.410134196440595, 16.038815494136983, 13.296927833796483, 6.556592235884161, 3.2046775752745917, 2.897527410423875, 0.0, 0.0, 21.73982902786349, 11.5151328728916, 0.8596650109570554, 3.257009898199158, 3.476299418154614, 1.2001999653923916, 8.199389894601328, 5.477197952541941, 11.30542309411397, 9.241303405746278, 6.8478723026728066, 5.6855125313268475, 34.11156796661805, 9.16986806169284, 8.187882036329661, 3.9507854487343614, 2.2689798022856427, 6.407321781649493, 5.786177527545758, 7.074002679967177, 10.431894867844912, 15.011378183064483, 3.6528809082787457, 15.369139213772398, 44.83080390227978, 5.322284151074898, 4.091330731629123, 6.868262394030727, 3.453237583644033, 18.29644713622378, 4.987891973264879, 23.518043741172, 2.3308864355807946, 14.467685368570214, 5.801434041162127, 6.650682103450864, 15.714585669699652, 32.7449875923943, 2.3686678941203403, 13.72306214536584, 20.576032140095037, 1.7431334119657782, 4.079502721141106, 13.98977776031719, 7.313280128143228, 57.78330204299696, 6.217854490063203, 7.711238679459225, 3.6448438819906013, 1.2969392985021921, 1.4359549383830872, 8.805044148288735, 2.742840850489095, 2.1953530327367914, 71.0325752849416, 0.18649678927260904, 9.766907918715102, 6.624141895434337, 17.54589892198323, 19.176180412856887, 2.193930145936728, 15.414387215589201, 5.124695070256885, 45.24306455743456, 9.464619451338613, 6.08099669661335, 5.123843095321877, 4.980454449705285, 31.884848305537385, 24.34315986044806, 4.2402503733510395, 6.803967866675889, 12.596767546804847, 9.708781733135938]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.427874167444526, "mean_inference_ms": 6.349097079442824, "mean_action_processing_ms": 1.0572882336915226, "mean_env_wait_ms": 0.7599305961512204, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013736248016357422, "StateBufferConnector_ms": 0.013140559196472168, "ViewRequirementAgentConnector_ms": 0.348565936088562}, "num_episodes": 18, "episode_return_max": 140.07643194251267, "episode_return_min": -47.32663140233925, "episode_return_mean": 27.165707221982487, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1440000, "num_agent_steps_trained": 1440000, "num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 20.866774634034048, "num_env_steps_trained_throughput_per_sec": 20.866774634034048, "timesteps_total": 360000, "num_env_steps_sampled_lifetime": 360000, "num_agent_steps_sampled_lifetime": 1440000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1440000, "timers": {"training_iteration_time_ms": 33361.921, "restore_workers_time_ms": 0.014, "training_step_time_ms": 33361.878, "sample_time_ms": 21881.046, "learn_time_ms": 11465.401, "learn_throughput": 348.876, "synch_weights_time_ms": 14.429}, "counters": {"num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_agent_steps_sampled": 1440000, "num_agent_steps_trained": 1440000}, "done": false, "training_iteration": 90, "trial_id": "d163c_00000", "date": "2024-08-16_13-25-58", "timestamp": 1723794958, "time_this_iter_s": 191.69659900665283, "time_total_s": 2176.963095664978, "pid": 81201, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16b976940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2176.963095664978, "iterations_since_restore": 90, "perf": {"cpu_util_percent": 37.333333333333336, "ram_util_percent": 70.37619047619047}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.44104379286211, "cur_kl_coeff": 0.00012359619140624997, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.858907343502398, "policy_loss": -0.002670168145510452, "vf_loss": 1.861576908416849, "vf_explained_var": 0.4413925796904892, "kl": 0.004834704429205808, "entropy": 0.37511231109263404, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 171045.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.8007249432896812, "cur_kl_coeff": 0.05, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.000712089311509, "policy_loss": -0.010036925844251912, "vf_loss": 3.009951714422337, "vf_explained_var": 0.6616549225395949, "kl": 0.01594594001940027, "entropy": 1.17561078204049, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 171045.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 364000, "num_env_steps_trained": 364000, "num_agent_steps_sampled": 1456000, "num_agent_steps_trained": 1456000}, "env_runners": {"episode_reward_max": 239.19766183566514, "episode_reward_min": -47.32663140233925, "episode_reward_mean": 38.55890017636858, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -68.55942032233861, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 176.48863458652372, "predator_policy": 75.90195941215629}, "policy_reward_mean": {"prey_policy": 8.263811137007059, "predator_policy": 11.01563895117721}, "custom_metrics": {}, "hist_stats": {"episode_reward": [51.402126865914816, 24.965926356407717, 25.865547632688237, 43.247897165138376, 55.96494647617082, 55.183476975450056, 24.157335729319975, 21.647126879867635, 48.41351472170788, 10.06798196802755, 3.4080326057163712, 33.3966996686516, 4.19581736183418, 4.083108051451763, 48.58411898450301, 3.989999999999959, 2.5783652275250875, 4.334485546295769, 45.29040234744945, 1.736728456977321, 35.02478657939559, 82.8525881674526, 59.14841762834891, 3.7799999999999634, -24.91365582126939, -47.32663140233925, 11.495494485404391, 6.27362439132548, 8.239727930547703, 7.583456269300935, 4.889999999999939, 10.64671169245785, -36.31299361440722, 3.7299999999999636, 4.600385244958651, 12.259999999999929, 21.967072736473014, 18.959504132901323, 62.15413615150372, 3.9999999999999587, 77.2857351392002, 4.717278125343792, 3.8099999999999627, 9.959191489339705, 69.5045801028991, 72.64369041832862, 3.1150507463992634, 74.42529072712419, 5.074727923253791, 11.872195440634435, 84.86056865088221, 108.75695065675703, 31.957788888385743, 7.8869212695244375, 7.197022877961482, 46.90211971590687, 7.403817226594868, 61.30590853036422, 16.482769041424383, 6.2686678941202585, 82.83000000000081, 140.07643194251267, -39.578533224602154, 9.485235712154292, 4.4225918254106515, 3.6599999999999664, 98.85000000000086, -43.02229455053663, 80.47428421434402, 87.6610476591365, 5.740963911207202, 24.77590820376821, 50.29853290798474, 57.601669432000634, 61.693186012142746, 29.08948726740963, 85.5706687422073, 5.382717212228626, 66.58460277444719, 161.2, 7.677382716221184, 139.95630514348292, 8.533645551676102, -15.469119944885515, 239.19766183566514, 99.49502103464663, 111.89776388530785, 59.35213973057915, 9.73999999999992, 154.35, 5.318603342619728, 130.01523207021262, 29.20710299127884, 80.25710295781639, 4.9214616632971815, 32.711397332579864, 3.7599999999999643, 32.570143435967864, 184.63862599043864, 91.96650940053964], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [28.830944644082717, -0.05885120529145369, 10.367748847954537, 2.0000000000000013, -1.1492908770849173, 13.508625589806119, -8.29723685731591, 9.530944770379818, 38.00828232497156, 0.788033026987421, -8.440859014645829, 44.0550826269218, -0.33939303385289166, -1.9559396001314389, -18.88160027428541, 2.0000000000000013, 33.937308765746856, 8.02442295586574, -0.8563290160538386, 6.949999999999958, -27.21310573325156, 0.035111859331954424, -0.9046144304418209, 28.203839241568957, -3.6302883472384524, -3.3945290992010024, -2.9577532311825205, -4.305894787952761, 29.004493774926267, 2.0000000000000013, 1.7703788863597916, 2.0000000000000013, -6.878894591181952, -8.17728037441585, 1.8040191564304946, -4.761736279430193, 36.03605298845172, 0.5100229662786425, -4.786847935271945, -11.461894329242337, 1.8082790796848622, 17.02505860115298, 38.209114328434616, 31.800672438680532, 42.74425893630837, -9.182156938576558, -5.828110006178351, 1.4031037631536913, -36.05175072834381, -45.11708696824872, -68.55942032233861, -57.16546258175182, 2.0000000000000013, -10.154984516092455, -4.103618057251643, 2.0000000000000013, -3.979034939809778, 2.0000000000000013, -15.252709217940618, -3.7740625325889523, 0.5631703750761942, 2.0000000000000013, -2.566983218881308, 1.3261520396917927, -51.92191613694133, -60.78337428302798, -38.49948400853258, 1.447628519964211, -2.593537558697955, 2.0000000000000013, -3.883363959654142, -4.352399959594852, -1.5837983309106005, -22.898078623194223, -0.01006035638005444, -0.8839555803997268, 9.744354651464635, 46.30757651434087, 2.0000000000000013, 2.0000000000000013, -19.489760519336667, 63.520533757780555, 2.0000000000000013, -1.399396783812391, 0.7498000346076098, -1.616299418154645, 2.0000000000000013, -5.717396357803522, 51.25770853375119, -2.29985493071389, 2.0000000000000013, 58.11030558432777, -32.42156796661838, -7.7448173152935915, -5.432758347596216, 67.71938158965574, -5.07454366266738, 1.472970001986064, -4.704137831888415, 3.716153065009917, -6.0798267304643305, 65.49712233043667, 23.34160074746942, 66.39332978723606, 19.376207058311472, -37.57150622328025, -5.072671856135371, 2.0000000000000013, -16.552661841905977, 2.0000000000000013, -21.641972035717203, 40.038156037187726, 0.5761564010479784, -9.97091097860408, 53.404921355528295, -4.551128969776803, -33.976804220669884, 2.0000000000000013, -11.823062145365881, 2.0000000000000013, 74.26799561011039, -13.757161162170906, -1.5608408126913593, 123.56799227374619, -49.82961693099917, -54.845498464743166, 2.0000000000000013, -6.443857457368093, 1.2587810164167719, -1.7779723714988969, 0.49404506161691425, -7.075044148288772, -0.8528408504891096, 94.76464696726357, -63.14704287057476, -51.09432375417601, 62.083234400193426, 2.0000000000000013, 19.392123810051196, 31.54684451424438, 1.6770337652705556, -13.544387215589241, -43.19612339365305, 17.604271969729844, 2.0000000000000013, 32.75291676003324, 47.289545550294505, 0.20782633667927514, -25.3569194982737, 30.822097344432006, 0.24923689405818855, 17.796032133324303, 70.95270235864237, -7.6875828963763215, 1.7786502795822907, -15.131859752681569, 58.82928037696487, -5.602876590548007, -15.733839216318655, 159.25020108615354, -2.5040204468705047, -19.641187845377473, 47.02096548176361, 65.1192113309979, 1.435684873315423, -8.09739767924658, -21.81974779815968, -28.134964284995473, 137.2175872707285, 78.32077249634432, 21.006540858699676, 54.82276907839447, 3.431178193605336, 95.12626906852503, 28.217594905018053, 0.5577525949996717, 0.47812347271206684, 1.593413451396685, 152.2558987663198, -1.1031500233189404, -2.2495375383218397, 2.0000000000000013, -7.418647627662882, 91.69621331411119, -0.9791082187447742, -10.680467500796267, 52.05257122458914, 16.384975970197797, -1.4572225309880096, 2.0000000000000013, -48.70525623298948, -19.821365965200442, -0.5137322051511262, -2.2809579425018764, 23.273908263101916, -20.492497661176905, 2.0000000000000013, 176.48863458652372, 84.28526781699948, 1.748222782462421], "policy_predator_policy_reward": [14.696665303639904, 7.933368123484274, 4.845634514131901, 7.752542994320744, 7.657855503537825, 5.848357416428701, 11.18144293325274, 30.83274631882217, 7.74960695851968, 9.419024165692454, 9.238175046771827, 10.331078316402467, 8.363851209700394, 18.088817153603475, 22.14343983014139, 16.385287324011415, 1.943514721708371, 4.508268278387112, 2.192784235730415, 1.7815267483510402, 29.31357802346729, 1.2724484561689942, 2.33341398660042, 3.7640608709243177, 6.170956395749801, 5.049678412523801, 5.646408325755955, 5.700347744831056, 9.89258752031458, 7.687037689262869, 0.21962111364020978, 0.0, 9.387436052083197, 8.247104141039625, 2.1355298805108878, 5.156672788784593, 4.577254444664398, 4.167071948054936, 14.322814473758292, 3.6626562477332376, 9.762613223691657, 6.42883567486667, 9.663079116863694, 3.179722283472336, 15.313174750387033, 10.273140880230322, 7.638110006178312, 0.5668962368463101, 51.268628866458506, 4.986553008864611, 2.4962920895949057, 75.90195941215629, 11.219275738860114, 8.431203262636776, 0.6236243913255529, 7.753618057251608, 5.647080214817753, 4.571682655539768, 10.096953647200415, 16.513274372630267, 0.0, 2.3268296249238074, 2.5404282551408635, 9.34711461650654, 5.485528308461374, 70.90676849710086, 40.249484008532235, 0.5323714800357904, 4.473537558697915, 0.7203852449587054, 5.703363959654103, 14.792399959594821, 30.410134196440595, 16.038815494136983, 13.296927833796483, 6.556592235884161, 3.2046775752745917, 2.897527410423875, 0.0, 0.0, 21.73982902786349, 11.5151328728916, 0.8596650109570554, 3.257009898199158, 3.476299418154614, 1.2001999653923916, 8.199389894601328, 5.477197952541941, 11.30542309411397, 9.241303405746278, 6.8478723026728066, 5.6855125313268475, 34.11156796661805, 9.16986806169284, 8.187882036329661, 3.9507854487343614, 2.2689798022856427, 6.407321781649493, 5.786177527545758, 7.074002679967177, 10.431894867844912, 15.011378183064483, 3.6528809082787457, 15.369139213772398, 44.83080390227978, 5.322284151074898, 4.091330731629123, 6.868262394030727, 3.453237583644033, 18.29644713622378, 4.987891973264879, 23.518043741172, 2.3308864355807946, 14.467685368570214, 5.801434041162127, 6.650682103450864, 15.714585669699652, 32.7449875923943, 2.3686678941203403, 13.72306214536584, 20.576032140095037, 1.7431334119657782, 4.079502721141106, 13.98977776031719, 7.313280128143228, 57.78330204299696, 6.217854490063203, 7.711238679459225, 3.6448438819906013, 1.2969392985021921, 1.4359549383830872, 8.805044148288735, 2.742840850489095, 2.1953530327367914, 71.0325752849416, 0.18649678927260904, 9.766907918715102, 6.624141895434337, 17.54589892198323, 19.176180412856887, 2.193930145936728, 15.414387215589201, 5.124695070256885, 45.24306455743456, 9.464619451338613, 6.08099669661335, 5.123843095321877, 4.980454449705285, 31.884848305537385, 24.34315986044806, 4.2402503733510395, 6.803967866675889, 12.596767546804847, 9.708781733135938, 16.76912283328881, 1.9668038520392943, 10.100123104741652, 3.2580758832872645, 0.14979891384647137, 17.53383921631889, 21.102321322410088, 8.720269686059382, 5.6263051434847675, 22.18982318723878, 6.533724264724676, 8.661634092882622, 33.85736559435005, 0.6282265439195791, 3.384676516846938, 20.27462555174647, 10.417324886807767, 13.248386210743826, 11.331653442797304, 2.008663180379759, 10.204949790907571, 20.37184243965441, 7.2818765272879356, 0.38658654860331626, 2.9831500233189203, 0.21410123368017936, 1.880258340459447, 3.6878825404821507, 32.25132793594892, 13.486338447816502, 20.030805925289577, 20.8358727855297, 8.360406533531862, 3.4591492294966963, 3.092731085375704, 1.2859531089095215, 48.92637543390377, 52.31164409686597, 2.599257860391112, 3.9554322872618433, 18.756153479053957, 11.032579354989098, 4.458919884291227, 1.6910715196239163, 2.966509400538567, 2.966509400538567]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.602798649616368, "mean_inference_ms": 7.047432283840511, "mean_action_processing_ms": 1.1881489132533998, "mean_env_wait_ms": 0.7593675129891616, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.019773244857788086, "StateBufferConnector_ms": 0.014743685722351074, "ViewRequirementAgentConnector_ms": 0.33944272994995117}, "num_episodes": 23, "episode_return_max": 239.19766183566514, "episode_return_min": -47.32663140233925, "episode_return_mean": 38.55890017636858, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1456000, "num_agent_steps_trained": 1456000, "num_env_steps_sampled": 364000, "num_env_steps_trained": 364000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 213.62465128233305, "num_env_steps_trained_throughput_per_sec": 213.62465128233305, "timesteps_total": 364000, "num_env_steps_sampled_lifetime": 364000, "num_agent_steps_sampled_lifetime": 1456000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1456000, "timers": {"training_iteration_time_ms": 33720.888, "restore_workers_time_ms": 0.014, "training_step_time_ms": 33720.846, "sample_time_ms": 21899.405, "learn_time_ms": 11805.809, "learn_throughput": 338.816, "synch_weights_time_ms": 14.651}, "counters": {"num_env_steps_sampled": 364000, "num_env_steps_trained": 364000, "num_agent_steps_sampled": 1456000, "num_agent_steps_trained": 1456000}, "done": false, "training_iteration": 91, "trial_id": "d163c_00000", "date": "2024-08-16_13-26-17", "timestamp": 1723794977, "time_this_iter_s": 18.72916293144226, "time_total_s": 2195.6922585964203, "pid": 81201, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16ba27ca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2195.6922585964203, "iterations_since_restore": 91, "perf": {"cpu_util_percent": 26.703703703703702, "ram_util_percent": 70.12962962962963}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.512653667239285, "cur_kl_coeff": 6.179809570312498e-05, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.978285526740488, "policy_loss": -0.0036347659439016035, "vf_loss": 0.9819200286474178, "vf_explained_var": 0.2489951876736192, "kl": 0.004288999448828214, "entropy": 0.35361648768028886, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 172935.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.955607593784887, "cur_kl_coeff": 0.05, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.6228865428576396, "policy_loss": -0.0053921319977947016, "vf_loss": 2.6277014814356647, "vf_explained_var": 0.6122662743248006, "kl": 0.011543889261402214, "entropy": 1.1804039900265042, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 172935.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 368000, "num_env_steps_trained": 368000, "num_agent_steps_sampled": 1472000, "num_agent_steps_trained": 1472000}, "env_runners": {"episode_reward_max": 239.19766183566514, "episode_reward_min": -47.32663140233925, "episode_reward_mean": 48.35883601952539, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -68.55942032233861, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 198.01999999999998, "predator_policy": 75.90195941215629}, "policy_reward_mean": {"prey_policy": 13.122124275751212, "predator_policy": 11.057293734011482}, "custom_metrics": {}, "hist_stats": {"episode_reward": [45.29040234744945, 1.736728456977321, 35.02478657939559, 82.8525881674526, 59.14841762834891, 3.7799999999999634, -24.91365582126939, -47.32663140233925, 11.495494485404391, 6.27362439132548, 8.239727930547703, 7.583456269300935, 4.889999999999939, 10.64671169245785, -36.31299361440722, 3.7299999999999636, 4.600385244958651, 12.259999999999929, 21.967072736473014, 18.959504132901323, 62.15413615150372, 3.9999999999999587, 77.2857351392002, 4.717278125343792, 3.8099999999999627, 9.959191489339705, 69.5045801028991, 72.64369041832862, 3.1150507463992634, 74.42529072712419, 5.074727923253791, 11.872195440634435, 84.86056865088221, 108.75695065675703, 31.957788888385743, 7.8869212695244375, 7.197022877961482, 46.90211971590687, 7.403817226594868, 61.30590853036422, 16.482769041424383, 6.2686678941202585, 82.83000000000081, 140.07643194251267, -39.578533224602154, 9.485235712154292, 4.4225918254106515, 3.6599999999999664, 98.85000000000086, -43.02229455053663, 80.47428421434402, 87.6610476591365, 5.740963911207202, 24.77590820376821, 50.29853290798474, 57.601669432000634, 61.693186012142746, 29.08948726740963, 85.5706687422073, 5.382717212228626, 66.58460277444719, 161.2, 7.677382716221184, 139.95630514348292, 8.533645551676102, -15.469119944885515, 239.19766183566514, 99.49502103464663, 111.89776388530785, 59.35213973057915, 9.73999999999992, 154.35, 5.318603342619728, 130.01523207021262, 29.20710299127884, 80.25710295781639, 4.9214616632971815, 32.711397332579864, 3.7599999999999643, 32.570143435967864, 184.63862599043864, 91.96650940053964, 184.28943087686045, 8.401486537402366, 159.30000000000007, 4.126941031893938, 11.537446847358407, 99.0200000000002, 219.13073689012404, 5.046028753161354, 197.97999999999962, 211.2558171035446, 4.359449312084322, 74.53371721161943, 5.321539143762662, 192.52094916600709, 5.379389597985238, 6.640754936356329, 9.80955860703333, 46.82684651715863], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [36.03605298845172, 0.5100229662786425, -4.786847935271945, -11.461894329242337, 1.8082790796848622, 17.02505860115298, 38.209114328434616, 31.800672438680532, 42.74425893630837, -9.182156938576558, -5.828110006178351, 1.4031037631536913, -36.05175072834381, -45.11708696824872, -68.55942032233861, -57.16546258175182, 2.0000000000000013, -10.154984516092455, -4.103618057251643, 2.0000000000000013, -3.979034939809778, 2.0000000000000013, -15.252709217940618, -3.7740625325889523, 0.5631703750761942, 2.0000000000000013, -2.566983218881308, 1.3261520396917927, -51.92191613694133, -60.78337428302798, -38.49948400853258, 1.447628519964211, -2.593537558697955, 2.0000000000000013, -3.883363959654142, -4.352399959594852, -1.5837983309106005, -22.898078623194223, -0.01006035638005444, -0.8839555803997268, 9.744354651464635, 46.30757651434087, 2.0000000000000013, 2.0000000000000013, -19.489760519336667, 63.520533757780555, 2.0000000000000013, -1.399396783812391, 0.7498000346076098, -1.616299418154645, 2.0000000000000013, -5.717396357803522, 51.25770853375119, -2.29985493071389, 2.0000000000000013, 58.11030558432777, -32.42156796661838, -7.7448173152935915, -5.432758347596216, 67.71938158965574, -5.07454366266738, 1.472970001986064, -4.704137831888415, 3.716153065009917, -6.0798267304643305, 65.49712233043667, 23.34160074746942, 66.39332978723606, 19.376207058311472, -37.57150622328025, -5.072671856135371, 2.0000000000000013, -16.552661841905977, 2.0000000000000013, -21.641972035717203, 40.038156037187726, 0.5761564010479784, -9.97091097860408, 53.404921355528295, -4.551128969776803, -33.976804220669884, 2.0000000000000013, -11.823062145365881, 2.0000000000000013, 74.26799561011039, -13.757161162170906, -1.5608408126913593, 123.56799227374619, -49.82961693099917, -54.845498464743166, 2.0000000000000013, -6.443857457368093, 1.2587810164167719, -1.7779723714988969, 0.49404506161691425, -7.075044148288772, -0.8528408504891096, 94.76464696726357, -63.14704287057476, -51.09432375417601, 62.083234400193426, 2.0000000000000013, 19.392123810051196, 31.54684451424438, 1.6770337652705556, -13.544387215589241, -43.19612339365305, 17.604271969729844, 2.0000000000000013, 32.75291676003324, 47.289545550294505, 0.20782633667927514, -25.3569194982737, 30.822097344432006, 0.24923689405818855, 17.796032133324303, 70.95270235864237, -7.6875828963763215, 1.7786502795822907, -15.131859752681569, 58.82928037696487, -5.602876590548007, -15.733839216318655, 159.25020108615354, -2.5040204468705047, -19.641187845377473, 47.02096548176361, 65.1192113309979, 1.435684873315423, -8.09739767924658, -21.81974779815968, -28.134964284995473, 137.2175872707285, 78.32077249634432, 21.006540858699676, 54.82276907839447, 3.431178193605336, 95.12626906852503, 28.217594905018053, 0.5577525949996717, 0.47812347271206684, 1.593413451396685, 152.2558987663198, -1.1031500233189404, -2.2495375383218397, 2.0000000000000013, -7.418647627662882, 91.69621331411119, -0.9791082187447742, -10.680467500796267, 52.05257122458914, 16.384975970197797, -1.4572225309880096, 2.0000000000000013, -48.70525623298948, -19.821365965200442, -0.5137322051511262, -2.2809579425018764, 23.273908263101916, -20.492497661176905, 2.0000000000000013, 176.48863458652372, 84.28526781699948, 1.748222782462421, 132.00672777058898, 15.007685453576912, -20.85915587849236, -8.315110406781647, 0.8303267696155127, 144.97381784813177, -0.4842392102896538, -2.0694608609277765, -15.747490822753345, 0.24218283426812443, 96.52454421700779, 2.0000000000000013, 65.93431132938518, 103.42613653886097, -9.338661475137325, 2.0000000000000013, 0.23589078532281244, 196.04, 198.01999999999998, -17.487099600777103, 2.0000000000000013, -0.26543554259254787, 69.04796890724548, 2.0000000000000013, 1.093260033187975, -3.038496130584929, -8.469983639413064, 179.1869959141319, -10.951323637977147, 1.800171170804398, -2.8243436333440064, 0.6577947188997441, -6.04806400257372, 2.0000000000000013, 24.937978533479356, -1.7886605156553856], "policy_predator_policy_reward": [4.577254444664398, 4.167071948054936, 14.322814473758292, 3.6626562477332376, 9.762613223691657, 6.42883567486667, 9.663079116863694, 3.179722283472336, 15.313174750387033, 10.273140880230322, 7.638110006178312, 0.5668962368463101, 51.268628866458506, 4.986553008864611, 2.4962920895949057, 75.90195941215629, 11.219275738860114, 8.431203262636776, 0.6236243913255529, 7.753618057251608, 5.647080214817753, 4.571682655539768, 10.096953647200415, 16.513274372630267, 0.0, 2.3268296249238074, 2.5404282551408635, 9.34711461650654, 5.485528308461374, 70.90676849710086, 40.249484008532235, 0.5323714800357904, 4.473537558697915, 0.7203852449587054, 5.703363959654103, 14.792399959594821, 30.410134196440595, 16.038815494136983, 13.296927833796483, 6.556592235884161, 3.2046775752745917, 2.897527410423875, 0.0, 0.0, 21.73982902786349, 11.5151328728916, 0.8596650109570554, 3.257009898199158, 3.476299418154614, 1.2001999653923916, 8.199389894601328, 5.477197952541941, 11.30542309411397, 9.241303405746278, 6.8478723026728066, 5.6855125313268475, 34.11156796661805, 9.16986806169284, 8.187882036329661, 3.9507854487343614, 2.2689798022856427, 6.407321781649493, 5.786177527545758, 7.074002679967177, 10.431894867844912, 15.011378183064483, 3.6528809082787457, 15.369139213772398, 44.83080390227978, 5.322284151074898, 4.091330731629123, 6.868262394030727, 3.453237583644033, 18.29644713622378, 4.987891973264879, 23.518043741172, 2.3308864355807946, 14.467685368570214, 5.801434041162127, 6.650682103450864, 15.714585669699652, 32.7449875923943, 2.3686678941203403, 13.72306214536584, 20.576032140095037, 1.7431334119657782, 4.079502721141106, 13.98977776031719, 7.313280128143228, 57.78330204299696, 6.217854490063203, 7.711238679459225, 3.6448438819906013, 1.2969392985021921, 1.4359549383830872, 8.805044148288735, 2.742840850489095, 2.1953530327367914, 71.0325752849416, 0.18649678927260904, 9.766907918715102, 6.624141895434337, 17.54589892198323, 19.176180412856887, 2.193930145936728, 15.414387215589201, 5.124695070256885, 45.24306455743456, 9.464619451338613, 6.08099669661335, 5.123843095321877, 4.980454449705285, 31.884848305537385, 24.34315986044806, 4.2402503733510395, 6.803967866675889, 12.596767546804847, 9.708781733135938, 16.76912283328881, 1.9668038520392943, 10.100123104741652, 3.2580758832872645, 0.14979891384647137, 17.53383921631889, 21.102321322410088, 8.720269686059382, 5.6263051434847675, 22.18982318723878, 6.533724264724676, 8.661634092882622, 33.85736559435005, 0.6282265439195791, 3.384676516846938, 20.27462555174647, 10.417324886807767, 13.248386210743826, 11.331653442797304, 2.008663180379759, 10.204949790907571, 20.37184243965441, 7.2818765272879356, 0.38658654860331626, 2.9831500233189203, 0.21410123368017936, 1.880258340459447, 3.6878825404821507, 32.25132793594892, 13.486338447816502, 20.030805925289577, 20.8358727855297, 8.360406533531862, 3.4591492294966963, 3.092731085375704, 1.2859531089095215, 48.92637543390377, 52.31164409686597, 2.599257860391112, 3.9554322872618433, 18.756153479053957, 11.032579354989098, 4.458919884291227, 1.6910715196239163, 2.966509400538567, 2.966509400538567, 16.406266245934425, 20.868751406760573, 24.87940891075855, 12.696343911918131, 1.1096732303844887, 12.386182151868256, 0.3469410318939811, 6.333700071217385, 6.404602784173632, 20.638152051670286, 0.4954557829922386, 0.0, 30.22470882210048, 19.54558019977882, 5.510544153502531, 6.874146074796181, 0.0, 1.704109214677189, 16.072462120821037, 14.65045458350137, 0.6173611440136904, 2.007523710663226, 0.3637172116194344, 3.1220310927544976, 2.5488946450704, 4.717880596089248, 10.154612814966603, 11.649324076321875, 1.9265768540166386, 12.603965211141382, 5.57974801024613, 3.2275558405545044, 6.942065478957954, 6.915557130649136, 13.406549450460659, 10.270979048874743]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.774802603975729, "mean_inference_ms": 7.566463815907521, "mean_action_processing_ms": 1.2747838925798651, "mean_env_wait_ms": 0.7589726901089908, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021332263946533203, "StateBufferConnector_ms": 0.016112804412841797, "ViewRequirementAgentConnector_ms": 0.3693811893463135}, "num_episodes": 18, "episode_return_max": 239.19766183566514, "episode_return_min": -47.32663140233925, "episode_return_mean": 48.35883601952539, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1472000, "num_agent_steps_trained": 1472000, "num_env_steps_sampled": 368000, "num_env_steps_trained": 368000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 24.82646242073558, "num_env_steps_trained_throughput_per_sec": 24.82646242073558, "timesteps_total": 368000, "num_env_steps_sampled_lifetime": 368000, "num_agent_steps_sampled_lifetime": 1472000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1472000, "timers": {"training_iteration_time_ms": 48291.331, "restore_workers_time_ms": 0.014, "training_step_time_ms": 48291.287, "sample_time_ms": 21940.554, "learn_time_ms": 26326.664, "learn_throughput": 151.937, "synch_weights_time_ms": 22.879}, "counters": {"num_env_steps_sampled": 368000, "num_env_steps_trained": 368000, "num_agent_steps_sampled": 1472000, "num_agent_steps_trained": 1472000}, "done": false, "training_iteration": 92, "trial_id": "d163c_00000", "date": "2024-08-16_13-28-58", "timestamp": 1723795138, "time_this_iter_s": 161.34520721435547, "time_total_s": 2357.0374658107758, "pid": 81201, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16ba5c8b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2357.0374658107758, "iterations_since_restore": 92, "perf": {"cpu_util_percent": 28.20740740740741, "ram_util_percent": 70.07407407407408}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.064646230109785, "cur_kl_coeff": 3.089904785156249e-05, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.8613891710995366, "policy_loss": -0.0033531929437741245, "vf_loss": 0.8647422346330824, "vf_explained_var": 0.768092679977417, "kl": 0.004200017286442154, "entropy": 0.31622146341220414, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 174825.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.4060375897341935, "cur_kl_coeff": 0.05, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.756817480622145, "policy_loss": -0.010007295663907099, "vf_loss": 3.766175174082398, "vf_explained_var": 0.667541388765214, "kl": 0.012991994642036113, "entropy": 1.1539798845689764, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 174825.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_agent_steps_sampled": 1488000, "num_agent_steps_trained": 1488000}, "env_runners": {"episode_reward_max": 339.28083921197947, "episode_reward_min": -43.02229455053663, "episode_reward_mean": 62.788024034344716, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -63.14704287057476, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 198.01999999999998, "predator_policy": 71.0325752849416}, "policy_reward_mean": {"prey_policy": 21.244939083041313, "predator_policy": 10.149072934131048}, "custom_metrics": {}, "hist_stats": {"episode_reward": [21.967072736473014, 18.959504132901323, 62.15413615150372, 3.9999999999999587, 77.2857351392002, 4.717278125343792, 3.8099999999999627, 9.959191489339705, 69.5045801028991, 72.64369041832862, 3.1150507463992634, 74.42529072712419, 5.074727923253791, 11.872195440634435, 84.86056865088221, 108.75695065675703, 31.957788888385743, 7.8869212695244375, 7.197022877961482, 46.90211971590687, 7.403817226594868, 61.30590853036422, 16.482769041424383, 6.2686678941202585, 82.83000000000081, 140.07643194251267, -39.578533224602154, 9.485235712154292, 4.4225918254106515, 3.6599999999999664, 98.85000000000086, -43.02229455053663, 80.47428421434402, 87.6610476591365, 5.740963911207202, 24.77590820376821, 50.29853290798474, 57.601669432000634, 61.693186012142746, 29.08948726740963, 85.5706687422073, 5.382717212228626, 66.58460277444719, 161.2, 7.677382716221184, 139.95630514348292, 8.533645551676102, -15.469119944885515, 239.19766183566514, 99.49502103464663, 111.89776388530785, 59.35213973057915, 9.73999999999992, 154.35, 5.318603342619728, 130.01523207021262, 29.20710299127884, 80.25710295781639, 4.9214616632971815, 32.711397332579864, 3.7599999999999643, 32.570143435967864, 184.63862599043864, 91.96650940053964, 184.28943087686045, 8.401486537402366, 159.30000000000007, 4.126941031893938, 11.537446847358407, 99.0200000000002, 219.13073689012404, 5.046028753161354, 197.97999999999962, 211.2558171035446, 4.359449312084322, 74.53371721161943, 5.321539143762662, 192.52094916600709, 5.379389597985238, 6.640754936356329, 9.80955860703333, 46.82684651715863, 93.9782454691551, 162.81223788743057, 178.10999999999984, 138.3800000000002, 15.473118016243642, 190.6999999999999, 38.289999999999445, 3.9699999999999593, 339.28083921197947, 14.700745939381278, 119.45480160698953, 9.227399765694305, 21.788257708338772, 3.9192580837206257, -38.07339169776795, 11.495484323075868, 170.6121128887819, 157.7987346345135], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-1.5837983309106005, -22.898078623194223, -0.01006035638005444, -0.8839555803997268, 9.744354651464635, 46.30757651434087, 2.0000000000000013, 2.0000000000000013, -19.489760519336667, 63.520533757780555, 2.0000000000000013, -1.399396783812391, 0.7498000346076098, -1.616299418154645, 2.0000000000000013, -5.717396357803522, 51.25770853375119, -2.29985493071389, 2.0000000000000013, 58.11030558432777, -32.42156796661838, -7.7448173152935915, -5.432758347596216, 67.71938158965574, -5.07454366266738, 1.472970001986064, -4.704137831888415, 3.716153065009917, -6.0798267304643305, 65.49712233043667, 23.34160074746942, 66.39332978723606, 19.376207058311472, -37.57150622328025, -5.072671856135371, 2.0000000000000013, -16.552661841905977, 2.0000000000000013, -21.641972035717203, 40.038156037187726, 0.5761564010479784, -9.97091097860408, 53.404921355528295, -4.551128969776803, -33.976804220669884, 2.0000000000000013, -11.823062145365881, 2.0000000000000013, 74.26799561011039, -13.757161162170906, -1.5608408126913593, 123.56799227374619, -49.82961693099917, -54.845498464743166, 2.0000000000000013, -6.443857457368093, 1.2587810164167719, -1.7779723714988969, 0.49404506161691425, -7.075044148288772, -0.8528408504891096, 94.76464696726357, -63.14704287057476, -51.09432375417601, 62.083234400193426, 2.0000000000000013, 19.392123810051196, 31.54684451424438, 1.6770337652705556, -13.544387215589241, -43.19612339365305, 17.604271969729844, 2.0000000000000013, 32.75291676003324, 47.289545550294505, 0.20782633667927514, -25.3569194982737, 30.822097344432006, 0.24923689405818855, 17.796032133324303, 70.95270235864237, -7.6875828963763215, 1.7786502795822907, -15.131859752681569, 58.82928037696487, -5.602876590548007, -15.733839216318655, 159.25020108615354, -2.5040204468705047, -19.641187845377473, 47.02096548176361, 65.1192113309979, 1.435684873315423, -8.09739767924658, -21.81974779815968, -28.134964284995473, 137.2175872707285, 78.32077249634432, 21.006540858699676, 54.82276907839447, 3.431178193605336, 95.12626906852503, 28.217594905018053, 0.5577525949996717, 0.47812347271206684, 1.593413451396685, 152.2558987663198, -1.1031500233189404, -2.2495375383218397, 2.0000000000000013, -7.418647627662882, 91.69621331411119, -0.9791082187447742, -10.680467500796267, 52.05257122458914, 16.384975970197797, -1.4572225309880096, 2.0000000000000013, -48.70525623298948, -19.821365965200442, -0.5137322051511262, -2.2809579425018764, 23.273908263101916, -20.492497661176905, 2.0000000000000013, 176.48863458652372, 84.28526781699948, 1.748222782462421, 132.00672777058898, 15.007685453576912, -20.85915587849236, -8.315110406781647, 0.8303267696155127, 144.97381784813177, -0.4842392102896538, -2.0694608609277765, -15.747490822753345, 0.24218283426812443, 96.52454421700779, 2.0000000000000013, 65.93431132938518, 103.42613653886097, -9.338661475137325, 2.0000000000000013, 0.23589078532281244, 196.04, 198.01999999999998, -17.487099600777103, 2.0000000000000013, -0.26543554259254787, 69.04796890724548, 2.0000000000000013, 1.093260033187975, -3.038496130584929, -8.469983639413064, 179.1869959141319, -10.951323637977147, 1.800171170804398, -2.8243436333440064, 0.6577947188997441, -6.04806400257372, 2.0000000000000013, 24.937978533479356, -1.7886605156553856, -9.930756643983878, 85.16000000000005, 2.0000000000000013, 156.6992302319606, 174.64223076239256, -0.3860626241083822, -3.5482414320001254, 134.82013330657378, -2.595045232131284, 11.53698368600094, -30.658744717362243, 186.25547018171204, 0.5650978677912365, 28.44368636381498, 1.6426266057190597, 1.8416355512883766, 190.1, 140.5148231262325, 1.3622838745779593, -16.528700957839895, -0.4773320237708807, 115.85, -4.959147679748937, -5.627687441238426, 11.89999999999996, -10.938621394653074, 1.0309160670337538, 1.5453282333548128, -50.70985659814047, -50.598031524148375, 1.262081139562067, 2.0000000000000013, 151.1184303472208, 2.0000000000000013, 133.2555482198223, 18.830000000000286], "policy_predator_policy_reward": [30.410134196440595, 16.038815494136983, 13.296927833796483, 6.556592235884161, 3.2046775752745917, 2.897527410423875, 0.0, 0.0, 21.73982902786349, 11.5151328728916, 0.8596650109570554, 3.257009898199158, 3.476299418154614, 1.2001999653923916, 8.199389894601328, 5.477197952541941, 11.30542309411397, 9.241303405746278, 6.8478723026728066, 5.6855125313268475, 34.11156796661805, 9.16986806169284, 8.187882036329661, 3.9507854487343614, 2.2689798022856427, 6.407321781649493, 5.786177527545758, 7.074002679967177, 10.431894867844912, 15.011378183064483, 3.6528809082787457, 15.369139213772398, 44.83080390227978, 5.322284151074898, 4.091330731629123, 6.868262394030727, 3.453237583644033, 18.29644713622378, 4.987891973264879, 23.518043741172, 2.3308864355807946, 14.467685368570214, 5.801434041162127, 6.650682103450864, 15.714585669699652, 32.7449875923943, 2.3686678941203403, 13.72306214536584, 20.576032140095037, 1.7431334119657782, 4.079502721141106, 13.98977776031719, 7.313280128143228, 57.78330204299696, 6.217854490063203, 7.711238679459225, 3.6448438819906013, 1.2969392985021921, 1.4359549383830872, 8.805044148288735, 2.742840850489095, 2.1953530327367914, 71.0325752849416, 0.18649678927260904, 9.766907918715102, 6.624141895434337, 17.54589892198323, 19.176180412856887, 2.193930145936728, 15.414387215589201, 5.124695070256885, 45.24306455743456, 9.464619451338613, 6.08099669661335, 5.123843095321877, 4.980454449705285, 31.884848305537385, 24.34315986044806, 4.2402503733510395, 6.803967866675889, 12.596767546804847, 9.708781733135938, 16.76912283328881, 1.9668038520392943, 10.100123104741652, 3.2580758832872645, 0.14979891384647137, 17.53383921631889, 21.102321322410088, 8.720269686059382, 5.6263051434847675, 22.18982318723878, 6.533724264724676, 8.661634092882622, 33.85736559435005, 0.6282265439195791, 3.384676516846938, 20.27462555174647, 10.417324886807767, 13.248386210743826, 11.331653442797304, 2.008663180379759, 10.204949790907571, 20.37184243965441, 7.2818765272879356, 0.38658654860331626, 2.9831500233189203, 0.21410123368017936, 1.880258340459447, 3.6878825404821507, 32.25132793594892, 13.486338447816502, 20.030805925289577, 20.8358727855297, 8.360406533531862, 3.4591492294966963, 3.092731085375704, 1.2859531089095215, 48.92637543390377, 52.31164409686597, 2.599257860391112, 3.9554322872618433, 18.756153479053957, 11.032579354989098, 4.458919884291227, 1.6910715196239163, 2.966509400538567, 2.966509400538567, 16.406266245934425, 20.868751406760573, 24.87940891075855, 12.696343911918131, 1.1096732303844887, 12.386182151868256, 0.3469410318939811, 6.333700071217385, 6.404602784173632, 20.638152051670286, 0.4954557829922386, 0.0, 30.22470882210048, 19.54558019977882, 5.510544153502531, 6.874146074796181, 0.0, 1.704109214677189, 16.072462120821037, 14.65045458350137, 0.6173611440136904, 2.007523710663226, 0.3637172116194344, 3.1220310927544976, 2.5488946450704, 4.717880596089248, 10.154612814966603, 11.649324076321875, 1.9265768540166386, 12.603965211141382, 5.57974801024613, 3.2275558405545044, 6.942065478957954, 6.915557130649136, 13.406549450460659, 10.270979048874743, 9.601253424841188, 9.147748688297632, 1.5437014232701332, 2.569306232200002, 1.5277692376074292, 2.326062624108377, 1.7498666934262188, 5.358241432000087, 3.6731844548886805, 2.8579951074853067, 31.35874471736225, 3.7445298182879734, 5.404041615966207, 3.8771741524277847, 0.14836444871162477, 0.3373733942809416, 4.815784919319348, 3.850231166427518, 13.257614027399342, 16.60954899524421, 2.300223278412808, 1.7819103523473971, 11.326148369309953, 8.488086517371716, 11.709892049786207, 9.11698705320505, 0.9290839329662475, 0.4139298503658534, 4.570105834365292, 58.6643905901556, 5.258913742616494, 2.9744894408973828, 8.8280003715816, 8.665682169979645, 2.6547387168119254, 3.058447697879291]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.9430713473231553, "mean_inference_ms": 8.073773776396619, "mean_action_processing_ms": 1.3592881258908787, "mean_env_wait_ms": 0.7579438531252333, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016797423362731934, "StateBufferConnector_ms": 0.015239119529724121, "ViewRequirementAgentConnector_ms": 0.3305654525756836}, "num_episodes": 18, "episode_return_max": 339.28083921197947, "episode_return_min": -43.02229455053663, "episode_return_mean": 62.788024034344716, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1488000, "num_agent_steps_trained": 1488000, "num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 234.63252281802326, "num_env_steps_trained_throughput_per_sec": 234.63252281802326, "timesteps_total": 372000, "num_env_steps_sampled_lifetime": 372000, "num_agent_steps_sampled_lifetime": 1488000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1488000, "timers": {"training_iteration_time_ms": 48517.242, "restore_workers_time_ms": 0.016, "training_step_time_ms": 48517.192, "sample_time_ms": 21698.024, "learn_time_ms": 26794.965, "learn_throughput": 149.282, "synch_weights_time_ms": 23.057}, "counters": {"num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_agent_steps_sampled": 1488000, "num_agent_steps_trained": 1488000}, "done": false, "training_iteration": 93, "trial_id": "d163c_00000", "date": "2024-08-16_13-29-16", "timestamp": 1723795156, "time_this_iter_s": 17.052242755889893, "time_total_s": 2374.0897085666656, "pid": 81201, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16b97bee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2374.0897085666656, "iterations_since_restore": 93, "perf": {"cpu_util_percent": 42.092, "ram_util_percent": 73.096}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.7651070968183893, "cur_kl_coeff": 1.5449523925781246e-05, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.5669482354133848, "policy_loss": -0.0033211345537984497, "vf_loss": 1.5702693508100258, "vf_explained_var": 0.7256271701010447, "kl": 0.0029857914274829056, "entropy": 0.3091455922082618, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 176715.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.687921526223894, "cur_kl_coeff": 0.05, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.282407372086136, "policy_loss": -0.0064099582165933, "vf_loss": 5.288000175435707, "vf_explained_var": 0.6174189658076675, "kl": 0.016342925712884194, "entropy": 1.0764195324882628, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 176715.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 376000, "num_env_steps_trained": 376000, "num_agent_steps_sampled": 1504000, "num_agent_steps_trained": 1504000}, "env_runners": {"episode_reward_max": 355.08650359516014, "episode_reward_min": -43.02229455053663, "episode_reward_mean": 83.66238672985814, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -63.14704287057476, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 198.01999999999998, "predator_policy": 71.0325752849416}, "policy_reward_mean": {"prey_policy": 30.81518305044402, "predator_policy": 11.016010314485088}, "custom_metrics": {}, "hist_stats": {"episode_reward": [16.482769041424383, 6.2686678941202585, 82.83000000000081, 140.07643194251267, -39.578533224602154, 9.485235712154292, 4.4225918254106515, 3.6599999999999664, 98.85000000000086, -43.02229455053663, 80.47428421434402, 87.6610476591365, 5.740963911207202, 24.77590820376821, 50.29853290798474, 57.601669432000634, 61.693186012142746, 29.08948726740963, 85.5706687422073, 5.382717212228626, 66.58460277444719, 161.2, 7.677382716221184, 139.95630514348292, 8.533645551676102, -15.469119944885515, 239.19766183566514, 99.49502103464663, 111.89776388530785, 59.35213973057915, 9.73999999999992, 154.35, 5.318603342619728, 130.01523207021262, 29.20710299127884, 80.25710295781639, 4.9214616632971815, 32.711397332579864, 3.7599999999999643, 32.570143435967864, 184.63862599043864, 91.96650940053964, 184.28943087686045, 8.401486537402366, 159.30000000000007, 4.126941031893938, 11.537446847358407, 99.0200000000002, 219.13073689012404, 5.046028753161354, 197.97999999999962, 211.2558171035446, 4.359449312084322, 74.53371721161943, 5.321539143762662, 192.52094916600709, 5.379389597985238, 6.640754936356329, 9.80955860703333, 46.82684651715863, 93.9782454691551, 162.81223788743057, 178.10999999999984, 138.3800000000002, 15.473118016243642, 190.6999999999999, 38.289999999999445, 3.9699999999999593, 339.28083921197947, 14.700745939381278, 119.45480160698953, 9.227399765694305, 21.788257708338772, 3.9192580837206257, -38.07339169776795, 11.495484323075868, 170.6121128887819, 157.7987346345135, 18.34231448813709, 4.5311810273563395, 49.45394349492595, 194.83999999999966, 251.4454184025367, 210.70516129804176, 178.5469533273153, 310.7800000000001, 191.20245798629372, 174.00999999999988, 4.527623741492102, 193.90771552672135, -38.955141191443865, 355.08650359516014, 33.03636320268875, 173.47855744095818, 202.8322258869996, 145.0009214932414, 190.9499999999997, 3.9699999999999593, -30.789978998351835, 66.29359977904844], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-33.976804220669884, 2.0000000000000013, -11.823062145365881, 2.0000000000000013, 74.26799561011039, -13.757161162170906, -1.5608408126913593, 123.56799227374619, -49.82961693099917, -54.845498464743166, 2.0000000000000013, -6.443857457368093, 1.2587810164167719, -1.7779723714988969, 0.49404506161691425, -7.075044148288772, -0.8528408504891096, 94.76464696726357, -63.14704287057476, -51.09432375417601, 62.083234400193426, 2.0000000000000013, 19.392123810051196, 31.54684451424438, 1.6770337652705556, -13.544387215589241, -43.19612339365305, 17.604271969729844, 2.0000000000000013, 32.75291676003324, 47.289545550294505, 0.20782633667927514, -25.3569194982737, 30.822097344432006, 0.24923689405818855, 17.796032133324303, 70.95270235864237, -7.6875828963763215, 1.7786502795822907, -15.131859752681569, 58.82928037696487, -5.602876590548007, -15.733839216318655, 159.25020108615354, -2.5040204468705047, -19.641187845377473, 47.02096548176361, 65.1192113309979, 1.435684873315423, -8.09739767924658, -21.81974779815968, -28.134964284995473, 137.2175872707285, 78.32077249634432, 21.006540858699676, 54.82276907839447, 3.431178193605336, 95.12626906852503, 28.217594905018053, 0.5577525949996717, 0.47812347271206684, 1.593413451396685, 152.2558987663198, -1.1031500233189404, -2.2495375383218397, 2.0000000000000013, -7.418647627662882, 91.69621331411119, -0.9791082187447742, -10.680467500796267, 52.05257122458914, 16.384975970197797, -1.4572225309880096, 2.0000000000000013, -48.70525623298948, -19.821365965200442, -0.5137322051511262, -2.2809579425018764, 23.273908263101916, -20.492497661176905, 2.0000000000000013, 176.48863458652372, 84.28526781699948, 1.748222782462421, 132.00672777058898, 15.007685453576912, -20.85915587849236, -8.315110406781647, 0.8303267696155127, 144.97381784813177, -0.4842392102896538, -2.0694608609277765, -15.747490822753345, 0.24218283426812443, 96.52454421700779, 2.0000000000000013, 65.93431132938518, 103.42613653886097, -9.338661475137325, 2.0000000000000013, 0.23589078532281244, 196.04, 198.01999999999998, -17.487099600777103, 2.0000000000000013, -0.26543554259254787, 69.04796890724548, 2.0000000000000013, 1.093260033187975, -3.038496130584929, -8.469983639413064, 179.1869959141319, -10.951323637977147, 1.800171170804398, -2.8243436333440064, 0.6577947188997441, -6.04806400257372, 2.0000000000000013, 24.937978533479356, -1.7886605156553856, -9.930756643983878, 85.16000000000005, 2.0000000000000013, 156.6992302319606, 174.64223076239256, -0.3860626241083822, -3.5482414320001254, 134.82013330657378, -2.595045232131284, 11.53698368600094, -30.658744717362243, 186.25547018171204, 0.5650978677912365, 28.44368636381498, 1.6426266057190597, 1.8416355512883766, 190.1, 140.5148231262325, 1.3622838745779593, -16.528700957839895, -0.4773320237708807, 115.85, -4.959147679748937, -5.627687441238426, 11.89999999999996, -10.938621394653074, 1.0309160670337538, 1.5453282333548128, -50.70985659814047, -50.598031524148375, 1.262081139562067, 2.0000000000000013, 151.1184303472208, 2.0000000000000013, 133.2555482198223, 18.830000000000286, 9.752680195050042, -2.7557280194868046, 2.0000000000000013, -1.3274210015743604, -57.5125601289865, -18.190681858701357, 191.9590550825045, -7.764597137324561, 164.59660391469373, 51.05921965253477, 6.434277252022737, 186.06093390668786, -18.158000197442323, 170.36201823622815, 122.78, 183.14319774376042, 176.07873497063878, -12.157935594014006, -4.7658162512536775, 167.85870560689136, 2.0000000000000013, -1.9377591889115828, 186.31316564231292, 2.0000000000000013, -46.796247281134775, -52.14276820730955, 141.36230884433772, 196.69090519813537, 2.0000000000000013, 18.04539999393677, 2.7109044068021126, 135.82060681981187, 165.07371218151974, 32.408867056355, -11.684714460101219, 135.65, 180.78674468003302, 0.4988988174166095, 1.807820643802006, 1.5066306189827745, -41.29101526943853, -61.71238048783978, 14.25763730902223, -26.263437419932224], "policy_predator_policy_reward": [15.714585669699652, 32.7449875923943, 2.3686678941203403, 13.72306214536584, 20.576032140095037, 1.7431334119657782, 4.079502721141106, 13.98977776031719, 7.313280128143228, 57.78330204299696, 6.217854490063203, 7.711238679459225, 3.6448438819906013, 1.2969392985021921, 1.4359549383830872, 8.805044148288735, 2.742840850489095, 2.1953530327367914, 71.0325752849416, 0.18649678927260904, 9.766907918715102, 6.624141895434337, 17.54589892198323, 19.176180412856887, 2.193930145936728, 15.414387215589201, 5.124695070256885, 45.24306455743456, 9.464619451338613, 6.08099669661335, 5.123843095321877, 4.980454449705285, 31.884848305537385, 24.34315986044806, 4.2402503733510395, 6.803967866675889, 12.596767546804847, 9.708781733135938, 16.76912283328881, 1.9668038520392943, 10.100123104741652, 3.2580758832872645, 0.14979891384647137, 17.53383921631889, 21.102321322410088, 8.720269686059382, 5.6263051434847675, 22.18982318723878, 6.533724264724676, 8.661634092882622, 33.85736559435005, 0.6282265439195791, 3.384676516846938, 20.27462555174647, 10.417324886807767, 13.248386210743826, 11.331653442797304, 2.008663180379759, 10.204949790907571, 20.37184243965441, 7.2818765272879356, 0.38658654860331626, 2.9831500233189203, 0.21410123368017936, 1.880258340459447, 3.6878825404821507, 32.25132793594892, 13.486338447816502, 20.030805925289577, 20.8358727855297, 8.360406533531862, 3.4591492294966963, 3.092731085375704, 1.2859531089095215, 48.92637543390377, 52.31164409686597, 2.599257860391112, 3.9554322872618433, 18.756153479053957, 11.032579354989098, 4.458919884291227, 1.6910715196239163, 2.966509400538567, 2.966509400538567, 16.406266245934425, 20.868751406760573, 24.87940891075855, 12.696343911918131, 1.1096732303844887, 12.386182151868256, 0.3469410318939811, 6.333700071217385, 6.404602784173632, 20.638152051670286, 0.4954557829922386, 0.0, 30.22470882210048, 19.54558019977882, 5.510544153502531, 6.874146074796181, 0.0, 1.704109214677189, 16.072462120821037, 14.65045458350137, 0.6173611440136904, 2.007523710663226, 0.3637172116194344, 3.1220310927544976, 2.5488946450704, 4.717880596089248, 10.154612814966603, 11.649324076321875, 1.9265768540166386, 12.603965211141382, 5.57974801024613, 3.2275558405545044, 6.942065478957954, 6.915557130649136, 13.406549450460659, 10.270979048874743, 9.601253424841188, 9.147748688297632, 1.5437014232701332, 2.569306232200002, 1.5277692376074292, 2.326062624108377, 1.7498666934262188, 5.358241432000087, 3.6731844548886805, 2.8579951074853067, 31.35874471736225, 3.7445298182879734, 5.404041615966207, 3.8771741524277847, 0.14836444871162477, 0.3373733942809416, 4.815784919319348, 3.850231166427518, 13.257614027399342, 16.60954899524421, 2.300223278412808, 1.7819103523473971, 11.326148369309953, 8.488086517371716, 11.709892049786207, 9.11698705320505, 0.9290839329662475, 0.4139298503658534, 4.570105834365292, 58.6643905901556, 5.258913742616494, 2.9744894408973828, 8.8280003715816, 8.665682169979645, 2.6547387168119254, 3.058447697879291, 5.670036253436562, 5.675326059136871, 0.7514762841954898, 3.1071257447352365, 67.53915996569538, 57.61802551691843, 1.0709449174955032, 9.574597137324522, 25.38148938867449, 10.408105446634062, 9.688682066973394, 8.521268072358188, 19.718000197442567, 6.624935091087357, 4.856802256239578, 0.0, 13.44452066892796, 13.837137940741245, 4.321294393108623, 6.5958162512536385, 3.7677591889115467, 0.6976237414921544, 3.686834357687066, 1.9077155267216734, 2.7243946496482603, 57.25947964735218, 2.147782299194073, 14.885507253493003, 5.612294499779363, 7.3786687089727145, 7.759572447526325, 27.187473766817995, 2.202719031261666, 3.146927617863356, 8.439862970572976, 12.59577298276949, 8.213255319966983, 1.451101182583392, 0.18217935619799558, 0.47336938101722686, 69.95835989507178, 2.2550568638546724, 31.508952628841243, 46.79044726111625]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.1941293624824345, "mean_inference_ms": 8.659496565490814, "mean_action_processing_ms": 1.4427790179669113, "mean_env_wait_ms": 0.7567178841665807, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01776266098022461, "StateBufferConnector_ms": 0.011434197425842285, "ViewRequirementAgentConnector_ms": 0.32024824619293213}, "num_episodes": 22, "episode_return_max": 355.08650359516014, "episode_return_min": -43.02229455053663, "episode_return_mean": 83.66238672985814, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1504000, "num_agent_steps_trained": 1504000, "num_env_steps_sampled": 376000, "num_env_steps_trained": 376000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 241.68138819702475, "num_env_steps_trained_throughput_per_sec": 241.68138819702475, "timesteps_total": 376000, "num_env_steps_sampled_lifetime": 376000, "num_agent_steps_sampled_lifetime": 1504000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1504000, "timers": {"training_iteration_time_ms": 48530.931, "restore_workers_time_ms": 0.016, "training_step_time_ms": 48530.881, "sample_time_ms": 21774.924, "learn_time_ms": 26731.729, "learn_throughput": 149.635, "synch_weights_time_ms": 23.07}, "counters": {"num_env_steps_sampled": 376000, "num_env_steps_trained": 376000, "num_agent_steps_sampled": 1504000, "num_agent_steps_trained": 1504000}, "done": false, "training_iteration": 94, "trial_id": "d163c_00000", "date": "2024-08-16_13-29-32", "timestamp": 1723795172, "time_this_iter_s": 16.555617094039917, "time_total_s": 2390.6453256607056, "pid": 81201, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16b8193a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2390.6453256607056, "iterations_since_restore": 94, "perf": {"cpu_util_percent": 31.613043478260867, "ram_util_percent": 72.08695652173913}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.9327213701116976, "cur_kl_coeff": 7.724761962890623e-06, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.6295644242454458, "policy_loss": -0.00432578049940131, "vf_loss": 0.6338900727806268, "vf_explained_var": 0.5327918314429188, "kl": 0.01729718291150293, "entropy": 0.429839465983961, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 178605.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.7314099985140343, "cur_kl_coeff": 0.05, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.767593652230722, "policy_loss": -0.007421700907230535, "vf_loss": 5.774424546610111, "vf_explained_var": 0.5615136441730317, "kl": 0.01181616873254204, "entropy": 1.0293399489745891, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 178605.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 380000, "num_env_steps_trained": 380000, "num_agent_steps_sampled": 1520000, "num_agent_steps_trained": 1520000}, "env_runners": {"episode_reward_max": 376.7090194864685, "episode_reward_min": -38.955141191443865, "episode_reward_mean": 112.4112820481901, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -61.71238048783978, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 69.95835989507178}, "policy_reward_mean": {"prey_policy": 46.81382366858631, "predator_policy": 9.391817355508797}, "custom_metrics": {}, "hist_stats": {"episode_reward": [85.5706687422073, 5.382717212228626, 66.58460277444719, 161.2, 7.677382716221184, 139.95630514348292, 8.533645551676102, -15.469119944885515, 239.19766183566514, 99.49502103464663, 111.89776388530785, 59.35213973057915, 9.73999999999992, 154.35, 5.318603342619728, 130.01523207021262, 29.20710299127884, 80.25710295781639, 4.9214616632971815, 32.711397332579864, 3.7599999999999643, 32.570143435967864, 184.63862599043864, 91.96650940053964, 184.28943087686045, 8.401486537402366, 159.30000000000007, 4.126941031893938, 11.537446847358407, 99.0200000000002, 219.13073689012404, 5.046028753161354, 197.97999999999962, 211.2558171035446, 4.359449312084322, 74.53371721161943, 5.321539143762662, 192.52094916600709, 5.379389597985238, 6.640754936356329, 9.80955860703333, 46.82684651715863, 93.9782454691551, 162.81223788743057, 178.10999999999984, 138.3800000000002, 15.473118016243642, 190.6999999999999, 38.289999999999445, 3.9699999999999593, 339.28083921197947, 14.700745939381278, 119.45480160698953, 9.227399765694305, 21.788257708338772, 3.9192580837206257, -38.07339169776795, 11.495484323075868, 170.6121128887819, 157.7987346345135, 18.34231448813709, 4.5311810273563395, 49.45394349492595, 194.83999999999966, 251.4454184025367, 210.70516129804176, 178.5469533273153, 310.7800000000001, 191.20245798629372, 174.00999999999988, 4.527623741492102, 193.90771552672135, -38.955141191443865, 355.08650359516014, 33.03636320268875, 173.47855744095818, 202.8322258869996, 145.0009214932414, 190.9499999999997, 3.9699999999999593, -30.789978998351835, 66.29359977904844, 197.93976215350733, 376.7090194864685, 201.9899999999996, 4.006639866943229, 337.6161944370296, 190.03999999999974, 34.79452196366649, 373.01025403863287, 188.67999999999972, 3.934233751282334, 274.25963406434266, 187.08145292673203, 109.73000000000017, 8.46999999999997, 319.56090948360566, 257.88685790946545, 288.0099999999998, 197.97999999999965], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [70.95270235864237, -7.6875828963763215, 1.7786502795822907, -15.131859752681569, 58.82928037696487, -5.602876590548007, -15.733839216318655, 159.25020108615354, -2.5040204468705047, -19.641187845377473, 47.02096548176361, 65.1192113309979, 1.435684873315423, -8.09739767924658, -21.81974779815968, -28.134964284995473, 137.2175872707285, 78.32077249634432, 21.006540858699676, 54.82276907839447, 3.431178193605336, 95.12626906852503, 28.217594905018053, 0.5577525949996717, 0.47812347271206684, 1.593413451396685, 152.2558987663198, -1.1031500233189404, -2.2495375383218397, 2.0000000000000013, -7.418647627662882, 91.69621331411119, -0.9791082187447742, -10.680467500796267, 52.05257122458914, 16.384975970197797, -1.4572225309880096, 2.0000000000000013, -48.70525623298948, -19.821365965200442, -0.5137322051511262, -2.2809579425018764, 23.273908263101916, -20.492497661176905, 2.0000000000000013, 176.48863458652372, 84.28526781699948, 1.748222782462421, 132.00672777058898, 15.007685453576912, -20.85915587849236, -8.315110406781647, 0.8303267696155127, 144.97381784813177, -0.4842392102896538, -2.0694608609277765, -15.747490822753345, 0.24218283426812443, 96.52454421700779, 2.0000000000000013, 65.93431132938518, 103.42613653886097, -9.338661475137325, 2.0000000000000013, 0.23589078532281244, 196.04, 198.01999999999998, -17.487099600777103, 2.0000000000000013, -0.26543554259254787, 69.04796890724548, 2.0000000000000013, 1.093260033187975, -3.038496130584929, -8.469983639413064, 179.1869959141319, -10.951323637977147, 1.800171170804398, -2.8243436333440064, 0.6577947188997441, -6.04806400257372, 2.0000000000000013, 24.937978533479356, -1.7886605156553856, -9.930756643983878, 85.16000000000005, 2.0000000000000013, 156.6992302319606, 174.64223076239256, -0.3860626241083822, -3.5482414320001254, 134.82013330657378, -2.595045232131284, 11.53698368600094, -30.658744717362243, 186.25547018171204, 0.5650978677912365, 28.44368636381498, 1.6426266057190597, 1.8416355512883766, 190.1, 140.5148231262325, 1.3622838745779593, -16.528700957839895, -0.4773320237708807, 115.85, -4.959147679748937, -5.627687441238426, 11.89999999999996, -10.938621394653074, 1.0309160670337538, 1.5453282333548128, -50.70985659814047, -50.598031524148375, 1.262081139562067, 2.0000000000000013, 151.1184303472208, 2.0000000000000013, 133.2555482198223, 18.830000000000286, 9.752680195050042, -2.7557280194868046, 2.0000000000000013, -1.3274210015743604, -57.5125601289865, -18.190681858701357, 191.9590550825045, -7.764597137324561, 164.59660391469373, 51.05921965253477, 6.434277252022737, 186.06093390668786, -18.158000197442323, 170.36201823622815, 122.78, 183.14319774376042, 176.07873497063878, -12.157935594014006, -4.7658162512536775, 167.85870560689136, 2.0000000000000013, -1.9377591889115828, 186.31316564231292, 2.0000000000000013, -46.796247281134775, -52.14276820730955, 141.36230884433772, 196.69090519813537, 2.0000000000000013, 18.04539999393677, 2.7109044068021126, 135.82060681981187, 165.07371218151974, 32.408867056355, -11.684714460101219, 135.65, 180.78674468003302, 0.4988988174166095, 1.807820643802006, 1.5066306189827745, -41.29101526943853, -61.71238048783978, 14.25763730902223, -26.263437419932224, 192.08583408861875, -1.4177204068638687, 183.89846116916243, 184.68275571629053, 1.7512492549563599, 200.0, 1.6226149302406445, 0.4699555275546918, 174.83760718907413, 151.42425528181798, 0.8794202392253109, 187.08199769031344, 9.919999999999959, 22.79247861308152, 170.16133140452837, 193.2499699062947, 184.8103429753714, -21.470952089047632, -6.441183572681277, -9.366479604646736, 133.2098146069377, 119.84134870270736, 2.0000000000000013, 171.47602515657542, -1.122436054814628, 105.31682083956633, 4.256291733455155, -13.34116984333691, 135.28147820426574, 175.75823347520316, 174.3522350077121, 79.22000000000018, 131.46442561494632, 151.90601802937454, 1.4940409319469263, 195.13618802154076], "policy_predator_policy_reward": [12.596767546804847, 9.708781733135938, 16.76912283328881, 1.9668038520392943, 10.100123104741652, 3.2580758832872645, 0.14979891384647137, 17.53383921631889, 21.102321322410088, 8.720269686059382, 5.6263051434847675, 22.18982318723878, 6.533724264724676, 8.661634092882622, 33.85736559435005, 0.6282265439195791, 3.384676516846938, 20.27462555174647, 10.417324886807767, 13.248386210743826, 11.331653442797304, 2.008663180379759, 10.204949790907571, 20.37184243965441, 7.2818765272879356, 0.38658654860331626, 2.9831500233189203, 0.21410123368017936, 1.880258340459447, 3.6878825404821507, 32.25132793594892, 13.486338447816502, 20.030805925289577, 20.8358727855297, 8.360406533531862, 3.4591492294966963, 3.092731085375704, 1.2859531089095215, 48.92637543390377, 52.31164409686597, 2.599257860391112, 3.9554322872618433, 18.756153479053957, 11.032579354989098, 4.458919884291227, 1.6910715196239163, 2.966509400538567, 2.966509400538567, 16.406266245934425, 20.868751406760573, 24.87940891075855, 12.696343911918131, 1.1096732303844887, 12.386182151868256, 0.3469410318939811, 6.333700071217385, 6.404602784173632, 20.638152051670286, 0.4954557829922386, 0.0, 30.22470882210048, 19.54558019977882, 5.510544153502531, 6.874146074796181, 0.0, 1.704109214677189, 16.072462120821037, 14.65045458350137, 0.6173611440136904, 2.007523710663226, 0.3637172116194344, 3.1220310927544976, 2.5488946450704, 4.717880596089248, 10.154612814966603, 11.649324076321875, 1.9265768540166386, 12.603965211141382, 5.57974801024613, 3.2275558405545044, 6.942065478957954, 6.915557130649136, 13.406549450460659, 10.270979048874743, 9.601253424841188, 9.147748688297632, 1.5437014232701332, 2.569306232200002, 1.5277692376074292, 2.326062624108377, 1.7498666934262188, 5.358241432000087, 3.6731844548886805, 2.8579951074853067, 31.35874471736225, 3.7445298182879734, 5.404041615966207, 3.8771741524277847, 0.14836444871162477, 0.3373733942809416, 4.815784919319348, 3.850231166427518, 13.257614027399342, 16.60954899524421, 2.300223278412808, 1.7819103523473971, 11.326148369309953, 8.488086517371716, 11.709892049786207, 9.11698705320505, 0.9290839329662475, 0.4139298503658534, 4.570105834365292, 58.6643905901556, 5.258913742616494, 2.9744894408973828, 8.8280003715816, 8.665682169979645, 2.6547387168119254, 3.058447697879291, 5.670036253436562, 5.675326059136871, 0.7514762841954898, 3.1071257447352365, 67.53915996569538, 57.61802551691843, 1.0709449174955032, 9.574597137324522, 25.38148938867449, 10.408105446634062, 9.688682066973394, 8.521268072358188, 19.718000197442567, 6.624935091087357, 4.856802256239578, 0.0, 13.44452066892796, 13.837137940741245, 4.321294393108623, 6.5958162512536385, 3.7677591889115467, 0.6976237414921544, 3.686834357687066, 1.9077155267216734, 2.7243946496482603, 57.25947964735218, 2.147782299194073, 14.885507253493003, 5.612294499779363, 7.3786687089727145, 7.759572447526325, 27.187473766817995, 2.202719031261666, 3.146927617863356, 8.439862970572976, 12.59577298276949, 8.213255319966983, 1.451101182583392, 0.18217935619799558, 0.47336938101722686, 69.95835989507178, 2.2550568638546724, 31.508952628841243, 46.79044726111625, 3.9754169482428106, 3.296231523509986, 4.048568026075097, 4.0792345749404495, 0.0, 0.23875074504364155, 0.4440249367026271, 1.4700444724453097, 9.32211422850541, 2.0322177376321036, 1.0805797607746905, 0.9980023096865599, 0.1845219636668015, 1.8975213869185932, 2.1859201687666303, 7.413032559043191, 23.13095208904789, 2.20965702462858, 10.066429045563469, 9.675467883046842, 13.511742864999206, 7.696727889698364, 7.091432630805906, 6.513995139350957, 2.5331791604336584, 3.0024360548146074, 14.931169843336876, 2.6237082665448295, 7.690798415878794, 0.8303993882580003, 2.3839073032095617, 1.930715598543753, 4.423981970625442, 0.21557438505362075, 0.9093624828570664, 0.4404085636552362]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.1817063617925454, "mean_inference_ms": 8.667984149229607, "mean_action_processing_ms": 1.4366305991367847, "mean_env_wait_ms": 0.7552317538389499, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020449519157409668, "StateBufferConnector_ms": 0.01301419734954834, "ViewRequirementAgentConnector_ms": 0.32151007652282715}, "num_episodes": 18, "episode_return_max": 376.7090194864685, "episode_return_min": -38.955141191443865, "episode_return_mean": 112.4112820481901, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1520000, "num_agent_steps_trained": 1520000, "num_env_steps_sampled": 380000, "num_env_steps_trained": 380000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 247.8807151360381, "num_env_steps_trained_throughput_per_sec": 247.8807151360381, "timesteps_total": 380000, "num_env_steps_sampled_lifetime": 380000, "num_agent_steps_sampled_lifetime": 1520000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1520000, "timers": {"training_iteration_time_ms": 48545.222, "restore_workers_time_ms": 0.016, "training_step_time_ms": 48545.173, "sample_time_ms": 21801.664, "learn_time_ms": 26719.277, "learn_throughput": 149.705, "synch_weights_time_ms": 23.083}, "counters": {"num_env_steps_sampled": 380000, "num_env_steps_trained": 380000, "num_agent_steps_sampled": 1520000, "num_agent_steps_trained": 1520000}, "done": false, "training_iteration": 95, "trial_id": "d163c_00000", "date": "2024-08-16_13-29-48", "timestamp": 1723795188, "time_this_iter_s": 16.140224933624268, "time_total_s": 2406.78555059433, "pid": 81201, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16ba2aee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2406.78555059433, "iterations_since_restore": 95, "perf": {"cpu_util_percent": 29.85217391304347, "ram_util_percent": 72.01304347826088}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.9905135869979858, "cur_kl_coeff": 7.724761962890623e-06, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.7795479797496998, "policy_loss": -0.00332595904939192, "vf_loss": 1.782873857399774, "vf_explained_var": 0.6650919271209252, "kl": 0.011059328312436036, "entropy": 0.5543762997660057, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 180495.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.7355974935349963, "cur_kl_coeff": 0.05, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.290180527722394, "policy_loss": -0.006062686589556357, "vf_loss": 6.295598098966811, "vf_explained_var": 0.5941132765283029, "kl": 0.012902051603333234, "entropy": 1.0308854416249291, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 180495.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_agent_steps_sampled": 1536000, "num_agent_steps_trained": 1536000}, "env_runners": {"episode_reward_max": 376.7090194864685, "episode_reward_min": -50.30498557097288, "episode_reward_mean": 136.18916710397232, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -194.18807263134286, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 155.70935129515138}, "policy_reward_mean": {"prey_policy": 56.008905661500314, "predator_policy": 12.085677890485908}, "custom_metrics": {}, "hist_stats": {"episode_reward": [91.96650940053964, 184.28943087686045, 8.401486537402366, 159.30000000000007, 4.126941031893938, 11.537446847358407, 99.0200000000002, 219.13073689012404, 5.046028753161354, 197.97999999999962, 211.2558171035446, 4.359449312084322, 74.53371721161943, 5.321539143762662, 192.52094916600709, 5.379389597985238, 6.640754936356329, 9.80955860703333, 46.82684651715863, 93.9782454691551, 162.81223788743057, 178.10999999999984, 138.3800000000002, 15.473118016243642, 190.6999999999999, 38.289999999999445, 3.9699999999999593, 339.28083921197947, 14.700745939381278, 119.45480160698953, 9.227399765694305, 21.788257708338772, 3.9192580837206257, -38.07339169776795, 11.495484323075868, 170.6121128887819, 157.7987346345135, 18.34231448813709, 4.5311810273563395, 49.45394349492595, 194.83999999999966, 251.4454184025367, 210.70516129804176, 178.5469533273153, 310.7800000000001, 191.20245798629372, 174.00999999999988, 4.527623741492102, 193.90771552672135, -38.955141191443865, 355.08650359516014, 33.03636320268875, 173.47855744095818, 202.8322258869996, 145.0009214932414, 190.9499999999997, 3.9699999999999593, -30.789978998351835, 66.29359977904844, 197.93976215350733, 376.7090194864685, 201.9899999999996, 4.006639866943229, 337.6161944370296, 190.03999999999974, 34.79452196366649, 373.01025403863287, 188.67999999999972, 3.934233751282334, 274.25963406434266, 187.08145292673203, 109.73000000000017, 8.46999999999997, 319.56090948360566, 257.88685790946545, 288.0099999999998, 197.97999999999965, 276.7565883491433, 188.05206087874, 188.95999999999972, 272.0900000000001, 183.6214531841374, 153.53823376503152, 153.41410964247092, 191.45719219288497, 176.22724480258248, 5.09135652976737, 190.07, 364.5646838721761, 202.0071210949547, -50.30498557097288, 201.95789070397473, 185.68000000000006, 19.47396868467221, 189.41000000000003, 129.2976473234366, 367.39860136702634, -1.9380235893631055, 239.745711313483, 188.0861094998636], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [84.28526781699948, 1.748222782462421, 132.00672777058898, 15.007685453576912, -20.85915587849236, -8.315110406781647, 0.8303267696155127, 144.97381784813177, -0.4842392102896538, -2.0694608609277765, -15.747490822753345, 0.24218283426812443, 96.52454421700779, 2.0000000000000013, 65.93431132938518, 103.42613653886097, -9.338661475137325, 2.0000000000000013, 0.23589078532281244, 196.04, 198.01999999999998, -17.487099600777103, 2.0000000000000013, -0.26543554259254787, 69.04796890724548, 2.0000000000000013, 1.093260033187975, -3.038496130584929, -8.469983639413064, 179.1869959141319, -10.951323637977147, 1.800171170804398, -2.8243436333440064, 0.6577947188997441, -6.04806400257372, 2.0000000000000013, 24.937978533479356, -1.7886605156553856, -9.930756643983878, 85.16000000000005, 2.0000000000000013, 156.6992302319606, 174.64223076239256, -0.3860626241083822, -3.5482414320001254, 134.82013330657378, -2.595045232131284, 11.53698368600094, -30.658744717362243, 186.25547018171204, 0.5650978677912365, 28.44368636381498, 1.6426266057190597, 1.8416355512883766, 190.1, 140.5148231262325, 1.3622838745779593, -16.528700957839895, -0.4773320237708807, 115.85, -4.959147679748937, -5.627687441238426, 11.89999999999996, -10.938621394653074, 1.0309160670337538, 1.5453282333548128, -50.70985659814047, -50.598031524148375, 1.262081139562067, 2.0000000000000013, 151.1184303472208, 2.0000000000000013, 133.2555482198223, 18.830000000000286, 9.752680195050042, -2.7557280194868046, 2.0000000000000013, -1.3274210015743604, -57.5125601289865, -18.190681858701357, 191.9590550825045, -7.764597137324561, 164.59660391469373, 51.05921965253477, 6.434277252022737, 186.06093390668786, -18.158000197442323, 170.36201823622815, 122.78, 183.14319774376042, 176.07873497063878, -12.157935594014006, -4.7658162512536775, 167.85870560689136, 2.0000000000000013, -1.9377591889115828, 186.31316564231292, 2.0000000000000013, -46.796247281134775, -52.14276820730955, 141.36230884433772, 196.69090519813537, 2.0000000000000013, 18.04539999393677, 2.7109044068021126, 135.82060681981187, 165.07371218151974, 32.408867056355, -11.684714460101219, 135.65, 180.78674468003302, 0.4988988174166095, 1.807820643802006, 1.5066306189827745, -41.29101526943853, -61.71238048783978, 14.25763730902223, -26.263437419932224, 192.08583408861875, -1.4177204068638687, 183.89846116916243, 184.68275571629053, 1.7512492549563599, 200.0, 1.6226149302406445, 0.4699555275546918, 174.83760718907413, 151.42425528181798, 0.8794202392253109, 187.08199769031344, 9.919999999999959, 22.79247861308152, 170.16133140452837, 193.2499699062947, 184.8103429753714, -21.470952089047632, -6.441183572681277, -9.366479604646736, 133.2098146069377, 119.84134870270736, 2.0000000000000013, 171.47602515657542, -1.122436054814628, 105.31682083956633, 4.256291733455155, -13.34116984333691, 135.28147820426574, 175.75823347520316, 174.3522350077121, 79.22000000000018, 131.46442561494632, 151.90601802937454, 1.4940409319469263, 195.13618802154076, 200.0, -194.18807263134286, 170.1540982671573, -25.813130434913514, 182.44029187603633, 0.949247626035404, 175.9842622077201, 90.4132888772179, 174.2458617117499, 2.0000000000000013, 150.0549900509842, -24.655747847266497, 126.13200209311597, -31.616377013382174, 183.2534550504562, -0.430872056281258, -18.58140374779744, 152.13041630609436, -19.59845603889372, -4.647303268169432, -136.1625695158018, 189.41095746363322, 179.19253083151403, 178.40127759690023, -89.73656264609093, 200.0, -68.58791778688509, -64.16600133077758, -5.12571424634738, 200.0, -42.861190670252626, 178.16858326810393, 2.0000000000000013, -27.52811123349434, -41.931154026545975, 185.01798194577634, -3.6242988342778846, 107.79479668604013, 176.03693070876534, 185.43622605391653, -23.49658654197196, -28.088477666639637, 127.52614126909405, 103.31476871446688, -9.882941745361682, 182.9366586057758], "policy_predator_policy_reward": [2.966509400538567, 2.966509400538567, 16.406266245934425, 20.868751406760573, 24.87940891075855, 12.696343911918131, 1.1096732303844887, 12.386182151868256, 0.3469410318939811, 6.333700071217385, 6.404602784173632, 20.638152051670286, 0.4954557829922386, 0.0, 30.22470882210048, 19.54558019977882, 5.510544153502531, 6.874146074796181, 0.0, 1.704109214677189, 16.072462120821037, 14.65045458350137, 0.6173611440136904, 2.007523710663226, 0.3637172116194344, 3.1220310927544976, 2.5488946450704, 4.717880596089248, 10.154612814966603, 11.649324076321875, 1.9265768540166386, 12.603965211141382, 5.57974801024613, 3.2275558405545044, 6.942065478957954, 6.915557130649136, 13.406549450460659, 10.270979048874743, 9.601253424841188, 9.147748688297632, 1.5437014232701332, 2.569306232200002, 1.5277692376074292, 2.326062624108377, 1.7498666934262188, 5.358241432000087, 3.6731844548886805, 2.8579951074853067, 31.35874471736225, 3.7445298182879734, 5.404041615966207, 3.8771741524277847, 0.14836444871162477, 0.3373733942809416, 4.815784919319348, 3.850231166427518, 13.257614027399342, 16.60954899524421, 2.300223278412808, 1.7819103523473971, 11.326148369309953, 8.488086517371716, 11.709892049786207, 9.11698705320505, 0.9290839329662475, 0.4139298503658534, 4.570105834365292, 58.6643905901556, 5.258913742616494, 2.9744894408973828, 8.8280003715816, 8.665682169979645, 2.6547387168119254, 3.058447697879291, 5.670036253436562, 5.675326059136871, 0.7514762841954898, 3.1071257447352365, 67.53915996569538, 57.61802551691843, 1.0709449174955032, 9.574597137324522, 25.38148938867449, 10.408105446634062, 9.688682066973394, 8.521268072358188, 19.718000197442567, 6.624935091087357, 4.856802256239578, 0.0, 13.44452066892796, 13.837137940741245, 4.321294393108623, 6.5958162512536385, 3.7677591889115467, 0.6976237414921544, 3.686834357687066, 1.9077155267216734, 2.7243946496482603, 57.25947964735218, 2.147782299194073, 14.885507253493003, 5.612294499779363, 7.3786687089727145, 7.759572447526325, 27.187473766817995, 2.202719031261666, 3.146927617863356, 8.439862970572976, 12.59577298276949, 8.213255319966983, 1.451101182583392, 0.18217935619799558, 0.47336938101722686, 69.95835989507178, 2.2550568638546724, 31.508952628841243, 46.79044726111625, 3.9754169482428106, 3.296231523509986, 4.048568026075097, 4.0792345749404495, 0.0, 0.23875074504364155, 0.4440249367026271, 1.4700444724453097, 9.32211422850541, 2.0322177376321036, 1.0805797607746905, 0.9980023096865599, 0.1845219636668015, 1.8975213869185932, 2.1859201687666303, 7.413032559043191, 23.13095208904789, 2.20965702462858, 10.066429045563469, 9.675467883046842, 13.511742864999206, 7.696727889698364, 7.091432630805906, 6.513995139350957, 2.5331791604336584, 3.0024360548146074, 14.931169843336876, 2.6237082665448295, 7.690798415878794, 0.8303993882580003, 2.3839073032095617, 1.930715598543753, 4.423981970625442, 0.21557438505362075, 0.9093624828570664, 0.4404085636552362, 155.70935129515138, 115.23530968533463, 24.2627471003708, 19.448345946126178, 1.0107523739645974, 4.559708123963683, 4.167096439608866, 1.5253524754531518, 6.754138288250081, 0.6214531841376606, 26.255747847266743, 1.8832437140472784, 21.09473181534731, 37.80375274738963, 5.7271598173489116, 2.9074493813613875, 25.58120918090452, 17.097023063381418, 8.208659797936827, 21.128456038893958, 0.6590425363667723, 136.1625695158018, 1.7875372733612171, 5.1833381704006305, 89.73656264609093, 2.007121094954704, 4.770551890939902, 77.67838165574992, 6.905714246347342, 0.17789070397510928, 43.541190670252625, 6.831416731896076, 18.707691288121183, 26.294388630045134, 42.34115402654597, 3.98201805422366, 8.642594336569285, 16.48455513510475, 2.8002407576625683, 3.1252038466819148, 24.364074628969895, 25.282965990279145, 5.529829126450949, 3.3749722034710756, 3.0633413942242376, 11.969051245225495]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.1690466100440258, "mean_inference_ms": 8.621069115327842, "mean_action_processing_ms": 1.427780447208811, "mean_env_wait_ms": 0.7532631263855749, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020421981811523438, "StateBufferConnector_ms": 0.013017416000366211, "ViewRequirementAgentConnector_ms": 0.32391417026519775}, "num_episodes": 23, "episode_return_max": 376.7090194864685, "episode_return_min": -50.30498557097288, "episode_return_mean": 136.18916710397232, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1536000, "num_agent_steps_trained": 1536000, "num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 233.07315015763527, "num_env_steps_trained_throughput_per_sec": 233.07315015763527, "timesteps_total": 384000, "num_env_steps_sampled_lifetime": 384000, "num_agent_steps_sampled_lifetime": 1536000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1536000, "timers": {"training_iteration_time_ms": 48748.487, "restore_workers_time_ms": 0.016, "training_step_time_ms": 48748.437, "sample_time_ms": 21823.179, "learn_time_ms": 26901.215, "learn_throughput": 148.692, "synch_weights_time_ms": 22.853}, "counters": {"num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_agent_steps_sampled": 1536000, "num_agent_steps_trained": 1536000}, "done": false, "training_iteration": 96, "trial_id": "d163c_00000", "date": "2024-08-16_13-30-06", "timestamp": 1723795206, "time_this_iter_s": 17.165536403656006, "time_total_s": 2423.951086997986, "pid": 81201, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16b97bee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2423.951086997986, "iterations_since_restore": 96, "perf": {"cpu_util_percent": 33.272000000000006, "ram_util_percent": 71.944}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.070984805071795, "cur_kl_coeff": 7.724761962890623e-06, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.5586099655185112, "policy_loss": -0.005680273529376204, "vf_loss": 0.5642901695712849, "vf_explained_var": 0.1881736863542486, "kl": 0.009365617684728557, "entropy": 0.682352457033894, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 182385.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.77797056483844, "cur_kl_coeff": 0.05, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.628634806789418, "policy_loss": -0.005517118653804852, "vf_loss": 6.633827241514095, "vf_explained_var": 0.7309714669588382, "kl": 0.006493493460436555, "entropy": 0.8611377087850419, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 182385.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 388000, "num_env_steps_trained": 388000, "num_agent_steps_sampled": 1552000, "num_agent_steps_trained": 1552000}, "env_runners": {"episode_reward_max": 376.7090194864685, "episode_reward_min": -50.30498557097288, "episode_reward_mean": 159.3532593005152, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -194.18807263134286, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 155.70935129515138}, "policy_reward_mean": {"prey_policy": 67.31190571448802, "predator_policy": 12.364723935769634}, "custom_metrics": {}, "hist_stats": {"episode_reward": [46.82684651715863, 93.9782454691551, 162.81223788743057, 178.10999999999984, 138.3800000000002, 15.473118016243642, 190.6999999999999, 38.289999999999445, 3.9699999999999593, 339.28083921197947, 14.700745939381278, 119.45480160698953, 9.227399765694305, 21.788257708338772, 3.9192580837206257, -38.07339169776795, 11.495484323075868, 170.6121128887819, 157.7987346345135, 18.34231448813709, 4.5311810273563395, 49.45394349492595, 194.83999999999966, 251.4454184025367, 210.70516129804176, 178.5469533273153, 310.7800000000001, 191.20245798629372, 174.00999999999988, 4.527623741492102, 193.90771552672135, -38.955141191443865, 355.08650359516014, 33.03636320268875, 173.47855744095818, 202.8322258869996, 145.0009214932414, 190.9499999999997, 3.9699999999999593, -30.789978998351835, 66.29359977904844, 197.93976215350733, 376.7090194864685, 201.9899999999996, 4.006639866943229, 337.6161944370296, 190.03999999999974, 34.79452196366649, 373.01025403863287, 188.67999999999972, 3.934233751282334, 274.25963406434266, 187.08145292673203, 109.73000000000017, 8.46999999999997, 319.56090948360566, 257.88685790946545, 288.0099999999998, 197.97999999999965, 276.7565883491433, 188.05206087874, 188.95999999999972, 272.0900000000001, 183.6214531841374, 153.53823376503152, 153.41410964247092, 191.45719219288497, 176.22724480258248, 5.09135652976737, 190.07, 364.5646838721761, 202.0071210949547, -50.30498557097288, 201.95789070397473, 185.68000000000006, 19.47396868467221, 189.41000000000003, 129.2976473234366, 367.39860136702634, -1.9380235893631055, 239.745711313483, 188.0861094998636, 166.09999999999997, 341.91518626528466, 23.29558918949279, 174.8118979859256, 258.20000000000016, 19.310778450200516, 198.82999999999964, 160.32999999999998, 187.99999999999972, 155.95000000000005, 151.88592165373012, 295.25476749283484, 371.15999999999997, 367.7104746778511, 108.93000000000019, 320.9677177024086, 132.58720921587172, 371.78943243642334], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [24.937978533479356, -1.7886605156553856, -9.930756643983878, 85.16000000000005, 2.0000000000000013, 156.6992302319606, 174.64223076239256, -0.3860626241083822, -3.5482414320001254, 134.82013330657378, -2.595045232131284, 11.53698368600094, -30.658744717362243, 186.25547018171204, 0.5650978677912365, 28.44368636381498, 1.6426266057190597, 1.8416355512883766, 190.1, 140.5148231262325, 1.3622838745779593, -16.528700957839895, -0.4773320237708807, 115.85, -4.959147679748937, -5.627687441238426, 11.89999999999996, -10.938621394653074, 1.0309160670337538, 1.5453282333548128, -50.70985659814047, -50.598031524148375, 1.262081139562067, 2.0000000000000013, 151.1184303472208, 2.0000000000000013, 133.2555482198223, 18.830000000000286, 9.752680195050042, -2.7557280194868046, 2.0000000000000013, -1.3274210015743604, -57.5125601289865, -18.190681858701357, 191.9590550825045, -7.764597137324561, 164.59660391469373, 51.05921965253477, 6.434277252022737, 186.06093390668786, -18.158000197442323, 170.36201823622815, 122.78, 183.14319774376042, 176.07873497063878, -12.157935594014006, -4.7658162512536775, 167.85870560689136, 2.0000000000000013, -1.9377591889115828, 186.31316564231292, 2.0000000000000013, -46.796247281134775, -52.14276820730955, 141.36230884433772, 196.69090519813537, 2.0000000000000013, 18.04539999393677, 2.7109044068021126, 135.82060681981187, 165.07371218151974, 32.408867056355, -11.684714460101219, 135.65, 180.78674468003302, 0.4988988174166095, 1.807820643802006, 1.5066306189827745, -41.29101526943853, -61.71238048783978, 14.25763730902223, -26.263437419932224, 192.08583408861875, -1.4177204068638687, 183.89846116916243, 184.68275571629053, 1.7512492549563599, 200.0, 1.6226149302406445, 0.4699555275546918, 174.83760718907413, 151.42425528181798, 0.8794202392253109, 187.08199769031344, 9.919999999999959, 22.79247861308152, 170.16133140452837, 193.2499699062947, 184.8103429753714, -21.470952089047632, -6.441183572681277, -9.366479604646736, 133.2098146069377, 119.84134870270736, 2.0000000000000013, 171.47602515657542, -1.122436054814628, 105.31682083956633, 4.256291733455155, -13.34116984333691, 135.28147820426574, 175.75823347520316, 174.3522350077121, 79.22000000000018, 131.46442561494632, 151.90601802937454, 1.4940409319469263, 195.13618802154076, 200.0, -194.18807263134286, 170.1540982671573, -25.813130434913514, 182.44029187603633, 0.949247626035404, 175.9842622077201, 90.4132888772179, 174.2458617117499, 2.0000000000000013, 150.0549900509842, -24.655747847266497, 126.13200209311597, -31.616377013382174, 183.2534550504562, -0.430872056281258, -18.58140374779744, 152.13041630609436, -19.59845603889372, -4.647303268169432, -136.1625695158018, 189.41095746363322, 179.19253083151403, 178.40127759690023, -89.73656264609093, 200.0, -68.58791778688509, -64.16600133077758, -5.12571424634738, 200.0, -42.861190670252626, 178.16858326810393, 2.0000000000000013, -27.52811123349434, -41.931154026545975, 185.01798194577634, -3.6242988342778846, 107.79479668604013, 176.03693070876534, 185.43622605391653, -23.49658654197196, -28.088477666639637, 127.52614126909405, 103.31476871446688, -9.882941745361682, 182.9366586057758, -3.457461115140535, 160.63921451171998, 183.14669159534196, 152.27095222826495, 16.624656089382306, -3.2891711203752596, -25.854228363354224, 161.39000000000007, 72.12375305928707, 180.63940572126245, 14.3894848851392, 0.5744684539452857, 196.35719664803344, -1.6923406741529303, 146.18501255340746, 1.2407537597939227, 171.13266529492668, 2.0000000000000013, -79.16295858785834, 91.08958728811308, -16.2912409863668, 148.52, 195.17030693856236, 57.73797802672236, 186.04157563730337, 178.01571371564063, 189.85572888480868, 172.9012641015396, 106.94, 1.8318278109374715, 185.25343157331028, 129.3144694682856, 2.0000000000000013, 121.78935582978968, 179.98290176768654, 180.35145565043194], "policy_predator_policy_reward": [13.406549450460659, 10.270979048874743, 9.601253424841188, 9.147748688297632, 1.5437014232701332, 2.569306232200002, 1.5277692376074292, 2.326062624108377, 1.7498666934262188, 5.358241432000087, 3.6731844548886805, 2.8579951074853067, 31.35874471736225, 3.7445298182879734, 5.404041615966207, 3.8771741524277847, 0.14836444871162477, 0.3373733942809416, 4.815784919319348, 3.850231166427518, 13.257614027399342, 16.60954899524421, 2.300223278412808, 1.7819103523473971, 11.326148369309953, 8.488086517371716, 11.709892049786207, 9.11698705320505, 0.9290839329662475, 0.4139298503658534, 4.570105834365292, 58.6643905901556, 5.258913742616494, 2.9744894408973828, 8.8280003715816, 8.665682169979645, 2.6547387168119254, 3.058447697879291, 5.670036253436562, 5.675326059136871, 0.7514762841954898, 3.1071257447352365, 67.53915996569538, 57.61802551691843, 1.0709449174955032, 9.574597137324522, 25.38148938867449, 10.408105446634062, 9.688682066973394, 8.521268072358188, 19.718000197442567, 6.624935091087357, 4.856802256239578, 0.0, 13.44452066892796, 13.837137940741245, 4.321294393108623, 6.5958162512536385, 3.7677591889115467, 0.6976237414921544, 3.686834357687066, 1.9077155267216734, 2.7243946496482603, 57.25947964735218, 2.147782299194073, 14.885507253493003, 5.612294499779363, 7.3786687089727145, 7.759572447526325, 27.187473766817995, 2.202719031261666, 3.146927617863356, 8.439862970572976, 12.59577298276949, 8.213255319966983, 1.451101182583392, 0.18217935619799558, 0.47336938101722686, 69.95835989507178, 2.2550568638546724, 31.508952628841243, 46.79044726111625, 3.9754169482428106, 3.296231523509986, 4.048568026075097, 4.0792345749404495, 0.0, 0.23875074504364155, 0.4440249367026271, 1.4700444724453097, 9.32211422850541, 2.0322177376321036, 1.0805797607746905, 0.9980023096865599, 0.1845219636668015, 1.8975213869185932, 2.1859201687666303, 7.413032559043191, 23.13095208904789, 2.20965702462858, 10.066429045563469, 9.675467883046842, 13.511742864999206, 7.696727889698364, 7.091432630805906, 6.513995139350957, 2.5331791604336584, 3.0024360548146074, 14.931169843336876, 2.6237082665448295, 7.690798415878794, 0.8303993882580003, 2.3839073032095617, 1.930715598543753, 4.423981970625442, 0.21557438505362075, 0.9093624828570664, 0.4404085636552362, 155.70935129515138, 115.23530968533463, 24.2627471003708, 19.448345946126178, 1.0107523739645974, 4.559708123963683, 4.167096439608866, 1.5253524754531518, 6.754138288250081, 0.6214531841376606, 26.255747847266743, 1.8832437140472784, 21.09473181534731, 37.80375274738963, 5.7271598173489116, 2.9074493813613875, 25.58120918090452, 17.097023063381418, 8.208659797936827, 21.128456038893958, 0.6590425363667723, 136.1625695158018, 1.7875372733612171, 5.1833381704006305, 89.73656264609093, 2.007121094954704, 4.770551890939902, 77.67838165574992, 6.905714246347342, 0.17789070397510928, 43.541190670252625, 6.831416731896076, 18.707691288121183, 26.294388630045134, 42.34115402654597, 3.98201805422366, 8.642594336569285, 16.48455513510475, 2.8002407576625683, 3.1252038466819148, 24.364074628969895, 25.282965990279145, 5.529829126450949, 3.3749722034710756, 3.0633413942242376, 11.969051245225495, 5.277461115140496, 3.640785488280021, 0.7754191886847698, 5.722123252992961, 3.8409865677965884, 6.119117652688636, 26.106793499068136, 13.16933285021197, 3.3605942787375582, 2.0762469407129323, 2.428660498157725, 1.9181646129583694, 0.6428033519665454, 3.5223406741528986, 0.7192462402060787, 12.184987446592535, 14.867334705073317, 0.0, 63.23041271188685, 80.79295858785918, 17.73890854608716, 1.9182540940099109, 21.61764758530178, 20.728834942248376, 5.958424362696643, 1.144286284359387, 0.7123280021931384, 4.241153689309872, 0.15817218906252994, 0.0, 0.19957396435877225, 6.200242696453964, 5.345842820546356, 3.452010565536065, 7.024983706521713, 4.430091311783135]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.157134629782669, "mean_inference_ms": 8.584550979589793, "mean_action_processing_ms": 1.4215403544799858, "mean_env_wait_ms": 0.7515587762600754, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.019106149673461914, "StateBufferConnector_ms": 0.009423136711120605, "ViewRequirementAgentConnector_ms": 0.3102787733078003}, "num_episodes": 18, "episode_return_max": 376.7090194864685, "episode_return_min": -50.30498557097288, "episode_return_mean": 159.3532593005152, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1552000, "num_agent_steps_trained": 1552000, "num_env_steps_sampled": 388000, "num_env_steps_trained": 388000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 253.8666923621988, "num_env_steps_trained_throughput_per_sec": 253.8666923621988, "timesteps_total": 388000, "num_env_steps_sampled_lifetime": 388000, "num_agent_steps_sampled_lifetime": 1552000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1552000, "timers": {"training_iteration_time_ms": 48839.803, "restore_workers_time_ms": 0.016, "training_step_time_ms": 48839.754, "sample_time_ms": 21829.2, "learn_time_ms": 26986.609, "learn_throughput": 148.222, "synch_weights_time_ms": 22.799}, "counters": {"num_env_steps_sampled": 388000, "num_env_steps_trained": 388000, "num_agent_steps_sampled": 1552000, "num_agent_steps_trained": 1552000}, "done": false, "training_iteration": 97, "trial_id": "d163c_00000", "date": "2024-08-16_13-30-21", "timestamp": 1723795221, "time_this_iter_s": 15.761482954025269, "time_total_s": 2439.712569952011, "pid": 81201, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16b96b9d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2439.712569952011, "iterations_since_restore": 97, "perf": {"cpu_util_percent": 28.586363636363636, "ram_util_percent": 71.77272727272727}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.0609884061195234, "cur_kl_coeff": 7.724761962890623e-06, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.7890909831044535, "policy_loss": -0.004855576615470151, "vf_loss": 0.7939464171885182, "vf_explained_var": 0.718986614829018, "kl": 0.01791517783875519, "entropy": 0.6273006485568152, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 184275.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.9591180242243267, "cur_kl_coeff": 0.05, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.067371557377003, "policy_loss": -0.006226470486492549, "vf_loss": 7.0730110534284485, "vf_explained_var": 0.80643148904755, "kl": 0.011739580314005729, "entropy": 0.8180394530296325, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 184275.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 392000, "num_env_steps_trained": 392000, "num_agent_steps_sampled": 1568000, "num_agent_steps_trained": 1568000}, "env_runners": {"episode_reward_max": 387.2161584118335, "episode_reward_min": -50.30498557097288, "episode_reward_mean": 199.44700451672128, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -194.18807263134286, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 155.70935129515138}, "policy_reward_mean": {"prey_policy": 87.89660434758117, "predator_policy": 11.826897910779502}, "custom_metrics": {}, "hist_stats": {"episode_reward": [194.83999999999966, 251.4454184025367, 210.70516129804176, 178.5469533273153, 310.7800000000001, 191.20245798629372, 174.00999999999988, 4.527623741492102, 193.90771552672135, -38.955141191443865, 355.08650359516014, 33.03636320268875, 173.47855744095818, 202.8322258869996, 145.0009214932414, 190.9499999999997, 3.9699999999999593, -30.789978998351835, 66.29359977904844, 197.93976215350733, 376.7090194864685, 201.9899999999996, 4.006639866943229, 337.6161944370296, 190.03999999999974, 34.79452196366649, 373.01025403863287, 188.67999999999972, 3.934233751282334, 274.25963406434266, 187.08145292673203, 109.73000000000017, 8.46999999999997, 319.56090948360566, 257.88685790946545, 288.0099999999998, 197.97999999999965, 276.7565883491433, 188.05206087874, 188.95999999999972, 272.0900000000001, 183.6214531841374, 153.53823376503152, 153.41410964247092, 191.45719219288497, 176.22724480258248, 5.09135652976737, 190.07, 364.5646838721761, 202.0071210949547, -50.30498557097288, 201.95789070397473, 185.68000000000006, 19.47396868467221, 189.41000000000003, 129.2976473234366, 367.39860136702634, -1.9380235893631055, 239.745711313483, 188.0861094998636, 166.09999999999997, 341.91518626528466, 23.29558918949279, 174.8118979859256, 258.20000000000016, 19.310778450200516, 198.82999999999964, 160.32999999999998, 187.99999999999972, 155.95000000000005, 151.88592165373012, 295.25476749283484, 371.15999999999997, 367.7104746778511, 108.93000000000019, 320.9677177024086, 132.58720921587172, 371.78943243642334, 323.0151601561639, 192.9994359814961, 366.22, 204.36355192789358, 372.0, 386.4661362358811, 341.1499208891988, 3.659999999999966, 198.96999999999963, 173.9599999999998, 322.6776580166235, 387.2161584118335, 191.02999999999972, 175.05000000000015, 136.58000000000027, 367.3324881331121, 335.44, 194.15474155160723, 312.9544592642018, 184.58, 384.0358118720145, 206.59112854569014], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [191.9590550825045, -7.764597137324561, 164.59660391469373, 51.05921965253477, 6.434277252022737, 186.06093390668786, -18.158000197442323, 170.36201823622815, 122.78, 183.14319774376042, 176.07873497063878, -12.157935594014006, -4.7658162512536775, 167.85870560689136, 2.0000000000000013, -1.9377591889115828, 186.31316564231292, 2.0000000000000013, -46.796247281134775, -52.14276820730955, 141.36230884433772, 196.69090519813537, 2.0000000000000013, 18.04539999393677, 2.7109044068021126, 135.82060681981187, 165.07371218151974, 32.408867056355, -11.684714460101219, 135.65, 180.78674468003302, 0.4988988174166095, 1.807820643802006, 1.5066306189827745, -41.29101526943853, -61.71238048783978, 14.25763730902223, -26.263437419932224, 192.08583408861875, -1.4177204068638687, 183.89846116916243, 184.68275571629053, 1.7512492549563599, 200.0, 1.6226149302406445, 0.4699555275546918, 174.83760718907413, 151.42425528181798, 0.8794202392253109, 187.08199769031344, 9.919999999999959, 22.79247861308152, 170.16133140452837, 193.2499699062947, 184.8103429753714, -21.470952089047632, -6.441183572681277, -9.366479604646736, 133.2098146069377, 119.84134870270736, 2.0000000000000013, 171.47602515657542, -1.122436054814628, 105.31682083956633, 4.256291733455155, -13.34116984333691, 135.28147820426574, 175.75823347520316, 174.3522350077121, 79.22000000000018, 131.46442561494632, 151.90601802937454, 1.4940409319469263, 195.13618802154076, 200.0, -194.18807263134286, 170.1540982671573, -25.813130434913514, 182.44029187603633, 0.949247626035404, 175.9842622077201, 90.4132888772179, 174.2458617117499, 2.0000000000000013, 150.0549900509842, -24.655747847266497, 126.13200209311597, -31.616377013382174, 183.2534550504562, -0.430872056281258, -18.58140374779744, 152.13041630609436, -19.59845603889372, -4.647303268169432, -136.1625695158018, 189.41095746363322, 179.19253083151403, 178.40127759690023, -89.73656264609093, 200.0, -68.58791778688509, -64.16600133077758, -5.12571424634738, 200.0, -42.861190670252626, 178.16858326810393, 2.0000000000000013, -27.52811123349434, -41.931154026545975, 185.01798194577634, -3.6242988342778846, 107.79479668604013, 176.03693070876534, 185.43622605391653, -23.49658654197196, -28.088477666639637, 127.52614126909405, 103.31476871446688, -9.882941745361682, 182.9366586057758, -3.457461115140535, 160.63921451171998, 183.14669159534196, 152.27095222826495, 16.624656089382306, -3.2891711203752596, -25.854228363354224, 161.39000000000007, 72.12375305928707, 180.63940572126245, 14.3894848851392, 0.5744684539452857, 196.35719664803344, -1.6923406741529303, 146.18501255340746, 1.2407537597939227, 171.13266529492668, 2.0000000000000013, -79.16295858785834, 91.08958728811308, -16.2912409863668, 148.52, 195.17030693856236, 57.73797802672236, 186.04157563730337, 178.01571371564063, 189.85572888480868, 172.9012641015396, 106.94, 1.8318278109374715, 185.25343157331028, 129.3144694682856, 2.0000000000000013, 121.78935582978968, 179.98290176768654, 180.35145565043194, 126.74000000000004, 193.33126489290385, 183.62203825829744, 2.0000000000000013, 175.9022812821005, 187.77653954219642, -9.449472284241722, 192.54170466745785, 177.86264089893967, 182.70365528254268, 191.02610115640593, 192.30740263632566, 137.03604867778142, 200.0, -0.607384157647541, -8.406091141130783, 1.3983142423313368, 196.43243766847297, -3.7885267520791936, 169.3142564863407, 75.80911339084122, 193.07, 193.60849075458663, 190.4324003756879, 1.0061530713720916, 188.0635615820472, 172.1140116046957, -44.876170245244026, 134.03173127940852, 0.9738813142503095, 184.1143150259262, 180.30590806521332, 139.86285887954938, 169.7645279119136, 2.0000000000000013, 179.1380218278312, 146.42915751995332, 141.18905224987446, -38.38709294943113, 181.53600573300477, 200.0, 175.0899002539253, -10.575427883716946, 197.03], "policy_predator_policy_reward": [1.0709449174955032, 9.574597137324522, 25.38148938867449, 10.408105446634062, 9.688682066973394, 8.521268072358188, 19.718000197442567, 6.624935091087357, 4.856802256239578, 0.0, 13.44452066892796, 13.837137940741245, 4.321294393108623, 6.5958162512536385, 3.7677591889115467, 0.6976237414921544, 3.686834357687066, 1.9077155267216734, 2.7243946496482603, 57.25947964735218, 2.147782299194073, 14.885507253493003, 5.612294499779363, 7.3786687089727145, 7.759572447526325, 27.187473766817995, 2.202719031261666, 3.146927617863356, 8.439862970572976, 12.59577298276949, 8.213255319966983, 1.451101182583392, 0.18217935619799558, 0.47336938101722686, 69.95835989507178, 2.2550568638546724, 31.508952628841243, 46.79044726111625, 3.9754169482428106, 3.296231523509986, 4.048568026075097, 4.0792345749404495, 0.0, 0.23875074504364155, 0.4440249367026271, 1.4700444724453097, 9.32211422850541, 2.0322177376321036, 1.0805797607746905, 0.9980023096865599, 0.1845219636668015, 1.8975213869185932, 2.1859201687666303, 7.413032559043191, 23.13095208904789, 2.20965702462858, 10.066429045563469, 9.675467883046842, 13.511742864999206, 7.696727889698364, 7.091432630805906, 6.513995139350957, 2.5331791604336584, 3.0024360548146074, 14.931169843336876, 2.6237082665448295, 7.690798415878794, 0.8303993882580003, 2.3839073032095617, 1.930715598543753, 4.423981970625442, 0.21557438505362075, 0.9093624828570664, 0.4404085636552362, 155.70935129515138, 115.23530968533463, 24.2627471003708, 19.448345946126178, 1.0107523739645974, 4.559708123963683, 4.167096439608866, 1.5253524754531518, 6.754138288250081, 0.6214531841376606, 26.255747847266743, 1.8832437140472784, 21.09473181534731, 37.80375274738963, 5.7271598173489116, 2.9074493813613875, 25.58120918090452, 17.097023063381418, 8.208659797936827, 21.128456038893958, 0.6590425363667723, 136.1625695158018, 1.7875372733612171, 5.1833381704006305, 89.73656264609093, 2.007121094954704, 4.770551890939902, 77.67838165574992, 6.905714246347342, 0.17789070397510928, 43.541190670252625, 6.831416731896076, 18.707691288121183, 26.294388630045134, 42.34115402654597, 3.98201805422366, 8.642594336569285, 16.48455513510475, 2.8002407576625683, 3.1252038466819148, 24.364074628969895, 25.282965990279145, 5.529829126450949, 3.3749722034710756, 3.0633413942242376, 11.969051245225495, 5.277461115140496, 3.640785488280021, 0.7754191886847698, 5.722123252992961, 3.8409865677965884, 6.119117652688636, 26.106793499068136, 13.16933285021197, 3.3605942787375582, 2.0762469407129323, 2.428660498157725, 1.9181646129583694, 0.6428033519665454, 3.5223406741528986, 0.7192462402060787, 12.184987446592535, 14.867334705073317, 0.0, 63.23041271188685, 80.79295858785918, 17.73890854608716, 1.9182540940099109, 21.61764758530178, 20.728834942248376, 5.958424362696643, 1.144286284359387, 0.7123280021931384, 4.241153689309872, 0.15817218906252994, 0.0, 0.19957396435877225, 6.200242696453964, 5.345842820546356, 3.452010565536065, 7.024983706521713, 4.430091311783135, 1.447574299353011, 1.496320963906972, 2.4405839965904508, 4.9368137266085155, 0.9749497190764231, 1.5662294566266723, 7.094337101641656, 14.17698244303617, 3.2963447174573166, 8.137359101060335, 1.97389884359407, 1.1587335995554502, 1.6147317584994163, 2.4991404529179935, 2.5173841576475313, 10.156091141130746, 0.5675623315270302, 0.5716857576686646, 2.8857435136592726, 5.548526752079156, 34.95987340893781, 18.83867121684448, 2.577599624312115, 0.5976676572468231, 0.9538469286279097, 1.0064384179527994, 2.0659883953043248, 45.74617024524416, 0.5982687205915345, 0.9761186857496919, 0.9365800678988114, 1.9756849740738147, 22.235472088086386, 3.5771411204506025, 0.15474155160754266, 12.86197817216879, 12.872753487074597, 12.463496007299423, 2.5139942669952196, 38.917092949431115, 2.0469862849762763, 6.898925333112977, 9.70586057324642, 10.430695856161051]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.229466770849291, "mean_inference_ms": 8.466402940342755, "mean_action_processing_ms": 1.4166585521107726, "mean_env_wait_ms": 0.751018076756813, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.019540071487426758, "StateBufferConnector_ms": 0.010861635208129883, "ViewRequirementAgentConnector_ms": 0.3725851774215698}, "num_episodes": 22, "episode_return_max": 387.2161584118335, "episode_return_min": -50.30498557097288, "episode_return_mean": 199.44700451672128, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1568000, "num_agent_steps_trained": 1568000, "num_env_steps_sampled": 392000, "num_env_steps_trained": 392000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 233.98187890371258, "num_env_steps_trained_throughput_per_sec": 233.98187890371258, "timesteps_total": 392000, "num_env_steps_sampled_lifetime": 392000, "num_agent_steps_sampled_lifetime": 1568000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1568000, "timers": {"training_iteration_time_ms": 48877.309, "restore_workers_time_ms": 0.016, "training_step_time_ms": 48877.259, "sample_time_ms": 21887.215, "learn_time_ms": 26966.248, "learn_throughput": 148.334, "synch_weights_time_ms": 22.67}, "counters": {"num_env_steps_sampled": 392000, "num_env_steps_trained": 392000, "num_agent_steps_sampled": 1568000, "num_agent_steps_trained": 1568000}, "done": false, "training_iteration": 98, "trial_id": "d163c_00000", "date": "2024-08-16_13-30-39", "timestamp": 1723795239, "time_this_iter_s": 17.099627017974854, "time_total_s": 2456.812196969986, "pid": 81201, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16ba5cb80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2456.812196969986, "iterations_since_restore": 98, "perf": {"cpu_util_percent": 31.487999999999996, "ram_util_percent": 71.74}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3981689002463424, "cur_kl_coeff": 7.724761962890623e-06, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.189861044082692, "policy_loss": -0.0038730994684907493, "vf_loss": 1.1937339657355868, "vf_explained_var": 0.7352913692199364, "kl": 0.023761510366066375, "entropy": 0.6603445473171415, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 186165.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.448879918597993, "cur_kl_coeff": 0.05, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.39939177780555, "policy_loss": -0.0034624415156603965, "vf_loss": 6.402363395186328, "vf_explained_var": 0.8248589263075874, "kl": 0.009816303254583646, "entropy": 0.8283711991928242, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 186165.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_agent_steps_sampled": 1584000, "num_agent_steps_trained": 1584000}, "env_runners": {"episode_reward_max": 387.2161584118335, "episode_reward_min": -50.30498557097288, "episode_reward_mean": 210.07833709469, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -194.18807263134286, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 155.70935129515138}, "policy_reward_mean": {"prey_policy": 92.54688578878476, "predator_policy": 12.492282758560268}, "custom_metrics": {}, "hist_stats": {"episode_reward": [66.29359977904844, 197.93976215350733, 376.7090194864685, 201.9899999999996, 4.006639866943229, 337.6161944370296, 190.03999999999974, 34.79452196366649, 373.01025403863287, 188.67999999999972, 3.934233751282334, 274.25963406434266, 187.08145292673203, 109.73000000000017, 8.46999999999997, 319.56090948360566, 257.88685790946545, 288.0099999999998, 197.97999999999965, 276.7565883491433, 188.05206087874, 188.95999999999972, 272.0900000000001, 183.6214531841374, 153.53823376503152, 153.41410964247092, 191.45719219288497, 176.22724480258248, 5.09135652976737, 190.07, 364.5646838721761, 202.0071210949547, -50.30498557097288, 201.95789070397473, 185.68000000000006, 19.47396868467221, 189.41000000000003, 129.2976473234366, 367.39860136702634, -1.9380235893631055, 239.745711313483, 188.0861094998636, 166.09999999999997, 341.91518626528466, 23.29558918949279, 174.8118979859256, 258.20000000000016, 19.310778450200516, 198.82999999999964, 160.32999999999998, 187.99999999999972, 155.95000000000005, 151.88592165373012, 295.25476749283484, 371.15999999999997, 367.7104746778511, 108.93000000000019, 320.9677177024086, 132.58720921587172, 371.78943243642334, 323.0151601561639, 192.9994359814961, 366.22, 204.36355192789358, 372.0, 386.4661362358811, 341.1499208891988, 3.659999999999966, 198.96999999999963, 173.9599999999998, 322.6776580166235, 387.2161584118335, 191.02999999999972, 175.05000000000015, 136.58000000000027, 367.3324881331121, 335.44, 194.15474155160723, 312.9544592642018, 184.58, 384.0358118720145, 206.59112854569014, 202.32133475162854, 185.1679435784181, 179.98999999999984, 377.0270378920572, 162.39, 360.1904518115982, 329.63, 174.1224256346152, 174.54999999999984, 162.71999999999997, 349.31, 221.04873130530368, 13.739958577407322, 193.90999999999968, 311.04451945214777, 200.0, 13.72187181537737, 196.82376468997217], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [14.25763730902223, -26.263437419932224, 192.08583408861875, -1.4177204068638687, 183.89846116916243, 184.68275571629053, 1.7512492549563599, 200.0, 1.6226149302406445, 0.4699555275546918, 174.83760718907413, 151.42425528181798, 0.8794202392253109, 187.08199769031344, 9.919999999999959, 22.79247861308152, 170.16133140452837, 193.2499699062947, 184.8103429753714, -21.470952089047632, -6.441183572681277, -9.366479604646736, 133.2098146069377, 119.84134870270736, 2.0000000000000013, 171.47602515657542, -1.122436054814628, 105.31682083956633, 4.256291733455155, -13.34116984333691, 135.28147820426574, 175.75823347520316, 174.3522350077121, 79.22000000000018, 131.46442561494632, 151.90601802937454, 1.4940409319469263, 195.13618802154076, 200.0, -194.18807263134286, 170.1540982671573, -25.813130434913514, 182.44029187603633, 0.949247626035404, 175.9842622077201, 90.4132888772179, 174.2458617117499, 2.0000000000000013, 150.0549900509842, -24.655747847266497, 126.13200209311597, -31.616377013382174, 183.2534550504562, -0.430872056281258, -18.58140374779744, 152.13041630609436, -19.59845603889372, -4.647303268169432, -136.1625695158018, 189.41095746363322, 179.19253083151403, 178.40127759690023, -89.73656264609093, 200.0, -68.58791778688509, -64.16600133077758, -5.12571424634738, 200.0, -42.861190670252626, 178.16858326810393, 2.0000000000000013, -27.52811123349434, -41.931154026545975, 185.01798194577634, -3.6242988342778846, 107.79479668604013, 176.03693070876534, 185.43622605391653, -23.49658654197196, -28.088477666639637, 127.52614126909405, 103.31476871446688, -9.882941745361682, 182.9366586057758, -3.457461115140535, 160.63921451171998, 183.14669159534196, 152.27095222826495, 16.624656089382306, -3.2891711203752596, -25.854228363354224, 161.39000000000007, 72.12375305928707, 180.63940572126245, 14.3894848851392, 0.5744684539452857, 196.35719664803344, -1.6923406741529303, 146.18501255340746, 1.2407537597939227, 171.13266529492668, 2.0000000000000013, -79.16295858785834, 91.08958728811308, -16.2912409863668, 148.52, 195.17030693856236, 57.73797802672236, 186.04157563730337, 178.01571371564063, 189.85572888480868, 172.9012641015396, 106.94, 1.8318278109374715, 185.25343157331028, 129.3144694682856, 2.0000000000000013, 121.78935582978968, 179.98290176768654, 180.35145565043194, 126.74000000000004, 193.33126489290385, 183.62203825829744, 2.0000000000000013, 175.9022812821005, 187.77653954219642, -9.449472284241722, 192.54170466745785, 177.86264089893967, 182.70365528254268, 191.02610115640593, 192.30740263632566, 137.03604867778142, 200.0, -0.607384157647541, -8.406091141130783, 1.3983142423313368, 196.43243766847297, -3.7885267520791936, 169.3142564863407, 75.80911339084122, 193.07, 193.60849075458663, 190.4324003756879, 1.0061530713720916, 188.0635615820472, 172.1140116046957, -44.876170245244026, 134.03173127940852, 0.9738813142503095, 184.1143150259262, 180.30590806521332, 139.86285887954938, 169.7645279119136, 2.0000000000000013, 179.1380218278312, 146.42915751995332, 141.18905224987446, -38.38709294943113, 181.53600573300477, 200.0, 175.0899002539253, -10.575427883716946, 197.03, 200.0, -1.7717692771335372, 175.25000000000006, -38.705999468503066, 1.8034879951878633, 170.38528830676645, 183.58124754162583, 182.95161606243926, 2.0000000000000013, 160.23527580065215, 156.04609594690356, 159.43870401238337, 132.58136125873614, 194.27595520982157, 168.72927680519945, -4.3877532564221795, 136.6237950886211, -26.296702865589765, 151.539886994034, -20.53954564254332, 187.80402918885662, 156.42993654033666, -30.335706959570366, 200.0, 2.0000000000000013, -20.097262718942304, 0.3399438996082224, 189.48676051578235, 171.06238827919148, 131.0121743453236, 200.0, -42.7364639976541, -61.225632256055164, -57.42087380756185, 181.55253284298277, 5.04171905087956], "policy_predator_policy_reward": [31.508952628841243, 46.79044726111625, 3.9754169482428106, 3.296231523509986, 4.048568026075097, 4.0792345749404495, 0.0, 0.23875074504364155, 0.4440249367026271, 1.4700444724453097, 9.32211422850541, 2.0322177376321036, 1.0805797607746905, 0.9980023096865599, 0.1845219636668015, 1.8975213869185932, 2.1859201687666303, 7.413032559043191, 23.13095208904789, 2.20965702462858, 10.066429045563469, 9.675467883046842, 13.511742864999206, 7.696727889698364, 7.091432630805906, 6.513995139350957, 2.5331791604336584, 3.0024360548146074, 14.931169843336876, 2.6237082665448295, 7.690798415878794, 0.8303993882580003, 2.3839073032095617, 1.930715598543753, 4.423981970625442, 0.21557438505362075, 0.9093624828570664, 0.4404085636552362, 155.70935129515138, 115.23530968533463, 24.2627471003708, 19.448345946126178, 1.0107523739645974, 4.559708123963683, 4.167096439608866, 1.5253524754531518, 6.754138288250081, 0.6214531841376606, 26.255747847266743, 1.8832437140472784, 21.09473181534731, 37.80375274738963, 5.7271598173489116, 2.9074493813613875, 25.58120918090452, 17.097023063381418, 8.208659797936827, 21.128456038893958, 0.6590425363667723, 136.1625695158018, 1.7875372733612171, 5.1833381704006305, 89.73656264609093, 2.007121094954704, 4.770551890939902, 77.67838165574992, 6.905714246347342, 0.17789070397510928, 43.541190670252625, 6.831416731896076, 18.707691288121183, 26.294388630045134, 42.34115402654597, 3.98201805422366, 8.642594336569285, 16.48455513510475, 2.8002407576625683, 3.1252038466819148, 24.364074628969895, 25.282965990279145, 5.529829126450949, 3.3749722034710756, 3.0633413942242376, 11.969051245225495, 5.277461115140496, 3.640785488280021, 0.7754191886847698, 5.722123252992961, 3.8409865677965884, 6.119117652688636, 26.106793499068136, 13.16933285021197, 3.3605942787375582, 2.0762469407129323, 2.428660498157725, 1.9181646129583694, 0.6428033519665454, 3.5223406741528986, 0.7192462402060787, 12.184987446592535, 14.867334705073317, 0.0, 63.23041271188685, 80.79295858785918, 17.73890854608716, 1.9182540940099109, 21.61764758530178, 20.728834942248376, 5.958424362696643, 1.144286284359387, 0.7123280021931384, 4.241153689309872, 0.15817218906252994, 0.0, 0.19957396435877225, 6.200242696453964, 5.345842820546356, 3.452010565536065, 7.024983706521713, 4.430091311783135, 1.447574299353011, 1.496320963906972, 2.4405839965904508, 4.9368137266085155, 0.9749497190764231, 1.5662294566266723, 7.094337101641656, 14.17698244303617, 3.2963447174573166, 8.137359101060335, 1.97389884359407, 1.1587335995554502, 1.6147317584994163, 2.4991404529179935, 2.5173841576475313, 10.156091141130746, 0.5675623315270302, 0.5716857576686646, 2.8857435136592726, 5.548526752079156, 34.95987340893781, 18.83867121684448, 2.577599624312115, 0.5976676572468231, 0.9538469286279097, 1.0064384179527994, 2.0659883953043248, 45.74617024524416, 0.5982687205915345, 0.9761186857496919, 0.9365800678988114, 1.9756849740738147, 22.235472088086386, 3.5771411204506025, 0.15474155160754266, 12.86197817216879, 12.872753487074597, 12.463496007299423, 2.5139942669952196, 38.917092949431115, 2.0469862849762763, 6.898925333112977, 9.70586057324642, 10.430695856161051, 0.47133475162893546, 3.621769277133503, 38.5679295970317, 10.056013449889226, 7.614711693233547, 0.18651200481213806, 2.6968908891742016, 7.797283398817916, 0.15472419934786039, 0.0, 33.09925585362848, 11.606395998682803, 1.0486387412638665, 1.7240447901784295, 3.643148829415893, 6.137753256422142, 27.72670286558999, 36.496204911378875, 22.25954564254359, 9.460113005966011, 0.5126075690717066, 4.563426701735027, 28.51788659944729, 22.86655166542691, 20.64599287458915, 11.191228421760739, 2.513239484217653, 1.570056100391779, 3.240439024781267, 5.729517802851392, 0.0, 42.7364639976541, 77.28194963208665, 55.086428246908106, 4.214963836061982, 6.01454896004817]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.1362152815617845, "mean_inference_ms": 8.52275195818316, "mean_action_processing_ms": 1.4118087545187783, "mean_env_wait_ms": 0.7500938229169072, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01913774013519287, "StateBufferConnector_ms": 0.010589122772216797, "ViewRequirementAgentConnector_ms": 0.36736249923706055}, "num_episodes": 18, "episode_return_max": 387.2161584118335, "episode_return_min": -50.30498557097288, "episode_return_mean": 210.07833709469, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1584000, "num_agent_steps_trained": 1584000, "num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 253.5125742023202, "num_env_steps_trained_throughput_per_sec": 253.5125742023202, "timesteps_total": 396000, "num_env_steps_sampled_lifetime": 396000, "num_agent_steps_sampled_lifetime": 1584000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1584000, "timers": {"training_iteration_time_ms": 48706.263, "restore_workers_time_ms": 0.016, "training_step_time_ms": 48706.213, "sample_time_ms": 21873.517, "learn_time_ms": 26808.771, "learn_throughput": 149.205, "synch_weights_time_ms": 22.773}, "counters": {"num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_agent_steps_sampled": 1584000, "num_agent_steps_trained": 1584000}, "done": false, "training_iteration": 99, "trial_id": "d163c_00000", "date": "2024-08-16_13-30-54", "timestamp": 1723795254, "time_this_iter_s": 15.782953977584839, "time_total_s": 2472.595150947571, "pid": 81201, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16b893ca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2472.595150947571, "iterations_since_restore": 99, "perf": {"cpu_util_percent": 29.16818181818181, "ram_util_percent": 71.41818181818182}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.2517551757355845, "cur_kl_coeff": 1.1587142944335941e-05, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.0345714032649993, "policy_loss": -0.0031941807173468447, "vf_loss": 1.0377654702890486, "vf_explained_var": 0.4583877906912849, "kl": 0.010686740666658739, "entropy": 0.6875938154086865, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 188055.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.5148654878139496, "cur_kl_coeff": 0.05, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.284629438541554, "policy_loss": -0.0069384260475142765, "vf_loss": 6.291002343949818, "vf_explained_var": 0.8085648368590723, "kl": 0.011310306264470115, "entropy": 0.8298869844466921, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 188055.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 400000, "num_env_steps_trained": 400000, "num_agent_steps_sampled": 1600000, "num_agent_steps_trained": 1600000}, "env_runners": {"episode_reward_max": 391.02073445205895, "episode_reward_min": -50.30498557097288, "episode_reward_mean": 219.2827780392923, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -136.1625695158018, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 136.1625695158018}, "policy_reward_mean": {"prey_policy": 97.56245906747893, "predator_policy": 12.07892995216727}, "custom_metrics": {}, "hist_stats": {"episode_reward": [183.6214531841374, 153.53823376503152, 153.41410964247092, 191.45719219288497, 176.22724480258248, 5.09135652976737, 190.07, 364.5646838721761, 202.0071210949547, -50.30498557097288, 201.95789070397473, 185.68000000000006, 19.47396868467221, 189.41000000000003, 129.2976473234366, 367.39860136702634, -1.9380235893631055, 239.745711313483, 188.0861094998636, 166.09999999999997, 341.91518626528466, 23.29558918949279, 174.8118979859256, 258.20000000000016, 19.310778450200516, 198.82999999999964, 160.32999999999998, 187.99999999999972, 155.95000000000005, 151.88592165373012, 295.25476749283484, 371.15999999999997, 367.7104746778511, 108.93000000000019, 320.9677177024086, 132.58720921587172, 371.78943243642334, 323.0151601561639, 192.9994359814961, 366.22, 204.36355192789358, 372.0, 386.4661362358811, 341.1499208891988, 3.659999999999966, 198.96999999999963, 173.9599999999998, 322.6776580166235, 387.2161584118335, 191.02999999999972, 175.05000000000015, 136.58000000000027, 367.3324881331121, 335.44, 194.15474155160723, 312.9544592642018, 184.58, 384.0358118720145, 206.59112854569014, 202.32133475162854, 185.1679435784181, 179.98999999999984, 377.0270378920572, 162.39, 360.1904518115982, 329.63, 174.1224256346152, 174.54999999999984, 162.71999999999997, 349.31, 221.04873130530368, 13.739958577407322, 193.90999999999968, 311.04451945214777, 200.0, 13.72187181537737, 196.82376468997217, 347.09537522448545, 186.05999999999983, 20.7730402064505, 355.507246691962, 174.90999999999985, 345.24266938558753, 323.7525270156344, 190.84416382350796, 199.35026380937558, 256.2407034191428, 188.97999999999973, 391.02073445205895, 186.59070788254428, 331.5927350260811, 217.97186684013403, 327.1837238995874, 362.235213605314, 184.84050103744016, 9.675306981876563, 182.50000000000006, 312.1354399949952, 186.60794958214004, 183.1856546705245], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [174.2458617117499, 2.0000000000000013, 150.0549900509842, -24.655747847266497, 126.13200209311597, -31.616377013382174, 183.2534550504562, -0.430872056281258, -18.58140374779744, 152.13041630609436, -19.59845603889372, -4.647303268169432, -136.1625695158018, 189.41095746363322, 179.19253083151403, 178.40127759690023, -89.73656264609093, 200.0, -68.58791778688509, -64.16600133077758, -5.12571424634738, 200.0, -42.861190670252626, 178.16858326810393, 2.0000000000000013, -27.52811123349434, -41.931154026545975, 185.01798194577634, -3.6242988342778846, 107.79479668604013, 176.03693070876534, 185.43622605391653, -23.49658654197196, -28.088477666639637, 127.52614126909405, 103.31476871446688, -9.882941745361682, 182.9366586057758, -3.457461115140535, 160.63921451171998, 183.14669159534196, 152.27095222826495, 16.624656089382306, -3.2891711203752596, -25.854228363354224, 161.39000000000007, 72.12375305928707, 180.63940572126245, 14.3894848851392, 0.5744684539452857, 196.35719664803344, -1.6923406741529303, 146.18501255340746, 1.2407537597939227, 171.13266529492668, 2.0000000000000013, -79.16295858785834, 91.08958728811308, -16.2912409863668, 148.52, 195.17030693856236, 57.73797802672236, 186.04157563730337, 178.01571371564063, 189.85572888480868, 172.9012641015396, 106.94, 1.8318278109374715, 185.25343157331028, 129.3144694682856, 2.0000000000000013, 121.78935582978968, 179.98290176768654, 180.35145565043194, 126.74000000000004, 193.33126489290385, 183.62203825829744, 2.0000000000000013, 175.9022812821005, 187.77653954219642, -9.449472284241722, 192.54170466745785, 177.86264089893967, 182.70365528254268, 191.02610115640593, 192.30740263632566, 137.03604867778142, 200.0, -0.607384157647541, -8.406091141130783, 1.3983142423313368, 196.43243766847297, -3.7885267520791936, 169.3142564863407, 75.80911339084122, 193.07, 193.60849075458663, 190.4324003756879, 1.0061530713720916, 188.0635615820472, 172.1140116046957, -44.876170245244026, 134.03173127940852, 0.9738813142503095, 184.1143150259262, 180.30590806521332, 139.86285887954938, 169.7645279119136, 2.0000000000000013, 179.1380218278312, 146.42915751995332, 141.18905224987446, -38.38709294943113, 181.53600573300477, 200.0, 175.0899002539253, -10.575427883716946, 197.03, 200.0, -1.7717692771335372, 175.25000000000006, -38.705999468503066, 1.8034879951878633, 170.38528830676645, 183.58124754162583, 182.95161606243926, 2.0000000000000013, 160.23527580065215, 156.04609594690356, 159.43870401238337, 132.58136125873614, 194.27595520982157, 168.72927680519945, -4.3877532564221795, 136.6237950886211, -26.296702865589765, 151.539886994034, -20.53954564254332, 187.80402918885662, 156.42993654033666, -30.335706959570366, 200.0, 2.0000000000000013, -20.097262718942304, 0.3399438996082224, 189.48676051578235, 171.06238827919148, 131.0121743453236, 200.0, -42.7364639976541, -61.225632256055164, -57.42087380756185, 181.55253284298277, 5.04171905087956, 159.04357800902443, 179.69594455953316, 180.9447125247145, 2.0000000000000013, 14.869999999999962, -6.05309278166424, 178.54407954985405, 171.29, 172.12708374849242, -23.000812803163882, 143.19855339604032, 187.88223568272335, 140.4220463087101, 163.60060629306105, 181.1711744536566, -8.804018692291155, 2.0000000000000013, 196.3787964404685, 110.89999999999999, 143.6992965808572, 1.5910567432757075, 183.0177128899147, 191.14897271281663, 195.1485186222787, 180.1632384496978, 2.0000000000000013, 172.77471266970426, 150.0411468798681, -56.50974240435045, 194.06, 161.7126460750662, 140.78699348114725, 170.3183818350796, 172.95773352214053, -19.389134323508596, 170.96173482407056, 2.0000000000000013, -18.37293335442761, -44.38780875366602, 163.16725194320014, 95.35871911000937, 197.03, 177.81480240352857, -10.394203079964438, 173.26999999999998, -57.90988936069084], "policy_predator_policy_reward": [6.754138288250081, 0.6214531841376606, 26.255747847266743, 1.8832437140472784, 21.09473181534731, 37.80375274738963, 5.7271598173489116, 2.9074493813613875, 25.58120918090452, 17.097023063381418, 8.208659797936827, 21.128456038893958, 0.6590425363667723, 136.1625695158018, 1.7875372733612171, 5.1833381704006305, 89.73656264609093, 2.007121094954704, 4.770551890939902, 77.67838165574992, 6.905714246347342, 0.17789070397510928, 43.541190670252625, 6.831416731896076, 18.707691288121183, 26.294388630045134, 42.34115402654597, 3.98201805422366, 8.642594336569285, 16.48455513510475, 2.8002407576625683, 3.1252038466819148, 24.364074628969895, 25.282965990279145, 5.529829126450949, 3.3749722034710756, 3.0633413942242376, 11.969051245225495, 5.277461115140496, 3.640785488280021, 0.7754191886847698, 5.722123252992961, 3.8409865677965884, 6.119117652688636, 26.106793499068136, 13.16933285021197, 3.3605942787375582, 2.0762469407129323, 2.428660498157725, 1.9181646129583694, 0.6428033519665454, 3.5223406741528986, 0.7192462402060787, 12.184987446592535, 14.867334705073317, 0.0, 63.23041271188685, 80.79295858785918, 17.73890854608716, 1.9182540940099109, 21.61764758530178, 20.728834942248376, 5.958424362696643, 1.144286284359387, 0.7123280021931384, 4.241153689309872, 0.15817218906252994, 0.0, 0.19957396435877225, 6.200242696453964, 5.345842820546356, 3.452010565536065, 7.024983706521713, 4.430091311783135, 1.447574299353011, 1.496320963906972, 2.4405839965904508, 4.9368137266085155, 0.9749497190764231, 1.5662294566266723, 7.094337101641656, 14.17698244303617, 3.2963447174573166, 8.137359101060335, 1.97389884359407, 1.1587335995554502, 1.6147317584994163, 2.4991404529179935, 2.5173841576475313, 10.156091141130746, 0.5675623315270302, 0.5716857576686646, 2.8857435136592726, 5.548526752079156, 34.95987340893781, 18.83867121684448, 2.577599624312115, 0.5976676572468231, 0.9538469286279097, 1.0064384179527994, 2.0659883953043248, 45.74617024524416, 0.5982687205915345, 0.9761186857496919, 0.9365800678988114, 1.9756849740738147, 22.235472088086386, 3.5771411204506025, 0.15474155160754266, 12.86197817216879, 12.872753487074597, 12.463496007299423, 2.5139942669952196, 38.917092949431115, 2.0469862849762763, 6.898925333112977, 9.70586057324642, 10.430695856161051, 0.47133475162893546, 3.621769277133503, 38.5679295970317, 10.056013449889226, 7.614711693233547, 0.18651200481213806, 2.6968908891742016, 7.797283398817916, 0.15472419934786039, 0.0, 33.09925585362848, 11.606395998682803, 1.0486387412638665, 1.7240447901784295, 3.643148829415893, 6.137753256422142, 27.72670286558999, 36.496204911378875, 22.25954564254359, 9.460113005966011, 0.5126075690717066, 4.563426701735027, 28.51788659944729, 22.86655166542691, 20.64599287458915, 11.191228421760739, 2.513239484217653, 1.570056100391779, 3.240439024781267, 5.729517802851392, 0.0, 42.7364639976541, 77.28194963208665, 55.086428246908106, 4.214963836061982, 6.01454896004817, 1.4612277034101013, 6.89462495251774, 0.0, 3.1152874752855357, 4.205317166854064, 7.750815821260092, 3.468015601210409, 2.205151540897563, 1.1029162515075772, 24.680812803164144, 2.8045526629647943, 11.357327643859085, 3.3286704353042875, 16.401203978559057, 10.091497168243901, 8.385510893898882, 0.6212035595314983, 0.35026380937593676, 0.8207034191427856, 0.8207034191427856, 0.388943256724294, 3.9822871100853057, 2.6434742979501893, 2.079768819013441, 0.7660487108358098, 3.66142072201093, 2.1126288239219946, 6.664246652586909, 23.381757598080362, 57.03985164640393, 12.314236350511447, 12.36984799286249, 13.99978252921537, 4.9593157188784645, 12.062039489753895, 21.205861047124774, 19.441979654919795, 6.606260681384738, 44.88780875366602, 18.832748056799865, 16.173678481389192, 3.573042403596561, 11.538014039613847, 7.649336218962319, 58.931235993115855, 8.89430803809936]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.0447503209732956, "mean_inference_ms": 8.528041744074546, "mean_action_processing_ms": 1.446827631712164, "mean_env_wait_ms": 0.7494734855626664, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015427827835083008, "StateBufferConnector_ms": 0.008932113647460938, "ViewRequirementAgentConnector_ms": 0.3542306423187256}, "num_episodes": 23, "episode_return_max": 391.02073445205895, "episode_return_min": -50.30498557097288, "episode_return_mean": 219.2827780392923, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1600000, "num_agent_steps_trained": 1600000, "num_env_steps_sampled": 400000, "num_env_steps_trained": 400000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 255.81862468877924, "num_env_steps_trained_throughput_per_sec": 255.81862468877924, "timesteps_total": 400000, "num_env_steps_sampled_lifetime": 400000, "num_agent_steps_sampled_lifetime": 1600000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1600000, "timers": {"training_iteration_time_ms": 31100.641, "restore_workers_time_ms": 0.016, "training_step_time_ms": 31100.592, "sample_time_ms": 4060.024, "learn_time_ms": 27016.331, "learn_throughput": 148.059, "synch_weights_time_ms": 23.119}, "counters": {"num_env_steps_sampled": 400000, "num_env_steps_trained": 400000, "num_agent_steps_sampled": 1600000, "num_agent_steps_trained": 1600000}, "done": true, "training_iteration": 100, "trial_id": "d163c_00000", "date": "2024-08-16_13-31-10", "timestamp": 1723795270, "time_this_iter_s": 15.640775918960571, "time_total_s": 2488.2359268665314, "pid": 81201, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16b97baf0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2488.2359268665314, "iterations_since_restore": 100, "perf": {"cpu_util_percent": 28.65454545454546, "ram_util_percent": 71.03636363636363}}
