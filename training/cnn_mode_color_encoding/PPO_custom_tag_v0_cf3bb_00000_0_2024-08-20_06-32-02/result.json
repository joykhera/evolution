{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.61109764407039, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.223953952738848, "policy_loss": -0.0014263996733697476, "vf_loss": 6.224843514154828, "vf_explained_var": 0.000509395233537785, "kl": 0.002684161941547197, "entropy": 1.606824195826495, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 945.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.4815513640247957, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.229472929586178, "policy_loss": -0.0015728814012454773, "vf_loss": 8.23064940871385, "vf_explained_var": 0.000844444263549078, "kl": 0.001982062255019062, "entropy": 1.6074504041797901, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 945.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "env_runners": {"episode_reward_max": 167.74248976813183, "episode_reward_min": 8.099283841415643, "episode_reward_mean": 85.1412225205873, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 3600, "policy_reward_min": {"prey_policy": -254.2714723470084, "predator_policy": 12.746667709120608}, "policy_reward_max": {"prey_policy": 103.75247201062604, "predator_policy": 346.9567118040618}, "policy_reward_mean": {"prey_policy": -78.91168687905467, "predator_policy": 121.48229813934826}, "custom_metrics": {}, "hist_stats": {"episode_reward": [74.09999999999957, 163.39999999999955, 73.89999999999975, 143.79999999999976, 91.36339727732528, 136.48872330210415, 27.600000000000126, 46.900000000000276, 118.0596777688312, 167.74248976813183, 88.09999999999914, 103.7938302315942, 34.20000000000012, 45.69066602306977, 97.69999999999979, 8.099283841415643, 37.40000000000026, 74.2039371581011], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [31.246219863245845, -189.65403016927897, 69.46987905021282, -114.36384285768938, 35.164265756551494, 1.364616088341912, -9.785985947398201, 12.048088389138337, -120.9052008944785, -155.27662351310246, -39.04260973525881, -92.18083515669605, -160.40710339484576, -150.26151162334347, -58.78961924602603, 17.40194058593799, -196.33834356898936, -151.12388325865808, 103.75247201062604, -181.693938862891, -69.27751833179306, 55.07528311922915, -207.55055383421617, -151.8805415184234, -254.2714723470084, 4.983018961191824, -142.5812522360232, -125.22975147690705, -12.748274239842114, -37.68400653765483, -199.89745654502156, -125.16400890179622, -0.1763735720150091, 6.153332290879359, 20.000000000000014, -251.19510599196602], "policy_predator_policy_reward": [35.9537801367543, 196.55403016927863, 73.53012094978715, 134.7638428576891, 15.454439967986621, 21.916678187120127, 43.185985947398166, 98.35191161086163, 283.0045076491882, 84.54071403571768, 75.219203371738, 192.49296482232114, 174.007103394845, 164.26151162334267, 74.48961924602594, 13.798059414062022, 118.56519279241687, 346.9567118040618, 53.22709289094208, 192.45686372945477, 83.47751833179237, 18.824716880770968, 201.8266493704615, 261.39827621377196, 269.67147234700855, 13.816981038808143, 215.86367603292905, 97.63799370307048, 94.54827423984204, 53.584006537654936, 266.7681523677011, 66.39259692053167, 18.67637357201498, 12.746667709120608, 53.84184465330051, 251.5571984967663]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9818665093931883, "mean_inference_ms": 2.063951805283759, "mean_action_processing_ms": 0.3316465306435407, "mean_env_wait_ms": 0.26927100677292903, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.019393364588419598, "StateBufferConnector_ms": 0.004436572392781575, "ViewRequirementAgentConnector_ms": 0.19077128834194607}, "num_episodes": 18, "episode_return_max": 167.74248976813183, "episode_return_min": 8.099283841415643, "episode_return_mean": 85.1412225205873, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 82.79309278116594, "num_env_steps_trained_throughput_per_sec": 82.79309278116594, "timesteps_total": 4000, "num_env_steps_sampled_lifetime": 4000, "num_agent_steps_sampled_lifetime": 16000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 16000, "timers": {"training_iteration_time_ms": 48313.219, "restore_workers_time_ms": 0.018, "training_step_time_ms": 48313.168, "sample_time_ms": 1736.14, "learn_time_ms": 46562.793, "learn_throughput": 85.905, "synch_weights_time_ms": 11.117}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "done": false, "training_iteration": 1, "trial_id": "cf3bb_00000", "date": "2024-08-20_06-33-00", "timestamp": 1724115780, "time_this_iter_s": 48.366936922073364, "time_total_s": 48.366936922073364, "pid": 25777, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39f7b4ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 48.366936922073364, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 32.27391304347825, "ram_util_percent": 82.55217391304346}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6236667603904765, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 5.408141557501738, "policy_loss": -0.0013561086731632708, "vf_loss": 5.40920196197651, "vf_explained_var": 0.0006441702287663858, "kl": 0.002957046390611627, "entropy": 1.6009043815274717, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 2835.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.0294812812060905, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 7.959767328746735, "policy_loss": -0.002406970137069938, "vf_loss": 7.961402230540281, "vf_explained_var": 0.0034446677833637864, "kl": 0.007720664607805712, "entropy": 1.588415985826462, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 2835.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "env_runners": {"episode_reward_max": 300.69999999999976, "episode_reward_min": 8.099283841415643, "episode_reward_mean": 103.51606713108505, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 7200, "policy_reward_min": {"prey_policy": -381.28016681507495, "predator_policy": 0.9258226910876294}, "policy_reward_max": {"prey_policy": 155.0374351303077, "predator_policy": 389.0020018834168}, "policy_reward_mean": {"prey_policy": -61.92773780112628, "predator_policy": 113.68577136666869}, "custom_metrics": {}, "hist_stats": {"episode_reward": [74.09999999999957, 163.39999999999955, 73.89999999999975, 143.79999999999976, 91.36339727732528, 136.48872330210415, 27.600000000000126, 46.900000000000276, 118.0596777688312, 167.74248976813183, 88.09999999999914, 103.7938302315942, 34.20000000000012, 45.69066602306977, 97.69999999999979, 8.099283841415643, 37.40000000000026, 74.2039371581011, 73.7, 103.4999999999996, 183.09999999999974, 187.19999999999976, 300.69999999999976, 89.37797072427313, 286.4000000000003, 98.77205195094743, 98.44520656155862, 117.39715899760323, 55.01967578976549, 53.200000000000216, 98.84282531232157, 167.59715796318733, 55.284364048834554, 111.09999999999965, 28.300000000000136, 86.10000000000012], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [31.246219863245845, -189.65403016927897, 69.46987905021282, -114.36384285768938, 35.164265756551494, 1.364616088341912, -9.785985947398201, 12.048088389138337, -120.9052008944785, -155.27662351310246, -39.04260973525881, -92.18083515669605, -160.40710339484576, -150.26151162334347, -58.78961924602603, 17.40194058593799, -196.33834356898936, -151.12388325865808, 103.75247201062604, -181.693938862891, -69.27751833179306, 55.07528311922915, -207.55055383421617, -151.8805415184234, -254.2714723470084, 4.983018961191824, -142.5812522360232, -125.22975147690705, -12.748274239842114, -37.68400653765483, -199.89745654502156, -125.16400890179622, -0.1763735720150091, 6.153332290879359, 20.000000000000014, -251.19510599196602, -157.50782149117347, -73.90919562847583, -162.2025071789666, -55.10408901411828, 77.76239309313068, 8.650395836416202, -186.98784350717656, 155.0374351303077, 95.6245872201897, 146.9491999078721, -49.7668927697201, 46.065701136396264, 107.17417730891225, 152.7637693615036, -53.469979168523025, -381.28016681507495, 8.478286275446905, -13.629379654345122, -55.55415541857434, 73.3505944709956, -136.64578972313757, -116.13137012553533, 35.86872339638715, -54.69920076156622, -199.3597413476573, -65.47818162267431, -222.6015608150478, 89.03828329438896, -84.87325202645712, -15.733603558965411, -201.75471017891346, 20.994630660878144, -111.72783368777128, -76.06899145152879, -50.54975335994396, -110.69855182260218], "policy_predator_policy_reward": [35.9537801367543, 196.55403016927863, 73.53012094978715, 134.7638428576891, 15.454439967986621, 21.916678187120127, 43.185985947398166, 98.35191161086163, 283.0045076491882, 84.54071403571768, 75.219203371738, 192.49296482232114, 174.007103394845, 164.26151162334267, 74.48961924602594, 13.798059414062022, 118.56519279241687, 346.9567118040618, 53.22709289094208, 192.45686372945477, 83.47751833179237, 18.824716880770968, 201.8266493704615, 261.39827621377196, 269.67147234700855, 13.816981038808143, 215.86367603292905, 97.63799370307048, 94.54827423984204, 53.584006537654936, 266.7681523677011, 66.39259692053167, 18.67637357201498, 12.746667709120608, 53.84184465330051, 251.5571984967663, 169.4078214911729, 135.70919562847544, 173.60250717896596, 147.20408901411832, 26.119242345917584, 70.56796872453535, 196.98784350717594, 22.162564869692325, 53.175412779810344, 4.950800092127931, 85.099746675637, 7.97941568196079, 0.9258226910876294, 25.536230638496406, 389.0020018834168, 144.52019605112872, 11.948818263744746, 91.6474816767129, 70.2513144161776, 29.34940552900438, 139.97553731455793, 167.8212983238795, 1.131276603612868, 70.89920076156596, 316.0970474745071, 47.58370080814565, 214.88962039538438, 86.27081508846202, 48.869474688828014, 107.0217449454282, 204.1908894612832, 87.6691900567517, 124.82783368777054, 91.26899145152827, 106.74975335994327, 140.59855182260154]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9276061934296903, "mean_inference_ms": 2.019899889114358, "mean_action_processing_ms": 0.3217720185983153, "mean_env_wait_ms": 0.2620016134649848, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013662377993265787, "StateBufferConnector_ms": 0.004450480143229167, "ViewRequirementAgentConnector_ms": 0.15893644756740993}, "num_episodes": 18, "episode_return_max": 300.69999999999976, "episode_return_min": 8.099283841415643, "episode_return_mean": 103.51606713108505, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1.584880901903377, "num_env_steps_trained_throughput_per_sec": 1.584880901903377, "timesteps_total": 8000, "num_env_steps_sampled_lifetime": 8000, "num_agent_steps_sampled_lifetime": 32000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 32000, "timers": {"training_iteration_time_ms": 1286081.162, "restore_workers_time_ms": 0.072, "training_step_time_ms": 1286080.92, "sample_time_ms": 1620.97, "learn_time_ms": 1284446.315, "learn_throughput": 3.114, "synch_weights_time_ms": 10.898}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "done": false, "training_iteration": 2, "trial_id": "cf3bb_00000", "date": "2024-08-20_07-15-07", "timestamp": 1724118307, "time_this_iter_s": 2523.8738412857056, "time_total_s": 2572.240778207779, "pid": 25777, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39f7d5ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2572.240778207779, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 41.33246753246753, "ram_util_percent": 82.34675324675324}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.4541191249395962, "cur_kl_coeff": 0.05, "cur_lr": 0.00010000000000000003, "total_loss": 3.909439962629288, "policy_loss": -0.005911460561953761, "vf_loss": 3.914546025997747, "vf_explained_var": -0.0006021996969899173, "kl": 0.016107853814098863, "entropy": 1.5763862732226255, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 4725.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.403497942785422, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 6.066268420850158, "policy_loss": -0.0070580519454938075, "vf_loss": 6.071472778269854, "vf_explained_var": 0.003023175934635142, "kl": 0.018536969849989048, "entropy": 1.577099336644329, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 4725.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "env_runners": {"episode_reward_max": 300.69999999999976, "episode_reward_min": -36.210974324064644, "episode_reward_mean": 84.97541614946903, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 10800, "policy_reward_min": {"prey_policy": -381.28016681507495, "predator_policy": 0.9258226910876294}, "policy_reward_max": {"prey_policy": 155.0374351303077, "predator_policy": 454.2209823645902}, "policy_reward_mean": {"prey_policy": -69.9207012995307, "predator_policy": 112.40840937426505}, "custom_metrics": {}, "hist_stats": {"episode_reward": [74.09999999999957, 163.39999999999955, 73.89999999999975, 143.79999999999976, 91.36339727732528, 136.48872330210415, 27.600000000000126, 46.900000000000276, 118.0596777688312, 167.74248976813183, 88.09999999999914, 103.7938302315942, 34.20000000000012, 45.69066602306977, 97.69999999999979, 8.099283841415643, 37.40000000000026, 74.2039371581011, 73.7, 103.4999999999996, 183.09999999999974, 187.19999999999976, 300.69999999999976, 89.37797072427313, 286.4000000000003, 98.77205195094743, 98.44520656155862, 117.39715899760323, 55.01967578976549, 53.200000000000216, 98.84282531232157, 167.59715796318733, 55.284364048834554, 111.09999999999965, 28.300000000000136, 86.10000000000012, 141.58496044494402, -36.210974324064644, 14.292493527718989, 36.90000000000017, 24.494992530274054, 35.863512135210314, 53.400000000000254, 28.600000000000136, 147.29999999999944, 22.150468854339962, 37.30000000000026, -26.8663411899469, 31.600000000000183, 53.500000000000234, 64.39802988091809, 177.29744769633302, 33.40000000000022, 23.089465796537688], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [31.246219863245845, -189.65403016927897, 69.46987905021282, -114.36384285768938, 35.164265756551494, 1.364616088341912, -9.785985947398201, 12.048088389138337, -120.9052008944785, -155.27662351310246, -39.04260973525881, -92.18083515669605, -160.40710339484576, -150.26151162334347, -58.78961924602603, 17.40194058593799, -196.33834356898936, -151.12388325865808, 103.75247201062604, -181.693938862891, -69.27751833179306, 55.07528311922915, -207.55055383421617, -151.8805415184234, -254.2714723470084, 4.983018961191824, -142.5812522360232, -125.22975147690705, -12.748274239842114, -37.68400653765483, -199.89745654502156, -125.16400890179622, -0.1763735720150091, 6.153332290879359, 20.000000000000014, -251.19510599196602, -157.50782149117347, -73.90919562847583, -162.2025071789666, -55.10408901411828, 77.76239309313068, 8.650395836416202, -186.98784350717656, 155.0374351303077, 95.6245872201897, 146.9491999078721, -49.7668927697201, 46.065701136396264, 107.17417730891225, 152.7637693615036, -53.469979168523025, -381.28016681507495, 8.478286275446905, -13.629379654345122, -55.55415541857434, 73.3505944709956, -136.64578972313757, -116.13137012553533, 35.86872339638715, -54.69920076156622, -199.3597413476573, -65.47818162267431, -222.6015608150478, 89.03828329438896, -84.87325202645712, -15.733603558965411, -201.75471017891346, 20.994630660878144, -111.72783368777128, -76.06899145152879, -50.54975335994396, -110.69855182260218, -0.17461336800600522, 15.80447472239683, -254.51590206668706, -269.98928168518114, -158.66866616387338, -124.85096850122733, -125.69491643046112, -65.55585656765287, -21.24092017985742, -258.4725799215397, -5.067327868759232, -76.37329020525452, -41.13043781609296, -97.66883027267461, 9.415037296909608, -177.66948964802017, -77.30640109070622, 67.97682741339426, -34.88746165742568, -145.28959111602458, -49.773305763674934, -67.75178281845412, -178.4517568818257, -254.3323787780704, -57.988656658678416, -76.65684889586636, -13.441278778141555, -11.02044584352705, -143.40226470011453, -0.8468342103517374, 78.55641219851923, 38.904586252174276, -42.83407365670662, -139.69456046921903, -95.24347768415174, -237.3017568533912], "policy_predator_policy_reward": [35.9537801367543, 196.55403016927863, 73.53012094978715, 134.7638428576891, 15.454439967986621, 21.916678187120127, 43.185985947398166, 98.35191161086163, 283.0045076491882, 84.54071403571768, 75.219203371738, 192.49296482232114, 174.007103394845, 164.26151162334267, 74.48961924602594, 13.798059414062022, 118.56519279241687, 346.9567118040618, 53.22709289094208, 192.45686372945477, 83.47751833179237, 18.824716880770968, 201.8266493704615, 261.39827621377196, 269.67147234700855, 13.816981038808143, 215.86367603292905, 97.63799370307048, 94.54827423984204, 53.584006537654936, 266.7681523677011, 66.39259692053167, 18.67637357201498, 12.746667709120608, 53.84184465330051, 251.5571984967663, 169.4078214911729, 135.70919562847544, 173.60250717896596, 147.20408901411832, 26.119242345917584, 70.56796872453535, 196.98784350717594, 22.162564869692325, 53.175412779810344, 4.950800092127931, 85.099746675637, 7.97941568196079, 0.9258226910876294, 25.536230638496406, 389.0020018834168, 144.52019605112872, 11.948818263744746, 91.6474816767129, 70.2513144161776, 29.34940552900438, 139.97553731455793, 167.8212983238795, 1.131276603612868, 70.89920076156596, 316.0970474745071, 47.58370080814565, 214.88962039538438, 86.27081508846202, 48.869474688828014, 107.0217449454282, 204.1908894612832, 87.6691900567517, 124.82783368777054, 91.26899145152827, 106.74975335994327, 140.59855182260154, 26.057004971444503, 99.89809411910949, 454.2209823645902, 34.07322706321371, 43.52190336303487, 254.2902248297835, 147.19491643046055, 80.95585656765206, 182.13459275063047, 122.07389988104084, 75.84837355407487, 41.4557566551482, 81.23043781609289, 110.96883027267391, 10.184962703090356, 186.66948964801983, 136.8079190000228, 19.821654677288823, 84.72095931810414, 117.60656230968559, 67.3733057636752, 87.45178281845327, 352.73244031233446, 53.1853541576135, 73.98865665867794, 92.2568488958655, 48.34127877814171, 29.620445843527225, 105.94249571456048, 102.70463307682338, 7.8085690002437484, 52.02788024539647, 60.53407365670687, 155.3945604692186, 346.65839784361606, 8.97630249046371]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8833223665952885, "mean_inference_ms": 1.9414155354219644, "mean_action_processing_ms": 0.31052751862059413, "mean_env_wait_ms": 0.2521276753762378, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011615179203174732, "StateBufferConnector_ms": 0.004083801198888708, "ViewRequirementAgentConnector_ms": 0.14133210535402652}, "num_episodes": 18, "episode_return_max": 300.69999999999976, "episode_return_min": -36.210974324064644, "episode_return_mean": 84.97541614946903, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 90.75367710887055, "num_env_steps_trained_throughput_per_sec": 90.75367710887055, "timesteps_total": 12000, "num_env_steps_sampled_lifetime": 12000, "num_agent_steps_sampled_lifetime": 48000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 48000, "timers": {"training_iteration_time_ms": 872079.226, "restore_workers_time_ms": 0.053, "training_step_time_ms": 872079.052, "sample_time_ms": 1465.803, "learn_time_ms": 870599.494, "learn_throughput": 4.595, "synch_weights_time_ms": 11.08}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "done": false, "training_iteration": 3, "trial_id": "cf3bb_00000", "date": "2024-08-20_07-15-51", "timestamp": 1724118351, "time_this_iter_s": 44.10979676246643, "time_total_s": 2616.3505749702454, "pid": 25777, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39f817040>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2616.3505749702454, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 32.357142857142854, "ram_util_percent": 82.41428571428573}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5537992378410996, "cur_kl_coeff": 0.05, "cur_lr": 0.00010000000000000003, "total_loss": 5.166197383719147, "policy_loss": -0.009016188092174984, "vf_loss": 5.1742583022546516, "vf_explained_var": -8.881268677888093e-05, "kl": 0.0191055216846043, "entropy": 1.5025584820086364, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 6615.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1128347079984096, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 6.552664931867488, "policy_loss": -0.004389557595211993, "vf_loss": 6.555630943257973, "vf_explained_var": 0.0004965436521661345, "kl": 0.014235322295987212, "entropy": 1.5323106556342392, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 6615.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "env_runners": {"episode_reward_max": 300.69999999999976, "episode_reward_min": -36.210974324064644, "episode_reward_mean": 81.08541787013299, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 14400, "policy_reward_min": {"prey_policy": -414.8775847774382, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 155.0374351303077, "predator_policy": 575.8061097677602}, "policy_reward_mean": {"prey_policy": -79.41279725974852, "predator_policy": 119.95550619481486}, "custom_metrics": {}, "hist_stats": {"episode_reward": [74.09999999999957, 163.39999999999955, 73.89999999999975, 143.79999999999976, 91.36339727732528, 136.48872330210415, 27.600000000000126, 46.900000000000276, 118.0596777688312, 167.74248976813183, 88.09999999999914, 103.7938302315942, 34.20000000000012, 45.69066602306977, 97.69999999999979, 8.099283841415643, 37.40000000000026, 74.2039371581011, 73.7, 103.4999999999996, 183.09999999999974, 187.19999999999976, 300.69999999999976, 89.37797072427313, 286.4000000000003, 98.77205195094743, 98.44520656155862, 117.39715899760323, 55.01967578976549, 53.200000000000216, 98.84282531232157, 167.59715796318733, 55.284364048834554, 111.09999999999965, 28.300000000000136, 86.10000000000012, 141.58496044494402, -36.210974324064644, 14.292493527718989, 36.90000000000017, 24.494992530274054, 35.863512135210314, 53.400000000000254, 28.600000000000136, 147.29999999999944, 22.150468854339962, 37.30000000000026, -26.8663411899469, 31.600000000000183, 53.500000000000234, 64.39802988091809, 177.29744769633302, 33.40000000000022, 23.089465796537688, 124.29999999999956, 57.20113319406714, 80.49999999999949, 84.2999999999993, 53.73479582582052, 64.00262784403016, 87.345778354645, -20.090536496721974, 157.29999999999933, 88.99315193335804, 17.42039841395536, 11.591430861249885, 57.71355151533831, 142.91782910245269, 82.82106606537204, 72.29999999999983, 31.740557081311927, 55.385830883371106], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [31.246219863245845, -189.65403016927897, 69.46987905021282, -114.36384285768938, 35.164265756551494, 1.364616088341912, -9.785985947398201, 12.048088389138337, -120.9052008944785, -155.27662351310246, -39.04260973525881, -92.18083515669605, -160.40710339484576, -150.26151162334347, -58.78961924602603, 17.40194058593799, -196.33834356898936, -151.12388325865808, 103.75247201062604, -181.693938862891, -69.27751833179306, 55.07528311922915, -207.55055383421617, -151.8805415184234, -254.2714723470084, 4.983018961191824, -142.5812522360232, -125.22975147690705, -12.748274239842114, -37.68400653765483, -199.89745654502156, -125.16400890179622, -0.1763735720150091, 6.153332290879359, 20.000000000000014, -251.19510599196602, -157.50782149117347, -73.90919562847583, -162.2025071789666, -55.10408901411828, 77.76239309313068, 8.650395836416202, -186.98784350717656, 155.0374351303077, 95.6245872201897, 146.9491999078721, -49.7668927697201, 46.065701136396264, 107.17417730891225, 152.7637693615036, -53.469979168523025, -381.28016681507495, 8.478286275446905, -13.629379654345122, -55.55415541857434, 73.3505944709956, -136.64578972313757, -116.13137012553533, 35.86872339638715, -54.69920076156622, -199.3597413476573, -65.47818162267431, -222.6015608150478, 89.03828329438896, -84.87325202645712, -15.733603558965411, -201.75471017891346, 20.994630660878144, -111.72783368777128, -76.06899145152879, -50.54975335994396, -110.69855182260218, -0.17461336800600522, 15.80447472239683, -254.51590206668706, -269.98928168518114, -158.66866616387338, -124.85096850122733, -125.69491643046112, -65.55585656765287, -21.24092017985742, -258.4725799215397, -5.067327868759232, -76.37329020525452, -41.13043781609296, -97.66883027267461, 9.415037296909608, -177.66948964802017, -77.30640109070622, 67.97682741339426, -34.88746165742568, -145.28959111602458, -49.773305763674934, -67.75178281845412, -178.4517568818257, -254.3323787780704, -57.988656658678416, -76.65684889586636, -13.441278778141555, -11.02044584352705, -143.40226470011453, -0.8468342103517374, 78.55641219851923, 38.904586252174276, -42.83407365670662, -139.69456046921903, -95.24347768415174, -237.3017568533912, 67.43215226517582, -277.70415019505003, -74.28193639199056, 9.341134522810583, -29.52547721036023, -157.37069347057223, -53.86827233477578, -18.643470249452054, 7.435363771062006, -204.0162120664745, -328.689964285151, -52.162207286626426, 39.73931675719238, -343.6990572926092, -360.77280235960563, -243.09764700592808, -73.37646231772972, 75.73279962588626, -25.658250028934876, -62.82787042937889, 8.447998198061786, -328.49110834621194, -149.83755838665226, -178.00659955260804, -112.63663177956926, -139.70922279229487, 23.1937269532793, -162.8134608986617, 23.779731960404476, -414.8775847774382, -40.329686068557, 29.000000000000163, -119.26959850187424, -33.53382435494794, -95.72476363090416, -87.18477709398441], "policy_predator_policy_reward": [35.9537801367543, 196.55403016927863, 73.53012094978715, 134.7638428576891, 15.454439967986621, 21.916678187120127, 43.185985947398166, 98.35191161086163, 283.0045076491882, 84.54071403571768, 75.219203371738, 192.49296482232114, 174.007103394845, 164.26151162334267, 74.48961924602594, 13.798059414062022, 118.56519279241687, 346.9567118040618, 53.22709289094208, 192.45686372945477, 83.47751833179237, 18.824716880770968, 201.8266493704615, 261.39827621377196, 269.67147234700855, 13.816981038808143, 215.86367603292905, 97.63799370307048, 94.54827423984204, 53.584006537654936, 266.7681523677011, 66.39259692053167, 18.67637357201498, 12.746667709120608, 53.84184465330051, 251.5571984967663, 169.4078214911729, 135.70919562847544, 173.60250717896596, 147.20408901411832, 26.119242345917584, 70.56796872453535, 196.98784350717594, 22.162564869692325, 53.175412779810344, 4.950800092127931, 85.099746675637, 7.97941568196079, 0.9258226910876294, 25.536230638496406, 389.0020018834168, 144.52019605112872, 11.948818263744746, 91.6474816767129, 70.2513144161776, 29.34940552900438, 139.97553731455793, 167.8212983238795, 1.131276603612868, 70.89920076156596, 316.0970474745071, 47.58370080814565, 214.88962039538438, 86.27081508846202, 48.869474688828014, 107.0217449454282, 204.1908894612832, 87.6691900567517, 124.82783368777054, 91.26899145152827, 106.74975335994327, 140.59855182260154, 26.057004971444503, 99.89809411910949, 454.2209823645902, 34.07322706321371, 43.52190336303487, 254.2902248297835, 147.19491643046055, 80.95585656765206, 182.13459275063047, 122.07389988104084, 75.84837355407487, 41.4557566551482, 81.23043781609289, 110.96883027267391, 10.184962703090356, 186.66948964801983, 136.8079190000228, 19.821654677288823, 84.72095931810414, 117.60656230968559, 67.3733057636752, 87.45178281845327, 352.73244031233446, 53.1853541576135, 73.98865665867794, 92.2568488958655, 48.34127877814171, 29.620445843527225, 105.94249571456048, 102.70463307682338, 7.8085690002437484, 52.02788024539647, 60.53407365670687, 155.3945604692186, 346.65839784361606, 8.97630249046371, 46.36784773482404, 288.2041501950499, 8.18097998100373, 113.96095508224231, 99.02547721036031, 168.37069347057223, 121.16827233477578, 35.64347024945225, 179.50175675473793, 70.81388736649394, 345.38899280497907, 99.46580661082866, 74.02538730230853, 317.2801315877537, 7.9738031010510735, 575.8061097677602, 145.5843093501513, 9.359353341691216, 100.44983594205826, 77.02943644961421, 0.7885167394102703, 336.6749918226967, 195.3053144194981, 144.13027438101068, 266.73687017564924, 43.32253591155202, 99.6108819153417, 182.92668113249397, 7.729041434779866, 466.18987744762586, 83.62968606855719, 0.0, 19.635114504538983, 164.90886543359454, 127.3359507646376, 110.95942084362032]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.2227473859361258, "mean_inference_ms": 11.329868524708319, "mean_action_processing_ms": 7.394586680356282, "mean_env_wait_ms": 2.6103920132810163, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010325014591217041, "StateBufferConnector_ms": 0.010797546969519721, "ViewRequirementAgentConnector_ms": 0.13320446014404297}, "num_episodes": 18, "episode_return_max": 300.69999999999976, "episode_return_min": -36.210974324064644, "episode_return_mean": 81.08541787013299, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 20.447218057553187, "num_env_steps_trained_throughput_per_sec": 20.447218057553187, "timesteps_total": 16000, "num_env_steps_sampled_lifetime": 16000, "num_agent_steps_sampled_lifetime": 64000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 64000, "timers": {"training_iteration_time_ms": 702965.83, "restore_workers_time_ms": 0.043, "training_step_time_ms": 702965.687, "sample_time_ms": 39249.653, "learn_time_ms": 663702.715, "learn_throughput": 6.027, "synch_weights_time_ms": 10.927}, "counters": {"num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "done": false, "training_iteration": 4, "trial_id": "cf3bb_00000", "date": "2024-08-20_07-19-07", "timestamp": 1724118547, "time_this_iter_s": 195.66733121871948, "time_total_s": 2812.017906188965, "pid": 25777, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39f8179d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2812.017906188965, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 28.659677419354836, "ram_util_percent": 81.78709677419353}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5471794013939206, "cur_kl_coeff": 0.05, "cur_lr": 0.00010000000000000003, "total_loss": 4.962316084412671, "policy_loss": -0.0036223548213167797, "vf_loss": 4.965270366996684, "vf_explained_var": -0.00013105976518499788, "kl": 0.013361241678751959, "entropy": 1.5335555861866663, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 8505.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.8484302123860705, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 5.1042757998067865, "policy_loss": -0.008850796362902555, "vf_loss": 5.110886793414121, "vf_explained_var": 0.004021071725421482, "kl": 0.022398122914642594, "entropy": 1.5367548012859606, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 8505.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "env_runners": {"episode_reward_max": 300.69999999999976, "episode_reward_min": -83.25068943989784, "episode_reward_mean": 80.03247013070886, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 19800, "policy_reward_min": {"prey_policy": -476.1200934514208, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 155.0374351303077, "predator_policy": 575.8061097677602}, "policy_reward_mean": {"prey_policy": -87.49130129472127, "predator_policy": 127.50753636007563}, "custom_metrics": {}, "hist_stats": {"episode_reward": [74.09999999999957, 163.39999999999955, 73.89999999999975, 143.79999999999976, 91.36339727732528, 136.48872330210415, 27.600000000000126, 46.900000000000276, 118.0596777688312, 167.74248976813183, 88.09999999999914, 103.7938302315942, 34.20000000000012, 45.69066602306977, 97.69999999999979, 8.099283841415643, 37.40000000000026, 74.2039371581011, 73.7, 103.4999999999996, 183.09999999999974, 187.19999999999976, 300.69999999999976, 89.37797072427313, 286.4000000000003, 98.77205195094743, 98.44520656155862, 117.39715899760323, 55.01967578976549, 53.200000000000216, 98.84282531232157, 167.59715796318733, 55.284364048834554, 111.09999999999965, 28.300000000000136, 86.10000000000012, 141.58496044494402, -36.210974324064644, 14.292493527718989, 36.90000000000017, 24.494992530274054, 35.863512135210314, 53.400000000000254, 28.600000000000136, 147.29999999999944, 22.150468854339962, 37.30000000000026, -26.8663411899469, 31.600000000000183, 53.500000000000234, 64.39802988091809, 177.29744769633302, 33.40000000000022, 23.089465796537688, 124.29999999999956, 57.20113319406714, 80.49999999999949, 84.2999999999993, 53.73479582582052, 64.00262784403016, 87.345778354645, -20.090536496721974, 157.29999999999933, 88.99315193335804, 17.42039841395536, 11.591430861249885, 57.71355151533831, 142.91782910245269, 82.82106606537204, 72.29999999999983, 31.740557081311927, 55.385830883371106, 88.69999999999892, 82.32746978457058, -9.94244322249786, -73.20112573267724, 11.951675587741232, 143.21457176583795, -82.08153336271486, 101.56280839708205, 105.89999999999905, 138.7999999999987, 149.09999999999894, 54.70000000000031, 79.47420818185596, 176.5021211954248, 79.79999999999929, 55.995824868789356, 242.9265260104854, 235.68470101431512, 16.99999999999998, 40.70000000000033, -83.25068943989784, 69.20000000000016, 98.79999999999896, 140.97545058587124, 37.89169703412222, 97.96063265044081, 84.37256097185853], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [31.246219863245845, -189.65403016927897, 69.46987905021282, -114.36384285768938, 35.164265756551494, 1.364616088341912, -9.785985947398201, 12.048088389138337, -120.9052008944785, -155.27662351310246, -39.04260973525881, -92.18083515669605, -160.40710339484576, -150.26151162334347, -58.78961924602603, 17.40194058593799, -196.33834356898936, -151.12388325865808, 103.75247201062604, -181.693938862891, -69.27751833179306, 55.07528311922915, -207.55055383421617, -151.8805415184234, -254.2714723470084, 4.983018961191824, -142.5812522360232, -125.22975147690705, -12.748274239842114, -37.68400653765483, -199.89745654502156, -125.16400890179622, -0.1763735720150091, 6.153332290879359, 20.000000000000014, -251.19510599196602, -157.50782149117347, -73.90919562847583, -162.2025071789666, -55.10408901411828, 77.76239309313068, 8.650395836416202, -186.98784350717656, 155.0374351303077, 95.6245872201897, 146.9491999078721, -49.7668927697201, 46.065701136396264, 107.17417730891225, 152.7637693615036, -53.469979168523025, -381.28016681507495, 8.478286275446905, -13.629379654345122, -55.55415541857434, 73.3505944709956, -136.64578972313757, -116.13137012553533, 35.86872339638715, -54.69920076156622, -199.3597413476573, -65.47818162267431, -222.6015608150478, 89.03828329438896, -84.87325202645712, -15.733603558965411, -201.75471017891346, 20.994630660878144, -111.72783368777128, -76.06899145152879, -50.54975335994396, -110.69855182260218, -0.17461336800600522, 15.80447472239683, -254.51590206668706, -269.98928168518114, -158.66866616387338, -124.85096850122733, -125.69491643046112, -65.55585656765287, -21.24092017985742, -258.4725799215397, -5.067327868759232, -76.37329020525452, -41.13043781609296, -97.66883027267461, 9.415037296909608, -177.66948964802017, -77.30640109070622, 67.97682741339426, -34.88746165742568, -145.28959111602458, -49.773305763674934, -67.75178281845412, -178.4517568818257, -254.3323787780704, -57.988656658678416, -76.65684889586636, -13.441278778141555, -11.02044584352705, -143.40226470011453, -0.8468342103517374, 78.55641219851923, 38.904586252174276, -42.83407365670662, -139.69456046921903, -95.24347768415174, -237.3017568533912, 67.43215226517582, -277.70415019505003, -74.28193639199056, 9.341134522810583, -29.52547721036023, -157.37069347057223, -53.86827233477578, -18.643470249452054, 7.435363771062006, -204.0162120664745, -328.689964285151, -52.162207286626426, 39.73931675719238, -343.6990572926092, -360.77280235960563, -243.09764700592808, -73.37646231772972, 75.73279962588626, -25.658250028934876, -62.82787042937889, 8.447998198061786, -328.49110834621194, -149.83755838665226, -178.00659955260804, -112.63663177956926, -139.70922279229487, 23.1937269532793, -162.8134608986617, 23.779731960404476, -414.8775847774382, -40.329686068557, 29.000000000000163, -119.26959850187424, -33.53382435494794, -95.72476363090416, -87.18477709398441, 13.156455428744977, -10.1545631598036, 22.26892244313229, -2.961119563199681, -52.54057557714963, -83.7567102673561, -340.09666914583795, -138.67170669280415, -55.46492185477945, -112.88724490586947, -28.394765857936584, -397.36350752702225, -319.27498922555236, -209.01447292996696, -191.22809335714766, -29.11510379504579, 11.60984312931292, 41.02724574006264, 46.40378606892648, 61.095718151387054, 71.6615365434838, 37.959987512783734, -52.29473065556793, -237.67794101944608, -15.015041506749203, -194.52590324125893, -476.1200934514208, -127.76134254171913, -29.91104717887071, 58.554011359560555, -194.44918436406383, -80.72570126441407, 45.12914561176653, -108.39980003365915, -368.8145935312249, -184.53721992775428, -401.4250348802931, -198.92743845343009, -130.71147371701537, 23.97216739040206, -187.5890647303272, -139.4328123490244, -203.44612388238139, 48.41898488228902, 30.451134739824614, -22.59370477241005, 10.802141871674612, 3.4387018006741146, -224.10912325013888, -220.20823538765868, -314.4389872117105, 11.310989426161196, -358.6827104000705, 17.626128558872228], "policy_predator_policy_reward": [35.9537801367543, 196.55403016927863, 73.53012094978715, 134.7638428576891, 15.454439967986621, 21.916678187120127, 43.185985947398166, 98.35191161086163, 283.0045076491882, 84.54071403571768, 75.219203371738, 192.49296482232114, 174.007103394845, 164.26151162334267, 74.48961924602594, 13.798059414062022, 118.56519279241687, 346.9567118040618, 53.22709289094208, 192.45686372945477, 83.47751833179237, 18.824716880770968, 201.8266493704615, 261.39827621377196, 269.67147234700855, 13.816981038808143, 215.86367603292905, 97.63799370307048, 94.54827423984204, 53.584006537654936, 266.7681523677011, 66.39259692053167, 18.67637357201498, 12.746667709120608, 53.84184465330051, 251.5571984967663, 169.4078214911729, 135.70919562847544, 173.60250717896596, 147.20408901411832, 26.119242345917584, 70.56796872453535, 196.98784350717594, 22.162564869692325, 53.175412779810344, 4.950800092127931, 85.099746675637, 7.97941568196079, 0.9258226910876294, 25.536230638496406, 389.0020018834168, 144.52019605112872, 11.948818263744746, 91.6474816767129, 70.2513144161776, 29.34940552900438, 139.97553731455793, 167.8212983238795, 1.131276603612868, 70.89920076156596, 316.0970474745071, 47.58370080814565, 214.88962039538438, 86.27081508846202, 48.869474688828014, 107.0217449454282, 204.1908894612832, 87.6691900567517, 124.82783368777054, 91.26899145152827, 106.74975335994327, 140.59855182260154, 26.057004971444503, 99.89809411910949, 454.2209823645902, 34.07322706321371, 43.52190336303487, 254.2902248297835, 147.19491643046055, 80.95585656765206, 182.13459275063047, 122.07389988104084, 75.84837355407487, 41.4557566551482, 81.23043781609289, 110.96883027267391, 10.184962703090356, 186.66948964801983, 136.8079190000228, 19.821654677288823, 84.72095931810414, 117.60656230968559, 67.3733057636752, 87.45178281845327, 352.73244031233446, 53.1853541576135, 73.98865665867794, 92.2568488958655, 48.34127877814171, 29.620445843527225, 105.94249571456048, 102.70463307682338, 7.8085690002437484, 52.02788024539647, 60.53407365670687, 155.3945604692186, 346.65839784361606, 8.97630249046371, 46.36784773482404, 288.2041501950499, 8.18097998100373, 113.96095508224231, 99.02547721036031, 168.37069347057223, 121.16827233477578, 35.64347024945225, 179.50175675473793, 70.81388736649394, 345.38899280497907, 99.46580661082866, 74.02538730230853, 317.2801315877537, 7.9738031010510735, 575.8061097677602, 145.5843093501513, 9.359353341691216, 100.44983594205826, 77.02943644961421, 0.7885167394102703, 336.6749918226967, 195.3053144194981, 144.13027438101068, 266.73687017564924, 43.32253591155202, 99.6108819153417, 182.92668113249397, 7.729041434779866, 466.18987744762586, 83.62968606855719, 0.0, 19.635114504538983, 164.90886543359454, 127.3359507646376, 110.95942084362032, 74.28272325660849, 11.41538447445029, 37.523131873407166, 25.496535031231716, 7.778158734735135, 118.57668388727163, 384.70100073674047, 20.866249369223926, 17.889779282597956, 162.41406306579125, 323.50375273130464, 245.46909241949245, 103.9001733947331, 342.30775539807263, 158.67022340238387, 163.2357821468912, 7.590156870687051, 45.6727542599375, 7.0589805011856015, 24.24151527850119, 25.53846345651587, 13.940012487216478, 339.35589150840514, 5.316780166608735, 85.17114874441484, 203.84400418544945, 333.67558408926556, 446.707973099299, 46.91104717887095, 4.24598864043963, 112.82404529227877, 218.34666520498703, 164.481871804163, 141.7153086282164, 345.77727350269475, 443.25924097059993, 273.19508062286525, 344.15739271085744, 144.5114737170146, 2.927832609598041, 240.94272166374762, 2.828465975706112, 192.79481385258933, 31.432325147503285, 21.73126786546962, 69.21130216711605, 79.04834235372738, 47.686264559796165, 428.9466511308231, 53.26240454109575, 203.2922310457876, 197.79639939020257, 349.6143356097579, 75.8148072033027]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.608702985496165, "mean_inference_ms": 16.923312997978478, "mean_action_processing_ms": 11.64101965612405, "mean_env_wait_ms": 4.02076505031343, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009368886851301097, "StateBufferConnector_ms": 0.008735151001901337, "ViewRequirementAgentConnector_ms": 0.12414623992611663}, "num_episodes": 27, "episode_return_max": 300.69999999999976, "episode_return_min": -83.25068943989784, "episode_return_mean": 80.03247013070886, "episodes_this_iter": 27}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 40.6914328673358, "num_env_steps_trained_throughput_per_sec": 40.6914328673358, "timesteps_total": 20000, "num_env_steps_sampled_lifetime": 20000, "num_agent_steps_sampled_lifetime": 80000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 80000, "timers": {"training_iteration_time_ms": 582032.824, "restore_workers_time_ms": 0.037, "training_step_time_ms": 582032.701, "sample_time_ms": 31618.098, "learn_time_ms": 550401.7, "learn_throughput": 7.267, "synch_weights_time_ms": 10.79}, "counters": {"num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "done": false, "training_iteration": 5, "trial_id": "cf3bb_00000", "date": "2024-08-20_07-20-45", "timestamp": 1724118645, "time_this_iter_s": 98.33339595794678, "time_total_s": 2910.3513021469116, "pid": 25777, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39f82ad30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2910.3513021469116, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 22.01875, "ram_util_percent": 81.4015625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.4989259732719609, "cur_kl_coeff": 0.05, "cur_lr": 0.00010000000000000003, "total_loss": 5.755551544320646, "policy_loss": -0.007062771546817015, "vf_loss": 5.761903122240904, "vf_explained_var": 9.174321694348855e-06, "kl": 0.014224532774049522, "entropy": 1.5407712868281773, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 10395.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.658808354524866, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 0.00010000000000000003, "total_loss": 6.123332782018752, "policy_loss": -0.010005678753885958, "vf_loss": 6.130229828092787, "vf_explained_var": 0.005453338509514218, "kl": 0.020724204896390243, "entropy": 1.554280110894057, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 10395.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "env_runners": {"episode_reward_max": 300.69999999999976, "episode_reward_min": -83.25068943989784, "episode_reward_mean": 74.22211207399927, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -476.1200934514208, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 155.0374351303077, "predator_policy": 575.8061097677602}, "policy_reward_mean": {"prey_policy": -94.13678790386379, "predator_policy": 131.2478439408634}, "custom_metrics": {}, "hist_stats": {"episode_reward": [74.2039371581011, 73.7, 103.4999999999996, 183.09999999999974, 187.19999999999976, 300.69999999999976, 89.37797072427313, 286.4000000000003, 98.77205195094743, 98.44520656155862, 117.39715899760323, 55.01967578976549, 53.200000000000216, 98.84282531232157, 167.59715796318733, 55.284364048834554, 111.09999999999965, 28.300000000000136, 86.10000000000012, 141.58496044494402, -36.210974324064644, 14.292493527718989, 36.90000000000017, 24.494992530274054, 35.863512135210314, 53.400000000000254, 28.600000000000136, 147.29999999999944, 22.150468854339962, 37.30000000000026, -26.8663411899469, 31.600000000000183, 53.500000000000234, 64.39802988091809, 177.29744769633302, 33.40000000000022, 23.089465796537688, 124.29999999999956, 57.20113319406714, 80.49999999999949, 84.2999999999993, 53.73479582582052, 64.00262784403016, 87.345778354645, -20.090536496721974, 157.29999999999933, 88.99315193335804, 17.42039841395536, 11.591430861249885, 57.71355151533831, 142.91782910245269, 82.82106606537204, 72.29999999999983, 31.740557081311927, 55.385830883371106, 88.69999999999892, 82.32746978457058, -9.94244322249786, -73.20112573267724, 11.951675587741232, 143.21457176583795, -82.08153336271486, 101.56280839708205, 105.89999999999905, 138.7999999999987, 149.09999999999894, 54.70000000000031, 79.47420818185596, 176.5021211954248, 79.79999999999929, 55.995824868789356, 242.9265260104854, 235.68470101431512, 16.99999999999998, 40.70000000000033, -83.25068943989784, 69.20000000000016, 98.79999999999896, 140.97545058587124, 37.89169703412222, 97.96063265044081, 84.37256097185853, -72.04390677690043, 96.12144086626763, 46.4313933713204, 90.39999999999927, -49.93016806767406, -61.889305463395544, 22.712148135953832, 96.02962072085124, 33.700000000000216, 37.073230708739, 38.000000000000284, 132.5220425391773, 53.40000000000026, 158.49784017111105, 88.29848533663981, 124.91089777199781, 93.80470884575833, 29.29630451237402], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [20.000000000000014, -251.19510599196602, -157.50782149117347, -73.90919562847583, -162.2025071789666, -55.10408901411828, 77.76239309313068, 8.650395836416202, -186.98784350717656, 155.0374351303077, 95.6245872201897, 146.9491999078721, -49.7668927697201, 46.065701136396264, 107.17417730891225, 152.7637693615036, -53.469979168523025, -381.28016681507495, 8.478286275446905, -13.629379654345122, -55.55415541857434, 73.3505944709956, -136.64578972313757, -116.13137012553533, 35.86872339638715, -54.69920076156622, -199.3597413476573, -65.47818162267431, -222.6015608150478, 89.03828329438896, -84.87325202645712, -15.733603558965411, -201.75471017891346, 20.994630660878144, -111.72783368777128, -76.06899145152879, -50.54975335994396, -110.69855182260218, -0.17461336800600522, 15.80447472239683, -254.51590206668706, -269.98928168518114, -158.66866616387338, -124.85096850122733, -125.69491643046112, -65.55585656765287, -21.24092017985742, -258.4725799215397, -5.067327868759232, -76.37329020525452, -41.13043781609296, -97.66883027267461, 9.415037296909608, -177.66948964802017, -77.30640109070622, 67.97682741339426, -34.88746165742568, -145.28959111602458, -49.773305763674934, -67.75178281845412, -178.4517568818257, -254.3323787780704, -57.988656658678416, -76.65684889586636, -13.441278778141555, -11.02044584352705, -143.40226470011453, -0.8468342103517374, 78.55641219851923, 38.904586252174276, -42.83407365670662, -139.69456046921903, -95.24347768415174, -237.3017568533912, 67.43215226517582, -277.70415019505003, -74.28193639199056, 9.341134522810583, -29.52547721036023, -157.37069347057223, -53.86827233477578, -18.643470249452054, 7.435363771062006, -204.0162120664745, -328.689964285151, -52.162207286626426, 39.73931675719238, -343.6990572926092, -360.77280235960563, -243.09764700592808, -73.37646231772972, 75.73279962588626, -25.658250028934876, -62.82787042937889, 8.447998198061786, -328.49110834621194, -149.83755838665226, -178.00659955260804, -112.63663177956926, -139.70922279229487, 23.1937269532793, -162.8134608986617, 23.779731960404476, -414.8775847774382, -40.329686068557, 29.000000000000163, -119.26959850187424, -33.53382435494794, -95.72476363090416, -87.18477709398441, 13.156455428744977, -10.1545631598036, 22.26892244313229, -2.961119563199681, -52.54057557714963, -83.7567102673561, -340.09666914583795, -138.67170669280415, -55.46492185477945, -112.88724490586947, -28.394765857936584, -397.36350752702225, -319.27498922555236, -209.01447292996696, -191.22809335714766, -29.11510379504579, 11.60984312931292, 41.02724574006264, 46.40378606892648, 61.095718151387054, 71.6615365434838, 37.959987512783734, -52.29473065556793, -237.67794101944608, -15.015041506749203, -194.52590324125893, -476.1200934514208, -127.76134254171913, -29.91104717887071, 58.554011359560555, -194.44918436406383, -80.72570126441407, 45.12914561176653, -108.39980003365915, -368.8145935312249, -184.53721992775428, -401.4250348802931, -198.92743845343009, -130.71147371701537, 23.97216739040206, -187.5890647303272, -139.4328123490244, -203.44612388238139, 48.41898488228902, 30.451134739824614, -22.59370477241005, 10.802141871674612, 3.4387018006741146, -224.10912325013888, -220.20823538765868, -314.4389872117105, 11.310989426161196, -358.6827104000705, 17.626128558872228, -160.36222302132728, -230.89722745740107, -18.02021583481849, -56.045058219949496, 0.5902203083197872, -299.52227500529204, -376.0187203243444, 31.575342082316546, -224.1800409931703, -303.53872244580646, -286.39983661288437, -114.23421454846755, -74.55443600453756, -201.78646916073995, 32.003325099249786, -151.4231752350875, -135.1150647500347, 13.112547227637673, -444.31392026314035, -142.27341386233414, -38.28129206022284, -31.894563781651087, -18.4443721283111, -155.98254078866216, 3.9817940248099446, -326.77366379892516, 32.39043669719561, 62.248387231223866, 21.26408943133584, -244.41629832791017, 9.132322853049498, 30.207584233427358, 4.722643979122724, -87.67484402744415, -177.60668136331202, -55.17496922386655], "policy_predator_policy_reward": [53.84184465330051, 251.5571984967663, 169.4078214911729, 135.70919562847544, 173.60250717896596, 147.20408901411832, 26.119242345917584, 70.56796872453535, 196.98784350717594, 22.162564869692325, 53.175412779810344, 4.950800092127931, 85.099746675637, 7.97941568196079, 0.9258226910876294, 25.536230638496406, 389.0020018834168, 144.52019605112872, 11.948818263744746, 91.6474816767129, 70.2513144161776, 29.34940552900438, 139.97553731455793, 167.8212983238795, 1.131276603612868, 70.89920076156596, 316.0970474745071, 47.58370080814565, 214.88962039538438, 86.27081508846202, 48.869474688828014, 107.0217449454282, 204.1908894612832, 87.6691900567517, 124.82783368777054, 91.26899145152827, 106.74975335994327, 140.59855182260154, 26.057004971444503, 99.89809411910949, 454.2209823645902, 34.07322706321371, 43.52190336303487, 254.2902248297835, 147.19491643046055, 80.95585656765206, 182.13459275063047, 122.07389988104084, 75.84837355407487, 41.4557566551482, 81.23043781609289, 110.96883027267391, 10.184962703090356, 186.66948964801983, 136.8079190000228, 19.821654677288823, 84.72095931810414, 117.60656230968559, 67.3733057636752, 87.45178281845327, 352.73244031233446, 53.1853541576135, 73.98865665867794, 92.2568488958655, 48.34127877814171, 29.620445843527225, 105.94249571456048, 102.70463307682338, 7.8085690002437484, 52.02788024539647, 60.53407365670687, 155.3945604692186, 346.65839784361606, 8.97630249046371, 46.36784773482404, 288.2041501950499, 8.18097998100373, 113.96095508224231, 99.02547721036031, 168.37069347057223, 121.16827233477578, 35.64347024945225, 179.50175675473793, 70.81388736649394, 345.38899280497907, 99.46580661082866, 74.02538730230853, 317.2801315877537, 7.9738031010510735, 575.8061097677602, 145.5843093501513, 9.359353341691216, 100.44983594205826, 77.02943644961421, 0.7885167394102703, 336.6749918226967, 195.3053144194981, 144.13027438101068, 266.73687017564924, 43.32253591155202, 99.6108819153417, 182.92668113249397, 7.729041434779866, 466.18987744762586, 83.62968606855719, 0.0, 19.635114504538983, 164.90886543359454, 127.3359507646376, 110.95942084362032, 74.28272325660849, 11.41538447445029, 37.523131873407166, 25.496535031231716, 7.778158734735135, 118.57668388727163, 384.70100073674047, 20.866249369223926, 17.889779282597956, 162.41406306579125, 323.50375273130464, 245.46909241949245, 103.9001733947331, 342.30775539807263, 158.67022340238387, 163.2357821468912, 7.590156870687051, 45.6727542599375, 7.0589805011856015, 24.24151527850119, 25.53846345651587, 13.940012487216478, 339.35589150840514, 5.316780166608735, 85.17114874441484, 203.84400418544945, 333.67558408926556, 446.707973099299, 46.91104717887095, 4.24598864043963, 112.82404529227877, 218.34666520498703, 164.481871804163, 141.7153086282164, 345.77727350269475, 443.25924097059993, 273.19508062286525, 344.15739271085744, 144.5114737170146, 2.927832609598041, 240.94272166374762, 2.828465975706112, 192.79481385258933, 31.432325147503285, 21.73126786546962, 69.21130216711605, 79.04834235372738, 47.686264559796165, 428.9466511308231, 53.26240454109575, 203.2922310457876, 197.79639939020257, 349.6143356097579, 75.8148072033027, 275.54423929168604, 43.67130441014178, 73.02021583481856, 97.16649908621707, 105.48501164675703, 239.8784364215354, 398.9024322234234, 35.9409460186056, 51.31504245965191, 426.47355291165184, 335.36025720760364, 3.384488490352339, 183.39454589242985, 115.65850740880036, 74.94533566306349, 140.50413519362596, 149.31506475003388, 6.387452772362291, 226.62675663643125, 397.03380819778164, 16.51105003178201, 91.6648058100921, 91.40446745036043, 215.54448800579027, 40.718205975190074, 335.47366379892657, 14.2590041317517, 49.60001211094105, 79.48922876693459, 231.96146546627898, 71.42268980726028, 14.14830087826216, 56.656185310399565, 120.10072358368072, 135.6500288197077, 126.42792627984409]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.657771554757351, "mean_inference_ms": 21.218383922367902, "mean_action_processing_ms": 14.919946515222373, "mean_env_wait_ms": 5.107401327065818, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00647580623626709, "StateBufferConnector_ms": 0.008500933647155762, "ViewRequirementAgentConnector_ms": 0.10715985298156738}, "num_episodes": 18, "episode_return_max": 300.69999999999976, "episode_return_min": -83.25068943989784, "episode_return_mean": 74.22211207399927, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 5.196132254103322, "num_env_steps_trained_throughput_per_sec": 5.196132254103322, "timesteps_total": 24000, "num_env_steps_sampled_lifetime": 24000, "num_agent_steps_sampled_lifetime": 96000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 96000, "timers": {"training_iteration_time_ms": 613327.912, "restore_workers_time_ms": 0.033, "training_step_time_ms": 613327.803, "sample_time_ms": 26532.718, "learn_time_ms": 586782.39, "learn_throughput": 6.817, "synch_weights_time_ms": 10.754}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "done": false, "training_iteration": 6, "trial_id": "cf3bb_00000", "date": "2024-08-20_07-33-35", "timestamp": 1724119415, "time_this_iter_s": 769.8419761657715, "time_total_s": 3680.193278312683, "pid": 25777, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39f822040>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3680.193278312683, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 25.3078125, "ram_util_percent": 80.89531249999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.4165692304768575, "cur_kl_coeff": 0.05, "cur_lr": 0.00010000000000000003, "total_loss": 3.847823629177437, "policy_loss": -0.0071506810425066205, "vf_loss": 3.8541049335368727, "vf_explained_var": -0.00010214082147709276, "kl": 0.017387478013506884, "entropy": 1.5451368405705406, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 12285.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.7860219090427987, "cur_kl_coeff": 0.22500000000000006, "cur_lr": 0.00010000000000000003, "total_loss": 5.278225155986806, "policy_loss": -0.00528273714580647, "vf_loss": 5.281402146627032, "vf_explained_var": 0.007121771510946688, "kl": 0.009358962999280572, "entropy": 1.5332132400659026, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 12285.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000}, "env_runners": {"episode_reward_max": 242.9265260104854, "episode_reward_min": -83.25068943989784, "episode_reward_mean": 64.82654542258787, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -476.1200934514208, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 109.84687561474831, "predator_policy": 575.8061097677602}, "policy_reward_mean": {"prey_policy": -102.414676657033, "predator_policy": 134.82794936832695}, "custom_metrics": {}, "hist_stats": {"episode_reward": [86.10000000000012, 141.58496044494402, -36.210974324064644, 14.292493527718989, 36.90000000000017, 24.494992530274054, 35.863512135210314, 53.400000000000254, 28.600000000000136, 147.29999999999944, 22.150468854339962, 37.30000000000026, -26.8663411899469, 31.600000000000183, 53.500000000000234, 64.39802988091809, 177.29744769633302, 33.40000000000022, 23.089465796537688, 124.29999999999956, 57.20113319406714, 80.49999999999949, 84.2999999999993, 53.73479582582052, 64.00262784403016, 87.345778354645, -20.090536496721974, 157.29999999999933, 88.99315193335804, 17.42039841395536, 11.591430861249885, 57.71355151533831, 142.91782910245269, 82.82106606537204, 72.29999999999983, 31.740557081311927, 55.385830883371106, 88.69999999999892, 82.32746978457058, -9.94244322249786, -73.20112573267724, 11.951675587741232, 143.21457176583795, -82.08153336271486, 101.56280839708205, 105.89999999999905, 138.7999999999987, 149.09999999999894, 54.70000000000031, 79.47420818185596, 176.5021211954248, 79.79999999999929, 55.995824868789356, 242.9265260104854, 235.68470101431512, 16.99999999999998, 40.70000000000033, -83.25068943989784, 69.20000000000016, 98.79999999999896, 140.97545058587124, 37.89169703412222, 97.96063265044081, 84.37256097185853, -72.04390677690043, 96.12144086626763, 46.4313933713204, 90.39999999999927, -49.93016806767406, -61.889305463395544, 22.712148135953832, 96.02962072085124, 33.700000000000216, 37.073230708739, 38.000000000000284, 132.5220425391773, 53.40000000000026, 158.49784017111105, 88.29848533663981, 124.91089777199781, 93.80470884575833, 29.29630451237402, 73.55615411845504, 66.88909003485215, 25.700000000000088, 64.65641561644529, 86.79999999999939, 47.075829833296496, 169.73847638844526, 26.838196075628385, 39.78654402326649, 34.30000000000022, 7.223830423314672, 27.41420735026482, 23.05832429490372, 199.99335324593855, 35.70000000000024, 181.35326196064227, 106.19999999999929, 26.300000000000104], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-50.54975335994396, -110.69855182260218, -0.17461336800600522, 15.80447472239683, -254.51590206668706, -269.98928168518114, -158.66866616387338, -124.85096850122733, -125.69491643046112, -65.55585656765287, -21.24092017985742, -258.4725799215397, -5.067327868759232, -76.37329020525452, -41.13043781609296, -97.66883027267461, 9.415037296909608, -177.66948964802017, -77.30640109070622, 67.97682741339426, -34.88746165742568, -145.28959111602458, -49.773305763674934, -67.75178281845412, -178.4517568818257, -254.3323787780704, -57.988656658678416, -76.65684889586636, -13.441278778141555, -11.02044584352705, -143.40226470011453, -0.8468342103517374, 78.55641219851923, 38.904586252174276, -42.83407365670662, -139.69456046921903, -95.24347768415174, -237.3017568533912, 67.43215226517582, -277.70415019505003, -74.28193639199056, 9.341134522810583, -29.52547721036023, -157.37069347057223, -53.86827233477578, -18.643470249452054, 7.435363771062006, -204.0162120664745, -328.689964285151, -52.162207286626426, 39.73931675719238, -343.6990572926092, -360.77280235960563, -243.09764700592808, -73.37646231772972, 75.73279962588626, -25.658250028934876, -62.82787042937889, 8.447998198061786, -328.49110834621194, -149.83755838665226, -178.00659955260804, -112.63663177956926, -139.70922279229487, 23.1937269532793, -162.8134608986617, 23.779731960404476, -414.8775847774382, -40.329686068557, 29.000000000000163, -119.26959850187424, -33.53382435494794, -95.72476363090416, -87.18477709398441, 13.156455428744977, -10.1545631598036, 22.26892244313229, -2.961119563199681, -52.54057557714963, -83.7567102673561, -340.09666914583795, -138.67170669280415, -55.46492185477945, -112.88724490586947, -28.394765857936584, -397.36350752702225, -319.27498922555236, -209.01447292996696, -191.22809335714766, -29.11510379504579, 11.60984312931292, 41.02724574006264, 46.40378606892648, 61.095718151387054, 71.6615365434838, 37.959987512783734, -52.29473065556793, -237.67794101944608, -15.015041506749203, -194.52590324125893, -476.1200934514208, -127.76134254171913, -29.91104717887071, 58.554011359560555, -194.44918436406383, -80.72570126441407, 45.12914561176653, -108.39980003365915, -368.8145935312249, -184.53721992775428, -401.4250348802931, -198.92743845343009, -130.71147371701537, 23.97216739040206, -187.5890647303272, -139.4328123490244, -203.44612388238139, 48.41898488228902, 30.451134739824614, -22.59370477241005, 10.802141871674612, 3.4387018006741146, -224.10912325013888, -220.20823538765868, -314.4389872117105, 11.310989426161196, -358.6827104000705, 17.626128558872228, -160.36222302132728, -230.89722745740107, -18.02021583481849, -56.045058219949496, 0.5902203083197872, -299.52227500529204, -376.0187203243444, 31.575342082316546, -224.1800409931703, -303.53872244580646, -286.39983661288437, -114.23421454846755, -74.55443600453756, -201.78646916073995, 32.003325099249786, -151.4231752350875, -135.1150647500347, 13.112547227637673, -444.31392026314035, -142.27341386233414, -38.28129206022284, -31.894563781651087, -18.4443721283111, -155.98254078866216, 3.9817940248099446, -326.77366379892516, 32.39043669719561, 62.248387231223866, 21.26408943133584, -244.41629832791017, 9.132322853049498, 30.207584233427358, 4.722643979122724, -87.67484402744415, -177.60668136331202, -55.17496922386655, 18.06742247711357, -147.59657431887643, -114.00972709056538, -164.44332998269482, -123.38358357750049, -114.282841839622, 34.78890236449114, -46.75048775233776, 12.441685166123369, -71.19839159224749, 1.0293587719701105, -38.44895857418267, -39.851753043824864, -22.81432494399788, -79.45152520154484, 11.681748981512957, -19.704847942373398, -123.20033237039294, -10.306180976100029, -54.70633890892985, -58.075793399724894, -293.1461821165374, -264.63206142319245, -35.948429403718755, -214.62199907033835, -317.90225848689244, -455.6808958861297, -50.85749422156492, -183.49548905662368, -43.416954717761634, -4.37968885633221, 109.84687561474831, 90.37116223533064, -307.8124607181613, -211.83230433910924, -9.77689127839833], "policy_predator_policy_reward": [106.74975335994327, 140.59855182260154, 26.057004971444503, 99.89809411910949, 454.2209823645902, 34.07322706321371, 43.52190336303487, 254.2902248297835, 147.19491643046055, 80.95585656765206, 182.13459275063047, 122.07389988104084, 75.84837355407487, 41.4557566551482, 81.23043781609289, 110.96883027267391, 10.184962703090356, 186.66948964801983, 136.8079190000228, 19.821654677288823, 84.72095931810414, 117.60656230968559, 67.3733057636752, 87.45178281845327, 352.73244031233446, 53.1853541576135, 73.98865665867794, 92.2568488958655, 48.34127877814171, 29.620445843527225, 105.94249571456048, 102.70463307682338, 7.8085690002437484, 52.02788024539647, 60.53407365670687, 155.3945604692186, 346.65839784361606, 8.97630249046371, 46.36784773482404, 288.2041501950499, 8.18097998100373, 113.96095508224231, 99.02547721036031, 168.37069347057223, 121.16827233477578, 35.64347024945225, 179.50175675473793, 70.81388736649394, 345.38899280497907, 99.46580661082866, 74.02538730230853, 317.2801315877537, 7.9738031010510735, 575.8061097677602, 145.5843093501513, 9.359353341691216, 100.44983594205826, 77.02943644961421, 0.7885167394102703, 336.6749918226967, 195.3053144194981, 144.13027438101068, 266.73687017564924, 43.32253591155202, 99.6108819153417, 182.92668113249397, 7.729041434779866, 466.18987744762586, 83.62968606855719, 0.0, 19.635114504538983, 164.90886543359454, 127.3359507646376, 110.95942084362032, 74.28272325660849, 11.41538447445029, 37.523131873407166, 25.496535031231716, 7.778158734735135, 118.57668388727163, 384.70100073674047, 20.866249369223926, 17.889779282597956, 162.41406306579125, 323.50375273130464, 245.46909241949245, 103.9001733947331, 342.30775539807263, 158.67022340238387, 163.2357821468912, 7.590156870687051, 45.6727542599375, 7.0589805011856015, 24.24151527850119, 25.53846345651587, 13.940012487216478, 339.35589150840514, 5.316780166608735, 85.17114874441484, 203.84400418544945, 333.67558408926556, 446.707973099299, 46.91104717887095, 4.24598864043963, 112.82404529227877, 218.34666520498703, 164.481871804163, 141.7153086282164, 345.77727350269475, 443.25924097059993, 273.19508062286525, 344.15739271085744, 144.5114737170146, 2.927832609598041, 240.94272166374762, 2.828465975706112, 192.79481385258933, 31.432325147503285, 21.73126786546962, 69.21130216711605, 79.04834235372738, 47.686264559796165, 428.9466511308231, 53.26240454109575, 203.2922310457876, 197.79639939020257, 349.6143356097579, 75.8148072033027, 275.54423929168604, 43.67130441014178, 73.02021583481856, 97.16649908621707, 105.48501164675703, 239.8784364215354, 398.9024322234234, 35.9409460186056, 51.31504245965191, 426.47355291165184, 335.36025720760364, 3.384488490352339, 183.39454589242985, 115.65850740880036, 74.94533566306349, 140.50413519362596, 149.31506475003388, 6.387452772362291, 226.62675663643125, 397.03380819778164, 16.51105003178201, 91.6648058100921, 91.40446745036043, 215.54448800579027, 40.718205975190074, 335.47366379892657, 14.2590041317517, 49.60001211094105, 79.48922876693459, 231.96146546627898, 71.42268980726028, 14.14830087826216, 56.656185310399565, 120.10072358368072, 135.6500288197077, 126.42792627984409, 190.21195616051216, 12.873349799706002, 288.2005798719873, 57.14156723612408, 44.87054189360246, 218.4958835235194, 2.055466087716081, 74.56253491657588, 22.048105191580184, 123.50860123454353, 20.02115191176238, 64.4742777237465, 142.2629272768319, 90.14162709943714, 1.0564470941152877, 93.55152520154414, 24.067383540318264, 158.62434079571355, 93.88736315060045, 5.4251567344297005, 41.82763923150253, 316.6181667080749, 281.7414385353903, 46.253259641788325, 275.9137909249814, 279.66879092715254, 258.01594279381675, 448.5158005598164, 154.30150737227336, 108.31093640211137, 33.93754430563897, 41.94853089658793, 9.728837764668778, 313.91246071816164, 220.43230433910898, 27.476891278398384]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.596314757671171, "mean_inference_ms": 25.019043646024116, "mean_action_processing_ms": 17.828214792752966, "mean_env_wait_ms": 6.070425245539485, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005753040313720703, "StateBufferConnector_ms": 0.008246421813964844, "ViewRequirementAgentConnector_ms": 0.10086846351623535}, "num_episodes": 18, "episode_return_max": 242.9265260104854, "episode_return_min": -83.25068943989784, "episode_return_mean": 64.82654542258787, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 88.35000276363381, "num_env_steps_trained_throughput_per_sec": 88.35000276363381, "timesteps_total": 28000, "num_env_steps_sampled_lifetime": 28000, "num_agent_steps_sampled_lifetime": 112000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 112000, "timers": {"training_iteration_time_ms": 532177.422, "restore_workers_time_ms": 0.03, "training_step_time_ms": 532177.324, "sample_time_ms": 22892.228, "learn_time_ms": 509272.658, "learn_throughput": 7.854, "synch_weights_time_ms": 10.654}, "counters": {"num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000}, "done": false, "training_iteration": 7, "trial_id": "cf3bb_00000", "date": "2024-08-20_07-34-20", "timestamp": 1724119460, "time_this_iter_s": 45.27789092063904, "time_total_s": 3725.471169233322, "pid": 25777, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39f82a550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3725.471169233322, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 19.238709677419354, "ram_util_percent": 78.67903225806452}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.3150564997737843, "cur_kl_coeff": 0.05, "cur_lr": 0.00010000000000000003, "total_loss": 3.730034088709998, "policy_loss": -0.0040373311010953135, "vf_loss": 3.7336038393949074, "vf_explained_var": 0.0003783390635535831, "kl": 0.00935185483018703, "entropy": 1.5714811725591225, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 14175.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.074135112084409, "cur_kl_coeff": 0.22500000000000006, "cur_lr": 0.00010000000000000003, "total_loss": 3.768460173581643, "policy_loss": -0.004208483309583571, "vf_loss": 3.7707628922487695, "vf_explained_var": -0.0011407337806842944, "kl": 0.008470056998896042, "entropy": 1.5320200966779518, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 14175.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000}, "env_runners": {"episode_reward_max": 242.9265260104854, "episode_reward_min": -83.25068943989784, "episode_reward_mean": 69.92787498910063, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -476.1200934514208, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 109.84687561474831, "predator_policy": 575.8061097677602}, "policy_reward_mean": {"prey_policy": -97.48096894132225, "predator_policy": 132.4449064358726}, "custom_metrics": {}, "hist_stats": {"episode_reward": [23.089465796537688, 124.29999999999956, 57.20113319406714, 80.49999999999949, 84.2999999999993, 53.73479582582052, 64.00262784403016, 87.345778354645, -20.090536496721974, 157.29999999999933, 88.99315193335804, 17.42039841395536, 11.591430861249885, 57.71355151533831, 142.91782910245269, 82.82106606537204, 72.29999999999983, 31.740557081311927, 55.385830883371106, 88.69999999999892, 82.32746978457058, -9.94244322249786, -73.20112573267724, 11.951675587741232, 143.21457176583795, -82.08153336271486, 101.56280839708205, 105.89999999999905, 138.7999999999987, 149.09999999999894, 54.70000000000031, 79.47420818185596, 176.5021211954248, 79.79999999999929, 55.995824868789356, 242.9265260104854, 235.68470101431512, 16.99999999999998, 40.70000000000033, -83.25068943989784, 69.20000000000016, 98.79999999999896, 140.97545058587124, 37.89169703412222, 97.96063265044081, 84.37256097185853, -72.04390677690043, 96.12144086626763, 46.4313933713204, 90.39999999999927, -49.93016806767406, -61.889305463395544, 22.712148135953832, 96.02962072085124, 33.700000000000216, 37.073230708739, 38.000000000000284, 132.5220425391773, 53.40000000000026, 158.49784017111105, 88.29848533663981, 124.91089777199781, 93.80470884575833, 29.29630451237402, 73.55615411845504, 66.88909003485215, 25.700000000000088, 64.65641561644529, 86.79999999999939, 47.075829833296496, 169.73847638844526, 26.838196075628385, 39.78654402326649, 34.30000000000022, 7.223830423314672, 27.41420735026482, 23.05832429490372, 199.99335324593855, 35.70000000000024, 181.35326196064227, 106.19999999999929, 26.300000000000104, 108.99999999999875, 25.7000000000001, 44.2000000000003, 78.64598626039786, 58.60000000000046, 38.10000000000027, 84.22326389779394, 149.8999999999985, 140.85197767829717, 39.7000000000003, 62.200000000000486, 31.222744514308634, 74.08071211393138, 81.86486688193689, 78.29999999999939, 78.60145483091658, 208.84654002942085, 51.20000000000047], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-95.24347768415174, -237.3017568533912, 67.43215226517582, -277.70415019505003, -74.28193639199056, 9.341134522810583, -29.52547721036023, -157.37069347057223, -53.86827233477578, -18.643470249452054, 7.435363771062006, -204.0162120664745, -328.689964285151, -52.162207286626426, 39.73931675719238, -343.6990572926092, -360.77280235960563, -243.09764700592808, -73.37646231772972, 75.73279962588626, -25.658250028934876, -62.82787042937889, 8.447998198061786, -328.49110834621194, -149.83755838665226, -178.00659955260804, -112.63663177956926, -139.70922279229487, 23.1937269532793, -162.8134608986617, 23.779731960404476, -414.8775847774382, -40.329686068557, 29.000000000000163, -119.26959850187424, -33.53382435494794, -95.72476363090416, -87.18477709398441, 13.156455428744977, -10.1545631598036, 22.26892244313229, -2.961119563199681, -52.54057557714963, -83.7567102673561, -340.09666914583795, -138.67170669280415, -55.46492185477945, -112.88724490586947, -28.394765857936584, -397.36350752702225, -319.27498922555236, -209.01447292996696, -191.22809335714766, -29.11510379504579, 11.60984312931292, 41.02724574006264, 46.40378606892648, 61.095718151387054, 71.6615365434838, 37.959987512783734, -52.29473065556793, -237.67794101944608, -15.015041506749203, -194.52590324125893, -476.1200934514208, -127.76134254171913, -29.91104717887071, 58.554011359560555, -194.44918436406383, -80.72570126441407, 45.12914561176653, -108.39980003365915, -368.8145935312249, -184.53721992775428, -401.4250348802931, -198.92743845343009, -130.71147371701537, 23.97216739040206, -187.5890647303272, -139.4328123490244, -203.44612388238139, 48.41898488228902, 30.451134739824614, -22.59370477241005, 10.802141871674612, 3.4387018006741146, -224.10912325013888, -220.20823538765868, -314.4389872117105, 11.310989426161196, -358.6827104000705, 17.626128558872228, -160.36222302132728, -230.89722745740107, -18.02021583481849, -56.045058219949496, 0.5902203083197872, -299.52227500529204, -376.0187203243444, 31.575342082316546, -224.1800409931703, -303.53872244580646, -286.39983661288437, -114.23421454846755, -74.55443600453756, -201.78646916073995, 32.003325099249786, -151.4231752350875, -135.1150647500347, 13.112547227637673, -444.31392026314035, -142.27341386233414, -38.28129206022284, -31.894563781651087, -18.4443721283111, -155.98254078866216, 3.9817940248099446, -326.77366379892516, 32.39043669719561, 62.248387231223866, 21.26408943133584, -244.41629832791017, 9.132322853049498, 30.207584233427358, 4.722643979122724, -87.67484402744415, -177.60668136331202, -55.17496922386655, 18.06742247711357, -147.59657431887643, -114.00972709056538, -164.44332998269482, -123.38358357750049, -114.282841839622, 34.78890236449114, -46.75048775233776, 12.441685166123369, -71.19839159224749, 1.0293587719701105, -38.44895857418267, -39.851753043824864, -22.81432494399788, -79.45152520154484, 11.681748981512957, -19.704847942373398, -123.20033237039294, -10.306180976100029, -54.70633890892985, -58.075793399724894, -293.1461821165374, -264.63206142319245, -35.948429403718755, -214.62199907033835, -317.90225848689244, -455.6808958861297, -50.85749422156492, -183.49548905662368, -43.416954717761634, -4.37968885633221, 109.84687561474831, 90.37116223533064, -307.8124607181613, -211.83230433910924, -9.77689127839833, 86.04921832749022, -98.75739475182026, -187.56605806563203, -158.09728217053484, 17.01842288315995, 5.351206078365166, 29.000000000000163, -343.5128640271111, 29.90000000000018, 13.305186344853356, 18.04703711682701, -4.667320309208293, 21.01548561634953, 17.103621585903998, 52.222108427314254, 89.10689370741846, -339.1550175591131, 73.40816317548303, 10.637855233742792, -50.60533615923536, 26.30000000000012, 23.55492038754999, -135.41119431080207, -131.36704611984968, -453.6316617978543, 49.94044294195392, -159.51292351466026, 38.47231956271964, -67.6519791601904, 58.93626842503101, -374.3081342128868, -196.25299133189338, 69.85700732647709, 31.705956800648877, -1.756167340265271, 6.721110718697105], "policy_predator_policy_reward": [346.65839784361606, 8.97630249046371, 46.36784773482404, 288.2041501950499, 8.18097998100373, 113.96095508224231, 99.02547721036031, 168.37069347057223, 121.16827233477578, 35.64347024945225, 179.50175675473793, 70.81388736649394, 345.38899280497907, 99.46580661082866, 74.02538730230853, 317.2801315877537, 7.9738031010510735, 575.8061097677602, 145.5843093501513, 9.359353341691216, 100.44983594205826, 77.02943644961421, 0.7885167394102703, 336.6749918226967, 195.3053144194981, 144.13027438101068, 266.73687017564924, 43.32253591155202, 99.6108819153417, 182.92668113249397, 7.729041434779866, 466.18987744762586, 83.62968606855719, 0.0, 19.635114504538983, 164.90886543359454, 127.3359507646376, 110.95942084362032, 74.28272325660849, 11.41538447445029, 37.523131873407166, 25.496535031231716, 7.778158734735135, 118.57668388727163, 384.70100073674047, 20.866249369223926, 17.889779282597956, 162.41406306579125, 323.50375273130464, 245.46909241949245, 103.9001733947331, 342.30775539807263, 158.67022340238387, 163.2357821468912, 7.590156870687051, 45.6727542599375, 7.0589805011856015, 24.24151527850119, 25.53846345651587, 13.940012487216478, 339.35589150840514, 5.316780166608735, 85.17114874441484, 203.84400418544945, 333.67558408926556, 446.707973099299, 46.91104717887095, 4.24598864043963, 112.82404529227877, 218.34666520498703, 164.481871804163, 141.7153086282164, 345.77727350269475, 443.25924097059993, 273.19508062286525, 344.15739271085744, 144.5114737170146, 2.927832609598041, 240.94272166374762, 2.828465975706112, 192.79481385258933, 31.432325147503285, 21.73126786546962, 69.21130216711605, 79.04834235372738, 47.686264559796165, 428.9466511308231, 53.26240454109575, 203.2922310457876, 197.79639939020257, 349.6143356097579, 75.8148072033027, 275.54423929168604, 43.67130441014178, 73.02021583481856, 97.16649908621707, 105.48501164675703, 239.8784364215354, 398.9024322234234, 35.9409460186056, 51.31504245965191, 426.47355291165184, 335.36025720760364, 3.384488490352339, 183.39454589242985, 115.65850740880036, 74.94533566306349, 140.50413519362596, 149.31506475003388, 6.387452772362291, 226.62675663643125, 397.03380819778164, 16.51105003178201, 91.6648058100921, 91.40446745036043, 215.54448800579027, 40.718205975190074, 335.47366379892657, 14.2590041317517, 49.60001211094105, 79.48922876693459, 231.96146546627898, 71.42268980726028, 14.14830087826216, 56.656185310399565, 120.10072358368072, 135.6500288197077, 126.42792627984409, 190.21195616051216, 12.873349799706002, 288.2005798719873, 57.14156723612408, 44.87054189360246, 218.4958835235194, 2.055466087716081, 74.56253491657588, 22.048105191580184, 123.50860123454353, 20.02115191176238, 64.4742777237465, 142.2629272768319, 90.14162709943714, 1.0564470941152877, 93.55152520154414, 24.067383540318264, 158.62434079571355, 93.88736315060045, 5.4251567344297005, 41.82763923150253, 316.6181667080749, 281.7414385353903, 46.253259641788325, 275.9137909249814, 279.66879092715254, 258.01594279381675, 448.5158005598164, 154.30150737227336, 108.31093640211137, 33.93754430563897, 41.94853089658793, 9.728837764668778, 313.91246071816164, 220.43230433910898, 27.476891278398384, 8.85078167250917, 112.85739475181946, 124.75673897561482, 246.6066012605509, 13.983777521437727, 7.846593517037137, 55.872749631925586, 337.28610065558576, 0.0, 15.39481365514661, 1.7529628831729807, 22.96732030920835, 24.413012989528166, 21.691143706013303, 6.777891572685961, 1.7931062925808663, 262.40981813370496, 144.18901392822468, 8.56214476625719, 71.1053361592355, 0.0, 12.345079612450249, 263.31135202005913, 34.689632924899556, 447.21378165947834, 30.558149310354228, 165.02347705947676, 37.88199377440112, 83.95197916018947, 3.0637315749691743, 249.23239028590524, 399.9301900897925, 26.95512811643204, 80.32844778586359, 33.85616734026525, 12.378889281302861]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.42343738903606, "mean_inference_ms": 28.35944135216076, "mean_action_processing_ms": 20.375120135701337, "mean_env_wait_ms": 6.914814453113995, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004975795745849609, "StateBufferConnector_ms": 0.00815892219543457, "ViewRequirementAgentConnector_ms": 0.09652793407440186}, "num_episodes": 18, "episode_return_max": 242.9265260104854, "episode_return_min": -83.25068943989784, "episode_return_mean": 69.92787498910063, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 78.7822036894813, "num_env_steps_trained_throughput_per_sec": 78.7822036894813, "timesteps_total": 32000, "num_env_steps_sampled_lifetime": 32000, "num_agent_steps_sampled_lifetime": 128000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 128000, "timers": {"training_iteration_time_ms": 472001.856, "restore_workers_time_ms": 0.028, "training_step_time_ms": 472001.761, "sample_time_ms": 20152.217, "learn_time_ms": 451837.134, "learn_throughput": 8.853, "synch_weights_time_ms": 10.705}, "counters": {"num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000}, "done": false, "training_iteration": 8, "trial_id": "cf3bb_00000", "date": "2024-08-20_07-35-11", "timestamp": 1724119511, "time_this_iter_s": 50.78471398353577, "time_total_s": 3776.255883216858, "pid": 25777, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39f81ab80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3776.255883216858, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 19.56031746031746, "ram_util_percent": 78.56507936507936}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.40346381188463915, "cur_kl_coeff": 0.05, "cur_lr": 0.00010000000000000003, "total_loss": 5.3274867267204975, "policy_loss": -0.007263781492125302, "vf_loss": 5.3339844248282215, "vf_explained_var": 3.458712466810115e-05, "kl": 0.015321496143037239, "entropy": 1.5243062844982853, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 16065.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.5101217265206355, "cur_kl_coeff": 0.22500000000000006, "cur_lr": 0.00010000000000000003, "total_loss": 7.056845811813597, "policy_loss": -0.0047609337094294095, "vf_loss": 7.059613828810434, "vf_explained_var": 0.0005580548886899595, "kl": 0.008857515997355967, "entropy": 1.539278882142728, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 16065.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "env_runners": {"episode_reward_max": 242.9265260104854, "episode_reward_min": -190.89929807008323, "episode_reward_mean": 65.68125760460994, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -656.9151406930548, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 115.33485620674496, "predator_policy": 770.9141181036337}, "policy_reward_mean": {"prey_policy": -105.10560671636289, "predator_policy": 137.94623551866795}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-73.20112573267724, 11.951675587741232, 143.21457176583795, -82.08153336271486, 101.56280839708205, 105.89999999999905, 138.7999999999987, 149.09999999999894, 54.70000000000031, 79.47420818185596, 176.5021211954248, 79.79999999999929, 55.995824868789356, 242.9265260104854, 235.68470101431512, 16.99999999999998, 40.70000000000033, -83.25068943989784, 69.20000000000016, 98.79999999999896, 140.97545058587124, 37.89169703412222, 97.96063265044081, 84.37256097185853, -72.04390677690043, 96.12144086626763, 46.4313933713204, 90.39999999999927, -49.93016806767406, -61.889305463395544, 22.712148135953832, 96.02962072085124, 33.700000000000216, 37.073230708739, 38.000000000000284, 132.5220425391773, 53.40000000000026, 158.49784017111105, 88.29848533663981, 124.91089777199781, 93.80470884575833, 29.29630451237402, 73.55615411845504, 66.88909003485215, 25.700000000000088, 64.65641561644529, 86.79999999999939, 47.075829833296496, 169.73847638844526, 26.838196075628385, 39.78654402326649, 34.30000000000022, 7.223830423314672, 27.41420735026482, 23.05832429490372, 199.99335324593855, 35.70000000000024, 181.35326196064227, 106.19999999999929, 26.300000000000104, 108.99999999999875, 25.7000000000001, 44.2000000000003, 78.64598626039786, 58.60000000000046, 38.10000000000027, 84.22326389779394, 149.8999999999985, 140.85197767829717, 39.7000000000003, 62.200000000000486, 31.222744514308634, 74.08071211393138, 81.86486688193689, 78.29999999999939, 78.60145483091658, 208.84654002942085, 51.20000000000047, 17.100004700808046, -122.28110813651674, 29.14950039995243, 106.59999999999857, 15.546436367388011, 77.01803398874942, 124.84380067837193, 52.000000000000405, 58.477369214725314, 38.1126781251819, 27.457977082970206, 27.81641047172962, 207.84564511684587, 9.66422869202568, 96.69999999999905, 40.127673001526915, 113.9999999999988, 69.30000000000001, 96.79999999999868, -190.89929807008323, 155.79999999999885, -42.18898314588123], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-340.09666914583795, -138.67170669280415, -55.46492185477945, -112.88724490586947, -28.394765857936584, -397.36350752702225, -319.27498922555236, -209.01447292996696, -191.22809335714766, -29.11510379504579, 11.60984312931292, 41.02724574006264, 46.40378606892648, 61.095718151387054, 71.6615365434838, 37.959987512783734, -52.29473065556793, -237.67794101944608, -15.015041506749203, -194.52590324125893, -476.1200934514208, -127.76134254171913, -29.91104717887071, 58.554011359560555, -194.44918436406383, -80.72570126441407, 45.12914561176653, -108.39980003365915, -368.8145935312249, -184.53721992775428, -401.4250348802931, -198.92743845343009, -130.71147371701537, 23.97216739040206, -187.5890647303272, -139.4328123490244, -203.44612388238139, 48.41898488228902, 30.451134739824614, -22.59370477241005, 10.802141871674612, 3.4387018006741146, -224.10912325013888, -220.20823538765868, -314.4389872117105, 11.310989426161196, -358.6827104000705, 17.626128558872228, -160.36222302132728, -230.89722745740107, -18.02021583481849, -56.045058219949496, 0.5902203083197872, -299.52227500529204, -376.0187203243444, 31.575342082316546, -224.1800409931703, -303.53872244580646, -286.39983661288437, -114.23421454846755, -74.55443600453756, -201.78646916073995, 32.003325099249786, -151.4231752350875, -135.1150647500347, 13.112547227637673, -444.31392026314035, -142.27341386233414, -38.28129206022284, -31.894563781651087, -18.4443721283111, -155.98254078866216, 3.9817940248099446, -326.77366379892516, 32.39043669719561, 62.248387231223866, 21.26408943133584, -244.41629832791017, 9.132322853049498, 30.207584233427358, 4.722643979122724, -87.67484402744415, -177.60668136331202, -55.17496922386655, 18.06742247711357, -147.59657431887643, -114.00972709056538, -164.44332998269482, -123.38358357750049, -114.282841839622, 34.78890236449114, -46.75048775233776, 12.441685166123369, -71.19839159224749, 1.0293587719701105, -38.44895857418267, -39.851753043824864, -22.81432494399788, -79.45152520154484, 11.681748981512957, -19.704847942373398, -123.20033237039294, -10.306180976100029, -54.70633890892985, -58.075793399724894, -293.1461821165374, -264.63206142319245, -35.948429403718755, -214.62199907033835, -317.90225848689244, -455.6808958861297, -50.85749422156492, -183.49548905662368, -43.416954717761634, -4.37968885633221, 109.84687561474831, 90.37116223533064, -307.8124607181613, -211.83230433910924, -9.77689127839833, 86.04921832749022, -98.75739475182026, -187.56605806563203, -158.09728217053484, 17.01842288315995, 5.351206078365166, 29.000000000000163, -343.5128640271111, 29.90000000000018, 13.305186344853356, 18.04703711682701, -4.667320309208293, 21.01548561634953, 17.103621585903998, 52.222108427314254, 89.10689370741846, -339.1550175591131, 73.40816317548303, 10.637855233742792, -50.60533615923536, 26.30000000000012, 23.55492038754999, -135.41119431080207, -131.36704611984968, -453.6316617978543, 49.94044294195392, -159.51292351466026, 38.47231956271964, -67.6519791601904, 58.93626842503101, -374.3081342128868, -196.25299133189338, 69.85700732647709, 31.705956800648877, -1.756167340265271, 6.721110718697105, -56.226652456611475, -206.39811163338672, -272.43595216144837, -656.9151406930548, -124.16293650967995, -238.50597515235035, 8.272927066936846, 17.95944622443022, -288.2647289153146, -168.23522864301356, 28.001163743644327, -153.39928656434506, -190.4377773233562, -11.034966851531951, -47.38829907596617, 18.794342451883253, 25.38531284417971, -173.17572012608645, -396.3719368316678, -1.9119600807363066, -136.77878514334492, -42.20979263977908, -233.3057877714183, -174.86145899507136, 19.946915147509536, -281.2177159303682, -55.25414417188123, -376.98056459828626, -104.47915521957559, -61.669860694839684, -139.62266195376748, -35.73478227579376, 60.60398679043475, 1.3821651558029828, 14.590182021564472, -64.67117372716545, -39.94627717449412, 48.80000000000022, -401.9766049205895, -336.7292758930842, 115.33485620674496, 27.665641445547518, -283.584892133999, -488.3167781324467], "policy_predator_policy_reward": [384.70100073674047, 20.866249369223926, 17.889779282597956, 162.41406306579125, 323.50375273130464, 245.46909241949245, 103.9001733947331, 342.30775539807263, 158.67022340238387, 163.2357821468912, 7.590156870687051, 45.6727542599375, 7.0589805011856015, 24.24151527850119, 25.53846345651587, 13.940012487216478, 339.35589150840514, 5.316780166608735, 85.17114874441484, 203.84400418544945, 333.67558408926556, 446.707973099299, 46.91104717887095, 4.24598864043963, 112.82404529227877, 218.34666520498703, 164.481871804163, 141.7153086282164, 345.77727350269475, 443.25924097059993, 273.19508062286525, 344.15739271085744, 144.5114737170146, 2.927832609598041, 240.94272166374762, 2.828465975706112, 192.79481385258933, 31.432325147503285, 21.73126786546962, 69.21130216711605, 79.04834235372738, 47.686264559796165, 428.9466511308231, 53.26240454109575, 203.2922310457876, 197.79639939020257, 349.6143356097579, 75.8148072033027, 275.54423929168604, 43.67130441014178, 73.02021583481856, 97.16649908621707, 105.48501164675703, 239.8784364215354, 398.9024322234234, 35.9409460186056, 51.31504245965191, 426.47355291165184, 335.36025720760364, 3.384488490352339, 183.39454589242985, 115.65850740880036, 74.94533566306349, 140.50413519362596, 149.31506475003388, 6.387452772362291, 226.62675663643125, 397.03380819778164, 16.51105003178201, 91.6648058100921, 91.40446745036043, 215.54448800579027, 40.718205975190074, 335.47366379892657, 14.2590041317517, 49.60001211094105, 79.48922876693459, 231.96146546627898, 71.42268980726028, 14.14830087826216, 56.656185310399565, 120.10072358368072, 135.6500288197077, 126.42792627984409, 190.21195616051216, 12.873349799706002, 288.2005798719873, 57.14156723612408, 44.87054189360246, 218.4958835235194, 2.055466087716081, 74.56253491657588, 22.048105191580184, 123.50860123454353, 20.02115191176238, 64.4742777237465, 142.2629272768319, 90.14162709943714, 1.0564470941152877, 93.55152520154414, 24.067383540318264, 158.62434079571355, 93.88736315060045, 5.4251567344297005, 41.82763923150253, 316.6181667080749, 281.7414385353903, 46.253259641788325, 275.9137909249814, 279.66879092715254, 258.01594279381675, 448.5158005598164, 154.30150737227336, 108.31093640211137, 33.93754430563897, 41.94853089658793, 9.728837764668778, 313.91246071816164, 220.43230433910898, 27.476891278398384, 8.85078167250917, 112.85739475181946, 124.75673897561482, 246.6066012605509, 13.983777521437727, 7.846593517037137, 55.872749631925586, 337.28610065558576, 0.0, 15.39481365514661, 1.7529628831729807, 22.96732030920835, 24.413012989528166, 21.691143706013303, 6.777891572685961, 1.7931062925808663, 262.40981813370496, 144.18901392822468, 8.56214476625719, 71.1053361592355, 0.0, 12.345079612450249, 263.31135202005913, 34.689632924899556, 447.21378165947834, 30.558149310354228, 165.02347705947676, 37.88199377440112, 83.95197916018947, 3.0637315749691743, 249.23239028590524, 399.9301900897925, 26.95512811643204, 80.32844778586359, 33.85616734026525, 12.378889281302861, 35.284563175832325, 244.44020561497356, 36.15586661435263, 770.9141181036337, 142.7781753555781, 249.04023670640294, 27.08310603069196, 53.28452067794091, 331.0113790839849, 141.03501484173125, 2.118033988749895, 200.29812282070023, 208.2737552737795, 118.04278957948101, 79.48829907596638, 1.1056575481167445, 112.08152257667463, 94.1862539199572, 174.25512454769742, 262.1414504898886, 110.37952080559616, 96.06703406049735, 78.94136893985969, 357.0422882983589, 226.69577949452696, 242.42066640517996, 12.54477655812721, 429.35416090406534, 8.830866096267853, 254.0181498181463, 215.4851172310873, 0.0, 14.785316421833167, 37.22853163192935, 39.5098179784355, 79.8711737271646, 87.94627717449427, 0.0, 455.5909080068479, 92.21567473674209, 10.765143793254634, 2.0343585544526226, 186.8088161739373, 542.9038709466282]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.449318464845052, "mean_inference_ms": 23.616046218315866, "mean_action_processing_ms": 17.909923822187668, "mean_env_wait_ms": 5.961129161398787, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004190802574157715, "StateBufferConnector_ms": 0.0031145811080932617, "ViewRequirementAgentConnector_ms": 0.09222638607025146}, "num_episodes": 22, "episode_return_max": 242.9265260104854, "episode_return_min": -190.89929807008323, "episode_return_mean": 65.68125760460994, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 3.867327878569823, "num_env_steps_trained_throughput_per_sec": 3.867327878569823, "timesteps_total": 36000, "num_env_steps_sampled_lifetime": 36000, "num_agent_steps_sampled_lifetime": 144000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 144000, "timers": {"training_iteration_time_ms": 534480.083, "restore_workers_time_ms": 0.026, "training_step_time_ms": 534479.993, "sample_time_ms": 18024.331, "learn_time_ms": 516443.161, "learn_throughput": 7.745, "synch_weights_time_ms": 10.74}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "done": false, "training_iteration": 9, "trial_id": "cf3bb_00000", "date": "2024-08-20_07-52-25", "timestamp": 1724120545, "time_this_iter_s": 1034.3407390117645, "time_total_s": 4810.596622228622, "pid": 25777, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39fcc3310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4810.596622228622, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 24.0921875, "ram_util_percent": 79.3765625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.419699592060513, "cur_kl_coeff": 0.05, "cur_lr": 0.00010000000000000003, "total_loss": 9.515171093915505, "policy_loss": -0.00398152052023246, "vf_loss": 9.5185390235255, "vf_explained_var": 1.489743984565533e-05, "kl": 0.01227155988776573, "entropy": 1.4397712318985552, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 17955.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.074095889752504, "cur_kl_coeff": 0.22500000000000006, "cur_lr": 0.00010000000000000003, "total_loss": 8.424591249385209, "policy_loss": -0.00872894311323762, "vf_loss": 8.430322432391858, "vf_explained_var": 0.0016083392516645805, "kl": 0.01332330036875544, "entropy": 1.5684341436340696, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 17955.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000}, "env_runners": {"episode_reward_max": 371.84353232809207, "episode_reward_min": -242.21513617986275, "episode_reward_mean": 74.19850235242616, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -788.0758140183152, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 115.33485620674496, "predator_policy": 857.8151182372487}, "policy_reward_mean": {"prey_policy": -157.657818911586, "predator_policy": 194.75707008779915}, "custom_metrics": {}, "hist_stats": {"episode_reward": [84.37256097185853, -72.04390677690043, 96.12144086626763, 46.4313933713204, 90.39999999999927, -49.93016806767406, -61.889305463395544, 22.712148135953832, 96.02962072085124, 33.700000000000216, 37.073230708739, 38.000000000000284, 132.5220425391773, 53.40000000000026, 158.49784017111105, 88.29848533663981, 124.91089777199781, 93.80470884575833, 29.29630451237402, 73.55615411845504, 66.88909003485215, 25.700000000000088, 64.65641561644529, 86.79999999999939, 47.075829833296496, 169.73847638844526, 26.838196075628385, 39.78654402326649, 34.30000000000022, 7.223830423314672, 27.41420735026482, 23.05832429490372, 199.99335324593855, 35.70000000000024, 181.35326196064227, 106.19999999999929, 26.300000000000104, 108.99999999999875, 25.7000000000001, 44.2000000000003, 78.64598626039786, 58.60000000000046, 38.10000000000027, 84.22326389779394, 149.8999999999985, 140.85197767829717, 39.7000000000003, 62.200000000000486, 31.222744514308634, 74.08071211393138, 81.86486688193689, 78.29999999999939, 78.60145483091658, 208.84654002942085, 51.20000000000047, 17.100004700808046, -122.28110813651674, 29.14950039995243, 106.59999999999857, 15.546436367388011, 77.01803398874942, 124.84380067837193, 52.000000000000405, 58.477369214725314, 38.1126781251819, 27.457977082970206, 27.81641047172962, 207.84564511684587, 9.66422869202568, 96.69999999999905, 40.127673001526915, 113.9999999999988, 69.30000000000001, 96.79999999999868, -190.89929807008323, 155.79999999999885, -42.18898314588123, 284.17044782277264, 371.84353232809207, 134.52760288294076, 216.22310283266927, 217.21477697414798, 98.86311080900192, 228.19949102626066, -167.60684860037188, -242.21513617986275, 111.98236257474622, 281.0751427225938, -12.115704015205287, 146.4764939722132, 280.11359447383205, 38.39517100530977, -28.354409438326122, 246.0415527033925, -3.4710957785764798, 71.37934884362485, 50.577362475828345, -11.338408171047762, 273.5847250862211, 105.76512718803642], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-358.6827104000705, 17.626128558872228, -160.36222302132728, -230.89722745740107, -18.02021583481849, -56.045058219949496, 0.5902203083197872, -299.52227500529204, -376.0187203243444, 31.575342082316546, -224.1800409931703, -303.53872244580646, -286.39983661288437, -114.23421454846755, -74.55443600453756, -201.78646916073995, 32.003325099249786, -151.4231752350875, -135.1150647500347, 13.112547227637673, -444.31392026314035, -142.27341386233414, -38.28129206022284, -31.894563781651087, -18.4443721283111, -155.98254078866216, 3.9817940248099446, -326.77366379892516, 32.39043669719561, 62.248387231223866, 21.26408943133584, -244.41629832791017, 9.132322853049498, 30.207584233427358, 4.722643979122724, -87.67484402744415, -177.60668136331202, -55.17496922386655, 18.06742247711357, -147.59657431887643, -114.00972709056538, -164.44332998269482, -123.38358357750049, -114.282841839622, 34.78890236449114, -46.75048775233776, 12.441685166123369, -71.19839159224749, 1.0293587719701105, -38.44895857418267, -39.851753043824864, -22.81432494399788, -79.45152520154484, 11.681748981512957, -19.704847942373398, -123.20033237039294, -10.306180976100029, -54.70633890892985, -58.075793399724894, -293.1461821165374, -264.63206142319245, -35.948429403718755, -214.62199907033835, -317.90225848689244, -455.6808958861297, -50.85749422156492, -183.49548905662368, -43.416954717761634, -4.37968885633221, 109.84687561474831, 90.37116223533064, -307.8124607181613, -211.83230433910924, -9.77689127839833, 86.04921832749022, -98.75739475182026, -187.56605806563203, -158.09728217053484, 17.01842288315995, 5.351206078365166, 29.000000000000163, -343.5128640271111, 29.90000000000018, 13.305186344853356, 18.04703711682701, -4.667320309208293, 21.01548561634953, 17.103621585903998, 52.222108427314254, 89.10689370741846, -339.1550175591131, 73.40816317548303, 10.637855233742792, -50.60533615923536, 26.30000000000012, 23.55492038754999, -135.41119431080207, -131.36704611984968, -453.6316617978543, 49.94044294195392, -159.51292351466026, 38.47231956271964, -67.6519791601904, 58.93626842503101, -374.3081342128868, -196.25299133189338, 69.85700732647709, 31.705956800648877, -1.756167340265271, 6.721110718697105, -56.226652456611475, -206.39811163338672, -272.43595216144837, -656.9151406930548, -124.16293650967995, -238.50597515235035, 8.272927066936846, 17.95944622443022, -288.2647289153146, -168.23522864301356, 28.001163743644327, -153.39928656434506, -190.4377773233562, -11.034966851531951, -47.38829907596617, 18.794342451883253, 25.38531284417971, -173.17572012608645, -396.3719368316678, -1.9119600807363066, -136.77878514334492, -42.20979263977908, -233.3057877714183, -174.86145899507136, 19.946915147509536, -281.2177159303682, -55.25414417188123, -376.98056459828626, -104.47915521957559, -61.669860694839684, -139.62266195376748, -35.73478227579376, 60.60398679043475, 1.3821651558029828, 14.590182021564472, -64.67117372716545, -39.94627717449412, 48.80000000000022, -401.9766049205895, -336.7292758930842, 115.33485620674496, 27.665641445547518, -283.584892133999, -488.3167781324467, -71.58244175267008, -307.47136552472716, -779.5841629630767, 12.051004747342962, -372.6657391694171, -109.53741906901699, -122.62889444294153, -407.35371653636287, -3.888821707813487, -78.17948768377384, -45.16579424130498, -335.18633733422195, -727.5945622164794, -353.5134564660067, -652.338118031375, -722.7311671293746, -582.8181453359942, -321.687048280773, -13.522053200414364, -84.25727347767452, 7.820140648571567, -737.7945896551646, -295.5469775447608, -320.4369406370096, -103.4657286950942, -788.0758140183152, -152.3396181715347, -353.09128832283534, -14.012201342558459, -18.712379044063766, -546.0269907560719, -769.2835618973344, -687.6017599160067, 33.88141814773401, -179.42242981636986, -122.34348359802212, -181.1048698414939, -246.85721172426398, -722.19172228254, -698.6788507439385, -182.56577785212656, -693.7870988491105, -600.4760262398836, -389.4794664627935, -369.8631809193455, -732.1217081084038], "policy_predator_policy_reward": [349.6143356097579, 75.8148072033027, 275.54423929168604, 43.67130441014178, 73.02021583481856, 97.16649908621707, 105.48501164675703, 239.8784364215354, 398.9024322234234, 35.9409460186056, 51.31504245965191, 426.47355291165184, 335.36025720760364, 3.384488490352339, 183.39454589242985, 115.65850740880036, 74.94533566306349, 140.50413519362596, 149.31506475003388, 6.387452772362291, 226.62675663643125, 397.03380819778164, 16.51105003178201, 91.6648058100921, 91.40446745036043, 215.54448800579027, 40.718205975190074, 335.47366379892657, 14.2590041317517, 49.60001211094105, 79.48922876693459, 231.96146546627898, 71.42268980726028, 14.14830087826216, 56.656185310399565, 120.10072358368072, 135.6500288197077, 126.42792627984409, 190.21195616051216, 12.873349799706002, 288.2005798719873, 57.14156723612408, 44.87054189360246, 218.4958835235194, 2.055466087716081, 74.56253491657588, 22.048105191580184, 123.50860123454353, 20.02115191176238, 64.4742777237465, 142.2629272768319, 90.14162709943714, 1.0564470941152877, 93.55152520154414, 24.067383540318264, 158.62434079571355, 93.88736315060045, 5.4251567344297005, 41.82763923150253, 316.6181667080749, 281.7414385353903, 46.253259641788325, 275.9137909249814, 279.66879092715254, 258.01594279381675, 448.5158005598164, 154.30150737227336, 108.31093640211137, 33.93754430563897, 41.94853089658793, 9.728837764668778, 313.91246071816164, 220.43230433910898, 27.476891278398384, 8.85078167250917, 112.85739475181946, 124.75673897561482, 246.6066012605509, 13.983777521437727, 7.846593517037137, 55.872749631925586, 337.28610065558576, 0.0, 15.39481365514661, 1.7529628831729807, 22.96732030920835, 24.413012989528166, 21.691143706013303, 6.777891572685961, 1.7931062925808663, 262.40981813370496, 144.18901392822468, 8.56214476625719, 71.1053361592355, 0.0, 12.345079612450249, 263.31135202005913, 34.689632924899556, 447.21378165947834, 30.558149310354228, 165.02347705947676, 37.88199377440112, 83.95197916018947, 3.0637315749691743, 249.23239028590524, 399.9301900897925, 26.95512811643204, 80.32844778586359, 33.85616734026525, 12.378889281302861, 35.284563175832325, 244.44020561497356, 36.15586661435263, 770.9141181036337, 142.7781753555781, 249.04023670640294, 27.08310603069196, 53.28452067794091, 331.0113790839849, 141.03501484173125, 2.118033988749895, 200.29812282070023, 208.2737552737795, 118.04278957948101, 79.48829907596638, 1.1056575481167445, 112.08152257667463, 94.1862539199572, 174.25512454769742, 262.1414504898886, 110.37952080559616, 96.06703406049735, 78.94136893985969, 357.0422882983589, 226.69577949452696, 242.42066640517996, 12.54477655812721, 429.35416090406534, 8.830866096267853, 254.0181498181463, 215.4851172310873, 0.0, 14.785316421833167, 37.22853163192935, 39.5098179784355, 79.8711737271646, 87.94627717449427, 0.0, 455.5909080068479, 92.21567473674209, 10.765143793254634, 2.0343585544526226, 186.8088161739373, 542.9038709466282, 377.9479465691644, 285.27630853100584, 466.62398269889934, 672.752707844926, 311.0985821160292, 305.6321790053446, 353.2749044859121, 392.9308093260606, 136.64363096478604, 162.63945540095006, 163.6806674269466, 315.5345749575817, 814.428792194752, 494.8787175139948, 857.8151182372487, 349.64731832312964, 638.2347726122891, 24.055284824615367, 116.02647120539928, 93.73521804743595, 332.4698149143812, 678.5797768148057, 444.7054513333826, 159.1627628331823, 306.78174731635994, 731.2362893692633, 464.59745621910076, 320.9470447491003, 30.270019287308017, 40.84973210462411, 640.4067737648323, 646.5493694502479, 670.8275897755719, 228.93430469609356, 282.27586077842477, 16.01895685739098, 159.61072710512394, 339.73070330425827, 629.2286278631225, 842.2193076391848, 139.97989747414132, 725.0345710560473, 621.9718925146725, 641.5683252742257, 596.9906350655513, 610.7593811502344]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.406686743816466, "mean_inference_ms": 21.18814617327631, "mean_action_processing_ms": 14.501142778625404, "mean_env_wait_ms": 4.9334051127682805, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037298202514648438, "StateBufferConnector_ms": 0.003174901008605957, "ViewRequirementAgentConnector_ms": 0.09317708015441895}, "num_episodes": 23, "episode_return_max": 371.84353232809207, "episode_return_min": -242.21513617986275, "episode_return_mean": 74.19850235242616, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 7.877061289407353, "num_env_steps_trained_throughput_per_sec": 7.877061289407353, "timesteps_total": 40000, "num_env_steps_sampled_lifetime": 40000, "num_agent_steps_sampled_lifetime": 160000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 160000, "timers": {"training_iteration_time_ms": 531812.434, "restore_workers_time_ms": 0.025, "training_step_time_ms": 531812.349, "sample_time_ms": 16324.29, "learn_time_ms": 515475.572, "learn_throughput": 7.76, "synch_weights_time_ms": 10.726}, "counters": {"num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000}, "done": false, "training_iteration": 10, "trial_id": "cf3bb_00000", "date": "2024-08-20_08-00-53", "timestamp": 1724121053, "time_this_iter_s": 507.8523259162903, "time_total_s": 5318.448948144913, "pid": 25777, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39f81aaf0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5318.448948144913, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 19.62096774193548, "ram_util_percent": 80.0564516129032}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5923907193537584, "cur_kl_coeff": 0.05, "cur_lr": 0.00010000000000000003, "total_loss": 5.368281896530636, "policy_loss": -0.0025873918847609608, "vf_loss": 5.370497776086999, "vf_explained_var": -3.510470743532534e-05, "kl": 0.007429976264070256, "entropy": 1.4633445948520034, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 19845.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.6603994310572348, "cur_kl_coeff": 0.22500000000000006, "cur_lr": 0.00010000000000000003, "total_loss": 6.284786747876929, "policy_loss": -0.009185301289504403, "vf_loss": 6.290347303158391, "vf_explained_var": 0.014710519679639706, "kl": 0.01610998578876767, "entropy": 1.5791124790433853, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 19845.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000}, "env_runners": {"episode_reward_max": 371.84353232809207, "episode_reward_min": -242.21513617986275, "episode_reward_mean": 88.9350419051485, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -788.0758140183152, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 151.10089299259243, "predator_policy": 857.8151182372487}, "policy_reward_mean": {"prey_policy": -151.65431620863336, "predator_policy": 196.12183716120765}, "custom_metrics": {}, "hist_stats": {"episode_reward": [29.29630451237402, 73.55615411845504, 66.88909003485215, 25.700000000000088, 64.65641561644529, 86.79999999999939, 47.075829833296496, 169.73847638844526, 26.838196075628385, 39.78654402326649, 34.30000000000022, 7.223830423314672, 27.41420735026482, 23.05832429490372, 199.99335324593855, 35.70000000000024, 181.35326196064227, 106.19999999999929, 26.300000000000104, 108.99999999999875, 25.7000000000001, 44.2000000000003, 78.64598626039786, 58.60000000000046, 38.10000000000027, 84.22326389779394, 149.8999999999985, 140.85197767829717, 39.7000000000003, 62.200000000000486, 31.222744514308634, 74.08071211393138, 81.86486688193689, 78.29999999999939, 78.60145483091658, 208.84654002942085, 51.20000000000047, 17.100004700808046, -122.28110813651674, 29.14950039995243, 106.59999999999857, 15.546436367388011, 77.01803398874942, 124.84380067837193, 52.000000000000405, 58.477369214725314, 38.1126781251819, 27.457977082970206, 27.81641047172962, 207.84564511684587, 9.66422869202568, 96.69999999999905, 40.127673001526915, 113.9999999999988, 69.30000000000001, 96.79999999999868, -190.89929807008323, 155.79999999999885, -42.18898314588123, 284.17044782277264, 371.84353232809207, 134.52760288294076, 216.22310283266927, 217.21477697414798, 98.86311080900192, 228.19949102626066, -167.60684860037188, -242.21513617986275, 111.98236257474622, 281.0751427225938, -12.115704015205287, 146.4764939722132, 280.11359447383205, 38.39517100530977, -28.354409438326122, 246.0415527033925, -3.4710957785764798, 71.37934884362485, 50.577362475828345, -11.338408171047762, 273.5847250862211, 105.76512718803642, 126.29999999999939, 79.12883460665643, 35.50000000000023, 182.09999999999917, 48.44932797356465, 202.73578590128264, 99.49649143411698, 155.80782609932675, 95.1094629449488, 264.9432439996373, 317.8672646912589, 111.39999999999904, 310.6801632749595, 153.79369933202753, 89.47107304776725, 73.50275914271212, 93.87901195568284, 45.90000000000042], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-177.60668136331202, -55.17496922386655, 18.06742247711357, -147.59657431887643, -114.00972709056538, -164.44332998269482, -123.38358357750049, -114.282841839622, 34.78890236449114, -46.75048775233776, 12.441685166123369, -71.19839159224749, 1.0293587719701105, -38.44895857418267, -39.851753043824864, -22.81432494399788, -79.45152520154484, 11.681748981512957, -19.704847942373398, -123.20033237039294, -10.306180976100029, -54.70633890892985, -58.075793399724894, -293.1461821165374, -264.63206142319245, -35.948429403718755, -214.62199907033835, -317.90225848689244, -455.6808958861297, -50.85749422156492, -183.49548905662368, -43.416954717761634, -4.37968885633221, 109.84687561474831, 90.37116223533064, -307.8124607181613, -211.83230433910924, -9.77689127839833, 86.04921832749022, -98.75739475182026, -187.56605806563203, -158.09728217053484, 17.01842288315995, 5.351206078365166, 29.000000000000163, -343.5128640271111, 29.90000000000018, 13.305186344853356, 18.04703711682701, -4.667320309208293, 21.01548561634953, 17.103621585903998, 52.222108427314254, 89.10689370741846, -339.1550175591131, 73.40816317548303, 10.637855233742792, -50.60533615923536, 26.30000000000012, 23.55492038754999, -135.41119431080207, -131.36704611984968, -453.6316617978543, 49.94044294195392, -159.51292351466026, 38.47231956271964, -67.6519791601904, 58.93626842503101, -374.3081342128868, -196.25299133189338, 69.85700732647709, 31.705956800648877, -1.756167340265271, 6.721110718697105, -56.226652456611475, -206.39811163338672, -272.43595216144837, -656.9151406930548, -124.16293650967995, -238.50597515235035, 8.272927066936846, 17.95944622443022, -288.2647289153146, -168.23522864301356, 28.001163743644327, -153.39928656434506, -190.4377773233562, -11.034966851531951, -47.38829907596617, 18.794342451883253, 25.38531284417971, -173.17572012608645, -396.3719368316678, -1.9119600807363066, -136.77878514334492, -42.20979263977908, -233.3057877714183, -174.86145899507136, 19.946915147509536, -281.2177159303682, -55.25414417188123, -376.98056459828626, -104.47915521957559, -61.669860694839684, -139.62266195376748, -35.73478227579376, 60.60398679043475, 1.3821651558029828, 14.590182021564472, -64.67117372716545, -39.94627717449412, 48.80000000000022, -401.9766049205895, -336.7292758930842, 115.33485620674496, 27.665641445547518, -283.584892133999, -488.3167781324467, -71.58244175267008, -307.47136552472716, -779.5841629630767, 12.051004747342962, -372.6657391694171, -109.53741906901699, -122.62889444294153, -407.35371653636287, -3.888821707813487, -78.17948768377384, -45.16579424130498, -335.18633733422195, -727.5945622164794, -353.5134564660067, -652.338118031375, -722.7311671293746, -582.8181453359942, -321.687048280773, -13.522053200414364, -84.25727347767452, 7.820140648571567, -737.7945896551646, -295.5469775447608, -320.4369406370096, -103.4657286950942, -788.0758140183152, -152.3396181715347, -353.09128832283534, -14.012201342558459, -18.712379044063766, -546.0269907560719, -769.2835618973344, -687.6017599160067, 33.88141814773401, -179.42242981636986, -122.34348359802212, -181.1048698414939, -246.85721172426398, -722.19172228254, -698.6788507439385, -182.56577785212656, -693.7870988491105, -600.4760262398836, -389.4794664627935, -369.8631809193455, -732.1217081084038, 18.779589163707563, 49.06024229046307, -0.9482608125432007, -186.46548821712497, 11.283934001312977, -43.0350108397442, 151.10089299259243, 19.937263965515463, -103.81646474637701, -39.803556748513856, 42.28744132553225, -288.8332255671341, -306.3439624180822, -133.59615312862238, 46.12799603287565, -81.06789780463677, 0.6231961642257363, 64.32373164914931, -341.1446674768387, 1.365422514809503, -2.6270645411879925, -452.01853082251927, -56.233367489291325, 83.87543508145143, -451.49767918951034, -368.1663376230404, -66.33799725793732, 47.60101363790852, -89.34773192588834, 17.615853315468073, 20.731897233483835, -76.55791022628812, -276.40296550276634, -170.46568958838526, -12.973589414923714, -48.310294762585436], "policy_predator_policy_reward": [135.6500288197077, 126.42792627984409, 190.21195616051216, 12.873349799706002, 288.2005798719873, 57.14156723612408, 44.87054189360246, 218.4958835235194, 2.055466087716081, 74.56253491657588, 22.048105191580184, 123.50860123454353, 20.02115191176238, 64.4742777237465, 142.2629272768319, 90.14162709943714, 1.0564470941152877, 93.55152520154414, 24.067383540318264, 158.62434079571355, 93.88736315060045, 5.4251567344297005, 41.82763923150253, 316.6181667080749, 281.7414385353903, 46.253259641788325, 275.9137909249814, 279.66879092715254, 258.01594279381675, 448.5158005598164, 154.30150737227336, 108.31093640211137, 33.93754430563897, 41.94853089658793, 9.728837764668778, 313.91246071816164, 220.43230433910898, 27.476891278398384, 8.85078167250917, 112.85739475181946, 124.75673897561482, 246.6066012605509, 13.983777521437727, 7.846593517037137, 55.872749631925586, 337.28610065558576, 0.0, 15.39481365514661, 1.7529628831729807, 22.96732030920835, 24.413012989528166, 21.691143706013303, 6.777891572685961, 1.7931062925808663, 262.40981813370496, 144.18901392822468, 8.56214476625719, 71.1053361592355, 0.0, 12.345079612450249, 263.31135202005913, 34.689632924899556, 447.21378165947834, 30.558149310354228, 165.02347705947676, 37.88199377440112, 83.95197916018947, 3.0637315749691743, 249.23239028590524, 399.9301900897925, 26.95512811643204, 80.32844778586359, 33.85616734026525, 12.378889281302861, 35.284563175832325, 244.44020561497356, 36.15586661435263, 770.9141181036337, 142.7781753555781, 249.04023670640294, 27.08310603069196, 53.28452067794091, 331.0113790839849, 141.03501484173125, 2.118033988749895, 200.29812282070023, 208.2737552737795, 118.04278957948101, 79.48829907596638, 1.1056575481167445, 112.08152257667463, 94.1862539199572, 174.25512454769742, 262.1414504898886, 110.37952080559616, 96.06703406049735, 78.94136893985969, 357.0422882983589, 226.69577949452696, 242.42066640517996, 12.54477655812721, 429.35416090406534, 8.830866096267853, 254.0181498181463, 215.4851172310873, 0.0, 14.785316421833167, 37.22853163192935, 39.5098179784355, 79.8711737271646, 87.94627717449427, 0.0, 455.5909080068479, 92.21567473674209, 10.765143793254634, 2.0343585544526226, 186.8088161739373, 542.9038709466282, 377.9479465691644, 285.27630853100584, 466.62398269889934, 672.752707844926, 311.0985821160292, 305.6321790053446, 353.2749044859121, 392.9308093260606, 136.64363096478604, 162.63945540095006, 163.6806674269466, 315.5345749575817, 814.428792194752, 494.8787175139948, 857.8151182372487, 349.64731832312964, 638.2347726122891, 24.055284824615367, 116.02647120539928, 93.73521804743595, 332.4698149143812, 678.5797768148057, 444.7054513333826, 159.1627628331823, 306.78174731635994, 731.2362893692633, 464.59745621910076, 320.9470447491003, 30.270019287308017, 40.84973210462411, 640.4067737648323, 646.5493694502479, 670.8275897755719, 228.93430469609356, 282.27586077842477, 16.01895685739098, 159.61072710512394, 339.73070330425827, 629.2286278631225, 842.2193076391848, 139.97989747414132, 725.0345710560473, 621.9718925146725, 641.5683252742257, 596.9906350655513, 610.7593811502344, 12.785249112844248, 45.67491943298526, 123.19905389394651, 143.34352974237777, 8.116065998686988, 59.1350108397444, 2.699107007407429, 8.36273603448455, 51.46775187332673, 140.60159759512794, 222.05227078671675, 227.22929935616847, 300.76496090528553, 238.67164607553582, 106.4779929005513, 84.26973497053689, 13.211051299579685, 16.95148383199487, 324.1533731707194, 280.5691157909479, 424.8333717871684, 347.6794882677966, 73.8333674892909, 9.924564918548137, 610.7800991126554, 519.564080974855, 94.52823096625922, 78.00245198579864, 3.395020320112999, 157.80793133807455, 12.48062612662181, 116.8481460088941, 261.98036344660795, 278.7673036002274, 42.373589414923906, 64.81029476258561]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.876956496616795, "mean_inference_ms": 18.98340849923013, "mean_action_processing_ms": 12.950250049289071, "mean_env_wait_ms": 4.413432861192071, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037779808044433594, "StateBufferConnector_ms": 0.0031387805938720703, "ViewRequirementAgentConnector_ms": 0.09289240837097168}, "num_episodes": 18, "episode_return_max": 371.84353232809207, "episode_return_min": -242.21513617986275, "episode_return_mean": 88.9350419051485, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 72.63297540345849, "num_env_steps_trained_throughput_per_sec": 72.63297540345849, "timesteps_total": 44000, "num_env_steps_sampled_lifetime": 44000, "num_agent_steps_sampled_lifetime": 176000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 176000, "timers": {"training_iteration_time_ms": 532488.253, "restore_workers_time_ms": 0.025, "training_step_time_ms": 532488.17, "sample_time_ms": 16253.464, "learn_time_ms": 516222.569, "learn_throughput": 7.749, "synch_weights_time_ms": 10.603}, "counters": {"num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000}, "done": false, "training_iteration": 11, "trial_id": "cf3bb_00000", "date": "2024-08-20_08-01-48", "timestamp": 1724121108, "time_this_iter_s": 55.07416772842407, "time_total_s": 5373.523115873337, "pid": 25777, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39f82adc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5373.523115873337, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 19.070967741935487, "ram_util_percent": 80.35483870967744}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.4170169522049566, "cur_kl_coeff": 0.05, "cur_lr": 0.00010000000000000003, "total_loss": 1.607426322421069, "policy_loss": -0.0007641215328245409, "vf_loss": 1.6080329154849684, "vf_explained_var": -0.0004048104954775048, "kl": 0.0031505516916683113, "entropy": 1.5071186124332367, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 21735.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.9344309962260975, "cur_kl_coeff": 0.22500000000000006, "cur_lr": 0.00010000000000000003, "total_loss": 6.891491309423295, "policy_loss": -0.010141218421862476, "vf_loss": 6.8986376404131535, "vf_explained_var": 0.09958303208073611, "kl": 0.013310628818121815, "entropy": 1.5459799211491982, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 21735.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000}, "env_runners": {"episode_reward_max": 409.15819104651825, "episode_reward_min": -242.21513617986275, "episode_reward_mean": 114.99159161548698, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -788.0758140183152, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 186.03166155663337, "predator_policy": 857.8151182372487}, "policy_reward_mean": {"prey_policy": -128.60564904369642, "predator_policy": 186.10144485144002}, "custom_metrics": {}, "hist_stats": {"episode_reward": [26.300000000000104, 108.99999999999875, 25.7000000000001, 44.2000000000003, 78.64598626039786, 58.60000000000046, 38.10000000000027, 84.22326389779394, 149.8999999999985, 140.85197767829717, 39.7000000000003, 62.200000000000486, 31.222744514308634, 74.08071211393138, 81.86486688193689, 78.29999999999939, 78.60145483091658, 208.84654002942085, 51.20000000000047, 17.100004700808046, -122.28110813651674, 29.14950039995243, 106.59999999999857, 15.546436367388011, 77.01803398874942, 124.84380067837193, 52.000000000000405, 58.477369214725314, 38.1126781251819, 27.457977082970206, 27.81641047172962, 207.84564511684587, 9.66422869202568, 96.69999999999905, 40.127673001526915, 113.9999999999988, 69.30000000000001, 96.79999999999868, -190.89929807008323, 155.79999999999885, -42.18898314588123, 284.17044782277264, 371.84353232809207, 134.52760288294076, 216.22310283266927, 217.21477697414798, 98.86311080900192, 228.19949102626066, -167.60684860037188, -242.21513617986275, 111.98236257474622, 281.0751427225938, -12.115704015205287, 146.4764939722132, 280.11359447383205, 38.39517100530977, -28.354409438326122, 246.0415527033925, -3.4710957785764798, 71.37934884362485, 50.577362475828345, -11.338408171047762, 273.5847250862211, 105.76512718803642, 126.29999999999939, 79.12883460665643, 35.50000000000023, 182.09999999999917, 48.44932797356465, 202.73578590128264, 99.49649143411698, 155.80782609932675, 95.1094629449488, 264.9432439996373, 317.8672646912589, 111.39999999999904, 310.6801632749595, 153.79369933202753, 89.47107304776725, 73.50275914271212, 93.87901195568284, 45.90000000000042, 241.63265203983778, 302.6200226294039, 208.90184717631087, 192.8999999999999, 125.41479115978034, 169.28274771855965, 140.2998718360411, 202.39999999999935, 241.59999999999977, 158.02676099411764, 262.79999999999967, 304.90000000000043, 283.6159117666968, 131.51746635298258, 409.15819104651825, 226.29999999999947, 212.96469619142758, 36.900000000000254], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-211.83230433910924, -9.77689127839833, 86.04921832749022, -98.75739475182026, -187.56605806563203, -158.09728217053484, 17.01842288315995, 5.351206078365166, 29.000000000000163, -343.5128640271111, 29.90000000000018, 13.305186344853356, 18.04703711682701, -4.667320309208293, 21.01548561634953, 17.103621585903998, 52.222108427314254, 89.10689370741846, -339.1550175591131, 73.40816317548303, 10.637855233742792, -50.60533615923536, 26.30000000000012, 23.55492038754999, -135.41119431080207, -131.36704611984968, -453.6316617978543, 49.94044294195392, -159.51292351466026, 38.47231956271964, -67.6519791601904, 58.93626842503101, -374.3081342128868, -196.25299133189338, 69.85700732647709, 31.705956800648877, -1.756167340265271, 6.721110718697105, -56.226652456611475, -206.39811163338672, -272.43595216144837, -656.9151406930548, -124.16293650967995, -238.50597515235035, 8.272927066936846, 17.95944622443022, -288.2647289153146, -168.23522864301356, 28.001163743644327, -153.39928656434506, -190.4377773233562, -11.034966851531951, -47.38829907596617, 18.794342451883253, 25.38531284417971, -173.17572012608645, -396.3719368316678, -1.9119600807363066, -136.77878514334492, -42.20979263977908, -233.3057877714183, -174.86145899507136, 19.946915147509536, -281.2177159303682, -55.25414417188123, -376.98056459828626, -104.47915521957559, -61.669860694839684, -139.62266195376748, -35.73478227579376, 60.60398679043475, 1.3821651558029828, 14.590182021564472, -64.67117372716545, -39.94627717449412, 48.80000000000022, -401.9766049205895, -336.7292758930842, 115.33485620674496, 27.665641445547518, -283.584892133999, -488.3167781324467, -71.58244175267008, -307.47136552472716, -779.5841629630767, 12.051004747342962, -372.6657391694171, -109.53741906901699, -122.62889444294153, -407.35371653636287, -3.888821707813487, -78.17948768377384, -45.16579424130498, -335.18633733422195, -727.5945622164794, -353.5134564660067, -652.338118031375, -722.7311671293746, -582.8181453359942, -321.687048280773, -13.522053200414364, -84.25727347767452, 7.820140648571567, -737.7945896551646, -295.5469775447608, -320.4369406370096, -103.4657286950942, -788.0758140183152, -152.3396181715347, -353.09128832283534, -14.012201342558459, -18.712379044063766, -546.0269907560719, -769.2835618973344, -687.6017599160067, 33.88141814773401, -179.42242981636986, -122.34348359802212, -181.1048698414939, -246.85721172426398, -722.19172228254, -698.6788507439385, -182.56577785212656, -693.7870988491105, -600.4760262398836, -389.4794664627935, -369.8631809193455, -732.1217081084038, 18.779589163707563, 49.06024229046307, -0.9482608125432007, -186.46548821712497, 11.283934001312977, -43.0350108397442, 151.10089299259243, 19.937263965515463, -103.81646474637701, -39.803556748513856, 42.28744132553225, -288.8332255671341, -306.3439624180822, -133.59615312862238, 46.12799603287565, -81.06789780463677, 0.6231961642257363, 64.32373164914931, -341.1446674768387, 1.365422514809503, -2.6270645411879925, -452.01853082251927, -56.233367489291325, 83.87543508145143, -451.49767918951034, -368.1663376230404, -66.33799725793732, 47.60101363790852, -89.34773192588834, 17.615853315468073, 20.731897233483835, -76.55791022628812, -276.40296550276634, -170.46568958838526, -12.973589414923714, -48.310294762585436, 91.14722287697123, 63.83410565207403, 120.30036712065419, 143.12002262940388, 186.03166155663337, -191.8168364066666, 11.554785421879288, 21.01140097259553, 3.7060869606198104, -139.0393916129605, 78.15793334910524, 16.184939517177128, 56.59987183604195, 36.88832363443167, 13.382578329078704, 160.40075646234678, -16.503302148224577, 137.11936628648348, -80.2387867241361, 13.714727712624148, 45.20278644796422, 170.95361316496655, 111.84786724204565, 176.4337234947633, -281.62601872738384, 156.05465253506063, 22.462008813293743, 80.45829382298733, 14.000779592292645, -295.28791033093285, 62.53587000800237, 141.49999999999986, 59.42287047118957, 78.98201419294513, 17.45700872337833, -30.893360337381516], "policy_predator_policy_reward": [220.43230433910898, 27.476891278398384, 8.85078167250917, 112.85739475181946, 124.75673897561482, 246.6066012605509, 13.983777521437727, 7.846593517037137, 55.872749631925586, 337.28610065558576, 0.0, 15.39481365514661, 1.7529628831729807, 22.96732030920835, 24.413012989528166, 21.691143706013303, 6.777891572685961, 1.7931062925808663, 262.40981813370496, 144.18901392822468, 8.56214476625719, 71.1053361592355, 0.0, 12.345079612450249, 263.31135202005913, 34.689632924899556, 447.21378165947834, 30.558149310354228, 165.02347705947676, 37.88199377440112, 83.95197916018947, 3.0637315749691743, 249.23239028590524, 399.9301900897925, 26.95512811643204, 80.32844778586359, 33.85616734026525, 12.378889281302861, 35.284563175832325, 244.44020561497356, 36.15586661435263, 770.9141181036337, 142.7781753555781, 249.04023670640294, 27.08310603069196, 53.28452067794091, 331.0113790839849, 141.03501484173125, 2.118033988749895, 200.29812282070023, 208.2737552737795, 118.04278957948101, 79.48829907596638, 1.1056575481167445, 112.08152257667463, 94.1862539199572, 174.25512454769742, 262.1414504898886, 110.37952080559616, 96.06703406049735, 78.94136893985969, 357.0422882983589, 226.69577949452696, 242.42066640517996, 12.54477655812721, 429.35416090406534, 8.830866096267853, 254.0181498181463, 215.4851172310873, 0.0, 14.785316421833167, 37.22853163192935, 39.5098179784355, 79.8711737271646, 87.94627717449427, 0.0, 455.5909080068479, 92.21567473674209, 10.765143793254634, 2.0343585544526226, 186.8088161739373, 542.9038709466282, 377.9479465691644, 285.27630853100584, 466.62398269889934, 672.752707844926, 311.0985821160292, 305.6321790053446, 353.2749044859121, 392.9308093260606, 136.64363096478604, 162.63945540095006, 163.6806674269466, 315.5345749575817, 814.428792194752, 494.8787175139948, 857.8151182372487, 349.64731832312964, 638.2347726122891, 24.055284824615367, 116.02647120539928, 93.73521804743595, 332.4698149143812, 678.5797768148057, 444.7054513333826, 159.1627628331823, 306.78174731635994, 731.2362893692633, 464.59745621910076, 320.9470447491003, 30.270019287308017, 40.84973210462411, 640.4067737648323, 646.5493694502479, 670.8275897755719, 228.93430469609356, 282.27586077842477, 16.01895685739098, 159.61072710512394, 339.73070330425827, 629.2286278631225, 842.2193076391848, 139.97989747414132, 725.0345710560473, 621.9718925146725, 641.5683252742257, 596.9906350655513, 610.7593811502344, 12.785249112844248, 45.67491943298526, 123.19905389394651, 143.34352974237777, 8.116065998686988, 59.1350108397444, 2.699107007407429, 8.36273603448455, 51.46775187332673, 140.60159759512794, 222.05227078671675, 227.22929935616847, 300.76496090528553, 238.67164607553582, 106.4779929005513, 84.26973497053689, 13.211051299579685, 16.95148383199487, 324.1533731707194, 280.5691157909479, 424.8333717871684, 347.6794882677966, 73.8333674892909, 9.924564918548137, 610.7800991126554, 519.564080974855, 94.52823096625922, 78.00245198579864, 3.395020320112999, 157.80793133807455, 12.48062612662181, 116.8481460088941, 261.98036344660795, 278.7673036002274, 42.373589414923906, 64.81029476258561, 86.65132351079286, 0.0, 0.0, 39.199632879345856, 21.047947873211662, 193.6390741531324, 117.24521457812071, 43.088599027404655, 209.77985398704504, 50.96824182507626, 64.78058909157683, 10.15928576070114, 46.811676365568474, 0.0, 6.017421670921264, 22.599243537653223, 101.71213794439647, 19.27179791734425, 78.04682606890006, 146.50399393672978, 35.257105921156246, 11.386494465913014, 14.052132757954293, 2.5662765052366074, 265.67315608574097, 143.51412187327918, 24.28164135900125, 4.315522357700308, 314.96833395465825, 375.4769878304987, 22.264129991997773, 0.0, 54.45545038821397, 20.104361139079867, 2.3429912766216523, 47.99336033738176]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.460164586204278, "mean_inference_ms": 17.25789242493951, "mean_action_processing_ms": 11.731493296837144, "mean_env_wait_ms": 4.004538133608062, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004284262657165527, "StateBufferConnector_ms": 0.0031088590621948242, "ViewRequirementAgentConnector_ms": 0.09144580364227295}, "num_episodes": 18, "episode_return_max": 409.15819104651825, "episode_return_min": -242.21513617986275, "episode_return_mean": 114.99159161548698, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 5.424957736131533, "num_env_steps_trained_throughput_per_sec": 5.424957736131533, "timesteps_total": 48000, "num_env_steps_sampled_lifetime": 48000, "num_agent_steps_sampled_lifetime": 192000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 192000, "timers": {"training_iteration_time_ms": 353836.637, "restore_workers_time_ms": 0.013, "training_step_time_ms": 353836.592, "sample_time_ms": 16199.447, "learn_time_ms": 337624.365, "learn_throughput": 11.847, "synch_weights_time_ms": 10.778}, "counters": {"num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000}, "done": false, "training_iteration": 12, "trial_id": "cf3bb_00000", "date": "2024-08-20_08-14-06", "timestamp": 1724121846, "time_this_iter_s": 737.3763172626495, "time_total_s": 6110.899433135986, "pid": 25777, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39f827af0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 6110.899433135986, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 23.8359375, "ram_util_percent": 80.509375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.3122848684628489, "cur_kl_coeff": 0.025, "cur_lr": 0.00010000000000000003, "total_loss": 1.2907098636109993, "policy_loss": -0.003970762861340686, "vf_loss": 1.2945026778985584, "vf_explained_var": 0.0010078513748431332, "kl": 0.007117937844204643, "entropy": 1.557943865294179, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 23625.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.156286315036514, "cur_kl_coeff": 0.22500000000000006, "cur_lr": 0.00010000000000000003, "total_loss": 5.005854362280911, "policy_loss": -0.003974782595553845, "vf_loss": 5.008908476400627, "vf_explained_var": 0.1345576225449799, "kl": 0.004091876903033532, "entropy": 1.5488805524255864, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 23625.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 208000, "num_agent_steps_trained": 208000}, "env_runners": {"episode_reward_max": 409.15819104651825, "episode_reward_min": -242.21513617986275, "episode_reward_mean": 130.50481156036648, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -788.0758140183152, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 198.12277957401966, "predator_policy": 857.8151182372487}, "policy_reward_mean": {"prey_policy": -111.12098091835976, "predator_policy": 176.37338669854307}, "custom_metrics": {}, "hist_stats": {"episode_reward": [51.20000000000047, 17.100004700808046, -122.28110813651674, 29.14950039995243, 106.59999999999857, 15.546436367388011, 77.01803398874942, 124.84380067837193, 52.000000000000405, 58.477369214725314, 38.1126781251819, 27.457977082970206, 27.81641047172962, 207.84564511684587, 9.66422869202568, 96.69999999999905, 40.127673001526915, 113.9999999999988, 69.30000000000001, 96.79999999999868, -190.89929807008323, 155.79999999999885, -42.18898314588123, 284.17044782277264, 371.84353232809207, 134.52760288294076, 216.22310283266927, 217.21477697414798, 98.86311080900192, 228.19949102626066, -167.60684860037188, -242.21513617986275, 111.98236257474622, 281.0751427225938, -12.115704015205287, 146.4764939722132, 280.11359447383205, 38.39517100530977, -28.354409438326122, 246.0415527033925, -3.4710957785764798, 71.37934884362485, 50.577362475828345, -11.338408171047762, 273.5847250862211, 105.76512718803642, 126.29999999999939, 79.12883460665643, 35.50000000000023, 182.09999999999917, 48.44932797356465, 202.73578590128264, 99.49649143411698, 155.80782609932675, 95.1094629449488, 264.9432439996373, 317.8672646912589, 111.39999999999904, 310.6801632749595, 153.79369933202753, 89.47107304776725, 73.50275914271212, 93.87901195568284, 45.90000000000042, 241.63265203983778, 302.6200226294039, 208.90184717631087, 192.8999999999999, 125.41479115978034, 169.28274771855965, 140.2998718360411, 202.39999999999935, 241.59999999999977, 158.02676099411764, 262.79999999999967, 304.90000000000043, 283.6159117666968, 131.51746635298258, 409.15819104651825, 226.29999999999947, 212.96469619142758, 36.900000000000254, 167.74433981405855, 104.39999999999986, 181.67987404948903, 62.200000000000344, 149.89183632545573, 174.69999999999922, 271.90000000000003, 132.7999999999994, 169.34349050595287, 201.59999999999934, 177.49999999999957, 112.99999999999974, 82.60000000000011, 351.5999999999999, 91.89999999999972, 255.1999999999997, 41.20000000000033, 232.39999999999938], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-1.756167340265271, 6.721110718697105, -56.226652456611475, -206.39811163338672, -272.43595216144837, -656.9151406930548, -124.16293650967995, -238.50597515235035, 8.272927066936846, 17.95944622443022, -288.2647289153146, -168.23522864301356, 28.001163743644327, -153.39928656434506, -190.4377773233562, -11.034966851531951, -47.38829907596617, 18.794342451883253, 25.38531284417971, -173.17572012608645, -396.3719368316678, -1.9119600807363066, -136.77878514334492, -42.20979263977908, -233.3057877714183, -174.86145899507136, 19.946915147509536, -281.2177159303682, -55.25414417188123, -376.98056459828626, -104.47915521957559, -61.669860694839684, -139.62266195376748, -35.73478227579376, 60.60398679043475, 1.3821651558029828, 14.590182021564472, -64.67117372716545, -39.94627717449412, 48.80000000000022, -401.9766049205895, -336.7292758930842, 115.33485620674496, 27.665641445547518, -283.584892133999, -488.3167781324467, -71.58244175267008, -307.47136552472716, -779.5841629630767, 12.051004747342962, -372.6657391694171, -109.53741906901699, -122.62889444294153, -407.35371653636287, -3.888821707813487, -78.17948768377384, -45.16579424130498, -335.18633733422195, -727.5945622164794, -353.5134564660067, -652.338118031375, -722.7311671293746, -582.8181453359942, -321.687048280773, -13.522053200414364, -84.25727347767452, 7.820140648571567, -737.7945896551646, -295.5469775447608, -320.4369406370096, -103.4657286950942, -788.0758140183152, -152.3396181715347, -353.09128832283534, -14.012201342558459, -18.712379044063766, -546.0269907560719, -769.2835618973344, -687.6017599160067, 33.88141814773401, -179.42242981636986, -122.34348359802212, -181.1048698414939, -246.85721172426398, -722.19172228254, -698.6788507439385, -182.56577785212656, -693.7870988491105, -600.4760262398836, -389.4794664627935, -369.8631809193455, -732.1217081084038, 18.779589163707563, 49.06024229046307, -0.9482608125432007, -186.46548821712497, 11.283934001312977, -43.0350108397442, 151.10089299259243, 19.937263965515463, -103.81646474637701, -39.803556748513856, 42.28744132553225, -288.8332255671341, -306.3439624180822, -133.59615312862238, 46.12799603287565, -81.06789780463677, 0.6231961642257363, 64.32373164914931, -341.1446674768387, 1.365422514809503, -2.6270645411879925, -452.01853082251927, -56.233367489291325, 83.87543508145143, -451.49767918951034, -368.1663376230404, -66.33799725793732, 47.60101363790852, -89.34773192588834, 17.615853315468073, 20.731897233483835, -76.55791022628812, -276.40296550276634, -170.46568958838526, -12.973589414923714, -48.310294762585436, 91.14722287697123, 63.83410565207403, 120.30036712065419, 143.12002262940388, 186.03166155663337, -191.8168364066666, 11.554785421879288, 21.01140097259553, 3.7060869606198104, -139.0393916129605, 78.15793334910524, 16.184939517177128, 56.59987183604195, 36.88832363443167, 13.382578329078704, 160.40075646234678, -16.503302148224577, 137.11936628648348, -80.2387867241361, 13.714727712624148, 45.20278644796422, 170.95361316496655, 111.84786724204565, 176.4337234947633, -281.62601872738384, 156.05465253506063, 22.462008813293743, 80.45829382298733, 14.000779592292645, -295.28791033093285, 62.53587000800237, 141.49999999999986, 59.42287047118957, 78.98201419294513, 17.45700872337833, -30.893360337381516, -13.747707034756013, 139.31103396759218, 69.32767622654806, -74.48766866714747, 104.2556607708384, -204.57704603008108, 4.517140424010277, -50.4180064756966, 77.8061297321594, -44.85718308263546, -7.21108126087411, 111.60221270658258, 198.12277957401966, 70.43370255974637, 11.685294930745076, 23.593851817650595, -116.75099224700344, 117.97634624886943, -90.64270972735073, 167.62168532668105, 20.000000000000014, 155.51734581160497, -103.81865192939557, 8.63754987467323, 18.843684014439585, 57.39961608390753, 188.46325928591557, 156.5645323037216, 56.56254474133896, -10.13280723050743, -27.307991980739658, 145.8097946689408, 7.31644183195638, -48.95535370407647, 139.42288069912325, 77.87537566952322], "policy_predator_policy_reward": [33.85616734026525, 12.378889281302861, 35.284563175832325, 244.44020561497356, 36.15586661435263, 770.9141181036337, 142.7781753555781, 249.04023670640294, 27.08310603069196, 53.28452067794091, 331.0113790839849, 141.03501484173125, 2.118033988749895, 200.29812282070023, 208.2737552737795, 118.04278957948101, 79.48829907596638, 1.1056575481167445, 112.08152257667463, 94.1862539199572, 174.25512454769742, 262.1414504898886, 110.37952080559616, 96.06703406049735, 78.94136893985969, 357.0422882983589, 226.69577949452696, 242.42066640517996, 12.54477655812721, 429.35416090406534, 8.830866096267853, 254.0181498181463, 215.4851172310873, 0.0, 14.785316421833167, 37.22853163192935, 39.5098179784355, 79.8711737271646, 87.94627717449427, 0.0, 455.5909080068479, 92.21567473674209, 10.765143793254634, 2.0343585544526226, 186.8088161739373, 542.9038709466282, 377.9479465691644, 285.27630853100584, 466.62398269889934, 672.752707844926, 311.0985821160292, 305.6321790053446, 353.2749044859121, 392.9308093260606, 136.64363096478604, 162.63945540095006, 163.6806674269466, 315.5345749575817, 814.428792194752, 494.8787175139948, 857.8151182372487, 349.64731832312964, 638.2347726122891, 24.055284824615367, 116.02647120539928, 93.73521804743595, 332.4698149143812, 678.5797768148057, 444.7054513333826, 159.1627628331823, 306.78174731635994, 731.2362893692633, 464.59745621910076, 320.9470447491003, 30.270019287308017, 40.84973210462411, 640.4067737648323, 646.5493694502479, 670.8275897755719, 228.93430469609356, 282.27586077842477, 16.01895685739098, 159.61072710512394, 339.73070330425827, 629.2286278631225, 842.2193076391848, 139.97989747414132, 725.0345710560473, 621.9718925146725, 641.5683252742257, 596.9906350655513, 610.7593811502344, 12.785249112844248, 45.67491943298526, 123.19905389394651, 143.34352974237777, 8.116065998686988, 59.1350108397444, 2.699107007407429, 8.36273603448455, 51.46775187332673, 140.60159759512794, 222.05227078671675, 227.22929935616847, 300.76496090528553, 238.67164607553582, 106.4779929005513, 84.26973497053689, 13.211051299579685, 16.95148383199487, 324.1533731707194, 280.5691157909479, 424.8333717871684, 347.6794882677966, 73.8333674892909, 9.924564918548137, 610.7800991126554, 519.564080974855, 94.52823096625922, 78.00245198579864, 3.395020320112999, 157.80793133807455, 12.48062612662181, 116.8481460088941, 261.98036344660795, 278.7673036002274, 42.373589414923906, 64.81029476258561, 86.65132351079286, 0.0, 0.0, 39.199632879345856, 21.047947873211662, 193.6390741531324, 117.24521457812071, 43.088599027404655, 209.77985398704504, 50.96824182507626, 64.78058909157683, 10.15928576070114, 46.811676365568474, 0.0, 6.017421670921264, 22.599243537653223, 101.71213794439647, 19.27179791734425, 78.04682606890006, 146.50399393672978, 35.257105921156246, 11.386494465913014, 14.052132757954293, 2.5662765052366074, 265.67315608574097, 143.51412187327918, 24.28164135900125, 4.315522357700308, 314.96833395465825, 375.4769878304987, 22.264129991997773, 0.0, 54.45545038821397, 20.104361139079867, 2.3429912766216523, 47.99336033738176, 34.07053828432396, 8.110474596899325, 18.272323773451923, 91.28766866714652, 121.27934910509356, 160.72191020363846, 48.576273378217266, 59.524592673469265, 42.88570659329675, 74.05718308263535, 25.511081260874214, 44.79778729341728, 0.8772204259803328, 2.466297440253288, 80.72482331786568, 16.79602993373858, 102.57576686685107, 65.54236963723558, 111.34270972734984, 13.278314673318958, 0.0, 1.9826541883951097, 117.02855422762136, 91.15254782710088, 1.056315985560416, 5.300383916092449, 5.536740714084408, 1.035467696278434, 17.43745525866109, 28.032807230507572, 94.50799198073949, 42.190205331059175, 18.583558168043595, 64.2553537040767, 4.377119300876731, 10.724624330476122]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.124128254846102, "mean_inference_ms": 15.869558228639033, "mean_action_processing_ms": 10.747130199716883, "mean_env_wait_ms": 3.6743555178498566, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004262328147888184, "StateBufferConnector_ms": 0.0030993223190307617, "ViewRequirementAgentConnector_ms": 0.09274113178253174}, "num_episodes": 18, "episode_return_max": 409.15819104651825, "episode_return_min": -242.21513617986275, "episode_return_mean": 130.50481156036648, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 208000, "num_agent_steps_trained": 208000, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 88.13175456759645, "num_env_steps_trained_throughput_per_sec": 88.13175456759645, "timesteps_total": 52000, "num_env_steps_sampled_lifetime": 52000, "num_agent_steps_sampled_lifetime": 208000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 208000, "timers": {"training_iteration_time_ms": 353967.761, "restore_workers_time_ms": 0.013, "training_step_time_ms": 353967.715, "sample_time_ms": 16195.608, "learn_time_ms": 337759.384, "learn_throughput": 11.843, "synch_weights_time_ms": 10.681}, "counters": {"num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 208000, "num_agent_steps_trained": 208000}, "done": false, "training_iteration": 13, "trial_id": "cf3bb_00000", "date": "2024-08-20_08-14-51", "timestamp": 1724121891, "time_this_iter_s": 45.41852593421936, "time_total_s": 6156.317959070206, "pid": 25777, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39f817a60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 6156.317959070206, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 19.400000000000002, "ram_util_percent": 81.47777777777776}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.37337068512286775, "cur_kl_coeff": 0.025, "cur_lr": 0.00010000000000000003, "total_loss": 1.765328885133935, "policy_loss": -0.003262542640647442, "vf_loss": 1.7684255491488825, "vf_explained_var": 0.0020627047649767033, "kl": 0.006635016774289337, "entropy": 1.5888861005899138, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 25515.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.124400417238632, "cur_kl_coeff": 0.11250000000000003, "cur_lr": 0.00010000000000000003, "total_loss": 5.492416978260827, "policy_loss": -0.004414709288905321, "vf_loss": 5.495748316547858, "vf_explained_var": 0.16586072741362154, "kl": 0.009629723580166656, "entropy": 1.5210580600001824, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 25515.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 224000}, "env_runners": {"episode_reward_max": 409.15819104651825, "episode_reward_min": -242.21513617986275, "episode_reward_mean": 151.5953021427111, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -788.0758140183152, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 198.12277957401966, "predator_policy": 857.8151182372487}, "policy_reward_mean": {"prey_policy": -60.776715112752115, "predator_policy": 136.57436618410776}, "custom_metrics": {}, "hist_stats": {"episode_reward": [217.21477697414798, 98.86311080900192, 228.19949102626066, -167.60684860037188, -242.21513617986275, 111.98236257474622, 281.0751427225938, -12.115704015205287, 146.4764939722132, 280.11359447383205, 38.39517100530977, -28.354409438326122, 246.0415527033925, -3.4710957785764798, 71.37934884362485, 50.577362475828345, -11.338408171047762, 273.5847250862211, 105.76512718803642, 126.29999999999939, 79.12883460665643, 35.50000000000023, 182.09999999999917, 48.44932797356465, 202.73578590128264, 99.49649143411698, 155.80782609932675, 95.1094629449488, 264.9432439996373, 317.8672646912589, 111.39999999999904, 310.6801632749595, 153.79369933202753, 89.47107304776725, 73.50275914271212, 93.87901195568284, 45.90000000000042, 241.63265203983778, 302.6200226294039, 208.90184717631087, 192.8999999999999, 125.41479115978034, 169.28274771855965, 140.2998718360411, 202.39999999999935, 241.59999999999977, 158.02676099411764, 262.79999999999967, 304.90000000000043, 283.6159117666968, 131.51746635298258, 409.15819104651825, 226.29999999999947, 212.96469619142758, 36.900000000000254, 167.74433981405855, 104.39999999999986, 181.67987404948903, 62.200000000000344, 149.89183632545573, 174.69999999999922, 271.90000000000003, 132.7999999999994, 169.34349050595287, 201.59999999999934, 177.49999999999957, 112.99999999999974, 82.60000000000011, 351.5999999999999, 91.89999999999972, 255.1999999999997, 41.20000000000033, 232.39999999999938, 61.38235151184667, 144.02358576572607, 35.500000000000234, 199.39999999999932, 161.39999999999958, 362.91650548972217, 76.09999999999954, 43.00000000000035, 275.9000000000001, 200.14910135475566, 162.9999999999993, 89.39999999999992, 31.059039089255116, 270.73996053163853, 360.7, 147.12076635225927, 196.6999999999993, 25.608894222864055, 167.49999999999952, 211.49999999999932, 157.89999999999904, 182.39999999999924, 38.60000000000028, 37.50000000000026, 91.19999999999874, 103.88431773455383, 341.41959053610765], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-3.888821707813487, -78.17948768377384, -45.16579424130498, -335.18633733422195, -727.5945622164794, -353.5134564660067, -652.338118031375, -722.7311671293746, -582.8181453359942, -321.687048280773, -13.522053200414364, -84.25727347767452, 7.820140648571567, -737.7945896551646, -295.5469775447608, -320.4369406370096, -103.4657286950942, -788.0758140183152, -152.3396181715347, -353.09128832283534, -14.012201342558459, -18.712379044063766, -546.0269907560719, -769.2835618973344, -687.6017599160067, 33.88141814773401, -179.42242981636986, -122.34348359802212, -181.1048698414939, -246.85721172426398, -722.19172228254, -698.6788507439385, -182.56577785212656, -693.7870988491105, -600.4760262398836, -389.4794664627935, -369.8631809193455, -732.1217081084038, 18.779589163707563, 49.06024229046307, -0.9482608125432007, -186.46548821712497, 11.283934001312977, -43.0350108397442, 151.10089299259243, 19.937263965515463, -103.81646474637701, -39.803556748513856, 42.28744132553225, -288.8332255671341, -306.3439624180822, -133.59615312862238, 46.12799603287565, -81.06789780463677, 0.6231961642257363, 64.32373164914931, -341.1446674768387, 1.365422514809503, -2.6270645411879925, -452.01853082251927, -56.233367489291325, 83.87543508145143, -451.49767918951034, -368.1663376230404, -66.33799725793732, 47.60101363790852, -89.34773192588834, 17.615853315468073, 20.731897233483835, -76.55791022628812, -276.40296550276634, -170.46568958838526, -12.973589414923714, -48.310294762585436, 91.14722287697123, 63.83410565207403, 120.30036712065419, 143.12002262940388, 186.03166155663337, -191.8168364066666, 11.554785421879288, 21.01140097259553, 3.7060869606198104, -139.0393916129605, 78.15793334910524, 16.184939517177128, 56.59987183604195, 36.88832363443167, 13.382578329078704, 160.40075646234678, -16.503302148224577, 137.11936628648348, -80.2387867241361, 13.714727712624148, 45.20278644796422, 170.95361316496655, 111.84786724204565, 176.4337234947633, -281.62601872738384, 156.05465253506063, 22.462008813293743, 80.45829382298733, 14.000779592292645, -295.28791033093285, 62.53587000800237, 141.49999999999986, 59.42287047118957, 78.98201419294513, 17.45700872337833, -30.893360337381516, -13.747707034756013, 139.31103396759218, 69.32767622654806, -74.48766866714747, 104.2556607708384, -204.57704603008108, 4.517140424010277, -50.4180064756966, 77.8061297321594, -44.85718308263546, -7.21108126087411, 111.60221270658258, 198.12277957401966, 70.43370255974637, 11.685294930745076, 23.593851817650595, -116.75099224700344, 117.97634624886943, -90.64270972735073, 167.62168532668105, 20.000000000000014, 155.51734581160497, -103.81865192939557, 8.63754987467323, 18.843684014439585, 57.39961608390753, 188.46325928591557, 156.5645323037216, 56.56254474133896, -10.13280723050743, -27.307991980739658, 145.8097946689408, 7.31644183195638, -48.95535370407647, 139.42288069912325, 77.87537566952322, 7.491198176364515, 34.40000000000023, 25.674529756277032, -85.2382787658079, -27.296163913086573, -38.26748095390358, -2.488856463873823, 179.0766503237437, 57.56372672307767, 18.206371341254414, 146.81219005594775, 163.69591689099266, 24.32588011953032, 3.7801217859502203, -1.5610491545124723, -9.361303643294702, 138.12745281542345, 71.51059380007149, 60.53188738095015, 14.541185300309541, 16.077963497915277, 110.13417335810198, -61.98736682815504, -36.04077599230844, -61.48498858052437, -1.9434115364890778, 97.33799263296541, 110.291888349016, 189.63384199700212, 152.11155713414772, 10.244681060121929, 2.739711580157262, 16.347949467640625, 151.13135215632525, -42.190903464777435, -26.520837815290264, 41.76735033435257, 4.914911360310567, 192.84532688299365, -31.193170001505067, -24.978331533131502, 129.33234111580586, 154.6331411204297, -3.9104289185391123, 8.327379245732374, 14.21393334902623, 6.094936107516753, -8.898416253989922, 20.000000000000014, 36.73623900208364, -132.42522058132877, -0.5615015766895795, 123.475419573572, 121.79661667541481], "policy_predator_policy_reward": [136.64363096478604, 162.63945540095006, 163.6806674269466, 315.5345749575817, 814.428792194752, 494.8787175139948, 857.8151182372487, 349.64731832312964, 638.2347726122891, 24.055284824615367, 116.02647120539928, 93.73521804743595, 332.4698149143812, 678.5797768148057, 444.7054513333826, 159.1627628331823, 306.78174731635994, 731.2362893692633, 464.59745621910076, 320.9470447491003, 30.270019287308017, 40.84973210462411, 640.4067737648323, 646.5493694502479, 670.8275897755719, 228.93430469609356, 282.27586077842477, 16.01895685739098, 159.61072710512394, 339.73070330425827, 629.2286278631225, 842.2193076391848, 139.97989747414132, 725.0345710560473, 621.9718925146725, 641.5683252742257, 596.9906350655513, 610.7593811502344, 12.785249112844248, 45.67491943298526, 123.19905389394651, 143.34352974237777, 8.116065998686988, 59.1350108397444, 2.699107007407429, 8.36273603448455, 51.46775187332673, 140.60159759512794, 222.05227078671675, 227.22929935616847, 300.76496090528553, 238.67164607553582, 106.4779929005513, 84.26973497053689, 13.211051299579685, 16.95148383199487, 324.1533731707194, 280.5691157909479, 424.8333717871684, 347.6794882677966, 73.8333674892909, 9.924564918548137, 610.7800991126554, 519.564080974855, 94.52823096625922, 78.00245198579864, 3.395020320112999, 157.80793133807455, 12.48062612662181, 116.8481460088941, 261.98036344660795, 278.7673036002274, 42.373589414923906, 64.81029476258561, 86.65132351079286, 0.0, 0.0, 39.199632879345856, 21.047947873211662, 193.6390741531324, 117.24521457812071, 43.088599027404655, 209.77985398704504, 50.96824182507626, 64.78058909157683, 10.15928576070114, 46.811676365568474, 0.0, 6.017421670921264, 22.599243537653223, 101.71213794439647, 19.27179791734425, 78.04682606890006, 146.50399393672978, 35.257105921156246, 11.386494465913014, 14.052132757954293, 2.5662765052366074, 265.67315608574097, 143.51412187327918, 24.28164135900125, 4.315522357700308, 314.96833395465825, 375.4769878304987, 22.264129991997773, 0.0, 54.45545038821397, 20.104361139079867, 2.3429912766216523, 47.99336033738176, 34.07053828432396, 8.110474596899325, 18.272323773451923, 91.28766866714652, 121.27934910509356, 160.72191020363846, 48.576273378217266, 59.524592673469265, 42.88570659329675, 74.05718308263535, 25.511081260874214, 44.79778729341728, 0.8772204259803328, 2.466297440253288, 80.72482331786568, 16.79602993373858, 102.57576686685107, 65.54236963723558, 111.34270972734984, 13.278314673318958, 0.0, 1.9826541883951097, 117.02855422762136, 91.15254782710088, 1.056315985560416, 5.300383916092449, 5.536740714084408, 1.035467696278434, 17.43745525866109, 28.032807230507572, 94.50799198073949, 42.190205331059175, 18.583558168043595, 64.2553537040767, 4.377119300876731, 10.724624330476122, 10.967041578369718, 8.524111757111928, 177.76969951340436, 25.817635261852843, 44.49616391308682, 56.56748095390384, 21.788856463873863, 1.0233496762562677, 13.189818805827025, 72.44008312984087, 22.67695482175007, 29.731443721031674, 32.87411988046979, 15.119878214049745, 20.661049154512497, 33.26130364329484, 21.572547184576564, 44.68940619992815, 45.25694147233862, 79.81908720115794, 4.691075787626318, 32.0967873563564, 48.17068907830145, 139.25745374216214, 91.68425916695398, 2.8031800393136286, 25.8019678986731, 37.30811165098397, 2.8661580029978673, 16.088442865852286, 68.5512485059582, 65.58512520602234, 3.3520505323593417, 25.868647843674747, 87.95146614708597, 6.369169355846264, 107.23264966564743, 13.5850886396894, 0.0, 49.84784311851168, 41.77833153313174, 11.767658884193855, 9.366858879570167, 22.310428918539156, 7.144627911609978, 8.914059493631353, 12.705063892483214, 27.59841625399006, 0.0, 34.46376099791654, 217.92434111765817, 18.94669877491385, 47.69096904504201, 48.456585242078916]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.087265032539773, "mean_inference_ms": 13.5052675213356, "mean_action_processing_ms": 9.60611197123824, "mean_env_wait_ms": 3.6442663843060803, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004433393478393555, "StateBufferConnector_ms": 0.003137946128845215, "ViewRequirementAgentConnector_ms": 0.09540510177612305}, "num_episodes": 27, "episode_return_max": 409.15819104651825, "episode_return_min": -242.21513617986275, "episode_return_mean": 151.5953021427111, "episodes_this_iter": 27}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 224000, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 6.68850173707347, "num_env_steps_trained_throughput_per_sec": 6.68850173707347, "timesteps_total": 56000, "num_env_steps_sampled_lifetime": 56000, "num_agent_steps_sampled_lifetime": 224000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 224000, "timers": {"training_iteration_time_ms": 394209.324, "restore_workers_time_ms": 0.013, "training_step_time_ms": 394209.279, "sample_time_ms": 1038.073, "learn_time_ms": 393158.223, "learn_throughput": 10.174, "synch_weights_time_ms": 10.741}, "counters": {"num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 224000}, "done": false, "training_iteration": 14, "trial_id": "cf3bb_00000", "date": "2024-08-20_08-24-49", "timestamp": 1724122489, "time_this_iter_s": 598.0787122249603, "time_total_s": 6754.396671295166, "pid": 25777, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39f796550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 6754.396671295166, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 23.049206349206354, "ram_util_percent": 81.64603174603175}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6477556441807084, "cur_kl_coeff": 0.025, "cur_lr": 0.00010000000000000003, "total_loss": 3.1271174647189954, "policy_loss": -0.002354302943718654, "vf_loss": 3.1293778520412547, "vf_explained_var": 0.005489847868207901, "kl": 0.003756457777443388, "entropy": 1.6016202334373717, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 27405.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.871917517790719, "cur_kl_coeff": 0.11250000000000003, "cur_lr": 0.00010000000000000003, "total_loss": 6.354623770587659, "policy_loss": -0.004640334230359821, "vf_loss": 6.358150484448387, "vf_explained_var": 0.12357328546741021, "kl": 0.009898920137971204, "entropy": 1.5072960704722733, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 27405.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000}, "env_runners": {"episode_reward_max": 409.15819104651825, "episode_reward_min": 25.608894222864055, "episode_reward_mean": 166.33156523287818, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -732.1217081084038, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 198.12277957401966, "predator_policy": 610.7800991126554}, "policy_reward_mean": {"prey_policy": 7.070646375415001, "predator_policy": 76.09513624102419}, "custom_metrics": {}, "hist_stats": {"episode_reward": [105.76512718803642, 126.29999999999939, 79.12883460665643, 35.50000000000023, 182.09999999999917, 48.44932797356465, 202.73578590128264, 99.49649143411698, 155.80782609932675, 95.1094629449488, 264.9432439996373, 317.8672646912589, 111.39999999999904, 310.6801632749595, 153.79369933202753, 89.47107304776725, 73.50275914271212, 93.87901195568284, 45.90000000000042, 241.63265203983778, 302.6200226294039, 208.90184717631087, 192.8999999999999, 125.41479115978034, 169.28274771855965, 140.2998718360411, 202.39999999999935, 241.59999999999977, 158.02676099411764, 262.79999999999967, 304.90000000000043, 283.6159117666968, 131.51746635298258, 409.15819104651825, 226.29999999999947, 212.96469619142758, 36.900000000000254, 167.74433981405855, 104.39999999999986, 181.67987404948903, 62.200000000000344, 149.89183632545573, 174.69999999999922, 271.90000000000003, 132.7999999999994, 169.34349050595287, 201.59999999999934, 177.49999999999957, 112.99999999999974, 82.60000000000011, 351.5999999999999, 91.89999999999972, 255.1999999999997, 41.20000000000033, 232.39999999999938, 61.38235151184667, 144.02358576572607, 35.500000000000234, 199.39999999999932, 161.39999999999958, 362.91650548972217, 76.09999999999954, 43.00000000000035, 275.9000000000001, 200.14910135475566, 162.9999999999993, 89.39999999999992, 31.059039089255116, 270.73996053163853, 360.7, 147.12076635225927, 196.6999999999993, 25.608894222864055, 167.49999999999952, 211.49999999999932, 157.89999999999904, 182.39999999999924, 38.60000000000028, 37.50000000000026, 91.19999999999874, 103.88431773455383, 341.41959053610765, 88.69999999999872, 153.29999999999936, 143.29999999999941, 49.33196202055265, 278.33114840657936, 188.6999999999994, 37.600000000000264, 95.79999999999906, 195.77344112087883, 79.4, 129.69999999999908, 288.3304691952085, 255.69999999999973, 252.7313603322681, 256.8228693883681, 185.8065890366395, 115.59999999999943, 257.49999999999966], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-369.8631809193455, -732.1217081084038, 18.779589163707563, 49.06024229046307, -0.9482608125432007, -186.46548821712497, 11.283934001312977, -43.0350108397442, 151.10089299259243, 19.937263965515463, -103.81646474637701, -39.803556748513856, 42.28744132553225, -288.8332255671341, -306.3439624180822, -133.59615312862238, 46.12799603287565, -81.06789780463677, 0.6231961642257363, 64.32373164914931, -341.1446674768387, 1.365422514809503, -2.6270645411879925, -452.01853082251927, -56.233367489291325, 83.87543508145143, -451.49767918951034, -368.1663376230404, -66.33799725793732, 47.60101363790852, -89.34773192588834, 17.615853315468073, 20.731897233483835, -76.55791022628812, -276.40296550276634, -170.46568958838526, -12.973589414923714, -48.310294762585436, 91.14722287697123, 63.83410565207403, 120.30036712065419, 143.12002262940388, 186.03166155663337, -191.8168364066666, 11.554785421879288, 21.01140097259553, 3.7060869606198104, -139.0393916129605, 78.15793334910524, 16.184939517177128, 56.59987183604195, 36.88832363443167, 13.382578329078704, 160.40075646234678, -16.503302148224577, 137.11936628648348, -80.2387867241361, 13.714727712624148, 45.20278644796422, 170.95361316496655, 111.84786724204565, 176.4337234947633, -281.62601872738384, 156.05465253506063, 22.462008813293743, 80.45829382298733, 14.000779592292645, -295.28791033093285, 62.53587000800237, 141.49999999999986, 59.42287047118957, 78.98201419294513, 17.45700872337833, -30.893360337381516, -13.747707034756013, 139.31103396759218, 69.32767622654806, -74.48766866714747, 104.2556607708384, -204.57704603008108, 4.517140424010277, -50.4180064756966, 77.8061297321594, -44.85718308263546, -7.21108126087411, 111.60221270658258, 198.12277957401966, 70.43370255974637, 11.685294930745076, 23.593851817650595, -116.75099224700344, 117.97634624886943, -90.64270972735073, 167.62168532668105, 20.000000000000014, 155.51734581160497, -103.81865192939557, 8.63754987467323, 18.843684014439585, 57.39961608390753, 188.46325928591557, 156.5645323037216, 56.56254474133896, -10.13280723050743, -27.307991980739658, 145.8097946689408, 7.31644183195638, -48.95535370407647, 139.42288069912325, 77.87537566952322, 7.491198176364515, 34.40000000000023, 25.674529756277032, -85.2382787658079, -27.296163913086573, -38.26748095390358, -2.488856463873823, 179.0766503237437, 57.56372672307767, 18.206371341254414, 146.81219005594775, 163.69591689099266, 24.32588011953032, 3.7801217859502203, -1.5610491545124723, -9.361303643294702, 138.12745281542345, 71.51059380007149, 60.53188738095015, 14.541185300309541, 16.077963497915277, 110.13417335810198, -61.98736682815504, -36.04077599230844, -61.48498858052437, -1.9434115364890778, 97.33799263296541, 110.291888349016, 189.63384199700212, 152.11155713414772, 10.244681060121929, 2.739711580157262, 16.347949467640625, 151.13135215632525, -42.190903464777435, -26.520837815290264, 41.76735033435257, 4.914911360310567, 192.84532688299365, -31.193170001505067, -24.978331533131502, 129.33234111580586, 154.6331411204297, -3.9104289185391123, 8.327379245732374, 14.21393334902623, 6.094936107516753, -8.898416253989922, 20.000000000000014, 36.73623900208364, -132.42522058132877, -0.5615015766895795, 123.475419573572, 121.79661667541481, 16.029991776152254, 17.301458547483456, 74.6980313079124, -49.86226009652434, 1.0463951024901637, 113.15818386019177, -100.68270749624709, -96.90345108826362, 106.759876036537, 31.561320506732038, 18.007882928718825, 145.13598593851884, -24.842925828336924, 5.101029756726886, 8.437156311630503, 53.795830514853336, 12.787667451505763, 68.74949460991174, -158.82892579548374, -22.969486356854837, 59.050925204162475, -5.8138141215973285, 86.9721514858415, 87.18267585847687, 157.18240596648027, 56.691562394747336, 55.463750674998415, -10.19633194518986, -89.7933823925307, 128.8552283718867, -28.267754612041344, 90.07950205634867, -50.55618478077742, -41.412026384283614, 30.236311381436693, 142.84123676761754], "policy_predator_policy_reward": [596.9906350655513, 610.7593811502344, 12.785249112844248, 45.67491943298526, 123.19905389394651, 143.34352974237777, 8.116065998686988, 59.1350108397444, 2.699107007407429, 8.36273603448455, 51.46775187332673, 140.60159759512794, 222.05227078671675, 227.22929935616847, 300.76496090528553, 238.67164607553582, 106.4779929005513, 84.26973497053689, 13.211051299579685, 16.95148383199487, 324.1533731707194, 280.5691157909479, 424.8333717871684, 347.6794882677966, 73.8333674892909, 9.924564918548137, 610.7800991126554, 519.564080974855, 94.52823096625922, 78.00245198579864, 3.395020320112999, 157.80793133807455, 12.48062612662181, 116.8481460088941, 261.98036344660795, 278.7673036002274, 42.373589414923906, 64.81029476258561, 86.65132351079286, 0.0, 0.0, 39.199632879345856, 21.047947873211662, 193.6390741531324, 117.24521457812071, 43.088599027404655, 209.77985398704504, 50.96824182507626, 64.78058909157683, 10.15928576070114, 46.811676365568474, 0.0, 6.017421670921264, 22.599243537653223, 101.71213794439647, 19.27179791734425, 78.04682606890006, 146.50399393672978, 35.257105921156246, 11.386494465913014, 14.052132757954293, 2.5662765052366074, 265.67315608574097, 143.51412187327918, 24.28164135900125, 4.315522357700308, 314.96833395465825, 375.4769878304987, 22.264129991997773, 0.0, 54.45545038821397, 20.104361139079867, 2.3429912766216523, 47.99336033738176, 34.07053828432396, 8.110474596899325, 18.272323773451923, 91.28766866714652, 121.27934910509356, 160.72191020363846, 48.576273378217266, 59.524592673469265, 42.88570659329675, 74.05718308263535, 25.511081260874214, 44.79778729341728, 0.8772204259803328, 2.466297440253288, 80.72482331786568, 16.79602993373858, 102.57576686685107, 65.54236963723558, 111.34270972734984, 13.278314673318958, 0.0, 1.9826541883951097, 117.02855422762136, 91.15254782710088, 1.056315985560416, 5.300383916092449, 5.536740714084408, 1.035467696278434, 17.43745525866109, 28.032807230507572, 94.50799198073949, 42.190205331059175, 18.583558168043595, 64.2553537040767, 4.377119300876731, 10.724624330476122, 10.967041578369718, 8.524111757111928, 177.76969951340436, 25.817635261852843, 44.49616391308682, 56.56748095390384, 21.788856463873863, 1.0233496762562677, 13.189818805827025, 72.44008312984087, 22.67695482175007, 29.731443721031674, 32.87411988046979, 15.119878214049745, 20.661049154512497, 33.26130364329484, 21.572547184576564, 44.68940619992815, 45.25694147233862, 79.81908720115794, 4.691075787626318, 32.0967873563564, 48.17068907830145, 139.25745374216214, 91.68425916695398, 2.8031800393136286, 25.8019678986731, 37.30811165098397, 2.8661580029978673, 16.088442865852286, 68.5512485059582, 65.58512520602234, 3.3520505323593417, 25.868647843674747, 87.95146614708597, 6.369169355846264, 107.23264966564743, 13.5850886396894, 0.0, 49.84784311851168, 41.77833153313174, 11.767658884193855, 9.366858879570167, 22.310428918539156, 7.144627911609978, 8.914059493631353, 12.705063892483214, 27.59841625399006, 0.0, 34.46376099791654, 217.92434111765817, 18.94669877491385, 47.69096904504201, 48.456585242078916, 9.968750268156514, 45.39979940820777, 42.262227597401704, 86.20200119121029, 17.65360489750982, 11.441816139808088, 123.61969093889232, 123.29842966616953, 6.4305507876721535, 133.5794010756378, 1.7921170712811636, 23.76401406148112, 43.44292582833719, 13.89897024327308, 10.762843688369463, 22.804169485146815, 2.884993010339251, 111.3512860491222, 221.62892579548372, 39.56948635685481, 22.899724576179004, 53.563164341256005, 2.4546108765681076, 111.72103097432199, 12.91759403351966, 28.908437605252818, 103.24032728994236, 104.22361431251753, 183.63871579571247, 34.12230761329961, 114.07433222393782, 9.920509368394775, 190.96612012227047, 16.6020910427907, 66.13006632761268, 18.292385523333206]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.5142880651297497, "mean_inference_ms": 13.26241691775492, "mean_action_processing_ms": 8.921813771743277, "mean_env_wait_ms": 3.0748201446604924, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004218339920043945, "StateBufferConnector_ms": 0.0032606124877929688, "ViewRequirementAgentConnector_ms": 0.09493517875671387}, "num_episodes": 18, "episode_return_max": 409.15819104651825, "episode_return_min": 25.608894222864055, "episode_return_mean": 166.33156523287818, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 9.164906773569253, "num_env_steps_trained_throughput_per_sec": 9.164906773569253, "timesteps_total": 60000, "num_env_steps_sampled_lifetime": 60000, "num_agent_steps_sampled_lifetime": 240000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 240000, "timers": {"training_iteration_time_ms": 428023.988, "restore_workers_time_ms": 0.013, "training_step_time_ms": 428023.943, "sample_time_ms": 1030.329, "learn_time_ms": 426980.435, "learn_throughput": 9.368, "synch_weights_time_ms": 10.795}, "counters": {"num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000}, "done": false, "training_iteration": 15, "trial_id": "cf3bb_00000", "date": "2024-08-20_08-32-06", "timestamp": 1724122926, "time_this_iter_s": 436.48591327667236, "time_total_s": 7190.882584571838, "pid": 25777, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39f817e50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 7190.882584571838, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 29.38125, "ram_util_percent": 81.934375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.4715625121598206, "cur_kl_coeff": 0.0125, "cur_lr": 0.00010000000000000003, "total_loss": 2.783440252902016, "policy_loss": -0.0008206637586077685, "vf_loss": 2.7842547069150934, "vf_explained_var": 0.0017853923260219514, "kl": 0.0004966833142401483, "entropy": 1.604464145438381, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 29295.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.020183703461021, "cur_kl_coeff": 0.11250000000000003, "cur_lr": 0.00010000000000000003, "total_loss": 5.344089059098057, "policy_loss": -0.0018614451614055764, "vf_loss": 5.345511215830606, "vf_explained_var": 0.08526657740905802, "kl": 0.003904871327893244, "entropy": 1.491054225094104, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 29295.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 256000, "num_agent_steps_trained": 256000}, "env_runners": {"episode_reward_max": 409.15819104651825, "episode_reward_min": -135.01553953507226, "episode_reward_mean": 162.6743902797284, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -295.28791033093285, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 198.12277957401966, "predator_policy": 375.4769878304987}, "policy_reward_mean": {"prey_policy": 26.638084634804162, "predator_policy": 54.699110505060126}, "custom_metrics": {}, "hist_stats": {"episode_reward": [45.90000000000042, 241.63265203983778, 302.6200226294039, 208.90184717631087, 192.8999999999999, 125.41479115978034, 169.28274771855965, 140.2998718360411, 202.39999999999935, 241.59999999999977, 158.02676099411764, 262.79999999999967, 304.90000000000043, 283.6159117666968, 131.51746635298258, 409.15819104651825, 226.29999999999947, 212.96469619142758, 36.900000000000254, 167.74433981405855, 104.39999999999986, 181.67987404948903, 62.200000000000344, 149.89183632545573, 174.69999999999922, 271.90000000000003, 132.7999999999994, 169.34349050595287, 201.59999999999934, 177.49999999999957, 112.99999999999974, 82.60000000000011, 351.5999999999999, 91.89999999999972, 255.1999999999997, 41.20000000000033, 232.39999999999938, 61.38235151184667, 144.02358576572607, 35.500000000000234, 199.39999999999932, 161.39999999999958, 362.91650548972217, 76.09999999999954, 43.00000000000035, 275.9000000000001, 200.14910135475566, 162.9999999999993, 89.39999999999992, 31.059039089255116, 270.73996053163853, 360.7, 147.12076635225927, 196.6999999999993, 25.608894222864055, 167.49999999999952, 211.49999999999932, 157.89999999999904, 182.39999999999924, 38.60000000000028, 37.50000000000026, 91.19999999999874, 103.88431773455383, 341.41959053610765, 88.69999999999872, 153.29999999999936, 143.29999999999941, 49.33196202055265, 278.33114840657936, 188.6999999999994, 37.600000000000264, 95.79999999999906, 195.77344112087883, 79.4, 129.69999999999908, 288.3304691952085, 255.69999999999973, 252.7313603322681, 256.8228693883681, 185.8065890366395, 115.59999999999943, 257.49999999999966, 50.974037689759044, -135.01553953507226, 322.4840313325805, 34.822279704642725, 173.69999999999948, 12.481036418249316, 280.668422792295, 29.537124425843732, 151.9999999999994, 244.40569635507612, 132.6442409846806, -14.41960413762087, 59.60000000000032, 131.49999999999895, 177.49999999999946, 45.300000000000395, 235.1308502465672, 246.8999999999993], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-12.973589414923714, -48.310294762585436, 91.14722287697123, 63.83410565207403, 120.30036712065419, 143.12002262940388, 186.03166155663337, -191.8168364066666, 11.554785421879288, 21.01140097259553, 3.7060869606198104, -139.0393916129605, 78.15793334910524, 16.184939517177128, 56.59987183604195, 36.88832363443167, 13.382578329078704, 160.40075646234678, -16.503302148224577, 137.11936628648348, -80.2387867241361, 13.714727712624148, 45.20278644796422, 170.95361316496655, 111.84786724204565, 176.4337234947633, -281.62601872738384, 156.05465253506063, 22.462008813293743, 80.45829382298733, 14.000779592292645, -295.28791033093285, 62.53587000800237, 141.49999999999986, 59.42287047118957, 78.98201419294513, 17.45700872337833, -30.893360337381516, -13.747707034756013, 139.31103396759218, 69.32767622654806, -74.48766866714747, 104.2556607708384, -204.57704603008108, 4.517140424010277, -50.4180064756966, 77.8061297321594, -44.85718308263546, -7.21108126087411, 111.60221270658258, 198.12277957401966, 70.43370255974637, 11.685294930745076, 23.593851817650595, -116.75099224700344, 117.97634624886943, -90.64270972735073, 167.62168532668105, 20.000000000000014, 155.51734581160497, -103.81865192939557, 8.63754987467323, 18.843684014439585, 57.39961608390753, 188.46325928591557, 156.5645323037216, 56.56254474133896, -10.13280723050743, -27.307991980739658, 145.8097946689408, 7.31644183195638, -48.95535370407647, 139.42288069912325, 77.87537566952322, 7.491198176364515, 34.40000000000023, 25.674529756277032, -85.2382787658079, -27.296163913086573, -38.26748095390358, -2.488856463873823, 179.0766503237437, 57.56372672307767, 18.206371341254414, 146.81219005594775, 163.69591689099266, 24.32588011953032, 3.7801217859502203, -1.5610491545124723, -9.361303643294702, 138.12745281542345, 71.51059380007149, 60.53188738095015, 14.541185300309541, 16.077963497915277, 110.13417335810198, -61.98736682815504, -36.04077599230844, -61.48498858052437, -1.9434115364890778, 97.33799263296541, 110.291888349016, 189.63384199700212, 152.11155713414772, 10.244681060121929, 2.739711580157262, 16.347949467640625, 151.13135215632525, -42.190903464777435, -26.520837815290264, 41.76735033435257, 4.914911360310567, 192.84532688299365, -31.193170001505067, -24.978331533131502, 129.33234111580586, 154.6331411204297, -3.9104289185391123, 8.327379245732374, 14.21393334902623, 6.094936107516753, -8.898416253989922, 20.000000000000014, 36.73623900208364, -132.42522058132877, -0.5615015766895795, 123.475419573572, 121.79661667541481, 16.029991776152254, 17.301458547483456, 74.6980313079124, -49.86226009652434, 1.0463951024901637, 113.15818386019177, -100.68270749624709, -96.90345108826362, 106.759876036537, 31.561320506732038, 18.007882928718825, 145.13598593851884, -24.842925828336924, 5.101029756726886, 8.437156311630503, 53.795830514853336, 12.787667451505763, 68.74949460991174, -158.82892579548374, -22.969486356854837, 59.050925204162475, -5.8138141215973285, 86.9721514858415, 87.18267585847687, 157.18240596648027, 56.691562394747336, 55.463750674998415, -10.19633194518986, -89.7933823925307, 128.8552283718867, -28.267754612041344, 90.07950205634867, -50.55618478077742, -41.412026384283614, 30.236311381436693, 142.84123676761754, -50.21016846824702, -30.514031613141128, -288.334027321345, -162.08461994714173, 106.18673078812452, 191.92933901118636, 5.410034401604262, -14.576220088859158, 110.39144056514763, 15.536658086255146, -74.09082975609171, -8.312393372148033, 163.6901993846093, 21.672524625510576, -145.1587772719006, -25.054176657003758, 27.84922025133673, 10.801884193664854, 91.88188982777604, -21.69991848125347, 67.74393073184052, -256.45456060927245, -81.12213467074206, -61.25692122866915, -40.11271327593622, -150.69400487474473, 61.64596145833664, -41.559501378850555, 148.32059200534275, 4.647682666724533, 23.767671391595066, -34.431616421247824, 32.63915136402375, 80.28198468310072, 89.0879401682316, 83.6884901243291], "policy_predator_policy_reward": [42.373589414923906, 64.81029476258561, 86.65132351079286, 0.0, 0.0, 39.199632879345856, 21.047947873211662, 193.6390741531324, 117.24521457812071, 43.088599027404655, 209.77985398704504, 50.96824182507626, 64.78058909157683, 10.15928576070114, 46.811676365568474, 0.0, 6.017421670921264, 22.599243537653223, 101.71213794439647, 19.27179791734425, 78.04682606890006, 146.50399393672978, 35.257105921156246, 11.386494465913014, 14.052132757954293, 2.5662765052366074, 265.67315608574097, 143.51412187327918, 24.28164135900125, 4.315522357700308, 314.96833395465825, 375.4769878304987, 22.264129991997773, 0.0, 54.45545038821397, 20.104361139079867, 2.3429912766216523, 47.99336033738176, 34.07053828432396, 8.110474596899325, 18.272323773451923, 91.28766866714652, 121.27934910509356, 160.72191020363846, 48.576273378217266, 59.524592673469265, 42.88570659329675, 74.05718308263535, 25.511081260874214, 44.79778729341728, 0.8772204259803328, 2.466297440253288, 80.72482331786568, 16.79602993373858, 102.57576686685107, 65.54236963723558, 111.34270972734984, 13.278314673318958, 0.0, 1.9826541883951097, 117.02855422762136, 91.15254782710088, 1.056315985560416, 5.300383916092449, 5.536740714084408, 1.035467696278434, 17.43745525866109, 28.032807230507572, 94.50799198073949, 42.190205331059175, 18.583558168043595, 64.2553537040767, 4.377119300876731, 10.724624330476122, 10.967041578369718, 8.524111757111928, 177.76969951340436, 25.817635261852843, 44.49616391308682, 56.56748095390384, 21.788856463873863, 1.0233496762562677, 13.189818805827025, 72.44008312984087, 22.67695482175007, 29.731443721031674, 32.87411988046979, 15.119878214049745, 20.661049154512497, 33.26130364329484, 21.572547184576564, 44.68940619992815, 45.25694147233862, 79.81908720115794, 4.691075787626318, 32.0967873563564, 48.17068907830145, 139.25745374216214, 91.68425916695398, 2.8031800393136286, 25.8019678986731, 37.30811165098397, 2.8661580029978673, 16.088442865852286, 68.5512485059582, 65.58512520602234, 3.3520505323593417, 25.868647843674747, 87.95146614708597, 6.369169355846264, 107.23264966564743, 13.5850886396894, 0.0, 49.84784311851168, 41.77833153313174, 11.767658884193855, 9.366858879570167, 22.310428918539156, 7.144627911609978, 8.914059493631353, 12.705063892483214, 27.59841625399006, 0.0, 34.46376099791654, 217.92434111765817, 18.94669877491385, 47.69096904504201, 48.456585242078916, 9.968750268156514, 45.39979940820777, 42.262227597401704, 86.20200119121029, 17.65360489750982, 11.441816139808088, 123.61969093889232, 123.29842966616953, 6.4305507876721535, 133.5794010756378, 1.7921170712811636, 23.76401406148112, 43.44292582833719, 13.89897024327308, 10.762843688369463, 22.804169485146815, 2.884993010339251, 111.3512860491222, 221.62892579548372, 39.56948635685481, 22.899724576179004, 53.563164341256005, 2.4546108765681076, 111.72103097432199, 12.91759403351966, 28.908437605252818, 103.24032728994236, 104.22361431251753, 183.63871579571247, 34.12230761329961, 114.07433222393782, 9.920509368394775, 190.96612012227047, 16.6020910427907, 66.13006632761268, 18.292385523333206, 56.903668991919254, 74.79456877922796, 64.5233206086969, 250.8797871247177, 16.265154145661313, 8.102807387606676, 9.47869071865908, 34.50977467323849, 43.70855943485238, 4.063341913744818, 94.88425954648828, 0.0, 12.278223407685312, 83.02747537448948, 17.083093449377248, 182.66698490536996, 60.648178895415846, 52.70071665958251, 33.120531848363115, 141.1031931601906, 6.923856283279282, 314.43101457883324, 1.971064025541018, 125.98838773624922, 86.81271327593639, 163.5940048747441, 0.0, 111.41353992051424, 10.179407994657256, 14.352317333275433, 17.452894727502823, 38.51105030215025, 73.43440829670553, 48.77530590273801, 63.336719464424505, 10.786850243014102]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.315657315847334, "mean_inference_ms": 12.448012285617683, "mean_action_processing_ms": 8.340132567956356, "mean_env_wait_ms": 2.8796158875545057, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004204154014587402, "StateBufferConnector_ms": 0.0034998655319213867, "ViewRequirementAgentConnector_ms": 0.0955049991607666}, "num_episodes": 18, "episode_return_max": 409.15819104651825, "episode_return_min": -135.01553953507226, "episode_return_mean": 162.6743902797284, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 256000, "num_agent_steps_trained": 256000, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 29.706000030656437, "num_env_steps_trained_throughput_per_sec": 29.706000030656437, "timesteps_total": 64000, "num_env_steps_sampled_lifetime": 64000, "num_agent_steps_sampled_lifetime": 256000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 256000, "timers": {"training_iteration_time_ms": 364508.946, "restore_workers_time_ms": 0.013, "training_step_time_ms": 364508.901, "sample_time_ms": 1025.46, "learn_time_ms": 363470.114, "learn_throughput": 11.005, "synch_weights_time_ms": 10.834}, "counters": {"num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 256000, "num_agent_steps_trained": 256000}, "done": false, "training_iteration": 16, "trial_id": "cf3bb_00000", "date": "2024-08-20_08-34-20", "timestamp": 1724123060, "time_this_iter_s": 134.720468044281, "time_total_s": 7325.603052616119, "pid": 25777, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39f796790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 7325.603052616119, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 20.596774193548388, "ram_util_percent": 81.21451612903225}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5299027453339289, "cur_kl_coeff": 0.00625, "cur_lr": 0.00010000000000000003, "total_loss": 4.647210986652071, "policy_loss": -0.0008342098927608243, "vf_loss": 4.648042237947857, "vf_explained_var": 0.000653230797046076, "kl": 0.00047616396792945825, "entropy": 1.6008173071518146, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 31185.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.123886431044056, "cur_kl_coeff": 0.056250000000000015, "cur_lr": 0.00010000000000000003, "total_loss": 5.822580755324591, "policy_loss": -0.003540372820915999, "vf_loss": 5.8255080487993025, "vf_explained_var": -0.017383732335277336, "kl": 0.01089917333505672, "entropy": 1.5060894112738352, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 31185.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 272000, "num_agent_steps_trained": 272000}, "env_runners": {"episode_reward_max": 362.91650548972217, "episode_reward_min": -135.01553953507226, "episode_reward_mean": 141.16352914339853, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -342.66134370806355, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 198.12277957401966, "predator_policy": 389.1414123724363}, "policy_reward_mean": {"prey_policy": 14.287250286989277, "predator_policy": 56.294514284710075}, "custom_metrics": {}, "hist_stats": {"episode_reward": [36.900000000000254, 167.74433981405855, 104.39999999999986, 181.67987404948903, 62.200000000000344, 149.89183632545573, 174.69999999999922, 271.90000000000003, 132.7999999999994, 169.34349050595287, 201.59999999999934, 177.49999999999957, 112.99999999999974, 82.60000000000011, 351.5999999999999, 91.89999999999972, 255.1999999999997, 41.20000000000033, 232.39999999999938, 61.38235151184667, 144.02358576572607, 35.500000000000234, 199.39999999999932, 161.39999999999958, 362.91650548972217, 76.09999999999954, 43.00000000000035, 275.9000000000001, 200.14910135475566, 162.9999999999993, 89.39999999999992, 31.059039089255116, 270.73996053163853, 360.7, 147.12076635225927, 196.6999999999993, 25.608894222864055, 167.49999999999952, 211.49999999999932, 157.89999999999904, 182.39999999999924, 38.60000000000028, 37.50000000000026, 91.19999999999874, 103.88431773455383, 341.41959053610765, 88.69999999999872, 153.29999999999936, 143.29999999999941, 49.33196202055265, 278.33114840657936, 188.6999999999994, 37.600000000000264, 95.79999999999906, 195.77344112087883, 79.4, 129.69999999999908, 288.3304691952085, 255.69999999999973, 252.7313603322681, 256.8228693883681, 185.8065890366395, 115.59999999999943, 257.49999999999966, 50.974037689759044, -135.01553953507226, 322.4840313325805, 34.822279704642725, 173.69999999999948, 12.481036418249316, 280.668422792295, 29.537124425843732, 151.9999999999994, 244.40569635507612, 132.6442409846806, -14.41960413762087, 59.60000000000032, 131.49999999999895, 177.49999999999946, 45.300000000000395, 235.1308502465672, 246.8999999999993, 35.60000000000023, -50.70432595964524, 35.00000000000023, 15.653816296606124, 126.59999999999951, 254.78249820697536, 232.89999999999924, 82.70818911653754, 113.5999999999995, 118.51611652351592, 37.40000000000026, 190.24454392829173, 38.70000000000028, 106.3314899813582, 207.7999999999996, 14.258138879333618, 103.03903661576655, 46.71934168995194], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [17.45700872337833, -30.893360337381516, -13.747707034756013, 139.31103396759218, 69.32767622654806, -74.48766866714747, 104.2556607708384, -204.57704603008108, 4.517140424010277, -50.4180064756966, 77.8061297321594, -44.85718308263546, -7.21108126087411, 111.60221270658258, 198.12277957401966, 70.43370255974637, 11.685294930745076, 23.593851817650595, -116.75099224700344, 117.97634624886943, -90.64270972735073, 167.62168532668105, 20.000000000000014, 155.51734581160497, -103.81865192939557, 8.63754987467323, 18.843684014439585, 57.39961608390753, 188.46325928591557, 156.5645323037216, 56.56254474133896, -10.13280723050743, -27.307991980739658, 145.8097946689408, 7.31644183195638, -48.95535370407647, 139.42288069912325, 77.87537566952322, 7.491198176364515, 34.40000000000023, 25.674529756277032, -85.2382787658079, -27.296163913086573, -38.26748095390358, -2.488856463873823, 179.0766503237437, 57.56372672307767, 18.206371341254414, 146.81219005594775, 163.69591689099266, 24.32588011953032, 3.7801217859502203, -1.5610491545124723, -9.361303643294702, 138.12745281542345, 71.51059380007149, 60.53188738095015, 14.541185300309541, 16.077963497915277, 110.13417335810198, -61.98736682815504, -36.04077599230844, -61.48498858052437, -1.9434115364890778, 97.33799263296541, 110.291888349016, 189.63384199700212, 152.11155713414772, 10.244681060121929, 2.739711580157262, 16.347949467640625, 151.13135215632525, -42.190903464777435, -26.520837815290264, 41.76735033435257, 4.914911360310567, 192.84532688299365, -31.193170001505067, -24.978331533131502, 129.33234111580586, 154.6331411204297, -3.9104289185391123, 8.327379245732374, 14.21393334902623, 6.094936107516753, -8.898416253989922, 20.000000000000014, 36.73623900208364, -132.42522058132877, -0.5615015766895795, 123.475419573572, 121.79661667541481, 16.029991776152254, 17.301458547483456, 74.6980313079124, -49.86226009652434, 1.0463951024901637, 113.15818386019177, -100.68270749624709, -96.90345108826362, 106.759876036537, 31.561320506732038, 18.007882928718825, 145.13598593851884, -24.842925828336924, 5.101029756726886, 8.437156311630503, 53.795830514853336, 12.787667451505763, 68.74949460991174, -158.82892579548374, -22.969486356854837, 59.050925204162475, -5.8138141215973285, 86.9721514858415, 87.18267585847687, 157.18240596648027, 56.691562394747336, 55.463750674998415, -10.19633194518986, -89.7933823925307, 128.8552283718867, -28.267754612041344, 90.07950205634867, -50.55618478077742, -41.412026384283614, 30.236311381436693, 142.84123676761754, -50.21016846824702, -30.514031613141128, -288.334027321345, -162.08461994714173, 106.18673078812452, 191.92933901118636, 5.410034401604262, -14.576220088859158, 110.39144056514763, 15.536658086255146, -74.09082975609171, -8.312393372148033, 163.6901993846093, 21.672524625510576, -145.1587772719006, -25.054176657003758, 27.84922025133673, 10.801884193664854, 91.88188982777604, -21.69991848125347, 67.74393073184052, -256.45456060927245, -81.12213467074206, -61.25692122866915, -40.11271327593622, -150.69400487474473, 61.64596145833664, -41.559501378850555, 148.32059200534275, 4.647682666724533, 23.767671391595066, -34.431616421247824, 32.63915136402375, 80.28198468310072, 89.0879401682316, 83.6884901243291, -12.989719360322274, -20.58021846100268, -121.99125558878725, -126.7886922073335, -42.73152563012284, -13.712071927060636, -173.25064858417912, -240.7392528270971, -22.78043988302725, 10.645170459266089, 76.71153954309754, 71.41895179114934, 142.3140794447379, 28.142289308451133, -342.66134370806355, 15.804210961854762, -3.162912267608531, -138.3713496993917, 33.00709653597827, -32.786448274194335, -8.149552506756192, 14.185675675871114, -92.0809343866105, 101.34155559120954, 8.323107175567582, 17.992432086243, 75.80998315192977, -17.638225232811607, 193.68134679290785, -87.23378940256472, -60.297008869017915, -14.21952003301217, -101.78691595759541, -79.6429655515883, -44.60126061622178, -254.13575713105334], "policy_predator_policy_reward": [2.3429912766216523, 47.99336033738176, 34.07053828432396, 8.110474596899325, 18.272323773451923, 91.28766866714652, 121.27934910509356, 160.72191020363846, 48.576273378217266, 59.524592673469265, 42.88570659329675, 74.05718308263535, 25.511081260874214, 44.79778729341728, 0.8772204259803328, 2.466297440253288, 80.72482331786568, 16.79602993373858, 102.57576686685107, 65.54236963723558, 111.34270972734984, 13.278314673318958, 0.0, 1.9826541883951097, 117.02855422762136, 91.15254782710088, 1.056315985560416, 5.300383916092449, 5.536740714084408, 1.035467696278434, 17.43745525866109, 28.032807230507572, 94.50799198073949, 42.190205331059175, 18.583558168043595, 64.2553537040767, 4.377119300876731, 10.724624330476122, 10.967041578369718, 8.524111757111928, 177.76969951340436, 25.817635261852843, 44.49616391308682, 56.56748095390384, 21.788856463873863, 1.0233496762562677, 13.189818805827025, 72.44008312984087, 22.67695482175007, 29.731443721031674, 32.87411988046979, 15.119878214049745, 20.661049154512497, 33.26130364329484, 21.572547184576564, 44.68940619992815, 45.25694147233862, 79.81908720115794, 4.691075787626318, 32.0967873563564, 48.17068907830145, 139.25745374216214, 91.68425916695398, 2.8031800393136286, 25.8019678986731, 37.30811165098397, 2.8661580029978673, 16.088442865852286, 68.5512485059582, 65.58512520602234, 3.3520505323593417, 25.868647843674747, 87.95146614708597, 6.369169355846264, 107.23264966564743, 13.5850886396894, 0.0, 49.84784311851168, 41.77833153313174, 11.767658884193855, 9.366858879570167, 22.310428918539156, 7.144627911609978, 8.914059493631353, 12.705063892483214, 27.59841625399006, 0.0, 34.46376099791654, 217.92434111765817, 18.94669877491385, 47.69096904504201, 48.456585242078916, 9.968750268156514, 45.39979940820777, 42.262227597401704, 86.20200119121029, 17.65360489750982, 11.441816139808088, 123.61969093889232, 123.29842966616953, 6.4305507876721535, 133.5794010756378, 1.7921170712811636, 23.76401406148112, 43.44292582833719, 13.89897024327308, 10.762843688369463, 22.804169485146815, 2.884993010339251, 111.3512860491222, 221.62892579548372, 39.56948635685481, 22.899724576179004, 53.563164341256005, 2.4546108765681076, 111.72103097432199, 12.91759403351966, 28.908437605252818, 103.24032728994236, 104.22361431251753, 183.63871579571247, 34.12230761329961, 114.07433222393782, 9.920509368394775, 190.96612012227047, 16.6020910427907, 66.13006632761268, 18.292385523333206, 56.903668991919254, 74.79456877922796, 64.5233206086969, 250.8797871247177, 16.265154145661313, 8.102807387606676, 9.47869071865908, 34.50977467323849, 43.70855943485238, 4.063341913744818, 94.88425954648828, 0.0, 12.278223407685312, 83.02747537448948, 17.083093449377248, 182.66698490536996, 60.648178895415846, 52.70071665958251, 33.120531848363115, 141.1031931601906, 6.923856283279282, 314.43101457883324, 1.971064025541018, 125.98838773624922, 86.81271327593639, 163.5940048747441, 0.0, 111.41353992051424, 10.179407994657256, 14.352317333275433, 17.452894727502823, 38.51105030215025, 73.43440829670553, 48.77530590273801, 63.336719464424505, 10.786850243014102, 30.38971936032233, 38.78021846100294, 39.47467686740108, 158.60094496907365, 60.43152563012309, 31.012071927060813, 389.1414123724363, 40.50230533544526, 117.90332565210109, 20.831943771660296, 19.664826414511353, 86.98718045821721, 21.764741256593283, 40.67888999021767, 308.16782791995774, 101.39749394278864, 136.31952610306556, 118.8147358639347, 69.29290346402159, 49.00256479771139, 26.049552506756307, 5.314324324128855, 173.47412291931587, 7.50979980437672, 10.576892824432386, 1.8075679137569887, 9.938252980720522, 38.22147908152029, 0.8186532070921686, 100.53378940256465, 0.0, 88.77466778136325, 142.56466539648642, 141.90425272846417, 57.06424996169076, 288.3921094755357]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.1447260303832296, "mean_inference_ms": 11.747191937276584, "mean_action_processing_ms": 7.838327994578151, "mean_env_wait_ms": 2.7113964126512347, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036269426345825195, "StateBufferConnector_ms": 0.0035371780395507812, "ViewRequirementAgentConnector_ms": 0.09736192226409912}, "num_episodes": 18, "episode_return_max": 362.91650548972217, "episode_return_min": -135.01553953507226, "episode_return_mean": 141.16352914339853, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 272000, "num_agent_steps_trained": 272000, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 63.48531400239177, "num_env_steps_trained_throughput_per_sec": 63.48531400239177, "timesteps_total": 68000, "num_env_steps_sampled_lifetime": 68000, "num_agent_steps_sampled_lifetime": 272000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 272000, "timers": {"training_iteration_time_ms": 366282.168, "restore_workers_time_ms": 0.013, "training_step_time_ms": 366282.122, "sample_time_ms": 1026.589, "learn_time_ms": 365241.573, "learn_throughput": 10.952, "synch_weights_time_ms": 11.328}, "counters": {"num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 272000, "num_agent_steps_trained": 272000}, "done": false, "training_iteration": 17, "trial_id": "cf3bb_00000", "date": "2024-08-20_08-35-24", "timestamp": 1724123124, "time_this_iter_s": 63.05525994300842, "time_total_s": 7388.658312559128, "pid": 25777, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39f819700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 7388.658312559128, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 19.998412698412693, "ram_util_percent": 81.33333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.47799880236150727, "cur_kl_coeff": 0.003125, "cur_lr": 0.00010000000000000003, "total_loss": 5.9611254997354335, "policy_loss": -0.004350146275782396, "vf_loss": 5.96543853497379, "vf_explained_var": 0.0002869328809162927, "kl": 0.01187826702142164, "entropy": 1.5725573962327664, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 33075.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.056033738264962, "cur_kl_coeff": 0.056250000000000015, "cur_lr": 0.00010000000000000003, "total_loss": 7.936918639632129, "policy_loss": -0.004950980673095694, "vf_loss": 7.9408927697984, "vf_explained_var": 0.023905900168040443, "kl": 0.017366302808074986, "entropy": 1.5398995811977083, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 33075.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000}, "env_runners": {"episode_reward_max": 362.91650548972217, "episode_reward_min": -138.9110134907137, "episode_reward_mean": 127.4334244057157, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -420.76352106114496, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 193.68134679290785, "predator_policy": 467.4458346329489}, "policy_reward_mean": {"prey_policy": -16.418988512119867, "predator_policy": 80.1357007149778}, "custom_metrics": {}, "hist_stats": {"episode_reward": [199.39999999999932, 161.39999999999958, 362.91650548972217, 76.09999999999954, 43.00000000000035, 275.9000000000001, 200.14910135475566, 162.9999999999993, 89.39999999999992, 31.059039089255116, 270.73996053163853, 360.7, 147.12076635225927, 196.6999999999993, 25.608894222864055, 167.49999999999952, 211.49999999999932, 157.89999999999904, 182.39999999999924, 38.60000000000028, 37.50000000000026, 91.19999999999874, 103.88431773455383, 341.41959053610765, 88.69999999999872, 153.29999999999936, 143.29999999999941, 49.33196202055265, 278.33114840657936, 188.6999999999994, 37.600000000000264, 95.79999999999906, 195.77344112087883, 79.4, 129.69999999999908, 288.3304691952085, 255.69999999999973, 252.7313603322681, 256.8228693883681, 185.8065890366395, 115.59999999999943, 257.49999999999966, 50.974037689759044, -135.01553953507226, 322.4840313325805, 34.822279704642725, 173.69999999999948, 12.481036418249316, 280.668422792295, 29.537124425843732, 151.9999999999994, 244.40569635507612, 132.6442409846806, -14.41960413762087, 59.60000000000032, 131.49999999999895, 177.49999999999946, 45.300000000000395, 235.1308502465672, 246.8999999999993, 35.60000000000023, -50.70432595964524, 35.00000000000023, 15.653816296606124, 126.59999999999951, 254.78249820697536, 232.89999999999924, 82.70818911653754, 113.5999999999995, 118.51611652351592, 37.40000000000026, 190.24454392829173, 38.70000000000028, 106.3314899813582, 207.7999999999996, 14.258138879333618, 103.03903661576655, 46.71934168995194, 106.72691458373629, -128.97561240622116, 50.20000000000043, 101.4999999999985, 205.99999999999983, 32.02814446336296, 214.20633146800574, 199.09723851886503, 2.351792352582705, 10.344819485981258, -97.16826295373986, 12.891298445869522, 309.3, 118.37001327108064, 124.39999999999925, 160.99999999999972, 88.59999999999894, 46.03116409434871, 123.39999999999911, 233.12051462691775, 91.94166174416887, -138.9110134907137], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-2.488856463873823, 179.0766503237437, 57.56372672307767, 18.206371341254414, 146.81219005594775, 163.69591689099266, 24.32588011953032, 3.7801217859502203, -1.5610491545124723, -9.361303643294702, 138.12745281542345, 71.51059380007149, 60.53188738095015, 14.541185300309541, 16.077963497915277, 110.13417335810198, -61.98736682815504, -36.04077599230844, -61.48498858052437, -1.9434115364890778, 97.33799263296541, 110.291888349016, 189.63384199700212, 152.11155713414772, 10.244681060121929, 2.739711580157262, 16.347949467640625, 151.13135215632525, -42.190903464777435, -26.520837815290264, 41.76735033435257, 4.914911360310567, 192.84532688299365, -31.193170001505067, -24.978331533131502, 129.33234111580586, 154.6331411204297, -3.9104289185391123, 8.327379245732374, 14.21393334902623, 6.094936107516753, -8.898416253989922, 20.000000000000014, 36.73623900208364, -132.42522058132877, -0.5615015766895795, 123.475419573572, 121.79661667541481, 16.029991776152254, 17.301458547483456, 74.6980313079124, -49.86226009652434, 1.0463951024901637, 113.15818386019177, -100.68270749624709, -96.90345108826362, 106.759876036537, 31.561320506732038, 18.007882928718825, 145.13598593851884, -24.842925828336924, 5.101029756726886, 8.437156311630503, 53.795830514853336, 12.787667451505763, 68.74949460991174, -158.82892579548374, -22.969486356854837, 59.050925204162475, -5.8138141215973285, 86.9721514858415, 87.18267585847687, 157.18240596648027, 56.691562394747336, 55.463750674998415, -10.19633194518986, -89.7933823925307, 128.8552283718867, -28.267754612041344, 90.07950205634867, -50.55618478077742, -41.412026384283614, 30.236311381436693, 142.84123676761754, -50.21016846824702, -30.514031613141128, -288.334027321345, -162.08461994714173, 106.18673078812452, 191.92933901118636, 5.410034401604262, -14.576220088859158, 110.39144056514763, 15.536658086255146, -74.09082975609171, -8.312393372148033, 163.6901993846093, 21.672524625510576, -145.1587772719006, -25.054176657003758, 27.84922025133673, 10.801884193664854, 91.88188982777604, -21.69991848125347, 67.74393073184052, -256.45456060927245, -81.12213467074206, -61.25692122866915, -40.11271327593622, -150.69400487474473, 61.64596145833664, -41.559501378850555, 148.32059200534275, 4.647682666724533, 23.767671391595066, -34.431616421247824, 32.63915136402375, 80.28198468310072, 89.0879401682316, 83.6884901243291, -12.989719360322274, -20.58021846100268, -121.99125558878725, -126.7886922073335, -42.73152563012284, -13.712071927060636, -173.25064858417912, -240.7392528270971, -22.78043988302725, 10.645170459266089, 76.71153954309754, 71.41895179114934, 142.3140794447379, 28.142289308451133, -342.66134370806355, 15.804210961854762, -3.162912267608531, -138.3713496993917, 33.00709653597827, -32.786448274194335, -8.149552506756192, 14.185675675871114, -92.0809343866105, 101.34155559120954, 8.323107175567582, 17.992432086243, 75.80998315192977, -17.638225232811607, 193.68134679290785, -87.23378940256472, -60.297008869017915, -14.21952003301217, -101.78691595759541, -79.6429655515883, -44.60126061622178, -254.13575713105334, -271.78923924708295, -22.619330184169975, -259.41220241342984, -420.76352106114496, 26.835664240329283, -167.30531065661816, 44.348880321097084, 48.78083227416459, 159.56971837246473, -369.64078536003836, -79.2597441077443, -109.28059089236983, 75.19241691767283, 10.148316514137882, 142.8264298054814, -221.47019919357277, -114.74802803899767, -342.34686620146726, -43.157637997658526, -318.93671312997003, -416.5069089842234, -267.7546203835996, -151.90899096051032, -136.76173730359758, 181.12388139206863, -51.779206413421065, -219.47121122891116, -5.174784029685918, -4.824739159527272, 35.34499755718778, 143.43577824956378, -241.70420144506173, -37.68464574635564, 59.728181074559025, -308.66688914006266, 0.15651298736119768, -169.87769475801824, 68.06177254357368, -25.139053564566694, 15.19782200375428, -220.0277704150494, -258.2965194618748, -367.60968926327723, -288.9933407470731], "policy_predator_policy_reward": [21.788856463873863, 1.0233496762562677, 13.189818805827025, 72.44008312984087, 22.67695482175007, 29.731443721031674, 32.87411988046979, 15.119878214049745, 20.661049154512497, 33.26130364329484, 21.572547184576564, 44.68940619992815, 45.25694147233862, 79.81908720115794, 4.691075787626318, 32.0967873563564, 48.17068907830145, 139.25745374216214, 91.68425916695398, 2.8031800393136286, 25.8019678986731, 37.30811165098397, 2.8661580029978673, 16.088442865852286, 68.5512485059582, 65.58512520602234, 3.3520505323593417, 25.868647843674747, 87.95146614708597, 6.369169355846264, 107.23264966564743, 13.5850886396894, 0.0, 49.84784311851168, 41.77833153313174, 11.767658884193855, 9.366858879570167, 22.310428918539156, 7.144627911609978, 8.914059493631353, 12.705063892483214, 27.59841625399006, 0.0, 34.46376099791654, 217.92434111765817, 18.94669877491385, 47.69096904504201, 48.456585242078916, 9.968750268156514, 45.39979940820777, 42.262227597401704, 86.20200119121029, 17.65360489750982, 11.441816139808088, 123.61969093889232, 123.29842966616953, 6.4305507876721535, 133.5794010756378, 1.7921170712811636, 23.76401406148112, 43.44292582833719, 13.89897024327308, 10.762843688369463, 22.804169485146815, 2.884993010339251, 111.3512860491222, 221.62892579548372, 39.56948635685481, 22.899724576179004, 53.563164341256005, 2.4546108765681076, 111.72103097432199, 12.91759403351966, 28.908437605252818, 103.24032728994236, 104.22361431251753, 183.63871579571247, 34.12230761329961, 114.07433222393782, 9.920509368394775, 190.96612012227047, 16.6020910427907, 66.13006632761268, 18.292385523333206, 56.903668991919254, 74.79456877922796, 64.5233206086969, 250.8797871247177, 16.265154145661313, 8.102807387606676, 9.47869071865908, 34.50977467323849, 43.70855943485238, 4.063341913744818, 94.88425954648828, 0.0, 12.278223407685312, 83.02747537448948, 17.083093449377248, 182.66698490536996, 60.648178895415846, 52.70071665958251, 33.120531848363115, 141.1031931601906, 6.923856283279282, 314.43101457883324, 1.971064025541018, 125.98838773624922, 86.81271327593639, 163.5940048747441, 0.0, 111.41353992051424, 10.179407994657256, 14.352317333275433, 17.452894727502823, 38.51105030215025, 73.43440829670553, 48.77530590273801, 63.336719464424505, 10.786850243014102, 30.38971936032233, 38.78021846100294, 39.47467686740108, 158.60094496907365, 60.43152563012309, 31.012071927060813, 389.1414123724363, 40.50230533544526, 117.90332565210109, 20.831943771660296, 19.664826414511353, 86.98718045821721, 21.764741256593283, 40.67888999021767, 308.16782791995774, 101.39749394278864, 136.31952610306556, 118.8147358639347, 69.29290346402159, 49.00256479771139, 26.049552506756307, 5.314324324128855, 173.47412291931587, 7.50979980437672, 10.576892824432386, 1.8075679137569887, 9.938252980720522, 38.22147908152029, 0.8186532070921686, 100.53378940256465, 0.0, 88.77466778136325, 142.56466539648642, 141.90425272846417, 57.06424996169076, 288.3921094755357, 242.53007839965818, 158.60540561533182, 467.4458346329489, 83.75427643540485, 9.364335759670851, 181.30531065661737, 7.55111967890314, 0.8191677258356339, 18.63028162753523, 397.4407853600383, 104.50581541327843, 116.06266405019956, 67.15517725571014, 61.710420780485244, 37.1495627808377, 240.59144512611854, 192.69892966605582, 266.74775692699194, 348.8972276396032, 23.541942974006506, 404.294373328241, 182.7988930858418, 191.98489694057056, 109.57712976940564, 11.076118607931365, 168.87920641342106, 170.08769911860782, 172.9283094110707, 71.5961723249637, 22.283569277375857, 7.264221750436261, 252.0042014450614, 54.47482689484653, 12.081637776950455, 319.96688914006245, 34.57465110698738, 183.77769475801745, 41.438227456426105, 76.78330404876448, 166.27844213896572, 371.73415043321273, 198.53180118788, 396.2289951900441, 121.46302132959258]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.9943401017896307, "mean_inference_ms": 10.712992977704621, "mean_action_processing_ms": 7.589541774579409, "mean_env_wait_ms": 2.5646505762539555, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036736726760864258, "StateBufferConnector_ms": 0.0035927295684814453, "ViewRequirementAgentConnector_ms": 0.09630024433135986}, "num_episodes": 22, "episode_return_max": 362.91650548972217, "episode_return_min": -138.9110134907137, "episode_return_mean": 127.4334244057157, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 43.88839164292071, "num_env_steps_trained_throughput_per_sec": 43.88839164292071, "timesteps_total": 72000, "num_env_steps_sampled_lifetime": 72000, "num_agent_steps_sampled_lifetime": 288000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 288000, "timers": {"training_iteration_time_ms": 370318.907, "restore_workers_time_ms": 0.013, "training_step_time_ms": 370318.864, "sample_time_ms": 1040.17, "learn_time_ms": 369264.867, "learn_throughput": 10.832, "synch_weights_time_ms": 11.223}, "counters": {"num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000}, "done": false, "training_iteration": 18, "trial_id": "cf3bb_00000", "date": "2024-08-20_08-36-55", "timestamp": 1724123215, "time_this_iter_s": 91.14333391189575, "time_total_s": 7479.801646471024, "pid": 25777, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39f827b80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 7479.801646471024, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 19.95079365079365, "ram_util_percent": 80.53015873015876}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8344796174023518, "cur_kl_coeff": 0.003125, "cur_lr": 0.00010000000000000003, "total_loss": 6.680918363288597, "policy_loss": -0.0008322304945005468, "vf_loss": 6.681744313366199, "vf_explained_var": -0.0004069739233249079, "kl": 0.0020102887097744764, "entropy": 1.5489370224967836, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 34965.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.1943244097015215, "cur_kl_coeff": 0.056250000000000015, "cur_lr": 0.00010000000000000003, "total_loss": 9.419429718501984, "policy_loss": -0.0076590788740388775, "vf_loss": 9.426109047541543, "vf_explained_var": 0.05665405518794186, "kl": 0.017417290758060946, "entropy": 1.547915101366699, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 34965.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 304000, "num_agent_steps_trained": 304000}, "env_runners": {"episode_reward_max": 442.5061266641901, "episode_reward_min": -138.9110134907137, "episode_reward_mean": 130.17622524042287, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -979.8755234696843, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 193.68134679290785, "predator_policy": 900.4500196915959}, "policy_reward_mean": {"prey_policy": -65.3442715770035, "predator_policy": 130.43238419721496}, "custom_metrics": {}, "hist_stats": {"episode_reward": [341.41959053610765, 88.69999999999872, 153.29999999999936, 143.29999999999941, 49.33196202055265, 278.33114840657936, 188.6999999999994, 37.600000000000264, 95.79999999999906, 195.77344112087883, 79.4, 129.69999999999908, 288.3304691952085, 255.69999999999973, 252.7313603322681, 256.8228693883681, 185.8065890366395, 115.59999999999943, 257.49999999999966, 50.974037689759044, -135.01553953507226, 322.4840313325805, 34.822279704642725, 173.69999999999948, 12.481036418249316, 280.668422792295, 29.537124425843732, 151.9999999999994, 244.40569635507612, 132.6442409846806, -14.41960413762087, 59.60000000000032, 131.49999999999895, 177.49999999999946, 45.300000000000395, 235.1308502465672, 246.8999999999993, 35.60000000000023, -50.70432595964524, 35.00000000000023, 15.653816296606124, 126.59999999999951, 254.78249820697536, 232.89999999999924, 82.70818911653754, 113.5999999999995, 118.51611652351592, 37.40000000000026, 190.24454392829173, 38.70000000000028, 106.3314899813582, 207.7999999999996, 14.258138879333618, 103.03903661576655, 46.71934168995194, 106.72691458373629, -128.97561240622116, 50.20000000000043, 101.4999999999985, 205.99999999999983, 32.02814446336296, 214.20633146800574, 199.09723851886503, 2.351792352582705, 10.344819485981258, -97.16826295373986, 12.891298445869522, 309.3, 118.37001327108064, 124.39999999999925, 160.99999999999972, 88.59999999999894, 46.03116409434871, 123.39999999999911, 233.12051462691775, 91.94166174416887, -138.9110134907137, 117.83582475971079, 284.2038366191787, 107.66986428784824, 26.000000000000043, 117.3415607756603, 213.88071117156903, 218.56118894566512, -40.0469470178652, 51.30303311638765, 325.4000000000003, 252.40062693348045, 103.16374829414421, -1.1513169390437188, 198.55997530915778, 29.260012643451873, -86.7471455813151, 442.5061266641901, 99.8999999999991, 193.1239670913237, 236.4623982394713, 312.400000000001, 311.29999999999995, 354.63120293274346], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [123.475419573572, 121.79661667541481, 16.029991776152254, 17.301458547483456, 74.6980313079124, -49.86226009652434, 1.0463951024901637, 113.15818386019177, -100.68270749624709, -96.90345108826362, 106.759876036537, 31.561320506732038, 18.007882928718825, 145.13598593851884, -24.842925828336924, 5.101029756726886, 8.437156311630503, 53.795830514853336, 12.787667451505763, 68.74949460991174, -158.82892579548374, -22.969486356854837, 59.050925204162475, -5.8138141215973285, 86.9721514858415, 87.18267585847687, 157.18240596648027, 56.691562394747336, 55.463750674998415, -10.19633194518986, -89.7933823925307, 128.8552283718867, -28.267754612041344, 90.07950205634867, -50.55618478077742, -41.412026384283614, 30.236311381436693, 142.84123676761754, -50.21016846824702, -30.514031613141128, -288.334027321345, -162.08461994714173, 106.18673078812452, 191.92933901118636, 5.410034401604262, -14.576220088859158, 110.39144056514763, 15.536658086255146, -74.09082975609171, -8.312393372148033, 163.6901993846093, 21.672524625510576, -145.1587772719006, -25.054176657003758, 27.84922025133673, 10.801884193664854, 91.88188982777604, -21.69991848125347, 67.74393073184052, -256.45456060927245, -81.12213467074206, -61.25692122866915, -40.11271327593622, -150.69400487474473, 61.64596145833664, -41.559501378850555, 148.32059200534275, 4.647682666724533, 23.767671391595066, -34.431616421247824, 32.63915136402375, 80.28198468310072, 89.0879401682316, 83.6884901243291, -12.989719360322274, -20.58021846100268, -121.99125558878725, -126.7886922073335, -42.73152563012284, -13.712071927060636, -173.25064858417912, -240.7392528270971, -22.78043988302725, 10.645170459266089, 76.71153954309754, 71.41895179114934, 142.3140794447379, 28.142289308451133, -342.66134370806355, 15.804210961854762, -3.162912267608531, -138.3713496993917, 33.00709653597827, -32.786448274194335, -8.149552506756192, 14.185675675871114, -92.0809343866105, 101.34155559120954, 8.323107175567582, 17.992432086243, 75.80998315192977, -17.638225232811607, 193.68134679290785, -87.23378940256472, -60.297008869017915, -14.21952003301217, -101.78691595759541, -79.6429655515883, -44.60126061622178, -254.13575713105334, -271.78923924708295, -22.619330184169975, -259.41220241342984, -420.76352106114496, 26.835664240329283, -167.30531065661816, 44.348880321097084, 48.78083227416459, 159.56971837246473, -369.64078536003836, -79.2597441077443, -109.28059089236983, 75.19241691767283, 10.148316514137882, 142.8264298054814, -221.47019919357277, -114.74802803899767, -342.34686620146726, -43.157637997658526, -318.93671312997003, -416.5069089842234, -267.7546203835996, -151.90899096051032, -136.76173730359758, 181.12388139206863, -51.779206413421065, -219.47121122891116, -5.174784029685918, -4.824739159527272, 35.34499755718778, 143.43577824956378, -241.70420144506173, -37.68464574635564, 59.728181074559025, -308.66688914006266, 0.15651298736119768, -169.87769475801824, 68.06177254357368, -25.139053564566694, 15.19782200375428, -220.0277704150494, -258.2965194618748, -367.60968926327723, -288.9933407470731, -53.65466930921605, -82.4117344203834, 70.71797645577306, 145.21518526675484, -489.2830048331088, -713.4221897087644, -201.21733513509514, -525.9988840506039, -979.8755234696843, -696.3996211507002, -152.44751326736022, 163.49118217530923, 141.86065485744837, -724.051834162149, -790.4106551589226, -846.9894436188911, 11.756788315969567, -91.54765667502379, 174.71226975441442, 132.9334225170826, -209.75593420483958, 130.9542891080714, -467.36547210644795, -367.8897991496999, -120.86424032718303, -47.85135453238128, -374.0574293597686, 179.13994082741235, -131.30898747484724, -222.5270378138908, -356.810410276974, -554.1975285808991, -775.6730631351412, 74.87678956254379, 9.76651725664478, -24.069506799423458, 67.2034000801621, -123.85999103831139, 110.77439521121735, -37.96284410233015, 55.08185084421518, 190.99999999999994, 136.56224525204226, 158.66629501044457, 179.6614052315196, 140.0145271027747], "policy_predator_policy_reward": [47.69096904504201, 48.456585242078916, 9.968750268156514, 45.39979940820777, 42.262227597401704, 86.20200119121029, 17.65360489750982, 11.441816139808088, 123.61969093889232, 123.29842966616953, 6.4305507876721535, 133.5794010756378, 1.7921170712811636, 23.76401406148112, 43.44292582833719, 13.89897024327308, 10.762843688369463, 22.804169485146815, 2.884993010339251, 111.3512860491222, 221.62892579548372, 39.56948635685481, 22.899724576179004, 53.563164341256005, 2.4546108765681076, 111.72103097432199, 12.91759403351966, 28.908437605252818, 103.24032728994236, 104.22361431251753, 183.63871579571247, 34.12230761329961, 114.07433222393782, 9.920509368394775, 190.96612012227047, 16.6020910427907, 66.13006632761268, 18.292385523333206, 56.903668991919254, 74.79456877922796, 64.5233206086969, 250.8797871247177, 16.265154145661313, 8.102807387606676, 9.47869071865908, 34.50977467323849, 43.70855943485238, 4.063341913744818, 94.88425954648828, 0.0, 12.278223407685312, 83.02747537448948, 17.083093449377248, 182.66698490536996, 60.648178895415846, 52.70071665958251, 33.120531848363115, 141.1031931601906, 6.923856283279282, 314.43101457883324, 1.971064025541018, 125.98838773624922, 86.81271327593639, 163.5940048747441, 0.0, 111.41353992051424, 10.179407994657256, 14.352317333275433, 17.452894727502823, 38.51105030215025, 73.43440829670553, 48.77530590273801, 63.336719464424505, 10.786850243014102, 30.38971936032233, 38.78021846100294, 39.47467686740108, 158.60094496907365, 60.43152563012309, 31.012071927060813, 389.1414123724363, 40.50230533544526, 117.90332565210109, 20.831943771660296, 19.664826414511353, 86.98718045821721, 21.764741256593283, 40.67888999021767, 308.16782791995774, 101.39749394278864, 136.31952610306556, 118.8147358639347, 69.29290346402159, 49.00256479771139, 26.049552506756307, 5.314324324128855, 173.47412291931587, 7.50979980437672, 10.576892824432386, 1.8075679137569887, 9.938252980720522, 38.22147908152029, 0.8186532070921686, 100.53378940256465, 0.0, 88.77466778136325, 142.56466539648642, 141.90425272846417, 57.06424996169076, 288.3921094755357, 242.53007839965818, 158.60540561533182, 467.4458346329489, 83.75427643540485, 9.364335759670851, 181.30531065661737, 7.55111967890314, 0.8191677258356339, 18.63028162753523, 397.4407853600383, 104.50581541327843, 116.06266405019956, 67.15517725571014, 61.710420780485244, 37.1495627808377, 240.59144512611854, 192.69892966605582, 266.74775692699194, 348.8972276396032, 23.541942974006506, 404.294373328241, 182.7988930858418, 191.98489694057056, 109.57712976940564, 11.076118607931365, 168.87920641342106, 170.08769911860782, 172.9283094110707, 71.5961723249637, 22.283569277375857, 7.264221750436261, 252.0042014450614, 54.47482689484653, 12.081637776950455, 319.96688914006245, 34.57465110698738, 183.77769475801745, 41.438227456426105, 76.78330404876448, 166.27844213896572, 371.73415043321273, 198.53180118788, 396.2289951900441, 121.46302132959258, 44.31144600371547, 209.5907824855949, 58.15942649945949, 10.111248397191085, 650.2669282412678, 660.1081305884533, 225.31733513509505, 527.8988840506038, 900.4500196915959, 893.1666857044488, 30.47067766380099, 172.3663645998191, 114.93575451173442, 685.8166137386315, 837.2780140804409, 760.0751376795076, 7.246244800417694, 123.84765667502322, 0.8996426618685051, 16.85466506663434, 172.44757490721773, 158.75469712303095, 518.906694997002, 419.5123245532903, 38.09791473469848, 129.46636318582122, 237.95348960401864, 155.52397423749517, 39.85855865851748, 343.23747927367225, 474.0452357937687, 350.2155574827895, 677.4380292344441, 465.8643710023429, 35.3640528905066, 78.83893665227231, 73.36561685698996, 176.41494119248316, 0.0, 163.65084713058408, 66.31814915578488, 0.0, 9.080571927406243, 6.990887810106841, 34.95527059844909, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.798196340393132, "mean_inference_ms": 10.373119085638415, "mean_action_processing_ms": 6.833653758328812, "mean_env_wait_ms": 2.371671418143404, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037310123443603516, "StateBufferConnector_ms": 0.0037003755569458008, "ViewRequirementAgentConnector_ms": 0.09530007839202881}, "num_episodes": 23, "episode_return_max": 442.5061266641901, "episode_return_min": -138.9110134907137, "episode_return_mean": 130.17622524042287, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 304000, "num_agent_steps_trained": 304000, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 43.5639492351943, "num_env_steps_trained_throughput_per_sec": 43.5639492351943, "timesteps_total": 76000, "num_env_steps_sampled_lifetime": 76000, "num_agent_steps_sampled_lifetime": 304000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 304000, "timers": {"training_iteration_time_ms": 276070.222, "restore_workers_time_ms": 0.013, "training_step_time_ms": 276070.181, "sample_time_ms": 1042.315, "learn_time_ms": 275014.347, "learn_throughput": 14.545, "synch_weights_time_ms": 11.06}, "counters": {"num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 304000, "num_agent_steps_trained": 304000}, "done": false, "training_iteration": 19, "trial_id": "cf3bb_00000", "date": "2024-08-20_08-38-27", "timestamp": 1724123307, "time_this_iter_s": 91.82251787185669, "time_total_s": 7571.62416434288, "pid": 25777, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39f821e50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 7571.62416434288, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 20.391935483870967, "ram_util_percent": 80.50483870967744}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.784228216225981, "cur_kl_coeff": 0.0015625, "cur_lr": 0.00010000000000000003, "total_loss": 2.438604686373756, "policy_loss": -0.0021779581468315823, "vf_loss": 2.4407640947235953, "vf_explained_var": 0.002637184801555815, "kl": 0.01187339808917863, "entropy": 1.5663218131141057, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 36855.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.154824142244758, "cur_kl_coeff": 0.056250000000000015, "cur_lr": 0.00010000000000000003, "total_loss": 9.029932472188637, "policy_loss": -0.0034655147968796355, "vf_loss": 9.032709666156265, "vf_explained_var": 0.1804319350177018, "kl": 0.01223722683683042, "entropy": 1.5272296614117093, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 36855.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000}, "env_runners": {"episode_reward_max": 442.5061266641901, "episode_reward_min": -138.9110134907137, "episode_reward_mean": 150.60680401203498, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -979.8755234696843, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 193.68134679290785, "predator_policy": 900.4500196915959}, "policy_reward_mean": {"prey_policy": -56.96823633628733, "predator_policy": 132.27163834230484}, "custom_metrics": {}, "hist_stats": {"episode_reward": [257.49999999999966, 50.974037689759044, -135.01553953507226, 322.4840313325805, 34.822279704642725, 173.69999999999948, 12.481036418249316, 280.668422792295, 29.537124425843732, 151.9999999999994, 244.40569635507612, 132.6442409846806, -14.41960413762087, 59.60000000000032, 131.49999999999895, 177.49999999999946, 45.300000000000395, 235.1308502465672, 246.8999999999993, 35.60000000000023, -50.70432595964524, 35.00000000000023, 15.653816296606124, 126.59999999999951, 254.78249820697536, 232.89999999999924, 82.70818911653754, 113.5999999999995, 118.51611652351592, 37.40000000000026, 190.24454392829173, 38.70000000000028, 106.3314899813582, 207.7999999999996, 14.258138879333618, 103.03903661576655, 46.71934168995194, 106.72691458373629, -128.97561240622116, 50.20000000000043, 101.4999999999985, 205.99999999999983, 32.02814446336296, 214.20633146800574, 199.09723851886503, 2.351792352582705, 10.344819485981258, -97.16826295373986, 12.891298445869522, 309.3, 118.37001327108064, 124.39999999999925, 160.99999999999972, 88.59999999999894, 46.03116409434871, 123.39999999999911, 233.12051462691775, 91.94166174416887, -138.9110134907137, 117.83582475971079, 284.2038366191787, 107.66986428784824, 26.000000000000043, 117.3415607756603, 213.88071117156903, 218.56118894566512, -40.0469470178652, 51.30303311638765, 325.4000000000003, 252.40062693348045, 103.16374829414421, -1.1513169390437188, 198.55997530915778, 29.260012643451873, -86.7471455813151, 442.5061266641901, 99.8999999999991, 193.1239670913237, 236.4623982394713, 312.400000000001, 311.29999999999995, 354.63120293274346, 352.09999999999997, 174.9999999999995, 316.73414648404963, 315.19999999999993, 211.7639301813658, 296.7998622606727, 312.3000000000003, 299.85238584753984, 322.40000000000026, 270.8298849327656, 317.9, 333.9479991115373, 175.2858274113054, 339.00000000000017, 127.24559621106513, 386.30000000000007, 345.9, 280.84567475751], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [30.236311381436693, 142.84123676761754, -50.21016846824702, -30.514031613141128, -288.334027321345, -162.08461994714173, 106.18673078812452, 191.92933901118636, 5.410034401604262, -14.576220088859158, 110.39144056514763, 15.536658086255146, -74.09082975609171, -8.312393372148033, 163.6901993846093, 21.672524625510576, -145.1587772719006, -25.054176657003758, 27.84922025133673, 10.801884193664854, 91.88188982777604, -21.69991848125347, 67.74393073184052, -256.45456060927245, -81.12213467074206, -61.25692122866915, -40.11271327593622, -150.69400487474473, 61.64596145833664, -41.559501378850555, 148.32059200534275, 4.647682666724533, 23.767671391595066, -34.431616421247824, 32.63915136402375, 80.28198468310072, 89.0879401682316, 83.6884901243291, -12.989719360322274, -20.58021846100268, -121.99125558878725, -126.7886922073335, -42.73152563012284, -13.712071927060636, -173.25064858417912, -240.7392528270971, -22.78043988302725, 10.645170459266089, 76.71153954309754, 71.41895179114934, 142.3140794447379, 28.142289308451133, -342.66134370806355, 15.804210961854762, -3.162912267608531, -138.3713496993917, 33.00709653597827, -32.786448274194335, -8.149552506756192, 14.185675675871114, -92.0809343866105, 101.34155559120954, 8.323107175567582, 17.992432086243, 75.80998315192977, -17.638225232811607, 193.68134679290785, -87.23378940256472, -60.297008869017915, -14.21952003301217, -101.78691595759541, -79.6429655515883, -44.60126061622178, -254.13575713105334, -271.78923924708295, -22.619330184169975, -259.41220241342984, -420.76352106114496, 26.835664240329283, -167.30531065661816, 44.348880321097084, 48.78083227416459, 159.56971837246473, -369.64078536003836, -79.2597441077443, -109.28059089236983, 75.19241691767283, 10.148316514137882, 142.8264298054814, -221.47019919357277, -114.74802803899767, -342.34686620146726, -43.157637997658526, -318.93671312997003, -416.5069089842234, -267.7546203835996, -151.90899096051032, -136.76173730359758, 181.12388139206863, -51.779206413421065, -219.47121122891116, -5.174784029685918, -4.824739159527272, 35.34499755718778, 143.43577824956378, -241.70420144506173, -37.68464574635564, 59.728181074559025, -308.66688914006266, 0.15651298736119768, -169.87769475801824, 68.06177254357368, -25.139053564566694, 15.19782200375428, -220.0277704150494, -258.2965194618748, -367.60968926327723, -288.9933407470731, -53.65466930921605, -82.4117344203834, 70.71797645577306, 145.21518526675484, -489.2830048331088, -713.4221897087644, -201.21733513509514, -525.9988840506039, -979.8755234696843, -696.3996211507002, -152.44751326736022, 163.49118217530923, 141.86065485744837, -724.051834162149, -790.4106551589226, -846.9894436188911, 11.756788315969567, -91.54765667502379, 174.71226975441442, 132.9334225170826, -209.75593420483958, 130.9542891080714, -467.36547210644795, -367.8897991496999, -120.86424032718303, -47.85135453238128, -374.0574293597686, 179.13994082741235, -131.30898747484724, -222.5270378138908, -356.810410276974, -554.1975285808991, -775.6730631351412, 74.87678956254379, 9.76651725664478, -24.069506799423458, 67.2034000801621, -123.85999103831139, 110.77439521121735, -37.96284410233015, 55.08185084421518, 190.99999999999994, 136.56224525204226, 158.66629501044457, 179.6614052315196, 140.0145271027747, 136.5542759188549, 170.692629106702, 10.169218722392577, 155.9, 165.73886387138225, -449.5732628077979, 71.72396030637901, 180.34765929846893, 42.2641106008328, -35.39352963561015, 137.2863343658172, 77.60659229033377, 182.89999999999992, 125.98589708599275, 182.16195189109436, -8.05676554447642, 186.5567639728456, 104.22734281670144, 182.6613475397029, -170.16695135446616, -25.07460784869695, 186.04653134121907, 159.21743618284836, 100.01076076013989, -102.89751214507925, 161.3, 179.42402716068472, 99.08495149514515, -299.98705956307214, -84.64041575455343, 178.49544468721564, 193.47238147367838, 119.12298812926274, 160.2733551126038, 56.39386825098812, 104.56975242886335], "policy_predator_policy_reward": [66.13006632761268, 18.292385523333206, 56.903668991919254, 74.79456877922796, 64.5233206086969, 250.8797871247177, 16.265154145661313, 8.102807387606676, 9.47869071865908, 34.50977467323849, 43.70855943485238, 4.063341913744818, 94.88425954648828, 0.0, 12.278223407685312, 83.02747537448948, 17.083093449377248, 182.66698490536996, 60.648178895415846, 52.70071665958251, 33.120531848363115, 141.1031931601906, 6.923856283279282, 314.43101457883324, 1.971064025541018, 125.98838773624922, 86.81271327593639, 163.5940048747441, 0.0, 111.41353992051424, 10.179407994657256, 14.352317333275433, 17.452894727502823, 38.51105030215025, 73.43440829670553, 48.77530590273801, 63.336719464424505, 10.786850243014102, 30.38971936032233, 38.78021846100294, 39.47467686740108, 158.60094496907365, 60.43152563012309, 31.012071927060813, 389.1414123724363, 40.50230533544526, 117.90332565210109, 20.831943771660296, 19.664826414511353, 86.98718045821721, 21.764741256593283, 40.67888999021767, 308.16782791995774, 101.39749394278864, 136.31952610306556, 118.8147358639347, 69.29290346402159, 49.00256479771139, 26.049552506756307, 5.314324324128855, 173.47412291931587, 7.50979980437672, 10.576892824432386, 1.8075679137569887, 9.938252980720522, 38.22147908152029, 0.8186532070921686, 100.53378940256465, 0.0, 88.77466778136325, 142.56466539648642, 141.90425272846417, 57.06424996169076, 288.3921094755357, 242.53007839965818, 158.60540561533182, 467.4458346329489, 83.75427643540485, 9.364335759670851, 181.30531065661737, 7.55111967890314, 0.8191677258356339, 18.63028162753523, 397.4407853600383, 104.50581541327843, 116.06266405019956, 67.15517725571014, 61.710420780485244, 37.1495627808377, 240.59144512611854, 192.69892966605582, 266.74775692699194, 348.8972276396032, 23.541942974006506, 404.294373328241, 182.7988930858418, 191.98489694057056, 109.57712976940564, 11.076118607931365, 168.87920641342106, 170.08769911860782, 172.9283094110707, 71.5961723249637, 22.283569277375857, 7.264221750436261, 252.0042014450614, 54.47482689484653, 12.081637776950455, 319.96688914006245, 34.57465110698738, 183.77769475801745, 41.438227456426105, 76.78330404876448, 166.27844213896572, 371.73415043321273, 198.53180118788, 396.2289951900441, 121.46302132959258, 44.31144600371547, 209.5907824855949, 58.15942649945949, 10.111248397191085, 650.2669282412678, 660.1081305884533, 225.31733513509505, 527.8988840506038, 900.4500196915959, 893.1666857044488, 30.47067766380099, 172.3663645998191, 114.93575451173442, 685.8166137386315, 837.2780140804409, 760.0751376795076, 7.246244800417694, 123.84765667502322, 0.8996426618685051, 16.85466506663434, 172.44757490721773, 158.75469712303095, 518.906694997002, 419.5123245532903, 38.09791473469848, 129.46636318582122, 237.95348960401864, 155.52397423749517, 39.85855865851748, 343.23747927367225, 474.0452357937687, 350.2155574827895, 677.4380292344441, 465.8643710023429, 35.3640528905066, 78.83893665227231, 73.36561685698996, 176.41494119248316, 0.0, 163.65084713058408, 66.31814915578488, 0.0, 9.080571927406243, 6.990887810106841, 34.95527059844909, 0.0, 41.69592507304732, 3.157169901395791, 8.93078127760739, 0.0, 167.85620366859476, 432.71234175187027, 53.87603969362106, 9.252340701531084, 15.131634052792622, 189.7617151633506, 50.55739039039855, 31.34954521412312, 0.0, 3.414102914007261, 115.25676554447618, 10.490433956445639, 6.419158367580337, 25.1967348428726, 29.663085184303533, 228.67240356322532, 148.9746078486969, 7.953468658780923, 67.23259249899152, 7.4872096695574895, 110.04452789912341, 6.8388116572611235, 1.475972839315309, 59.01504850485481, 149.72686917249885, 362.14620235619407, 12.504555312784346, 1.827618526321598, 42.777011870737276, 23.726644887396198, 81.08793292299141, 38.79412115466704]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.6815173126466076, "mean_inference_ms": 9.897951897917208, "mean_action_processing_ms": 6.492535209622706, "mean_env_wait_ms": 2.257452360398808, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037450790405273438, "StateBufferConnector_ms": 0.0034433603286743164, "ViewRequirementAgentConnector_ms": 0.09163296222686768}, "num_episodes": 18, "episode_return_max": 442.5061266641901, "episode_return_min": -138.9110134907137, "episode_return_mean": 150.60680401203498, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 6.985135016345855, "num_env_steps_trained_throughput_per_sec": 6.985135016345855, "timesteps_total": 80000, "num_env_steps_sampled_lifetime": 80000, "num_agent_steps_sampled_lifetime": 320000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 320000, "timers": {"training_iteration_time_ms": 282554.325, "restore_workers_time_ms": 0.013, "training_step_time_ms": 282554.284, "sample_time_ms": 1041.33, "learn_time_ms": 281498.582, "learn_throughput": 14.21, "synch_weights_time_ms": 11.89}, "counters": {"num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000}, "done": false, "training_iteration": 20, "trial_id": "cf3bb_00000", "date": "2024-08-20_08-47-59", "timestamp": 1724123879, "time_this_iter_s": 572.7212290763855, "time_total_s": 8144.345393419266, "pid": 25777, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39f81ec10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 8144.345393419266, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 20.953968253968256, "ram_util_percent": 80.54603174603176}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9484522744737289, "cur_kl_coeff": 0.0015625, "cur_lr": 0.00010000000000000003, "total_loss": 2.6494119734360426, "policy_loss": -0.005263037964573534, "vf_loss": 2.6546514666900434, "vf_explained_var": 0.004472517431097687, "kl": 0.01506927521979089, "entropy": 1.5535798614618008, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 38745.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.070745490704264, "cur_kl_coeff": 0.056250000000000015, "cur_lr": 0.00010000000000000003, "total_loss": 8.048108051693628, "policy_loss": -0.003961248153810779, "vf_loss": 8.0514074545058, "vf_explained_var": 0.14865527752215268, "kl": 0.01176651442383782, "entropy": 1.5546425595485345, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 38745.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000}, "env_runners": {"episode_reward_max": 442.5061266641901, "episode_reward_min": -138.9110134907137, "episode_reward_mean": 174.03832808677262, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -979.8755234696843, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 195.16926669344394, "predator_policy": 900.4500196915959}, "policy_reward_mean": {"prey_policy": -46.70733461156124, "predator_policy": 133.72649865494762}, "custom_metrics": {}, "hist_stats": {"episode_reward": [246.8999999999993, 35.60000000000023, -50.70432595964524, 35.00000000000023, 15.653816296606124, 126.59999999999951, 254.78249820697536, 232.89999999999924, 82.70818911653754, 113.5999999999995, 118.51611652351592, 37.40000000000026, 190.24454392829173, 38.70000000000028, 106.3314899813582, 207.7999999999996, 14.258138879333618, 103.03903661576655, 46.71934168995194, 106.72691458373629, -128.97561240622116, 50.20000000000043, 101.4999999999985, 205.99999999999983, 32.02814446336296, 214.20633146800574, 199.09723851886503, 2.351792352582705, 10.344819485981258, -97.16826295373986, 12.891298445869522, 309.3, 118.37001327108064, 124.39999999999925, 160.99999999999972, 88.59999999999894, 46.03116409434871, 123.39999999999911, 233.12051462691775, 91.94166174416887, -138.9110134907137, 117.83582475971079, 284.2038366191787, 107.66986428784824, 26.000000000000043, 117.3415607756603, 213.88071117156903, 218.56118894566512, -40.0469470178652, 51.30303311638765, 325.4000000000003, 252.40062693348045, 103.16374829414421, -1.1513169390437188, 198.55997530915778, 29.260012643451873, -86.7471455813151, 442.5061266641901, 99.8999999999991, 193.1239670913237, 236.4623982394713, 312.400000000001, 311.29999999999995, 354.63120293274346, 352.09999999999997, 174.9999999999995, 316.73414648404963, 315.19999999999993, 211.7639301813658, 296.7998622606727, 312.3000000000003, 299.85238584753984, 322.40000000000026, 270.8298849327656, 317.9, 333.9479991115373, 175.2858274113054, 339.00000000000017, 127.24559621106513, 386.30000000000007, 345.9, 280.84567475751, 298.6228931174404, 278.00000000000006, 204.02783462076073, 124.22153344542174, 362.0, 141.09999999999965, 352.9, 64.99760250666723, 197.99999999999937, 370.9000000000002, 373.7801771654715, 129.39554480883862, 167.69999999999953, 194.19999999999936, 286.36594238490716, 346.6000000000003, 286.6, 354.5534557012602], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [89.0879401682316, 83.6884901243291, -12.989719360322274, -20.58021846100268, -121.99125558878725, -126.7886922073335, -42.73152563012284, -13.712071927060636, -173.25064858417912, -240.7392528270971, -22.78043988302725, 10.645170459266089, 76.71153954309754, 71.41895179114934, 142.3140794447379, 28.142289308451133, -342.66134370806355, 15.804210961854762, -3.162912267608531, -138.3713496993917, 33.00709653597827, -32.786448274194335, -8.149552506756192, 14.185675675871114, -92.0809343866105, 101.34155559120954, 8.323107175567582, 17.992432086243, 75.80998315192977, -17.638225232811607, 193.68134679290785, -87.23378940256472, -60.297008869017915, -14.21952003301217, -101.78691595759541, -79.6429655515883, -44.60126061622178, -254.13575713105334, -271.78923924708295, -22.619330184169975, -259.41220241342984, -420.76352106114496, 26.835664240329283, -167.30531065661816, 44.348880321097084, 48.78083227416459, 159.56971837246473, -369.64078536003836, -79.2597441077443, -109.28059089236983, 75.19241691767283, 10.148316514137882, 142.8264298054814, -221.47019919357277, -114.74802803899767, -342.34686620146726, -43.157637997658526, -318.93671312997003, -416.5069089842234, -267.7546203835996, -151.90899096051032, -136.76173730359758, 181.12388139206863, -51.779206413421065, -219.47121122891116, -5.174784029685918, -4.824739159527272, 35.34499755718778, 143.43577824956378, -241.70420144506173, -37.68464574635564, 59.728181074559025, -308.66688914006266, 0.15651298736119768, -169.87769475801824, 68.06177254357368, -25.139053564566694, 15.19782200375428, -220.0277704150494, -258.2965194618748, -367.60968926327723, -288.9933407470731, -53.65466930921605, -82.4117344203834, 70.71797645577306, 145.21518526675484, -489.2830048331088, -713.4221897087644, -201.21733513509514, -525.9988840506039, -979.8755234696843, -696.3996211507002, -152.44751326736022, 163.49118217530923, 141.86065485744837, -724.051834162149, -790.4106551589226, -846.9894436188911, 11.756788315969567, -91.54765667502379, 174.71226975441442, 132.9334225170826, -209.75593420483958, 130.9542891080714, -467.36547210644795, -367.8897991496999, -120.86424032718303, -47.85135453238128, -374.0574293597686, 179.13994082741235, -131.30898747484724, -222.5270378138908, -356.810410276974, -554.1975285808991, -775.6730631351412, 74.87678956254379, 9.76651725664478, -24.069506799423458, 67.2034000801621, -123.85999103831139, 110.77439521121735, -37.96284410233015, 55.08185084421518, 190.99999999999994, 136.56224525204226, 158.66629501044457, 179.6614052315196, 140.0145271027747, 136.5542759188549, 170.692629106702, 10.169218722392577, 155.9, 165.73886387138225, -449.5732628077979, 71.72396030637901, 180.34765929846893, 42.2641106008328, -35.39352963561015, 137.2863343658172, 77.60659229033377, 182.89999999999992, 125.98589708599275, 182.16195189109436, -8.05676554447642, 186.5567639728456, 104.22734281670144, 182.6613475397029, -170.16695135446616, -25.07460784869695, 186.04653134121907, 159.21743618284836, 100.01076076013989, -102.89751214507925, 161.3, 179.42402716068472, 99.08495149514515, -299.98705956307214, -84.64041575455343, 178.49544468721564, 193.47238147367838, 119.12298812926274, 160.2733551126038, 56.39386825098812, 104.56975242886335, 35.57296197884395, 52.496247175311794, 167.4924647939157, 67.73647301496628, -6.749830047257774, 14.895480974908578, 12.278644498077231, -52.51173168407465, 131.5155819419415, 182.0733822440592, 16.821052751618126, -27.95976396784976, 165.6405278169831, 132.74214887471277, -152.56838254147655, -186.50390484182373, 122.86046516705336, -24.167121489147647, 195.16926669344394, 172.28200164299932, 178.56551823783232, 151.2925847795512, -183.27775323780136, -81.67148046216958, -20.685326472895937, 20.470446848703773, -175.94149380006647, 116.92696581874348, 100.47695169055616, 26.90583167459758, 120.76028810777179, 178.9865955107195, 34.13636967519621, 139.62090411446644, 177.53154020813673, 100.77426540331089], "policy_predator_policy_reward": [63.336719464424505, 10.786850243014102, 30.38971936032233, 38.78021846100294, 39.47467686740108, 158.60094496907365, 60.43152563012309, 31.012071927060813, 389.1414123724363, 40.50230533544526, 117.90332565210109, 20.831943771660296, 19.664826414511353, 86.98718045821721, 21.764741256593283, 40.67888999021767, 308.16782791995774, 101.39749394278864, 136.31952610306556, 118.8147358639347, 69.29290346402159, 49.00256479771139, 26.049552506756307, 5.314324324128855, 173.47412291931587, 7.50979980437672, 10.576892824432386, 1.8075679137569887, 9.938252980720522, 38.22147908152029, 0.8186532070921686, 100.53378940256465, 0.0, 88.77466778136325, 142.56466539648642, 141.90425272846417, 57.06424996169076, 288.3921094755357, 242.53007839965818, 158.60540561533182, 467.4458346329489, 83.75427643540485, 9.364335759670851, 181.30531065661737, 7.55111967890314, 0.8191677258356339, 18.63028162753523, 397.4407853600383, 104.50581541327843, 116.06266405019956, 67.15517725571014, 61.710420780485244, 37.1495627808377, 240.59144512611854, 192.69892966605582, 266.74775692699194, 348.8972276396032, 23.541942974006506, 404.294373328241, 182.7988930858418, 191.98489694057056, 109.57712976940564, 11.076118607931365, 168.87920641342106, 170.08769911860782, 172.9283094110707, 71.5961723249637, 22.283569277375857, 7.264221750436261, 252.0042014450614, 54.47482689484653, 12.081637776950455, 319.96688914006245, 34.57465110698738, 183.77769475801745, 41.438227456426105, 76.78330404876448, 166.27844213896572, 371.73415043321273, 198.53180118788, 396.2289951900441, 121.46302132959258, 44.31144600371547, 209.5907824855949, 58.15942649945949, 10.111248397191085, 650.2669282412678, 660.1081305884533, 225.31733513509505, 527.8988840506038, 900.4500196915959, 893.1666857044488, 30.47067766380099, 172.3663645998191, 114.93575451173442, 685.8166137386315, 837.2780140804409, 760.0751376795076, 7.246244800417694, 123.84765667502322, 0.8996426618685051, 16.85466506663434, 172.44757490721773, 158.75469712303095, 518.906694997002, 419.5123245532903, 38.09791473469848, 129.46636318582122, 237.95348960401864, 155.52397423749517, 39.85855865851748, 343.23747927367225, 474.0452357937687, 350.2155574827895, 677.4380292344441, 465.8643710023429, 35.3640528905066, 78.83893665227231, 73.36561685698996, 176.41494119248316, 0.0, 163.65084713058408, 66.31814915578488, 0.0, 9.080571927406243, 6.990887810106841, 34.95527059844909, 0.0, 41.69592507304732, 3.157169901395791, 8.93078127760739, 0.0, 167.85620366859476, 432.71234175187027, 53.87603969362106, 9.252340701531084, 15.131634052792622, 189.7617151633506, 50.55739039039855, 31.34954521412312, 0.0, 3.414102914007261, 115.25676554447618, 10.490433956445639, 6.419158367580337, 25.1967348428726, 29.663085184303533, 228.67240356322532, 148.9746078486969, 7.953468658780923, 67.23259249899152, 7.4872096695574895, 110.04452789912341, 6.8388116572611235, 1.475972839315309, 59.01504850485481, 149.72686917249885, 362.14620235619407, 12.504555312784346, 1.827618526321598, 42.777011870737276, 23.726644887396198, 81.08793292299141, 38.79412115466704, 197.8295437654514, 12.724140197833098, 20.507535206084317, 22.263526985033586, 57.57813631380662, 138.30404737930394, 86.91320448404676, 77.54141614737256, 38.48441805805847, 9.926617755940802, 107.17894724838187, 45.05976396784999, 13.259472183016882, 41.25785112528723, 332.11024529300187, 71.95964459696563, 43.16712148914792, 56.13953483294664, 1.1307333065560505, 2.3179983570006186, 19.410236178010766, 24.511837970077245, 381.4676600304398, 12.877118478369475, 38.48532647289619, 129.42955315129618, 190.14149380006566, 63.07303418125652, 107.4222869805977, 51.56087203915577, 37.63971189222813, 9.213404489280482, 63.5504651424356, 49.292261067901784, 43.187222270706606, 33.060427819105854]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.5800367779123854, "mean_inference_ms": 9.479803999007183, "mean_action_processing_ms": 6.189114802365631, "mean_env_wait_ms": 2.1562128302596926, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0043697357177734375, "StateBufferConnector_ms": 0.003256678581237793, "ViewRequirementAgentConnector_ms": 0.10445737838745117}, "num_episodes": 18, "episode_return_max": 442.5061266641901, "episode_return_min": -138.9110134907137, "episode_return_mean": 174.03832808677262, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 44.43097005149914, "num_env_steps_trained_throughput_per_sec": 44.43097005149914, "timesteps_total": 84000, "num_env_steps_sampled_lifetime": 84000, "num_agent_steps_sampled_lifetime": 336000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 336000, "timers": {"training_iteration_time_ms": 286049.914, "restore_workers_time_ms": 0.013, "training_step_time_ms": 286049.871, "sample_time_ms": 1102.742, "learn_time_ms": 284932.581, "learn_throughput": 14.038, "synch_weights_time_ms": 12.028}, "counters": {"num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000}, "done": false, "training_iteration": 21, "trial_id": "cf3bb_00000", "date": "2024-08-20_08-49-29", "timestamp": 1724123969, "time_this_iter_s": 90.06904101371765, "time_total_s": 8234.414434432983, "pid": 25777, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39f8219d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 8234.414434432983, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 21.00634920634921, "ram_util_percent": 79.89682539682542}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9216435063452948, "cur_kl_coeff": 0.0015625, "cur_lr": 0.00010000000000000003, "total_loss": 2.523204883822688, "policy_loss": -0.00363301604742273, "vf_loss": 2.526821212415342, "vf_explained_var": 0.001167637582809206, "kl": 0.010680885722764002, "entropy": 1.5371226598346044, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 40635.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.498753638068836, "cur_kl_coeff": 0.056250000000000015, "cur_lr": 0.00010000000000000003, "total_loss": 7.780322517667498, "policy_loss": -0.002845673382444869, "vf_loss": 7.782709819803793, "vf_explained_var": 0.32928327258932527, "kl": 0.008148921769617994, "entropy": 1.5675807101385935, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 40635.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 352000, "num_agent_steps_trained": 352000}, "env_runners": {"episode_reward_max": 442.5061266641901, "episode_reward_min": -138.9110134907137, "episode_reward_mean": 194.98281253416008, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -979.8755234696843, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 900.4500196915959}, "policy_reward_mean": {"prey_policy": -36.56401262964713, "predator_policy": 134.05541889672722}, "custom_metrics": {}, "hist_stats": {"episode_reward": [46.71934168995194, 106.72691458373629, -128.97561240622116, 50.20000000000043, 101.4999999999985, 205.99999999999983, 32.02814446336296, 214.20633146800574, 199.09723851886503, 2.351792352582705, 10.344819485981258, -97.16826295373986, 12.891298445869522, 309.3, 118.37001327108064, 124.39999999999925, 160.99999999999972, 88.59999999999894, 46.03116409434871, 123.39999999999911, 233.12051462691775, 91.94166174416887, -138.9110134907137, 117.83582475971079, 284.2038366191787, 107.66986428784824, 26.000000000000043, 117.3415607756603, 213.88071117156903, 218.56118894566512, -40.0469470178652, 51.30303311638765, 325.4000000000003, 252.40062693348045, 103.16374829414421, -1.1513169390437188, 198.55997530915778, 29.260012643451873, -86.7471455813151, 442.5061266641901, 99.8999999999991, 193.1239670913237, 236.4623982394713, 312.400000000001, 311.29999999999995, 354.63120293274346, 352.09999999999997, 174.9999999999995, 316.73414648404963, 315.19999999999993, 211.7639301813658, 296.7998622606727, 312.3000000000003, 299.85238584753984, 322.40000000000026, 270.8298849327656, 317.9, 333.9479991115373, 175.2858274113054, 339.00000000000017, 127.24559621106513, 386.30000000000007, 345.9, 280.84567475751, 298.6228931174404, 278.00000000000006, 204.02783462076073, 124.22153344542174, 362.0, 141.09999999999965, 352.9, 64.99760250666723, 197.99999999999937, 370.9000000000002, 373.7801771654715, 129.39554480883862, 167.69999999999953, 194.19999999999936, 286.36594238490716, 346.6000000000003, 286.6, 354.5534557012602, 329.5439098255697, 182.5999999999996, 235.74258912250662, -9.591863976210545, 323.69999999999993, 194.5999999999995, 230.48738639286861, 193.79999999999933, 192.54857103832785, 407.3760201927123, 193.5999999999994, 360.85662473268144, 179.61471099902744, 30.50000000000015, 198.49999999999935, 355.1, 191.69999999999933, 213.09999999999928], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-44.60126061622178, -254.13575713105334, -271.78923924708295, -22.619330184169975, -259.41220241342984, -420.76352106114496, 26.835664240329283, -167.30531065661816, 44.348880321097084, 48.78083227416459, 159.56971837246473, -369.64078536003836, -79.2597441077443, -109.28059089236983, 75.19241691767283, 10.148316514137882, 142.8264298054814, -221.47019919357277, -114.74802803899767, -342.34686620146726, -43.157637997658526, -318.93671312997003, -416.5069089842234, -267.7546203835996, -151.90899096051032, -136.76173730359758, 181.12388139206863, -51.779206413421065, -219.47121122891116, -5.174784029685918, -4.824739159527272, 35.34499755718778, 143.43577824956378, -241.70420144506173, -37.68464574635564, 59.728181074559025, -308.66688914006266, 0.15651298736119768, -169.87769475801824, 68.06177254357368, -25.139053564566694, 15.19782200375428, -220.0277704150494, -258.2965194618748, -367.60968926327723, -288.9933407470731, -53.65466930921605, -82.4117344203834, 70.71797645577306, 145.21518526675484, -489.2830048331088, -713.4221897087644, -201.21733513509514, -525.9988840506039, -979.8755234696843, -696.3996211507002, -152.44751326736022, 163.49118217530923, 141.86065485744837, -724.051834162149, -790.4106551589226, -846.9894436188911, 11.756788315969567, -91.54765667502379, 174.71226975441442, 132.9334225170826, -209.75593420483958, 130.9542891080714, -467.36547210644795, -367.8897991496999, -120.86424032718303, -47.85135453238128, -374.0574293597686, 179.13994082741235, -131.30898747484724, -222.5270378138908, -356.810410276974, -554.1975285808991, -775.6730631351412, 74.87678956254379, 9.76651725664478, -24.069506799423458, 67.2034000801621, -123.85999103831139, 110.77439521121735, -37.96284410233015, 55.08185084421518, 190.99999999999994, 136.56224525204226, 158.66629501044457, 179.6614052315196, 140.0145271027747, 136.5542759188549, 170.692629106702, 10.169218722392577, 155.9, 165.73886387138225, -449.5732628077979, 71.72396030637901, 180.34765929846893, 42.2641106008328, -35.39352963561015, 137.2863343658172, 77.60659229033377, 182.89999999999992, 125.98589708599275, 182.16195189109436, -8.05676554447642, 186.5567639728456, 104.22734281670144, 182.6613475397029, -170.16695135446616, -25.07460784869695, 186.04653134121907, 159.21743618284836, 100.01076076013989, -102.89751214507925, 161.3, 179.42402716068472, 99.08495149514515, -299.98705956307214, -84.64041575455343, 178.49544468721564, 193.47238147367838, 119.12298812926274, 160.2733551126038, 56.39386825098812, 104.56975242886335, 35.57296197884395, 52.496247175311794, 167.4924647939157, 67.73647301496628, -6.749830047257774, 14.895480974908578, 12.278644498077231, -52.51173168407465, 131.5155819419415, 182.0733822440592, 16.821052751618126, -27.95976396784976, 165.6405278169831, 132.74214887471277, -152.56838254147655, -186.50390484182373, 122.86046516705336, -24.167121489147647, 195.16926669344394, 172.28200164299932, 178.56551823783232, 151.2925847795512, -183.27775323780136, -81.67148046216958, -20.685326472895937, 20.470446848703773, -175.94149380006647, 116.92696581874348, 100.47695169055616, 26.90583167459758, 120.76028810777179, 178.9865955107195, 34.13636967519621, 139.62090411446644, 177.53154020813673, 100.77426540331089, 137.29628870256838, 154.02442557548082, -132.4884307398831, 164.68480904428299, 197.0876357032456, -130.7238805549621, -85.53305506574061, -152.65011358942897, 187.39999999999992, 53.45732457813669, 148.64707587415035, -51.424164307435646, -350.85012938792437, 105.71157776625185, 178.96395695609334, -275.6226225091514, -29.57291147886479, 152.38835530869375, 200.0, 82.68708254059784, 15.653371660916205, 134.05029616619896, 160.92274853880303, 139.2032890796363, -21.202169041659502, -147.0796778214679, -135.2138320577607, -30.776734710160227, -41.37876577641598, 146.3906904947261, 189.04486075364673, 105.11624482535933, -77.19389922550245, 137.51146590509714, -85.57849438561689, 194.27085601358803], "policy_predator_policy_reward": [57.06424996169076, 288.3921094755357, 242.53007839965818, 158.60540561533182, 467.4458346329489, 83.75427643540485, 9.364335759670851, 181.30531065661737, 7.55111967890314, 0.8191677258356339, 18.63028162753523, 397.4407853600383, 104.50581541327843, 116.06266405019956, 67.15517725571014, 61.710420780485244, 37.1495627808377, 240.59144512611854, 192.69892966605582, 266.74775692699194, 348.8972276396032, 23.541942974006506, 404.294373328241, 182.7988930858418, 191.98489694057056, 109.57712976940564, 11.076118607931365, 168.87920641342106, 170.08769911860782, 172.9283094110707, 71.5961723249637, 22.283569277375857, 7.264221750436261, 252.0042014450614, 54.47482689484653, 12.081637776950455, 319.96688914006245, 34.57465110698738, 183.77769475801745, 41.438227456426105, 76.78330404876448, 166.27844213896572, 371.73415043321273, 198.53180118788, 396.2289951900441, 121.46302132959258, 44.31144600371547, 209.5907824855949, 58.15942649945949, 10.111248397191085, 650.2669282412678, 660.1081305884533, 225.31733513509505, 527.8988840506038, 900.4500196915959, 893.1666857044488, 30.47067766380099, 172.3663645998191, 114.93575451173442, 685.8166137386315, 837.2780140804409, 760.0751376795076, 7.246244800417694, 123.84765667502322, 0.8996426618685051, 16.85466506663434, 172.44757490721773, 158.75469712303095, 518.906694997002, 419.5123245532903, 38.09791473469848, 129.46636318582122, 237.95348960401864, 155.52397423749517, 39.85855865851748, 343.23747927367225, 474.0452357937687, 350.2155574827895, 677.4380292344441, 465.8643710023429, 35.3640528905066, 78.83893665227231, 73.36561685698996, 176.41494119248316, 0.0, 163.65084713058408, 66.31814915578488, 0.0, 9.080571927406243, 6.990887810106841, 34.95527059844909, 0.0, 41.69592507304732, 3.157169901395791, 8.93078127760739, 0.0, 167.85620366859476, 432.71234175187027, 53.87603969362106, 9.252340701531084, 15.131634052792622, 189.7617151633506, 50.55739039039855, 31.34954521412312, 0.0, 3.414102914007261, 115.25676554447618, 10.490433956445639, 6.419158367580337, 25.1967348428726, 29.663085184303533, 228.67240356322532, 148.9746078486969, 7.953468658780923, 67.23259249899152, 7.4872096695574895, 110.04452789912341, 6.8388116572611235, 1.475972839315309, 59.01504850485481, 149.72686917249885, 362.14620235619407, 12.504555312784346, 1.827618526321598, 42.777011870737276, 23.726644887396198, 81.08793292299141, 38.79412115466704, 197.8295437654514, 12.724140197833098, 20.507535206084317, 22.263526985033586, 57.57813631380662, 138.30404737930394, 86.91320448404676, 77.54141614737256, 38.48441805805847, 9.926617755940802, 107.17894724838187, 45.05976396784999, 13.259472183016882, 41.25785112528723, 332.11024529300187, 71.95964459696563, 43.16712148914792, 56.13953483294664, 1.1307333065560505, 2.3179983570006186, 19.410236178010766, 24.511837970077245, 381.4676600304398, 12.877118478369475, 38.48532647289619, 129.42955315129618, 190.14149380006566, 63.07303418125652, 107.4222869805977, 51.56087203915577, 37.63971189222813, 9.213404489280482, 63.5504651424356, 49.292261067901784, 43.187222270706606, 33.060427819105854, 28.696882288844208, 9.52631325867632, 143.58843073988277, 6.815190955716993, 47.20360023752776, 122.17523373669543, 48.60959892110574, 179.9817057578526, 0.0, 82.84267542186312, 30.75292412584965, 66.62416430743576, 154.29744071374944, 321.3284973007925, 3.5360430439066364, 286.922622509154, 47.37291147886504, 22.36021572963469, 64.62674864079709, 60.06218901131735, 3.946628339083759, 39.94970383380106, 44.94778226961896, 15.782804844623131, 271.9336861526943, 75.96287170946076, 7.56236088519129, 188.92820588272946, 58.87876577641623, 34.609309505273906, 5.9551392463532755, 54.98375517464068, 89.99389922550175, 41.38853409490287, 101.67849438561598, 2.7291439864119607]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4891398489066137, "mean_inference_ms": 9.10478413148047, "mean_action_processing_ms": 5.916579645773511, "mean_env_wait_ms": 2.0653180335191426, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004313945770263672, "StateBufferConnector_ms": 0.0032221078872680664, "ViewRequirementAgentConnector_ms": 0.10415339469909668}, "num_episodes": 18, "episode_return_max": 442.5061266641901, "episode_return_min": -138.9110134907137, "episode_return_mean": 194.98281253416008, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 352000, "num_agent_steps_trained": 352000, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 91.6035459184913, "num_env_steps_trained_throughput_per_sec": 91.6035459184913, "timesteps_total": 88000, "num_env_steps_sampled_lifetime": 88000, "num_agent_steps_sampled_lifetime": 352000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 352000, "timers": {"training_iteration_time_ms": 216683.264, "restore_workers_time_ms": 0.014, "training_step_time_ms": 216683.221, "sample_time_ms": 1112.278, "learn_time_ms": 215557.208, "learn_throughput": 18.557, "synch_weights_time_ms": 11.831}, "counters": {"num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 352000, "num_agent_steps_trained": 352000}, "done": false, "training_iteration": 22, "trial_id": "cf3bb_00000", "date": "2024-08-20_08-50-13", "timestamp": 1724124013, "time_this_iter_s": 43.66973900794983, "time_total_s": 8278.084173440933, "pid": 25777, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39f827280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 8278.084173440933, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 18.89516129032258, "ram_util_percent": 79.98225806451612}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.910232405719303, "cur_kl_coeff": 0.0015625, "cur_lr": 0.00010000000000000003, "total_loss": 3.9895556875006863, "policy_loss": -0.0032540999308583282, "vf_loss": 3.9927904094968523, "vf_explained_var": 0.007590571408549314, "kl": 0.012402984815643428, "entropy": 1.558032416918921, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 42525.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.592213789700832, "cur_kl_coeff": 0.056250000000000015, "cur_lr": 0.00010000000000000003, "total_loss": 9.099475553805235, "policy_loss": -0.0038600775045490574, "vf_loss": 9.103082328877122, "vf_explained_var": 0.20557539119291557, "kl": 0.004503165181595449, "entropy": 1.5595354160303792, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 42525.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 368000, "num_agent_steps_trained": 368000}, "env_runners": {"episode_reward_max": 442.5061266641901, "episode_reward_min": -86.7471455813151, "episode_reward_mean": 230.59250448422338, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -979.8755234696843, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 900.4500196915959}, "policy_reward_mean": {"prey_policy": 4.061884138158087, "predator_policy": 111.23436810395364}, "custom_metrics": {}, "hist_stats": {"episode_reward": [117.3415607756603, 213.88071117156903, 218.56118894566512, -40.0469470178652, 51.30303311638765, 325.4000000000003, 252.40062693348045, 103.16374829414421, -1.1513169390437188, 198.55997530915778, 29.260012643451873, -86.7471455813151, 442.5061266641901, 99.8999999999991, 193.1239670913237, 236.4623982394713, 312.400000000001, 311.29999999999995, 354.63120293274346, 352.09999999999997, 174.9999999999995, 316.73414648404963, 315.19999999999993, 211.7639301813658, 296.7998622606727, 312.3000000000003, 299.85238584753984, 322.40000000000026, 270.8298849327656, 317.9, 333.9479991115373, 175.2858274113054, 339.00000000000017, 127.24559621106513, 386.30000000000007, 345.9, 280.84567475751, 298.6228931174404, 278.00000000000006, 204.02783462076073, 124.22153344542174, 362.0, 141.09999999999965, 352.9, 64.99760250666723, 197.99999999999937, 370.9000000000002, 373.7801771654715, 129.39554480883862, 167.69999999999953, 194.19999999999936, 286.36594238490716, 346.6000000000003, 286.6, 354.5534557012602, 329.5439098255697, 182.5999999999996, 235.74258912250662, -9.591863976210545, 323.69999999999993, 194.5999999999995, 230.48738639286861, 193.79999999999933, 192.54857103832785, 407.3760201927123, 193.5999999999994, 360.85662473268144, 179.61471099902744, 30.50000000000015, 198.49999999999935, 355.1, 191.69999999999933, 213.09999999999928, 191.7999999999994, 196.08438777863097, 211.4999999999994, 356.69999999999993, 295.9999999999998, 231.69999999999945, 156.09999999999965, 141.40000000000003, 195.92479055899037, 178.49999999999991, 320.1, 257.9999999999997, 147.89999999999964, 113.5705559965428, 23.400000000000063, 301.460072088104, 338.5, 326.9, 308.9999999999999, 159.0999999999999, 190.48154598564085, 175.59999999999948, 302.5127867231837, 231.53663011074002, 303.4, 19.782297325429774, 332.9], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-979.8755234696843, -696.3996211507002, -152.44751326736022, 163.49118217530923, 141.86065485744837, -724.051834162149, -790.4106551589226, -846.9894436188911, 11.756788315969567, -91.54765667502379, 174.71226975441442, 132.9334225170826, -209.75593420483958, 130.9542891080714, -467.36547210644795, -367.8897991496999, -120.86424032718303, -47.85135453238128, -374.0574293597686, 179.13994082741235, -131.30898747484724, -222.5270378138908, -356.810410276974, -554.1975285808991, -775.6730631351412, 74.87678956254379, 9.76651725664478, -24.069506799423458, 67.2034000801621, -123.85999103831139, 110.77439521121735, -37.96284410233015, 55.08185084421518, 190.99999999999994, 136.56224525204226, 158.66629501044457, 179.6614052315196, 140.0145271027747, 136.5542759188549, 170.692629106702, 10.169218722392577, 155.9, 165.73886387138225, -449.5732628077979, 71.72396030637901, 180.34765929846893, 42.2641106008328, -35.39352963561015, 137.2863343658172, 77.60659229033377, 182.89999999999992, 125.98589708599275, 182.16195189109436, -8.05676554447642, 186.5567639728456, 104.22734281670144, 182.6613475397029, -170.16695135446616, -25.07460784869695, 186.04653134121907, 159.21743618284836, 100.01076076013989, -102.89751214507925, 161.3, 179.42402716068472, 99.08495149514515, -299.98705956307214, -84.64041575455343, 178.49544468721564, 193.47238147367838, 119.12298812926274, 160.2733551126038, 56.39386825098812, 104.56975242886335, 35.57296197884395, 52.496247175311794, 167.4924647939157, 67.73647301496628, -6.749830047257774, 14.895480974908578, 12.278644498077231, -52.51173168407465, 131.5155819419415, 182.0733822440592, 16.821052751618126, -27.95976396784976, 165.6405278169831, 132.74214887471277, -152.56838254147655, -186.50390484182373, 122.86046516705336, -24.167121489147647, 195.16926669344394, 172.28200164299932, 178.56551823783232, 151.2925847795512, -183.27775323780136, -81.67148046216958, -20.685326472895937, 20.470446848703773, -175.94149380006647, 116.92696581874348, 100.47695169055616, 26.90583167459758, 120.76028810777179, 178.9865955107195, 34.13636967519621, 139.62090411446644, 177.53154020813673, 100.77426540331089, 137.29628870256838, 154.02442557548082, -132.4884307398831, 164.68480904428299, 197.0876357032456, -130.7238805549621, -85.53305506574061, -152.65011358942897, 187.39999999999992, 53.45732457813669, 148.64707587415035, -51.424164307435646, -350.85012938792437, 105.71157776625185, 178.96395695609334, -275.6226225091514, -29.57291147886479, 152.38835530869375, 200.0, 82.68708254059784, 15.653371660916205, 134.05029616619896, 160.92274853880303, 139.2032890796363, -21.202169041659502, -147.0796778214679, -135.2138320577607, -30.776734710160227, -41.37876577641598, 146.3906904947261, 189.04486075364673, 105.11624482535933, -77.19389922550245, 137.51146590509714, -85.57849438561689, 194.27085601358803, 95.7326496127455, 17.520563865322334, 107.49369324078395, -111.01348144387164, -236.51840234196587, 200.0, 133.4550549558392, 182.7688144689353, -129.5078588713573, 174.3949206746155, -17.438248889518235, 171.4208443187679, -233.30161467722297, 19.215126604149162, -15.349366843745486, -204.33199854458246, -27.308945323109413, 34.501756534492074, 168.25698944945992, -407.135336378862, 151.37530388340835, 109.15481391523771, -42.18525113692513, 161.2417470060256, 5.381706927960963, 1.3501417862267937, -175.5581744486066, -62.898354798971184, -227.75868067212147, -43.17313867849169, 104.29605952553071, 158.9413618578073, 196.2398408800628, 139.09918447958154, 31.349132101978185, 141.54197033636981, 93.89976677370976, 184.81994026641513, -103.78516152308164, 84.09985854732938, -18.61632241187084, -67.83272140516036, 82.19708897210016, -44.450444268411275, 136.29657114669752, 74.8113246949163, 59.91690890114589, 4.870381097004126, 78.53588332047536, 77.42736080487971, -176.62246444975415, -167.4503002093436, 180.5024980961938, 24.35372111426544], "policy_predator_policy_reward": [900.4500196915959, 893.1666857044488, 30.47067766380099, 172.3663645998191, 114.93575451173442, 685.8166137386315, 837.2780140804409, 760.0751376795076, 7.246244800417694, 123.84765667502322, 0.8996426618685051, 16.85466506663434, 172.44757490721773, 158.75469712303095, 518.906694997002, 419.5123245532903, 38.09791473469848, 129.46636318582122, 237.95348960401864, 155.52397423749517, 39.85855865851748, 343.23747927367225, 474.0452357937687, 350.2155574827895, 677.4380292344441, 465.8643710023429, 35.3640528905066, 78.83893665227231, 73.36561685698996, 176.41494119248316, 0.0, 163.65084713058408, 66.31814915578488, 0.0, 9.080571927406243, 6.990887810106841, 34.95527059844909, 0.0, 41.69592507304732, 3.157169901395791, 8.93078127760739, 0.0, 167.85620366859476, 432.71234175187027, 53.87603969362106, 9.252340701531084, 15.131634052792622, 189.7617151633506, 50.55739039039855, 31.34954521412312, 0.0, 3.414102914007261, 115.25676554447618, 10.490433956445639, 6.419158367580337, 25.1967348428726, 29.663085184303533, 228.67240356322532, 148.9746078486969, 7.953468658780923, 67.23259249899152, 7.4872096695574895, 110.04452789912341, 6.8388116572611235, 1.475972839315309, 59.01504850485481, 149.72686917249885, 362.14620235619407, 12.504555312784346, 1.827618526321598, 42.777011870737276, 23.726644887396198, 81.08793292299141, 38.79412115466704, 197.8295437654514, 12.724140197833098, 20.507535206084317, 22.263526985033586, 57.57813631380662, 138.30404737930394, 86.91320448404676, 77.54141614737256, 38.48441805805847, 9.926617755940802, 107.17894724838187, 45.05976396784999, 13.259472183016882, 41.25785112528723, 332.11024529300187, 71.95964459696563, 43.16712148914792, 56.13953483294664, 1.1307333065560505, 2.3179983570006186, 19.410236178010766, 24.511837970077245, 381.4676600304398, 12.877118478369475, 38.48532647289619, 129.42955315129618, 190.14149380006566, 63.07303418125652, 107.4222869805977, 51.56087203915577, 37.63971189222813, 9.213404489280482, 63.5504651424356, 49.292261067901784, 43.187222270706606, 33.060427819105854, 28.696882288844208, 9.52631325867632, 143.58843073988277, 6.815190955716993, 47.20360023752776, 122.17523373669543, 48.60959892110574, 179.9817057578526, 0.0, 82.84267542186312, 30.75292412584965, 66.62416430743576, 154.29744071374944, 321.3284973007925, 3.5360430439066364, 286.922622509154, 47.37291147886504, 22.36021572963469, 64.62674864079709, 60.06218901131735, 3.946628339083759, 39.94970383380106, 44.94778226961896, 15.782804844623131, 271.9336861526943, 75.96287170946076, 7.56236088519129, 188.92820588272946, 58.87876577641623, 34.609309505273906, 5.9551392463532755, 54.98375517464068, 89.99389922550175, 41.38853409490287, 101.67849438561598, 2.7291439864119607, 76.2673503872545, 2.279436134677648, 0.0, 199.60417598171856, 248.0184023419652, 0.0, 39.54494504416082, 0.9311855310646562, 249.10785887135722, 2.0050793253843575, 68.03824888951817, 9.679155681232027, 243.10161467722241, 127.08487339585083, 158.3179283086798, 202.76343707964793, 175.13656712515294, 13.59541222245474, 366.98835170871456, 50.38999522068746, 42.440765126353824, 17.129117075000085, 118.18525113692489, 20.75825299397439, 123.91829307203896, 17.249858213773166, 145.5185644769239, 206.50852076719679, 235.85868067212115, 58.4731386784919, 29.957810628711446, 8.264840076054593, 1.7601591199372186, 1.4008155204184616, 123.05086789802178, 30.958029663630214, 29.36900637880323, 0.9112865810719528, 1.7679822038698607, 177.01732077188228, 67.11646482319033, 209.81412497948165, 76.00291102789983, 61.85044426841152, 14.705762241362681, 76.69912864020719, 38.894132256136714, 127.85520785645323, 135.5777289004343, 11.859026974210542, 225.24974962047446, 138.60531236405322, 9.597501903806227, 118.44627888573456]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.5554691787947728, "mean_inference_ms": 8.247828511619094, "mean_action_processing_ms": 5.568124412909508, "mean_env_wait_ms": 2.131300025924591, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004609465599060059, "StateBufferConnector_ms": 0.0032747983932495117, "ViewRequirementAgentConnector_ms": 0.10533690452575684}, "num_episodes": 27, "episode_return_max": 442.5061266641901, "episode_return_min": -86.7471455813151, "episode_return_mean": 230.59250448422338, "episodes_this_iter": 27}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 368000, "num_agent_steps_trained": 368000, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 58.990673464996696, "num_env_steps_trained_throughput_per_sec": 58.990673464996696, "timesteps_total": 92000, "num_env_steps_sampled_lifetime": 92000, "num_agent_steps_sampled_lifetime": 368000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 368000, "timers": {"training_iteration_time_ms": 218925.338, "restore_workers_time_ms": 0.014, "training_step_time_ms": 218925.296, "sample_time_ms": 1103.983, "learn_time_ms": 217807.856, "learn_throughput": 18.365, "synch_weights_time_ms": 11.767}, "counters": {"num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 368000, "num_agent_steps_trained": 368000}, "done": false, "training_iteration": 23, "trial_id": "cf3bb_00000", "date": "2024-08-20_08-51-21", "timestamp": 1724124081, "time_this_iter_s": 67.81084179878235, "time_total_s": 8345.895015239716, "pid": 25777, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39f77d670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 8345.895015239716, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 18.827419354838714, "ram_util_percent": 80.06290322580645}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.654257020062555, "cur_kl_coeff": 0.0015625, "cur_lr": 0.00010000000000000003, "total_loss": 5.922164192149248, "policy_loss": -0.007424572515227492, "vf_loss": 5.92954705783299, "vf_explained_var": 0.0029770903171054902, "kl": 0.0266926911229615, "entropy": 1.5406602312648108, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 44415.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.284455786574455, "cur_kl_coeff": 0.028125000000000008, "cur_lr": 0.00010000000000000003, "total_loss": 9.164099586325348, "policy_loss": -0.004021584364048467, "vf_loss": 9.167778016650487, "vf_explained_var": 0.24616513586548902, "kl": 0.012200455256291898, "entropy": 1.547378042576805, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 44415.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000}, "env_runners": {"episode_reward_max": 407.3760201927123, "episode_reward_min": -9.591863976210545, "episode_reward_mean": 235.86139116019743, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -480.67028975246603, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 500.7451044278085}, "policy_reward_mean": {"prey_policy": 27.384731091931254, "predator_policy": 90.54596448816751}, "custom_metrics": {}, "hist_stats": {"episode_reward": [354.63120293274346, 352.09999999999997, 174.9999999999995, 316.73414648404963, 315.19999999999993, 211.7639301813658, 296.7998622606727, 312.3000000000003, 299.85238584753984, 322.40000000000026, 270.8298849327656, 317.9, 333.9479991115373, 175.2858274113054, 339.00000000000017, 127.24559621106513, 386.30000000000007, 345.9, 280.84567475751, 298.6228931174404, 278.00000000000006, 204.02783462076073, 124.22153344542174, 362.0, 141.09999999999965, 352.9, 64.99760250666723, 197.99999999999937, 370.9000000000002, 373.7801771654715, 129.39554480883862, 167.69999999999953, 194.19999999999936, 286.36594238490716, 346.6000000000003, 286.6, 354.5534557012602, 329.5439098255697, 182.5999999999996, 235.74258912250662, -9.591863976210545, 323.69999999999993, 194.5999999999995, 230.48738639286861, 193.79999999999933, 192.54857103832785, 407.3760201927123, 193.5999999999994, 360.85662473268144, 179.61471099902744, 30.50000000000015, 198.49999999999935, 355.1, 191.69999999999933, 213.09999999999928, 191.7999999999994, 196.08438777863097, 211.4999999999994, 356.69999999999993, 295.9999999999998, 231.69999999999945, 156.09999999999965, 141.40000000000003, 195.92479055899037, 178.49999999999991, 320.1, 257.9999999999997, 147.89999999999964, 113.5705559965428, 23.400000000000063, 301.460072088104, 338.5, 326.9, 308.9999999999999, 159.0999999999999, 190.48154598564085, 175.59999999999948, 302.5127867231837, 231.53663011074002, 303.4, 19.782297325429774, 332.9, 255.99774464177452, 159.24154359299828, 250.47427719437758, 152.73486659076167, 264.87377620927566, 137.5999999999999, 145.254427466009, 384.0, 274.927365255866, 160.00727873578467, 279.43716249055353, 159.19999999999987, 99.49994846201923, 151.36083841315522, 204.1999999999996, 52.199432055263316, 170.32082879617732, 203.17711733966684], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [179.6614052315196, 140.0145271027747, 136.5542759188549, 170.692629106702, 10.169218722392577, 155.9, 165.73886387138225, -449.5732628077979, 71.72396030637901, 180.34765929846893, 42.2641106008328, -35.39352963561015, 137.2863343658172, 77.60659229033377, 182.89999999999992, 125.98589708599275, 182.16195189109436, -8.05676554447642, 186.5567639728456, 104.22734281670144, 182.6613475397029, -170.16695135446616, -25.07460784869695, 186.04653134121907, 159.21743618284836, 100.01076076013989, -102.89751214507925, 161.3, 179.42402716068472, 99.08495149514515, -299.98705956307214, -84.64041575455343, 178.49544468721564, 193.47238147367838, 119.12298812926274, 160.2733551126038, 56.39386825098812, 104.56975242886335, 35.57296197884395, 52.496247175311794, 167.4924647939157, 67.73647301496628, -6.749830047257774, 14.895480974908578, 12.278644498077231, -52.51173168407465, 131.5155819419415, 182.0733822440592, 16.821052751618126, -27.95976396784976, 165.6405278169831, 132.74214887471277, -152.56838254147655, -186.50390484182373, 122.86046516705336, -24.167121489147647, 195.16926669344394, 172.28200164299932, 178.56551823783232, 151.2925847795512, -183.27775323780136, -81.67148046216958, -20.685326472895937, 20.470446848703773, -175.94149380006647, 116.92696581874348, 100.47695169055616, 26.90583167459758, 120.76028810777179, 178.9865955107195, 34.13636967519621, 139.62090411446644, 177.53154020813673, 100.77426540331089, 137.29628870256838, 154.02442557548082, -132.4884307398831, 164.68480904428299, 197.0876357032456, -130.7238805549621, -85.53305506574061, -152.65011358942897, 187.39999999999992, 53.45732457813669, 148.64707587415035, -51.424164307435646, -350.85012938792437, 105.71157776625185, 178.96395695609334, -275.6226225091514, -29.57291147886479, 152.38835530869375, 200.0, 82.68708254059784, 15.653371660916205, 134.05029616619896, 160.92274853880303, 139.2032890796363, -21.202169041659502, -147.0796778214679, -135.2138320577607, -30.776734710160227, -41.37876577641598, 146.3906904947261, 189.04486075364673, 105.11624482535933, -77.19389922550245, 137.51146590509714, -85.57849438561689, 194.27085601358803, 95.7326496127455, 17.520563865322334, 107.49369324078395, -111.01348144387164, -236.51840234196587, 200.0, 133.4550549558392, 182.7688144689353, -129.5078588713573, 174.3949206746155, -17.438248889518235, 171.4208443187679, -233.30161467722297, 19.215126604149162, -15.349366843745486, -204.33199854458246, -27.308945323109413, 34.501756534492074, 168.25698944945992, -407.135336378862, 151.37530388340835, 109.15481391523771, -42.18525113692513, 161.2417470060256, 5.381706927960963, 1.3501417862267937, -175.5581744486066, -62.898354798971184, -227.75868067212147, -43.17313867849169, 104.29605952553071, 158.9413618578073, 196.2398408800628, 139.09918447958154, 31.349132101978185, 141.54197033636981, 93.89976677370976, 184.81994026641513, -103.78516152308164, 84.09985854732938, -18.61632241187084, -67.83272140516036, 82.19708897210016, -44.450444268411275, 136.29657114669752, 74.8113246949163, 59.91690890114589, 4.870381097004126, 78.53588332047536, 77.42736080487971, -176.62246444975415, -167.4503002093436, 180.5024980961938, 24.35372111426544, 132.4412487442787, -151.62752690316736, 75.44514701281756, -480.67028975246603, 14.954907162515568, 2.739046646828399, -393.91730331730685, 31.439112258651214, -92.57680309977823, 153.5353074340732, -292.2052969451003, 82.90203657051302, 48.19099980747307, -270.843644223197, 192.06165727132378, 174.1676629937839, 200.0, -252.64095558922833, -62.530159716593126, 93.2022980913007, 126.99198338965161, 33.06816201014706, 119.81421658353861, -314.26163504831, -86.58286334393466, -178.75035305705063, -190.60125360193675, 0.6749746564405683, 176.0025315624591, -163.60927638345183, -109.27721580876076, -294.22769939563057, -132.51232225626222, 78.1819176022041, 42.21319461892828, -3.7582208520092575], "policy_predator_policy_reward": [34.95527059844909, 0.0, 41.69592507304732, 3.157169901395791, 8.93078127760739, 0.0, 167.85620366859476, 432.71234175187027, 53.87603969362106, 9.252340701531084, 15.131634052792622, 189.7617151633506, 50.55739039039855, 31.34954521412312, 0.0, 3.414102914007261, 115.25676554447618, 10.490433956445639, 6.419158367580337, 25.1967348428726, 29.663085184303533, 228.67240356322532, 148.9746078486969, 7.953468658780923, 67.23259249899152, 7.4872096695574895, 110.04452789912341, 6.8388116572611235, 1.475972839315309, 59.01504850485481, 149.72686917249885, 362.14620235619407, 12.504555312784346, 1.827618526321598, 42.777011870737276, 23.726644887396198, 81.08793292299141, 38.79412115466704, 197.8295437654514, 12.724140197833098, 20.507535206084317, 22.263526985033586, 57.57813631380662, 138.30404737930394, 86.91320448404676, 77.54141614737256, 38.48441805805847, 9.926617755940802, 107.17894724838187, 45.05976396784999, 13.259472183016882, 41.25785112528723, 332.11024529300187, 71.95964459696563, 43.16712148914792, 56.13953483294664, 1.1307333065560505, 2.3179983570006186, 19.410236178010766, 24.511837970077245, 381.4676600304398, 12.877118478369475, 38.48532647289619, 129.42955315129618, 190.14149380006566, 63.07303418125652, 107.4222869805977, 51.56087203915577, 37.63971189222813, 9.213404489280482, 63.5504651424356, 49.292261067901784, 43.187222270706606, 33.060427819105854, 28.696882288844208, 9.52631325867632, 143.58843073988277, 6.815190955716993, 47.20360023752776, 122.17523373669543, 48.60959892110574, 179.9817057578526, 0.0, 82.84267542186312, 30.75292412584965, 66.62416430743576, 154.29744071374944, 321.3284973007925, 3.5360430439066364, 286.922622509154, 47.37291147886504, 22.36021572963469, 64.62674864079709, 60.06218901131735, 3.946628339083759, 39.94970383380106, 44.94778226961896, 15.782804844623131, 271.9336861526943, 75.96287170946076, 7.56236088519129, 188.92820588272946, 58.87876577641623, 34.609309505273906, 5.9551392463532755, 54.98375517464068, 89.99389922550175, 41.38853409490287, 101.67849438561598, 2.7291439864119607, 76.2673503872545, 2.279436134677648, 0.0, 199.60417598171856, 248.0184023419652, 0.0, 39.54494504416082, 0.9311855310646562, 249.10785887135722, 2.0050793253843575, 68.03824888951817, 9.679155681232027, 243.10161467722241, 127.08487339585083, 158.3179283086798, 202.76343707964793, 175.13656712515294, 13.59541222245474, 366.98835170871456, 50.38999522068746, 42.440765126353824, 17.129117075000085, 118.18525113692489, 20.75825299397439, 123.91829307203896, 17.249858213773166, 145.5185644769239, 206.50852076719679, 235.85868067212115, 58.4731386784919, 29.957810628711446, 8.264840076054593, 1.7601591199372186, 1.4008155204184616, 123.05086789802178, 30.958029663630214, 29.36900637880323, 0.9112865810719528, 1.7679822038698607, 177.01732077188228, 67.11646482319033, 209.81412497948165, 76.00291102789983, 61.85044426841152, 14.705762241362681, 76.69912864020719, 38.894132256136714, 127.85520785645323, 135.5777289004343, 11.859026974210542, 225.24974962047446, 138.60531236405322, 9.597501903806227, 118.44627888573456, 89.08833490668191, 186.09568789398122, 63.721581904838665, 500.7451044278085, 158.97618170308564, 73.80414168194804, 295.5468089243032, 219.66624872511534, 49.81775966593352, 154.09751220904712, 302.8052969450999, 44.097963429487045, 282.8976651318815, 85.00940674985155, 3.9383427286762336, 13.8323370062161, 203.24897351537214, 124.31934732972188, 37.425934700501365, 91.90920566057575, 7.586626666212812, 111.79039042454208, 33.88578341646142, 319.7616350483097, 90.727444767995, 274.1057200950097, 236.9352296753798, 104.35188768327158, 5.507340489427223, 186.29940433156506, 79.55859379310428, 376.1457534665502, 220.69557893120032, 3.9556545190349377, 92.68162579352278, 72.04051777922527]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.3023778503208843, "mean_inference_ms": 8.305074441958205, "mean_action_processing_ms": 5.343725659557456, "mean_env_wait_ms": 1.8774920384003249, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0048073530197143555, "StateBufferConnector_ms": 0.0031954050064086914, "ViewRequirementAgentConnector_ms": 0.10442662239074707}, "num_episodes": 18, "episode_return_max": 407.3760201927123, "episode_return_min": -9.591863976210545, "episode_return_mean": 235.86139116019743, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 35.12905537287137, "num_env_steps_trained_throughput_per_sec": 35.12905537287137, "timesteps_total": 96000, "num_env_steps_sampled_lifetime": 96000, "num_agent_steps_sampled_lifetime": 384000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 384000, "timers": {"training_iteration_time_ms": 170507.797, "restore_workers_time_ms": 0.014, "training_step_time_ms": 170507.756, "sample_time_ms": 1099.398, "learn_time_ms": 169395.22, "learn_throughput": 23.613, "synch_weights_time_ms": 11.704}, "counters": {"num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000}, "done": false, "training_iteration": 24, "trial_id": "cf3bb_00000", "date": "2024-08-20_08-53-15", "timestamp": 1724124195, "time_this_iter_s": 113.89904713630676, "time_total_s": 8459.794062376022, "pid": 25777, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39f81ac10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 8459.794062376022, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 18.55483870967742, "ram_util_percent": 80.5258064516129}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8374908628641928, "cur_kl_coeff": 0.0023437499999999995, "cur_lr": 0.00010000000000000003, "total_loss": 4.034656880141566, "policy_loss": -0.0078911541497936, "vf_loss": 4.042478656138062, "vf_explained_var": 0.00019017199359873616, "kl": 0.029599792758582235, "entropy": 1.58106425521235, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 46305.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.195530125057255, "cur_kl_coeff": 0.028125000000000008, "cur_lr": 0.00010000000000000003, "total_loss": 9.21782624532306, "policy_loss": -0.007441481120795721, "vf_loss": 9.224763778908542, "vf_explained_var": 0.28574189609951445, "kl": 0.017918090891361073, "entropy": 1.517482855458739, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 46305.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 400000, "num_agent_steps_trained": 400000}, "env_runners": {"episode_reward_max": 407.3760201927123, "episode_reward_min": -9.591863976210545, "episode_reward_mean": 223.47809207954575, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -480.67028975246603, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 516.4569488454125}, "policy_reward_mean": {"prey_policy": 5.32261913641348, "predator_policy": 106.41642690335944}, "custom_metrics": {}, "hist_stats": {"episode_reward": [280.84567475751, 298.6228931174404, 278.00000000000006, 204.02783462076073, 124.22153344542174, 362.0, 141.09999999999965, 352.9, 64.99760250666723, 197.99999999999937, 370.9000000000002, 373.7801771654715, 129.39554480883862, 167.69999999999953, 194.19999999999936, 286.36594238490716, 346.6000000000003, 286.6, 354.5534557012602, 329.5439098255697, 182.5999999999996, 235.74258912250662, -9.591863976210545, 323.69999999999993, 194.5999999999995, 230.48738639286861, 193.79999999999933, 192.54857103832785, 407.3760201927123, 193.5999999999994, 360.85662473268144, 179.61471099902744, 30.50000000000015, 198.49999999999935, 355.1, 191.69999999999933, 213.09999999999928, 191.7999999999994, 196.08438777863097, 211.4999999999994, 356.69999999999993, 295.9999999999998, 231.69999999999945, 156.09999999999965, 141.40000000000003, 195.92479055899037, 178.49999999999991, 320.1, 257.9999999999997, 147.89999999999964, 113.5705559965428, 23.400000000000063, 301.460072088104, 338.5, 326.9, 308.9999999999999, 159.0999999999999, 190.48154598564085, 175.59999999999948, 302.5127867231837, 231.53663011074002, 303.4, 19.782297325429774, 332.9, 255.99774464177452, 159.24154359299828, 250.47427719437758, 152.73486659076167, 264.87377620927566, 137.5999999999999, 145.254427466009, 384.0, 274.927365255866, 160.00727873578467, 279.43716249055353, 159.19999999999987, 99.49994846201923, 151.36083841315522, 204.1999999999996, 52.199432055263316, 170.32082879617732, 203.17711733966684, 63.33769376846632, 169.49999999999955, 395.8198028445437, 178.79999999999998, 222.51905075625035, 281.4370934306066, 193.19999999999996, 272.89999999999975, 26.08469423428388, 103.89609151429096, 293.4832719995036, 325.2783265046745, 113.96425279003233, 305.5323512247197, 297.7988474222086, 359.19576483954705, 97.79999999999987, 314.313685978753], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [56.39386825098812, 104.56975242886335, 35.57296197884395, 52.496247175311794, 167.4924647939157, 67.73647301496628, -6.749830047257774, 14.895480974908578, 12.278644498077231, -52.51173168407465, 131.5155819419415, 182.0733822440592, 16.821052751618126, -27.95976396784976, 165.6405278169831, 132.74214887471277, -152.56838254147655, -186.50390484182373, 122.86046516705336, -24.167121489147647, 195.16926669344394, 172.28200164299932, 178.56551823783232, 151.2925847795512, -183.27775323780136, -81.67148046216958, -20.685326472895937, 20.470446848703773, -175.94149380006647, 116.92696581874348, 100.47695169055616, 26.90583167459758, 120.76028810777179, 178.9865955107195, 34.13636967519621, 139.62090411446644, 177.53154020813673, 100.77426540331089, 137.29628870256838, 154.02442557548082, -132.4884307398831, 164.68480904428299, 197.0876357032456, -130.7238805549621, -85.53305506574061, -152.65011358942897, 187.39999999999992, 53.45732457813669, 148.64707587415035, -51.424164307435646, -350.85012938792437, 105.71157776625185, 178.96395695609334, -275.6226225091514, -29.57291147886479, 152.38835530869375, 200.0, 82.68708254059784, 15.653371660916205, 134.05029616619896, 160.92274853880303, 139.2032890796363, -21.202169041659502, -147.0796778214679, -135.2138320577607, -30.776734710160227, -41.37876577641598, 146.3906904947261, 189.04486075364673, 105.11624482535933, -77.19389922550245, 137.51146590509714, -85.57849438561689, 194.27085601358803, 95.7326496127455, 17.520563865322334, 107.49369324078395, -111.01348144387164, -236.51840234196587, 200.0, 133.4550549558392, 182.7688144689353, -129.5078588713573, 174.3949206746155, -17.438248889518235, 171.4208443187679, -233.30161467722297, 19.215126604149162, -15.349366843745486, -204.33199854458246, -27.308945323109413, 34.501756534492074, 168.25698944945992, -407.135336378862, 151.37530388340835, 109.15481391523771, -42.18525113692513, 161.2417470060256, 5.381706927960963, 1.3501417862267937, -175.5581744486066, -62.898354798971184, -227.75868067212147, -43.17313867849169, 104.29605952553071, 158.9413618578073, 196.2398408800628, 139.09918447958154, 31.349132101978185, 141.54197033636981, 93.89976677370976, 184.81994026641513, -103.78516152308164, 84.09985854732938, -18.61632241187084, -67.83272140516036, 82.19708897210016, -44.450444268411275, 136.29657114669752, 74.8113246949163, 59.91690890114589, 4.870381097004126, 78.53588332047536, 77.42736080487971, -176.62246444975415, -167.4503002093436, 180.5024980961938, 24.35372111426544, 132.4412487442787, -151.62752690316736, 75.44514701281756, -480.67028975246603, 14.954907162515568, 2.739046646828399, -393.91730331730685, 31.439112258651214, -92.57680309977823, 153.5353074340732, -292.2052969451003, 82.90203657051302, 48.19099980747307, -270.843644223197, 192.06165727132378, 174.1676629937839, 200.0, -252.64095558922833, -62.530159716593126, 93.2022980913007, 126.99198338965161, 33.06816201014706, 119.81421658353861, -314.26163504831, -86.58286334393466, -178.75035305705063, -190.60125360193675, 0.6749746564405683, 176.0025315624591, -163.60927638345183, -109.27721580876076, -294.22769939563057, -132.51232225626222, 78.1819176022041, 42.21319461892828, -3.7582208520092575, -110.93446756161103, -440.82637447464657, -303.3581388632276, 112.82059328025018, 198.2, 192.02539194556556, -467.30630830999604, 160.03425473845832, -70.11094897261862, -39.78005888281817, -382.43118152763515, 137.67532354944007, 191.0, -422.9538355327178, 180.32633459379983, 43.614210953447284, -195.17578376451206, -362.4889920272242, -450.3413988376003, -352.92981300189984, 116.25582416391599, 71.22818767591176, 110.12380443747182, 131.0466341674877, -147.3317305633073, 0.8672011682063769, 72.88998915034854, 97.16535510903032, 34.34396407312333, 34.030543918496974, 158.69527547374167, 104.66409889533683, -144.3289916154417, -72.42012839499483, 88.56218484713614, 107.83724089636738], "policy_predator_policy_reward": [81.08793292299141, 38.79412115466704, 197.8295437654514, 12.724140197833098, 20.507535206084317, 22.263526985033586, 57.57813631380662, 138.30404737930394, 86.91320448404676, 77.54141614737256, 38.48441805805847, 9.926617755940802, 107.17894724838187, 45.05976396784999, 13.259472183016882, 41.25785112528723, 332.11024529300187, 71.95964459696563, 43.16712148914792, 56.13953483294664, 1.1307333065560505, 2.3179983570006186, 19.410236178010766, 24.511837970077245, 381.4676600304398, 12.877118478369475, 38.48532647289619, 129.42955315129618, 190.14149380006566, 63.07303418125652, 107.4222869805977, 51.56087203915577, 37.63971189222813, 9.213404489280482, 63.5504651424356, 49.292261067901784, 43.187222270706606, 33.060427819105854, 28.696882288844208, 9.52631325867632, 143.58843073988277, 6.815190955716993, 47.20360023752776, 122.17523373669543, 48.60959892110574, 179.9817057578526, 0.0, 82.84267542186312, 30.75292412584965, 66.62416430743576, 154.29744071374944, 321.3284973007925, 3.5360430439066364, 286.922622509154, 47.37291147886504, 22.36021572963469, 64.62674864079709, 60.06218901131735, 3.946628339083759, 39.94970383380106, 44.94778226961896, 15.782804844623131, 271.9336861526943, 75.96287170946076, 7.56236088519129, 188.92820588272946, 58.87876577641623, 34.609309505273906, 5.9551392463532755, 54.98375517464068, 89.99389922550175, 41.38853409490287, 101.67849438561598, 2.7291439864119607, 76.2673503872545, 2.279436134677648, 0.0, 199.60417598171856, 248.0184023419652, 0.0, 39.54494504416082, 0.9311855310646562, 249.10785887135722, 2.0050793253843575, 68.03824888951817, 9.679155681232027, 243.10161467722241, 127.08487339585083, 158.3179283086798, 202.76343707964793, 175.13656712515294, 13.59541222245474, 366.98835170871456, 50.38999522068746, 42.440765126353824, 17.129117075000085, 118.18525113692489, 20.75825299397439, 123.91829307203896, 17.249858213773166, 145.5185644769239, 206.50852076719679, 235.85868067212115, 58.4731386784919, 29.957810628711446, 8.264840076054593, 1.7601591199372186, 1.4008155204184616, 123.05086789802178, 30.958029663630214, 29.36900637880323, 0.9112865810719528, 1.7679822038698607, 177.01732077188228, 67.11646482319033, 209.81412497948165, 76.00291102789983, 61.85044426841152, 14.705762241362681, 76.69912864020719, 38.894132256136714, 127.85520785645323, 135.5777289004343, 11.859026974210542, 225.24974962047446, 138.60531236405322, 9.597501903806227, 118.44627888573456, 89.08833490668191, 186.09568789398122, 63.721581904838665, 500.7451044278085, 158.97618170308564, 73.80414168194804, 295.5468089243032, 219.66624872511534, 49.81775966593352, 154.09751220904712, 302.8052969450999, 44.097963429487045, 282.8976651318815, 85.00940674985155, 3.9383427286762336, 13.8323370062161, 203.24897351537214, 124.31934732972188, 37.425934700501365, 91.90920566057575, 7.586626666212812, 111.79039042454208, 33.88578341646142, 319.7616350483097, 90.727444767995, 274.1057200950097, 236.9352296753798, 104.35188768327158, 5.507340489427223, 186.29940433156506, 79.55859379310428, 376.1457534665502, 220.69557893120032, 3.9556545190349377, 92.68162579352278, 72.04051777922527, 410.347613550066, 204.75092225465704, 311.8581388632294, 48.17940671974983, 2.136453939801311, 3.45795695917686, 470.0063083099961, 16.06574526154167, 108.35649804761562, 224.05356056407155, 331.4519208909516, 194.74103051785013, 0.0, 425.1538355327176, 9.673665406200183, 39.28578904655287, 264.44304642531273, 319.306423600708, 516.4569488454125, 390.71035450837826, 91.85335667759252, 14.14590348208326, 69.77892712544799, 14.32896077426696, 241.3317305633073, 19.097051621826125, 0.0, 135.4770069653402, 12.246486043583948, 217.17785338700435, 13.131000117238225, 82.70539035323033, 156.82899161544103, 157.72012839499465, 6.4991770933636, 111.41508314188589]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.2347081130716067, "mean_inference_ms": 8.024963511442975, "mean_action_processing_ms": 5.139868521826417, "mean_env_wait_ms": 1.8094513102705572, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005106091499328613, "StateBufferConnector_ms": 0.003174901008605957, "ViewRequirementAgentConnector_ms": 0.10364973545074463}, "num_episodes": 18, "episode_return_max": 407.3760201927123, "episode_return_min": -9.591863976210545, "episode_return_mean": 223.47809207954575, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 400000, "num_agent_steps_trained": 400000, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 20.104054451705018, "num_env_steps_trained_throughput_per_sec": 20.104054451705018, "timesteps_total": 100000, "num_env_steps_sampled_lifetime": 100000, "num_agent_steps_sampled_lifetime": 400000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 400000, "timers": {"training_iteration_time_ms": 146759.539, "restore_workers_time_ms": 0.013, "training_step_time_ms": 146759.497, "sample_time_ms": 1097.866, "learn_time_ms": 145648.657, "learn_throughput": 27.463, "synch_weights_time_ms": 11.672}, "counters": {"num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 400000, "num_agent_steps_trained": 400000}, "done": false, "training_iteration": 25, "trial_id": "cf3bb_00000", "date": "2024-08-20_08-56-34", "timestamp": 1724124394, "time_this_iter_s": 198.9828269481659, "time_total_s": 8658.776889324188, "pid": 25777, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39f81e430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 8658.776889324188, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 19.926984126984124, "ram_util_percent": 80.76984126984125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.958135030958703, "cur_kl_coeff": 0.003515625000000001, "cur_lr": 0.00010000000000000003, "total_loss": 4.299105034051118, "policy_loss": -0.007042925477905012, "vf_loss": 4.306060675086168, "vf_explained_var": 0.0008714549755923963, "kl": 0.024825944659022353, "entropy": 1.5617854513188518, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 48195.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 14.158864261233617, "cur_kl_coeff": 0.028125000000000008, "cur_lr": 0.00010000000000000003, "total_loss": 8.098235680817297, "policy_loss": -0.0030718429893669156, "vf_loss": 8.101055660701933, "vf_explained_var": 0.31810173338683195, "kl": 0.00895457083888058, "entropy": 1.520404386015796, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 48195.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 416000, "num_agent_steps_trained": 416000}, "env_runners": {"episode_reward_max": 407.3760201927123, "episode_reward_min": -9.591863976210545, "episode_reward_mean": 217.7446193919716, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -480.67028975246603, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 516.4569488454125}, "policy_reward_mean": {"prey_policy": -3.8002627014727683, "predator_policy": 112.67257239745862}, "custom_metrics": {}, "hist_stats": {"episode_reward": [354.5534557012602, 329.5439098255697, 182.5999999999996, 235.74258912250662, -9.591863976210545, 323.69999999999993, 194.5999999999995, 230.48738639286861, 193.79999999999933, 192.54857103832785, 407.3760201927123, 193.5999999999994, 360.85662473268144, 179.61471099902744, 30.50000000000015, 198.49999999999935, 355.1, 191.69999999999933, 213.09999999999928, 191.7999999999994, 196.08438777863097, 211.4999999999994, 356.69999999999993, 295.9999999999998, 231.69999999999945, 156.09999999999965, 141.40000000000003, 195.92479055899037, 178.49999999999991, 320.1, 257.9999999999997, 147.89999999999964, 113.5705559965428, 23.400000000000063, 301.460072088104, 338.5, 326.9, 308.9999999999999, 159.0999999999999, 190.48154598564085, 175.59999999999948, 302.5127867231837, 231.53663011074002, 303.4, 19.782297325429774, 332.9, 255.99774464177452, 159.24154359299828, 250.47427719437758, 152.73486659076167, 264.87377620927566, 137.5999999999999, 145.254427466009, 384.0, 274.927365255866, 160.00727873578467, 279.43716249055353, 159.19999999999987, 99.49994846201923, 151.36083841315522, 204.1999999999996, 52.199432055263316, 170.32082879617732, 203.17711733966684, 63.33769376846632, 169.49999999999955, 395.8198028445437, 178.79999999999998, 222.51905075625035, 281.4370934306066, 193.19999999999996, 272.89999999999975, 26.08469423428388, 103.89609151429096, 293.4832719995036, 325.2783265046745, 113.96425279003233, 305.5323512247197, 297.7988474222086, 359.19576483954705, 97.79999999999987, 314.313685978753, 182.19999999999987, 234.15014687570522, 288.9, 296.90090785769115, 169.1999999999995, 154.386839406273, 253.45724989472265, 91.18920185499391, 323.193268943096, 159.1994013094281, 285.03630679314625, 117.69999999999963, 215.49999999999926, 381.98887773431306, 317.8, 131.2778716869071, 177.02986169332627, 107.79999999999981], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [177.53154020813673, 100.77426540331089, 137.29628870256838, 154.02442557548082, -132.4884307398831, 164.68480904428299, 197.0876357032456, -130.7238805549621, -85.53305506574061, -152.65011358942897, 187.39999999999992, 53.45732457813669, 148.64707587415035, -51.424164307435646, -350.85012938792437, 105.71157776625185, 178.96395695609334, -275.6226225091514, -29.57291147886479, 152.38835530869375, 200.0, 82.68708254059784, 15.653371660916205, 134.05029616619896, 160.92274853880303, 139.2032890796363, -21.202169041659502, -147.0796778214679, -135.2138320577607, -30.776734710160227, -41.37876577641598, 146.3906904947261, 189.04486075364673, 105.11624482535933, -77.19389922550245, 137.51146590509714, -85.57849438561689, 194.27085601358803, 95.7326496127455, 17.520563865322334, 107.49369324078395, -111.01348144387164, -236.51840234196587, 200.0, 133.4550549558392, 182.7688144689353, -129.5078588713573, 174.3949206746155, -17.438248889518235, 171.4208443187679, -233.30161467722297, 19.215126604149162, -15.349366843745486, -204.33199854458246, -27.308945323109413, 34.501756534492074, 168.25698944945992, -407.135336378862, 151.37530388340835, 109.15481391523771, -42.18525113692513, 161.2417470060256, 5.381706927960963, 1.3501417862267937, -175.5581744486066, -62.898354798971184, -227.75868067212147, -43.17313867849169, 104.29605952553071, 158.9413618578073, 196.2398408800628, 139.09918447958154, 31.349132101978185, 141.54197033636981, 93.89976677370976, 184.81994026641513, -103.78516152308164, 84.09985854732938, -18.61632241187084, -67.83272140516036, 82.19708897210016, -44.450444268411275, 136.29657114669752, 74.8113246949163, 59.91690890114589, 4.870381097004126, 78.53588332047536, 77.42736080487971, -176.62246444975415, -167.4503002093436, 180.5024980961938, 24.35372111426544, 132.4412487442787, -151.62752690316736, 75.44514701281756, -480.67028975246603, 14.954907162515568, 2.739046646828399, -393.91730331730685, 31.439112258651214, -92.57680309977823, 153.5353074340732, -292.2052969451003, 82.90203657051302, 48.19099980747307, -270.843644223197, 192.06165727132378, 174.1676629937839, 200.0, -252.64095558922833, -62.530159716593126, 93.2022980913007, 126.99198338965161, 33.06816201014706, 119.81421658353861, -314.26163504831, -86.58286334393466, -178.75035305705063, -190.60125360193675, 0.6749746564405683, 176.0025315624591, -163.60927638345183, -109.27721580876076, -294.22769939563057, -132.51232225626222, 78.1819176022041, 42.21319461892828, -3.7582208520092575, -110.93446756161103, -440.82637447464657, -303.3581388632276, 112.82059328025018, 198.2, 192.02539194556556, -467.30630830999604, 160.03425473845832, -70.11094897261862, -39.78005888281817, -382.43118152763515, 137.67532354944007, 191.0, -422.9538355327178, 180.32633459379983, 43.614210953447284, -195.17578376451206, -362.4889920272242, -450.3413988376003, -352.92981300189984, 116.25582416391599, 71.22818767591176, 110.12380443747182, 131.0466341674877, -147.3317305633073, 0.8672011682063769, 72.88998915034854, 97.16535510903032, 34.34396407312333, 34.030543918496974, 158.69527547374167, 104.66409889533683, -144.3289916154417, -72.42012839499483, 88.56218484713614, 107.83724089636738, 131.19882139459193, -243.43966013323734, 99.84174764748576, -9.547358712794363, 133.0312201057774, 12.893133847693335, 79.81070795808868, 99.45589104363276, -360.78046010560087, 149.1566786681583, 77.12211861095545, -223.08491891428235, -102.60855114363909, -34.47412320764846, -80.2311558153814, -194.00377729291063, 117.29751766303906, 98.21901905309986, -254.13466547561978, 78.73934837802491, 123.82006867732329, 90.8131006927748, -152.33679706870433, -13.167031263338046, 191.9328495103309, 9.002316215792568, -4.352105021373603, 163.48469931538466, 161.8315567416615, 100.98321045699588, -211.109435999809, -22.579241879630956, -1.8047237792723365, 77.3207825207792, -169.46762314547814, 43.236461042141755], "policy_predator_policy_reward": [43.187222270706606, 33.060427819105854, 28.696882288844208, 9.52631325867632, 143.58843073988277, 6.815190955716993, 47.20360023752776, 122.17523373669543, 48.60959892110574, 179.9817057578526, 0.0, 82.84267542186312, 30.75292412584965, 66.62416430743576, 154.29744071374944, 321.3284973007925, 3.5360430439066364, 286.922622509154, 47.37291147886504, 22.36021572963469, 64.62674864079709, 60.06218901131735, 3.946628339083759, 39.94970383380106, 44.94778226961896, 15.782804844623131, 271.9336861526943, 75.96287170946076, 7.56236088519129, 188.92820588272946, 58.87876577641623, 34.609309505273906, 5.9551392463532755, 54.98375517464068, 89.99389922550175, 41.38853409490287, 101.67849438561598, 2.7291439864119607, 76.2673503872545, 2.279436134677648, 0.0, 199.60417598171856, 248.0184023419652, 0.0, 39.54494504416082, 0.9311855310646562, 249.10785887135722, 2.0050793253843575, 68.03824888951817, 9.679155681232027, 243.10161467722241, 127.08487339585083, 158.3179283086798, 202.76343707964793, 175.13656712515294, 13.59541222245474, 366.98835170871456, 50.38999522068746, 42.440765126353824, 17.129117075000085, 118.18525113692489, 20.75825299397439, 123.91829307203896, 17.249858213773166, 145.5185644769239, 206.50852076719679, 235.85868067212115, 58.4731386784919, 29.957810628711446, 8.264840076054593, 1.7601591199372186, 1.4008155204184616, 123.05086789802178, 30.958029663630214, 29.36900637880323, 0.9112865810719528, 1.7679822038698607, 177.01732077188228, 67.11646482319033, 209.81412497948165, 76.00291102789983, 61.85044426841152, 14.705762241362681, 76.69912864020719, 38.894132256136714, 127.85520785645323, 135.5777289004343, 11.859026974210542, 225.24974962047446, 138.60531236405322, 9.597501903806227, 118.44627888573456, 89.08833490668191, 186.09568789398122, 63.721581904838665, 500.7451044278085, 158.97618170308564, 73.80414168194804, 295.5468089243032, 219.66624872511534, 49.81775966593352, 154.09751220904712, 302.8052969450999, 44.097963429487045, 282.8976651318815, 85.00940674985155, 3.9383427286762336, 13.8323370062161, 203.24897351537214, 124.31934732972188, 37.425934700501365, 91.90920566057575, 7.586626666212812, 111.79039042454208, 33.88578341646142, 319.7616350483097, 90.727444767995, 274.1057200950097, 236.9352296753798, 104.35188768327158, 5.507340489427223, 186.29940433156506, 79.55859379310428, 376.1457534665502, 220.69557893120032, 3.9556545190349377, 92.68162579352278, 72.04051777922527, 410.347613550066, 204.75092225465704, 311.8581388632294, 48.17940671974983, 2.136453939801311, 3.45795695917686, 470.0063083099961, 16.06574526154167, 108.35649804761562, 224.05356056407155, 331.4519208909516, 194.74103051785013, 0.0, 425.1538355327176, 9.673665406200183, 39.28578904655287, 264.44304642531273, 319.306423600708, 516.4569488454125, 390.71035450837826, 91.85335667759252, 14.14590348208326, 69.77892712544799, 14.32896077426696, 241.3317305633073, 19.097051621826125, 0.0, 135.4770069653402, 12.246486043583948, 217.17785338700435, 13.131000117238225, 82.70539035323033, 156.82899161544103, 157.72012839499465, 6.4991770933636, 111.41508314188589, 41.70117860540809, 252.73966013323744, 25.934424270641145, 117.92133367037263, 107.86433255565768, 35.111313490871616, 65.44781138262405, 52.18649747334572, 370.4804601056029, 10.343321331841706, 268.3660935255016, 31.983546184098348, 122.867579770682, 267.67234447532826, 208.97363039171995, 156.45050457156523, 66.14450635029273, 41.53222587666441, 264.03166740709554, 70.56305099992736, 2.086102304192898, 68.31703511885526, 147.0225562591089, 136.18127207293304, 4.067150489669106, 10.497683784207396, 90.76561178459932, 132.0906716557027, 7.668443258338492, 47.316789543004155, 245.69599246280958, 119.27055710353694, 83.59358523212127, 17.92021771969829, 182.46762314547738, 51.56353895785833]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.1704119442613212, "mean_inference_ms": 7.763111257783266, "mean_action_processing_ms": 4.952066475931137, "mean_env_wait_ms": 1.7464513560274362, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004841208457946777, "StateBufferConnector_ms": 0.0031223297119140625, "ViewRequirementAgentConnector_ms": 0.09045600891113281}, "num_episodes": 18, "episode_return_max": 407.3760201927123, "episode_return_min": -9.591863976210545, "episode_return_mean": 217.7446193919716, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 416000, "num_agent_steps_trained": 416000, "num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 66.94700515448592, "num_env_steps_trained_throughput_per_sec": 66.94700515448592, "timesteps_total": 104000, "num_env_steps_sampled_lifetime": 104000, "num_agent_steps_sampled_lifetime": 416000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 416000, "timers": {"training_iteration_time_ms": 139269.121, "restore_workers_time_ms": 0.013, "training_step_time_ms": 139269.079, "sample_time_ms": 1092.71, "learn_time_ms": 138163.554, "learn_throughput": 28.951, "synch_weights_time_ms": 11.628}, "counters": {"num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 416000, "num_agent_steps_trained": 416000}, "done": false, "training_iteration": 26, "trial_id": "cf3bb_00000", "date": "2024-08-20_08-57-34", "timestamp": 1724124454, "time_this_iter_s": 59.75247311592102, "time_total_s": 8718.52936244011, "pid": 25777, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39f781280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 8718.52936244011, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 18.785483870967738, "ram_util_percent": 80.4241935483871}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8663481680646775, "cur_kl_coeff": 0.0052734375, "cur_lr": 0.00010000000000000003, "total_loss": 5.23143092034355, "policy_loss": -0.0037192777587623195, "vf_loss": 5.235083544443524, "vf_explained_var": -0.00017490503649232248, "kl": 0.01263969381838556, "entropy": 1.5097359087101365, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 50085.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.917891793591636, "cur_kl_coeff": 0.028125000000000008, "cur_lr": 0.00010000000000000003, "total_loss": 9.400782286427008, "policy_loss": -0.0069601895809962, "vf_loss": 9.406979007317275, "vf_explained_var": 0.21559939113243548, "kl": 0.027145173185475456, "entropy": 1.5339613189142216, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 50085.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 432000}, "env_runners": {"episode_reward_max": 571.0820745508744, "episode_reward_min": 14.359511453443481, "episode_reward_mean": 222.73410565497232, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -879.8194465413818, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 757.0883516902529}, "policy_reward_mean": {"prey_policy": -18.559380229115515, "predator_policy": 129.9264330566017}, "custom_metrics": {}, "hist_stats": {"episode_reward": [356.69999999999993, 295.9999999999998, 231.69999999999945, 156.09999999999965, 141.40000000000003, 195.92479055899037, 178.49999999999991, 320.1, 257.9999999999997, 147.89999999999964, 113.5705559965428, 23.400000000000063, 301.460072088104, 338.5, 326.9, 308.9999999999999, 159.0999999999999, 190.48154598564085, 175.59999999999948, 302.5127867231837, 231.53663011074002, 303.4, 19.782297325429774, 332.9, 255.99774464177452, 159.24154359299828, 250.47427719437758, 152.73486659076167, 264.87377620927566, 137.5999999999999, 145.254427466009, 384.0, 274.927365255866, 160.00727873578467, 279.43716249055353, 159.19999999999987, 99.49994846201923, 151.36083841315522, 204.1999999999996, 52.199432055263316, 170.32082879617732, 203.17711733966684, 63.33769376846632, 169.49999999999955, 395.8198028445437, 178.79999999999998, 222.51905075625035, 281.4370934306066, 193.19999999999996, 272.89999999999975, 26.08469423428388, 103.89609151429096, 293.4832719995036, 325.2783265046745, 113.96425279003233, 305.5323512247197, 297.7988474222086, 359.19576483954705, 97.79999999999987, 314.313685978753, 182.19999999999987, 234.15014687570522, 288.9, 296.90090785769115, 169.1999999999995, 154.386839406273, 253.45724989472265, 91.18920185499391, 323.193268943096, 159.1994013094281, 285.03630679314625, 117.69999999999963, 215.49999999999926, 381.98887773431306, 317.8, 131.2778716869071, 177.02986169332627, 107.79999999999981, 150.90180757513832, 300.0, 203.8884423582739, 33.1000000000002, 571.0820745508744, 268.7831663373354, 190.09999999999937, 143.12616847501894, 388.30000000000007, 237.113217573665, 14.359511453443481, 193.50000000000003, 165.85273592515833, 338.90000000000015, 191.7999999999994, 366.2, 314.6, 268.4573450005457, 359.1, 270.99994885799316, 155.8999999999999, 330.6], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [133.4550549558392, 182.7688144689353, -129.5078588713573, 174.3949206746155, -17.438248889518235, 171.4208443187679, -233.30161467722297, 19.215126604149162, -15.349366843745486, -204.33199854458246, -27.308945323109413, 34.501756534492074, 168.25698944945992, -407.135336378862, 151.37530388340835, 109.15481391523771, -42.18525113692513, 161.2417470060256, 5.381706927960963, 1.3501417862267937, -175.5581744486066, -62.898354798971184, -227.75868067212147, -43.17313867849169, 104.29605952553071, 158.9413618578073, 196.2398408800628, 139.09918447958154, 31.349132101978185, 141.54197033636981, 93.89976677370976, 184.81994026641513, -103.78516152308164, 84.09985854732938, -18.61632241187084, -67.83272140516036, 82.19708897210016, -44.450444268411275, 136.29657114669752, 74.8113246949163, 59.91690890114589, 4.870381097004126, 78.53588332047536, 77.42736080487971, -176.62246444975415, -167.4503002093436, 180.5024980961938, 24.35372111426544, 132.4412487442787, -151.62752690316736, 75.44514701281756, -480.67028975246603, 14.954907162515568, 2.739046646828399, -393.91730331730685, 31.439112258651214, -92.57680309977823, 153.5353074340732, -292.2052969451003, 82.90203657051302, 48.19099980747307, -270.843644223197, 192.06165727132378, 174.1676629937839, 200.0, -252.64095558922833, -62.530159716593126, 93.2022980913007, 126.99198338965161, 33.06816201014706, 119.81421658353861, -314.26163504831, -86.58286334393466, -178.75035305705063, -190.60125360193675, 0.6749746564405683, 176.0025315624591, -163.60927638345183, -109.27721580876076, -294.22769939563057, -132.51232225626222, 78.1819176022041, 42.21319461892828, -3.7582208520092575, -110.93446756161103, -440.82637447464657, -303.3581388632276, 112.82059328025018, 198.2, 192.02539194556556, -467.30630830999604, 160.03425473845832, -70.11094897261862, -39.78005888281817, -382.43118152763515, 137.67532354944007, 191.0, -422.9538355327178, 180.32633459379983, 43.614210953447284, -195.17578376451206, -362.4889920272242, -450.3413988376003, -352.92981300189984, 116.25582416391599, 71.22818767591176, 110.12380443747182, 131.0466341674877, -147.3317305633073, 0.8672011682063769, 72.88998915034854, 97.16535510903032, 34.34396407312333, 34.030543918496974, 158.69527547374167, 104.66409889533683, -144.3289916154417, -72.42012839499483, 88.56218484713614, 107.83724089636738, 131.19882139459193, -243.43966013323734, 99.84174764748576, -9.547358712794363, 133.0312201057774, 12.893133847693335, 79.81070795808868, 99.45589104363276, -360.78046010560087, 149.1566786681583, 77.12211861095545, -223.08491891428235, -102.60855114363909, -34.47412320764846, -80.2311558153814, -194.00377729291063, 117.29751766303906, 98.21901905309986, -254.13466547561978, 78.73934837802491, 123.82006867732329, 90.8131006927748, -152.33679706870433, -13.167031263338046, 191.9328495103309, 9.002316215792568, -4.352105021373603, 163.48469931538466, 161.8315567416615, 100.98321045699588, -211.109435999809, -22.579241879630956, -1.8047237792723365, 77.3207825207792, -169.46762314547814, 43.236461042141755, -54.68699101416402, -170.74055202293474, -31.237698921105533, 87.75676428617929, -34.784497546286744, 73.72603893402055, -140.34394248796136, 13.354622728811174, 40.05292478692816, -879.8194465413818, 76.50422951778319, 42.96537727333877, -106.75443916302125, 127.68425763517862, -232.70798286060986, -37.97975245485637, 198.2, 179.40354161407276, 46.548804327195555, -90.83710702756244, -215.84125403449877, -456.26801360571994, -643.6586044725198, 173.08359701613963, -122.0336186288181, 70.25344442481071, 77.27557107856276, 174.31450659158537, 167.52939359996896, -124.05191008636257, 146.5188739909586, 186.05720197471712, -0.47624612455982174, 156.04518210548878, 166.1719923080518, -420.4292949065666, 134.50342044375466, 143.6216228626208, -242.04601561003304, 177.43103580946698, -400.30369998964335, 136.44950402406917, 84.25450424000834, 162.21545377630537], "policy_predator_policy_reward": [39.54494504416082, 0.9311855310646562, 249.10785887135722, 2.0050793253843575, 68.03824888951817, 9.679155681232027, 243.10161467722241, 127.08487339585083, 158.3179283086798, 202.76343707964793, 175.13656712515294, 13.59541222245474, 366.98835170871456, 50.38999522068746, 42.440765126353824, 17.129117075000085, 118.18525113692489, 20.75825299397439, 123.91829307203896, 17.249858213773166, 145.5185644769239, 206.50852076719679, 235.85868067212115, 58.4731386784919, 29.957810628711446, 8.264840076054593, 1.7601591199372186, 1.4008155204184616, 123.05086789802178, 30.958029663630214, 29.36900637880323, 0.9112865810719528, 1.7679822038698607, 177.01732077188228, 67.11646482319033, 209.81412497948165, 76.00291102789983, 61.85044426841152, 14.705762241362681, 76.69912864020719, 38.894132256136714, 127.85520785645323, 135.5777289004343, 11.859026974210542, 225.24974962047446, 138.60531236405322, 9.597501903806227, 118.44627888573456, 89.08833490668191, 186.09568789398122, 63.721581904838665, 500.7451044278085, 158.97618170308564, 73.80414168194804, 295.5468089243032, 219.66624872511534, 49.81775966593352, 154.09751220904712, 302.8052969450999, 44.097963429487045, 282.8976651318815, 85.00940674985155, 3.9383427286762336, 13.8323370062161, 203.24897351537214, 124.31934732972188, 37.425934700501365, 91.90920566057575, 7.586626666212812, 111.79039042454208, 33.88578341646142, 319.7616350483097, 90.727444767995, 274.1057200950097, 236.9352296753798, 104.35188768327158, 5.507340489427223, 186.29940433156506, 79.55859379310428, 376.1457534665502, 220.69557893120032, 3.9556545190349377, 92.68162579352278, 72.04051777922527, 410.347613550066, 204.75092225465704, 311.8581388632294, 48.17940671974983, 2.136453939801311, 3.45795695917686, 470.0063083099961, 16.06574526154167, 108.35649804761562, 224.05356056407155, 331.4519208909516, 194.74103051785013, 0.0, 425.1538355327176, 9.673665406200183, 39.28578904655287, 264.44304642531273, 319.306423600708, 516.4569488454125, 390.71035450837826, 91.85335667759252, 14.14590348208326, 69.77892712544799, 14.32896077426696, 241.3317305633073, 19.097051621826125, 0.0, 135.4770069653402, 12.246486043583948, 217.17785338700435, 13.131000117238225, 82.70539035323033, 156.82899161544103, 157.72012839499465, 6.4991770933636, 111.41508314188589, 41.70117860540809, 252.73966013323744, 25.934424270641145, 117.92133367037263, 107.86433255565768, 35.111313490871616, 65.44781138262405, 52.18649747334572, 370.4804601056029, 10.343321331841706, 268.3660935255016, 31.983546184098348, 122.867579770682, 267.67234447532826, 208.97363039171995, 156.45050457156523, 66.14450635029273, 41.53222587666441, 264.03166740709554, 70.56305099992736, 2.086102304192898, 68.31703511885526, 147.0225562591089, 136.18127207293304, 4.067150489669106, 10.497683784207396, 90.76561178459932, 132.0906716557027, 7.668443258338492, 47.316789543004155, 245.69599246280958, 119.27055710353694, 83.59358523212127, 17.92021771969829, 182.46762314547738, 51.56353895785833, 310.0963316894964, 66.23301892274051, 168.23769892110553, 75.24323571382071, 163.91482637421018, 1.032074596330067, 153.94394248796056, 6.145377271188791, 757.0883516902529, 653.7602446150753, 24.68489071292548, 124.62866883328802, 119.85443916302053, 49.31574236482138, 334.5480890536337, 79.26581473685123, 0.0, 10.696458385927226, 139.85842416130984, 141.5430961127222, 234.00668918413405, 452.4620899095282, 647.1586044725199, 16.916402983860372, 25.248813906988392, 192.38409622217733, 75.42442892143728, 11.885493408414627, 9.070606400031053, 139.2519100863617, 26.681126009041385, 6.942798025282881, 141.7762461245598, 17.25481789451125, 370.83807280944524, 151.87657478961552, 50.49657955624533, 30.478377137379198, 238.77842708139903, 96.83650157716039, 404.40369998964417, 15.350495975930805, 65.68861100509173, 18.44143097859458]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.110644168179187, "mean_inference_ms": 7.301142155962798, "mean_action_processing_ms": 4.905249049775643, "mean_env_wait_ms": 1.6882948540869434, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006109356880187988, "StateBufferConnector_ms": 0.003196239471435547, "ViewRequirementAgentConnector_ms": 0.09011924266815186}, "num_episodes": 22, "episode_return_max": 571.0820745508744, "episode_return_min": 14.359511453443481, "episode_return_mean": 222.73410565497232, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 432000, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 12.587520886156783, "num_env_steps_trained_throughput_per_sec": 12.587520886156783, "timesteps_total": 108000, "num_env_steps_sampled_lifetime": 108000, "num_agent_steps_sampled_lifetime": 432000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 432000, "timers": {"training_iteration_time_ms": 164745.956, "restore_workers_time_ms": 0.013, "training_step_time_ms": 164745.915, "sample_time_ms": 1093.386, "learn_time_ms": 163640.135, "learn_throughput": 24.444, "synch_weights_time_ms": 11.338}, "counters": {"num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 432000}, "done": false, "training_iteration": 27, "trial_id": "cf3bb_00000", "date": "2024-08-20_09-02-52", "timestamp": 1724124772, "time_this_iter_s": 317.77836894989014, "time_total_s": 9036.30773139, "pid": 25777, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39f81e3a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 9036.30773139, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 19.075806451612905, "ram_util_percent": 80.84193548387097}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6445502589540507, "cur_kl_coeff": 0.0052734375, "cur_lr": 0.00010000000000000003, "total_loss": 2.3078969915707908, "policy_loss": -0.001451040683412757, "vf_loss": 2.3093075294343253, "vf_explained_var": 0.0008667549128254886, "kl": 0.007680529135967857, "entropy": 1.5287359679817523, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 51975.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 14.05166719174259, "cur_kl_coeff": 0.0421875, "cur_lr": 0.00010000000000000003, "total_loss": 8.644201709858324, "policy_loss": -0.008847380233386522, "vf_loss": 8.652363523856673, "vf_explained_var": 0.2700570276174596, "kl": 0.01625047363836675, "entropy": 1.4989876650628589, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 51975.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000}, "env_runners": {"episode_reward_max": 571.0820745508744, "episode_reward_min": -331.5409717167004, "episode_reward_mean": 230.09192141964348, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -991.4073552038403, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 1071.1138305334507}, "policy_reward_mean": {"prey_policy": -27.24623549715836, "predator_policy": 142.2921962069801}, "custom_metrics": {}, "hist_stats": {"episode_reward": [332.9, 255.99774464177452, 159.24154359299828, 250.47427719437758, 152.73486659076167, 264.87377620927566, 137.5999999999999, 145.254427466009, 384.0, 274.927365255866, 160.00727873578467, 279.43716249055353, 159.19999999999987, 99.49994846201923, 151.36083841315522, 204.1999999999996, 52.199432055263316, 170.32082879617732, 203.17711733966684, 63.33769376846632, 169.49999999999955, 395.8198028445437, 178.79999999999998, 222.51905075625035, 281.4370934306066, 193.19999999999996, 272.89999999999975, 26.08469423428388, 103.89609151429096, 293.4832719995036, 325.2783265046745, 113.96425279003233, 305.5323512247197, 297.7988474222086, 359.19576483954705, 97.79999999999987, 314.313685978753, 182.19999999999987, 234.15014687570522, 288.9, 296.90090785769115, 169.1999999999995, 154.386839406273, 253.45724989472265, 91.18920185499391, 323.193268943096, 159.1994013094281, 285.03630679314625, 117.69999999999963, 215.49999999999926, 381.98887773431306, 317.8, 131.2778716869071, 177.02986169332627, 107.79999999999981, 150.90180757513832, 300.0, 203.8884423582739, 33.1000000000002, 571.0820745508744, 268.7831663373354, 190.09999999999937, 143.12616847501894, 388.30000000000007, 237.113217573665, 14.359511453443481, 193.50000000000003, 165.85273592515833, 338.90000000000015, 191.7999999999994, 366.2, 314.6, 268.4573450005457, 359.1, 270.99994885799316, 155.8999999999999, 330.6, 289.70000000000005, 379.0375030897263, 214.6539451478528, 120.19999999999976, 292.8, 173.9999999999995, 336.55486064841375, 282.99092946796384, -331.5409717167004, 373.0, 350.24952676359607, 222.89281275501543, 350.9897521249618, 352.4, 24.777397224683575, 392.01881502676133, 336.58364090241946, 353.3870584795874, 249.79999999999976, 402.0955537549525, 189.69999999999973, 257.29873361691915, 199.76069796958356], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [180.5024980961938, 24.35372111426544, 132.4412487442787, -151.62752690316736, 75.44514701281756, -480.67028975246603, 14.954907162515568, 2.739046646828399, -393.91730331730685, 31.439112258651214, -92.57680309977823, 153.5353074340732, -292.2052969451003, 82.90203657051302, 48.19099980747307, -270.843644223197, 192.06165727132378, 174.1676629937839, 200.0, -252.64095558922833, -62.530159716593126, 93.2022980913007, 126.99198338965161, 33.06816201014706, 119.81421658353861, -314.26163504831, -86.58286334393466, -178.75035305705063, -190.60125360193675, 0.6749746564405683, 176.0025315624591, -163.60927638345183, -109.27721580876076, -294.22769939563057, -132.51232225626222, 78.1819176022041, 42.21319461892828, -3.7582208520092575, -110.93446756161103, -440.82637447464657, -303.3581388632276, 112.82059328025018, 198.2, 192.02539194556556, -467.30630830999604, 160.03425473845832, -70.11094897261862, -39.78005888281817, -382.43118152763515, 137.67532354944007, 191.0, -422.9538355327178, 180.32633459379983, 43.614210953447284, -195.17578376451206, -362.4889920272242, -450.3413988376003, -352.92981300189984, 116.25582416391599, 71.22818767591176, 110.12380443747182, 131.0466341674877, -147.3317305633073, 0.8672011682063769, 72.88998915034854, 97.16535510903032, 34.34396407312333, 34.030543918496974, 158.69527547374167, 104.66409889533683, -144.3289916154417, -72.42012839499483, 88.56218484713614, 107.83724089636738, 131.19882139459193, -243.43966013323734, 99.84174764748576, -9.547358712794363, 133.0312201057774, 12.893133847693335, 79.81070795808868, 99.45589104363276, -360.78046010560087, 149.1566786681583, 77.12211861095545, -223.08491891428235, -102.60855114363909, -34.47412320764846, -80.2311558153814, -194.00377729291063, 117.29751766303906, 98.21901905309986, -254.13466547561978, 78.73934837802491, 123.82006867732329, 90.8131006927748, -152.33679706870433, -13.167031263338046, 191.9328495103309, 9.002316215792568, -4.352105021373603, 163.48469931538466, 161.8315567416615, 100.98321045699588, -211.109435999809, -22.579241879630956, -1.8047237792723365, 77.3207825207792, -169.46762314547814, 43.236461042141755, -54.68699101416402, -170.74055202293474, -31.237698921105533, 87.75676428617929, -34.784497546286744, 73.72603893402055, -140.34394248796136, 13.354622728811174, 40.05292478692816, -879.8194465413818, 76.50422951778319, 42.96537727333877, -106.75443916302125, 127.68425763517862, -232.70798286060986, -37.97975245485637, 198.2, 179.40354161407276, 46.548804327195555, -90.83710702756244, -215.84125403449877, -456.26801360571994, -643.6586044725198, 173.08359701613963, -122.0336186288181, 70.25344442481071, 77.27557107856276, 174.31450659158537, 167.52939359996896, -124.05191008636257, 146.5188739909586, 186.05720197471712, -0.47624612455982174, 156.04518210548878, 166.1719923080518, -420.4292949065666, 134.50342044375466, 143.6216228626208, -242.04601561003304, 177.43103580946698, -400.30369998964335, 136.44950402406917, 84.25450424000834, 162.21545377630537, 55.848951925435856, -42.106730181129194, 192.03750308972627, 144.5264252158003, 179.82973562774703, 11.844734615513298, 69.3588698273349, 17.74787733295585, 97.51874275376198, 45.092491141483336, 20.000000000000014, 66.54602511440008, 164.85455228865084, 143.38242055497113, 192.7422523532104, -271.43599451441514, -991.4073552038403, -772.2383634956594, 176.2296905011239, 157.58999003833486, 126.35817891342913, 126.5277976044736, 158.7219257357873, -631.264051134415, 149.78588410534275, 180.8388978791796, 134.8562439959651, 167.5778538922424, -422.84442736050863, -720.6736914276852, 165.6771332065046, -989.2135360685332, 127.65775200857658, 122.42392436267309, 179.96827064177637, 153.9908753547091, 168.43982317800348, -15.271759564574921, 192.3402520124228, 86.25678366999762, 168.5616498081313, -331.80109726725624, 65.79617846275357, 0.36548759444389134, -15.48367136996049, 51.22991987253212], "policy_predator_policy_reward": [9.597501903806227, 118.44627888573456, 89.08833490668191, 186.09568789398122, 63.721581904838665, 500.7451044278085, 158.97618170308564, 73.80414168194804, 295.5468089243032, 219.66624872511534, 49.81775966593352, 154.09751220904712, 302.8052969450999, 44.097963429487045, 282.8976651318815, 85.00940674985155, 3.9383427286762336, 13.8323370062161, 203.24897351537214, 124.31934732972188, 37.425934700501365, 91.90920566057575, 7.586626666212812, 111.79039042454208, 33.88578341646142, 319.7616350483097, 90.727444767995, 274.1057200950097, 236.9352296753798, 104.35188768327158, 5.507340489427223, 186.29940433156506, 79.55859379310428, 376.1457534665502, 220.69557893120032, 3.9556545190349377, 92.68162579352278, 72.04051777922527, 410.347613550066, 204.75092225465704, 311.8581388632294, 48.17940671974983, 2.136453939801311, 3.45795695917686, 470.0063083099961, 16.06574526154167, 108.35649804761562, 224.05356056407155, 331.4519208909516, 194.74103051785013, 0.0, 425.1538355327176, 9.673665406200183, 39.28578904655287, 264.44304642531273, 319.306423600708, 516.4569488454125, 390.71035450837826, 91.85335667759252, 14.14590348208326, 69.77892712544799, 14.32896077426696, 241.3317305633073, 19.097051621826125, 0.0, 135.4770069653402, 12.246486043583948, 217.17785338700435, 13.131000117238225, 82.70539035323033, 156.82899161544103, 157.72012839499465, 6.4991770933636, 111.41508314188589, 41.70117860540809, 252.73966013323744, 25.934424270641145, 117.92133367037263, 107.86433255565768, 35.111313490871616, 65.44781138262405, 52.18649747334572, 370.4804601056029, 10.343321331841706, 268.3660935255016, 31.983546184098348, 122.867579770682, 267.67234447532826, 208.97363039171995, 156.45050457156523, 66.14450635029273, 41.53222587666441, 264.03166740709554, 70.56305099992736, 2.086102304192898, 68.31703511885526, 147.0225562591089, 136.18127207293304, 4.067150489669106, 10.497683784207396, 90.76561178459932, 132.0906716557027, 7.668443258338492, 47.316789543004155, 245.69599246280958, 119.27055710353694, 83.59358523212127, 17.92021771969829, 182.46762314547738, 51.56353895785833, 310.0963316894964, 66.23301892274051, 168.23769892110553, 75.24323571382071, 163.91482637421018, 1.032074596330067, 153.94394248796056, 6.145377271188791, 757.0883516902529, 653.7602446150753, 24.68489071292548, 124.62866883328802, 119.85443916302053, 49.31574236482138, 334.5480890536337, 79.26581473685123, 0.0, 10.696458385927226, 139.85842416130984, 141.5430961127222, 234.00668918413405, 452.4620899095282, 647.1586044725199, 16.916402983860372, 25.248813906988392, 192.38409622217733, 75.42442892143728, 11.885493408414627, 9.070606400031053, 139.2519100863617, 26.681126009041385, 6.942798025282881, 141.7762461245598, 17.25481789451125, 370.83807280944524, 151.87657478961552, 50.49657955624533, 30.478377137379198, 238.77842708139903, 96.83650157716039, 404.40369998964417, 15.350495975930805, 65.68861100509173, 18.44143097859458, 109.15104807456414, 166.80673018112915, 42.47357478419972, 0.0, 14.643418919581483, 8.33605598501166, 31.041130172665216, 2.0521226670441357, 104.26632837697632, 45.922437727778316, 0.0, 87.45397488559992, 9.905660528210843, 18.41222727658089, 129.63987084458824, 232.0448007845805, 1071.1138305334507, 360.99091644934805, 12.770309498876106, 26.410009961665153, 50.509694037934814, 46.85385620775854, 63.0845520059449, 632.3503861476984, 20.364970140439446, 0.0, 49.14375600403491, 0.822146107757629, 440.2959386779679, 727.9995773349093, 261.8756013727883, 953.6796165160023, 84.24782319243008, 2.2541413387397222, 6.848317419545385, 12.57959506355661, 7.460176821996509, 89.17175956457436, 35.06840173140543, 88.43011634112665, 12.3383501918687, 340.60109726725574, 40.47478208562967, 150.66228547409204, 48.41392769679532, 115.60052177021666]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.028941928342416, "mean_inference_ms": 7.20595221511378, "mean_action_processing_ms": 4.5450258924667635, "mean_env_wait_ms": 1.6081691995924121, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006236553192138672, "StateBufferConnector_ms": 0.0031908750534057617, "ViewRequirementAgentConnector_ms": 0.0890352725982666}, "num_episodes": 23, "episode_return_max": 571.0820745508744, "episode_return_min": -331.5409717167004, "episode_return_mean": 230.09192141964348, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 17.233265576700603, "num_env_steps_trained_throughput_per_sec": 17.233265576700603, "timesteps_total": 112000, "num_env_steps_sampled_lifetime": 112000, "num_agent_steps_sampled_lifetime": 448000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 448000, "timers": {"training_iteration_time_ms": 178842.851, "restore_workers_time_ms": 0.013, "training_step_time_ms": 178842.81, "sample_time_ms": 1082.032, "learn_time_ms": 177748.279, "learn_throughput": 22.504, "synch_weights_time_ms": 11.41}, "counters": {"num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000}, "done": false, "training_iteration": 28, "trial_id": "cf3bb_00000", "date": "2024-08-20_09-06-44", "timestamp": 1724125004, "time_this_iter_s": 232.1562900543213, "time_total_s": 9268.46402144432, "pid": 25777, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39f71c790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 9268.46402144432, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 22.541269841269845, "ram_util_percent": 80.30317460317458}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.4482806663979929, "cur_kl_coeff": 0.0052734375, "cur_lr": 0.00010000000000000003, "total_loss": 1.15327121523953, "policy_loss": -0.0048794210752935475, "vf_loss": 1.1580695480738998, "vf_explained_var": 0.004719115438915435, "kl": 0.015376392456418845, "entropy": 1.5779456886034162, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 53865.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 18.339299157482607, "cur_kl_coeff": 0.0421875, "cur_lr": 0.00010000000000000003, "total_loss": 7.403341267348598, "policy_loss": -0.001617531548870146, "vf_loss": 7.404623931047147, "vf_explained_var": 0.5835497444268888, "kl": 0.00793776251912869, "entropy": 1.4917697716011573, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 53865.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_agent_steps_sampled": 464000, "num_agent_steps_trained": 464000}, "env_runners": {"episode_reward_max": 571.0820745508744, "episode_reward_min": -331.5409717167004, "episode_reward_mean": 238.49100063477027, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -991.4073552038403, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 198.2, "predator_policy": 1071.1138305334507}, "policy_reward_mean": {"prey_policy": -5.499439008189367, "predator_policy": 124.74493932557456}, "custom_metrics": {}, "hist_stats": {"episode_reward": [203.17711733966684, 63.33769376846632, 169.49999999999955, 395.8198028445437, 178.79999999999998, 222.51905075625035, 281.4370934306066, 193.19999999999996, 272.89999999999975, 26.08469423428388, 103.89609151429096, 293.4832719995036, 325.2783265046745, 113.96425279003233, 305.5323512247197, 297.7988474222086, 359.19576483954705, 97.79999999999987, 314.313685978753, 182.19999999999987, 234.15014687570522, 288.9, 296.90090785769115, 169.1999999999995, 154.386839406273, 253.45724989472265, 91.18920185499391, 323.193268943096, 159.1994013094281, 285.03630679314625, 117.69999999999963, 215.49999999999926, 381.98887773431306, 317.8, 131.2778716869071, 177.02986169332627, 107.79999999999981, 150.90180757513832, 300.0, 203.8884423582739, 33.1000000000002, 571.0820745508744, 268.7831663373354, 190.09999999999937, 143.12616847501894, 388.30000000000007, 237.113217573665, 14.359511453443481, 193.50000000000003, 165.85273592515833, 338.90000000000015, 191.7999999999994, 366.2, 314.6, 268.4573450005457, 359.1, 270.99994885799316, 155.8999999999999, 330.6, 289.70000000000005, 379.0375030897263, 214.6539451478528, 120.19999999999976, 292.8, 173.9999999999995, 336.55486064841375, 282.99092946796384, -331.5409717167004, 373.0, 350.24952676359607, 222.89281275501543, 350.9897521249618, 352.4, 24.777397224683575, 392.01881502676133, 336.58364090241946, 353.3870584795874, 249.79999999999976, 402.0955537549525, 189.69999999999973, 257.29873361691915, 199.76069796958356, 246.15891517861516, 342.1, 377.29999999999995, 160.59999999999954, 269.4986387128929, 191.5660742724536, 174.3, 203.09999999999934, 352.4917536885538, 363.3512830571252, 149.39999999999958, 180.39999999999944, 295.009411158519, 354.65654486650124, 21.53411993123355, 144.31973573226443, 371.4509348185436, 276.89999999999986], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [42.21319461892828, -3.7582208520092575, -110.93446756161103, -440.82637447464657, -303.3581388632276, 112.82059328025018, 198.2, 192.02539194556556, -467.30630830999604, 160.03425473845832, -70.11094897261862, -39.78005888281817, -382.43118152763515, 137.67532354944007, 191.0, -422.9538355327178, 180.32633459379983, 43.614210953447284, -195.17578376451206, -362.4889920272242, -450.3413988376003, -352.92981300189984, 116.25582416391599, 71.22818767591176, 110.12380443747182, 131.0466341674877, -147.3317305633073, 0.8672011682063769, 72.88998915034854, 97.16535510903032, 34.34396407312333, 34.030543918496974, 158.69527547374167, 104.66409889533683, -144.3289916154417, -72.42012839499483, 88.56218484713614, 107.83724089636738, 131.19882139459193, -243.43966013323734, 99.84174764748576, -9.547358712794363, 133.0312201057774, 12.893133847693335, 79.81070795808868, 99.45589104363276, -360.78046010560087, 149.1566786681583, 77.12211861095545, -223.08491891428235, -102.60855114363909, -34.47412320764846, -80.2311558153814, -194.00377729291063, 117.29751766303906, 98.21901905309986, -254.13466547561978, 78.73934837802491, 123.82006867732329, 90.8131006927748, -152.33679706870433, -13.167031263338046, 191.9328495103309, 9.002316215792568, -4.352105021373603, 163.48469931538466, 161.8315567416615, 100.98321045699588, -211.109435999809, -22.579241879630956, -1.8047237792723365, 77.3207825207792, -169.46762314547814, 43.236461042141755, -54.68699101416402, -170.74055202293474, -31.237698921105533, 87.75676428617929, -34.784497546286744, 73.72603893402055, -140.34394248796136, 13.354622728811174, 40.05292478692816, -879.8194465413818, 76.50422951778319, 42.96537727333877, -106.75443916302125, 127.68425763517862, -232.70798286060986, -37.97975245485637, 198.2, 179.40354161407276, 46.548804327195555, -90.83710702756244, -215.84125403449877, -456.26801360571994, -643.6586044725198, 173.08359701613963, -122.0336186288181, 70.25344442481071, 77.27557107856276, 174.31450659158537, 167.52939359996896, -124.05191008636257, 146.5188739909586, 186.05720197471712, -0.47624612455982174, 156.04518210548878, 166.1719923080518, -420.4292949065666, 134.50342044375466, 143.6216228626208, -242.04601561003304, 177.43103580946698, -400.30369998964335, 136.44950402406917, 84.25450424000834, 162.21545377630537, 55.848951925435856, -42.106730181129194, 192.03750308972627, 144.5264252158003, 179.82973562774703, 11.844734615513298, 69.3588698273349, 17.74787733295585, 97.51874275376198, 45.092491141483336, 20.000000000000014, 66.54602511440008, 164.85455228865084, 143.38242055497113, 192.7422523532104, -271.43599451441514, -991.4073552038403, -772.2383634956594, 176.2296905011239, 157.58999003833486, 126.35817891342913, 126.5277976044736, 158.7219257357873, -631.264051134415, 149.78588410534275, 180.8388978791796, 134.8562439959651, 167.5778538922424, -422.84442736050863, -720.6736914276852, 165.6771332065046, -989.2135360685332, 127.65775200857658, 122.42392436267309, 179.96827064177637, 153.9908753547091, 168.43982317800348, -15.271759564574921, 192.3402520124228, 86.25678366999762, 168.5616498081313, -331.80109726725624, 65.79617846275357, 0.36548759444389134, -15.48367136996049, 51.22991987253212, 7.827133252196411, 183.22531600482313, 135.8613239879373, 90.5221453812078, 167.47587379292, 166.98005422548422, -12.87370185737257, 102.87393782920802, 9.850663542000433, 106.3873127266509, 14.68227809111333, -78.35758409509631, -12.62339478685577, 52.9749574325014, 20.000000000000014, 175.8157666772115, 56.3344751313969, 181.63595532855933, 139.74000278023613, 186.1054394661664, 130.7, -1.1727346028392307, 111.9003493721645, 11.636111593875112, 138.94995999745476, 46.86900245388463, 191.27040320301438, 117.16375534121855, -9.878863310916397, -16.03824097532508, -122.28386101922354, 2.809807218129123, 196.2662949792125, 138.73910880496604, 38.999164946409834, 152.82591544777034], "policy_predator_policy_reward": [92.68162579352278, 72.04051777922527, 410.347613550066, 204.75092225465704, 311.8581388632294, 48.17940671974983, 2.136453939801311, 3.45795695917686, 470.0063083099961, 16.06574526154167, 108.35649804761562, 224.05356056407155, 331.4519208909516, 194.74103051785013, 0.0, 425.1538355327176, 9.673665406200183, 39.28578904655287, 264.44304642531273, 319.306423600708, 516.4569488454125, 390.71035450837826, 91.85335667759252, 14.14590348208326, 69.77892712544799, 14.32896077426696, 241.3317305633073, 19.097051621826125, 0.0, 135.4770069653402, 12.246486043583948, 217.17785338700435, 13.131000117238225, 82.70539035323033, 156.82899161544103, 157.72012839499465, 6.4991770933636, 111.41508314188589, 41.70117860540809, 252.73966013323744, 25.934424270641145, 117.92133367037263, 107.86433255565768, 35.111313490871616, 65.44781138262405, 52.18649747334572, 370.4804601056029, 10.343321331841706, 268.3660935255016, 31.983546184098348, 122.867579770682, 267.67234447532826, 208.97363039171995, 156.45050457156523, 66.14450635029273, 41.53222587666441, 264.03166740709554, 70.56305099992736, 2.086102304192898, 68.31703511885526, 147.0225562591089, 136.18127207293304, 4.067150489669106, 10.497683784207396, 90.76561178459932, 132.0906716557027, 7.668443258338492, 47.316789543004155, 245.69599246280958, 119.27055710353694, 83.59358523212127, 17.92021771969829, 182.46762314547738, 51.56353895785833, 310.0963316894964, 66.23301892274051, 168.23769892110553, 75.24323571382071, 163.91482637421018, 1.032074596330067, 153.94394248796056, 6.145377271188791, 757.0883516902529, 653.7602446150753, 24.68489071292548, 124.62866883328802, 119.85443916302053, 49.31574236482138, 334.5480890536337, 79.26581473685123, 0.0, 10.696458385927226, 139.85842416130984, 141.5430961127222, 234.00668918413405, 452.4620899095282, 647.1586044725199, 16.916402983860372, 25.248813906988392, 192.38409622217733, 75.42442892143728, 11.885493408414627, 9.070606400031053, 139.2519100863617, 26.681126009041385, 6.942798025282881, 141.7762461245598, 17.25481789451125, 370.83807280944524, 151.87657478961552, 50.49657955624533, 30.478377137379198, 238.77842708139903, 96.83650157716039, 404.40369998964417, 15.350495975930805, 65.68861100509173, 18.44143097859458, 109.15104807456414, 166.80673018112915, 42.47357478419972, 0.0, 14.643418919581483, 8.33605598501166, 31.041130172665216, 2.0521226670441357, 104.26632837697632, 45.922437727778316, 0.0, 87.45397488559992, 9.905660528210843, 18.41222727658089, 129.63987084458824, 232.0448007845805, 1071.1138305334507, 360.99091644934805, 12.770309498876106, 26.410009961665153, 50.509694037934814, 46.85385620775854, 63.0845520059449, 632.3503861476984, 20.364970140439446, 0.0, 49.14375600403491, 0.822146107757629, 440.2959386779679, 727.9995773349093, 261.8756013727883, 953.6796165160023, 84.24782319243008, 2.2541413387397222, 6.848317419545385, 12.57959506355661, 7.460176821996509, 89.17175956457436, 35.06840173140543, 88.43011634112665, 12.3383501918687, 340.60109726725574, 40.47478208562967, 150.66228547409204, 48.41392769679532, 115.60052177021666, 36.58559896413648, 18.52086695745988, 41.738676012062705, 73.97785461879216, 22.63847642677565, 20.205595554820135, 30.67370185737276, 39.926062170791994, 1.5219788315368443, 151.7386836127047, 195.03591434632716, 60.20546593010995, 116.32339478685545, 17.625042567498582, 0.0, 7.284233322788478, 22.550952510543226, 91.9703707180543, 35.8523371262574, 1.6535036844652997, 0.0, 19.872734602839245, 49.09965062783551, 7.763888406124853, 5.103458148099445, 104.08699055908032, 40.78895362911247, 5.4334326931557895, 7.333930076127084, 40.11729414134833, 245.99496233591432, 17.798827197444567, 0.8846398393310961, 35.56089119503397, 59.900835053590264, 25.17408455222964]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9781839440941895, "mean_inference_ms": 7.0003426395130575, "mean_action_processing_ms": 4.3976551535905966, "mean_env_wait_ms": 1.5586156429476279, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0057904720306396484, "StateBufferConnector_ms": 0.003158092498779297, "ViewRequirementAgentConnector_ms": 0.08829247951507568}, "num_episodes": 18, "episode_return_max": 571.0820745508744, "episode_return_min": -331.5409717167004, "episode_return_mean": 238.49100063477027, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 464000, "num_agent_steps_trained": 464000, "num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 87.08596359845282, "num_env_steps_trained_throughput_per_sec": 87.08596359845282, "timesteps_total": 116000, "num_env_steps_sampled_lifetime": 116000, "num_agent_steps_sampled_lifetime": 464000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 464000, "timers": {"training_iteration_time_ms": 174254.11, "restore_workers_time_ms": 0.013, "training_step_time_ms": 174254.069, "sample_time_ms": 1081.168, "learn_time_ms": 173160.324, "learn_throughput": 23.1, "synch_weights_time_ms": 11.475}, "counters": {"num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_agent_steps_sampled": 464000, "num_agent_steps_trained": 464000}, "done": false, "training_iteration": 29, "trial_id": "cf3bb_00000", "date": "2024-08-20_09-07-30", "timestamp": 1724125050, "time_this_iter_s": 45.93536901473999, "time_total_s": 9314.39939045906, "pid": 25777, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39f78f670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 9314.39939045906, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 18.868253968253967, "ram_util_percent": 79.81904761904762}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9334946854128724, "cur_kl_coeff": 0.0052734375, "cur_lr": 0.00010000000000000003, "total_loss": 2.5795368162412493, "policy_loss": -0.005789681956930845, "vf_loss": 2.5852597774651946, "vf_explained_var": 0.010939887686381265, "kl": 0.012652759865329682, "entropy": 1.5824769555576264, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 55755.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 20.14724165762543, "cur_kl_coeff": 0.0421875, "cur_lr": 0.00010000000000000003, "total_loss": 7.484396560608395, "policy_loss": -0.0058582216713124165, "vf_loss": 7.489532500726205, "vf_explained_var": 0.24551495439791807, "kl": 0.0171207361606288, "entropy": 1.4229939339022157, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 55755.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000}, "env_runners": {"episode_reward_max": 571.0820745508744, "episode_reward_min": -331.5409717167004, "episode_reward_mean": 243.72797639086366, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -991.4073552038403, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 198.2, "predator_policy": 1071.1138305334507}, "policy_reward_mean": {"prey_policy": 18.821199259487834, "predator_policy": 103.04278893594403}, "custom_metrics": {}, "hist_stats": {"episode_reward": [314.313685978753, 182.19999999999987, 234.15014687570522, 288.9, 296.90090785769115, 169.1999999999995, 154.386839406273, 253.45724989472265, 91.18920185499391, 323.193268943096, 159.1994013094281, 285.03630679314625, 117.69999999999963, 215.49999999999926, 381.98887773431306, 317.8, 131.2778716869071, 177.02986169332627, 107.79999999999981, 150.90180757513832, 300.0, 203.8884423582739, 33.1000000000002, 571.0820745508744, 268.7831663373354, 190.09999999999937, 143.12616847501894, 388.30000000000007, 237.113217573665, 14.359511453443481, 193.50000000000003, 165.85273592515833, 338.90000000000015, 191.7999999999994, 366.2, 314.6, 268.4573450005457, 359.1, 270.99994885799316, 155.8999999999999, 330.6, 289.70000000000005, 379.0375030897263, 214.6539451478528, 120.19999999999976, 292.8, 173.9999999999995, 336.55486064841375, 282.99092946796384, -331.5409717167004, 373.0, 350.24952676359607, 222.89281275501543, 350.9897521249618, 352.4, 24.777397224683575, 392.01881502676133, 336.58364090241946, 353.3870584795874, 249.79999999999976, 402.0955537549525, 189.69999999999973, 257.29873361691915, 199.76069796958356, 246.15891517861516, 342.1, 377.29999999999995, 160.59999999999954, 269.4986387128929, 191.5660742724536, 174.3, 203.09999999999934, 352.4917536885538, 363.3512830571252, 149.39999999999958, 180.39999999999944, 295.009411158519, 354.65654486650124, 21.53411993123355, 144.31973573226443, 371.4509348185436, 276.89999999999986, 188.79999999999941, 356.3994937506884, 176.0999999999995, 114.89999999999978, 274.1, 141.0999999999993, 202.39999999999935, 167.39999999999952, 149.49999999999957, 187.89999999999944, 381.0, 305.32244052744323, 310.1, 327.59999999999997, 268.4999999999999, 378.0, 327.5, 170.7999999999995], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [88.56218484713614, 107.83724089636738, 131.19882139459193, -243.43966013323734, 99.84174764748576, -9.547358712794363, 133.0312201057774, 12.893133847693335, 79.81070795808868, 99.45589104363276, -360.78046010560087, 149.1566786681583, 77.12211861095545, -223.08491891428235, -102.60855114363909, -34.47412320764846, -80.2311558153814, -194.00377729291063, 117.29751766303906, 98.21901905309986, -254.13466547561978, 78.73934837802491, 123.82006867732329, 90.8131006927748, -152.33679706870433, -13.167031263338046, 191.9328495103309, 9.002316215792568, -4.352105021373603, 163.48469931538466, 161.8315567416615, 100.98321045699588, -211.109435999809, -22.579241879630956, -1.8047237792723365, 77.3207825207792, -169.46762314547814, 43.236461042141755, -54.68699101416402, -170.74055202293474, -31.237698921105533, 87.75676428617929, -34.784497546286744, 73.72603893402055, -140.34394248796136, 13.354622728811174, 40.05292478692816, -879.8194465413818, 76.50422951778319, 42.96537727333877, -106.75443916302125, 127.68425763517862, -232.70798286060986, -37.97975245485637, 198.2, 179.40354161407276, 46.548804327195555, -90.83710702756244, -215.84125403449877, -456.26801360571994, -643.6586044725198, 173.08359701613963, -122.0336186288181, 70.25344442481071, 77.27557107856276, 174.31450659158537, 167.52939359996896, -124.05191008636257, 146.5188739909586, 186.05720197471712, -0.47624612455982174, 156.04518210548878, 166.1719923080518, -420.4292949065666, 134.50342044375466, 143.6216228626208, -242.04601561003304, 177.43103580946698, -400.30369998964335, 136.44950402406917, 84.25450424000834, 162.21545377630537, 55.848951925435856, -42.106730181129194, 192.03750308972627, 144.5264252158003, 179.82973562774703, 11.844734615513298, 69.3588698273349, 17.74787733295585, 97.51874275376198, 45.092491141483336, 20.000000000000014, 66.54602511440008, 164.85455228865084, 143.38242055497113, 192.7422523532104, -271.43599451441514, -991.4073552038403, -772.2383634956594, 176.2296905011239, 157.58999003833486, 126.35817891342913, 126.5277976044736, 158.7219257357873, -631.264051134415, 149.78588410534275, 180.8388978791796, 134.8562439959651, 167.5778538922424, -422.84442736050863, -720.6736914276852, 165.6771332065046, -989.2135360685332, 127.65775200857658, 122.42392436267309, 179.96827064177637, 153.9908753547091, 168.43982317800348, -15.271759564574921, 192.3402520124228, 86.25678366999762, 168.5616498081313, -331.80109726725624, 65.79617846275357, 0.36548759444389134, -15.48367136996049, 51.22991987253212, 7.827133252196411, 183.22531600482313, 135.8613239879373, 90.5221453812078, 167.47587379292, 166.98005422548422, -12.87370185737257, 102.87393782920802, 9.850663542000433, 106.3873127266509, 14.68227809111333, -78.35758409509631, -12.62339478685577, 52.9749574325014, 20.000000000000014, 175.8157666772115, 56.3344751313969, 181.63595532855933, 139.74000278023613, 186.1054394661664, 130.7, -1.1727346028392307, 111.9003493721645, 11.636111593875112, 138.94995999745476, 46.86900245388463, 191.27040320301438, 117.16375534121855, -9.878863310916397, -16.03824097532508, -122.28386101922354, 2.809807218129123, 196.2662949792125, 138.73910880496604, 38.999164946409834, 152.82591544777034, 141.93096035234674, 12.537013783073792, 121.27664366720255, 136.67520030929433, 120.06265854929819, 20.000000000000014, -89.57140937961839, -178.7331021130408, 97.55629555094305, 38.31082132888957, -3.8363121691916, 9.23980246034803, 172.43614664839157, 16.158258584440645, 20.000000000000014, 67.83492221052191, 17.033601244088413, 129.79999999999998, 129.97478837819347, -10.504070326465134, 177.82436473630707, 178.9210884188424, 64.27230906135699, 113.51316016013477, 134.9213696020419, 155.94177828327315, 194.26122118165074, 120.1437821710866, 95.40397085526197, 121.57437596529405, 193.97049056845574, 167.1610464010437, 197.3, 125.58685883095518, 72.70818795539077, 5.185238996328712], "policy_predator_policy_reward": [6.4991770933636, 111.41508314188589, 41.70117860540809, 252.73966013323744, 25.934424270641145, 117.92133367037263, 107.86433255565768, 35.111313490871616, 65.44781138262405, 52.18649747334572, 370.4804601056029, 10.343321331841706, 268.3660935255016, 31.983546184098348, 122.867579770682, 267.67234447532826, 208.97363039171995, 156.45050457156523, 66.14450635029273, 41.53222587666441, 264.03166740709554, 70.56305099992736, 2.086102304192898, 68.31703511885526, 147.0225562591089, 136.18127207293304, 4.067150489669106, 10.497683784207396, 90.76561178459932, 132.0906716557027, 7.668443258338492, 47.316789543004155, 245.69599246280958, 119.27055710353694, 83.59358523212127, 17.92021771969829, 182.46762314547738, 51.56353895785833, 310.0963316894964, 66.23301892274051, 168.23769892110553, 75.24323571382071, 163.91482637421018, 1.032074596330067, 153.94394248796056, 6.145377271188791, 757.0883516902529, 653.7602446150753, 24.68489071292548, 124.62866883328802, 119.85443916302053, 49.31574236482138, 334.5480890536337, 79.26581473685123, 0.0, 10.696458385927226, 139.85842416130984, 141.5430961127222, 234.00668918413405, 452.4620899095282, 647.1586044725199, 16.916402983860372, 25.248813906988392, 192.38409622217733, 75.42442892143728, 11.885493408414627, 9.070606400031053, 139.2519100863617, 26.681126009041385, 6.942798025282881, 141.7762461245598, 17.25481789451125, 370.83807280944524, 151.87657478961552, 50.49657955624533, 30.478377137379198, 238.77842708139903, 96.83650157716039, 404.40369998964417, 15.350495975930805, 65.68861100509173, 18.44143097859458, 109.15104807456414, 166.80673018112915, 42.47357478419972, 0.0, 14.643418919581483, 8.33605598501166, 31.041130172665216, 2.0521226670441357, 104.26632837697632, 45.922437727778316, 0.0, 87.45397488559992, 9.905660528210843, 18.41222727658089, 129.63987084458824, 232.0448007845805, 1071.1138305334507, 360.99091644934805, 12.770309498876106, 26.410009961665153, 50.509694037934814, 46.85385620775854, 63.0845520059449, 632.3503861476984, 20.364970140439446, 0.0, 49.14375600403491, 0.822146107757629, 440.2959386779679, 727.9995773349093, 261.8756013727883, 953.6796165160023, 84.24782319243008, 2.2541413387397222, 6.848317419545385, 12.57959506355661, 7.460176821996509, 89.17175956457436, 35.06840173140543, 88.43011634112665, 12.3383501918687, 340.60109726725574, 40.47478208562967, 150.66228547409204, 48.41392769679532, 115.60052177021666, 36.58559896413648, 18.52086695745988, 41.738676012062705, 73.97785461879216, 22.63847642677565, 20.205595554820135, 30.67370185737276, 39.926062170791994, 1.5219788315368443, 151.7386836127047, 195.03591434632716, 60.20546593010995, 116.32339478685545, 17.625042567498582, 0.0, 7.284233322788478, 22.550952510543226, 91.9703707180543, 35.8523371262574, 1.6535036844652997, 0.0, 19.872734602839245, 49.09965062783551, 7.763888406124853, 5.103458148099445, 104.08699055908032, 40.78895362911247, 5.4334326931557895, 7.333930076127084, 40.11729414134833, 245.99496233591432, 17.798827197444567, 0.8846398393310961, 35.56089119503397, 59.900835053590264, 25.17408455222964, 27.569039647653273, 6.762986216926173, 40.53377997432222, 57.91386979986935, 14.493804167701432, 21.54353728300038, 190.5714093796184, 192.63310211304002, 35.966655246803256, 102.26622787336413, 21.93631216919164, 113.760197539652, 10.263853351608425, 3.5417414155593177, 18.79917916844107, 60.76589862103702, 2.666398755911564, 0.0, 40.025211621806534, 28.40407032646527, 12.175635263692936, 12.078911581157605, 92.11804540351582, 35.418925902435596, 6.768589476982754, 12.468262637702185, 0.0, 13.194996647262618, 2.6960291447380227, 48.825624034705946, 3.029509431544247, 13.838953598956296, 0.0, 4.61314116904483, 1.1230255518516847, 91.78354749642881]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9311448514992333, "mean_inference_ms": 6.809399174013934, "mean_action_processing_ms": 4.260909689397632, "mean_env_wait_ms": 1.5126149861145617, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005414366722106934, "StateBufferConnector_ms": 0.0031543970108032227, "ViewRequirementAgentConnector_ms": 0.09069132804870605}, "num_episodes": 18, "episode_return_max": 571.0820745508744, "episode_return_min": -331.5409717167004, "episode_return_mean": 243.72797639086366, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 85.90228787406637, "num_env_steps_trained_throughput_per_sec": 85.90228787406637, "timesteps_total": 120000, "num_env_steps_sampled_lifetime": 120000, "num_agent_steps_sampled_lifetime": 480000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 480000, "timers": {"training_iteration_time_ms": 121646.101, "restore_workers_time_ms": 0.013, "training_step_time_ms": 121646.06, "sample_time_ms": 1077.846, "learn_time_ms": 120556.472, "learn_throughput": 33.179, "synch_weights_time_ms": 10.645}, "counters": {"num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000}, "done": false, "training_iteration": 30, "trial_id": "cf3bb_00000", "date": "2024-08-20_09-08-16", "timestamp": 1724125096, "time_this_iter_s": 46.601884841918945, "time_total_s": 9361.00127530098, "pid": 25777, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39f81ab80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 9361.00127530098, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 30.172727272727272, "ram_util_percent": 80.63636363636364}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8483603803569046, "cur_kl_coeff": 0.0052734375, "cur_lr": 0.00010000000000000003, "total_loss": 3.4190776008777517, "policy_loss": -0.004353707044129137, "vf_loss": 3.4233877411595097, "vf_explained_var": 0.005541209442905648, "kl": 0.008261870437103809, "entropy": 1.5756616779105372, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 57645.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 19.913079484966065, "cur_kl_coeff": 0.0421875, "cur_lr": 0.00010000000000000003, "total_loss": 6.914084343683152, "policy_loss": -0.0036013305635639913, "vf_loss": 6.9169725069924, "vf_explained_var": 0.18652813592285075, "kl": 0.016904647419237806, "entropy": 1.3801949357229566, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 57645.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_agent_steps_sampled": 496000, "num_agent_steps_trained": 496000}, "env_runners": {"episode_reward_max": 571.0820745508744, "episode_reward_min": -331.5409717167004, "episode_reward_mean": 241.03271508779483, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -991.4073552038403, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 198.2, "predator_policy": 1071.1138305334507}, "policy_reward_mean": {"prey_policy": 20.23549902758644, "predator_policy": 100.28085851631106}, "custom_metrics": {}, "hist_stats": {"episode_reward": [107.79999999999981, 150.90180757513832, 300.0, 203.8884423582739, 33.1000000000002, 571.0820745508744, 268.7831663373354, 190.09999999999937, 143.12616847501894, 388.30000000000007, 237.113217573665, 14.359511453443481, 193.50000000000003, 165.85273592515833, 338.90000000000015, 191.7999999999994, 366.2, 314.6, 268.4573450005457, 359.1, 270.99994885799316, 155.8999999999999, 330.6, 289.70000000000005, 379.0375030897263, 214.6539451478528, 120.19999999999976, 292.8, 173.9999999999995, 336.55486064841375, 282.99092946796384, -331.5409717167004, 373.0, 350.24952676359607, 222.89281275501543, 350.9897521249618, 352.4, 24.777397224683575, 392.01881502676133, 336.58364090241946, 353.3870584795874, 249.79999999999976, 402.0955537549525, 189.69999999999973, 257.29873361691915, 199.76069796958356, 246.15891517861516, 342.1, 377.29999999999995, 160.59999999999954, 269.4986387128929, 191.5660742724536, 174.3, 203.09999999999934, 352.4917536885538, 363.3512830571252, 149.39999999999958, 180.39999999999944, 295.009411158519, 354.65654486650124, 21.53411993123355, 144.31973573226443, 371.4509348185436, 276.89999999999986, 188.79999999999941, 356.3994937506884, 176.0999999999995, 114.89999999999978, 274.1, 141.0999999999993, 202.39999999999935, 167.39999999999952, 149.49999999999957, 187.89999999999944, 381.0, 305.32244052744323, 310.1, 327.59999999999997, 268.4999999999999, 378.0, 327.5, 170.7999999999995, 76.05492752030506, 140.0999999999993, 375.9, 392.012119674743, 200.92778911406796, 201.39999999999935, 47.84213254919485, 359.0, 123.0999999999995, 146.39999999999964, 359.4408117406906, 142.19999999999968, 122.99999999999947, 309.5451731417147, 319.5, 165.9999999999995, 130.0745359807612, 211.3999999999993], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-169.46762314547814, 43.236461042141755, -54.68699101416402, -170.74055202293474, -31.237698921105533, 87.75676428617929, -34.784497546286744, 73.72603893402055, -140.34394248796136, 13.354622728811174, 40.05292478692816, -879.8194465413818, 76.50422951778319, 42.96537727333877, -106.75443916302125, 127.68425763517862, -232.70798286060986, -37.97975245485637, 198.2, 179.40354161407276, 46.548804327195555, -90.83710702756244, -215.84125403449877, -456.26801360571994, -643.6586044725198, 173.08359701613963, -122.0336186288181, 70.25344442481071, 77.27557107856276, 174.31450659158537, 167.52939359996896, -124.05191008636257, 146.5188739909586, 186.05720197471712, -0.47624612455982174, 156.04518210548878, 166.1719923080518, -420.4292949065666, 134.50342044375466, 143.6216228626208, -242.04601561003304, 177.43103580946698, -400.30369998964335, 136.44950402406917, 84.25450424000834, 162.21545377630537, 55.848951925435856, -42.106730181129194, 192.03750308972627, 144.5264252158003, 179.82973562774703, 11.844734615513298, 69.3588698273349, 17.74787733295585, 97.51874275376198, 45.092491141483336, 20.000000000000014, 66.54602511440008, 164.85455228865084, 143.38242055497113, 192.7422523532104, -271.43599451441514, -991.4073552038403, -772.2383634956594, 176.2296905011239, 157.58999003833486, 126.35817891342913, 126.5277976044736, 158.7219257357873, -631.264051134415, 149.78588410534275, 180.8388978791796, 134.8562439959651, 167.5778538922424, -422.84442736050863, -720.6736914276852, 165.6771332065046, -989.2135360685332, 127.65775200857658, 122.42392436267309, 179.96827064177637, 153.9908753547091, 168.43982317800348, -15.271759564574921, 192.3402520124228, 86.25678366999762, 168.5616498081313, -331.80109726725624, 65.79617846275357, 0.36548759444389134, -15.48367136996049, 51.22991987253212, 7.827133252196411, 183.22531600482313, 135.8613239879373, 90.5221453812078, 167.47587379292, 166.98005422548422, -12.87370185737257, 102.87393782920802, 9.850663542000433, 106.3873127266509, 14.68227809111333, -78.35758409509631, -12.62339478685577, 52.9749574325014, 20.000000000000014, 175.8157666772115, 56.3344751313969, 181.63595532855933, 139.74000278023613, 186.1054394661664, 130.7, -1.1727346028392307, 111.9003493721645, 11.636111593875112, 138.94995999745476, 46.86900245388463, 191.27040320301438, 117.16375534121855, -9.878863310916397, -16.03824097532508, -122.28386101922354, 2.809807218129123, 196.2662949792125, 138.73910880496604, 38.999164946409834, 152.82591544777034, 141.93096035234674, 12.537013783073792, 121.27664366720255, 136.67520030929433, 120.06265854929819, 20.000000000000014, -89.57140937961839, -178.7331021130408, 97.55629555094305, 38.31082132888957, -3.8363121691916, 9.23980246034803, 172.43614664839157, 16.158258584440645, 20.000000000000014, 67.83492221052191, 17.033601244088413, 129.79999999999998, 129.97478837819347, -10.504070326465134, 177.82436473630707, 178.9210884188424, 64.27230906135699, 113.51316016013477, 134.9213696020419, 155.94177828327315, 194.26122118165074, 120.1437821710866, 95.40397085526197, 121.57437596529405, 193.97049056845574, 167.1610464010437, 197.3, 125.58685883095518, 72.70818795539077, 5.185238996328712, -172.07002735718368, -174.5711090144984, 3.3325345202071923, -11.083368170115769, 194.1571199560268, 165.0720436148002, 188.28273785050683, 105.11395376475377, -168.51262130606605, 94.96877919353885, 146.7476315453641, -23.637968708282138, 18.031464529144532, -24.937682578394195, 141.3289035981866, 169.73873565462702, -88.95973924488548, -259.24991827094084, 11.118230908814425, -364.6908521580822, 137.28021844972517, 180.8407696841557, -82.2449902702545, 2.838296208711377, -49.668605592921224, -36.32408439387254, 64.83791445171016, 145.31096023529568, 173.9, 114.28361947385156, 75.69067309857085, 20.000000000000014, -209.37412819554362, -117.81239877978615, 183.81662908475147, 14.006440269655876], "policy_predator_policy_reward": [182.46762314547738, 51.56353895785833, 310.0963316894964, 66.23301892274051, 168.23769892110553, 75.24323571382071, 163.91482637421018, 1.032074596330067, 153.94394248796056, 6.145377271188791, 757.0883516902529, 653.7602446150753, 24.68489071292548, 124.62866883328802, 119.85443916302053, 49.31574236482138, 334.5480890536337, 79.26581473685123, 0.0, 10.696458385927226, 139.85842416130984, 141.5430961127222, 234.00668918413405, 452.4620899095282, 647.1586044725199, 16.916402983860372, 25.248813906988392, 192.38409622217733, 75.42442892143728, 11.885493408414627, 9.070606400031053, 139.2519100863617, 26.681126009041385, 6.942798025282881, 141.7762461245598, 17.25481789451125, 370.83807280944524, 151.87657478961552, 50.49657955624533, 30.478377137379198, 238.77842708139903, 96.83650157716039, 404.40369998964417, 15.350495975930805, 65.68861100509173, 18.44143097859458, 109.15104807456414, 166.80673018112915, 42.47357478419972, 0.0, 14.643418919581483, 8.33605598501166, 31.041130172665216, 2.0521226670441357, 104.26632837697632, 45.922437727778316, 0.0, 87.45397488559992, 9.905660528210843, 18.41222727658089, 129.63987084458824, 232.0448007845805, 1071.1138305334507, 360.99091644934805, 12.770309498876106, 26.410009961665153, 50.509694037934814, 46.85385620775854, 63.0845520059449, 632.3503861476984, 20.364970140439446, 0.0, 49.14375600403491, 0.822146107757629, 440.2959386779679, 727.9995773349093, 261.8756013727883, 953.6796165160023, 84.24782319243008, 2.2541413387397222, 6.848317419545385, 12.57959506355661, 7.460176821996509, 89.17175956457436, 35.06840173140543, 88.43011634112665, 12.3383501918687, 340.60109726725574, 40.47478208562967, 150.66228547409204, 48.41392769679532, 115.60052177021666, 36.58559896413648, 18.52086695745988, 41.738676012062705, 73.97785461879216, 22.63847642677565, 20.205595554820135, 30.67370185737276, 39.926062170791994, 1.5219788315368443, 151.7386836127047, 195.03591434632716, 60.20546593010995, 116.32339478685545, 17.625042567498582, 0.0, 7.284233322788478, 22.550952510543226, 91.9703707180543, 35.8523371262574, 1.6535036844652997, 0.0, 19.872734602839245, 49.09965062783551, 7.763888406124853, 5.103458148099445, 104.08699055908032, 40.78895362911247, 5.4334326931557895, 7.333930076127084, 40.11729414134833, 245.99496233591432, 17.798827197444567, 0.8846398393310961, 35.56089119503397, 59.900835053590264, 25.17408455222964, 27.569039647653273, 6.762986216926173, 40.53377997432222, 57.91386979986935, 14.493804167701432, 21.54353728300038, 190.5714093796184, 192.63310211304002, 35.966655246803256, 102.26622787336413, 21.93631216919164, 113.760197539652, 10.263853351608425, 3.5417414155593177, 18.79917916844107, 60.76589862103702, 2.666398755911564, 0.0, 40.025211621806534, 28.40407032646527, 12.175635263692936, 12.078911581157605, 92.11804540351582, 35.418925902435596, 6.768589476982754, 12.468262637702185, 0.0, 13.194996647262618, 2.6960291447380227, 48.825624034705946, 3.029509431544247, 13.838953598956296, 0.0, 4.61314116904483, 1.1230255518516847, 91.78354749642881, 133.04454189617266, 289.6515219958147, 139.61272784852358, 8.238105801384977, 14.492920700361227, 2.1779157288117776, 48.984766534250156, 49.630661525231936, 238.74631996086023, 35.725311265735, 37.252368454635906, 41.037968708282385, 38.353851436581834, 16.394499161862505, 29.671096401813422, 18.26126434537296, 200.95973924488533, 270.34991827094314, 127.88176909118565, 372.0908521580833, 6.5696940867445655, 34.750129520065194, 96.44499027025373, 125.16170379128862, 166.19453404607805, 42.79815594071564, 8.49481376701747, 90.90148468769141, 0.0, 31.316380526148514, 70.30932690142915, 0.0, 97.26603410450116, 359.9950288515898, 8.18337091524852, 5.39355973034409]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8890156111096628, "mean_inference_ms": 6.637284845365456, "mean_action_processing_ms": 4.134377799798193, "mean_env_wait_ms": 1.470466722630623, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005205988883972168, "StateBufferConnector_ms": 0.005835413932800293, "ViewRequirementAgentConnector_ms": 0.10845553874969482}, "num_episodes": 18, "episode_return_max": 571.0820745508744, "episode_return_min": -331.5409717167004, "episode_return_mean": 241.03271508779483, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 496000, "num_agent_steps_trained": 496000, "num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 85.49841683961905, "num_env_steps_trained_throughput_per_sec": 85.49841683961905, "timesteps_total": 124000, "num_env_steps_sampled_lifetime": 124000, "num_agent_steps_sampled_lifetime": 496000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 496000, "timers": {"training_iteration_time_ms": 117321.821, "restore_workers_time_ms": 0.013, "training_step_time_ms": 117321.781, "sample_time_ms": 1079.718, "learn_time_ms": 116230.355, "learn_throughput": 34.414, "synch_weights_time_ms": 10.575}, "counters": {"num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_agent_steps_sampled": 496000, "num_agent_steps_trained": 496000}, "done": false, "training_iteration": 31, "trial_id": "cf3bb_00000", "date": "2024-08-20_09-09-03", "timestamp": 1724125143, "time_this_iter_s": 46.846773862838745, "time_total_s": 9407.848049163818, "pid": 25777, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39f77d430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 9407.848049163818, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 32.562686567164185, "ram_util_percent": 78.36865671641789}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9250882630586309, "cur_kl_coeff": 0.0052734375, "cur_lr": 0.00010000000000000003, "total_loss": 5.49561565540455, "policy_loss": -0.003602525904262192, "vf_loss": 5.499144894231564, "vf_explained_var": 0.0021560041362015656, "kl": 0.013894863989963455, "entropy": 1.5457801407607143, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 59535.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 16.519153467546065, "cur_kl_coeff": 0.0421875, "cur_lr": 0.00010000000000000003, "total_loss": 8.766901914152518, "policy_loss": -0.0020613098775760993, "vf_loss": 8.768542120696376, "vf_explained_var": 0.26809860616133957, "kl": 0.00998129693585663, "entropy": 1.41838441260908, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 59535.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 512000, "num_agent_steps_trained": 512000}, "env_runners": {"episode_reward_max": 402.0955537549525, "episode_reward_min": -331.5409717167004, "episode_reward_mean": 224.24629282734205, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -991.4073552038403, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 197.3, "predator_policy": 1071.1138305334507}, "policy_reward_mean": {"prey_policy": 15.907240738014194, "predator_policy": 96.2159056756569}, "custom_metrics": {}, "hist_stats": {"episode_reward": [292.8, 173.9999999999995, 336.55486064841375, 282.99092946796384, -331.5409717167004, 373.0, 350.24952676359607, 222.89281275501543, 350.9897521249618, 352.4, 24.777397224683575, 392.01881502676133, 336.58364090241946, 353.3870584795874, 249.79999999999976, 402.0955537549525, 189.69999999999973, 257.29873361691915, 199.76069796958356, 246.15891517861516, 342.1, 377.29999999999995, 160.59999999999954, 269.4986387128929, 191.5660742724536, 174.3, 203.09999999999934, 352.4917536885538, 363.3512830571252, 149.39999999999958, 180.39999999999944, 295.009411158519, 354.65654486650124, 21.53411993123355, 144.31973573226443, 371.4509348185436, 276.89999999999986, 188.79999999999941, 356.3994937506884, 176.0999999999995, 114.89999999999978, 274.1, 141.0999999999993, 202.39999999999935, 167.39999999999952, 149.49999999999957, 187.89999999999944, 381.0, 305.32244052744323, 310.1, 327.59999999999997, 268.4999999999999, 378.0, 327.5, 170.7999999999995, 76.05492752030506, 140.0999999999993, 375.9, 392.012119674743, 200.92778911406796, 201.39999999999935, 47.84213254919485, 359.0, 123.0999999999995, 146.39999999999964, 359.4408117406906, 142.19999999999968, 122.99999999999947, 309.5451731417147, 319.5, 165.9999999999995, 130.0745359807612, 211.3999999999993, 196.49999999999937, 199.51824488974518, 128.55448727647126, 140.89999999999972, -134.5737629695215, 135.07712907375904, 38.300000000000274, 338.17187392084264, 211.49999999999935, 142.5999999999997, 92.49763854843738, 205.61636448955272, 301.5121527952147, 311.19464483334957, 268.39275154794996, 115.25869342605745, 186.24102343175505, 361.5231300800644, 351.0, 246.89999999999998, 279.154221690248, -4.376742869799358, 203.12690484865743, 291.4842981184417, -35.55941283147733, 170.49999999999952, 148.39999999999995], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [97.51874275376198, 45.092491141483336, 20.000000000000014, 66.54602511440008, 164.85455228865084, 143.38242055497113, 192.7422523532104, -271.43599451441514, -991.4073552038403, -772.2383634956594, 176.2296905011239, 157.58999003833486, 126.35817891342913, 126.5277976044736, 158.7219257357873, -631.264051134415, 149.78588410534275, 180.8388978791796, 134.8562439959651, 167.5778538922424, -422.84442736050863, -720.6736914276852, 165.6771332065046, -989.2135360685332, 127.65775200857658, 122.42392436267309, 179.96827064177637, 153.9908753547091, 168.43982317800348, -15.271759564574921, 192.3402520124228, 86.25678366999762, 168.5616498081313, -331.80109726725624, 65.79617846275357, 0.36548759444389134, -15.48367136996049, 51.22991987253212, 7.827133252196411, 183.22531600482313, 135.8613239879373, 90.5221453812078, 167.47587379292, 166.98005422548422, -12.87370185737257, 102.87393782920802, 9.850663542000433, 106.3873127266509, 14.68227809111333, -78.35758409509631, -12.62339478685577, 52.9749574325014, 20.000000000000014, 175.8157666772115, 56.3344751313969, 181.63595532855933, 139.74000278023613, 186.1054394661664, 130.7, -1.1727346028392307, 111.9003493721645, 11.636111593875112, 138.94995999745476, 46.86900245388463, 191.27040320301438, 117.16375534121855, -9.878863310916397, -16.03824097532508, -122.28386101922354, 2.809807218129123, 196.2662949792125, 138.73910880496604, 38.999164946409834, 152.82591544777034, 141.93096035234674, 12.537013783073792, 121.27664366720255, 136.67520030929433, 120.06265854929819, 20.000000000000014, -89.57140937961839, -178.7331021130408, 97.55629555094305, 38.31082132888957, -3.8363121691916, 9.23980246034803, 172.43614664839157, 16.158258584440645, 20.000000000000014, 67.83492221052191, 17.033601244088413, 129.79999999999998, 129.97478837819347, -10.504070326465134, 177.82436473630707, 178.9210884188424, 64.27230906135699, 113.51316016013477, 134.9213696020419, 155.94177828327315, 194.26122118165074, 120.1437821710866, 95.40397085526197, 121.57437596529405, 193.97049056845574, 167.1610464010437, 197.3, 125.58685883095518, 72.70818795539077, 5.185238996328712, -172.07002735718368, -174.5711090144984, 3.3325345202071923, -11.083368170115769, 194.1571199560268, 165.0720436148002, 188.28273785050683, 105.11395376475377, -168.51262130606605, 94.96877919353885, 146.7476315453641, -23.637968708282138, 18.031464529144532, -24.937682578394195, 141.3289035981866, 169.73873565462702, -88.95973924488548, -259.24991827094084, 11.118230908814425, -364.6908521580822, 137.28021844972517, 180.8407696841557, -82.2449902702545, 2.838296208711377, -49.668605592921224, -36.32408439387254, 64.83791445171016, 145.31096023529568, 173.9, 114.28361947385156, 75.69067309857085, 20.000000000000014, -209.37412819554362, -117.81239877978615, 183.81662908475147, 14.006440269655876, -31.771731436831963, 159.5899791112342, -119.86688679941346, 23.811453501046387, -20.954470300451696, -4.085475002556233, -8.579177255591068, -31.489693120107518, -187.45915154976515, -397.7137067166798, 0.7019878698331481, -246.76085309112258, 18.910536172460862, -7.3079783835379875, 83.27294578453146, 169.22679420675698, -37.57359711878291, 183.48613141138466, -61.146914639815286, 39.42936071400217, 1.1684276718905762, -305.92595243247706, 41.21802054577513, -64.49519144479102, -193.0738510659489, 112.86280602582244, 47.607264290115985, 163.933826639104, 52.06887890196361, 64.39229787019727, -29.644908243379184, -54.51134957703753, -494.1644834859004, 48.06303549441206, 170.9597378038822, 173.9, 139.48685300779798, 160.28000996834447, 120.85262616215955, -71.39399534404404, 98.42385806983705, 88.73550302611424, -241.57971385626217, -456.7618270329071, 39.9107357605861, -6.640527405815355, -79.6422313940696, 141.87827288804473, -167.10129634692817, -414.47390090063243, -21.104745903564364, 36.516275877985535, -407.59414526185606, 56.25548162199694], "policy_predator_policy_reward": [104.26632837697632, 45.922437727778316, 0.0, 87.45397488559992, 9.905660528210843, 18.41222727658089, 129.63987084458824, 232.0448007845805, 1071.1138305334507, 360.99091644934805, 12.770309498876106, 26.410009961665153, 50.509694037934814, 46.85385620775854, 63.0845520059449, 632.3503861476984, 20.364970140439446, 0.0, 49.14375600403491, 0.822146107757629, 440.2959386779679, 727.9995773349093, 261.8756013727883, 953.6796165160023, 84.24782319243008, 2.2541413387397222, 6.848317419545385, 12.57959506355661, 7.460176821996509, 89.17175956457436, 35.06840173140543, 88.43011634112665, 12.3383501918687, 340.60109726725574, 40.47478208562967, 150.66228547409204, 48.41392769679532, 115.60052177021666, 36.58559896413648, 18.52086695745988, 41.738676012062705, 73.97785461879216, 22.63847642677565, 20.205595554820135, 30.67370185737276, 39.926062170791994, 1.5219788315368443, 151.7386836127047, 195.03591434632716, 60.20546593010995, 116.32339478685545, 17.625042567498582, 0.0, 7.284233322788478, 22.550952510543226, 91.9703707180543, 35.8523371262574, 1.6535036844652997, 0.0, 19.872734602839245, 49.09965062783551, 7.763888406124853, 5.103458148099445, 104.08699055908032, 40.78895362911247, 5.4334326931557895, 7.333930076127084, 40.11729414134833, 245.99496233591432, 17.798827197444567, 0.8846398393310961, 35.56089119503397, 59.900835053590264, 25.17408455222964, 27.569039647653273, 6.762986216926173, 40.53377997432222, 57.91386979986935, 14.493804167701432, 21.54353728300038, 190.5714093796184, 192.63310211304002, 35.966655246803256, 102.26622787336413, 21.93631216919164, 113.760197539652, 10.263853351608425, 3.5417414155593177, 18.79917916844107, 60.76589862103702, 2.666398755911564, 0.0, 40.025211621806534, 28.40407032646527, 12.175635263692936, 12.078911581157605, 92.11804540351582, 35.418925902435596, 6.768589476982754, 12.468262637702185, 0.0, 13.194996647262618, 2.6960291447380227, 48.825624034705946, 3.029509431544247, 13.838953598956296, 0.0, 4.61314116904483, 1.1230255518516847, 91.78354749642881, 133.04454189617266, 289.6515219958147, 139.61272784852358, 8.238105801384977, 14.492920700361227, 2.1779157288117776, 48.984766534250156, 49.630661525231936, 238.74631996086023, 35.725311265735, 37.252368454635906, 41.037968708282385, 38.353851436581834, 16.394499161862505, 29.671096401813422, 18.26126434537296, 200.95973924488533, 270.34991827094314, 127.88176909118565, 372.0908521580833, 6.5696940867445655, 34.750129520065194, 96.44499027025373, 125.16170379128862, 166.19453404607805, 42.79815594071564, 8.49481376701747, 90.90148468769141, 0.0, 31.316380526148514, 70.30932690142915, 0.0, 97.26603410450116, 359.9950288515898, 8.18337091524852, 5.39355973034409, 48.371731436832206, 20.310020888765813, 288.29784181742616, 7.275836370685923, 153.5944325794791, 0.0, 26.479177255591182, 154.4896931201075, 29.827652960036215, 420.77144233688693, 34.46202302396079, 346.6739712710874, 0.9894638275391416, 25.707978383538094, 78.72705421546853, 6.94507971408569, 54.07359711878315, 11.51386858861534, 120.7066050214781, 43.61094890433434, 368.06190168548767, 29.193261623536088, 9.162891465603943, 219.7306439229648, 183.11605846300745, 198.60713937233396, 81.39273570988402, 18.260818194245545, 35.556323772523406, 116.37525100326579, 129.01619294107775, 70.39875830539702, 490.31299056326503, 142.0294808599789, 7.773047715493063, 8.89034456068914, 34.61314699220203, 16.619990031655465, 46.1429034896971, 151.29846569218748, 76.81761864651496, 15.177241947781564, 556.8153995818507, 137.1493984375189, 38.17499117606183, 131.68170531782476, 203.84223139406961, 25.406025230397013, 451.48723100303084, 94.52855341305288, 39.60474590356462, 115.48372412201446, 409.59414526185617, 90.14451837800303]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9570109298452325, "mean_inference_ms": 6.161846964423523, "mean_action_processing_ms": 3.9673882049435445, "mean_env_wait_ms": 1.5380324627877706, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004324197769165039, "StateBufferConnector_ms": 0.005895137786865234, "ViewRequirementAgentConnector_ms": 0.11381185054779053}, "num_episodes": 27, "episode_return_max": 402.0955537549525, "episode_return_min": -331.5409717167004, "episode_return_mean": 224.24629282734205, "episodes_this_iter": 27}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 512000, "num_agent_steps_trained": 512000, "num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 88.51502314643066, "num_env_steps_trained_throughput_per_sec": 88.51502314643066, "timesteps_total": 128000, "num_env_steps_sampled_lifetime": 128000, "num_agent_steps_sampled_lifetime": 512000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 512000, "timers": {"training_iteration_time_ms": 117474.185, "restore_workers_time_ms": 0.012, "training_step_time_ms": 117474.145, "sample_time_ms": 1101.325, "learn_time_ms": 116360.802, "learn_throughput": 34.376, "synch_weights_time_ms": 10.814}, "counters": {"num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 512000, "num_agent_steps_trained": 512000}, "done": false, "training_iteration": 32, "trial_id": "cf3bb_00000", "date": "2024-08-20_09-09-48", "timestamp": 1724125188, "time_this_iter_s": 45.22250699996948, "time_total_s": 9453.070556163788, "pid": 25777, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39f78fdc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 9453.070556163788, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 26.8859375, "ram_util_percent": 79.634375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8423420269377333, "cur_kl_coeff": 0.0052734375, "cur_lr": 0.00010000000000000003, "total_loss": 5.456305969329107, "policy_loss": -0.0016195010388930324, "vf_loss": 5.457872541745504, "vf_explained_var": -0.0009978641593267048, "kl": 0.01003691844146705, "entropy": 1.5380313921857762, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 61425.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 20.953046638987683, "cur_kl_coeff": 0.0421875, "cur_lr": 0.00010000000000000003, "total_loss": 8.867352103682423, "policy_loss": -0.004486340687674268, "vf_loss": 8.871057964254309, "vf_explained_var": 0.3726149184993966, "kl": 0.018500461071475884, "entropy": 1.3489527625381632, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 61425.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 528000, "num_agent_steps_trained": 528000}, "env_runners": {"episode_reward_max": 489.42777422221934, "episode_reward_min": -134.5737629695215, "episode_reward_mean": 220.5116614602443, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -699.380841772796, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 197.3, "predator_policy": 713.7932020398968}, "policy_reward_mean": {"prey_policy": 8.330486604793746, "predator_policy": 101.92534412532852}, "custom_metrics": {}, "hist_stats": {"episode_reward": [199.76069796958356, 246.15891517861516, 342.1, 377.29999999999995, 160.59999999999954, 269.4986387128929, 191.5660742724536, 174.3, 203.09999999999934, 352.4917536885538, 363.3512830571252, 149.39999999999958, 180.39999999999944, 295.009411158519, 354.65654486650124, 21.53411993123355, 144.31973573226443, 371.4509348185436, 276.89999999999986, 188.79999999999941, 356.3994937506884, 176.0999999999995, 114.89999999999978, 274.1, 141.0999999999993, 202.39999999999935, 167.39999999999952, 149.49999999999957, 187.89999999999944, 381.0, 305.32244052744323, 310.1, 327.59999999999997, 268.4999999999999, 378.0, 327.5, 170.7999999999995, 76.05492752030506, 140.0999999999993, 375.9, 392.012119674743, 200.92778911406796, 201.39999999999935, 47.84213254919485, 359.0, 123.0999999999995, 146.39999999999964, 359.4408117406906, 142.19999999999968, 122.99999999999947, 309.5451731417147, 319.5, 165.9999999999995, 130.0745359807612, 211.3999999999993, 196.49999999999937, 199.51824488974518, 128.55448727647126, 140.89999999999972, -134.5737629695215, 135.07712907375904, 38.300000000000274, 338.17187392084264, 211.49999999999935, 142.5999999999997, 92.49763854843738, 205.61636448955272, 301.5121527952147, 311.19464483334957, 268.39275154794996, 115.25869342605745, 186.24102343175505, 361.5231300800644, 351.0, 246.89999999999998, 279.154221690248, -4.376742869799358, 203.12690484865743, 291.4842981184417, -35.55941283147733, 170.49999999999952, 148.39999999999995, 236.59390544320422, 272.3508018685852, -17.505956187233565, 337.54199702652227, 489.42777422221934, 195.10268928838968, 192.65571486968278, 355.2, 239.2971209828177, 356.7401291511028, -63.944870267897414, 206.30402814986573, 268.83408198078985, 362.6305724423245, 232.50698336842888, 368.1, 196.69999999999956, 7.999999999999988], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-15.48367136996049, 51.22991987253212, 7.827133252196411, 183.22531600482313, 135.8613239879373, 90.5221453812078, 167.47587379292, 166.98005422548422, -12.87370185737257, 102.87393782920802, 9.850663542000433, 106.3873127266509, 14.68227809111333, -78.35758409509631, -12.62339478685577, 52.9749574325014, 20.000000000000014, 175.8157666772115, 56.3344751313969, 181.63595532855933, 139.74000278023613, 186.1054394661664, 130.7, -1.1727346028392307, 111.9003493721645, 11.636111593875112, 138.94995999745476, 46.86900245388463, 191.27040320301438, 117.16375534121855, -9.878863310916397, -16.03824097532508, -122.28386101922354, 2.809807218129123, 196.2662949792125, 138.73910880496604, 38.999164946409834, 152.82591544777034, 141.93096035234674, 12.537013783073792, 121.27664366720255, 136.67520030929433, 120.06265854929819, 20.000000000000014, -89.57140937961839, -178.7331021130408, 97.55629555094305, 38.31082132888957, -3.8363121691916, 9.23980246034803, 172.43614664839157, 16.158258584440645, 20.000000000000014, 67.83492221052191, 17.033601244088413, 129.79999999999998, 129.97478837819347, -10.504070326465134, 177.82436473630707, 178.9210884188424, 64.27230906135699, 113.51316016013477, 134.9213696020419, 155.94177828327315, 194.26122118165074, 120.1437821710866, 95.40397085526197, 121.57437596529405, 193.97049056845574, 167.1610464010437, 197.3, 125.58685883095518, 72.70818795539077, 5.185238996328712, -172.07002735718368, -174.5711090144984, 3.3325345202071923, -11.083368170115769, 194.1571199560268, 165.0720436148002, 188.28273785050683, 105.11395376475377, -168.51262130606605, 94.96877919353885, 146.7476315453641, -23.637968708282138, 18.031464529144532, -24.937682578394195, 141.3289035981866, 169.73873565462702, -88.95973924488548, -259.24991827094084, 11.118230908814425, -364.6908521580822, 137.28021844972517, 180.8407696841557, -82.2449902702545, 2.838296208711377, -49.668605592921224, -36.32408439387254, 64.83791445171016, 145.31096023529568, 173.9, 114.28361947385156, 75.69067309857085, 20.000000000000014, -209.37412819554362, -117.81239877978615, 183.81662908475147, 14.006440269655876, -31.771731436831963, 159.5899791112342, -119.86688679941346, 23.811453501046387, -20.954470300451696, -4.085475002556233, -8.579177255591068, -31.489693120107518, -187.45915154976515, -397.7137067166798, 0.7019878698331481, -246.76085309112258, 18.910536172460862, -7.3079783835379875, 83.27294578453146, 169.22679420675698, -37.57359711878291, 183.48613141138466, -61.146914639815286, 39.42936071400217, 1.1684276718905762, -305.92595243247706, 41.21802054577513, -64.49519144479102, -193.0738510659489, 112.86280602582244, 47.607264290115985, 163.933826639104, 52.06887890196361, 64.39229787019727, -29.644908243379184, -54.51134957703753, -494.1644834859004, 48.06303549441206, 170.9597378038822, 173.9, 139.48685300779798, 160.28000996834447, 120.85262616215955, -71.39399534404404, 98.42385806983705, 88.73550302611424, -241.57971385626217, -456.7618270329071, 39.9107357605861, -6.640527405815355, -79.6422313940696, 141.87827288804473, -167.10129634692817, -414.47390090063243, -21.104745903564364, 36.516275877985535, -407.59414526185606, 56.25548162199694, -421.628276052221, 157.22904415444467, 31.517486556468853, 39.090500024685184, -111.80745244523516, -487.12897579649473, 76.9723252604843, 169.32841948793396, 118.07684506612722, -668.1020230584479, 81.50523937174655, -699.380841772796, -143.26037932669072, 55.35229265131049, 124.8280331777091, 174.0846083225387, -14.714023038399006, 70.85553101448241, 118.7586543800679, 142.9785252015002, -442.46330644869596, -694.8287359458294, 127.91743260190589, -398.76756700333766, -40.13177869686854, 136.6046582855051, 168.20828713321555, 87.87221404620755, -474.52088742829915, 155.78668094541644, 170.74505981866292, 183.8, -210.1515323575054, 163.89242312550405, -582.6216757889476, -287.296830974778], "policy_predator_policy_reward": [48.41392769679532, 115.60052177021666, 36.58559896413648, 18.52086695745988, 41.738676012062705, 73.97785461879216, 22.63847642677565, 20.205595554820135, 30.67370185737276, 39.926062170791994, 1.5219788315368443, 151.7386836127047, 195.03591434632716, 60.20546593010995, 116.32339478685545, 17.625042567498582, 0.0, 7.284233322788478, 22.550952510543226, 91.9703707180543, 35.8523371262574, 1.6535036844652997, 0.0, 19.872734602839245, 49.09965062783551, 7.763888406124853, 5.103458148099445, 104.08699055908032, 40.78895362911247, 5.4334326931557895, 7.333930076127084, 40.11729414134833, 245.99496233591432, 17.798827197444567, 0.8846398393310961, 35.56089119503397, 59.900835053590264, 25.17408455222964, 27.569039647653273, 6.762986216926173, 40.53377997432222, 57.91386979986935, 14.493804167701432, 21.54353728300038, 190.5714093796184, 192.63310211304002, 35.966655246803256, 102.26622787336413, 21.93631216919164, 113.760197539652, 10.263853351608425, 3.5417414155593177, 18.79917916844107, 60.76589862103702, 2.666398755911564, 0.0, 40.025211621806534, 28.40407032646527, 12.175635263692936, 12.078911581157605, 92.11804540351582, 35.418925902435596, 6.768589476982754, 12.468262637702185, 0.0, 13.194996647262618, 2.6960291447380227, 48.825624034705946, 3.029509431544247, 13.838953598956296, 0.0, 4.61314116904483, 1.1230255518516847, 91.78354749642881, 133.04454189617266, 289.6515219958147, 139.61272784852358, 8.238105801384977, 14.492920700361227, 2.1779157288117776, 48.984766534250156, 49.630661525231936, 238.74631996086023, 35.725311265735, 37.252368454635906, 41.037968708282385, 38.353851436581834, 16.394499161862505, 29.671096401813422, 18.26126434537296, 200.95973924488533, 270.34991827094314, 127.88176909118565, 372.0908521580833, 6.5696940867445655, 34.750129520065194, 96.44499027025373, 125.16170379128862, 166.19453404607805, 42.79815594071564, 8.49481376701747, 90.90148468769141, 0.0, 31.316380526148514, 70.30932690142915, 0.0, 97.26603410450116, 359.9950288515898, 8.18337091524852, 5.39355973034409, 48.371731436832206, 20.310020888765813, 288.29784181742616, 7.275836370685923, 153.5944325794791, 0.0, 26.479177255591182, 154.4896931201075, 29.827652960036215, 420.77144233688693, 34.46202302396079, 346.6739712710874, 0.9894638275391416, 25.707978383538094, 78.72705421546853, 6.94507971408569, 54.07359711878315, 11.51386858861534, 120.7066050214781, 43.61094890433434, 368.06190168548767, 29.193261623536088, 9.162891465603943, 219.7306439229648, 183.11605846300745, 198.60713937233396, 81.39273570988402, 18.260818194245545, 35.556323772523406, 116.37525100326579, 129.01619294107775, 70.39875830539702, 490.31299056326503, 142.0294808599789, 7.773047715493063, 8.89034456068914, 34.61314699220203, 16.619990031655465, 46.1429034896971, 151.29846569218748, 76.81761864651496, 15.177241947781564, 556.8153995818507, 137.1493984375189, 38.17499117606183, 131.68170531782476, 203.84223139406961, 25.406025230397013, 451.48723100303084, 94.52855341305288, 39.60474590356462, 115.48372412201446, 409.59414526185617, 90.14451837800303, 424.86206518114125, 76.13107215983909, 91.43499030133817, 110.30782498609298, 323.5397513249592, 257.89072072953684, 80.0276747395157, 11.213577538588298, 529.1152608013035, 510.3376914132365, 115.0619160107104, 697.9163756787287, 61.70156165879262, 218.86223988627043, 43.171966822290905, 13.11539167746127, 4.645993734780102, 178.50961927195436, 60.58147477103491, 34.42147479849975, 359.5539700867321, 713.7932020398968, 130.02087720849676, 347.13328534280095, 9.682424121599315, 162.67877827055392, 62.851499867379914, 43.69857139552152, 446.32761061395075, 104.91357923736096, 13.554940181337066, 0.0, 221.85153235750494, 21.107576874495958, 584.9216757889476, 292.9968309747786]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.80004518509685, "mean_inference_ms": 6.260281560347042, "mean_action_processing_ms": 3.8568294814486346, "mean_env_wait_ms": 1.380293508226024, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00412595272064209, "StateBufferConnector_ms": 0.005846142768859863, "ViewRequirementAgentConnector_ms": 0.11666464805603027}, "num_episodes": 18, "episode_return_max": 489.42777422221934, "episode_return_min": -134.5737629695215, "episode_return_mean": 220.5116614602443, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 528000, "num_agent_steps_trained": 528000, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 79.42608454810866, "num_env_steps_trained_throughput_per_sec": 79.42608454810866, "timesteps_total": 132000, "num_env_steps_sampled_lifetime": 132000, "num_agent_steps_sampled_lifetime": 528000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 528000, "timers": {"training_iteration_time_ms": 115729.581, "restore_workers_time_ms": 0.013, "training_step_time_ms": 115729.537, "sample_time_ms": 1125.6, "learn_time_ms": 114590.158, "learn_throughput": 34.907, "synch_weights_time_ms": 11.776}, "counters": {"num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 528000, "num_agent_steps_trained": 528000}, "done": false, "training_iteration": 33, "trial_id": "cf3bb_00000", "date": "2024-08-20_09-10-39", "timestamp": 1724125239, "time_this_iter_s": 50.43617391586304, "time_total_s": 9503.50673007965, "pid": 25777, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39f77d1f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 9503.50673007965, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 37.32083333333333, "ram_util_percent": 80.44722222222224}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3179197387562858, "cur_kl_coeff": 0.0052734375, "cur_lr": 0.00010000000000000003, "total_loss": 4.668597690768974, "policy_loss": -0.003503729760395511, "vf_loss": 4.671999752332294, "vf_explained_var": 0.000579782800068931, "kl": 0.019279929394100136, "entropy": 1.5009668622698102, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 63315.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 23.218241722684688, "cur_kl_coeff": 0.0421875, "cur_lr": 0.00010000000000000003, "total_loss": 7.667354691470111, "policy_loss": -0.0035708038929711887, "vf_loss": 7.6704833076113745, "vf_explained_var": 0.4441916211887642, "kl": 0.01048183608166548, "entropy": 1.3304364968229223, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 63315.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_agent_steps_sampled": 544000, "num_agent_steps_trained": 544000}, "env_runners": {"episode_reward_max": 489.42777422221934, "episode_reward_min": -134.5737629695215, "episode_reward_mean": 210.06352246894855, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -699.380841772796, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 197.3, "predator_policy": 713.7932020398968}, "policy_reward_mean": {"prey_policy": -11.134328816063924, "predator_policy": 116.16609005053827}, "custom_metrics": {}, "hist_stats": {"episode_reward": [276.89999999999986, 188.79999999999941, 356.3994937506884, 176.0999999999995, 114.89999999999978, 274.1, 141.0999999999993, 202.39999999999935, 167.39999999999952, 149.49999999999957, 187.89999999999944, 381.0, 305.32244052744323, 310.1, 327.59999999999997, 268.4999999999999, 378.0, 327.5, 170.7999999999995, 76.05492752030506, 140.0999999999993, 375.9, 392.012119674743, 200.92778911406796, 201.39999999999935, 47.84213254919485, 359.0, 123.0999999999995, 146.39999999999964, 359.4408117406906, 142.19999999999968, 122.99999999999947, 309.5451731417147, 319.5, 165.9999999999995, 130.0745359807612, 211.3999999999993, 196.49999999999937, 199.51824488974518, 128.55448727647126, 140.89999999999972, -134.5737629695215, 135.07712907375904, 38.300000000000274, 338.17187392084264, 211.49999999999935, 142.5999999999997, 92.49763854843738, 205.61636448955272, 301.5121527952147, 311.19464483334957, 268.39275154794996, 115.25869342605745, 186.24102343175505, 361.5231300800644, 351.0, 246.89999999999998, 279.154221690248, -4.376742869799358, 203.12690484865743, 291.4842981184417, -35.55941283147733, 170.49999999999952, 148.39999999999995, 236.59390544320422, 272.3508018685852, -17.505956187233565, 337.54199702652227, 489.42777422221934, 195.10268928838968, 192.65571486968278, 355.2, 239.2971209828177, 356.7401291511028, -63.944870267897414, 206.30402814986573, 268.83408198078985, 362.6305724423245, 232.50698336842888, 368.1, 196.69999999999956, 7.999999999999988, 207.64783082649575, 272.32078698152526, 201.99999999999935, 297.16463418406124, 71.09992511863916, 176.59999999999954, 152.62555374410826, 324.73193192210135, 187.69999999999965, 186.19999999999976, 120.9280786139476, 135.49659999163654, 198.59999999999937, 33.70000000000021, 194.49999999999994, 163.84284281761862, 180.4, 246.62602605657185], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [38.999164946409834, 152.82591544777034, 141.93096035234674, 12.537013783073792, 121.27664366720255, 136.67520030929433, 120.06265854929819, 20.000000000000014, -89.57140937961839, -178.7331021130408, 97.55629555094305, 38.31082132888957, -3.8363121691916, 9.23980246034803, 172.43614664839157, 16.158258584440645, 20.000000000000014, 67.83492221052191, 17.033601244088413, 129.79999999999998, 129.97478837819347, -10.504070326465134, 177.82436473630707, 178.9210884188424, 64.27230906135699, 113.51316016013477, 134.9213696020419, 155.94177828327315, 194.26122118165074, 120.1437821710866, 95.40397085526197, 121.57437596529405, 193.97049056845574, 167.1610464010437, 197.3, 125.58685883095518, 72.70818795539077, 5.185238996328712, -172.07002735718368, -174.5711090144984, 3.3325345202071923, -11.083368170115769, 194.1571199560268, 165.0720436148002, 188.28273785050683, 105.11395376475377, -168.51262130606605, 94.96877919353885, 146.7476315453641, -23.637968708282138, 18.031464529144532, -24.937682578394195, 141.3289035981866, 169.73873565462702, -88.95973924488548, -259.24991827094084, 11.118230908814425, -364.6908521580822, 137.28021844972517, 180.8407696841557, -82.2449902702545, 2.838296208711377, -49.668605592921224, -36.32408439387254, 64.83791445171016, 145.31096023529568, 173.9, 114.28361947385156, 75.69067309857085, 20.000000000000014, -209.37412819554362, -117.81239877978615, 183.81662908475147, 14.006440269655876, -31.771731436831963, 159.5899791112342, -119.86688679941346, 23.811453501046387, -20.954470300451696, -4.085475002556233, -8.579177255591068, -31.489693120107518, -187.45915154976515, -397.7137067166798, 0.7019878698331481, -246.76085309112258, 18.910536172460862, -7.3079783835379875, 83.27294578453146, 169.22679420675698, -37.57359711878291, 183.48613141138466, -61.146914639815286, 39.42936071400217, 1.1684276718905762, -305.92595243247706, 41.21802054577513, -64.49519144479102, -193.0738510659489, 112.86280602582244, 47.607264290115985, 163.933826639104, 52.06887890196361, 64.39229787019727, -29.644908243379184, -54.51134957703753, -494.1644834859004, 48.06303549441206, 170.9597378038822, 173.9, 139.48685300779798, 160.28000996834447, 120.85262616215955, -71.39399534404404, 98.42385806983705, 88.73550302611424, -241.57971385626217, -456.7618270329071, 39.9107357605861, -6.640527405815355, -79.6422313940696, 141.87827288804473, -167.10129634692817, -414.47390090063243, -21.104745903564364, 36.516275877985535, -407.59414526185606, 56.25548162199694, -421.628276052221, 157.22904415444467, 31.517486556468853, 39.090500024685184, -111.80745244523516, -487.12897579649473, 76.9723252604843, 169.32841948793396, 118.07684506612722, -668.1020230584479, 81.50523937174655, -699.380841772796, -143.26037932669072, 55.35229265131049, 124.8280331777091, 174.0846083225387, -14.714023038399006, 70.85553101448241, 118.7586543800679, 142.9785252015002, -442.46330644869596, -694.8287359458294, 127.91743260190589, -398.76756700333766, -40.13177869686854, 136.6046582855051, 168.20828713321555, 87.87221404620755, -474.52088742829915, 155.78668094541644, 170.74505981866292, 183.8, -210.1515323575054, 163.89242312550405, -582.6216757889476, -287.296830974778, -34.270110946113434, 40.85917204725272, 21.264359850973747, 121.17628958210204, -160.2642088088711, 187.3560667057139, 99.01707221750645, 74.99029154529609, -242.14483976306457, -28.671356291927665, -9.413978770720679, 66.66616578221378, -504.63561892514247, 87.05871969142925, 78.15644956596466, 158.48358723003966, -187.71415233476085, 151.127176810298, 93.87997875152872, -240.53538627062426, -119.6961372042694, -26.634442545460004, -345.63396708822455, -20.587413856351432, -37.81063396118496, 159.5749197005499, 5.746081862838978, -60.47436820478322, -366.53949102601183, 149.40277525096923, 75.79241813757152, -52.184003503835974, -382.61447397206103, 117.19027232758668, -78.96698626774185, -14.798015021743907], "policy_predator_policy_reward": [59.900835053590264, 25.17408455222964, 27.569039647653273, 6.762986216926173, 40.53377997432222, 57.91386979986935, 14.493804167701432, 21.54353728300038, 190.5714093796184, 192.63310211304002, 35.966655246803256, 102.26622787336413, 21.93631216919164, 113.760197539652, 10.263853351608425, 3.5417414155593177, 18.79917916844107, 60.76589862103702, 2.666398755911564, 0.0, 40.025211621806534, 28.40407032646527, 12.175635263692936, 12.078911581157605, 92.11804540351582, 35.418925902435596, 6.768589476982754, 12.468262637702185, 0.0, 13.194996647262618, 2.6960291447380227, 48.825624034705946, 3.029509431544247, 13.838953598956296, 0.0, 4.61314116904483, 1.1230255518516847, 91.78354749642881, 133.04454189617266, 289.6515219958147, 139.61272784852358, 8.238105801384977, 14.492920700361227, 2.1779157288117776, 48.984766534250156, 49.630661525231936, 238.74631996086023, 35.725311265735, 37.252368454635906, 41.037968708282385, 38.353851436581834, 16.394499161862505, 29.671096401813422, 18.26126434537296, 200.95973924488533, 270.34991827094314, 127.88176909118565, 372.0908521580833, 6.5696940867445655, 34.750129520065194, 96.44499027025373, 125.16170379128862, 166.19453404607805, 42.79815594071564, 8.49481376701747, 90.90148468769141, 0.0, 31.316380526148514, 70.30932690142915, 0.0, 97.26603410450116, 359.9950288515898, 8.18337091524852, 5.39355973034409, 48.371731436832206, 20.310020888765813, 288.29784181742616, 7.275836370685923, 153.5944325794791, 0.0, 26.479177255591182, 154.4896931201075, 29.827652960036215, 420.77144233688693, 34.46202302396079, 346.6739712710874, 0.9894638275391416, 25.707978383538094, 78.72705421546853, 6.94507971408569, 54.07359711878315, 11.51386858861534, 120.7066050214781, 43.61094890433434, 368.06190168548767, 29.193261623536088, 9.162891465603943, 219.7306439229648, 183.11605846300745, 198.60713937233396, 81.39273570988402, 18.260818194245545, 35.556323772523406, 116.37525100326579, 129.01619294107775, 70.39875830539702, 490.31299056326503, 142.0294808599789, 7.773047715493063, 8.89034456068914, 34.61314699220203, 16.619990031655465, 46.1429034896971, 151.29846569218748, 76.81761864651496, 15.177241947781564, 556.8153995818507, 137.1493984375189, 38.17499117606183, 131.68170531782476, 203.84223139406961, 25.406025230397013, 451.48723100303084, 94.52855341305288, 39.60474590356462, 115.48372412201446, 409.59414526185617, 90.14451837800303, 424.86206518114125, 76.13107215983909, 91.43499030133817, 110.30782498609298, 323.5397513249592, 257.89072072953684, 80.0276747395157, 11.213577538588298, 529.1152608013035, 510.3376914132365, 115.0619160107104, 697.9163756787287, 61.70156165879262, 218.86223988627043, 43.171966822290905, 13.11539167746127, 4.645993734780102, 178.50961927195436, 60.58147477103491, 34.42147479849975, 359.5539700867321, 713.7932020398968, 130.02087720849676, 347.13328534280095, 9.682424121599315, 162.67877827055392, 62.851499867379914, 43.69857139552152, 446.32761061395075, 104.91357923736096, 13.554940181337066, 0.0, 221.85153235750494, 21.107576874495958, 584.9216757889476, 292.9968309747786, 93.03044757773445, 108.028322147622, 6.1532228632271, 123.72691468522245, 171.56420880887052, 3.3439332942860602, 41.2302125550274, 81.92705786623127, 329.51306296757645, 12.403058206055118, 23.30130064553896, 96.04651234296789, 514.8830235962066, 55.31942938161666, 74.79124517888816, 13.300649947208802, 197.41415233476047, 26.872823189701997, 81.12002124847128, 251.73538627062442, 84.93695196389942, 182.32170639977815, 342.212150996501, 159.50582993971213, 55.41063396118521, 21.425080299450094, 12.953918137160997, 75.47436820478264, 25.33330933336437, 386.3034064416783, 48.64946902973917, 91.58495915414446, 385.8144739720611, 60.00972767241331, 206.36132200838313, 134.02970533767447]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7716338830904157, "mean_inference_ms": 6.137420689291958, "mean_action_processing_ms": 3.7554891534135093, "mean_env_wait_ms": 1.3477936409073659, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005313277244567871, "StateBufferConnector_ms": 0.006177544593811035, "ViewRequirementAgentConnector_ms": 0.1344677209854126}, "num_episodes": 18, "episode_return_max": 489.42777422221934, "episode_return_min": -134.5737629695215, "episode_return_mean": 210.06352246894855, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 544000, "num_agent_steps_trained": 544000, "num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 66.45408025136517, "num_env_steps_trained_throughput_per_sec": 66.45408025136517, "timesteps_total": 136000, "num_env_steps_sampled_lifetime": 136000, "num_agent_steps_sampled_lifetime": 544000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 544000, "timers": {"training_iteration_time_ms": 110362.189, "restore_workers_time_ms": 0.013, "training_step_time_ms": 110362.144, "sample_time_ms": 1320.208, "learn_time_ms": 109027.66, "learn_throughput": 36.688, "synch_weights_time_ms": 11.903}, "counters": {"num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_agent_steps_sampled": 544000, "num_agent_steps_trained": 544000}, "done": false, "training_iteration": 34, "trial_id": "cf3bb_00000", "date": "2024-08-20_09-11-39", "timestamp": 1724125299, "time_this_iter_s": 60.21952509880066, "time_total_s": 9563.726255178452, "pid": 25777, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39f82a9d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 9563.726255178452, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 51.444705882352935, "ram_util_percent": 81.62588235294116}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2192632696694798, "cur_kl_coeff": 0.0052734375, "cur_lr": 0.00010000000000000003, "total_loss": 5.640534514977188, "policy_loss": -0.003199296319246213, "vf_loss": 5.643624220197163, "vf_explained_var": -0.00067696732188028, "kl": 0.02078229139391653, "entropy": 1.4947016327469438, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 65205.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 24.909881737465582, "cur_kl_coeff": 0.0421875, "cur_lr": 0.00010000000000000003, "total_loss": 8.638390400800755, "policy_loss": -0.004110522939769364, "vf_loss": 8.641932537189867, "vf_explained_var": 0.33335434589436447, "kl": 0.013472433788940072, "entropy": 1.3301036914189657, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 65205.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_agent_steps_sampled": 560000, "num_agent_steps_trained": 560000}, "env_runners": {"episode_reward_max": 489.42777422221934, "episode_reward_min": -394.0177519898355, "episode_reward_mean": 204.57968545844574, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1046.0965210662048, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 198.04836952232102, "predator_policy": 837.9698826308065}, "policy_reward_mean": {"prey_policy": -40.83159975097838, "predator_policy": 143.12144248020138}, "custom_metrics": {}, "hist_stats": {"episode_reward": [170.7999999999995, 76.05492752030506, 140.0999999999993, 375.9, 392.012119674743, 200.92778911406796, 201.39999999999935, 47.84213254919485, 359.0, 123.0999999999995, 146.39999999999964, 359.4408117406906, 142.19999999999968, 122.99999999999947, 309.5451731417147, 319.5, 165.9999999999995, 130.0745359807612, 211.3999999999993, 196.49999999999937, 199.51824488974518, 128.55448727647126, 140.89999999999972, -134.5737629695215, 135.07712907375904, 38.300000000000274, 338.17187392084264, 211.49999999999935, 142.5999999999997, 92.49763854843738, 205.61636448955272, 301.5121527952147, 311.19464483334957, 268.39275154794996, 115.25869342605745, 186.24102343175505, 361.5231300800644, 351.0, 246.89999999999998, 279.154221690248, -4.376742869799358, 203.12690484865743, 291.4842981184417, -35.55941283147733, 170.49999999999952, 148.39999999999995, 236.59390544320422, 272.3508018685852, -17.505956187233565, 337.54199702652227, 489.42777422221934, 195.10268928838968, 192.65571486968278, 355.2, 239.2971209828177, 356.7401291511028, -63.944870267897414, 206.30402814986573, 268.83408198078985, 362.6305724423245, 232.50698336842888, 368.1, 196.69999999999956, 7.999999999999988, 207.64783082649575, 272.32078698152526, 201.99999999999935, 297.16463418406124, 71.09992511863916, 176.59999999999954, 152.62555374410826, 324.73193192210135, 187.69999999999965, 186.19999999999976, 120.9280786139476, 135.49659999163654, 198.59999999999937, 33.70000000000021, 194.49999999999994, 163.84284281761862, 180.4, 246.62602605657185, 236.10620331346612, 191.99999999999974, 272.46343119459846, 332.3, 172.69999999999945, 386.4, 238.50380437704672, 318.4, 202.49999999999963, 402.2893135099278, 142.70000000000002, 321.1254443605648, 192.92064116332756, 197.16654699580778, 278.0579442950764, 295.42265600787607, 198.0999999999997, -394.0177519898355], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [72.70818795539077, 5.185238996328712, -172.07002735718368, -174.5711090144984, 3.3325345202071923, -11.083368170115769, 194.1571199560268, 165.0720436148002, 188.28273785050683, 105.11395376475377, -168.51262130606605, 94.96877919353885, 146.7476315453641, -23.637968708282138, 18.031464529144532, -24.937682578394195, 141.3289035981866, 169.73873565462702, -88.95973924488548, -259.24991827094084, 11.118230908814425, -364.6908521580822, 137.28021844972517, 180.8407696841557, -82.2449902702545, 2.838296208711377, -49.668605592921224, -36.32408439387254, 64.83791445171016, 145.31096023529568, 173.9, 114.28361947385156, 75.69067309857085, 20.000000000000014, -209.37412819554362, -117.81239877978615, 183.81662908475147, 14.006440269655876, -31.771731436831963, 159.5899791112342, -119.86688679941346, 23.811453501046387, -20.954470300451696, -4.085475002556233, -8.579177255591068, -31.489693120107518, -187.45915154976515, -397.7137067166798, 0.7019878698331481, -246.76085309112258, 18.910536172460862, -7.3079783835379875, 83.27294578453146, 169.22679420675698, -37.57359711878291, 183.48613141138466, -61.146914639815286, 39.42936071400217, 1.1684276718905762, -305.92595243247706, 41.21802054577513, -64.49519144479102, -193.0738510659489, 112.86280602582244, 47.607264290115985, 163.933826639104, 52.06887890196361, 64.39229787019727, -29.644908243379184, -54.51134957703753, -494.1644834859004, 48.06303549441206, 170.9597378038822, 173.9, 139.48685300779798, 160.28000996834447, 120.85262616215955, -71.39399534404404, 98.42385806983705, 88.73550302611424, -241.57971385626217, -456.7618270329071, 39.9107357605861, -6.640527405815355, -79.6422313940696, 141.87827288804473, -167.10129634692817, -414.47390090063243, -21.104745903564364, 36.516275877985535, -407.59414526185606, 56.25548162199694, -421.628276052221, 157.22904415444467, 31.517486556468853, 39.090500024685184, -111.80745244523516, -487.12897579649473, 76.9723252604843, 169.32841948793396, 118.07684506612722, -668.1020230584479, 81.50523937174655, -699.380841772796, -143.26037932669072, 55.35229265131049, 124.8280331777091, 174.0846083225387, -14.714023038399006, 70.85553101448241, 118.7586543800679, 142.9785252015002, -442.46330644869596, -694.8287359458294, 127.91743260190589, -398.76756700333766, -40.13177869686854, 136.6046582855051, 168.20828713321555, 87.87221404620755, -474.52088742829915, 155.78668094541644, 170.74505981866292, 183.8, -210.1515323575054, 163.89242312550405, -582.6216757889476, -287.296830974778, -34.270110946113434, 40.85917204725272, 21.264359850973747, 121.17628958210204, -160.2642088088711, 187.3560667057139, 99.01707221750645, 74.99029154529609, -242.14483976306457, -28.671356291927665, -9.413978770720679, 66.66616578221378, -504.63561892514247, 87.05871969142925, 78.15644956596466, 158.48358723003966, -187.71415233476085, 151.127176810298, 93.87997875152872, -240.53538627062426, -119.6961372042694, -26.634442545460004, -345.63396708822455, -20.587413856351432, -37.81063396118496, 159.5749197005499, 5.746081862838978, -60.47436820478322, -366.53949102601183, 149.40277525096923, 75.79241813757152, -52.184003503835974, -382.61447397206103, 117.19027232758668, -78.96698626774185, -14.798015021743907, 34.36127917180774, -229.45598101339576, -272.62822512724625, 134.95806960588092, -20.222626039339715, 148.40024320598394, 124.4296226806834, 101.65617497433243, 140.10246421120712, -315.2334767251092, 178.41888062130096, 198.04836952232102, 34.67551656632551, 64.21542744120646, 10.8221797269265, 188.93549358484876, 182.6374133054367, -109.41689941660614, -790.9019494786053, 141.51139869776483, -318.5369947435458, 79.55059116965128, 138.49202588267482, 67.06543173963011, -354.540507312573, 136.70518511365327, -119.46277224246627, 156.6400419660981, 31.924065519677825, -490.6490682516721, -1.9609087810697474, 132.16989993808102, 178.23092480854177, -299.174627450765, -974.3212130797273, -1046.0965210662048], "policy_predator_policy_reward": [1.1230255518516847, 91.78354749642881, 133.04454189617266, 289.6515219958147, 139.61272784852358, 8.238105801384977, 14.492920700361227, 2.1779157288117776, 48.984766534250156, 49.630661525231936, 238.74631996086023, 35.725311265735, 37.252368454635906, 41.037968708282385, 38.353851436581834, 16.394499161862505, 29.671096401813422, 18.26126434537296, 200.95973924488533, 270.34991827094314, 127.88176909118565, 372.0908521580833, 6.5696940867445655, 34.750129520065194, 96.44499027025373, 125.16170379128862, 166.19453404607805, 42.79815594071564, 8.49481376701747, 90.90148468769141, 0.0, 31.316380526148514, 70.30932690142915, 0.0, 97.26603410450116, 359.9950288515898, 8.18337091524852, 5.39355973034409, 48.371731436832206, 20.310020888765813, 288.29784181742616, 7.275836370685923, 153.5944325794791, 0.0, 26.479177255591182, 154.4896931201075, 29.827652960036215, 420.77144233688693, 34.46202302396079, 346.6739712710874, 0.9894638275391416, 25.707978383538094, 78.72705421546853, 6.94507971408569, 54.07359711878315, 11.51386858861534, 120.7066050214781, 43.61094890433434, 368.06190168548767, 29.193261623536088, 9.162891465603943, 219.7306439229648, 183.11605846300745, 198.60713937233396, 81.39273570988402, 18.260818194245545, 35.556323772523406, 116.37525100326579, 129.01619294107775, 70.39875830539702, 490.31299056326503, 142.0294808599789, 7.773047715493063, 8.89034456068914, 34.61314699220203, 16.619990031655465, 46.1429034896971, 151.29846569218748, 76.81761864651496, 15.177241947781564, 556.8153995818507, 137.1493984375189, 38.17499117606183, 131.68170531782476, 203.84223139406961, 25.406025230397013, 451.48723100303084, 94.52855341305288, 39.60474590356462, 115.48372412201446, 409.59414526185617, 90.14451837800303, 424.86206518114125, 76.13107215983909, 91.43499030133817, 110.30782498609298, 323.5397513249592, 257.89072072953684, 80.0276747395157, 11.213577538588298, 529.1152608013035, 510.3376914132365, 115.0619160107104, 697.9163756787287, 61.70156165879262, 218.86223988627043, 43.171966822290905, 13.11539167746127, 4.645993734780102, 178.50961927195436, 60.58147477103491, 34.42147479849975, 359.5539700867321, 713.7932020398968, 130.02087720849676, 347.13328534280095, 9.682424121599315, 162.67877827055392, 62.851499867379914, 43.69857139552152, 446.32761061395075, 104.91357923736096, 13.554940181337066, 0.0, 221.85153235750494, 21.107576874495958, 584.9216757889476, 292.9968309747786, 93.03044757773445, 108.028322147622, 6.1532228632271, 123.72691468522245, 171.56420880887052, 3.3439332942860602, 41.2302125550274, 81.92705786623127, 329.51306296757645, 12.403058206055118, 23.30130064553896, 96.04651234296789, 514.8830235962066, 55.31942938161666, 74.79124517888816, 13.300649947208802, 197.41415233476047, 26.872823189701997, 81.12002124847128, 251.73538627062442, 84.93695196389942, 182.32170639977815, 342.212150996501, 159.50582993971213, 55.41063396118521, 21.425080299450094, 12.953918137160997, 75.47436820478264, 25.33330933336437, 386.3034064416783, 48.64946902973917, 91.58495915414446, 385.8144739720611, 60.00972767241331, 206.36132200838313, 134.02970533767447, 183.10445422000788, 248.09645093504645, 3.732136157284728, 325.9380193640805, 140.93030200740085, 3.355512020553346, 43.87037731931661, 62.34382502566758, 21.19753578879291, 326.6334767251118, 8.98111937869905, 0.9516304776789737, 112.9779089590771, 26.63495141043772, 45.27928434701437, 73.36304234121036, 5.9625866945633055, 123.3168994166061, 696.7557272231094, 354.92413706765876, 330.73699474354584, 50.94940883034876, 57.77469987057345, 57.79328686768621, 340.24238087648826, 70.51358248576014, 128.69608360165446, 31.293193670521244, 372.800693488915, 363.9822535381555, 125.97339082100997, 39.240274029854845, 10.269075191458233, 308.7746274507651, 788.4300995252897, 837.9698826308065]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7477448972085898, "mean_inference_ms": 6.028320104046436, "mean_action_processing_ms": 3.66098407594136, "mean_env_wait_ms": 1.318143644937222, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007668137550354004, "StateBufferConnector_ms": 0.006434202194213867, "ViewRequirementAgentConnector_ms": 0.14402329921722412}, "num_episodes": 18, "episode_return_max": 489.42777422221934, "episode_return_min": -394.0177519898355, "episode_return_mean": 204.57968545844574, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 560000, "num_agent_steps_trained": 560000, "num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 64.49016153883653, "num_env_steps_trained_throughput_per_sec": 64.49016153883653, "timesteps_total": 140000, "num_env_steps_sampled_lifetime": 140000, "num_agent_steps_sampled_lifetime": 560000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 560000, "timers": {"training_iteration_time_ms": 96668.201, "restore_workers_time_ms": 0.014, "training_step_time_ms": 96668.156, "sample_time_ms": 1413.362, "learn_time_ms": 95240.243, "learn_throughput": 41.999, "synch_weights_time_ms": 12.076}, "counters": {"num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_agent_steps_sampled": 560000, "num_agent_steps_trained": 560000}, "done": false, "training_iteration": 35, "trial_id": "cf3bb_00000", "date": "2024-08-20_09-12-41", "timestamp": 1724125361, "time_this_iter_s": 62.06887412071228, "time_total_s": 9625.795129299164, "pid": 25777, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39f796940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 9625.795129299164, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 53.69213483146067, "ram_util_percent": 82.1932584269663}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2719428322893918, "cur_kl_coeff": 0.007910156249999998, "cur_lr": 0.00010000000000000003, "total_loss": 4.490551409771833, "policy_loss": -0.00526487459071355, "vf_loss": 4.495583338207669, "vf_explained_var": 0.0003382328641477716, "kl": 0.02944872208635359, "entropy": 1.44462566590183, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 67095.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 23.882472732678924, "cur_kl_coeff": 0.0421875, "cur_lr": 0.00010000000000000003, "total_loss": 8.45046684300458, "policy_loss": -0.0020023588030771526, "vf_loss": 8.451979426479845, "vf_explained_var": 0.39822137891930875, "kl": 0.011609463288252232, "entropy": 1.3034084526319352, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 67095.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 576000}, "env_runners": {"episode_reward_max": 489.42777422221934, "episode_reward_min": -394.0177519898355, "episode_reward_mean": 205.25562323338204, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1046.0965210662048, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 198.04836952232102, "predator_policy": 837.9698826308065}, "policy_reward_mean": {"prey_policy": -62.40766235361038, "predator_policy": 165.0354739703015}, "custom_metrics": {}, "hist_stats": {"episode_reward": [140.89999999999972, -134.5737629695215, 135.07712907375904, 38.300000000000274, 338.17187392084264, 211.49999999999935, 142.5999999999997, 92.49763854843738, 205.61636448955272, 301.5121527952147, 311.19464483334957, 268.39275154794996, 115.25869342605745, 186.24102343175505, 361.5231300800644, 351.0, 246.89999999999998, 279.154221690248, -4.376742869799358, 203.12690484865743, 291.4842981184417, -35.55941283147733, 170.49999999999952, 148.39999999999995, 236.59390544320422, 272.3508018685852, -17.505956187233565, 337.54199702652227, 489.42777422221934, 195.10268928838968, 192.65571486968278, 355.2, 239.2971209828177, 356.7401291511028, -63.944870267897414, 206.30402814986573, 268.83408198078985, 362.6305724423245, 232.50698336842888, 368.1, 196.69999999999956, 7.999999999999988, 207.64783082649575, 272.32078698152526, 201.99999999999935, 297.16463418406124, 71.09992511863916, 176.59999999999954, 152.62555374410826, 324.73193192210135, 187.69999999999965, 186.19999999999976, 120.9280786139476, 135.49659999163654, 198.59999999999937, 33.70000000000021, 194.49999999999994, 163.84284281761862, 180.4, 246.62602605657185, 236.10620331346612, 191.99999999999974, 272.46343119459846, 332.3, 172.69999999999945, 386.4, 238.50380437704672, 318.4, 202.49999999999963, 402.2893135099278, 142.70000000000002, 321.1254443605648, 192.92064116332756, 197.16654699580778, 278.0579442950764, 295.42265600787607, 198.0999999999997, -394.0177519898355, 270.4081895144611, 250.71945241661643, 352.1159316981824, 275.08642216917735, 369.1, 203.4438169552658, 166.59999999999985, 188.0999999999995, 321.5, 258.8766331744715, 371.21251341932003, 327.0, 260.87998687176133, 63.97081349074641, -73.10513611633957, 153.63952433624115, 361.41048727666254, 196.59999999999937, 185.79856731767492, 256.67275614642585, -332.7336190368004, 159.5676597474489], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-8.579177255591068, -31.489693120107518, -187.45915154976515, -397.7137067166798, 0.7019878698331481, -246.76085309112258, 18.910536172460862, -7.3079783835379875, 83.27294578453146, 169.22679420675698, -37.57359711878291, 183.48613141138466, -61.146914639815286, 39.42936071400217, 1.1684276718905762, -305.92595243247706, 41.21802054577513, -64.49519144479102, -193.0738510659489, 112.86280602582244, 47.607264290115985, 163.933826639104, 52.06887890196361, 64.39229787019727, -29.644908243379184, -54.51134957703753, -494.1644834859004, 48.06303549441206, 170.9597378038822, 173.9, 139.48685300779798, 160.28000996834447, 120.85262616215955, -71.39399534404404, 98.42385806983705, 88.73550302611424, -241.57971385626217, -456.7618270329071, 39.9107357605861, -6.640527405815355, -79.6422313940696, 141.87827288804473, -167.10129634692817, -414.47390090063243, -21.104745903564364, 36.516275877985535, -407.59414526185606, 56.25548162199694, -421.628276052221, 157.22904415444467, 31.517486556468853, 39.090500024685184, -111.80745244523516, -487.12897579649473, 76.9723252604843, 169.32841948793396, 118.07684506612722, -668.1020230584479, 81.50523937174655, -699.380841772796, -143.26037932669072, 55.35229265131049, 124.8280331777091, 174.0846083225387, -14.714023038399006, 70.85553101448241, 118.7586543800679, 142.9785252015002, -442.46330644869596, -694.8287359458294, 127.91743260190589, -398.76756700333766, -40.13177869686854, 136.6046582855051, 168.20828713321555, 87.87221404620755, -474.52088742829915, 155.78668094541644, 170.74505981866292, 183.8, -210.1515323575054, 163.89242312550405, -582.6216757889476, -287.296830974778, -34.270110946113434, 40.85917204725272, 21.264359850973747, 121.17628958210204, -160.2642088088711, 187.3560667057139, 99.01707221750645, 74.99029154529609, -242.14483976306457, -28.671356291927665, -9.413978770720679, 66.66616578221378, -504.63561892514247, 87.05871969142925, 78.15644956596466, 158.48358723003966, -187.71415233476085, 151.127176810298, 93.87997875152872, -240.53538627062426, -119.6961372042694, -26.634442545460004, -345.63396708822455, -20.587413856351432, -37.81063396118496, 159.5749197005499, 5.746081862838978, -60.47436820478322, -366.53949102601183, 149.40277525096923, 75.79241813757152, -52.184003503835974, -382.61447397206103, 117.19027232758668, -78.96698626774185, -14.798015021743907, 34.36127917180774, -229.45598101339576, -272.62822512724625, 134.95806960588092, -20.222626039339715, 148.40024320598394, 124.4296226806834, 101.65617497433243, 140.10246421120712, -315.2334767251092, 178.41888062130096, 198.04836952232102, 34.67551656632551, 64.21542744120646, 10.8221797269265, 188.93549358484876, 182.6374133054367, -109.41689941660614, -790.9019494786053, 141.51139869776483, -318.5369947435458, 79.55059116965128, 138.49202588267482, 67.06543173963011, -354.540507312573, 136.70518511365327, -119.46277224246627, 156.6400419660981, 31.924065519677825, -490.6490682516721, -1.9609087810697474, 132.16989993808102, 178.23092480854177, -299.174627450765, -974.3212130797273, -1046.0965210662048, 128.97393750830935, -355.8686294470049, 6.012428152653314, 52.18027041609119, 138.53557424980107, 161.80561223130053, 19.34480306470745, -1.2193930193699885, 180.7620120881912, 150.66597617991826, -454.58687489708666, 170.55383167738043, -311.50755376523887, 107.47011675816087, 124.63194399779061, -273.00966949487537, 119.35352008388782, 190.7947209502874, -488.50071451530613, 46.588337332637266, 160.87305828306418, 62.04756485599259, 56.63189775272545, 158.2462225720377, 43.72243257693795, 51.71123364925977, -12.906781782150093, -383.68633361170504, -665.6391644960592, -668.8566905117107, 53.97212077076368, -719.8359311524642, 166.52496385025506, 149.48707807462756, 148.34807661299075, -24.85998673186236, -35.77721869396336, -273.6364756983371, 104.95729082126937, 43.561177564528755, -716.4000612366359, -900.0382293928809, -66.88207672306899, -107.58047935593066], "policy_predator_policy_reward": [26.479177255591182, 154.4896931201075, 29.827652960036215, 420.77144233688693, 34.46202302396079, 346.6739712710874, 0.9894638275391416, 25.707978383538094, 78.72705421546853, 6.94507971408569, 54.07359711878315, 11.51386858861534, 120.7066050214781, 43.61094890433434, 368.06190168548767, 29.193261623536088, 9.162891465603943, 219.7306439229648, 183.11605846300745, 198.60713937233396, 81.39273570988402, 18.260818194245545, 35.556323772523406, 116.37525100326579, 129.01619294107775, 70.39875830539702, 490.31299056326503, 142.0294808599789, 7.773047715493063, 8.89034456068914, 34.61314699220203, 16.619990031655465, 46.1429034896971, 151.29846569218748, 76.81761864651496, 15.177241947781564, 556.8153995818507, 137.1493984375189, 38.17499117606183, 131.68170531782476, 203.84223139406961, 25.406025230397013, 451.48723100303084, 94.52855341305288, 39.60474590356462, 115.48372412201446, 409.59414526185617, 90.14451837800303, 424.86206518114125, 76.13107215983909, 91.43499030133817, 110.30782498609298, 323.5397513249592, 257.89072072953684, 80.0276747395157, 11.213577538588298, 529.1152608013035, 510.3376914132365, 115.0619160107104, 697.9163756787287, 61.70156165879262, 218.86223988627043, 43.171966822290905, 13.11539167746127, 4.645993734780102, 178.50961927195436, 60.58147477103491, 34.42147479849975, 359.5539700867321, 713.7932020398968, 130.02087720849676, 347.13328534280095, 9.682424121599315, 162.67877827055392, 62.851499867379914, 43.69857139552152, 446.32761061395075, 104.91357923736096, 13.554940181337066, 0.0, 221.85153235750494, 21.107576874495958, 584.9216757889476, 292.9968309747786, 93.03044757773445, 108.028322147622, 6.1532228632271, 123.72691468522245, 171.56420880887052, 3.3439332942860602, 41.2302125550274, 81.92705786623127, 329.51306296757645, 12.403058206055118, 23.30130064553896, 96.04651234296789, 514.8830235962066, 55.31942938161666, 74.79124517888816, 13.300649947208802, 197.41415233476047, 26.872823189701997, 81.12002124847128, 251.73538627062442, 84.93695196389942, 182.32170639977815, 342.212150996501, 159.50582993971213, 55.41063396118521, 21.425080299450094, 12.953918137160997, 75.47436820478264, 25.33330933336437, 386.3034064416783, 48.64946902973917, 91.58495915414446, 385.8144739720611, 60.00972767241331, 206.36132200838313, 134.02970533767447, 183.10445422000788, 248.09645093504645, 3.732136157284728, 325.9380193640805, 140.93030200740085, 3.355512020553346, 43.87037731931661, 62.34382502566758, 21.19753578879291, 326.6334767251118, 8.98111937869905, 0.9516304776789737, 112.9779089590771, 26.63495141043772, 45.27928434701437, 73.36304234121036, 5.9625866945633055, 123.3168994166061, 696.7557272231094, 354.92413706765876, 330.73699474354584, 50.94940883034876, 57.77469987057345, 57.79328686768621, 340.24238087648826, 70.51358248576014, 128.69608360165446, 31.293193670521244, 372.800693488915, 363.9822535381555, 125.97339082100997, 39.240274029854845, 10.269075191458233, 308.7746274507651, 788.4300995252897, 837.9698826308065, 171.8323210847621, 325.4705603683945, 41.79806632193639, 150.7286875259356, 1.1870847470342152, 50.58766047004657, 88.48642733938377, 168.47458478445617, 4.33798791180881, 33.33402382008174, 404.44101098023975, 83.03584919473187, 318.10755376523855, 52.52988324183913, 52.368056002209386, 284.1096694948773, 11.351758965824787, 0.0, 481.20730204537887, 219.58170831176164, 57.792477907385646, 90.49941237287766, 88.36810224727455, 23.753777427962305, 135.7989542090374, 29.647366436526234, 263.7356606463684, 196.82826823823302, 706.5835803021431, 554.8071385892891, 106.80049953578076, 712.7028351821612, 12.033566396067332, 33.36487895571259, 8.066042511868336, 65.04586760700326, 215.49864786173964, 279.7136138482358, 18.276526154094128, 89.87776160653357, 501.12495110808493, 782.5797204846314, 171.03999038921478, 162.9902254372336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7304580977391135, "mean_inference_ms": 5.7944521227002, "mean_action_processing_ms": 3.668490304490394, "mean_env_wait_ms": 1.2918261802792492, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007972240447998047, "StateBufferConnector_ms": 0.004314780235290527, "ViewRequirementAgentConnector_ms": 0.1468876600265503}, "num_episodes": 22, "episode_return_max": 489.42777422221934, "episode_return_min": -394.0177519898355, "episode_return_mean": 205.25562323338204, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 576000, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 67.86832988603037, "num_env_steps_trained_throughput_per_sec": 67.86832988603037, "timesteps_total": 144000, "num_env_steps_sampled_lifetime": 144000, "num_agent_steps_sampled_lifetime": 576000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 576000, "timers": {"training_iteration_time_ms": 96587.091, "restore_workers_time_ms": 0.014, "training_step_time_ms": 96587.045, "sample_time_ms": 1609.958, "learn_time_ms": 94959.811, "learn_throughput": 42.123, "synch_weights_time_ms": 14.719}, "counters": {"num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 576000}, "done": false, "training_iteration": 36, "trial_id": "cf3bb_00000", "date": "2024-08-20_09-13-40", "timestamp": 1724125420, "time_this_iter_s": 58.96969509124756, "time_total_s": 9684.764824390411, "pid": 25777, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39f77dc10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 9684.764824390411, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 49.6710843373494, "ram_util_percent": 82.16024096385541}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9913633622386784, "cur_kl_coeff": 0.011865234375000004, "cur_lr": 0.00010000000000000003, "total_loss": 3.400214166237564, "policy_loss": -0.002209489878572563, "vf_loss": 3.402248132922662, "vf_explained_var": 0.0003060755906281648, "kl": 0.014792679309885223, "entropy": 1.4218406394675926, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 68985.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 27.140925117176046, "cur_kl_coeff": 0.0421875, "cur_lr": 0.00010000000000000003, "total_loss": 7.405458482106527, "policy_loss": -0.0035063713944206635, "vf_loss": 7.4084233074591905, "vf_explained_var": 0.292622292577905, "kl": 0.012836361280864409, "entropy": 1.373821318906451, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 68985.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_agent_steps_sampled": 592000, "num_agent_steps_trained": 592000}, "env_runners": {"episode_reward_max": 516.3719144715055, "episode_reward_min": -394.0177519898355, "episode_reward_mean": 225.256672114988, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1115.7101595224167, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 198.04836952232102, "predator_policy": 975.3591149905094}, "policy_reward_mean": {"prey_policy": -67.23992718285231, "predator_policy": 179.86826324034638}, "custom_metrics": {}, "hist_stats": {"episode_reward": [148.39999999999995, 236.59390544320422, 272.3508018685852, -17.505956187233565, 337.54199702652227, 489.42777422221934, 195.10268928838968, 192.65571486968278, 355.2, 239.2971209828177, 356.7401291511028, -63.944870267897414, 206.30402814986573, 268.83408198078985, 362.6305724423245, 232.50698336842888, 368.1, 196.69999999999956, 7.999999999999988, 207.64783082649575, 272.32078698152526, 201.99999999999935, 297.16463418406124, 71.09992511863916, 176.59999999999954, 152.62555374410826, 324.73193192210135, 187.69999999999965, 186.19999999999976, 120.9280786139476, 135.49659999163654, 198.59999999999937, 33.70000000000021, 194.49999999999994, 163.84284281761862, 180.4, 246.62602605657185, 236.10620331346612, 191.99999999999974, 272.46343119459846, 332.3, 172.69999999999945, 386.4, 238.50380437704672, 318.4, 202.49999999999963, 402.2893135099278, 142.70000000000002, 321.1254443605648, 192.92064116332756, 197.16654699580778, 278.0579442950764, 295.42265600787607, 198.0999999999997, -394.0177519898355, 270.4081895144611, 250.71945241661643, 352.1159316981824, 275.08642216917735, 369.1, 203.4438169552658, 166.59999999999985, 188.0999999999995, 321.5, 258.8766331744715, 371.21251341932003, 327.0, 260.87998687176133, 63.97081349074641, -73.10513611633957, 153.63952433624115, 361.41048727666254, 196.59999999999937, 185.79856731767492, 256.67275614642585, -332.7336190368004, 159.5676597474489, 273.5979218578008, 382.3061178650571, 345.3, 147.19999999999962, 303.753415298973, 240.4298578696131, 49.29386472193488, 390.57835768706127, 118.22535625036333, 305.2538388705868, 43.77772237186518, 343.0, 478.5081508345069, 364.2992781948565, 331.9, 353.1, 326.0, 354.0, 158.09999999999954, 34.200000000000216, 146.35000000000002, 516.3719144715055, 210.9999999999993], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-407.59414526185606, 56.25548162199694, -421.628276052221, 157.22904415444467, 31.517486556468853, 39.090500024685184, -111.80745244523516, -487.12897579649473, 76.9723252604843, 169.32841948793396, 118.07684506612722, -668.1020230584479, 81.50523937174655, -699.380841772796, -143.26037932669072, 55.35229265131049, 124.8280331777091, 174.0846083225387, -14.714023038399006, 70.85553101448241, 118.7586543800679, 142.9785252015002, -442.46330644869596, -694.8287359458294, 127.91743260190589, -398.76756700333766, -40.13177869686854, 136.6046582855051, 168.20828713321555, 87.87221404620755, -474.52088742829915, 155.78668094541644, 170.74505981866292, 183.8, -210.1515323575054, 163.89242312550405, -582.6216757889476, -287.296830974778, -34.270110946113434, 40.85917204725272, 21.264359850973747, 121.17628958210204, -160.2642088088711, 187.3560667057139, 99.01707221750645, 74.99029154529609, -242.14483976306457, -28.671356291927665, -9.413978770720679, 66.66616578221378, -504.63561892514247, 87.05871969142925, 78.15644956596466, 158.48358723003966, -187.71415233476085, 151.127176810298, 93.87997875152872, -240.53538627062426, -119.6961372042694, -26.634442545460004, -345.63396708822455, -20.587413856351432, -37.81063396118496, 159.5749197005499, 5.746081862838978, -60.47436820478322, -366.53949102601183, 149.40277525096923, 75.79241813757152, -52.184003503835974, -382.61447397206103, 117.19027232758668, -78.96698626774185, -14.798015021743907, 34.36127917180774, -229.45598101339576, -272.62822512724625, 134.95806960588092, -20.222626039339715, 148.40024320598394, 124.4296226806834, 101.65617497433243, 140.10246421120712, -315.2334767251092, 178.41888062130096, 198.04836952232102, 34.67551656632551, 64.21542744120646, 10.8221797269265, 188.93549358484876, 182.6374133054367, -109.41689941660614, -790.9019494786053, 141.51139869776483, -318.5369947435458, 79.55059116965128, 138.49202588267482, 67.06543173963011, -354.540507312573, 136.70518511365327, -119.46277224246627, 156.6400419660981, 31.924065519677825, -490.6490682516721, -1.9609087810697474, 132.16989993808102, 178.23092480854177, -299.174627450765, -974.3212130797273, -1046.0965210662048, 128.97393750830935, -355.8686294470049, 6.012428152653314, 52.18027041609119, 138.53557424980107, 161.80561223130053, 19.34480306470745, -1.2193930193699885, 180.7620120881912, 150.66597617991826, -454.58687489708666, 170.55383167738043, -311.50755376523887, 107.47011675816087, 124.63194399779061, -273.00966949487537, 119.35352008388782, 190.7947209502874, -488.50071451530613, 46.588337332637266, 160.87305828306418, 62.04756485599259, 56.63189775272545, 158.2462225720377, 43.72243257693795, 51.71123364925977, -12.906781782150093, -383.68633361170504, -665.6391644960592, -668.8566905117107, 53.97212077076368, -719.8359311524642, 166.52496385025506, 149.48707807462756, 148.34807661299075, -24.85998673186236, -35.77721869396336, -273.6364756983371, 104.95729082126937, 43.561177564528755, -716.4000612366359, -900.0382293928809, -66.88207672306899, -107.58047935593066, 99.748335320888, 21.35267478509121, 149.95643960636045, -546.7295059849667, 167.04653880643193, 111.44229964128982, 20.000000000000014, -13.592738744179144, 79.31940414799841, 142.40229447087424, -219.67178415375443, 166.6149116817105, -437.96893087065206, -67.91041214841722, 189.9401449896419, 185.5146665555661, -17.94568423926235, -266.50568657145203, 48.89257870831167, 153.30260713207568, 2.026021455796018, -659.1637241086781, 120.96509740893674, 75.40779963756225, -309.5864916586169, -1115.7101595224167, 154.26056658102624, 117.62335187672457, 73.53072943376905, 145.09914143919454, 168.16269331962124, 131.82487397931254, 119.39915313077367, 78.05983913750364, 121.47493634486374, 160.56811468257177, 20.000000000000014, 107.6630025717979, 17.733759198631084, -137.05756385856967, -975.3591149905094, 21.632632330846548, 19.572911250886662, -942.4951617230871, 174.3072064432873, -2.8595934893259045], "policy_predator_policy_reward": [409.59414526185617, 90.14451837800303, 424.86206518114125, 76.13107215983909, 91.43499030133817, 110.30782498609298, 323.5397513249592, 257.89072072953684, 80.0276747395157, 11.213577538588298, 529.1152608013035, 510.3376914132365, 115.0619160107104, 697.9163756787287, 61.70156165879262, 218.86223988627043, 43.171966822290905, 13.11539167746127, 4.645993734780102, 178.50961927195436, 60.58147477103491, 34.42147479849975, 359.5539700867321, 713.7932020398968, 130.02087720849676, 347.13328534280095, 9.682424121599315, 162.67877827055392, 62.851499867379914, 43.69857139552152, 446.32761061395075, 104.91357923736096, 13.554940181337066, 0.0, 221.85153235750494, 21.107576874495958, 584.9216757889476, 292.9968309747786, 93.03044757773445, 108.028322147622, 6.1532228632271, 123.72691468522245, 171.56420880887052, 3.3439332942860602, 41.2302125550274, 81.92705786623127, 329.51306296757645, 12.403058206055118, 23.30130064553896, 96.04651234296789, 514.8830235962066, 55.31942938161666, 74.79124517888816, 13.300649947208802, 197.41415233476047, 26.872823189701997, 81.12002124847128, 251.73538627062442, 84.93695196389942, 182.32170639977815, 342.212150996501, 159.50582993971213, 55.41063396118521, 21.425080299450094, 12.953918137160997, 75.47436820478264, 25.33330933336437, 386.3034064416783, 48.64946902973917, 91.58495915414446, 385.8144739720611, 60.00972767241331, 206.36132200838313, 134.02970533767447, 183.10445422000788, 248.09645093504645, 3.732136157284728, 325.9380193640805, 140.93030200740085, 3.355512020553346, 43.87037731931661, 62.34382502566758, 21.19753578879291, 326.6334767251118, 8.98111937869905, 0.9516304776789737, 112.9779089590771, 26.63495141043772, 45.27928434701437, 73.36304234121036, 5.9625866945633055, 123.3168994166061, 696.7557272231094, 354.92413706765876, 330.73699474354584, 50.94940883034876, 57.77469987057345, 57.79328686768621, 340.24238087648826, 70.51358248576014, 128.69608360165446, 31.293193670521244, 372.800693488915, 363.9822535381555, 125.97339082100997, 39.240274029854845, 10.269075191458233, 308.7746274507651, 788.4300995252897, 837.9698826308065, 171.8323210847621, 325.4705603683945, 41.79806632193639, 150.7286875259356, 1.1870847470342152, 50.58766047004657, 88.48642733938377, 168.47458478445617, 4.33798791180881, 33.33402382008174, 404.44101098023975, 83.03584919473187, 318.10755376523855, 52.52988324183913, 52.368056002209386, 284.1096694948773, 11.351758965824787, 0.0, 481.20730204537887, 219.58170831176164, 57.792477907385646, 90.49941237287766, 88.36810224727455, 23.753777427962305, 135.7989542090374, 29.647366436526234, 263.7356606463684, 196.82826823823302, 706.5835803021431, 554.8071385892891, 106.80049953578076, 712.7028351821612, 12.033566396067332, 33.36487895571259, 8.066042511868336, 65.04586760700326, 215.49864786173964, 279.7136138482358, 18.276526154094128, 89.87776160653357, 501.12495110808493, 782.5797204846314, 171.03999038921478, 162.9902254372336, 9.906896695340944, 142.5900150564808, 415.68225158122317, 363.39693266244024, 13.353461193568076, 53.45770035871019, 98.42660223716452, 42.3661365070146, 34.52421217377012, 47.50750450633021, 231.5717841537538, 61.914946187903176, 125.75601265610705, 429.4171950848984, 7.685795821102627, 7.437750320750639, 128.7710404896257, 273.90568657145184, 2.704247016626905, 100.35440601357257, 474.3387864092548, 226.57663861549264, 59.03490259106326, 87.59220036243777, 931.3267841817135, 972.4780178338289, 72.5953787581364, 19.819980978969326, 77.3692705662309, 35.90085856080547, 15.837306680378763, 37.27512602068746, 51.600846869226324, 76.94016086249636, 49.525063655136265, 22.43188531742821, 0.0, 30.43699742820217, 2.0662408013689024, 151.45756385856885, 975.3591149905094, 124.71736766915343, 635.5055927997172, 803.7885721439891, 15.6223470568753, 23.930039989163344]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7036493072854884, "mean_inference_ms": 5.815893123379658, "mean_action_processing_ms": 3.452607814117619, "mean_env_wait_ms": 1.2535950659535182, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007973432540893555, "StateBufferConnector_ms": 0.004443168640136719, "ViewRequirementAgentConnector_ms": 0.1799861192703247}, "num_episodes": 23, "episode_return_max": 516.3719144715055, "episode_return_min": -394.0177519898355, "episode_return_mean": 225.256672114988, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 592000, "num_agent_steps_trained": 592000, "num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 68.66543497761093, "num_env_steps_trained_throughput_per_sec": 68.66543497761093, "timesteps_total": 148000, "num_env_steps_sampled_lifetime": 148000, "num_agent_steps_sampled_lifetime": 592000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 592000, "timers": {"training_iteration_time_ms": 70634.934, "restore_workers_time_ms": 0.014, "training_step_time_ms": 70634.886, "sample_time_ms": 1716.299, "learn_time_ms": 68899.746, "learn_throughput": 58.055, "synch_weights_time_ms": 15.854}, "counters": {"num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_agent_steps_sampled": 592000, "num_agent_steps_trained": 592000}, "done": false, "training_iteration": 37, "trial_id": "cf3bb_00000", "date": "2024-08-20_09-14-39", "timestamp": 1724125479, "time_this_iter_s": 58.33342123031616, "time_total_s": 9743.098245620728, "pid": 25777, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39f78fb80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 9743.098245620728, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 48.191566265060246, "ram_util_percent": 80.97831325301205}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.078835883050684, "cur_kl_coeff": 0.011865234375000004, "cur_lr": 0.00010000000000000003, "total_loss": 2.1622133113719797, "policy_loss": -0.004962476400816172, "vf_loss": 2.1669562848156723, "vf_explained_var": 0.0038191355094707832, "kl": 0.018499552784460898, "entropy": 1.490805879282573, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 70875.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 28.60445830462471, "cur_kl_coeff": 0.0421875, "cur_lr": 0.00010000000000000003, "total_loss": 7.083854856188335, "policy_loss": -0.0060970859037263805, "vf_loss": 7.08937136912472, "vf_explained_var": 0.5512711750767219, "kl": 0.013761405711026088, "entropy": 1.3563750939394432, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 70875.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_agent_steps_sampled": 608000, "num_agent_steps_trained": 608000}, "env_runners": {"episode_reward_max": 516.3719144715055, "episode_reward_min": -394.0177519898355, "episode_reward_mean": 227.92125186632222, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1115.7101595224167, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 198.04836952232102, "predator_policy": 975.3591149905094}, "policy_reward_mean": {"prey_policy": -41.042804240771055, "predator_policy": 155.00343017393226}, "custom_metrics": {}, "hist_stats": {"episode_reward": [7.999999999999988, 207.64783082649575, 272.32078698152526, 201.99999999999935, 297.16463418406124, 71.09992511863916, 176.59999999999954, 152.62555374410826, 324.73193192210135, 187.69999999999965, 186.19999999999976, 120.9280786139476, 135.49659999163654, 198.59999999999937, 33.70000000000021, 194.49999999999994, 163.84284281761862, 180.4, 246.62602605657185, 236.10620331346612, 191.99999999999974, 272.46343119459846, 332.3, 172.69999999999945, 386.4, 238.50380437704672, 318.4, 202.49999999999963, 402.2893135099278, 142.70000000000002, 321.1254443605648, 192.92064116332756, 197.16654699580778, 278.0579442950764, 295.42265600787607, 198.0999999999997, -394.0177519898355, 270.4081895144611, 250.71945241661643, 352.1159316981824, 275.08642216917735, 369.1, 203.4438169552658, 166.59999999999985, 188.0999999999995, 321.5, 258.8766331744715, 371.21251341932003, 327.0, 260.87998687176133, 63.97081349074641, -73.10513611633957, 153.63952433624115, 361.41048727666254, 196.59999999999937, 185.79856731767492, 256.67275614642585, -332.7336190368004, 159.5676597474489, 273.5979218578008, 382.3061178650571, 345.3, 147.19999999999962, 303.753415298973, 240.4298578696131, 49.29386472193488, 390.57835768706127, 118.22535625036333, 305.2538388705868, 43.77772237186518, 343.0, 478.5081508345069, 364.2992781948565, 331.9, 353.1, 326.0, 354.0, 158.09999999999954, 34.200000000000216, 146.35000000000002, 516.3719144715055, 210.9999999999993, 380.00000000000034, 340.48232076824166, 193.7999999999994, 212.3999999999993, 371.38725533426424, 188.54119573586382, 340.08389013371595, 378.9, 199.69999999999936, 39.60270709693497, 204.39999999999932, 220.41280241523265, 371.0, 34.200000000000216, 179.49999999999946, 323.70000000000005, 318.38277598797305, 346.90000000000003], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-582.6216757889476, -287.296830974778, -34.270110946113434, 40.85917204725272, 21.264359850973747, 121.17628958210204, -160.2642088088711, 187.3560667057139, 99.01707221750645, 74.99029154529609, -242.14483976306457, -28.671356291927665, -9.413978770720679, 66.66616578221378, -504.63561892514247, 87.05871969142925, 78.15644956596466, 158.48358723003966, -187.71415233476085, 151.127176810298, 93.87997875152872, -240.53538627062426, -119.6961372042694, -26.634442545460004, -345.63396708822455, -20.587413856351432, -37.81063396118496, 159.5749197005499, 5.746081862838978, -60.47436820478322, -366.53949102601183, 149.40277525096923, 75.79241813757152, -52.184003503835974, -382.61447397206103, 117.19027232758668, -78.96698626774185, -14.798015021743907, 34.36127917180774, -229.45598101339576, -272.62822512724625, 134.95806960588092, -20.222626039339715, 148.40024320598394, 124.4296226806834, 101.65617497433243, 140.10246421120712, -315.2334767251092, 178.41888062130096, 198.04836952232102, 34.67551656632551, 64.21542744120646, 10.8221797269265, 188.93549358484876, 182.6374133054367, -109.41689941660614, -790.9019494786053, 141.51139869776483, -318.5369947435458, 79.55059116965128, 138.49202588267482, 67.06543173963011, -354.540507312573, 136.70518511365327, -119.46277224246627, 156.6400419660981, 31.924065519677825, -490.6490682516721, -1.9609087810697474, 132.16989993808102, 178.23092480854177, -299.174627450765, -974.3212130797273, -1046.0965210662048, 128.97393750830935, -355.8686294470049, 6.012428152653314, 52.18027041609119, 138.53557424980107, 161.80561223130053, 19.34480306470745, -1.2193930193699885, 180.7620120881912, 150.66597617991826, -454.58687489708666, 170.55383167738043, -311.50755376523887, 107.47011675816087, 124.63194399779061, -273.00966949487537, 119.35352008388782, 190.7947209502874, -488.50071451530613, 46.588337332637266, 160.87305828306418, 62.04756485599259, 56.63189775272545, 158.2462225720377, 43.72243257693795, 51.71123364925977, -12.906781782150093, -383.68633361170504, -665.6391644960592, -668.8566905117107, 53.97212077076368, -719.8359311524642, 166.52496385025506, 149.48707807462756, 148.34807661299075, -24.85998673186236, -35.77721869396336, -273.6364756983371, 104.95729082126937, 43.561177564528755, -716.4000612366359, -900.0382293928809, -66.88207672306899, -107.58047935593066, 99.748335320888, 21.35267478509121, 149.95643960636045, -546.7295059849667, 167.04653880643193, 111.44229964128982, 20.000000000000014, -13.592738744179144, 79.31940414799841, 142.40229447087424, -219.67178415375443, 166.6149116817105, -437.96893087065206, -67.91041214841722, 189.9401449896419, 185.5146665555661, -17.94568423926235, -266.50568657145203, 48.89257870831167, 153.30260713207568, 2.026021455796018, -659.1637241086781, 120.96509740893674, 75.40779963756225, -309.5864916586169, -1115.7101595224167, 154.26056658102624, 117.62335187672457, 73.53072943376905, 145.09914143919454, 168.16269331962124, 131.82487397931254, 119.39915313077367, 78.05983913750364, 121.47493634486374, 160.56811468257177, 20.000000000000014, 107.6630025717979, 17.733759198631084, -137.05756385856967, -975.3591149905094, 21.632632330846548, 19.572911250886662, -942.4951617230871, 174.3072064432873, -2.8595934893259045, 180.73529532390802, 197.3, 126.64874011717008, 164.17715480576283, -5.2762405710138225, 128.93647460846722, 11.575464678307034, 186.50751783020814, 163.40705141258417, 160.53522229338415, -542.1981652557964, 128.0369600546345, 107.28862708692857, 137.02060816837766, 168.94938658940873, 187.32282146594733, -25.57710572893844, 133.49733964199487, -262.7488506011565, -14.523273921006043, -27.72710964368177, 150.8794592736289, 193.5288399902193, -15.414476907332674, 176.31544054465033, 142.69732209650357, 15.337798874469982, -101.71972728041874, -163.6609507268254, 106.71831192298475, 90.65356389126424, 154.76156913097896, 131.95821134465476, 143.9933927750459, 188.2166291894015, 118.45110355677122], "policy_predator_policy_reward": [584.9216757889476, 292.9968309747786, 93.03044757773445, 108.028322147622, 6.1532228632271, 123.72691468522245, 171.56420880887052, 3.3439332942860602, 41.2302125550274, 81.92705786623127, 329.51306296757645, 12.403058206055118, 23.30130064553896, 96.04651234296789, 514.8830235962066, 55.31942938161666, 74.79124517888816, 13.300649947208802, 197.41415233476047, 26.872823189701997, 81.12002124847128, 251.73538627062442, 84.93695196389942, 182.32170639977815, 342.212150996501, 159.50582993971213, 55.41063396118521, 21.425080299450094, 12.953918137160997, 75.47436820478264, 25.33330933336437, 386.3034064416783, 48.64946902973917, 91.58495915414446, 385.8144739720611, 60.00972767241331, 206.36132200838313, 134.02970533767447, 183.10445422000788, 248.09645093504645, 3.732136157284728, 325.9380193640805, 140.93030200740085, 3.355512020553346, 43.87037731931661, 62.34382502566758, 21.19753578879291, 326.6334767251118, 8.98111937869905, 0.9516304776789737, 112.9779089590771, 26.63495141043772, 45.27928434701437, 73.36304234121036, 5.9625866945633055, 123.3168994166061, 696.7557272231094, 354.92413706765876, 330.73699474354584, 50.94940883034876, 57.77469987057345, 57.79328686768621, 340.24238087648826, 70.51358248576014, 128.69608360165446, 31.293193670521244, 372.800693488915, 363.9822535381555, 125.97339082100997, 39.240274029854845, 10.269075191458233, 308.7746274507651, 788.4300995252897, 837.9698826308065, 171.8323210847621, 325.4705603683945, 41.79806632193639, 150.7286875259356, 1.1870847470342152, 50.58766047004657, 88.48642733938377, 168.47458478445617, 4.33798791180881, 33.33402382008174, 404.44101098023975, 83.03584919473187, 318.10755376523855, 52.52988324183913, 52.368056002209386, 284.1096694948773, 11.351758965824787, 0.0, 481.20730204537887, 219.58170831176164, 57.792477907385646, 90.49941237287766, 88.36810224727455, 23.753777427962305, 135.7989542090374, 29.647366436526234, 263.7356606463684, 196.82826823823302, 706.5835803021431, 554.8071385892891, 106.80049953578076, 712.7028351821612, 12.033566396067332, 33.36487895571259, 8.066042511868336, 65.04586760700326, 215.49864786173964, 279.7136138482358, 18.276526154094128, 89.87776160653357, 501.12495110808493, 782.5797204846314, 171.03999038921478, 162.9902254372336, 9.906896695340944, 142.5900150564808, 415.68225158122317, 363.39693266244024, 13.353461193568076, 53.45770035871019, 98.42660223716452, 42.3661365070146, 34.52421217377012, 47.50750450633021, 231.5717841537538, 61.914946187903176, 125.75601265610705, 429.4171950848984, 7.685795821102627, 7.437750320750639, 128.7710404896257, 273.90568657145184, 2.704247016626905, 100.35440601357257, 474.3387864092548, 226.57663861549264, 59.03490259106326, 87.59220036243777, 931.3267841817135, 972.4780178338289, 72.5953787581364, 19.819980978969326, 77.3692705662309, 35.90085856080547, 15.837306680378763, 37.27512602068746, 51.600846869226324, 76.94016086249636, 49.525063655136265, 22.43188531742821, 0.0, 30.43699742820217, 2.0662408013689024, 151.45756385856885, 975.3591149905094, 124.71736766915343, 635.5055927997172, 803.7885721439891, 15.6223470568753, 23.930039989163344, 1.9647046760918787, 0.0, 42.35125988282992, 7.305165962478849, 24.076240571013898, 46.06352539153277, 7.824535321692931, 6.492482169791861, 23.25057612060385, 24.19440550769205, 497.05009451967754, 105.65230641734968, 33.09459545745661, 62.68005942095312, 17.650613410591266, 4.977178534052676, 44.27710572893871, 47.50266035800512, 48.86592777653651, 268.0089038425626, 36.72941424281581, 44.51823612723731, 9.583962425014123, 32.714476907332866, 13.684559455349676, 38.30267790349643, 37.913610124368354, 82.66831828157946, 176.1609507268247, 60.28168807701524, 50.74967498491203, 27.5351919928448, 24.47418612279473, 17.95698574547642, 4.083370810598524, 36.14889644322882]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6890175429473748, "mean_inference_ms": 5.7393842460632, "mean_action_processing_ms": 3.3755959565596907, "mean_env_wait_ms": 1.2303447565449537, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007984161376953125, "StateBufferConnector_ms": 0.004756808280944824, "ViewRequirementAgentConnector_ms": 0.1912144422531128}, "num_episodes": 18, "episode_return_max": 516.3719144715055, "episode_return_min": -394.0177519898355, "episode_return_mean": 227.92125186632222, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 608000, "num_agent_steps_trained": 608000, "num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 68.63422702575535, "num_env_steps_trained_throughput_per_sec": 68.63422702575535, "timesteps_total": 152000, "num_env_steps_sampled_lifetime": 152000, "num_agent_steps_sampled_lifetime": 608000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 608000, "timers": {"training_iteration_time_ms": 53252.007, "restore_workers_time_ms": 0.015, "training_step_time_ms": 53251.959, "sample_time_ms": 1768.868, "learn_time_ms": 51463.871, "learn_throughput": 77.724, "synch_weights_time_ms": 16.178}, "counters": {"num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_agent_steps_sampled": 608000, "num_agent_steps_trained": 608000}, "done": false, "training_iteration": 38, "trial_id": "cf3bb_00000", "date": "2024-08-20_09-15-37", "timestamp": 1724125537, "time_this_iter_s": 58.3382887840271, "time_total_s": 9801.436534404755, "pid": 25777, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39f77d160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 9801.436534404755, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 47.07590361445783, "ram_util_percent": 80.17710843373494}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7793124926862893, "cur_kl_coeff": 0.011865234375000004, "cur_lr": 0.00010000000000000003, "total_loss": 2.5191815529550823, "policy_loss": -0.0064206629114412755, "vf_loss": 2.525372129899484, "vf_explained_var": 0.001825892799115055, "kl": 0.019391781815895202, "entropy": 1.5185489880344856, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 72765.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 30.638456462899214, "cur_kl_coeff": 0.0421875, "cur_lr": 0.00010000000000000003, "total_loss": 6.792228368981175, "policy_loss": -0.00517641650586729, "vf_loss": 6.79688521037026, "vf_explained_var": 0.5220077333626923, "kl": 0.012315796832347653, "entropy": 1.2742092547593293, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 72765.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 624000, "num_agent_steps_trained": 624000}, "env_runners": {"episode_reward_max": 516.3719144715055, "episode_reward_min": -394.0177519898355, "episode_reward_mean": 246.55675063103547, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1115.7101595224167, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 198.04836952232102, "predator_policy": 975.3591149905094}, "policy_reward_mean": {"prey_policy": -20.896380780430217, "predator_policy": 144.17475609594803}, "custom_metrics": {}, "hist_stats": {"episode_reward": [246.62602605657185, 236.10620331346612, 191.99999999999974, 272.46343119459846, 332.3, 172.69999999999945, 386.4, 238.50380437704672, 318.4, 202.49999999999963, 402.2893135099278, 142.70000000000002, 321.1254443605648, 192.92064116332756, 197.16654699580778, 278.0579442950764, 295.42265600787607, 198.0999999999997, -394.0177519898355, 270.4081895144611, 250.71945241661643, 352.1159316981824, 275.08642216917735, 369.1, 203.4438169552658, 166.59999999999985, 188.0999999999995, 321.5, 258.8766331744715, 371.21251341932003, 327.0, 260.87998687176133, 63.97081349074641, -73.10513611633957, 153.63952433624115, 361.41048727666254, 196.59999999999937, 185.79856731767492, 256.67275614642585, -332.7336190368004, 159.5676597474489, 273.5979218578008, 382.3061178650571, 345.3, 147.19999999999962, 303.753415298973, 240.4298578696131, 49.29386472193488, 390.57835768706127, 118.22535625036333, 305.2538388705868, 43.77772237186518, 343.0, 478.5081508345069, 364.2992781948565, 331.9, 353.1, 326.0, 354.0, 158.09999999999954, 34.200000000000216, 146.35000000000002, 516.3719144715055, 210.9999999999993, 380.00000000000034, 340.48232076824166, 193.7999999999994, 212.3999999999993, 371.38725533426424, 188.54119573586382, 340.08389013371595, 378.9, 199.69999999999936, 39.60270709693497, 204.39999999999932, 220.41280241523265, 371.0, 34.200000000000216, 179.49999999999946, 323.70000000000005, 318.38277598797305, 346.90000000000003, 212.19999999999936, 369.081093019443, 340.06500783717735, 218.2415885331005, 149.19999999999968, 205.45606045415337, 342.3158658538314, 200.09999999999937, 204.99999999999952, 313.7251788499693, 334.0583278238721, 368.8561422920196, 279.2588506880162, 320.0, 359.4395603298197, 257.22587828475025, 307.1845067053064, 195.69999999999987], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-78.96698626774185, -14.798015021743907, 34.36127917180774, -229.45598101339576, -272.62822512724625, 134.95806960588092, -20.222626039339715, 148.40024320598394, 124.4296226806834, 101.65617497433243, 140.10246421120712, -315.2334767251092, 178.41888062130096, 198.04836952232102, 34.67551656632551, 64.21542744120646, 10.8221797269265, 188.93549358484876, 182.6374133054367, -109.41689941660614, -790.9019494786053, 141.51139869776483, -318.5369947435458, 79.55059116965128, 138.49202588267482, 67.06543173963011, -354.540507312573, 136.70518511365327, -119.46277224246627, 156.6400419660981, 31.924065519677825, -490.6490682516721, -1.9609087810697474, 132.16989993808102, 178.23092480854177, -299.174627450765, -974.3212130797273, -1046.0965210662048, 128.97393750830935, -355.8686294470049, 6.012428152653314, 52.18027041609119, 138.53557424980107, 161.80561223130053, 19.34480306470745, -1.2193930193699885, 180.7620120881912, 150.66597617991826, -454.58687489708666, 170.55383167738043, -311.50755376523887, 107.47011675816087, 124.63194399779061, -273.00966949487537, 119.35352008388782, 190.7947209502874, -488.50071451530613, 46.588337332637266, 160.87305828306418, 62.04756485599259, 56.63189775272545, 158.2462225720377, 43.72243257693795, 51.71123364925977, -12.906781782150093, -383.68633361170504, -665.6391644960592, -668.8566905117107, 53.97212077076368, -719.8359311524642, 166.52496385025506, 149.48707807462756, 148.34807661299075, -24.85998673186236, -35.77721869396336, -273.6364756983371, 104.95729082126937, 43.561177564528755, -716.4000612366359, -900.0382293928809, -66.88207672306899, -107.58047935593066, 99.748335320888, 21.35267478509121, 149.95643960636045, -546.7295059849667, 167.04653880643193, 111.44229964128982, 20.000000000000014, -13.592738744179144, 79.31940414799841, 142.40229447087424, -219.67178415375443, 166.6149116817105, -437.96893087065206, -67.91041214841722, 189.9401449896419, 185.5146665555661, -17.94568423926235, -266.50568657145203, 48.89257870831167, 153.30260713207568, 2.026021455796018, -659.1637241086781, 120.96509740893674, 75.40779963756225, -309.5864916586169, -1115.7101595224167, 154.26056658102624, 117.62335187672457, 73.53072943376905, 145.09914143919454, 168.16269331962124, 131.82487397931254, 119.39915313077367, 78.05983913750364, 121.47493634486374, 160.56811468257177, 20.000000000000014, 107.6630025717979, 17.733759198631084, -137.05756385856967, -975.3591149905094, 21.632632330846548, 19.572911250886662, -942.4951617230871, 174.3072064432873, -2.8595934893259045, 180.73529532390802, 197.3, 126.64874011717008, 164.17715480576283, -5.2762405710138225, 128.93647460846722, 11.575464678307034, 186.50751783020814, 163.40705141258417, 160.53522229338415, -542.1981652557964, 128.0369600546345, 107.28862708692857, 137.02060816837766, 168.94938658940873, 187.32282146594733, -25.57710572893844, 133.49733964199487, -262.7488506011565, -14.523273921006043, -27.72710964368177, 150.8794592736289, 193.5288399902193, -15.414476907332674, 176.31544054465033, 142.69732209650357, 15.337798874469982, -101.71972728041874, -163.6609507268254, 106.71831192298475, 90.65356389126424, 154.76156913097896, 131.95821134465476, 143.9933927750459, 188.2166291894015, 118.45110355677122, 188.09993683760462, -20.181510056665424, 175.12467881006822, 116.10108182907199, 97.32400099403654, 150.7895485466489, 176.33242999928873, -235.3155303641522, 41.22592924196027, -61.45720002979694, 28.188822428162155, -67.72869917092336, 87.63771430913488, 107.60829478050287, -0.074047069222485, 179.9544612602375, -355.10014077463575, 195.13318454825685, 135.38691729068063, 106.22963347412293, 140.7519278125386, 126.03645728755117, 160.67330170530573, 171.8686120662934, -8.561336387574016, 16.855384059490916, 37.18617233046639, 37.85965112003309, 127.86946802607142, 165.27415535976263, 48.898034464827006, 80.34523314279981, 130.11643448601131, 13.108852398711846, 190.94100885917257, -457.2194647249718], "policy_predator_policy_reward": [206.36132200838313, 134.02970533767447, 183.10445422000788, 248.09645093504645, 3.732136157284728, 325.9380193640805, 140.93030200740085, 3.355512020553346, 43.87037731931661, 62.34382502566758, 21.19753578879291, 326.6334767251118, 8.98111937869905, 0.9516304776789737, 112.9779089590771, 26.63495141043772, 45.27928434701437, 73.36304234121036, 5.9625866945633055, 123.3168994166061, 696.7557272231094, 354.92413706765876, 330.73699474354584, 50.94940883034876, 57.77469987057345, 57.79328686768621, 340.24238087648826, 70.51358248576014, 128.69608360165446, 31.293193670521244, 372.800693488915, 363.9822535381555, 125.97339082100997, 39.240274029854845, 10.269075191458233, 308.7746274507651, 788.4300995252897, 837.9698826308065, 171.8323210847621, 325.4705603683945, 41.79806632193639, 150.7286875259356, 1.1870847470342152, 50.58766047004657, 88.48642733938377, 168.47458478445617, 4.33798791180881, 33.33402382008174, 404.44101098023975, 83.03584919473187, 318.10755376523855, 52.52988324183913, 52.368056002209386, 284.1096694948773, 11.351758965824787, 0.0, 481.20730204537887, 219.58170831176164, 57.792477907385646, 90.49941237287766, 88.36810224727455, 23.753777427962305, 135.7989542090374, 29.647366436526234, 263.7356606463684, 196.82826823823302, 706.5835803021431, 554.8071385892891, 106.80049953578076, 712.7028351821612, 12.033566396067332, 33.36487895571259, 8.066042511868336, 65.04586760700326, 215.49864786173964, 279.7136138482358, 18.276526154094128, 89.87776160653357, 501.12495110808493, 782.5797204846314, 171.03999038921478, 162.9902254372336, 9.906896695340944, 142.5900150564808, 415.68225158122317, 363.39693266244024, 13.353461193568076, 53.45770035871019, 98.42660223716452, 42.3661365070146, 34.52421217377012, 47.50750450633021, 231.5717841537538, 61.914946187903176, 125.75601265610705, 429.4171950848984, 7.685795821102627, 7.437750320750639, 128.7710404896257, 273.90568657145184, 2.704247016626905, 100.35440601357257, 474.3387864092548, 226.57663861549264, 59.03490259106326, 87.59220036243777, 931.3267841817135, 972.4780178338289, 72.5953787581364, 19.819980978969326, 77.3692705662309, 35.90085856080547, 15.837306680378763, 37.27512602068746, 51.600846869226324, 76.94016086249636, 49.525063655136265, 22.43188531742821, 0.0, 30.43699742820217, 2.0662408013689024, 151.45756385856885, 975.3591149905094, 124.71736766915343, 635.5055927997172, 803.7885721439891, 15.6223470568753, 23.930039989163344, 1.9647046760918787, 0.0, 42.35125988282992, 7.305165962478849, 24.076240571013898, 46.06352539153277, 7.824535321692931, 6.492482169791861, 23.25057612060385, 24.19440550769205, 497.05009451967754, 105.65230641734968, 33.09459545745661, 62.68005942095312, 17.650613410591266, 4.977178534052676, 44.27710572893871, 47.50266035800512, 48.86592777653651, 268.0089038425626, 36.72941424281581, 44.51823612723731, 9.583962425014123, 32.714476907332866, 13.684559455349676, 38.30267790349643, 37.913610124368354, 82.66831828157946, 176.1609507268247, 60.28168807701524, 50.74967498491203, 27.5351919928448, 24.47418612279473, 17.95698574547642, 4.083370810598524, 36.14889644322882, 6.90006316239538, 37.38151005666558, 31.008053440371267, 46.84727893993155, 56.19637527043022, 35.75508302606167, 135.85460465376232, 141.37008424420185, 44.66390570896841, 124.76736507886753, 25.89351501344461, 219.10242218346988, 94.57815154469658, 52.49170521949713, 18.37404706922244, 1.8455387397624883, 363.8001407746377, 1.1668154517431528, 62.67662668342263, 9.432001401743076, 45.50094277786506, 21.76899994591714, 21.326698294694257, 14.987530225726225, 181.04630647840247, 89.91849653769688, 124.81382766953361, 120.14034887996691, 48.33053197392858, 17.96540497005707, 28.765455125839328, 99.21715555128414, 43.56807221929501, 120.39114760128807, 0.858991140827423, 461.1194647249722]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6755720062905362, "mean_inference_ms": 5.668417669636482, "mean_action_processing_ms": 3.303373484259452, "mean_env_wait_ms": 1.2087501567627976, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007410883903503418, "StateBufferConnector_ms": 0.00510251522064209, "ViewRequirementAgentConnector_ms": 0.20831120014190674}, "num_episodes": 18, "episode_return_max": 516.3719144715055, "episode_return_min": -394.0177519898355, "episode_return_mean": 246.55675063103547, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 624000, "num_agent_steps_trained": 624000, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 65.61386597392374, "num_env_steps_trained_throughput_per_sec": 65.61386597392374, "timesteps_total": 156000, "num_env_steps_sampled_lifetime": 156000, "num_agent_steps_sampled_lifetime": 624000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 624000, "timers": {"training_iteration_time_ms": 54755.117, "restore_workers_time_ms": 0.015, "training_step_time_ms": 54755.068, "sample_time_ms": 1992.797, "learn_time_ms": 52741.713, "learn_throughput": 75.841, "synch_weights_time_ms": 16.906}, "counters": {"num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 624000, "num_agent_steps_trained": 624000}, "done": false, "training_iteration": 39, "trial_id": "cf3bb_00000", "date": "2024-08-20_09-16-38", "timestamp": 1724125598, "time_this_iter_s": 60.99574422836304, "time_total_s": 9862.432278633118, "pid": 25777, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39ffb85e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 9862.432278633118, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 50.35172413793105, "ram_util_percent": 80.92988505747125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9524272908451696, "cur_kl_coeff": 0.011865234375000004, "cur_lr": 0.00010000000000000003, "total_loss": 4.922193209582535, "policy_loss": -0.004259439689974502, "vf_loss": 4.926252715423624, "vf_explained_var": -5.3916532526571285e-05, "kl": 0.016850035543451446, "entropy": 1.4629379475558246, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 74655.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 27.307334561890396, "cur_kl_coeff": 0.0421875, "cur_lr": 0.00010000000000000003, "total_loss": 7.691949112453158, "policy_loss": -0.00550317372633982, "vf_loss": 7.696826295751743, "vf_explained_var": 0.34149865158020504, "kl": 0.014838209111477174, "entropy": 1.269008201455313, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 74655.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 640000, "num_agent_steps_trained": 640000}, "env_runners": {"episode_reward_max": 516.3719144715055, "episode_reward_min": -332.7336190368004, "episode_reward_mean": 255.18337893208977, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1115.7101595224167, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 975.3591149905094}, "policy_reward_mean": {"prey_policy": -26.87115250292243, "predator_policy": 154.4628419689674}, "custom_metrics": {}, "hist_stats": {"episode_reward": [275.08642216917735, 369.1, 203.4438169552658, 166.59999999999985, 188.0999999999995, 321.5, 258.8766331744715, 371.21251341932003, 327.0, 260.87998687176133, 63.97081349074641, -73.10513611633957, 153.63952433624115, 361.41048727666254, 196.59999999999937, 185.79856731767492, 256.67275614642585, -332.7336190368004, 159.5676597474489, 273.5979218578008, 382.3061178650571, 345.3, 147.19999999999962, 303.753415298973, 240.4298578696131, 49.29386472193488, 390.57835768706127, 118.22535625036333, 305.2538388705868, 43.77772237186518, 343.0, 478.5081508345069, 364.2992781948565, 331.9, 353.1, 326.0, 354.0, 158.09999999999954, 34.200000000000216, 146.35000000000002, 516.3719144715055, 210.9999999999993, 380.00000000000034, 340.48232076824166, 193.7999999999994, 212.3999999999993, 371.38725533426424, 188.54119573586382, 340.08389013371595, 378.9, 199.69999999999936, 39.60270709693497, 204.39999999999932, 220.41280241523265, 371.0, 34.200000000000216, 179.49999999999946, 323.70000000000005, 318.38277598797305, 346.90000000000003, 212.19999999999936, 369.081093019443, 340.06500783717735, 218.2415885331005, 149.19999999999968, 205.45606045415337, 342.3158658538314, 200.09999999999937, 204.99999999999952, 313.7251788499693, 334.0583278238721, 368.8561422920196, 279.2588506880162, 320.0, 359.4395603298197, 257.22587828475025, 307.1845067053064, 195.69999999999987, 189.79999999999941, 515.6864137941072, 351.2, 384.1, 5.390981823397489, 360.90000000000003, 147.2925130219075, 297.58156365402647, 231.71778785374877, 26.800000000000114, 369.4, 211.59999999999943, 178.1732566663395, 466.0484564385302, 206.1999999999995, -0.3840946182553957, 185.83388347648298, 485.4467420086064, 328.53647997856245, 337.1561804875657, 329.19049843409795, 360.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [19.34480306470745, -1.2193930193699885, 180.7620120881912, 150.66597617991826, -454.58687489708666, 170.55383167738043, -311.50755376523887, 107.47011675816087, 124.63194399779061, -273.00966949487537, 119.35352008388782, 190.7947209502874, -488.50071451530613, 46.588337332637266, 160.87305828306418, 62.04756485599259, 56.63189775272545, 158.2462225720377, 43.72243257693795, 51.71123364925977, -12.906781782150093, -383.68633361170504, -665.6391644960592, -668.8566905117107, 53.97212077076368, -719.8359311524642, 166.52496385025506, 149.48707807462756, 148.34807661299075, -24.85998673186236, -35.77721869396336, -273.6364756983371, 104.95729082126937, 43.561177564528755, -716.4000612366359, -900.0382293928809, -66.88207672306899, -107.58047935593066, 99.748335320888, 21.35267478509121, 149.95643960636045, -546.7295059849667, 167.04653880643193, 111.44229964128982, 20.000000000000014, -13.592738744179144, 79.31940414799841, 142.40229447087424, -219.67178415375443, 166.6149116817105, -437.96893087065206, -67.91041214841722, 189.9401449896419, 185.5146665555661, -17.94568423926235, -266.50568657145203, 48.89257870831167, 153.30260713207568, 2.026021455796018, -659.1637241086781, 120.96509740893674, 75.40779963756225, -309.5864916586169, -1115.7101595224167, 154.26056658102624, 117.62335187672457, 73.53072943376905, 145.09914143919454, 168.16269331962124, 131.82487397931254, 119.39915313077367, 78.05983913750364, 121.47493634486374, 160.56811468257177, 20.000000000000014, 107.6630025717979, 17.733759198631084, -137.05756385856967, -975.3591149905094, 21.632632330846548, 19.572911250886662, -942.4951617230871, 174.3072064432873, -2.8595934893259045, 180.73529532390802, 197.3, 126.64874011717008, 164.17715480576283, -5.2762405710138225, 128.93647460846722, 11.575464678307034, 186.50751783020814, 163.40705141258417, 160.53522229338415, -542.1981652557964, 128.0369600546345, 107.28862708692857, 137.02060816837766, 168.94938658940873, 187.32282146594733, -25.57710572893844, 133.49733964199487, -262.7488506011565, -14.523273921006043, -27.72710964368177, 150.8794592736289, 193.5288399902193, -15.414476907332674, 176.31544054465033, 142.69732209650357, 15.337798874469982, -101.71972728041874, -163.6609507268254, 106.71831192298475, 90.65356389126424, 154.76156913097896, 131.95821134465476, 143.9933927750459, 188.2166291894015, 118.45110355677122, 188.09993683760462, -20.181510056665424, 175.12467881006822, 116.10108182907199, 97.32400099403654, 150.7895485466489, 176.33242999928873, -235.3155303641522, 41.22592924196027, -61.45720002979694, 28.188822428162155, -67.72869917092336, 87.63771430913488, 107.60829478050287, -0.074047069222485, 179.9544612602375, -355.10014077463575, 195.13318454825685, 135.38691729068063, 106.22963347412293, 140.7519278125386, 126.03645728755117, 160.67330170530573, 171.8686120662934, -8.561336387574016, 16.855384059490916, 37.18617233046639, 37.85965112003309, 127.86946802607142, 165.27415535976263, 48.898034464827006, 80.34523314279981, 130.11643448601131, 13.108852398711846, 190.94100885917257, -457.2194647249718, 153.88155622971996, 13.581809499124569, -1047.3501986939646, 79.87686080173447, 142.88862900061125, 144.9210621391069, 160.10755003076554, 200.0, -566.7672573262239, -317.2333744213013, 198.00617786339214, 159.20118821964385, -739.2655437356947, -194.00881901625016, 130.58163033987762, 62.60805026037118, -40.31971372422578, 53.890170495479495, -285.7376950562197, 12.31837696341769, 166.53716833955264, 117.79078685015101, -123.44924249337423, 194.0173096711519, 45.92485100844489, -494.3677946346973, 158.7386309230398, -782.1530523639327, 191.1754021494096, -201.12321101108643, -417.3418777026127, -951.9514647131936, -526.5773329049935, 150.25976976383322, -907.0858350627689, 81.82804084003426, 114.93229702912406, 132.7796048232712, 113.51579358723177, 148.96215887490732, 150.984871127295, 118.81591608329876, 129.07702988614662, 171.7984961093325], "policy_predator_policy_reward": [88.48642733938377, 168.47458478445617, 4.33798791180881, 33.33402382008174, 404.44101098023975, 83.03584919473187, 318.10755376523855, 52.52988324183913, 52.368056002209386, 284.1096694948773, 11.351758965824787, 0.0, 481.20730204537887, 219.58170831176164, 57.792477907385646, 90.49941237287766, 88.36810224727455, 23.753777427962305, 135.7989542090374, 29.647366436526234, 263.7356606463684, 196.82826823823302, 706.5835803021431, 554.8071385892891, 106.80049953578076, 712.7028351821612, 12.033566396067332, 33.36487895571259, 8.066042511868336, 65.04586760700326, 215.49864786173964, 279.7136138482358, 18.276526154094128, 89.87776160653357, 501.12495110808493, 782.5797204846314, 171.03999038921478, 162.9902254372336, 9.906896695340944, 142.5900150564808, 415.68225158122317, 363.39693266244024, 13.353461193568076, 53.45770035871019, 98.42660223716452, 42.3661365070146, 34.52421217377012, 47.50750450633021, 231.5717841537538, 61.914946187903176, 125.75601265610705, 429.4171950848984, 7.685795821102627, 7.437750320750639, 128.7710404896257, 273.90568657145184, 2.704247016626905, 100.35440601357257, 474.3387864092548, 226.57663861549264, 59.03490259106326, 87.59220036243777, 931.3267841817135, 972.4780178338289, 72.5953787581364, 19.819980978969326, 77.3692705662309, 35.90085856080547, 15.837306680378763, 37.27512602068746, 51.600846869226324, 76.94016086249636, 49.525063655136265, 22.43188531742821, 0.0, 30.43699742820217, 2.0662408013689024, 151.45756385856885, 975.3591149905094, 124.71736766915343, 635.5055927997172, 803.7885721439891, 15.6223470568753, 23.930039989163344, 1.9647046760918787, 0.0, 42.35125988282992, 7.305165962478849, 24.076240571013898, 46.06352539153277, 7.824535321692931, 6.492482169791861, 23.25057612060385, 24.19440550769205, 497.05009451967754, 105.65230641734968, 33.09459545745661, 62.68005942095312, 17.650613410591266, 4.977178534052676, 44.27710572893871, 47.50266035800512, 48.86592777653651, 268.0089038425626, 36.72941424281581, 44.51823612723731, 9.583962425014123, 32.714476907332866, 13.684559455349676, 38.30267790349643, 37.913610124368354, 82.66831828157946, 176.1609507268247, 60.28168807701524, 50.74967498491203, 27.5351919928448, 24.47418612279473, 17.95698574547642, 4.083370810598524, 36.14889644322882, 6.90006316239538, 37.38151005666558, 31.008053440371267, 46.84727893993155, 56.19637527043022, 35.75508302606167, 135.85460465376232, 141.37008424420185, 44.66390570896841, 124.76736507886753, 25.89351501344461, 219.10242218346988, 94.57815154469658, 52.49170521949713, 18.37404706922244, 1.8455387397624883, 363.8001407746377, 1.1668154517431528, 62.67662668342263, 9.432001401743076, 45.50094277786506, 21.76899994591714, 21.326698294694257, 14.987530225726225, 181.04630647840247, 89.91849653769688, 124.81382766953361, 120.14034887996691, 48.33053197392858, 17.96540497005707, 28.765455125839328, 99.21715555128414, 43.56807221929501, 120.39114760128807, 0.858991140827423, 461.1194647249722, 16.51844377028003, 5.818190500875396, 923.1781113503621, 559.9816403359755, 35.11137099938875, 28.278937860893098, 23.992449969234475, 0.0, 573.7655786125714, 315.62603495835447, 2.8438433484944254, 0.8487905684695894, 549.0354508736605, 531.5314249001905, 22.999933314148873, 81.3919497396288, 154.9548346247911, 63.192496457703925, 189.38229949482871, 110.83701859797486, 20.66283166044736, 64.40921314984898, 41.996735954411925, 99.03519686781061, 504.44743957325755, 122.16876071933417, 437.0401450209102, 652.4227328585132, 3.124597850590409, 213.02321101108575, 420.56177162584225, 948.3474761717088, 224.35077580152895, 337.80067081611446, 709.2907309886682, 601.413805242673, 41.066659441197956, 39.75791868496925, 49.563024722184636, 25.11520330324198, 0.9678907800136306, 58.4218204434905, 20.874729669273485, 38.249744335247414]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6625196942550047, "mean_inference_ms": 5.4781330262084085, "mean_action_processing_ms": 3.3203730870283277, "mean_env_wait_ms": 1.188534742510823, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005415439605712891, "StateBufferConnector_ms": 0.005011200904846191, "ViewRequirementAgentConnector_ms": 0.21570801734924316}, "num_episodes": 22, "episode_return_max": 516.3719144715055, "episode_return_min": -332.7336190368004, "episode_return_mean": 255.18337893208977, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 640000, "num_agent_steps_trained": 640000, "num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 66.45338587702993, "num_env_steps_trained_throughput_per_sec": 66.45338587702993, "timesteps_total": 160000, "num_env_steps_sampled_lifetime": 160000, "num_agent_steps_sampled_lifetime": 640000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 640000, "timers": {"training_iteration_time_ms": 56117.921, "restore_workers_time_ms": 0.015, "training_step_time_ms": 56117.87, "sample_time_ms": 2044.125, "learn_time_ms": 54052.362, "learn_throughput": 74.002, "synch_weights_time_ms": 17.505}, "counters": {"num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 640000, "num_agent_steps_trained": 640000}, "done": false, "training_iteration": 40, "trial_id": "cf3bb_00000", "date": "2024-08-20_09-17-39", "timestamp": 1724125659, "time_this_iter_s": 60.23316192626953, "time_total_s": 9922.665440559387, "pid": 25777, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39ffb8940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 9922.665440559387, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 50.34302325581394, "ram_util_percent": 81.10581395348838}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7347802442138788, "cur_kl_coeff": 0.011865234375000004, "cur_lr": 0.00010000000000000003, "total_loss": 2.056038153423834, "policy_loss": -0.00182673888559399, "vf_loss": 2.0577253431870193, "vf_explained_var": 0.0009379754621515829, "kl": 0.011761061554448601, "entropy": 1.4425627895133206, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 76545.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 33.76673812926131, "cur_kl_coeff": 0.0421875, "cur_lr": 0.00010000000000000003, "total_loss": 6.369428734804587, "policy_loss": -0.0029128232225529337, "vf_loss": 6.371942712390234, "vf_explained_var": 0.463079412904366, "kl": 0.009453786128016183, "entropy": 1.2843203270876848, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 76545.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_agent_steps_sampled": 656000, "num_agent_steps_trained": 656000}, "env_runners": {"episode_reward_max": 516.3719144715055, "episode_reward_min": -0.3840946182553957, "episode_reward_mean": 276.1613547488755, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1115.7101595224167, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 975.3591149905094}, "policy_reward_mean": {"prey_policy": 0.97341816233911, "predator_policy": 137.10725921209874}, "custom_metrics": {}, "hist_stats": {"episode_reward": [303.753415298973, 240.4298578696131, 49.29386472193488, 390.57835768706127, 118.22535625036333, 305.2538388705868, 43.77772237186518, 343.0, 478.5081508345069, 364.2992781948565, 331.9, 353.1, 326.0, 354.0, 158.09999999999954, 34.200000000000216, 146.35000000000002, 516.3719144715055, 210.9999999999993, 380.00000000000034, 340.48232076824166, 193.7999999999994, 212.3999999999993, 371.38725533426424, 188.54119573586382, 340.08389013371595, 378.9, 199.69999999999936, 39.60270709693497, 204.39999999999932, 220.41280241523265, 371.0, 34.200000000000216, 179.49999999999946, 323.70000000000005, 318.38277598797305, 346.90000000000003, 212.19999999999936, 369.081093019443, 340.06500783717735, 218.2415885331005, 149.19999999999968, 205.45606045415337, 342.3158658538314, 200.09999999999937, 204.99999999999952, 313.7251788499693, 334.0583278238721, 368.8561422920196, 279.2588506880162, 320.0, 359.4395603298197, 257.22587828475025, 307.1845067053064, 195.69999999999987, 189.79999999999941, 515.6864137941072, 351.2, 384.1, 5.390981823397489, 360.90000000000003, 147.2925130219075, 297.58156365402647, 231.71778785374877, 26.800000000000114, 369.4, 211.59999999999943, 178.1732566663395, 466.0484564385302, 206.1999999999995, -0.3840946182553957, 185.83388347648298, 485.4467420086064, 328.53647997856245, 337.1561804875657, 329.19049843409795, 360.0, 292.29872711725693, 378.4, 368.0, 387.0, 245.06842685732397, 348.0, 180.16162807249265, 315.4, 188.1999999999994, 360.84752543231934, 210.8999999999993, 267.46724503174903, 260.51611292279404, 294.47098922914125, 299.1397946824925, 181.14429909922893, 309.6618671322002, 500.5208676319054, 465.4191709468536, 141.89999999999964, 253.30539299773343, 331.80000000000007, 380.2], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [79.31940414799841, 142.40229447087424, -219.67178415375443, 166.6149116817105, -437.96893087065206, -67.91041214841722, 189.9401449896419, 185.5146665555661, -17.94568423926235, -266.50568657145203, 48.89257870831167, 153.30260713207568, 2.026021455796018, -659.1637241086781, 120.96509740893674, 75.40779963756225, -309.5864916586169, -1115.7101595224167, 154.26056658102624, 117.62335187672457, 73.53072943376905, 145.09914143919454, 168.16269331962124, 131.82487397931254, 119.39915313077367, 78.05983913750364, 121.47493634486374, 160.56811468257177, 20.000000000000014, 107.6630025717979, 17.733759198631084, -137.05756385856967, -975.3591149905094, 21.632632330846548, 19.572911250886662, -942.4951617230871, 174.3072064432873, -2.8595934893259045, 180.73529532390802, 197.3, 126.64874011717008, 164.17715480576283, -5.2762405710138225, 128.93647460846722, 11.575464678307034, 186.50751783020814, 163.40705141258417, 160.53522229338415, -542.1981652557964, 128.0369600546345, 107.28862708692857, 137.02060816837766, 168.94938658940873, 187.32282146594733, -25.57710572893844, 133.49733964199487, -262.7488506011565, -14.523273921006043, -27.72710964368177, 150.8794592736289, 193.5288399902193, -15.414476907332674, 176.31544054465033, 142.69732209650357, 15.337798874469982, -101.71972728041874, -163.6609507268254, 106.71831192298475, 90.65356389126424, 154.76156913097896, 131.95821134465476, 143.9933927750459, 188.2166291894015, 118.45110355677122, 188.09993683760462, -20.181510056665424, 175.12467881006822, 116.10108182907199, 97.32400099403654, 150.7895485466489, 176.33242999928873, -235.3155303641522, 41.22592924196027, -61.45720002979694, 28.188822428162155, -67.72869917092336, 87.63771430913488, 107.60829478050287, -0.074047069222485, 179.9544612602375, -355.10014077463575, 195.13318454825685, 135.38691729068063, 106.22963347412293, 140.7519278125386, 126.03645728755117, 160.67330170530573, 171.8686120662934, -8.561336387574016, 16.855384059490916, 37.18617233046639, 37.85965112003309, 127.86946802607142, 165.27415535976263, 48.898034464827006, 80.34523314279981, 130.11643448601131, 13.108852398711846, 190.94100885917257, -457.2194647249718, 153.88155622971996, 13.581809499124569, -1047.3501986939646, 79.87686080173447, 142.88862900061125, 144.9210621391069, 160.10755003076554, 200.0, -566.7672573262239, -317.2333744213013, 198.00617786339214, 159.20118821964385, -739.2655437356947, -194.00881901625016, 130.58163033987762, 62.60805026037118, -40.31971372422578, 53.890170495479495, -285.7376950562197, 12.31837696341769, 166.53716833955264, 117.79078685015101, -123.44924249337423, 194.0173096711519, 45.92485100844489, -494.3677946346973, 158.7386309230398, -782.1530523639327, 191.1754021494096, -201.12321101108643, -417.3418777026127, -951.9514647131936, -526.5773329049935, 150.25976976383322, -907.0858350627689, 81.82804084003426, 114.93229702912406, 132.7796048232712, 113.51579358723177, 148.96215887490732, 150.984871127295, 118.81591608329876, 129.07702988614662, 171.7984961093325, 134.87441620097783, 55.02101194379142, 185.48936350014628, 171.7437339737833, 123.13757031555548, 170.65551041732462, 158.52804188561885, 195.75987992701232, 83.61442635630888, 32.05669825506854, 92.54826954951903, 153.7002866986918, 112.2851720322648, 14.965569560951618, 43.53915324724453, 142.99541136381544, 134.16711273466984, -127.14557925412356, 171.7325750295892, 171.17996699408664, 187.46591356327264, -82.31006478927151, -6.234930017977831, 32.96983422217093, 63.69929766583128, 45.68891264139427, -50.71035842298227, 165.99529479432826, 69.74765889199385, 120.65745570562382, 16.14429909922943, 65.06790129657557, 168.2180480608737, -7.269105550791181, -794.6412854108809, 38.2744490277547, -747.5944602380772, 176.6, 107.50734306417701, 8.699151980723306, -803.8441919763558, 128.84498404725468, 123.2925947046758, 179.52315088024008, 190.37974160013937, 166.44269534977332], "policy_predator_policy_reward": [34.52421217377012, 47.50750450633021, 231.5717841537538, 61.914946187903176, 125.75601265610705, 429.4171950848984, 7.685795821102627, 7.437750320750639, 128.7710404896257, 273.90568657145184, 2.704247016626905, 100.35440601357257, 474.3387864092548, 226.57663861549264, 59.03490259106326, 87.59220036243777, 931.3267841817135, 972.4780178338289, 72.5953787581364, 19.819980978969326, 77.3692705662309, 35.90085856080547, 15.837306680378763, 37.27512602068746, 51.600846869226324, 76.94016086249636, 49.525063655136265, 22.43188531742821, 0.0, 30.43699742820217, 2.0662408013689024, 151.45756385856885, 975.3591149905094, 124.71736766915343, 635.5055927997172, 803.7885721439891, 15.6223470568753, 23.930039989163344, 1.9647046760918787, 0.0, 42.35125988282992, 7.305165962478849, 24.076240571013898, 46.06352539153277, 7.824535321692931, 6.492482169791861, 23.25057612060385, 24.19440550769205, 497.05009451967754, 105.65230641734968, 33.09459545745661, 62.68005942095312, 17.650613410591266, 4.977178534052676, 44.27710572893871, 47.50266035800512, 48.86592777653651, 268.0089038425626, 36.72941424281581, 44.51823612723731, 9.583962425014123, 32.714476907332866, 13.684559455349676, 38.30267790349643, 37.913610124368354, 82.66831828157946, 176.1609507268247, 60.28168807701524, 50.74967498491203, 27.5351919928448, 24.47418612279473, 17.95698574547642, 4.083370810598524, 36.14889644322882, 6.90006316239538, 37.38151005666558, 31.008053440371267, 46.84727893993155, 56.19637527043022, 35.75508302606167, 135.85460465376232, 141.37008424420185, 44.66390570896841, 124.76736507886753, 25.89351501344461, 219.10242218346988, 94.57815154469658, 52.49170521949713, 18.37404706922244, 1.8455387397624883, 363.8001407746377, 1.1668154517431528, 62.67662668342263, 9.432001401743076, 45.50094277786506, 21.76899994591714, 21.326698294694257, 14.987530225726225, 181.04630647840247, 89.91849653769688, 124.81382766953361, 120.14034887996691, 48.33053197392858, 17.96540497005707, 28.765455125839328, 99.21715555128414, 43.56807221929501, 120.39114760128807, 0.858991140827423, 461.1194647249722, 16.51844377028003, 5.818190500875396, 923.1781113503621, 559.9816403359755, 35.11137099938875, 28.278937860893098, 23.992449969234475, 0.0, 573.7655786125714, 315.62603495835447, 2.8438433484944254, 0.8487905684695894, 549.0354508736605, 531.5314249001905, 22.999933314148873, 81.3919497396288, 154.9548346247911, 63.192496457703925, 189.38229949482871, 110.83701859797486, 20.66283166044736, 64.40921314984898, 41.996735954411925, 99.03519686781061, 504.44743957325755, 122.16876071933417, 437.0401450209102, 652.4227328585132, 3.124597850590409, 213.02321101108575, 420.56177162584225, 948.3474761717088, 224.35077580152895, 337.80067081611446, 709.2907309886682, 601.413805242673, 41.066659441197956, 39.75791868496925, 49.563024722184636, 25.11520330324198, 0.9678907800136306, 58.4218204434905, 20.874729669273485, 38.249744335247414, 28.513340171448792, 73.88995880103886, 5.910636499853711, 15.256266026216714, 55.862429684444514, 18.344489582675376, 30.47195811438115, 2.240120072987665, 0.0, 129.39730224594658, 90.58094913884928, 11.170494612939873, 5.698983483253807, 47.211902996022935, 115.46084675275547, 13.404588636184554, 39.83288726533014, 141.34557925412275, 7.004786512084867, 10.930196896558586, 6.534086436727376, 99.21006478927055, 240.73234082755596, 0.0, 18.4968929314948, 132.63100968407372, 163.41035842298228, 15.775694434812959, 83.5213045855802, 25.21337549929459, 99.93209870342443, 0.0, 6.744599356978141, 141.96832526513947, 505.57522115980134, 751.3124828552301, 703.5188860174, 332.8947451675315, 4.762492207791606, 20.931012747308042, 708.1629586476215, 220.1416422792131, 19.307405295324237, 9.67684911975991, 5.62025839986064, 17.7573046502267]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7329562171943906, "mean_inference_ms": 5.319371352375345, "mean_action_processing_ms": 3.143772374747974, "mean_env_wait_ms": 1.2522769429079557, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00888669490814209, "StateBufferConnector_ms": 0.0045397281646728516, "ViewRequirementAgentConnector_ms": 0.1948244571685791}, "num_episodes": 23, "episode_return_max": 516.3719144715055, "episode_return_min": -0.3840946182553957, "episode_return_mean": 276.1613547488755, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 656000, "num_agent_steps_trained": 656000, "num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 77.36468535308643, "num_env_steps_trained_throughput_per_sec": 77.36468535308643, "timesteps_total": 164000, "num_env_steps_sampled_lifetime": 164000, "num_agent_steps_sampled_lifetime": 656000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 656000, "timers": {"training_iteration_time_ms": 56609.789, "restore_workers_time_ms": 0.015, "training_step_time_ms": 56609.739, "sample_time_ms": 2086.42, "learn_time_ms": 54500.921, "learn_throughput": 73.393, "synch_weights_time_ms": 18.121}, "counters": {"num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_agent_steps_sampled": 656000, "num_agent_steps_trained": 656000}, "done": false, "training_iteration": 41, "trial_id": "cf3bb_00000", "date": "2024-08-20_09-18-30", "timestamp": 1724125710, "time_this_iter_s": 51.72384524345398, "time_total_s": 9974.389285802841, "pid": 25777, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39f81e160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 9974.389285802841, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 38.983561643835614, "ram_util_percent": 81.54383561643837}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6407467892028825, "cur_kl_coeff": 0.011865234375000004, "cur_lr": 0.00010000000000000003, "total_loss": 2.421670409485146, "policy_loss": -0.0035505877943246295, "vf_loss": 2.4250022242308926, "vf_explained_var": 7.191978434406261e-07, "kl": 0.018437436331740834, "entropy": 1.3095361501451523, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 78435.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 32.18330090027007, "cur_kl_coeff": 0.0421875, "cur_lr": 0.00010000000000000003, "total_loss": 6.3245429788317, "policy_loss": -0.005420015684437381, "vf_loss": 6.3294578794449095, "vf_explained_var": 0.4628594682330177, "kl": 0.011973017864104932, "entropy": 1.2736746011587678, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 78435.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 672000, "num_agent_steps_trained": 672000}, "env_runners": {"episode_reward_max": 515.6864137941072, "episode_reward_min": -0.3840946182553957, "episode_reward_mean": 279.89493448922053, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1047.3501986939646, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 948.3474761717088}, "policy_reward_mean": {"prey_policy": 21.925071716985588, "predator_policy": 118.02239552762475}, "custom_metrics": {}, "hist_stats": {"episode_reward": [210.9999999999993, 380.00000000000034, 340.48232076824166, 193.7999999999994, 212.3999999999993, 371.38725533426424, 188.54119573586382, 340.08389013371595, 378.9, 199.69999999999936, 39.60270709693497, 204.39999999999932, 220.41280241523265, 371.0, 34.200000000000216, 179.49999999999946, 323.70000000000005, 318.38277598797305, 346.90000000000003, 212.19999999999936, 369.081093019443, 340.06500783717735, 218.2415885331005, 149.19999999999968, 205.45606045415337, 342.3158658538314, 200.09999999999937, 204.99999999999952, 313.7251788499693, 334.0583278238721, 368.8561422920196, 279.2588506880162, 320.0, 359.4395603298197, 257.22587828475025, 307.1845067053064, 195.69999999999987, 189.79999999999941, 515.6864137941072, 351.2, 384.1, 5.390981823397489, 360.90000000000003, 147.2925130219075, 297.58156365402647, 231.71778785374877, 26.800000000000114, 369.4, 211.59999999999943, 178.1732566663395, 466.0484564385302, 206.1999999999995, -0.3840946182553957, 185.83388347648298, 485.4467420086064, 328.53647997856245, 337.1561804875657, 329.19049843409795, 360.0, 292.29872711725693, 378.4, 368.0, 387.0, 245.06842685732397, 348.0, 180.16162807249265, 315.4, 188.1999999999994, 360.84752543231934, 210.8999999999993, 267.46724503174903, 260.51611292279404, 294.47098922914125, 299.1397946824925, 181.14429909922893, 309.6618671322002, 500.5208676319054, 465.4191709468536, 141.89999999999964, 253.30539299773343, 331.80000000000007, 380.2, 353.4, 363.9522653008734, 35.92018925158506, 180.19999999999973, 257.6625525850885, 330.87387974469493, 361.3, 179.39999999999998, 204.34726410015878, 377.3, 260.65283370393286, 335.47638788395705, 321.2, 389.1, 315.202730253858, 337.25836769899047, 385.65326008262775, 241.5999999999995], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [174.3072064432873, -2.8595934893259045, 180.73529532390802, 197.3, 126.64874011717008, 164.17715480576283, -5.2762405710138225, 128.93647460846722, 11.575464678307034, 186.50751783020814, 163.40705141258417, 160.53522229338415, -542.1981652557964, 128.0369600546345, 107.28862708692857, 137.02060816837766, 168.94938658940873, 187.32282146594733, -25.57710572893844, 133.49733964199487, -262.7488506011565, -14.523273921006043, -27.72710964368177, 150.8794592736289, 193.5288399902193, -15.414476907332674, 176.31544054465033, 142.69732209650357, 15.337798874469982, -101.71972728041874, -163.6609507268254, 106.71831192298475, 90.65356389126424, 154.76156913097896, 131.95821134465476, 143.9933927750459, 188.2166291894015, 118.45110355677122, 188.09993683760462, -20.181510056665424, 175.12467881006822, 116.10108182907199, 97.32400099403654, 150.7895485466489, 176.33242999928873, -235.3155303641522, 41.22592924196027, -61.45720002979694, 28.188822428162155, -67.72869917092336, 87.63771430913488, 107.60829478050287, -0.074047069222485, 179.9544612602375, -355.10014077463575, 195.13318454825685, 135.38691729068063, 106.22963347412293, 140.7519278125386, 126.03645728755117, 160.67330170530573, 171.8686120662934, -8.561336387574016, 16.855384059490916, 37.18617233046639, 37.85965112003309, 127.86946802607142, 165.27415535976263, 48.898034464827006, 80.34523314279981, 130.11643448601131, 13.108852398711846, 190.94100885917257, -457.2194647249718, 153.88155622971996, 13.581809499124569, -1047.3501986939646, 79.87686080173447, 142.88862900061125, 144.9210621391069, 160.10755003076554, 200.0, -566.7672573262239, -317.2333744213013, 198.00617786339214, 159.20118821964385, -739.2655437356947, -194.00881901625016, 130.58163033987762, 62.60805026037118, -40.31971372422578, 53.890170495479495, -285.7376950562197, 12.31837696341769, 166.53716833955264, 117.79078685015101, -123.44924249337423, 194.0173096711519, 45.92485100844489, -494.3677946346973, 158.7386309230398, -782.1530523639327, 191.1754021494096, -201.12321101108643, -417.3418777026127, -951.9514647131936, -526.5773329049935, 150.25976976383322, -907.0858350627689, 81.82804084003426, 114.93229702912406, 132.7796048232712, 113.51579358723177, 148.96215887490732, 150.984871127295, 118.81591608329876, 129.07702988614662, 171.7984961093325, 134.87441620097783, 55.02101194379142, 185.48936350014628, 171.7437339737833, 123.13757031555548, 170.65551041732462, 158.52804188561885, 195.75987992701232, 83.61442635630888, 32.05669825506854, 92.54826954951903, 153.7002866986918, 112.2851720322648, 14.965569560951618, 43.53915324724453, 142.99541136381544, 134.16711273466984, -127.14557925412356, 171.7325750295892, 171.17996699408664, 187.46591356327264, -82.31006478927151, -6.234930017977831, 32.96983422217093, 63.69929766583128, 45.68891264139427, -50.71035842298227, 165.99529479432826, 69.74765889199385, 120.65745570562382, 16.14429909922943, 65.06790129657557, 168.2180480608737, -7.269105550791181, -794.6412854108809, 38.2744490277547, -747.5944602380772, 176.6, 107.50734306417701, 8.699151980723306, -803.8441919763558, 128.84498404725468, 123.2925947046758, 179.52315088024008, 190.37974160013937, 166.44269534977332, 153.99927915479546, 147.69645663977687, 169.7322451810581, 169.8494580092394, 8.20752689016077, 6.86007809628064, -314.3196940727668, 105.48223580256938, 56.201228977382996, 60.31669799051046, 128.94340807233172, 152.8849931480405, 200.0, 98.95725649984901, -739.8687526357564, 141.78225355200567, 177.29262279949822, -498.3135971340017, 173.46205504216766, 180.77908712046042, -485.19489793588, -245.72182345608044, 125.1729234587373, 107.7520190256902, 64.75241376628205, 131.41175781072437, 193.8338841675035, 182.63272639015202, 87.95269274636819, 58.44542109634915, 148.44857663112623, 149.1786446853281, 142.6954371353841, 191.91021221190803, 186.03951721799763, 42.692884464683914], "policy_predator_policy_reward": [15.6223470568753, 23.930039989163344, 1.9647046760918787, 0.0, 42.35125988282992, 7.305165962478849, 24.076240571013898, 46.06352539153277, 7.824535321692931, 6.492482169791861, 23.25057612060385, 24.19440550769205, 497.05009451967754, 105.65230641734968, 33.09459545745661, 62.68005942095312, 17.650613410591266, 4.977178534052676, 44.27710572893871, 47.50266035800512, 48.86592777653651, 268.0089038425626, 36.72941424281581, 44.51823612723731, 9.583962425014123, 32.714476907332866, 13.684559455349676, 38.30267790349643, 37.913610124368354, 82.66831828157946, 176.1609507268247, 60.28168807701524, 50.74967498491203, 27.5351919928448, 24.47418612279473, 17.95698574547642, 4.083370810598524, 36.14889644322882, 6.90006316239538, 37.38151005666558, 31.008053440371267, 46.84727893993155, 56.19637527043022, 35.75508302606167, 135.85460465376232, 141.37008424420185, 44.66390570896841, 124.76736507886753, 25.89351501344461, 219.10242218346988, 94.57815154469658, 52.49170521949713, 18.37404706922244, 1.8455387397624883, 363.8001407746377, 1.1668154517431528, 62.67662668342263, 9.432001401743076, 45.50094277786506, 21.76899994591714, 21.326698294694257, 14.987530225726225, 181.04630647840247, 89.91849653769688, 124.81382766953361, 120.14034887996691, 48.33053197392858, 17.96540497005707, 28.765455125839328, 99.21715555128414, 43.56807221929501, 120.39114760128807, 0.858991140827423, 461.1194647249722, 16.51844377028003, 5.818190500875396, 923.1781113503621, 559.9816403359755, 35.11137099938875, 28.278937860893098, 23.992449969234475, 0.0, 573.7655786125714, 315.62603495835447, 2.8438433484944254, 0.8487905684695894, 549.0354508736605, 531.5314249001905, 22.999933314148873, 81.3919497396288, 154.9548346247911, 63.192496457703925, 189.38229949482871, 110.83701859797486, 20.66283166044736, 64.40921314984898, 41.996735954411925, 99.03519686781061, 504.44743957325755, 122.16876071933417, 437.0401450209102, 652.4227328585132, 3.124597850590409, 213.02321101108575, 420.56177162584225, 948.3474761717088, 224.35077580152895, 337.80067081611446, 709.2907309886682, 601.413805242673, 41.066659441197956, 39.75791868496925, 49.563024722184636, 25.11520330324198, 0.9678907800136306, 58.4218204434905, 20.874729669273485, 38.249744335247414, 28.513340171448792, 73.88995880103886, 5.910636499853711, 15.256266026216714, 55.862429684444514, 18.344489582675376, 30.47195811438115, 2.240120072987665, 0.0, 129.39730224594658, 90.58094913884928, 11.170494612939873, 5.698983483253807, 47.211902996022935, 115.46084675275547, 13.404588636184554, 39.83288726533014, 141.34557925412275, 7.004786512084867, 10.930196896558586, 6.534086436727376, 99.21006478927055, 240.73234082755596, 0.0, 18.4968929314948, 132.63100968407372, 163.41035842298228, 15.775694434812959, 83.5213045855802, 25.21337549929459, 99.93209870342443, 0.0, 6.744599356978141, 141.96832526513947, 505.57522115980134, 751.3124828552301, 703.5188860174, 332.8947451675315, 4.762492207791606, 20.931012747308042, 708.1629586476215, 220.1416422792131, 19.307405295324237, 9.67684911975991, 5.62025839986064, 17.7573046502267, 29.00072084520454, 22.703543360223154, 19.009428594085605, 5.361133516490334, 11.264782449270855, 9.587801815872485, 320.36969407276786, 68.66776419743057, 116.75779987477301, 24.386825742422047, 3.5497927750374765, 45.495685749285215, 36.41047165230803, 25.932271847842962, 741.2687526357563, 36.21774644799432, 123.63361566573177, 401.73462276893156, 11.837944957832356, 11.22091287953957, 583.4504178799386, 408.11913721595505, 42.303464425219715, 60.24798097430979, 54.257489194528496, 70.7783392284651, 3.166115832496508, 9.46727360984797, 112.63094555693554, 56.17367085420516, 37.61687045347271, 2.0142759290634165, 27.705776532735214, 23.341834202600392, 4.560482782002375, 8.307115535316061]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6238903062887347, "mean_inference_ms": 5.43089394246505, "mean_action_processing_ms": 3.0800091648811154, "mean_env_wait_ms": 1.140711402536946, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00878751277923584, "StateBufferConnector_ms": 0.004546999931335449, "ViewRequirementAgentConnector_ms": 0.17479825019836426}, "num_episodes": 18, "episode_return_max": 515.6864137941072, "episode_return_min": -0.3840946182553957, "episode_return_mean": 279.89493448922053, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 672000, "num_agent_steps_trained": 672000, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 78.71058511579994, "num_env_steps_trained_throughput_per_sec": 78.71058511579994, "timesteps_total": 168000, "num_env_steps_sampled_lifetime": 168000, "num_agent_steps_sampled_lifetime": 672000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 672000, "timers": {"training_iteration_time_ms": 57172.691, "restore_workers_time_ms": 0.015, "training_step_time_ms": 57172.641, "sample_time_ms": 2093.155, "learn_time_ms": 55055.074, "learn_throughput": 72.655, "synch_weights_time_ms": 19.946}, "counters": {"num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 672000, "num_agent_steps_trained": 672000}, "done": false, "training_iteration": 42, "trial_id": "cf3bb_00000", "date": "2024-08-20_09-19-21", "timestamp": 1724125761, "time_this_iter_s": 50.875174045562744, "time_total_s": 10025.264459848404, "pid": 25777, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39f78f310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 10025.264459848404, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 45.327397260273976, "ram_util_percent": 81.29726027397261}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7701404079242989, "cur_kl_coeff": 0.011865234375000004, "cur_lr": 0.00010000000000000003, "total_loss": 1.1916571033379388, "policy_loss": -0.0036834376346733836, "vf_loss": 1.1951173525480998, "vf_explained_var": 0.008735989515112822, "kl": 0.018810272009170775, "entropy": 1.122880216250344, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 80325.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 35.3057636652674, "cur_kl_coeff": 0.0421875, "cur_lr": 0.00010000000000000003, "total_loss": 5.908091572605113, "policy_loss": -0.003363000110121907, "vf_loss": 5.9110663512396435, "vf_explained_var": 0.6498013181030435, "kl": 0.009201948386323969, "entropy": 1.2289478366337125, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 80325.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_agent_steps_sampled": 688000, "num_agent_steps_trained": 688000}, "env_runners": {"episode_reward_max": 515.6864137941072, "episode_reward_min": -0.3840946182553957, "episode_reward_mean": 282.75973148089594, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1047.3501986939646, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 948.3474761717088}, "policy_reward_mean": {"prey_policy": 24.321058187533595, "predator_policy": 117.05880755291447}, "custom_metrics": {}, "hist_stats": {"episode_reward": [346.90000000000003, 212.19999999999936, 369.081093019443, 340.06500783717735, 218.2415885331005, 149.19999999999968, 205.45606045415337, 342.3158658538314, 200.09999999999937, 204.99999999999952, 313.7251788499693, 334.0583278238721, 368.8561422920196, 279.2588506880162, 320.0, 359.4395603298197, 257.22587828475025, 307.1845067053064, 195.69999999999987, 189.79999999999941, 515.6864137941072, 351.2, 384.1, 5.390981823397489, 360.90000000000003, 147.2925130219075, 297.58156365402647, 231.71778785374877, 26.800000000000114, 369.4, 211.59999999999943, 178.1732566663395, 466.0484564385302, 206.1999999999995, -0.3840946182553957, 185.83388347648298, 485.4467420086064, 328.53647997856245, 337.1561804875657, 329.19049843409795, 360.0, 292.29872711725693, 378.4, 368.0, 387.0, 245.06842685732397, 348.0, 180.16162807249265, 315.4, 188.1999999999994, 360.84752543231934, 210.8999999999993, 267.46724503174903, 260.51611292279404, 294.47098922914125, 299.1397946824925, 181.14429909922893, 309.6618671322002, 500.5208676319054, 465.4191709468536, 141.89999999999964, 253.30539299773343, 331.80000000000007, 380.2, 353.4, 363.9522653008734, 35.92018925158506, 180.19999999999973, 257.6625525850885, 330.87387974469493, 361.3, 179.39999999999998, 204.34726410015878, 377.3, 260.65283370393286, 335.47638788395705, 321.2, 389.1, 315.202730253858, 337.25836769899047, 385.65326008262775, 241.5999999999995, 339.6, 305.34236481291805, 304.4399905143455, 34.70000000000022, 327.90000000000003, 193.89999999999938, 180.9999999999994, 298.89999999999986, 231.5, 332.60682928724145, 229.64331496275003, 202.49999999999946, 204.91494553253153, 363.03782172174664, 312.1647637250053, 378.1, 190.0999999999994, 363.62261608323035], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [188.2166291894015, 118.45110355677122, 188.09993683760462, -20.181510056665424, 175.12467881006822, 116.10108182907199, 97.32400099403654, 150.7895485466489, 176.33242999928873, -235.3155303641522, 41.22592924196027, -61.45720002979694, 28.188822428162155, -67.72869917092336, 87.63771430913488, 107.60829478050287, -0.074047069222485, 179.9544612602375, -355.10014077463575, 195.13318454825685, 135.38691729068063, 106.22963347412293, 140.7519278125386, 126.03645728755117, 160.67330170530573, 171.8686120662934, -8.561336387574016, 16.855384059490916, 37.18617233046639, 37.85965112003309, 127.86946802607142, 165.27415535976263, 48.898034464827006, 80.34523314279981, 130.11643448601131, 13.108852398711846, 190.94100885917257, -457.2194647249718, 153.88155622971996, 13.581809499124569, -1047.3501986939646, 79.87686080173447, 142.88862900061125, 144.9210621391069, 160.10755003076554, 200.0, -566.7672573262239, -317.2333744213013, 198.00617786339214, 159.20118821964385, -739.2655437356947, -194.00881901625016, 130.58163033987762, 62.60805026037118, -40.31971372422578, 53.890170495479495, -285.7376950562197, 12.31837696341769, 166.53716833955264, 117.79078685015101, -123.44924249337423, 194.0173096711519, 45.92485100844489, -494.3677946346973, 158.7386309230398, -782.1530523639327, 191.1754021494096, -201.12321101108643, -417.3418777026127, -951.9514647131936, -526.5773329049935, 150.25976976383322, -907.0858350627689, 81.82804084003426, 114.93229702912406, 132.7796048232712, 113.51579358723177, 148.96215887490732, 150.984871127295, 118.81591608329876, 129.07702988614662, 171.7984961093325, 134.87441620097783, 55.02101194379142, 185.48936350014628, 171.7437339737833, 123.13757031555548, 170.65551041732462, 158.52804188561885, 195.75987992701232, 83.61442635630888, 32.05669825506854, 92.54826954951903, 153.7002866986918, 112.2851720322648, 14.965569560951618, 43.53915324724453, 142.99541136381544, 134.16711273466984, -127.14557925412356, 171.7325750295892, 171.17996699408664, 187.46591356327264, -82.31006478927151, -6.234930017977831, 32.96983422217093, 63.69929766583128, 45.68891264139427, -50.71035842298227, 165.99529479432826, 69.74765889199385, 120.65745570562382, 16.14429909922943, 65.06790129657557, 168.2180480608737, -7.269105550791181, -794.6412854108809, 38.2744490277547, -747.5944602380772, 176.6, 107.50734306417701, 8.699151980723306, -803.8441919763558, 128.84498404725468, 123.2925947046758, 179.52315088024008, 190.37974160013937, 166.44269534977332, 153.99927915479546, 147.69645663977687, 169.7322451810581, 169.8494580092394, 8.20752689016077, 6.86007809628064, -314.3196940727668, 105.48223580256938, 56.201228977382996, 60.31669799051046, 128.94340807233172, 152.8849931480405, 200.0, 98.95725649984901, -739.8687526357564, 141.78225355200567, 177.29262279949822, -498.3135971340017, 173.46205504216766, 180.77908712046042, -485.19489793588, -245.72182345608044, 125.1729234587373, 107.7520190256902, 64.75241376628205, 131.41175781072437, 193.8338841675035, 182.63272639015202, 87.95269274636819, 58.44542109634915, 148.44857663112623, 149.1786446853281, 142.6954371353841, 191.91021221190803, 186.03951721799763, 42.692884464683914, 73.74468086443221, 177.95101976187578, 86.10549564542859, 117.75634197434115, 123.30191109217412, 104.25579694549788, -16.09822381179014, -71.2889982927616, 163.53030404041232, 89.03443601863452, 122.7632588896229, -13.1592941804316, 157.80616869227106, -53.054427558458784, 174.6482068037113, 98.25862023304072, 39.794367920012796, 114.77305300810465, 51.16812079927425, 178.86693709464777, 86.61513840279902, 40.05869707427077, -316.8323003156928, 182.1187127031292, 164.4231547335161, -122.45039057998986, 168.00863530382574, 164.29129660811418, 75.58164093081811, 74.647177050643, 187.2578694344238, 187.92261056481996, 135.8718220228095, -8.905257746484105, 82.62315808585268, 159.19184013598084], "policy_predator_policy_reward": [4.083370810598524, 36.14889644322882, 6.90006316239538, 37.38151005666558, 31.008053440371267, 46.84727893993155, 56.19637527043022, 35.75508302606167, 135.85460465376232, 141.37008424420185, 44.66390570896841, 124.76736507886753, 25.89351501344461, 219.10242218346988, 94.57815154469658, 52.49170521949713, 18.37404706922244, 1.8455387397624883, 363.8001407746377, 1.1668154517431528, 62.67662668342263, 9.432001401743076, 45.50094277786506, 21.76899994591714, 21.326698294694257, 14.987530225726225, 181.04630647840247, 89.91849653769688, 124.81382766953361, 120.14034887996691, 48.33053197392858, 17.96540497005707, 28.765455125839328, 99.21715555128414, 43.56807221929501, 120.39114760128807, 0.858991140827423, 461.1194647249722, 16.51844377028003, 5.818190500875396, 923.1781113503621, 559.9816403359755, 35.11137099938875, 28.278937860893098, 23.992449969234475, 0.0, 573.7655786125714, 315.62603495835447, 2.8438433484944254, 0.8487905684695894, 549.0354508736605, 531.5314249001905, 22.999933314148873, 81.3919497396288, 154.9548346247911, 63.192496457703925, 189.38229949482871, 110.83701859797486, 20.66283166044736, 64.40921314984898, 41.996735954411925, 99.03519686781061, 504.44743957325755, 122.16876071933417, 437.0401450209102, 652.4227328585132, 3.124597850590409, 213.02321101108575, 420.56177162584225, 948.3474761717088, 224.35077580152895, 337.80067081611446, 709.2907309886682, 601.413805242673, 41.066659441197956, 39.75791868496925, 49.563024722184636, 25.11520330324198, 0.9678907800136306, 58.4218204434905, 20.874729669273485, 38.249744335247414, 28.513340171448792, 73.88995880103886, 5.910636499853711, 15.256266026216714, 55.862429684444514, 18.344489582675376, 30.47195811438115, 2.240120072987665, 0.0, 129.39730224594658, 90.58094913884928, 11.170494612939873, 5.698983483253807, 47.211902996022935, 115.46084675275547, 13.404588636184554, 39.83288726533014, 141.34557925412275, 7.004786512084867, 10.930196896558586, 6.534086436727376, 99.21006478927055, 240.73234082755596, 0.0, 18.4968929314948, 132.63100968407372, 163.41035842298228, 15.775694434812959, 83.5213045855802, 25.21337549929459, 99.93209870342443, 0.0, 6.744599356978141, 141.96832526513947, 505.57522115980134, 751.3124828552301, 703.5188860174, 332.8947451675315, 4.762492207791606, 20.931012747308042, 708.1629586476215, 220.1416422792131, 19.307405295324237, 9.67684911975991, 5.62025839986064, 17.7573046502267, 29.00072084520454, 22.703543360223154, 19.009428594085605, 5.361133516490334, 11.264782449270855, 9.587801815872485, 320.36969407276786, 68.66776419743057, 116.75779987477301, 24.386825742422047, 3.5497927750374765, 45.495685749285215, 36.41047165230803, 25.932271847842962, 741.2687526357563, 36.21774644799432, 123.63361566573177, 401.73462276893156, 11.837944957832356, 11.22091287953957, 583.4504178799386, 408.11913721595505, 42.303464425219715, 60.24798097430979, 54.257489194528496, 70.7783392284651, 3.166115832496508, 9.46727360984797, 112.63094555693554, 56.17367085420516, 37.61687045347271, 2.0142759290634165, 27.705776532735214, 23.341834202600392, 4.560482782002375, 8.307115535316061, 74.85531913556764, 13.048980238124232, 41.35015965284683, 60.13036754030143, 44.38211523639606, 32.50016724027745, 122.08722210455124, 0.0, 18.46969595958768, 56.86556398136554, 52.2367411103771, 32.05929418043182, 6.593831307728922, 69.65442755845888, 13.351793196288705, 12.641379766959245, 49.505632079987336, 27.426946991895417, 37.851622514340804, 64.72014887897865, 55.57323293560362, 47.396246550076505, 326.33230031569497, 10.881287296870786, 24.391790799016114, 138.55039057998894, 28.745516015567464, 1.9923737942392408, 62.80468026409967, 99.13126547944454, 0.9421305655762041, 1.9773894351800383, 36.128177977190504, 27.005257746484236, 34.13946315566555, 87.6681547057313]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6098180848172445, "mean_inference_ms": 5.368477144492239, "mean_action_processing_ms": 3.020803833054286, "mean_env_wait_ms": 1.1225930252563538, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00883793830871582, "StateBufferConnector_ms": 0.0047272443771362305, "ViewRequirementAgentConnector_ms": 0.17574667930603027}, "num_episodes": 18, "episode_return_max": 515.6864137941072, "episode_return_min": -0.3840946182553957, "episode_return_mean": 282.75973148089594, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 688000, "num_agent_steps_trained": 688000, "num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 76.72796333532624, "num_env_steps_trained_throughput_per_sec": 76.72796333532624, "timesteps_total": 172000, "num_env_steps_sampled_lifetime": 172000, "num_agent_steps_sampled_lifetime": 688000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 688000, "timers": {"training_iteration_time_ms": 57349.785, "restore_workers_time_ms": 0.015, "training_step_time_ms": 57349.738, "sample_time_ms": 2199.761, "learn_time_ms": 55125.458, "learn_throughput": 72.562, "synch_weights_time_ms": 20.368}, "counters": {"num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_agent_steps_sampled": 688000, "num_agent_steps_trained": 688000}, "done": false, "training_iteration": 43, "trial_id": "cf3bb_00000", "date": "2024-08-20_09-20-13", "timestamp": 1724125813, "time_this_iter_s": 52.170660734176636, "time_total_s": 10077.43512058258, "pid": 25777, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39f77d040>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 10077.43512058258, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 44.13918918918919, "ram_util_percent": 82.8162162162162}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8722355885322762, "cur_kl_coeff": 0.011865234375000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.49952534269245846, "policy_loss": -0.003790869478508337, "vf_loss": 0.5031063202670012, "vf_explained_var": 0.07169638503165472, "kl": 0.017689735933469702, "entropy": 1.229448337340481, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 82215.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 35.290895459008595, "cur_kl_coeff": 0.0421875, "cur_lr": 0.00010000000000000003, "total_loss": 4.947260009674799, "policy_loss": -0.004392592026482499, "vf_loss": 4.951108901589005, "vf_explained_var": 0.8423248907876393, "kl": 0.012887795323996653, "entropy": 1.265697889416306, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 82215.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_agent_steps_sampled": 704000, "num_agent_steps_trained": 704000}, "env_runners": {"episode_reward_max": 515.6864137941072, "episode_reward_min": -0.3840946182553957, "episode_reward_mean": 281.1074672976593, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1047.3501986939646, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 948.3474761717088}, "policy_reward_mean": {"prey_policy": 30.59855810441878, "predator_policy": 109.95517554441096}, "custom_metrics": {}, "hist_stats": {"episode_reward": [195.69999999999987, 189.79999999999941, 515.6864137941072, 351.2, 384.1, 5.390981823397489, 360.90000000000003, 147.2925130219075, 297.58156365402647, 231.71778785374877, 26.800000000000114, 369.4, 211.59999999999943, 178.1732566663395, 466.0484564385302, 206.1999999999995, -0.3840946182553957, 185.83388347648298, 485.4467420086064, 328.53647997856245, 337.1561804875657, 329.19049843409795, 360.0, 292.29872711725693, 378.4, 368.0, 387.0, 245.06842685732397, 348.0, 180.16162807249265, 315.4, 188.1999999999994, 360.84752543231934, 210.8999999999993, 267.46724503174903, 260.51611292279404, 294.47098922914125, 299.1397946824925, 181.14429909922893, 309.6618671322002, 500.5208676319054, 465.4191709468536, 141.89999999999964, 253.30539299773343, 331.80000000000007, 380.2, 353.4, 363.9522653008734, 35.92018925158506, 180.19999999999973, 257.6625525850885, 330.87387974469493, 361.3, 179.39999999999998, 204.34726410015878, 377.3, 260.65283370393286, 335.47638788395705, 321.2, 389.1, 315.202730253858, 337.25836769899047, 385.65326008262775, 241.5999999999995, 339.6, 305.34236481291805, 304.4399905143455, 34.70000000000022, 327.90000000000003, 193.89999999999938, 180.9999999999994, 298.89999999999986, 231.5, 332.60682928724145, 229.64331496275003, 202.49999999999946, 204.91494553253153, 363.03782172174664, 312.1647637250053, 378.1, 190.0999999999994, 363.62261608323035, 390.0, 204.19999999999933, 33.400000000000205, 189.8999999999994, 270.5999999999999, 338.9426314106138, 369.2737167896155, 345.5936041982961, 367.1, 178.29999999999947, 329.80000000000007, 274.0999999999997, 347.3, 215.89999999999927, 347.9476942673015, 39.60000000000029, 360.3, 360.82399568196695], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [190.94100885917257, -457.2194647249718, 153.88155622971996, 13.581809499124569, -1047.3501986939646, 79.87686080173447, 142.88862900061125, 144.9210621391069, 160.10755003076554, 200.0, -566.7672573262239, -317.2333744213013, 198.00617786339214, 159.20118821964385, -739.2655437356947, -194.00881901625016, 130.58163033987762, 62.60805026037118, -40.31971372422578, 53.890170495479495, -285.7376950562197, 12.31837696341769, 166.53716833955264, 117.79078685015101, -123.44924249337423, 194.0173096711519, 45.92485100844489, -494.3677946346973, 158.7386309230398, -782.1530523639327, 191.1754021494096, -201.12321101108643, -417.3418777026127, -951.9514647131936, -526.5773329049935, 150.25976976383322, -907.0858350627689, 81.82804084003426, 114.93229702912406, 132.7796048232712, 113.51579358723177, 148.96215887490732, 150.984871127295, 118.81591608329876, 129.07702988614662, 171.7984961093325, 134.87441620097783, 55.02101194379142, 185.48936350014628, 171.7437339737833, 123.13757031555548, 170.65551041732462, 158.52804188561885, 195.75987992701232, 83.61442635630888, 32.05669825506854, 92.54826954951903, 153.7002866986918, 112.2851720322648, 14.965569560951618, 43.53915324724453, 142.99541136381544, 134.16711273466984, -127.14557925412356, 171.7325750295892, 171.17996699408664, 187.46591356327264, -82.31006478927151, -6.234930017977831, 32.96983422217093, 63.69929766583128, 45.68891264139427, -50.71035842298227, 165.99529479432826, 69.74765889199385, 120.65745570562382, 16.14429909922943, 65.06790129657557, 168.2180480608737, -7.269105550791181, -794.6412854108809, 38.2744490277547, -747.5944602380772, 176.6, 107.50734306417701, 8.699151980723306, -803.8441919763558, 128.84498404725468, 123.2925947046758, 179.52315088024008, 190.37974160013937, 166.44269534977332, 153.99927915479546, 147.69645663977687, 169.7322451810581, 169.8494580092394, 8.20752689016077, 6.86007809628064, -314.3196940727668, 105.48223580256938, 56.201228977382996, 60.31669799051046, 128.94340807233172, 152.8849931480405, 200.0, 98.95725649984901, -739.8687526357564, 141.78225355200567, 177.29262279949822, -498.3135971340017, 173.46205504216766, 180.77908712046042, -485.19489793588, -245.72182345608044, 125.1729234587373, 107.7520190256902, 64.75241376628205, 131.41175781072437, 193.8338841675035, 182.63272639015202, 87.95269274636819, 58.44542109634915, 148.44857663112623, 149.1786446853281, 142.6954371353841, 191.91021221190803, 186.03951721799763, 42.692884464683914, 73.74468086443221, 177.95101976187578, 86.10549564542859, 117.75634197434115, 123.30191109217412, 104.25579694549788, -16.09822381179014, -71.2889982927616, 163.53030404041232, 89.03443601863452, 122.7632588896229, -13.1592941804316, 157.80616869227106, -53.054427558458784, 174.6482068037113, 98.25862023304072, 39.794367920012796, 114.77305300810465, 51.16812079927425, 178.86693709464777, 86.61513840279902, 40.05869707427077, -316.8323003156928, 182.1187127031292, 164.4231547335161, -122.45039057998986, 168.00863530382574, 164.29129660811418, 75.58164093081811, 74.647177050643, 187.2578694344238, 187.92261056481996, 135.8718220228095, -8.905257746484105, 82.62315808585268, 159.19184013598084, 184.6270389924764, 190.4341328565937, 167.15480943966588, 9.53843395781323, -153.6547444803346, 17.54168100891846, 5.485871917573093, 114.23164405630018, -180.44967060128715, 147.1472002733161, 150.0440060372401, 151.3314673252592, 158.763079620692, 180.67555753608207, 129.63857690729236, 120.69559614229699, 165.17771420748534, 168.31799140075154, -0.6992307383829544, 78.55977031350476, 173.290338744216, 138.74001773409918, 79.90235213320864, 186.71770906792477, 168.29666938562107, 139.15676961371423, 15.58276509101879, 195.39477399008064, 121.08651899890533, 157.52279569857134, 20.000000000000014, 15.691104997313007, 153.55858613007382, 161.16139248736806, 177.7956142458416, 147.2712363886667], "policy_predator_policy_reward": [0.858991140827423, 461.1194647249722, 16.51844377028003, 5.818190500875396, 923.1781113503621, 559.9816403359755, 35.11137099938875, 28.278937860893098, 23.992449969234475, 0.0, 573.7655786125714, 315.62603495835447, 2.8438433484944254, 0.8487905684695894, 549.0354508736605, 531.5314249001905, 22.999933314148873, 81.3919497396288, 154.9548346247911, 63.192496457703925, 189.38229949482871, 110.83701859797486, 20.66283166044736, 64.40921314984898, 41.996735954411925, 99.03519686781061, 504.44743957325755, 122.16876071933417, 437.0401450209102, 652.4227328585132, 3.124597850590409, 213.02321101108575, 420.56177162584225, 948.3474761717088, 224.35077580152895, 337.80067081611446, 709.2907309886682, 601.413805242673, 41.066659441197956, 39.75791868496925, 49.563024722184636, 25.11520330324198, 0.9678907800136306, 58.4218204434905, 20.874729669273485, 38.249744335247414, 28.513340171448792, 73.88995880103886, 5.910636499853711, 15.256266026216714, 55.862429684444514, 18.344489582675376, 30.47195811438115, 2.240120072987665, 0.0, 129.39730224594658, 90.58094913884928, 11.170494612939873, 5.698983483253807, 47.211902996022935, 115.46084675275547, 13.404588636184554, 39.83288726533014, 141.34557925412275, 7.004786512084867, 10.930196896558586, 6.534086436727376, 99.21006478927055, 240.73234082755596, 0.0, 18.4968929314948, 132.63100968407372, 163.41035842298228, 15.775694434812959, 83.5213045855802, 25.21337549929459, 99.93209870342443, 0.0, 6.744599356978141, 141.96832526513947, 505.57522115980134, 751.3124828552301, 703.5188860174, 332.8947451675315, 4.762492207791606, 20.931012747308042, 708.1629586476215, 220.1416422792131, 19.307405295324237, 9.67684911975991, 5.62025839986064, 17.7573046502267, 29.00072084520454, 22.703543360223154, 19.009428594085605, 5.361133516490334, 11.264782449270855, 9.587801815872485, 320.36969407276786, 68.66776419743057, 116.75779987477301, 24.386825742422047, 3.5497927750374765, 45.495685749285215, 36.41047165230803, 25.932271847842962, 741.2687526357563, 36.21774644799432, 123.63361566573177, 401.73462276893156, 11.837944957832356, 11.22091287953957, 583.4504178799386, 408.11913721595505, 42.303464425219715, 60.24798097430979, 54.257489194528496, 70.7783392284651, 3.166115832496508, 9.46727360984797, 112.63094555693554, 56.17367085420516, 37.61687045347271, 2.0142759290634165, 27.705776532735214, 23.341834202600392, 4.560482782002375, 8.307115535316061, 74.85531913556764, 13.048980238124232, 41.35015965284683, 60.13036754030143, 44.38211523639606, 32.50016724027745, 122.08722210455124, 0.0, 18.46969595958768, 56.86556398136554, 52.2367411103771, 32.05929418043182, 6.593831307728922, 69.65442755845888, 13.351793196288705, 12.641379766959245, 49.505632079987336, 27.426946991895417, 37.851622514340804, 64.72014887897865, 55.57323293560362, 47.396246550076505, 326.33230031569497, 10.881287296870786, 24.391790799016114, 138.55039057998894, 28.745516015567464, 1.9923737942392408, 62.80468026409967, 99.13126547944454, 0.9421305655762041, 1.9773894351800383, 36.128177977190504, 27.005257746484236, 34.13946315566555, 87.6681547057313, 8.37296100752359, 6.565867143406312, 17.8451905603341, 9.661566042186736, 133.69666251642903, 35.81640095498638, 53.18348650986029, 16.998997516266403, 276.04967060128774, 27.852799726683905, 4.720179693832459, 32.846978354281994, 26.809580772915684, 3.0254988599257895, 82.74975869036236, 12.509672458344362, 12.92228579251467, 20.68200859924847, 19.799230738382967, 80.64022968649512, 0.0, 17.769643521684817, 5.639005545363659, 1.840933253502925, 5.317411684098246, 34.52914931656645, 4.017234908981175, 0.9052260099193697, 2.6625312400040153, 66.67584832982082, 0.0, 3.9088950026869567, 25.441413869926187, 20.13860751263193, 28.160645485715467, 7.596499561743215]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5931267842080101, "mean_inference_ms": 5.299238443903686, "mean_action_processing_ms": 2.9630265461257586, "mean_env_wait_ms": 1.1042077404484414, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010046958923339844, "StateBufferConnector_ms": 0.004189848899841309, "ViewRequirementAgentConnector_ms": 0.15250253677368164}, "num_episodes": 18, "episode_return_max": 515.6864137941072, "episode_return_min": -0.3840946182553957, "episode_return_mean": 281.1074672976593, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 704000, "num_agent_steps_trained": 704000, "num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 76.14213375359752, "num_env_steps_trained_throughput_per_sec": 76.14213375359752, "timesteps_total": 176000, "num_env_steps_sampled_lifetime": 176000, "num_agent_steps_sampled_lifetime": 704000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 704000, "timers": {"training_iteration_time_ms": 56583.924, "restore_workers_time_ms": 0.014, "training_step_time_ms": 56583.868, "sample_time_ms": 2046.81, "learn_time_ms": 54512.246, "learn_throughput": 73.378, "synch_weights_time_ms": 20.772}, "counters": {"num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_agent_steps_sampled": 704000, "num_agent_steps_trained": 704000}, "done": false, "training_iteration": 44, "trial_id": "cf3bb_00000", "date": "2024-08-20_09-21-06", "timestamp": 1724125866, "time_this_iter_s": 52.58619284629822, "time_total_s": 10130.021313428879, "pid": 25777, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39fe3d3a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 10130.021313428879, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 44.66533333333333, "ram_util_percent": 82.50133333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.846453501193454, "cur_kl_coeff": 0.011865234375000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.9213833017481698, "policy_loss": -0.0019602883121777304, "vf_loss": 0.9231235453829406, "vf_explained_var": 0.006605562047352866, "kl": 0.01854519796694081, "entropy": 1.3374510143799756, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 84105.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 32.65516561342295, "cur_kl_coeff": 0.0421875, "cur_lr": 0.00010000000000000003, "total_loss": 6.116039114906674, "policy_loss": -0.004322923545706549, "vf_loss": 6.119816754356263, "vf_explained_var": 0.5650326450035055, "kl": 0.012925320973193592, "entropy": 1.2380421800588173, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 84105.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000}, "env_runners": {"episode_reward_max": 500.5208676319054, "episode_reward_min": 33.400000000000205, "episode_reward_mean": 293.8237304030942, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -803.8441919763558, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 751.3124828552301}, "policy_reward_mean": {"prey_policy": 80.40620378616205, "predator_policy": 66.5056614153851}, "custom_metrics": {}, "hist_stats": {"episode_reward": [360.0, 292.29872711725693, 378.4, 368.0, 387.0, 245.06842685732397, 348.0, 180.16162807249265, 315.4, 188.1999999999994, 360.84752543231934, 210.8999999999993, 267.46724503174903, 260.51611292279404, 294.47098922914125, 299.1397946824925, 181.14429909922893, 309.6618671322002, 500.5208676319054, 465.4191709468536, 141.89999999999964, 253.30539299773343, 331.80000000000007, 380.2, 353.4, 363.9522653008734, 35.92018925158506, 180.19999999999973, 257.6625525850885, 330.87387974469493, 361.3, 179.39999999999998, 204.34726410015878, 377.3, 260.65283370393286, 335.47638788395705, 321.2, 389.1, 315.202730253858, 337.25836769899047, 385.65326008262775, 241.5999999999995, 339.6, 305.34236481291805, 304.4399905143455, 34.70000000000022, 327.90000000000003, 193.89999999999938, 180.9999999999994, 298.89999999999986, 231.5, 332.60682928724145, 229.64331496275003, 202.49999999999946, 204.91494553253153, 363.03782172174664, 312.1647637250053, 378.1, 190.0999999999994, 363.62261608323035, 390.0, 204.19999999999933, 33.400000000000205, 189.8999999999994, 270.5999999999999, 338.9426314106138, 369.2737167896155, 345.5936041982961, 367.1, 178.29999999999947, 329.80000000000007, 274.0999999999997, 347.3, 215.89999999999927, 347.9476942673015, 39.60000000000029, 360.3, 360.82399568196695, 384.99441356670604, 374.20000000000005, 317.69999999999993, 362.0, 387.8, 377.28857980371583, 347.3159889937996, 207.9999999999993, 212.3999999999993, 199.49999999999935, 392.1, 365.25221637842714, 212.5999999999993, 363.6, 346.4, 127.79999999999997, 361.1, 312.5281625949508, 385.0, 367.0, 370.81761222501206, 299.5999999999998], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [129.07702988614662, 171.7984961093325, 134.87441620097783, 55.02101194379142, 185.48936350014628, 171.7437339737833, 123.13757031555548, 170.65551041732462, 158.52804188561885, 195.75987992701232, 83.61442635630888, 32.05669825506854, 92.54826954951903, 153.7002866986918, 112.2851720322648, 14.965569560951618, 43.53915324724453, 142.99541136381544, 134.16711273466984, -127.14557925412356, 171.7325750295892, 171.17996699408664, 187.46591356327264, -82.31006478927151, -6.234930017977831, 32.96983422217093, 63.69929766583128, 45.68891264139427, -50.71035842298227, 165.99529479432826, 69.74765889199385, 120.65745570562382, 16.14429909922943, 65.06790129657557, 168.2180480608737, -7.269105550791181, -794.6412854108809, 38.2744490277547, -747.5944602380772, 176.6, 107.50734306417701, 8.699151980723306, -803.8441919763558, 128.84498404725468, 123.2925947046758, 179.52315088024008, 190.37974160013937, 166.44269534977332, 153.99927915479546, 147.69645663977687, 169.7322451810581, 169.8494580092394, 8.20752689016077, 6.86007809628064, -314.3196940727668, 105.48223580256938, 56.201228977382996, 60.31669799051046, 128.94340807233172, 152.8849931480405, 200.0, 98.95725649984901, -739.8687526357564, 141.78225355200567, 177.29262279949822, -498.3135971340017, 173.46205504216766, 180.77908712046042, -485.19489793588, -245.72182345608044, 125.1729234587373, 107.7520190256902, 64.75241376628205, 131.41175781072437, 193.8338841675035, 182.63272639015202, 87.95269274636819, 58.44542109634915, 148.44857663112623, 149.1786446853281, 142.6954371353841, 191.91021221190803, 186.03951721799763, 42.692884464683914, 73.74468086443221, 177.95101976187578, 86.10549564542859, 117.75634197434115, 123.30191109217412, 104.25579694549788, -16.09822381179014, -71.2889982927616, 163.53030404041232, 89.03443601863452, 122.7632588896229, -13.1592941804316, 157.80616869227106, -53.054427558458784, 174.6482068037113, 98.25862023304072, 39.794367920012796, 114.77305300810465, 51.16812079927425, 178.86693709464777, 86.61513840279902, 40.05869707427077, -316.8323003156928, 182.1187127031292, 164.4231547335161, -122.45039057998986, 168.00863530382574, 164.29129660811418, 75.58164093081811, 74.647177050643, 187.2578694344238, 187.92261056481996, 135.8718220228095, -8.905257746484105, 82.62315808585268, 159.19184013598084, 184.6270389924764, 190.4341328565937, 167.15480943966588, 9.53843395781323, -153.6547444803346, 17.54168100891846, 5.485871917573093, 114.23164405630018, -180.44967060128715, 147.1472002733161, 150.0440060372401, 151.3314673252592, 158.763079620692, 180.67555753608207, 129.63857690729236, 120.69559614229699, 165.17771420748534, 168.31799140075154, -0.6992307383829544, 78.55977031350476, 173.290338744216, 138.74001773409918, 79.90235213320864, 186.71770906792477, 168.29666938562107, 139.15676961371423, 15.58276509101879, 195.39477399008064, 121.08651899890533, 157.52279569857134, 20.000000000000014, 15.691104997313007, 153.55858613007382, 161.16139248736806, 177.7956142458416, 147.2712363886667, 133.09466705890645, 198.04218253707296, 199.1, 153.76197556389596, 102.72619119775746, 183.16911236307655, 175.86826192283533, 157.96291450158415, 195.4592790996369, 184.5685330288823, 124.2575709119439, 196.5120755330564, 97.22410406267977, 142.10243798512994, 176.21858619159104, 10.286301282798192, 190.44614714013608, 1.3929344814375042, 154.47242198080866, -13.72333980339914, 188.24607417881924, 197.03821948940123, 136.73823231852452, 130.21745795869057, 176.54769551710075, 18.58622920589665, 145.97750029439356, 147.98985744246073, 154.92889218850428, 154.43363628622217, -588.020854816805, 122.53339159102178, 187.6155459470471, 126.43420383181824, 71.36527982030549, 81.58363737366709, 191.89462225476996, 175.87509514190805, 200.0, 76.41315178171773, 171.33644591711746, 182.45808718636434, 191.95046559212386, 93.55870699540719], "policy_predator_policy_reward": [20.874729669273485, 38.249744335247414, 28.513340171448792, 73.88995880103886, 5.910636499853711, 15.256266026216714, 55.862429684444514, 18.344489582675376, 30.47195811438115, 2.240120072987665, 0.0, 129.39730224594658, 90.58094913884928, 11.170494612939873, 5.698983483253807, 47.211902996022935, 115.46084675275547, 13.404588636184554, 39.83288726533014, 141.34557925412275, 7.004786512084867, 10.930196896558586, 6.534086436727376, 99.21006478927055, 240.73234082755596, 0.0, 18.4968929314948, 132.63100968407372, 163.41035842298228, 15.775694434812959, 83.5213045855802, 25.21337549929459, 99.93209870342443, 0.0, 6.744599356978141, 141.96832526513947, 505.57522115980134, 751.3124828552301, 703.5188860174, 332.8947451675315, 4.762492207791606, 20.931012747308042, 708.1629586476215, 220.1416422792131, 19.307405295324237, 9.67684911975991, 5.62025839986064, 17.7573046502267, 29.00072084520454, 22.703543360223154, 19.009428594085605, 5.361133516490334, 11.264782449270855, 9.587801815872485, 320.36969407276786, 68.66776419743057, 116.75779987477301, 24.386825742422047, 3.5497927750374765, 45.495685749285215, 36.41047165230803, 25.932271847842962, 741.2687526357563, 36.21774644799432, 123.63361566573177, 401.73462276893156, 11.837944957832356, 11.22091287953957, 583.4504178799386, 408.11913721595505, 42.303464425219715, 60.24798097430979, 54.257489194528496, 70.7783392284651, 3.166115832496508, 9.46727360984797, 112.63094555693554, 56.17367085420516, 37.61687045347271, 2.0142759290634165, 27.705776532735214, 23.341834202600392, 4.560482782002375, 8.307115535316061, 74.85531913556764, 13.048980238124232, 41.35015965284683, 60.13036754030143, 44.38211523639606, 32.50016724027745, 122.08722210455124, 0.0, 18.46969595958768, 56.86556398136554, 52.2367411103771, 32.05929418043182, 6.593831307728922, 69.65442755845888, 13.351793196288705, 12.641379766959245, 49.505632079987336, 27.426946991895417, 37.851622514340804, 64.72014887897865, 55.57323293560362, 47.396246550076505, 326.33230031569497, 10.881287296870786, 24.391790799016114, 138.55039057998894, 28.745516015567464, 1.9923737942392408, 62.80468026409967, 99.13126547944454, 0.9421305655762041, 1.9773894351800383, 36.128177977190504, 27.005257746484236, 34.13946315566555, 87.6681547057313, 8.37296100752359, 6.565867143406312, 17.8451905603341, 9.661566042186736, 133.69666251642903, 35.81640095498638, 53.18348650986029, 16.998997516266403, 276.04967060128774, 27.852799726683905, 4.720179693832459, 32.846978354281994, 26.809580772915684, 3.0254988599257895, 82.74975869036236, 12.509672458344362, 12.92228579251467, 20.68200859924847, 19.799230738382967, 80.64022968649512, 0.0, 17.769643521684817, 5.639005545363659, 1.840933253502925, 5.317411684098246, 34.52914931656645, 4.017234908981175, 0.9052260099193697, 2.6625312400040153, 66.67584832982082, 0.0, 3.9088950026869567, 25.441413869926187, 20.13860751263193, 28.160645485715467, 7.596499561743215, 35.7711491392146, 18.086414831512062, 2.9998056256949317, 18.338218810409128, 22.97380880224264, 8.830887636923448, 11.53173807716467, 16.637085498415853, 2.540720900363108, 5.231466971117699, 55.74242908805609, 0.7765042706594621, 28.52854407008721, 79.46090287590263, 12.781413808408958, 8.713698717201787, 2.9538528598639187, 17.60706551856247, 26.52757801919133, 32.22333980339936, 0.887073093602475, 5.928633238177049, 46.7335036682673, 51.56302243294476, 13.652304482899265, 3.813770794103314, 32.22249970560643, 37.410142557539274, 12.671107811495704, 24.366363713777826, 588.320854816805, 4.96660840897822, 5.684454052952874, 41.36579616818177, 31.21666350228481, 128.36258189869338, 15.577989648813805, 1.6522929545081824, 0.0, 90.58684821828227, 17.023079121530294, 0.0, 4.049534407876139, 10.041293004592783]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5774314550518438, "mean_inference_ms": 5.205581671338973, "mean_action_processing_ms": 2.8985781208009422, "mean_env_wait_ms": 1.0865130684315862, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00972902774810791, "StateBufferConnector_ms": 0.0041544437408447266, "ViewRequirementAgentConnector_ms": 0.13686513900756836}, "num_episodes": 22, "episode_return_max": 500.5208676319054, "episode_return_min": 33.400000000000205, "episode_return_mean": 293.8237304030942, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 83.31395639631003, "num_env_steps_trained_throughput_per_sec": 83.31395639631003, "timesteps_total": 180000, "num_env_steps_sampled_lifetime": 180000, "num_agent_steps_sampled_lifetime": 720000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 720000, "timers": {"training_iteration_time_ms": 55182.545, "restore_workers_time_ms": 0.014, "training_step_time_ms": 55182.488, "sample_time_ms": 1979.224, "learn_time_ms": 53178.076, "learn_throughput": 75.219, "synch_weights_time_ms": 21.028}, "counters": {"num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000}, "done": false, "training_iteration": 45, "trial_id": "cf3bb_00000", "date": "2024-08-20_09-21-54", "timestamp": 1724125914, "time_this_iter_s": 48.05665898323059, "time_total_s": 10178.07797241211, "pid": 25777, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39ffb89d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 10178.07797241211, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 37.633823529411764, "ram_util_percent": 82.5191176470588}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6295602213019732, "cur_kl_coeff": 0.011865234375000004, "cur_lr": 0.00010000000000000003, "total_loss": 1.2768153486743805, "policy_loss": -0.003826743211207921, "vf_loss": 1.2805117781830844, "vf_explained_var": 0.01759232941758696, "kl": 0.010982633636273612, "entropy": 1.4001995636041833, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 85995.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 30.408687036882633, "cur_kl_coeff": 0.0421875, "cur_lr": 0.00010000000000000003, "total_loss": 3.837827195061578, "policy_loss": -0.0037067745705061253, "vf_loss": 3.8409645214282646, "vf_explained_var": 0.8273251290359195, "kl": 0.013497739711649519, "entropy": 1.2537961329732623, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 85995.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_agent_steps_sampled": 736000, "num_agent_steps_trained": 736000}, "env_runners": {"episode_reward_max": 396.0, "episode_reward_min": 33.400000000000205, "episode_reward_mean": 273.079593714469, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -739.8687526357564, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 741.2687526357563}, "policy_reward_mean": {"prey_policy": 88.01222175640586, "predator_policy": 48.52757510082872}, "custom_metrics": {}, "hist_stats": {"episode_reward": [380.2, 353.4, 363.9522653008734, 35.92018925158506, 180.19999999999973, 257.6625525850885, 330.87387974469493, 361.3, 179.39999999999998, 204.34726410015878, 377.3, 260.65283370393286, 335.47638788395705, 321.2, 389.1, 315.202730253858, 337.25836769899047, 385.65326008262775, 241.5999999999995, 339.6, 305.34236481291805, 304.4399905143455, 34.70000000000022, 327.90000000000003, 193.89999999999938, 180.9999999999994, 298.89999999999986, 231.5, 332.60682928724145, 229.64331496275003, 202.49999999999946, 204.91494553253153, 363.03782172174664, 312.1647637250053, 378.1, 190.0999999999994, 363.62261608323035, 390.0, 204.19999999999933, 33.400000000000205, 189.8999999999994, 270.5999999999999, 338.9426314106138, 369.2737167896155, 345.5936041982961, 367.1, 178.29999999999947, 329.80000000000007, 274.0999999999997, 347.3, 215.89999999999927, 347.9476942673015, 39.60000000000029, 360.3, 360.82399568196695, 384.99441356670604, 374.20000000000005, 317.69999999999993, 362.0, 387.8, 377.28857980371583, 347.3159889937996, 207.9999999999993, 212.3999999999993, 199.49999999999935, 392.1, 365.25221637842714, 212.5999999999993, 363.6, 346.4, 127.79999999999997, 361.1, 312.5281625949508, 385.0, 367.0, 370.81761222501206, 299.5999999999998, 39.60000000000029, 207.19999999999933, 217.62305872345337, 37.10000000000026, 204.99999999999935, 201.99999999999935, 208.38405609608216, 153.49999999999957, 322.55215220198363, 343.06398484083877, 190.19999999999942, 46.300000000000246, 379.3, 185.49999999999946, 187.19999999999942, 186.49999999999943, 37.80000000000027, 396.0, 325.9441100389306, 344.030466028496, 195.0999999999994, 314.3105503611887, 140.99999999999963], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [190.37974160013937, 166.44269534977332, 153.99927915479546, 147.69645663977687, 169.7322451810581, 169.8494580092394, 8.20752689016077, 6.86007809628064, -314.3196940727668, 105.48223580256938, 56.201228977382996, 60.31669799051046, 128.94340807233172, 152.8849931480405, 200.0, 98.95725649984901, -739.8687526357564, 141.78225355200567, 177.29262279949822, -498.3135971340017, 173.46205504216766, 180.77908712046042, -485.19489793588, -245.72182345608044, 125.1729234587373, 107.7520190256902, 64.75241376628205, 131.41175781072437, 193.8338841675035, 182.63272639015202, 87.95269274636819, 58.44542109634915, 148.44857663112623, 149.1786446853281, 142.6954371353841, 191.91021221190803, 186.03951721799763, 42.692884464683914, 73.74468086443221, 177.95101976187578, 86.10549564542859, 117.75634197434115, 123.30191109217412, 104.25579694549788, -16.09822381179014, -71.2889982927616, 163.53030404041232, 89.03443601863452, 122.7632588896229, -13.1592941804316, 157.80616869227106, -53.054427558458784, 174.6482068037113, 98.25862023304072, 39.794367920012796, 114.77305300810465, 51.16812079927425, 178.86693709464777, 86.61513840279902, 40.05869707427077, -316.8323003156928, 182.1187127031292, 164.4231547335161, -122.45039057998986, 168.00863530382574, 164.29129660811418, 75.58164093081811, 74.647177050643, 187.2578694344238, 187.92261056481996, 135.8718220228095, -8.905257746484105, 82.62315808585268, 159.19184013598084, 184.6270389924764, 190.4341328565937, 167.15480943966588, 9.53843395781323, -153.6547444803346, 17.54168100891846, 5.485871917573093, 114.23164405630018, -180.44967060128715, 147.1472002733161, 150.0440060372401, 151.3314673252592, 158.763079620692, 180.67555753608207, 129.63857690729236, 120.69559614229699, 165.17771420748534, 168.31799140075154, -0.6992307383829544, 78.55977031350476, 173.290338744216, 138.74001773409918, 79.90235213320864, 186.71770906792477, 168.29666938562107, 139.15676961371423, 15.58276509101879, 195.39477399008064, 121.08651899890533, 157.52279569857134, 20.000000000000014, 15.691104997313007, 153.55858613007382, 161.16139248736806, 177.7956142458416, 147.2712363886667, 133.09466705890645, 198.04218253707296, 199.1, 153.76197556389596, 102.72619119775746, 183.16911236307655, 175.86826192283533, 157.96291450158415, 195.4592790996369, 184.5685330288823, 124.2575709119439, 196.5120755330564, 97.22410406267977, 142.10243798512994, 176.21858619159104, 10.286301282798192, 190.44614714013608, 1.3929344814375042, 154.47242198080866, -13.72333980339914, 188.24607417881924, 197.03821948940123, 136.73823231852452, 130.21745795869057, 176.54769551710075, 18.58622920589665, 145.97750029439356, 147.98985744246073, 154.92889218850428, 154.43363628622217, -588.020854816805, 122.53339159102178, 187.6155459470471, 126.43420383181824, 71.36527982030549, 81.58363737366709, 191.89462225476996, 175.87509514190805, 200.0, 76.41315178171773, 171.33644591711746, 182.45808718636434, 191.95046559212386, 93.55870699540719, 14.046504446348916, 20.000000000000014, -15.652937808487081, 186.0710395369475, -1.2810370053589875, 100.00758336102423, -8.64418008617751, 15.871364433699137, 1.3108384051550608, 164.29895147365391, 20.000000000000014, 114.05781238109775, 16.77214745705417, 133.79667941014608, 10.15847182152522, 42.46687977086842, 118.00379628363277, 51.6309163227028, 154.74302115063284, 145.6883168425936, -1.1653956225007174, 126.72645883761493, -2.253229728249063, 3.1692909832142035, 193.32668998134113, 154.664451150585, 124.51085971093949, -18.258026795166018, 114.05395808604575, 5.156141179186291, 15.524817950305192, 139.8395075040559, -8.70331747041247, 9.913693852774866, 189.87344126128968, 200.0, 113.75463946095797, 86.60377996417199, 100.92042799615825, 41.232142167521914, 170.55530226556948, -5.761477277461779, 109.99662032962061, 114.34027072040516, 5.558079285034188, -18.205689973737293], "policy_predator_policy_reward": [5.62025839986064, 17.7573046502267, 29.00072084520454, 22.703543360223154, 19.009428594085605, 5.361133516490334, 11.264782449270855, 9.587801815872485, 320.36969407276786, 68.66776419743057, 116.75779987477301, 24.386825742422047, 3.5497927750374765, 45.495685749285215, 36.41047165230803, 25.932271847842962, 741.2687526357563, 36.21774644799432, 123.63361566573177, 401.73462276893156, 11.837944957832356, 11.22091287953957, 583.4504178799386, 408.11913721595505, 42.303464425219715, 60.24798097430979, 54.257489194528496, 70.7783392284651, 3.166115832496508, 9.46727360984797, 112.63094555693554, 56.17367085420516, 37.61687045347271, 2.0142759290634165, 27.705776532735214, 23.341834202600392, 4.560482782002375, 8.307115535316061, 74.85531913556764, 13.048980238124232, 41.35015965284683, 60.13036754030143, 44.38211523639606, 32.50016724027745, 122.08722210455124, 0.0, 18.46969595958768, 56.86556398136554, 52.2367411103771, 32.05929418043182, 6.593831307728922, 69.65442755845888, 13.351793196288705, 12.641379766959245, 49.505632079987336, 27.426946991895417, 37.851622514340804, 64.72014887897865, 55.57323293560362, 47.396246550076505, 326.33230031569497, 10.881287296870786, 24.391790799016114, 138.55039057998894, 28.745516015567464, 1.9923737942392408, 62.80468026409967, 99.13126547944454, 0.9421305655762041, 1.9773894351800383, 36.128177977190504, 27.005257746484236, 34.13946315566555, 87.6681547057313, 8.37296100752359, 6.565867143406312, 17.8451905603341, 9.661566042186736, 133.69666251642903, 35.81640095498638, 53.18348650986029, 16.998997516266403, 276.04967060128774, 27.852799726683905, 4.720179693832459, 32.846978354281994, 26.809580772915684, 3.0254988599257895, 82.74975869036236, 12.509672458344362, 12.92228579251467, 20.68200859924847, 19.799230738382967, 80.64022968649512, 0.0, 17.769643521684817, 5.639005545363659, 1.840933253502925, 5.317411684098246, 34.52914931656645, 4.017234908981175, 0.9052260099193697, 2.6625312400040153, 66.67584832982082, 0.0, 3.9088950026869567, 25.441413869926187, 20.13860751263193, 28.160645485715467, 7.596499561743215, 35.7711491392146, 18.086414831512062, 2.9998056256949317, 18.338218810409128, 22.97380880224264, 8.830887636923448, 11.53173807716467, 16.637085498415853, 2.540720900363108, 5.231466971117699, 55.74242908805609, 0.7765042706594621, 28.52854407008721, 79.46090287590263, 12.781413808408958, 8.713698717201787, 2.9538528598639187, 17.60706551856247, 26.52757801919133, 32.22333980339936, 0.887073093602475, 5.928633238177049, 46.7335036682673, 51.56302243294476, 13.652304482899265, 3.813770794103314, 32.22249970560643, 37.410142557539274, 12.671107811495704, 24.366363713777826, 588.320854816805, 4.96660840897822, 5.684454052952874, 41.36579616818177, 31.21666350228481, 128.36258189869338, 15.577989648813805, 1.6522929545081824, 0.0, 90.58684821828227, 17.023079121530294, 0.0, 4.049534407876139, 10.041293004592783, 5.553495553651048, 0.0, 33.952937808487334, 2.8289604630525114, 74.37254901048702, 44.523963357301845, 26.144180086177546, 3.7286355663008255, 17.689161594844922, 21.701048526346092, 0.0, 67.94218761890225, 16.959702496393543, 40.85552673248902, 21.057339752095135, 79.81730865551097, 13.413057986109232, 139.5043816095388, 33.91395319061053, 8.718693657001797, 20.065395622500734, 44.57354116238509, 38.72915071753208, 6.654788027502873, 1.9733100186588575, 29.33554884941501, 1.8869392035268442, 77.36022788069997, 20.605553975210686, 47.38434675955724, 4.0751820496947735, 27.060492495944118, 27.203317470412603, 9.386306147225099, 6.126558738710319, 0.0, 25.152464961271644, 100.433225652529, 74.19107940617364, 127.68681645864221, 7.337278224259374, 22.96889678763291, 9.085033558069215, 80.88862575309369, 13.441920714965779, 140.20568997373732]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5517271871705396, "mean_inference_ms": 5.12809774283553, "mean_action_processing_ms": 2.82737798323464, "mean_env_wait_ms": 1.0600727299472155, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006256461143493652, "StateBufferConnector_ms": 0.003979325294494629, "ViewRequirementAgentConnector_ms": 0.12474524974822998}, "num_episodes": 23, "episode_return_max": 396.0, "episode_return_min": 33.400000000000205, "episode_return_mean": 273.079593714469, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 736000, "num_agent_steps_trained": 736000, "num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 81.5339122424142, "num_env_steps_trained_throughput_per_sec": 81.5339122424142, "timesteps_total": 184000, "num_env_steps_sampled_lifetime": 184000, "num_agent_steps_sampled_lifetime": 736000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 736000, "timers": {"training_iteration_time_ms": 54194.713, "restore_workers_time_ms": 0.014, "training_step_time_ms": 54194.657, "sample_time_ms": 1809.929, "learn_time_ms": 52361.824, "learn_throughput": 76.392, "synch_weights_time_ms": 18.788}, "counters": {"num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_agent_steps_sampled": 736000, "num_agent_steps_trained": 736000}, "done": false, "training_iteration": 46, "trial_id": "cf3bb_00000", "date": "2024-08-20_09-22-43", "timestamp": 1724125963, "time_this_iter_s": 49.07292103767395, "time_total_s": 10227.150893449783, "pid": 25777, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39f821d30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 10227.150893449783, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 40.730000000000004, "ram_util_percent": 81.16000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.713776794970824, "cur_kl_coeff": 0.011865234375000004, "cur_lr": 0.00010000000000000003, "total_loss": 1.2369438448437937, "policy_loss": -0.006416756076314462, "vf_loss": 1.2431037712822515, "vf_explained_var": 0.020164056934376874, "kl": 0.021645626802048797, "entropy": 1.4337692639184376, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 87885.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 33.90934696922857, "cur_kl_coeff": 0.0421875, "cur_lr": 0.00010000000000000003, "total_loss": 4.651806065645167, "policy_loss": -0.0035172965729894936, "vf_loss": 4.654935350619927, "vf_explained_var": 0.7786485327614678, "kl": 0.009197223194091738, "entropy": 1.2235792375746228, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 87885.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_agent_steps_sampled": 752000, "num_agent_steps_trained": 752000}, "env_runners": {"episode_reward_max": 396.0, "episode_reward_min": 33.400000000000205, "episode_reward_mean": 263.1319490596351, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -588.020854816805, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 588.320854816805}, "policy_reward_mean": {"prey_policy": 94.7883807940058, "predator_policy": 36.77759373581184}, "custom_metrics": {}, "hist_stats": {"episode_reward": [241.5999999999995, 339.6, 305.34236481291805, 304.4399905143455, 34.70000000000022, 327.90000000000003, 193.89999999999938, 180.9999999999994, 298.89999999999986, 231.5, 332.60682928724145, 229.64331496275003, 202.49999999999946, 204.91494553253153, 363.03782172174664, 312.1647637250053, 378.1, 190.0999999999994, 363.62261608323035, 390.0, 204.19999999999933, 33.400000000000205, 189.8999999999994, 270.5999999999999, 338.9426314106138, 369.2737167896155, 345.5936041982961, 367.1, 178.29999999999947, 329.80000000000007, 274.0999999999997, 347.3, 215.89999999999927, 347.9476942673015, 39.60000000000029, 360.3, 360.82399568196695, 384.99441356670604, 374.20000000000005, 317.69999999999993, 362.0, 387.8, 377.28857980371583, 347.3159889937996, 207.9999999999993, 212.3999999999993, 199.49999999999935, 392.1, 365.25221637842714, 212.5999999999993, 363.6, 346.4, 127.79999999999997, 361.1, 312.5281625949508, 385.0, 367.0, 370.81761222501206, 299.5999999999998, 39.60000000000029, 207.19999999999933, 217.62305872345337, 37.10000000000026, 204.99999999999935, 201.99999999999935, 208.38405609608216, 153.49999999999957, 322.55215220198363, 343.06398484083877, 190.19999999999942, 46.300000000000246, 379.3, 185.49999999999946, 187.19999999999942, 186.49999999999943, 37.80000000000027, 396.0, 325.9441100389306, 344.030466028496, 195.0999999999994, 314.3105503611887, 140.99999999999963, 216.59999999999928, 345.2, 188.69999999999942, 199.7850525188353, 157.79999999999956, 35.10000000000023, 186.6999999999994, 202.89999999999932, 368.7679677078053, 353.77321694031986, 269.3580009521229, 166.8999999999995, 362.5463556711598, 159.8999999999996, 375.10467133213643, 209.9999999999993, 368.6, 206.59999999999934], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [186.03951721799763, 42.692884464683914, 73.74468086443221, 177.95101976187578, 86.10549564542859, 117.75634197434115, 123.30191109217412, 104.25579694549788, -16.09822381179014, -71.2889982927616, 163.53030404041232, 89.03443601863452, 122.7632588896229, -13.1592941804316, 157.80616869227106, -53.054427558458784, 174.6482068037113, 98.25862023304072, 39.794367920012796, 114.77305300810465, 51.16812079927425, 178.86693709464777, 86.61513840279902, 40.05869707427077, -316.8323003156928, 182.1187127031292, 164.4231547335161, -122.45039057998986, 168.00863530382574, 164.29129660811418, 75.58164093081811, 74.647177050643, 187.2578694344238, 187.92261056481996, 135.8718220228095, -8.905257746484105, 82.62315808585268, 159.19184013598084, 184.6270389924764, 190.4341328565937, 167.15480943966588, 9.53843395781323, -153.6547444803346, 17.54168100891846, 5.485871917573093, 114.23164405630018, -180.44967060128715, 147.1472002733161, 150.0440060372401, 151.3314673252592, 158.763079620692, 180.67555753608207, 129.63857690729236, 120.69559614229699, 165.17771420748534, 168.31799140075154, -0.6992307383829544, 78.55977031350476, 173.290338744216, 138.74001773409918, 79.90235213320864, 186.71770906792477, 168.29666938562107, 139.15676961371423, 15.58276509101879, 195.39477399008064, 121.08651899890533, 157.52279569857134, 20.000000000000014, 15.691104997313007, 153.55858613007382, 161.16139248736806, 177.7956142458416, 147.2712363886667, 133.09466705890645, 198.04218253707296, 199.1, 153.76197556389596, 102.72619119775746, 183.16911236307655, 175.86826192283533, 157.96291450158415, 195.4592790996369, 184.5685330288823, 124.2575709119439, 196.5120755330564, 97.22410406267977, 142.10243798512994, 176.21858619159104, 10.286301282798192, 190.44614714013608, 1.3929344814375042, 154.47242198080866, -13.72333980339914, 188.24607417881924, 197.03821948940123, 136.73823231852452, 130.21745795869057, 176.54769551710075, 18.58622920589665, 145.97750029439356, 147.98985744246073, 154.92889218850428, 154.43363628622217, -588.020854816805, 122.53339159102178, 187.6155459470471, 126.43420383181824, 71.36527982030549, 81.58363737366709, 191.89462225476996, 175.87509514190805, 200.0, 76.41315178171773, 171.33644591711746, 182.45808718636434, 191.95046559212386, 93.55870699540719, 14.046504446348916, 20.000000000000014, -15.652937808487081, 186.0710395369475, -1.2810370053589875, 100.00758336102423, -8.64418008617751, 15.871364433699137, 1.3108384051550608, 164.29895147365391, 20.000000000000014, 114.05781238109775, 16.77214745705417, 133.79667941014608, 10.15847182152522, 42.46687977086842, 118.00379628363277, 51.6309163227028, 154.74302115063284, 145.6883168425936, -1.1653956225007174, 126.72645883761493, -2.253229728249063, 3.1692909832142035, 193.32668998134113, 154.664451150585, 124.51085971093949, -18.258026795166018, 114.05395808604575, 5.156141179186291, 15.524817950305192, 139.8395075040559, -8.70331747041247, 9.913693852774866, 189.87344126128968, 200.0, 113.75463946095797, 86.60377996417199, 100.92042799615825, 41.232142167521914, 170.55530226556948, -5.761477277461779, 109.99662032962061, 114.34027072040516, 5.558079285034188, -18.205689973737293, 5.709513592384528, 195.49521813915493, 140.26903947488117, 178.7320635931324, -11.699252819368024, 121.57679586856659, 152.29314061769088, 15.593662404346697, 27.091210362305944, 17.80301890764355, 20.000000000000014, -54.860991534229115, -99.53647098098824, 128.9511036748611, 177.59885927143586, -54.3008370782427, 174.81106998616121, 114.6817219171283, 157.7329330587608, 138.3459721422886, 44.73668513013003, 98.03461454935649, 19.07462772754554, 40.09659001293625, 144.38408536433474, 167.55874328482187, -3.4035846999639974, 52.754180114410886, 133.62034929753327, 187.9981871833428, 176.7172338220306, 20.000000000000014, 199.1, 148.3379336307321, -2.1613334670236424, 172.1329887889912], "policy_predator_policy_reward": [4.560482782002375, 8.307115535316061, 74.85531913556764, 13.048980238124232, 41.35015965284683, 60.13036754030143, 44.38211523639606, 32.50016724027745, 122.08722210455124, 0.0, 18.46969595958768, 56.86556398136554, 52.2367411103771, 32.05929418043182, 6.593831307728922, 69.65442755845888, 13.351793196288705, 12.641379766959245, 49.505632079987336, 27.426946991895417, 37.851622514340804, 64.72014887897865, 55.57323293560362, 47.396246550076505, 326.33230031569497, 10.881287296870786, 24.391790799016114, 138.55039057998894, 28.745516015567464, 1.9923737942392408, 62.80468026409967, 99.13126547944454, 0.9421305655762041, 1.9773894351800383, 36.128177977190504, 27.005257746484236, 34.13946315566555, 87.6681547057313, 8.37296100752359, 6.565867143406312, 17.8451905603341, 9.661566042186736, 133.69666251642903, 35.81640095498638, 53.18348650986029, 16.998997516266403, 276.04967060128774, 27.852799726683905, 4.720179693832459, 32.846978354281994, 26.809580772915684, 3.0254988599257895, 82.74975869036236, 12.509672458344362, 12.92228579251467, 20.68200859924847, 19.799230738382967, 80.64022968649512, 0.0, 17.769643521684817, 5.639005545363659, 1.840933253502925, 5.317411684098246, 34.52914931656645, 4.017234908981175, 0.9052260099193697, 2.6625312400040153, 66.67584832982082, 0.0, 3.9088950026869567, 25.441413869926187, 20.13860751263193, 28.160645485715467, 7.596499561743215, 35.7711491392146, 18.086414831512062, 2.9998056256949317, 18.338218810409128, 22.97380880224264, 8.830887636923448, 11.53173807716467, 16.637085498415853, 2.540720900363108, 5.231466971117699, 55.74242908805609, 0.7765042706594621, 28.52854407008721, 79.46090287590263, 12.781413808408958, 8.713698717201787, 2.9538528598639187, 17.60706551856247, 26.52757801919133, 32.22333980339936, 0.887073093602475, 5.928633238177049, 46.7335036682673, 51.56302243294476, 13.652304482899265, 3.813770794103314, 32.22249970560643, 37.410142557539274, 12.671107811495704, 24.366363713777826, 588.320854816805, 4.96660840897822, 5.684454052952874, 41.36579616818177, 31.21666350228481, 128.36258189869338, 15.577989648813805, 1.6522929545081824, 0.0, 90.58684821828227, 17.023079121530294, 0.0, 4.049534407876139, 10.041293004592783, 5.553495553651048, 0.0, 33.952937808487334, 2.8289604630525114, 74.37254901048702, 44.523963357301845, 26.144180086177546, 3.7286355663008255, 17.689161594844922, 21.701048526346092, 0.0, 67.94218761890225, 16.959702496393543, 40.85552673248902, 21.057339752095135, 79.81730865551097, 13.413057986109232, 139.5043816095388, 33.91395319061053, 8.718693657001797, 20.065395622500734, 44.57354116238509, 38.72915071753208, 6.654788027502873, 1.9733100186588575, 29.33554884941501, 1.8869392035268442, 77.36022788069997, 20.605553975210686, 47.38434675955724, 4.0751820496947735, 27.060492495944118, 27.203317470412603, 9.386306147225099, 6.126558738710319, 0.0, 25.152464961271644, 100.433225652529, 74.19107940617364, 127.68681645864221, 7.337278224259374, 22.96889678763291, 9.085033558069215, 80.88862575309369, 13.441920714965779, 140.20568997373732, 12.89048640761544, 2.504781860845077, 21.630960525118837, 4.567936406867587, 45.011870544940784, 33.81058640586083, 16.878141460688692, 15.020108036109631, 6.053254854002045, 106.85251587604844, 0.0, 69.96099153422895, 113.23647098098746, 44.0488963251389, 7.401140728564156, 72.20083707824249, 28.612512621939494, 50.66266318257634, 3.0404144763284986, 54.65389726294193, 125.72444677865154, 0.8622544939848062, 102.5284585270786, 5.200323732439614, 45.15807676203363, 5.445450259969593, 65.35812717037012, 45.19127741518303, 2.688392730481138, 50.79774212077922, 13.282766177969377, 0.0, 0.0, 21.162066369267908, 20.761333467023665, 15.867011211008785]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5353893910165795, "mean_inference_ms": 5.0609946520742515, "mean_action_processing_ms": 2.776336614908024, "mean_env_wait_ms": 1.0432442337221257, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006648063659667969, "StateBufferConnector_ms": 0.003947138786315918, "ViewRequirementAgentConnector_ms": 0.1243281364440918}, "num_episodes": 18, "episode_return_max": 396.0, "episode_return_min": 33.400000000000205, "episode_return_mean": 263.1319490596351, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 752000, "num_agent_steps_trained": 752000, "num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 87.43882299321977, "num_env_steps_trained_throughput_per_sec": 87.43882299321977, "timesteps_total": 188000, "num_env_steps_sampled_lifetime": 188000, "num_agent_steps_sampled_lifetime": 752000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 752000, "timers": {"training_iteration_time_ms": 52943.993, "restore_workers_time_ms": 0.014, "training_step_time_ms": 52943.938, "sample_time_ms": 1719.287, "learn_time_ms": 51202.911, "learn_throughput": 78.121, "synch_weights_time_ms": 18.06}, "counters": {"num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_agent_steps_sampled": 752000, "num_agent_steps_trained": 752000}, "done": false, "training_iteration": 47, "trial_id": "cf3bb_00000", "date": "2024-08-20_09-23-29", "timestamp": 1724126009, "time_this_iter_s": 45.75128436088562, "time_total_s": 10272.902177810669, "pid": 25777, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39ffb83a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 10272.902177810669, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 27.287692307692307, "ram_util_percent": 71.96615384615384}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7714016314260859, "cur_kl_coeff": 0.01779785156249999, "cur_lr": 0.00010000000000000003, "total_loss": 2.413914666667817, "policy_loss": -0.005570137488320667, "vf_loss": 2.419190490245819, "vf_explained_var": 0.017994798901219848, "kl": 0.016536505384062008, "entropy": 1.4664402645100991, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 89775.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 29.78763164259769, "cur_kl_coeff": 0.0421875, "cur_lr": 0.00010000000000000003, "total_loss": 5.587340003725082, "policy_loss": -0.001583166389785234, "vf_loss": 5.588615740417803, "vf_explained_var": 0.4238734839139161, "kl": 0.007287481056834087, "entropy": 1.1932341412892418, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 89775.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 768000, "num_agent_steps_trained": 768000}, "env_runners": {"episode_reward_max": 396.0, "episode_reward_min": 33.400000000000205, "episode_reward_mean": 261.213303539307, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -588.020854816805, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 588.320854816805}, "policy_reward_mean": {"prey_policy": 90.66446431202829, "predator_policy": 39.94218745762531}, "custom_metrics": {}, "hist_stats": {"episode_reward": [363.62261608323035, 390.0, 204.19999999999933, 33.400000000000205, 189.8999999999994, 270.5999999999999, 338.9426314106138, 369.2737167896155, 345.5936041982961, 367.1, 178.29999999999947, 329.80000000000007, 274.0999999999997, 347.3, 215.89999999999927, 347.9476942673015, 39.60000000000029, 360.3, 360.82399568196695, 384.99441356670604, 374.20000000000005, 317.69999999999993, 362.0, 387.8, 377.28857980371583, 347.3159889937996, 207.9999999999993, 212.3999999999993, 199.49999999999935, 392.1, 365.25221637842714, 212.5999999999993, 363.6, 346.4, 127.79999999999997, 361.1, 312.5281625949508, 385.0, 367.0, 370.81761222501206, 299.5999999999998, 39.60000000000029, 207.19999999999933, 217.62305872345337, 37.10000000000026, 204.99999999999935, 201.99999999999935, 208.38405609608216, 153.49999999999957, 322.55215220198363, 343.06398484083877, 190.19999999999942, 46.300000000000246, 379.3, 185.49999999999946, 187.19999999999942, 186.49999999999943, 37.80000000000027, 396.0, 325.9441100389306, 344.030466028496, 195.0999999999994, 314.3105503611887, 140.99999999999963, 216.59999999999928, 345.2, 188.69999999999942, 199.7850525188353, 157.79999999999956, 35.10000000000023, 186.6999999999994, 202.89999999999932, 368.7679677078053, 353.77321694031986, 269.3580009521229, 166.8999999999995, 362.5463556711598, 159.8999999999996, 375.10467133213643, 209.9999999999993, 368.6, 206.59999999999934, 213.59999999999928, 218.46518505764348, 267.60979592765847, 207.88805733873252, 333.6, 283.2189870133233, 209.7999999999993, 261.32973036454473, 376.0, 208.49999999999932, 218.69999999999925, 222.3920930481724, 181.96168545402782, 189.8999999999994, 348.3, 135.89999999999972, 338.40000000000003, 264.51994431962635], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [82.62315808585268, 159.19184013598084, 184.6270389924764, 190.4341328565937, 167.15480943966588, 9.53843395781323, -153.6547444803346, 17.54168100891846, 5.485871917573093, 114.23164405630018, -180.44967060128715, 147.1472002733161, 150.0440060372401, 151.3314673252592, 158.763079620692, 180.67555753608207, 129.63857690729236, 120.69559614229699, 165.17771420748534, 168.31799140075154, -0.6992307383829544, 78.55977031350476, 173.290338744216, 138.74001773409918, 79.90235213320864, 186.71770906792477, 168.29666938562107, 139.15676961371423, 15.58276509101879, 195.39477399008064, 121.08651899890533, 157.52279569857134, 20.000000000000014, 15.691104997313007, 153.55858613007382, 161.16139248736806, 177.7956142458416, 147.2712363886667, 133.09466705890645, 198.04218253707296, 199.1, 153.76197556389596, 102.72619119775746, 183.16911236307655, 175.86826192283533, 157.96291450158415, 195.4592790996369, 184.5685330288823, 124.2575709119439, 196.5120755330564, 97.22410406267977, 142.10243798512994, 176.21858619159104, 10.286301282798192, 190.44614714013608, 1.3929344814375042, 154.47242198080866, -13.72333980339914, 188.24607417881924, 197.03821948940123, 136.73823231852452, 130.21745795869057, 176.54769551710075, 18.58622920589665, 145.97750029439356, 147.98985744246073, 154.92889218850428, 154.43363628622217, -588.020854816805, 122.53339159102178, 187.6155459470471, 126.43420383181824, 71.36527982030549, 81.58363737366709, 191.89462225476996, 175.87509514190805, 200.0, 76.41315178171773, 171.33644591711746, 182.45808718636434, 191.95046559212386, 93.55870699540719, 14.046504446348916, 20.000000000000014, -15.652937808487081, 186.0710395369475, -1.2810370053589875, 100.00758336102423, -8.64418008617751, 15.871364433699137, 1.3108384051550608, 164.29895147365391, 20.000000000000014, 114.05781238109775, 16.77214745705417, 133.79667941014608, 10.15847182152522, 42.46687977086842, 118.00379628363277, 51.6309163227028, 154.74302115063284, 145.6883168425936, -1.1653956225007174, 126.72645883761493, -2.253229728249063, 3.1692909832142035, 193.32668998134113, 154.664451150585, 124.51085971093949, -18.258026795166018, 114.05395808604575, 5.156141179186291, 15.524817950305192, 139.8395075040559, -8.70331747041247, 9.913693852774866, 189.87344126128968, 200.0, 113.75463946095797, 86.60377996417199, 100.92042799615825, 41.232142167521914, 170.55530226556948, -5.761477277461779, 109.99662032962061, 114.34027072040516, 5.558079285034188, -18.205689973737293, 5.709513592384528, 195.49521813915493, 140.26903947488117, 178.7320635931324, -11.699252819368024, 121.57679586856659, 152.29314061769088, 15.593662404346697, 27.091210362305944, 17.80301890764355, 20.000000000000014, -54.860991534229115, -99.53647098098824, 128.9511036748611, 177.59885927143586, -54.3008370782427, 174.81106998616121, 114.6817219171283, 157.7329330587608, 138.3459721422886, 44.73668513013003, 98.03461454935649, 19.07462772754554, 40.09659001293625, 144.38408536433474, 167.55874328482187, -3.4035846999639974, 52.754180114410886, 133.62034929753327, 187.9981871833428, 176.7172338220306, 20.000000000000014, 199.1, 148.3379336307321, -2.1613334670236424, 172.1329887889912, 16.370970993411166, 187.61476485924243, -34.636108409435224, 32.84688523002663, 76.40666683689406, -140.05393197680814, 183.8571229400327, -16.828880778665926, 82.397075966136, 156.71452603005477, 92.90574308532752, -40.23551158683961, 2.9986980912193535, 156.6993702447867, -30.93567699154613, 79.14571108794149, 162.346294395445, 178.74310564450948, -13.02874602073436, 159.99137292755125, -6.5715603938269584, 200.0, -29.877613244686188, 27.94947429129212, -192.7233912917915, 67.30933734462042, 137.833692711609, -4.497177362768259, 136.64138150871605, 132.04117723956594, 7.0780702961058175, 49.15630654375583, 146.48112419466597, 118.06662079797896, -67.98134707554473, 128.49013928597952], "policy_predator_policy_reward": [34.13946315566555, 87.6681547057313, 8.37296100752359, 6.565867143406312, 17.8451905603341, 9.661566042186736, 133.69666251642903, 35.81640095498638, 53.18348650986029, 16.998997516266403, 276.04967060128774, 27.852799726683905, 4.720179693832459, 32.846978354281994, 26.809580772915684, 3.0254988599257895, 82.74975869036236, 12.509672458344362, 12.92228579251467, 20.68200859924847, 19.799230738382967, 80.64022968649512, 0.0, 17.769643521684817, 5.639005545363659, 1.840933253502925, 5.317411684098246, 34.52914931656645, 4.017234908981175, 0.9052260099193697, 2.6625312400040153, 66.67584832982082, 0.0, 3.9088950026869567, 25.441413869926187, 20.13860751263193, 28.160645485715467, 7.596499561743215, 35.7711491392146, 18.086414831512062, 2.9998056256949317, 18.338218810409128, 22.97380880224264, 8.830887636923448, 11.53173807716467, 16.637085498415853, 2.540720900363108, 5.231466971117699, 55.74242908805609, 0.7765042706594621, 28.52854407008721, 79.46090287590263, 12.781413808408958, 8.713698717201787, 2.9538528598639187, 17.60706551856247, 26.52757801919133, 32.22333980339936, 0.887073093602475, 5.928633238177049, 46.7335036682673, 51.56302243294476, 13.652304482899265, 3.813770794103314, 32.22249970560643, 37.410142557539274, 12.671107811495704, 24.366363713777826, 588.320854816805, 4.96660840897822, 5.684454052952874, 41.36579616818177, 31.21666350228481, 128.36258189869338, 15.577989648813805, 1.6522929545081824, 0.0, 90.58684821828227, 17.023079121530294, 0.0, 4.049534407876139, 10.041293004592783, 5.553495553651048, 0.0, 33.952937808487334, 2.8289604630525114, 74.37254901048702, 44.523963357301845, 26.144180086177546, 3.7286355663008255, 17.689161594844922, 21.701048526346092, 0.0, 67.94218761890225, 16.959702496393543, 40.85552673248902, 21.057339752095135, 79.81730865551097, 13.413057986109232, 139.5043816095388, 33.91395319061053, 8.718693657001797, 20.065395622500734, 44.57354116238509, 38.72915071753208, 6.654788027502873, 1.9733100186588575, 29.33554884941501, 1.8869392035268442, 77.36022788069997, 20.605553975210686, 47.38434675955724, 4.0751820496947735, 27.060492495944118, 27.203317470412603, 9.386306147225099, 6.126558738710319, 0.0, 25.152464961271644, 100.433225652529, 74.19107940617364, 127.68681645864221, 7.337278224259374, 22.96889678763291, 9.085033558069215, 80.88862575309369, 13.441920714965779, 140.20568997373732, 12.89048640761544, 2.504781860845077, 21.630960525118837, 4.567936406867587, 45.011870544940784, 33.81058640586083, 16.878141460688692, 15.020108036109631, 6.053254854002045, 106.85251587604844, 0.0, 69.96099153422895, 113.23647098098746, 44.0488963251389, 7.401140728564156, 72.20083707824249, 28.612512621939494, 50.66266318257634, 3.0404144763284986, 54.65389726294193, 125.72444677865154, 0.8622544939848062, 102.5284585270786, 5.200323732439614, 45.15807676203363, 5.445450259969593, 65.35812717037012, 45.19127741518303, 2.688392730481138, 50.79774212077922, 13.282766177969377, 0.0, 0.0, 21.162066369267908, 20.761333467023665, 15.867011211008785, 3.2290290065888003, 6.385235140757589, 14.8923590960374, 205.36204914101467, 153.9131451677003, 177.34391589987226, 5.576427051368313, 35.28338812599837, 78.602924033864, 15.885473969945231, 96.1735245395668, 134.3752309752685, 15.801301908780609, 34.3006297552133, 24.695841429567118, 188.42385483858237, 23.653705604554983, 11.256894355490514, 31.52874602073457, 30.008627072448736, 25.271560393827055, 0.0, 127.33677385184247, 96.98345814972397, 260.8863664129385, 46.48937298826043, 33.16630728839102, 23.39717736276832, 38.65861849128394, 40.95882276043406, 64.052870286462, 15.612752873676328, 26.618875805334042, 47.23337920202108, 32.30423028610029, 171.7069218230913]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5176601366849791, "mean_inference_ms": 4.989398071111194, "mean_action_processing_ms": 2.726399678084734, "mean_env_wait_ms": 1.0263328460289358, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006762266159057617, "StateBufferConnector_ms": 0.003454923629760742, "ViewRequirementAgentConnector_ms": 0.10758912563323975}, "num_episodes": 18, "episode_return_max": 396.0, "episode_return_min": 33.400000000000205, "episode_return_mean": 261.213303539307, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 768000, "num_agent_steps_trained": 768000, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 76.36666949000157, "num_env_steps_trained_throughput_per_sec": 76.36666949000157, "timesteps_total": 192000, "num_env_steps_sampled_lifetime": 192000, "num_agent_steps_sampled_lifetime": 768000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 768000, "timers": {"training_iteration_time_ms": 52353.889, "restore_workers_time_ms": 0.013, "training_step_time_ms": 52353.821, "sample_time_ms": 1667.036, "learn_time_ms": 50664.225, "learn_throughput": 78.951, "synch_weights_time_ms": 18.5}, "counters": {"num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 768000, "num_agent_steps_trained": 768000}, "done": false, "training_iteration": 48, "trial_id": "cf3bb_00000", "date": "2024-08-20_09-24-22", "timestamp": 1724126062, "time_this_iter_s": 52.418851137161255, "time_total_s": 10325.32102894783, "pid": 25777, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39f79d9d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 10325.32102894783, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 48.601351351351354, "ram_util_percent": 77.69324324324324}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.187404141981135, "cur_kl_coeff": 0.01779785156249999, "cur_lr": 0.00010000000000000003, "total_loss": 4.170154500512219, "policy_loss": -0.003479044392911924, "vf_loss": 4.173415019777086, "vf_explained_var": 0.015236155665110027, "kl": 0.012278382776861966, "entropy": 1.465692706839748, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 91665.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 19.567595261808425, "cur_kl_coeff": 0.0421875, "cur_lr": 0.00010000000000000003, "total_loss": 6.6069832158467126, "policy_loss": -0.00434011388372965, "vf_loss": 6.610947347318054, "vf_explained_var": -0.16029027277830415, "kl": 0.008911833872191107, "entropy": 1.1117116474600697, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 91665.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_agent_steps_sampled": 784000, "num_agent_steps_trained": 784000}, "env_runners": {"episode_reward_max": 396.0, "episode_reward_min": -102.0590166023517, "episode_reward_mean": 228.73918039967464, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -588.020854816805, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 644.4534774200732}, "policy_reward_mean": {"prey_policy": 54.41608191600562, "predator_policy": 59.95350828383181}, "custom_metrics": {}, "hist_stats": {"episode_reward": [362.0, 387.8, 377.28857980371583, 347.3159889937996, 207.9999999999993, 212.3999999999993, 199.49999999999935, 392.1, 365.25221637842714, 212.5999999999993, 363.6, 346.4, 127.79999999999997, 361.1, 312.5281625949508, 385.0, 367.0, 370.81761222501206, 299.5999999999998, 39.60000000000029, 207.19999999999933, 217.62305872345337, 37.10000000000026, 204.99999999999935, 201.99999999999935, 208.38405609608216, 153.49999999999957, 322.55215220198363, 343.06398484083877, 190.19999999999942, 46.300000000000246, 379.3, 185.49999999999946, 187.19999999999942, 186.49999999999943, 37.80000000000027, 396.0, 325.9441100389306, 344.030466028496, 195.0999999999994, 314.3105503611887, 140.99999999999963, 216.59999999999928, 345.2, 188.69999999999942, 199.7850525188353, 157.79999999999956, 35.10000000000023, 186.6999999999994, 202.89999999999932, 368.7679677078053, 353.77321694031986, 269.3580009521229, 166.8999999999995, 362.5463556711598, 159.8999999999996, 375.10467133213643, 209.9999999999993, 368.6, 206.59999999999934, 213.59999999999928, 218.46518505764348, 267.60979592765847, 207.88805733873252, 333.6, 283.2189870133233, 209.7999999999993, 261.32973036454473, 376.0, 208.49999999999932, 218.69999999999925, 222.3920930481724, 181.96168545402782, 189.8999999999994, 348.3, 135.89999999999972, 338.40000000000003, 264.51994431962635, 45.200000000000124, 375.6, 150.69999999999933, 180.6999999999994, 254.07925715690976, 36.90000000000007, 182.79999999999944, 79.74494055942814, 104.66761845636103, 142.1999999999997, -102.0590166023517, 181.49999999999946, 385.4, 83.99936679073858, 210.7999999999993, 17.837233247078736, 169.76621645176425, 14.518150156779967, 149.19999999999965, 161.24751865963134, 286.81014129465575, 44.574931863498094], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [175.86826192283533, 157.96291450158415, 195.4592790996369, 184.5685330288823, 124.2575709119439, 196.5120755330564, 97.22410406267977, 142.10243798512994, 176.21858619159104, 10.286301282798192, 190.44614714013608, 1.3929344814375042, 154.47242198080866, -13.72333980339914, 188.24607417881924, 197.03821948940123, 136.73823231852452, 130.21745795869057, 176.54769551710075, 18.58622920589665, 145.97750029439356, 147.98985744246073, 154.92889218850428, 154.43363628622217, -588.020854816805, 122.53339159102178, 187.6155459470471, 126.43420383181824, 71.36527982030549, 81.58363737366709, 191.89462225476996, 175.87509514190805, 200.0, 76.41315178171773, 171.33644591711746, 182.45808718636434, 191.95046559212386, 93.55870699540719, 14.046504446348916, 20.000000000000014, -15.652937808487081, 186.0710395369475, -1.2810370053589875, 100.00758336102423, -8.64418008617751, 15.871364433699137, 1.3108384051550608, 164.29895147365391, 20.000000000000014, 114.05781238109775, 16.77214745705417, 133.79667941014608, 10.15847182152522, 42.46687977086842, 118.00379628363277, 51.6309163227028, 154.74302115063284, 145.6883168425936, -1.1653956225007174, 126.72645883761493, -2.253229728249063, 3.1692909832142035, 193.32668998134113, 154.664451150585, 124.51085971093949, -18.258026795166018, 114.05395808604575, 5.156141179186291, 15.524817950305192, 139.8395075040559, -8.70331747041247, 9.913693852774866, 189.87344126128968, 200.0, 113.75463946095797, 86.60377996417199, 100.92042799615825, 41.232142167521914, 170.55530226556948, -5.761477277461779, 109.99662032962061, 114.34027072040516, 5.558079285034188, -18.205689973737293, 5.709513592384528, 195.49521813915493, 140.26903947488117, 178.7320635931324, -11.699252819368024, 121.57679586856659, 152.29314061769088, 15.593662404346697, 27.091210362305944, 17.80301890764355, 20.000000000000014, -54.860991534229115, -99.53647098098824, 128.9511036748611, 177.59885927143586, -54.3008370782427, 174.81106998616121, 114.6817219171283, 157.7329330587608, 138.3459721422886, 44.73668513013003, 98.03461454935649, 19.07462772754554, 40.09659001293625, 144.38408536433474, 167.55874328482187, -3.4035846999639974, 52.754180114410886, 133.62034929753327, 187.9981871833428, 176.7172338220306, 20.000000000000014, 199.1, 148.3379336307321, -2.1613334670236424, 172.1329887889912, 16.370970993411166, 187.61476485924243, -34.636108409435224, 32.84688523002663, 76.40666683689406, -140.05393197680814, 183.8571229400327, -16.828880778665926, 82.397075966136, 156.71452603005477, 92.90574308532752, -40.23551158683961, 2.9986980912193535, 156.6993702447867, -30.93567699154613, 79.14571108794149, 162.346294395445, 178.74310564450948, -13.02874602073436, 159.99137292755125, -6.5715603938269584, 200.0, -29.877613244686188, 27.94947429129212, -192.7233912917915, 67.30933734462042, 137.833692711609, -4.497177362768259, 136.64138150871605, 132.04117723956594, 7.0780702961058175, 49.15630654375583, 146.48112419466597, 118.06662079797896, -67.98134707554473, 128.49013928597952, 9.127160529273057, -486.29590136421575, 195.21556536039918, 149.39310113772052, -40.23538564740306, 30.342999556707028, 3.1060951991852863, 121.72760129039506, 112.70532313886483, -142.5477737261794, 18.925825399754668, -411.32534861443685, 99.24317748570799, -16.286603988629004, -76.58667496886602, -128.05704321823697, 20.000000000000014, -126.20595954651807, -0.7918988860018885, 1.7716289192755912, -165.91171450515856, -580.6007795172661, 108.76221479831432, -0.5852314895621095, 179.17123747762056, 194.09742803812003, -198.86474796261294, -46.406654724600166, 186.18320159652635, -14.593461172789494, -317.0111379560919, -377.5473279346783, -67.22644762789764, -12.509864301877485, -198.18521576570285, -72.28693037496008, 7.882098243058135, 63.88541808293737, 19.013629932785634, 11.549689506174218, 98.10739098897304, 21.54614825219656, -209.12334218656562, -144.80927083585027], "policy_predator_policy_reward": [11.53173807716467, 16.637085498415853, 2.540720900363108, 5.231466971117699, 55.74242908805609, 0.7765042706594621, 28.52854407008721, 79.46090287590263, 12.781413808408958, 8.713698717201787, 2.9538528598639187, 17.60706551856247, 26.52757801919133, 32.22333980339936, 0.887073093602475, 5.928633238177049, 46.7335036682673, 51.56302243294476, 13.652304482899265, 3.813770794103314, 32.22249970560643, 37.410142557539274, 12.671107811495704, 24.366363713777826, 588.320854816805, 4.96660840897822, 5.684454052952874, 41.36579616818177, 31.21666350228481, 128.36258189869338, 15.577989648813805, 1.6522929545081824, 0.0, 90.58684821828227, 17.023079121530294, 0.0, 4.049534407876139, 10.041293004592783, 5.553495553651048, 0.0, 33.952937808487334, 2.8289604630525114, 74.37254901048702, 44.523963357301845, 26.144180086177546, 3.7286355663008255, 17.689161594844922, 21.701048526346092, 0.0, 67.94218761890225, 16.959702496393543, 40.85552673248902, 21.057339752095135, 79.81730865551097, 13.413057986109232, 139.5043816095388, 33.91395319061053, 8.718693657001797, 20.065395622500734, 44.57354116238509, 38.72915071753208, 6.654788027502873, 1.9733100186588575, 29.33554884941501, 1.8869392035268442, 77.36022788069997, 20.605553975210686, 47.38434675955724, 4.0751820496947735, 27.060492495944118, 27.203317470412603, 9.386306147225099, 6.126558738710319, 0.0, 25.152464961271644, 100.433225652529, 74.19107940617364, 127.68681645864221, 7.337278224259374, 22.96889678763291, 9.085033558069215, 80.88862575309369, 13.441920714965779, 140.20568997373732, 12.89048640761544, 2.504781860845077, 21.630960525118837, 4.567936406867587, 45.011870544940784, 33.81058640586083, 16.878141460688692, 15.020108036109631, 6.053254854002045, 106.85251587604844, 0.0, 69.96099153422895, 113.23647098098746, 44.0488963251389, 7.401140728564156, 72.20083707824249, 28.612512621939494, 50.66266318257634, 3.0404144763284986, 54.65389726294193, 125.72444677865154, 0.8622544939848062, 102.5284585270786, 5.200323732439614, 45.15807676203363, 5.445450259969593, 65.35812717037012, 45.19127741518303, 2.688392730481138, 50.79774212077922, 13.282766177969377, 0.0, 0.0, 21.162066369267908, 20.761333467023665, 15.867011211008785, 3.2290290065888003, 6.385235140757589, 14.8923590960374, 205.36204914101467, 153.9131451677003, 177.34391589987226, 5.576427051368313, 35.28338812599837, 78.602924033864, 15.885473969945231, 96.1735245395668, 134.3752309752685, 15.801301908780609, 34.3006297552133, 24.695841429567118, 188.42385483858237, 23.653705604554983, 11.256894355490514, 31.52874602073457, 30.008627072448736, 25.271560393827055, 0.0, 127.33677385184247, 96.98345814972397, 260.8863664129385, 46.48937298826043, 33.16630728839102, 23.39717736276832, 38.65861849128394, 40.95882276043406, 64.052870286462, 15.612752873676328, 26.618875805334042, 47.23337920202108, 32.30423028610029, 171.7069218230913, 10.072839470726908, 512.2959013642158, 1.8844346396008005, 29.10689886227948, 56.935385647403294, 103.65700044329297, 15.593904800814682, 40.27239870960495, 19.450863699858846, 264.47084404436526, 0.9741746002453342, 428.32534861443685, 65.75682251429201, 34.08660398862926, 8.750400360957109, 275.638258385574, 13.837424285847689, 197.0361537170318, 53.59423915384027, 87.62603081288596, 0.0, 644.4534774200732, 54.237785201685675, 19.085231489562112, 9.228762522379443, 2.90257196187999, 324.3715439356009, 4.899225542350578, 6.916798403473653, 32.29346117278972, 387.72604033950114, 324.6696587983474, 30.04739566386674, 219.45513271767254, 281.57718909932464, 3.4131071981184515, 72.32041518037353, 5.112068493630922, 2.23388872684615, 128.45031049382578, 28.166357128968023, 138.99024492451815, 398.50754488591434, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.499327158324278, "mean_inference_ms": 4.822349251252321, "mean_action_processing_ms": 2.7477953470646623, "mean_env_wait_ms": 1.0099600965546043, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006076335906982422, "StateBufferConnector_ms": 0.0034646987915039062, "ViewRequirementAgentConnector_ms": 0.10430443286895752}, "num_episodes": 22, "episode_return_max": 396.0, "episode_return_min": -102.0590166023517, "episode_return_mean": 228.73918039967464, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 784000, "num_agent_steps_trained": 784000, "num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 79.12064885774353, "num_env_steps_trained_throughput_per_sec": 79.12064885774353, "timesteps_total": 196000, "num_env_steps_sampled_lifetime": 196000, "num_agent_steps_sampled_lifetime": 784000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 784000, "timers": {"training_iteration_time_ms": 51313.187, "restore_workers_time_ms": 0.014, "training_step_time_ms": 51313.119, "sample_time_ms": 1477.951, "learn_time_ms": 49812.775, "learn_throughput": 80.301, "synch_weights_time_ms": 18.792}, "counters": {"num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_agent_steps_sampled": 784000, "num_agent_steps_trained": 784000}, "done": false, "training_iteration": 49, "trial_id": "cf3bb_00000", "date": "2024-08-20_09-25-12", "timestamp": 1724126112, "time_this_iter_s": 50.5904278755188, "time_total_s": 10375.911456823349, "pid": 25777, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39f71c790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 10375.911456823349, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 45.94722222222222, "ram_util_percent": 82.50416666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7358233098315183, "cur_kl_coeff": 0.01779785156249999, "cur_lr": 0.00010000000000000003, "total_loss": 4.569688156672886, "policy_loss": -0.005135768153285854, "vf_loss": 4.574522224305168, "vf_explained_var": 0.008700780010727978, "kl": 0.01695066365564256, "entropy": 1.3819916344193555, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 93555.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 20.41925585910126, "cur_kl_coeff": 0.0421875, "cur_lr": 0.00010000000000000003, "total_loss": 6.936041189879967, "policy_loss": -0.002804768054189269, "vf_loss": 6.938523260500065, "vf_explained_var": -0.059457558393478396, "kl": 0.007648963955462228, "entropy": 1.1666576734295597, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 93555.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_agent_steps_sampled": 800000, "num_agent_steps_trained": 800000}, "env_runners": {"episode_reward_max": 396.0, "episode_reward_min": -203.91809677328123, "episode_reward_mean": 189.05409735424448, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -580.6007795172661, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 644.4534774200732}, "policy_reward_mean": {"prey_policy": 8.309736992867911, "predator_policy": 86.2173116842544}, "custom_metrics": {}, "hist_stats": {"episode_reward": [204.99999999999935, 201.99999999999935, 208.38405609608216, 153.49999999999957, 322.55215220198363, 343.06398484083877, 190.19999999999942, 46.300000000000246, 379.3, 185.49999999999946, 187.19999999999942, 186.49999999999943, 37.80000000000027, 396.0, 325.9441100389306, 344.030466028496, 195.0999999999994, 314.3105503611887, 140.99999999999963, 216.59999999999928, 345.2, 188.69999999999942, 199.7850525188353, 157.79999999999956, 35.10000000000023, 186.6999999999994, 202.89999999999932, 368.7679677078053, 353.77321694031986, 269.3580009521229, 166.8999999999995, 362.5463556711598, 159.8999999999996, 375.10467133213643, 209.9999999999993, 368.6, 206.59999999999934, 213.59999999999928, 218.46518505764348, 267.60979592765847, 207.88805733873252, 333.6, 283.2189870133233, 209.7999999999993, 261.32973036454473, 376.0, 208.49999999999932, 218.69999999999925, 222.3920930481724, 181.96168545402782, 189.8999999999994, 348.3, 135.89999999999972, 338.40000000000003, 264.51994431962635, 45.200000000000124, 375.6, 150.69999999999933, 180.6999999999994, 254.07925715690976, 36.90000000000007, 182.79999999999944, 79.74494055942814, 104.66761845636103, 142.1999999999997, -102.0590166023517, 181.49999999999946, 385.4, 83.99936679073858, 210.7999999999993, 17.837233247078736, 169.76621645176425, 14.518150156779967, 149.19999999999965, 161.24751865963134, 286.81014129465575, 44.574931863498094, 124.11693547723237, 206.5999999999993, 183.21309252673345, 364.76002110041037, 76.32574516023423, -203.91809677328123, 55.690398990862604, 31.200000000000173, -23.84274886559004, 183.69999999999965, 381.0, 92.12852176804981, 30.500000000000163, 127.61727537822064, 112.68650400285725, 366.91930098343215, 24.673904764359268, 70.22850417811203, 62.42895635168755, 83.43947967641883, 17.72739582869392, 36.70000000000025, 127.22212362790964], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [1.3108384051550608, 164.29895147365391, 20.000000000000014, 114.05781238109775, 16.77214745705417, 133.79667941014608, 10.15847182152522, 42.46687977086842, 118.00379628363277, 51.6309163227028, 154.74302115063284, 145.6883168425936, -1.1653956225007174, 126.72645883761493, -2.253229728249063, 3.1692909832142035, 193.32668998134113, 154.664451150585, 124.51085971093949, -18.258026795166018, 114.05395808604575, 5.156141179186291, 15.524817950305192, 139.8395075040559, -8.70331747041247, 9.913693852774866, 189.87344126128968, 200.0, 113.75463946095797, 86.60377996417199, 100.92042799615825, 41.232142167521914, 170.55530226556948, -5.761477277461779, 109.99662032962061, 114.34027072040516, 5.558079285034188, -18.205689973737293, 5.709513592384528, 195.49521813915493, 140.26903947488117, 178.7320635931324, -11.699252819368024, 121.57679586856659, 152.29314061769088, 15.593662404346697, 27.091210362305944, 17.80301890764355, 20.000000000000014, -54.860991534229115, -99.53647098098824, 128.9511036748611, 177.59885927143586, -54.3008370782427, 174.81106998616121, 114.6817219171283, 157.7329330587608, 138.3459721422886, 44.73668513013003, 98.03461454935649, 19.07462772754554, 40.09659001293625, 144.38408536433474, 167.55874328482187, -3.4035846999639974, 52.754180114410886, 133.62034929753327, 187.9981871833428, 176.7172338220306, 20.000000000000014, 199.1, 148.3379336307321, -2.1613334670236424, 172.1329887889912, 16.370970993411166, 187.61476485924243, -34.636108409435224, 32.84688523002663, 76.40666683689406, -140.05393197680814, 183.8571229400327, -16.828880778665926, 82.397075966136, 156.71452603005477, 92.90574308532752, -40.23551158683961, 2.9986980912193535, 156.6993702447867, -30.93567699154613, 79.14571108794149, 162.346294395445, 178.74310564450948, -13.02874602073436, 159.99137292755125, -6.5715603938269584, 200.0, -29.877613244686188, 27.94947429129212, -192.7233912917915, 67.30933734462042, 137.833692711609, -4.497177362768259, 136.64138150871605, 132.04117723956594, 7.0780702961058175, 49.15630654375583, 146.48112419466597, 118.06662079797896, -67.98134707554473, 128.49013928597952, 9.127160529273057, -486.29590136421575, 195.21556536039918, 149.39310113772052, -40.23538564740306, 30.342999556707028, 3.1060951991852863, 121.72760129039506, 112.70532313886483, -142.5477737261794, 18.925825399754668, -411.32534861443685, 99.24317748570799, -16.286603988629004, -76.58667496886602, -128.05704321823697, 20.000000000000014, -126.20595954651807, -0.7918988860018885, 1.7716289192755912, -165.91171450515856, -580.6007795172661, 108.76221479831432, -0.5852314895621095, 179.17123747762056, 194.09742803812003, -198.86474796261294, -46.406654724600166, 186.18320159652635, -14.593461172789494, -317.0111379560919, -377.5473279346783, -67.22644762789764, -12.509864301877485, -198.18521576570285, -72.28693037496008, 7.882098243058135, 63.88541808293737, 19.013629932785634, 11.549689506174218, 98.10739098897304, 21.54614825219656, -209.12334218656562, -144.80927083585027, -35.21615034457602, -200.52765387161483, -9.45435338639762, 163.50686305304603, 128.74873786003607, -286.6224847849584, 140.31293157237124, 162.9347839316414, -278.03309101479476, 0.8784253003191735, -451.82181335785424, -389.61256075700896, -146.31742779975357, -312.4147302676231, -115.35256869503488, -70.64389272668056, -142.3198469203642, -291.06939939757865, 131.06073287964824, -123.02514465167192, 147.59459111803392, 200.0, -66.05431881810395, -355.57213683438187, -177.81259844469426, -39.42708087769646, -434.0562472517838, 17.812502442664055, -70.80522690647791, -234.24825031146156, 118.7827987075041, 178.77459917761752, -128.91110210598183, -96.73636227826557, -287.1119018729734, -24.48621946737785, -283.852598291221, -174.55633303187798, -52.65114733801449, -303.19320639905624, -14.741968623619742, -49.53589787963512, -56.22167638731857, 18.93836078855526, -28.816924685928797, -60.223856983602076], "policy_predator_policy_reward": [17.689161594844922, 21.701048526346092, 0.0, 67.94218761890225, 16.959702496393543, 40.85552673248902, 21.057339752095135, 79.81730865551097, 13.413057986109232, 139.5043816095388, 33.91395319061053, 8.718693657001797, 20.065395622500734, 44.57354116238509, 38.72915071753208, 6.654788027502873, 1.9733100186588575, 29.33554884941501, 1.8869392035268442, 77.36022788069997, 20.605553975210686, 47.38434675955724, 4.0751820496947735, 27.060492495944118, 27.203317470412603, 9.386306147225099, 6.126558738710319, 0.0, 25.152464961271644, 100.433225652529, 74.19107940617364, 127.68681645864221, 7.337278224259374, 22.96889678763291, 9.085033558069215, 80.88862575309369, 13.441920714965779, 140.20568997373732, 12.89048640761544, 2.504781860845077, 21.630960525118837, 4.567936406867587, 45.011870544940784, 33.81058640586083, 16.878141460688692, 15.020108036109631, 6.053254854002045, 106.85251587604844, 0.0, 69.96099153422895, 113.23647098098746, 44.0488963251389, 7.401140728564156, 72.20083707824249, 28.612512621939494, 50.66266318257634, 3.0404144763284986, 54.65389726294193, 125.72444677865154, 0.8622544939848062, 102.5284585270786, 5.200323732439614, 45.15807676203363, 5.445450259969593, 65.35812717037012, 45.19127741518303, 2.688392730481138, 50.79774212077922, 13.282766177969377, 0.0, 0.0, 21.162066369267908, 20.761333467023665, 15.867011211008785, 3.2290290065888003, 6.385235140757589, 14.8923590960374, 205.36204914101467, 153.9131451677003, 177.34391589987226, 5.576427051368313, 35.28338812599837, 78.602924033864, 15.885473969945231, 96.1735245395668, 134.3752309752685, 15.801301908780609, 34.3006297552133, 24.695841429567118, 188.42385483858237, 23.653705604554983, 11.256894355490514, 31.52874602073457, 30.008627072448736, 25.271560393827055, 0.0, 127.33677385184247, 96.98345814972397, 260.8863664129385, 46.48937298826043, 33.16630728839102, 23.39717736276832, 38.65861849128394, 40.95882276043406, 64.052870286462, 15.612752873676328, 26.618875805334042, 47.23337920202108, 32.30423028610029, 171.7069218230913, 10.072839470726908, 512.2959013642158, 1.8844346396008005, 29.10689886227948, 56.935385647403294, 103.65700044329297, 15.593904800814682, 40.27239870960495, 19.450863699858846, 264.47084404436526, 0.9741746002453342, 428.32534861443685, 65.75682251429201, 34.08660398862926, 8.750400360957109, 275.638258385574, 13.837424285847689, 197.0361537170318, 53.59423915384027, 87.62603081288596, 0.0, 644.4534774200732, 54.237785201685675, 19.085231489562112, 9.228762522379443, 2.90257196187999, 324.3715439356009, 4.899225542350578, 6.916798403473653, 32.29346117278972, 387.72604033950114, 324.6696587983474, 30.04739566386674, 219.45513271767254, 281.57718909932464, 3.4131071981184515, 72.32041518037353, 5.112068493630922, 2.23388872684615, 128.45031049382578, 28.166357128968023, 138.99024492451815, 398.50754488591434, 0.0, 115.69546360392094, 244.16527608950233, 28.054353386397768, 24.493136946953975, 7.212163306793889, 333.8746761448618, 28.85758325022059, 32.65472234617713, 116.06343777954345, 237.41697309516647, 70.62275010296102, 566.893527238621, 225.93855241573985, 288.48400464249863, 216.3238495429969, 0.8726118787170261, 344.59025014930506, 64.95624730304763, 39.939267120351765, 135.7251446516712, 33.40540888196609, 0.0, 367.88939794340814, 145.86557947712657, 25.77274584944799, 221.96693347294254, 433.19651279914353, 110.66450738819702, 144.31867102019132, 273.421310200605, 46.27929428891354, 23.08260880939699, 49.01262609045241, 201.30874305815277, 364.27029185770937, 17.556333660754035, 103.3193730341156, 417.51851464067073, 37.99121352535234, 401.2926198881369, 13.851935755629054, 68.15332657632004, 73.02167638731817, 0.9616392114447394, 149.43994356274368, 66.82296173469763]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5533313209958897, "mean_inference_ms": 4.684845027962224, "mean_action_processing_ms": 2.6156468459729103, "mean_env_wait_ms": 1.0630207104949916, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00967395305633545, "StateBufferConnector_ms": 0.0035632848739624023, "ViewRequirementAgentConnector_ms": 0.1135871410369873}, "num_episodes": 23, "episode_return_max": 396.0, "episode_return_min": -203.91809677328123, "episode_return_mean": 189.05409735424448, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 800000, "num_agent_steps_trained": 800000, "num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 79.76047577155441, "num_env_steps_trained_throughput_per_sec": 79.76047577155441, "timesteps_total": 200000, "num_env_steps_sampled_lifetime": 200000, "num_agent_steps_sampled_lifetime": 800000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 800000, "timers": {"training_iteration_time_ms": 50308.945, "restore_workers_time_ms": 0.013, "training_step_time_ms": 50308.878, "sample_time_ms": 1492.452, "learn_time_ms": 48794.032, "learn_throughput": 81.977, "synch_weights_time_ms": 18.828}, "counters": {"num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_agent_steps_sampled": 800000, "num_agent_steps_trained": 800000}, "done": false, "training_iteration": 50, "trial_id": "cf3bb_00000", "date": "2024-08-20_09-26-02", "timestamp": 1724126162, "time_this_iter_s": 50.20883297920227, "time_total_s": 10426.120289802551, "pid": 25777, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39f79dd30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 10426.120289802551, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 40.483333333333334, "ram_util_percent": 82.24305555555556}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9203771533671194, "cur_kl_coeff": 0.01779785156249999, "cur_lr": 0.00010000000000000003, "total_loss": 4.177567003139113, "policy_loss": -0.0016152732071796896, "vf_loss": 4.1791204849878945, "vf_explained_var": 0.010583034078910867, "kl": 0.003471789890084007, "entropy": 1.3820340056898732, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 95445.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 24.747184506925958, "cur_kl_coeff": 0.0421875, "cur_lr": 0.00010000000000000003, "total_loss": 5.74755103651178, "policy_loss": -0.005496489049043881, "vf_loss": 5.752686857041859, "vf_explained_var": 0.16817014034462985, "kl": 0.008549076424873289, "entropy": 1.2512341691703392, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 95445.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_agent_steps_sampled": 816000, "num_agent_steps_trained": 816000}, "env_runners": {"episode_reward_max": 385.4, "episode_reward_min": -203.91809677328123, "episode_reward_mean": 173.40566395756105, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -580.6007795172661, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 644.4534774200732}, "policy_reward_mean": {"prey_policy": -8.936281808286868, "predator_policy": 95.63911378706746}, "custom_metrics": {}, "hist_stats": {"episode_reward": [140.99999999999963, 216.59999999999928, 345.2, 188.69999999999942, 199.7850525188353, 157.79999999999956, 35.10000000000023, 186.6999999999994, 202.89999999999932, 368.7679677078053, 353.77321694031986, 269.3580009521229, 166.8999999999995, 362.5463556711598, 159.8999999999996, 375.10467133213643, 209.9999999999993, 368.6, 206.59999999999934, 213.59999999999928, 218.46518505764348, 267.60979592765847, 207.88805733873252, 333.6, 283.2189870133233, 209.7999999999993, 261.32973036454473, 376.0, 208.49999999999932, 218.69999999999925, 222.3920930481724, 181.96168545402782, 189.8999999999994, 348.3, 135.89999999999972, 338.40000000000003, 264.51994431962635, 45.200000000000124, 375.6, 150.69999999999933, 180.6999999999994, 254.07925715690976, 36.90000000000007, 182.79999999999944, 79.74494055942814, 104.66761845636103, 142.1999999999997, -102.0590166023517, 181.49999999999946, 385.4, 83.99936679073858, 210.7999999999993, 17.837233247078736, 169.76621645176425, 14.518150156779967, 149.19999999999965, 161.24751865963134, 286.81014129465575, 44.574931863498094, 124.11693547723237, 206.5999999999993, 183.21309252673345, 364.76002110041037, 76.32574516023423, -203.91809677328123, 55.690398990862604, 31.200000000000173, -23.84274886559004, 183.69999999999965, 381.0, 92.12852176804981, 30.500000000000163, 127.61727537822064, 112.68650400285725, 366.91930098343215, 24.673904764359268, 70.22850417811203, 62.42895635168755, 83.43947967641883, 17.72739582869392, 36.70000000000025, 127.22212362790964, 187.79999999999941, 160.73069079725553, 373.6, 39.20000000000029, -92.13303036804359, 77.10000000000004, 33.916116523517054, 60.40000000000014, 319.6779405128691, 159.69999999999942, 108.29999999999936, 146.5716115245361, 111.99999999999966, 15.866226840445007, 173.3999999999995, 316.5, 298.95425793195176, 166.25816613664716], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [5.558079285034188, -18.205689973737293, 5.709513592384528, 195.49521813915493, 140.26903947488117, 178.7320635931324, -11.699252819368024, 121.57679586856659, 152.29314061769088, 15.593662404346697, 27.091210362305944, 17.80301890764355, 20.000000000000014, -54.860991534229115, -99.53647098098824, 128.9511036748611, 177.59885927143586, -54.3008370782427, 174.81106998616121, 114.6817219171283, 157.7329330587608, 138.3459721422886, 44.73668513013003, 98.03461454935649, 19.07462772754554, 40.09659001293625, 144.38408536433474, 167.55874328482187, -3.4035846999639974, 52.754180114410886, 133.62034929753327, 187.9981871833428, 176.7172338220306, 20.000000000000014, 199.1, 148.3379336307321, -2.1613334670236424, 172.1329887889912, 16.370970993411166, 187.61476485924243, -34.636108409435224, 32.84688523002663, 76.40666683689406, -140.05393197680814, 183.8571229400327, -16.828880778665926, 82.397075966136, 156.71452603005477, 92.90574308532752, -40.23551158683961, 2.9986980912193535, 156.6993702447867, -30.93567699154613, 79.14571108794149, 162.346294395445, 178.74310564450948, -13.02874602073436, 159.99137292755125, -6.5715603938269584, 200.0, -29.877613244686188, 27.94947429129212, -192.7233912917915, 67.30933734462042, 137.833692711609, -4.497177362768259, 136.64138150871605, 132.04117723956594, 7.0780702961058175, 49.15630654375583, 146.48112419466597, 118.06662079797896, -67.98134707554473, 128.49013928597952, 9.127160529273057, -486.29590136421575, 195.21556536039918, 149.39310113772052, -40.23538564740306, 30.342999556707028, 3.1060951991852863, 121.72760129039506, 112.70532313886483, -142.5477737261794, 18.925825399754668, -411.32534861443685, 99.24317748570799, -16.286603988629004, -76.58667496886602, -128.05704321823697, 20.000000000000014, -126.20595954651807, -0.7918988860018885, 1.7716289192755912, -165.91171450515856, -580.6007795172661, 108.76221479831432, -0.5852314895621095, 179.17123747762056, 194.09742803812003, -198.86474796261294, -46.406654724600166, 186.18320159652635, -14.593461172789494, -317.0111379560919, -377.5473279346783, -67.22644762789764, -12.509864301877485, -198.18521576570285, -72.28693037496008, 7.882098243058135, 63.88541808293737, 19.013629932785634, 11.549689506174218, 98.10739098897304, 21.54614825219656, -209.12334218656562, -144.80927083585027, -35.21615034457602, -200.52765387161483, -9.45435338639762, 163.50686305304603, 128.74873786003607, -286.6224847849584, 140.31293157237124, 162.9347839316414, -278.03309101479476, 0.8784253003191735, -451.82181335785424, -389.61256075700896, -146.31742779975357, -312.4147302676231, -115.35256869503488, -70.64389272668056, -142.3198469203642, -291.06939939757865, 131.06073287964824, -123.02514465167192, 147.59459111803392, 200.0, -66.05431881810395, -355.57213683438187, -177.81259844469426, -39.42708087769646, -434.0562472517838, 17.812502442664055, -70.80522690647791, -234.24825031146156, 118.7827987075041, 178.77459917761752, -128.91110210598183, -96.73636227826557, -287.1119018729734, -24.48621946737785, -283.852598291221, -174.55633303187798, -52.65114733801449, -303.19320639905624, -14.741968623619742, -49.53589787963512, -56.22167638731857, 18.93836078855526, -28.816924685928797, -60.223856983602076, 106.00579637646557, -83.62545763227851, 50.33562406878253, 18.730690797256027, 184.55866213941067, 158.1356557500557, 10.200723171770967, 19.01611652351682, -157.29628858616516, -192.10147899455453, -91.64865398533857, -133.59969887486986, -3.3386003013104575, -14.166923646902346, -13.136719838039214, -428.97781710671654, 88.48649358341416, 135.29610106403587, -3.1686108790039227, 78.99495507371157, -76.21158262371195, -6.273986786144587, 4.056981544207163, -150.2966277799385, -106.21880480007032, -44.69621073813308, -91.18005690294432, -149.67857731937772, -67.69654453324092, 106.58111396918426, 119.79230279223273, 165.77634513074878, 112.87447770101294, 76.99664294391619, -62.07537178731974, -58.70555191758692], "policy_predator_policy_reward": [13.441920714965779, 140.20568997373732, 12.89048640761544, 2.504781860845077, 21.630960525118837, 4.567936406867587, 45.011870544940784, 33.81058640586083, 16.878141460688692, 15.020108036109631, 6.053254854002045, 106.85251587604844, 0.0, 69.96099153422895, 113.23647098098746, 44.0488963251389, 7.401140728564156, 72.20083707824249, 28.612512621939494, 50.66266318257634, 3.0404144763284986, 54.65389726294193, 125.72444677865154, 0.8622544939848062, 102.5284585270786, 5.200323732439614, 45.15807676203363, 5.445450259969593, 65.35812717037012, 45.19127741518303, 2.688392730481138, 50.79774212077922, 13.282766177969377, 0.0, 0.0, 21.162066369267908, 20.761333467023665, 15.867011211008785, 3.2290290065888003, 6.385235140757589, 14.8923590960374, 205.36204914101467, 153.9131451677003, 177.34391589987226, 5.576427051368313, 35.28338812599837, 78.602924033864, 15.885473969945231, 96.1735245395668, 134.3752309752685, 15.801301908780609, 34.3006297552133, 24.695841429567118, 188.42385483858237, 23.653705604554983, 11.256894355490514, 31.52874602073457, 30.008627072448736, 25.271560393827055, 0.0, 127.33677385184247, 96.98345814972397, 260.8863664129385, 46.48937298826043, 33.16630728839102, 23.39717736276832, 38.65861849128394, 40.95882276043406, 64.052870286462, 15.612752873676328, 26.618875805334042, 47.23337920202108, 32.30423028610029, 171.7069218230913, 10.072839470726908, 512.2959013642158, 1.8844346396008005, 29.10689886227948, 56.935385647403294, 103.65700044329297, 15.593904800814682, 40.27239870960495, 19.450863699858846, 264.47084404436526, 0.9741746002453342, 428.32534861443685, 65.75682251429201, 34.08660398862926, 8.750400360957109, 275.638258385574, 13.837424285847689, 197.0361537170318, 53.59423915384027, 87.62603081288596, 0.0, 644.4534774200732, 54.237785201685675, 19.085231489562112, 9.228762522379443, 2.90257196187999, 324.3715439356009, 4.899225542350578, 6.916798403473653, 32.29346117278972, 387.72604033950114, 324.6696587983474, 30.04739566386674, 219.45513271767254, 281.57718909932464, 3.4131071981184515, 72.32041518037353, 5.112068493630922, 2.23388872684615, 128.45031049382578, 28.166357128968023, 138.99024492451815, 398.50754488591434, 0.0, 115.69546360392094, 244.16527608950233, 28.054353386397768, 24.493136946953975, 7.212163306793889, 333.8746761448618, 28.85758325022059, 32.65472234617713, 116.06343777954345, 237.41697309516647, 70.62275010296102, 566.893527238621, 225.93855241573985, 288.48400464249863, 216.3238495429969, 0.8726118787170261, 344.59025014930506, 64.95624730304763, 39.939267120351765, 135.7251446516712, 33.40540888196609, 0.0, 367.88939794340814, 145.86557947712657, 25.77274584944799, 221.96693347294254, 433.19651279914353, 110.66450738819702, 144.31867102019132, 273.421310200605, 46.27929428891354, 23.08260880939699, 49.01262609045241, 201.30874305815277, 364.27029185770937, 17.556333660754035, 103.3193730341156, 417.51851464067073, 37.99121352535234, 401.2926198881369, 13.851935755629054, 68.15332657632004, 73.02167638731817, 0.9616392114447394, 149.43994356274368, 66.82296173469763, 65.99420362353443, 99.42545763227766, 9.011124960111728, 82.65325097110578, 5.841337860589339, 25.064344249944313, 9.099276828228998, 0.8838834764831843, 13.708259375143564, 243.55647783753196, 105.2486539853379, 197.09969887486972, 22.438600301310398, 28.98304017041938, 30.53671983803941, 471.97781710671666, 65.27496975847212, 30.62037610694694, 56.41779537596723, 27.455860429325142, 11.261728889290906, 179.5238405205657, 179.98040433373075, 112.8308534265372, 120.21880480006952, 142.69621073813292, 180.11603893800117, 76.60882212476429, 84.19654453323999, 50.31888603081576, 24.30769720776719, 6.623654869251226, 4.147086314339062, 104.93605097268359, 2.3456461654441156, 284.6934436761103]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.463679843057519, "mean_inference_ms": 4.76936040656865, "mean_action_processing_ms": 2.5709315493270726, "mean_env_wait_ms": 0.9743183263207204, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009472370147705078, "StateBufferConnector_ms": 0.0036045312881469727, "ViewRequirementAgentConnector_ms": 0.11600780487060547}, "num_episodes": 18, "episode_return_max": 385.4, "episode_return_min": -203.91809677328123, "episode_return_mean": 173.40566395756105, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 816000, "num_agent_steps_trained": 816000, "num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 79.39836379291167, "num_env_steps_trained_throughput_per_sec": 79.39836379291167, "timesteps_total": 204000, "num_env_steps_sampled_lifetime": 204000, "num_agent_steps_sampled_lifetime": 816000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 816000, "timers": {"training_iteration_time_ms": 50176.515, "restore_workers_time_ms": 0.014, "training_step_time_ms": 50176.448, "sample_time_ms": 1423.941, "learn_time_ms": 48730.296, "learn_throughput": 82.084, "synch_weights_time_ms": 18.962}, "counters": {"num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_agent_steps_sampled": 816000, "num_agent_steps_trained": 816000}, "done": false, "training_iteration": 51, "trial_id": "cf3bb_00000", "date": "2024-08-20_09-26-53", "timestamp": 1724126213, "time_this_iter_s": 50.42802309989929, "time_total_s": 10476.54831290245, "pid": 25777, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39f773670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 10476.54831290245, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 41.033802816901414, "ram_util_percent": 82.30704225352113}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.0138350202450677, "cur_kl_coeff": 0.008898925781249995, "cur_lr": 0.00010000000000000003, "total_loss": 5.350746378066048, "policy_loss": -0.006889494424858303, "vf_loss": 5.357436599933282, "vf_explained_var": 0.021062661636443367, "kl": 0.0223942589523258, "entropy": 1.3175656353355085, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 97335.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 19.23057555868512, "cur_kl_coeff": 0.0421875, "cur_lr": 0.00010000000000000003, "total_loss": 6.664009617245386, "policy_loss": -0.0035724382342465183, "vf_loss": 6.667171015815129, "vf_explained_var": -0.1170800422865247, "kl": 0.009742711007298782, "entropy": 1.23065603624576, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 97335.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_agent_steps_sampled": 832000, "num_agent_steps_trained": 832000}, "env_runners": {"episode_reward_max": 385.4, "episode_reward_min": -203.91809677328123, "episode_reward_mean": 153.98830214587278, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -580.6007795172661, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 687.4706497768273}, "policy_reward_mean": {"prey_policy": -33.73259555390965, "predator_policy": 110.7267466268461}, "custom_metrics": {}, "hist_stats": {"episode_reward": [206.59999999999934, 213.59999999999928, 218.46518505764348, 267.60979592765847, 207.88805733873252, 333.6, 283.2189870133233, 209.7999999999993, 261.32973036454473, 376.0, 208.49999999999932, 218.69999999999925, 222.3920930481724, 181.96168545402782, 189.8999999999994, 348.3, 135.89999999999972, 338.40000000000003, 264.51994431962635, 45.200000000000124, 375.6, 150.69999999999933, 180.6999999999994, 254.07925715690976, 36.90000000000007, 182.79999999999944, 79.74494055942814, 104.66761845636103, 142.1999999999997, -102.0590166023517, 181.49999999999946, 385.4, 83.99936679073858, 210.7999999999993, 17.837233247078736, 169.76621645176425, 14.518150156779967, 149.19999999999965, 161.24751865963134, 286.81014129465575, 44.574931863498094, 124.11693547723237, 206.5999999999993, 183.21309252673345, 364.76002110041037, 76.32574516023423, -203.91809677328123, 55.690398990862604, 31.200000000000173, -23.84274886559004, 183.69999999999965, 381.0, 92.12852176804981, 30.500000000000163, 127.61727537822064, 112.68650400285725, 366.91930098343215, 24.673904764359268, 70.22850417811203, 62.42895635168755, 83.43947967641883, 17.72739582869392, 36.70000000000025, 127.22212362790964, 187.79999999999941, 160.73069079725553, 373.6, 39.20000000000029, -92.13303036804359, 77.10000000000004, 33.916116523517054, 60.40000000000014, 319.6779405128691, 159.69999999999942, 108.29999999999936, 146.5716115245361, 111.99999999999966, 15.866226840445007, 173.3999999999995, 316.5, 298.95425793195176, 166.25816613664716, 129.75243567173553, 156.89999999999947, 38.10000000000027, 43.56986034192398, 57.84001669002955, 245.3081133302189, 148.8999999999995, 362.6, 188.29999999999933, 142.49999999999943, 129.29999999999941, 101.34670712700363, 111.43548041068382, 67.34541866480882, 66.92777559378796, 167.0999999999993, 140.15689260808222, 69.61638351527533], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-2.1613334670236424, 172.1329887889912, 16.370970993411166, 187.61476485924243, -34.636108409435224, 32.84688523002663, 76.40666683689406, -140.05393197680814, 183.8571229400327, -16.828880778665926, 82.397075966136, 156.71452603005477, 92.90574308532752, -40.23551158683961, 2.9986980912193535, 156.6993702447867, -30.93567699154613, 79.14571108794149, 162.346294395445, 178.74310564450948, -13.02874602073436, 159.99137292755125, -6.5715603938269584, 200.0, -29.877613244686188, 27.94947429129212, -192.7233912917915, 67.30933734462042, 137.833692711609, -4.497177362768259, 136.64138150871605, 132.04117723956594, 7.0780702961058175, 49.15630654375583, 146.48112419466597, 118.06662079797896, -67.98134707554473, 128.49013928597952, 9.127160529273057, -486.29590136421575, 195.21556536039918, 149.39310113772052, -40.23538564740306, 30.342999556707028, 3.1060951991852863, 121.72760129039506, 112.70532313886483, -142.5477737261794, 18.925825399754668, -411.32534861443685, 99.24317748570799, -16.286603988629004, -76.58667496886602, -128.05704321823697, 20.000000000000014, -126.20595954651807, -0.7918988860018885, 1.7716289192755912, -165.91171450515856, -580.6007795172661, 108.76221479831432, -0.5852314895621095, 179.17123747762056, 194.09742803812003, -198.86474796261294, -46.406654724600166, 186.18320159652635, -14.593461172789494, -317.0111379560919, -377.5473279346783, -67.22644762789764, -12.509864301877485, -198.18521576570285, -72.28693037496008, 7.882098243058135, 63.88541808293737, 19.013629932785634, 11.549689506174218, 98.10739098897304, 21.54614825219656, -209.12334218656562, -144.80927083585027, -35.21615034457602, -200.52765387161483, -9.45435338639762, 163.50686305304603, 128.74873786003607, -286.6224847849584, 140.31293157237124, 162.9347839316414, -278.03309101479476, 0.8784253003191735, -451.82181335785424, -389.61256075700896, -146.31742779975357, -312.4147302676231, -115.35256869503488, -70.64389272668056, -142.3198469203642, -291.06939939757865, 131.06073287964824, -123.02514465167192, 147.59459111803392, 200.0, -66.05431881810395, -355.57213683438187, -177.81259844469426, -39.42708087769646, -434.0562472517838, 17.812502442664055, -70.80522690647791, -234.24825031146156, 118.7827987075041, 178.77459917761752, -128.91110210598183, -96.73636227826557, -287.1119018729734, -24.48621946737785, -283.852598291221, -174.55633303187798, -52.65114733801449, -303.19320639905624, -14.741968623619742, -49.53589787963512, -56.22167638731857, 18.93836078855526, -28.816924685928797, -60.223856983602076, 106.00579637646557, -83.62545763227851, 50.33562406878253, 18.730690797256027, 184.55866213941067, 158.1356557500557, 10.200723171770967, 19.01611652351682, -157.29628858616516, -192.10147899455453, -91.64865398533857, -133.59969887486986, -3.3386003013104575, -14.166923646902346, -13.136719838039214, -428.97781710671654, 88.48649358341416, 135.29610106403587, -3.1686108790039227, 78.99495507371157, -76.21158262371195, -6.273986786144587, 4.056981544207163, -150.2966277799385, -106.21880480007032, -44.69621073813308, -91.18005690294432, -149.67857731937772, -67.69654453324092, 106.58111396918426, 119.79230279223273, 165.77634513074878, 112.87447770101294, 76.99664294391619, -62.07537178731974, -58.70555191758692, -14.50022025445074, -95.92934878101036, 18.890341083377923, 64.4278978889768, 8.155444376052758, 6.7145698462086045, 20.000000000000014, -28.684579230199013, -117.65129601831069, -343.87010970041007, 93.89750512150171, -18.211171048626895, 37.158628501506044, 18.941553220526743, 123.7634397991452, 156.62564389323342, 18.933308282542054, 143.9568809549167, 52.24144515576665, -40.973851262324025, -55.44530361756782, -5.443134581256295, -298.10789300535174, 14.430091171149869, -101.2484326268854, 9.041913262692438, -531.368853532871, -400.7790422613616, -103.21291444087304, -196.44828586913454, 97.47417275102956, 19.07053979897312, -56.417132906037324, -157.42960273068178, -72.33497180267132, -262.28017523570986], "policy_predator_policy_reward": [20.761333467023665, 15.867011211008785, 3.2290290065888003, 6.385235140757589, 14.8923590960374, 205.36204914101467, 153.9131451677003, 177.34391589987226, 5.576427051368313, 35.28338812599837, 78.602924033864, 15.885473969945231, 96.1735245395668, 134.3752309752685, 15.801301908780609, 34.3006297552133, 24.695841429567118, 188.42385483858237, 23.653705604554983, 11.256894355490514, 31.52874602073457, 30.008627072448736, 25.271560393827055, 0.0, 127.33677385184247, 96.98345814972397, 260.8863664129385, 46.48937298826043, 33.16630728839102, 23.39717736276832, 38.65861849128394, 40.95882276043406, 64.052870286462, 15.612752873676328, 26.618875805334042, 47.23337920202108, 32.30423028610029, 171.7069218230913, 10.072839470726908, 512.2959013642158, 1.8844346396008005, 29.10689886227948, 56.935385647403294, 103.65700044329297, 15.593904800814682, 40.27239870960495, 19.450863699858846, 264.47084404436526, 0.9741746002453342, 428.32534861443685, 65.75682251429201, 34.08660398862926, 8.750400360957109, 275.638258385574, 13.837424285847689, 197.0361537170318, 53.59423915384027, 87.62603081288596, 0.0, 644.4534774200732, 54.237785201685675, 19.085231489562112, 9.228762522379443, 2.90257196187999, 324.3715439356009, 4.899225542350578, 6.916798403473653, 32.29346117278972, 387.72604033950114, 324.6696587983474, 30.04739566386674, 219.45513271767254, 281.57718909932464, 3.4131071981184515, 72.32041518037353, 5.112068493630922, 2.23388872684615, 128.45031049382578, 28.166357128968023, 138.99024492451815, 398.50754488591434, 0.0, 115.69546360392094, 244.16527608950233, 28.054353386397768, 24.493136946953975, 7.212163306793889, 333.8746761448618, 28.85758325022059, 32.65472234617713, 116.06343777954345, 237.41697309516647, 70.62275010296102, 566.893527238621, 225.93855241573985, 288.48400464249863, 216.3238495429969, 0.8726118787170261, 344.59025014930506, 64.95624730304763, 39.939267120351765, 135.7251446516712, 33.40540888196609, 0.0, 367.88939794340814, 145.86557947712657, 25.77274584944799, 221.96693347294254, 433.19651279914353, 110.66450738819702, 144.31867102019132, 273.421310200605, 46.27929428891354, 23.08260880939699, 49.01262609045241, 201.30874305815277, 364.27029185770937, 17.556333660754035, 103.3193730341156, 417.51851464067073, 37.99121352535234, 401.2926198881369, 13.851935755629054, 68.15332657632004, 73.02167638731817, 0.9616392114447394, 149.43994356274368, 66.82296173469763, 65.99420362353443, 99.42545763227766, 9.011124960111728, 82.65325097110578, 5.841337860589339, 25.064344249944313, 9.099276828228998, 0.8838834764831843, 13.708259375143564, 243.55647783753196, 105.2486539853379, 197.09969887486972, 22.438600301310398, 28.98304017041938, 30.53671983803941, 471.97781710671666, 65.27496975847212, 30.62037610694694, 56.41779537596723, 27.455860429325142, 11.261728889290906, 179.5238405205657, 179.98040433373075, 112.8308534265372, 120.21880480006952, 142.69621073813292, 180.11603893800117, 76.60882212476429, 84.19654453323999, 50.31888603081576, 24.30769720776719, 6.623654869251226, 4.147086314339062, 104.93605097268359, 2.3456461654441156, 284.6934436761103, 8.143664831076972, 232.03833987611998, 69.80907767516622, 3.772683352479069, 7.1769809981668375, 16.053004779571733, 22.72006524114312, 29.534374330979748, 259.75844595327806, 259.602976455473, 27.85695275698397, 141.7648265003601, 91.84137149849401, 0.9584467794732594, 49.44171435052702, 32.769201957094374, 15.822516912613548, 9.58729384992772, 72.75855484423334, 58.473851262324274, 166.44530361756784, 23.743134581256317, 213.37245212887726, 171.6520568323284, 154.29534784694587, 49.346651927931276, 312.0226646822134, 687.4706497768273, 62.72996055621434, 303.8590153475811, 6.460711729660086, 44.094575720337275, 354.0036282448016, 0.0, 348.498299995362, 55.73323055829452]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.449994378730765, "mean_inference_ms": 4.712142734909284, "mean_action_processing_ms": 2.5291338548173434, "mean_env_wait_ms": 0.9605180676362142, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009495735168457031, "StateBufferConnector_ms": 0.0036535263061523438, "ViewRequirementAgentConnector_ms": 0.11692452430725098}, "num_episodes": 18, "episode_return_max": 385.4, "episode_return_min": -203.91809677328123, "episode_return_mean": 153.98830214587278, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 832000, "num_agent_steps_trained": 832000, "num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 79.38087556172472, "num_env_steps_trained_throughput_per_sec": 79.38087556172472, "timesteps_total": 208000, "num_env_steps_sampled_lifetime": 208000, "num_agent_steps_sampled_lifetime": 832000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 832000, "timers": {"training_iteration_time_ms": 50133.603, "restore_workers_time_ms": 0.013, "training_step_time_ms": 50133.531, "sample_time_ms": 1436.816, "learn_time_ms": 48675.882, "learn_throughput": 82.176, "synch_weights_time_ms": 17.405}, "counters": {"num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_agent_steps_sampled": 832000, "num_agent_steps_trained": 832000}, "done": false, "training_iteration": 52, "trial_id": "cf3bb_00000", "date": "2024-08-20_09-27-43", "timestamp": 1724126263, "time_this_iter_s": 50.4167160987854, "time_total_s": 10526.965029001236, "pid": 25777, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39fe3d3a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 10526.965029001236, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 42.0125, "ram_util_percent": 82.47916666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3170017171631414, "cur_kl_coeff": 0.013348388671874996, "cur_lr": 0.00010000000000000003, "total_loss": 5.905147449553959, "policy_loss": -0.0025970697082657976, "vf_loss": 5.907624241410109, "vf_explained_var": 0.01687931292271488, "kl": 0.009011222698444123, "entropy": 1.2443692399711206, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 99225.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 18.65902578389203, "cur_kl_coeff": 0.0421875, "cur_lr": 0.00010000000000000003, "total_loss": 7.028301336651757, "policy_loss": -0.0024830075246947154, "vf_loss": 7.03043994197139, "vf_explained_var": -0.2988663006081152, "kl": 0.008163759696315814, "entropy": 1.2069127037411644, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 99225.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_agent_steps_sampled": 848000, "num_agent_steps_trained": 848000}, "env_runners": {"episode_reward_max": 385.4, "episode_reward_min": -203.91809677328123, "episode_reward_mean": 122.14637979585683, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -620.6607916566848, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 687.4706497768273}, "policy_reward_mean": {"prey_policy": -73.80198110327665, "predator_policy": 134.87517100120508}, "custom_metrics": {}, "hist_stats": {"episode_reward": [264.51994431962635, 45.200000000000124, 375.6, 150.69999999999933, 180.6999999999994, 254.07925715690976, 36.90000000000007, 182.79999999999944, 79.74494055942814, 104.66761845636103, 142.1999999999997, -102.0590166023517, 181.49999999999946, 385.4, 83.99936679073858, 210.7999999999993, 17.837233247078736, 169.76621645176425, 14.518150156779967, 149.19999999999965, 161.24751865963134, 286.81014129465575, 44.574931863498094, 124.11693547723237, 206.5999999999993, 183.21309252673345, 364.76002110041037, 76.32574516023423, -203.91809677328123, 55.690398990862604, 31.200000000000173, -23.84274886559004, 183.69999999999965, 381.0, 92.12852176804981, 30.500000000000163, 127.61727537822064, 112.68650400285725, 366.91930098343215, 24.673904764359268, 70.22850417811203, 62.42895635168755, 83.43947967641883, 17.72739582869392, 36.70000000000025, 127.22212362790964, 187.79999999999941, 160.73069079725553, 373.6, 39.20000000000029, -92.13303036804359, 77.10000000000004, 33.916116523517054, 60.40000000000014, 319.6779405128691, 159.69999999999942, 108.29999999999936, 146.5716115245361, 111.99999999999966, 15.866226840445007, 173.3999999999995, 316.5, 298.95425793195176, 166.25816613664716, 129.75243567173553, 156.89999999999947, 38.10000000000027, 43.56986034192398, 57.84001669002955, 245.3081133302189, 148.8999999999995, 362.6, 188.29999999999933, 142.49999999999943, 129.29999999999941, 101.34670712700363, 111.43548041068382, 67.34541866480882, 66.92777559378796, 167.0999999999993, 140.15689260808222, 69.61638351527533, 54.17395038083672, -14.287496410923035, 112.52049427430326, 101.09697507101475, 122.5225558311818, 94.19999999999939, 124.09999999999968, -81.5207566551618, 69.20000000000002, -177.3378163096813, 56.49360825186213, 75.99999999999952, 340.25727341548384, 123.30908812054327, -3.3835403031831874, 36.8852144886548, 68.08279157644324, 135.6609574711267], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-67.98134707554473, 128.49013928597952, 9.127160529273057, -486.29590136421575, 195.21556536039918, 149.39310113772052, -40.23538564740306, 30.342999556707028, 3.1060951991852863, 121.72760129039506, 112.70532313886483, -142.5477737261794, 18.925825399754668, -411.32534861443685, 99.24317748570799, -16.286603988629004, -76.58667496886602, -128.05704321823697, 20.000000000000014, -126.20595954651807, -0.7918988860018885, 1.7716289192755912, -165.91171450515856, -580.6007795172661, 108.76221479831432, -0.5852314895621095, 179.17123747762056, 194.09742803812003, -198.86474796261294, -46.406654724600166, 186.18320159652635, -14.593461172789494, -317.0111379560919, -377.5473279346783, -67.22644762789764, -12.509864301877485, -198.18521576570285, -72.28693037496008, 7.882098243058135, 63.88541808293737, 19.013629932785634, 11.549689506174218, 98.10739098897304, 21.54614825219656, -209.12334218656562, -144.80927083585027, -35.21615034457602, -200.52765387161483, -9.45435338639762, 163.50686305304603, 128.74873786003607, -286.6224847849584, 140.31293157237124, 162.9347839316414, -278.03309101479476, 0.8784253003191735, -451.82181335785424, -389.61256075700896, -146.31742779975357, -312.4147302676231, -115.35256869503488, -70.64389272668056, -142.3198469203642, -291.06939939757865, 131.06073287964824, -123.02514465167192, 147.59459111803392, 200.0, -66.05431881810395, -355.57213683438187, -177.81259844469426, -39.42708087769646, -434.0562472517838, 17.812502442664055, -70.80522690647791, -234.24825031146156, 118.7827987075041, 178.77459917761752, -128.91110210598183, -96.73636227826557, -287.1119018729734, -24.48621946737785, -283.852598291221, -174.55633303187798, -52.65114733801449, -303.19320639905624, -14.741968623619742, -49.53589787963512, -56.22167638731857, 18.93836078855526, -28.816924685928797, -60.223856983602076, 106.00579637646557, -83.62545763227851, 50.33562406878253, 18.730690797256027, 184.55866213941067, 158.1356557500557, 10.200723171770967, 19.01611652351682, -157.29628858616516, -192.10147899455453, -91.64865398533857, -133.59969887486986, -3.3386003013104575, -14.166923646902346, -13.136719838039214, -428.97781710671654, 88.48649358341416, 135.29610106403587, -3.1686108790039227, 78.99495507371157, -76.21158262371195, -6.273986786144587, 4.056981544207163, -150.2966277799385, -106.21880480007032, -44.69621073813308, -91.18005690294432, -149.67857731937772, -67.69654453324092, 106.58111396918426, 119.79230279223273, 165.77634513074878, 112.87447770101294, 76.99664294391619, -62.07537178731974, -58.70555191758692, -14.50022025445074, -95.92934878101036, 18.890341083377923, 64.4278978889768, 8.155444376052758, 6.7145698462086045, 20.000000000000014, -28.684579230199013, -117.65129601831069, -343.87010970041007, 93.89750512150171, -18.211171048626895, 37.158628501506044, 18.941553220526743, 123.7634397991452, 156.62564389323342, 18.933308282542054, 143.9568809549167, 52.24144515576665, -40.973851262324025, -55.44530361756782, -5.443134581256295, -298.10789300535174, 14.430091171149869, -101.2484326268854, 9.041913262692438, -531.368853532871, -400.7790422613616, -103.21291444087304, -196.44828586913454, 97.47417275102956, 19.07053979897312, -56.417132906037324, -157.42960273068178, -72.33497180267132, -262.28017523570986, 11.72497413540012, -329.6480820633849, -170.3058881159309, -620.6607916566848, -246.21946154536752, 20.000000000000014, -180.5779545277649, 20.000000000000014, -111.87260790724808, -32.41201737149821, -226.97809970950522, -5.607093781350091, 4.444590018969251, -146.8662750985182, -272.8979416657729, -491.9277797380746, -303.5352687874578, -10.469848164761778, -534.6197527435213, -244.75238838871783, -240.60856751108307, -131.86632456649355, -80.1589888358343, -220.23552468807557, 155.0086681068805, 143.9274754205082, 14.713509907635979, -385.380509493838, -115.99895356666408, -167.87767554175454, -60.64078837698781, -125.05338712482336, -558.7199955633172, -41.42726172745805, 5.562452358520655, -79.76100103367392], "policy_predator_policy_reward": [32.30423028610029, 171.7069218230913, 10.072839470726908, 512.2959013642158, 1.8844346396008005, 29.10689886227948, 56.935385647403294, 103.65700044329297, 15.593904800814682, 40.27239870960495, 19.450863699858846, 264.47084404436526, 0.9741746002453342, 428.32534861443685, 65.75682251429201, 34.08660398862926, 8.750400360957109, 275.638258385574, 13.837424285847689, 197.0361537170318, 53.59423915384027, 87.62603081288596, 0.0, 644.4534774200732, 54.237785201685675, 19.085231489562112, 9.228762522379443, 2.90257196187999, 324.3715439356009, 4.899225542350578, 6.916798403473653, 32.29346117278972, 387.72604033950114, 324.6696587983474, 30.04739566386674, 219.45513271767254, 281.57718909932464, 3.4131071981184515, 72.32041518037353, 5.112068493630922, 2.23388872684615, 128.45031049382578, 28.166357128968023, 138.99024492451815, 398.50754488591434, 0.0, 115.69546360392094, 244.16527608950233, 28.054353386397768, 24.493136946953975, 7.212163306793889, 333.8746761448618, 28.85758325022059, 32.65472234617713, 116.06343777954345, 237.41697309516647, 70.62275010296102, 566.893527238621, 225.93855241573985, 288.48400464249863, 216.3238495429969, 0.8726118787170261, 344.59025014930506, 64.95624730304763, 39.939267120351765, 135.7251446516712, 33.40540888196609, 0.0, 367.88939794340814, 145.86557947712657, 25.77274584944799, 221.96693347294254, 433.19651279914353, 110.66450738819702, 144.31867102019132, 273.421310200605, 46.27929428891354, 23.08260880939699, 49.01262609045241, 201.30874305815277, 364.27029185770937, 17.556333660754035, 103.3193730341156, 417.51851464067073, 37.99121352535234, 401.2926198881369, 13.851935755629054, 68.15332657632004, 73.02167638731817, 0.9616392114447394, 149.43994356274368, 66.82296173469763, 65.99420362353443, 99.42545763227766, 9.011124960111728, 82.65325097110578, 5.841337860589339, 25.064344249944313, 9.099276828228998, 0.8838834764831843, 13.708259375143564, 243.55647783753196, 105.2486539853379, 197.09969887486972, 22.438600301310398, 28.98304017041938, 30.53671983803941, 471.97781710671666, 65.27496975847212, 30.62037610694694, 56.41779537596723, 27.455860429325142, 11.261728889290906, 179.5238405205657, 179.98040433373075, 112.8308534265372, 120.21880480006952, 142.69621073813292, 180.11603893800117, 76.60882212476429, 84.19654453323999, 50.31888603081576, 24.30769720776719, 6.623654869251226, 4.147086314339062, 104.93605097268359, 2.3456461654441156, 284.6934436761103, 8.143664831076972, 232.03833987611998, 69.80907767516622, 3.772683352479069, 7.1769809981668375, 16.053004779571733, 22.72006524114312, 29.534374330979748, 259.75844595327806, 259.602976455473, 27.85695275698397, 141.7648265003601, 91.84137149849401, 0.9584467794732594, 49.44171435052702, 32.769201957094374, 15.822516912613548, 9.58729384992772, 72.75855484423334, 58.473851262324274, 166.44530361756784, 23.743134581256317, 213.37245212887726, 171.6520568323284, 154.29534784694587, 49.346651927931276, 312.0226646822134, 687.4706497768273, 62.72996055621434, 303.8590153475811, 6.460711729660086, 44.094575720337275, 354.0036282448016, 0.0, 348.498299995362, 55.73323055829452, 95.84555296758597, 276.25150534123526, 143.00123163757783, 633.6779517241151, 33.72857800039657, 305.0113778192746, 240.57795452776512, 21.096975071014977, 242.99763074698964, 23.809550362938534, 102.96292101772427, 223.8222724731311, 104.55540998103076, 161.96627509851734, 145.2942091201577, 538.010755628528, 354.53526878745794, 28.669848164761937, 599.681835314309, 2.3524895082488504, 276.6512157260811, 152.3172846033574, 94.1589888358337, 282.23552468807566, 35.724969069095536, 5.596160818999669, 65.84650247993403, 428.12958522681146, 40.955161393205884, 239.53792741202875, 0.9433926234759257, 221.6359973669898, 561.7199955633172, 106.51005330390153, 132.6693508662491, 77.1901552800308]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4374148000849625, "mean_inference_ms": 4.658789719204496, "mean_action_processing_ms": 2.489205380974537, "mean_env_wait_ms": 0.9475342435454713, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00930631160736084, "StateBufferConnector_ms": 0.004895329475402832, "ViewRequirementAgentConnector_ms": 0.12335240840911865}, "num_episodes": 18, "episode_return_max": 385.4, "episode_return_min": -203.91809677328123, "episode_return_mean": 122.14637979585683, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 848000, "num_agent_steps_trained": 848000, "num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 79.59446617359154, "num_env_steps_trained_throughput_per_sec": 79.59446617359154, "timesteps_total": 212000, "num_env_steps_sampled_lifetime": 212000, "num_agent_steps_sampled_lifetime": 848000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 848000, "timers": {"training_iteration_time_ms": 49945.855, "restore_workers_time_ms": 0.013, "training_step_time_ms": 49945.78, "sample_time_ms": 1338.271, "learn_time_ms": 48586.977, "learn_throughput": 82.327, "synch_weights_time_ms": 16.592}, "counters": {"num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_agent_steps_sampled": 848000, "num_agent_steps_trained": 848000}, "done": false, "training_iteration": 53, "trial_id": "cf3bb_00000", "date": "2024-08-20_09-28-34", "timestamp": 1724126314, "time_this_iter_s": 50.288970947265625, "time_total_s": 10577.253999948502, "pid": 25777, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39ffb8e50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 10577.253999948502, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 43.39436619718309, "ram_util_percent": 82.23098591549298}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9566644749234593, "cur_kl_coeff": 0.013348388671874996, "cur_lr": 0.00010000000000000003, "total_loss": 6.068944217288305, "policy_loss": -0.0021049680658887147, "vf_loss": 6.070923732828211, "vf_explained_var": 0.005761937489585271, "kl": 0.009399511601226216, "entropy": 1.2758937399854104, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 101115.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 17.978708582233498, "cur_kl_coeff": 0.0421875, "cur_lr": 0.00010000000000000003, "total_loss": 6.386429510923921, "policy_loss": -0.0024522647727280855, "vf_loss": 6.388565644763765, "vf_explained_var": -0.1818980867585177, "kl": 0.0074934666068976865, "entropy": 1.2378740222365767, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 101115.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_agent_steps_sampled": 864000, "num_agent_steps_trained": 864000}, "env_runners": {"episode_reward_max": 381.0, "episode_reward_min": -203.91809677328123, "episode_reward_mean": 115.85497585415636, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -804.4655116551647, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 805.1655116551648}, "policy_reward_mean": {"prey_policy": -78.5773123120108, "predator_policy": 136.50480023908895}, "custom_metrics": {}, "hist_stats": {"episode_reward": [44.574931863498094, 124.11693547723237, 206.5999999999993, 183.21309252673345, 364.76002110041037, 76.32574516023423, -203.91809677328123, 55.690398990862604, 31.200000000000173, -23.84274886559004, 183.69999999999965, 381.0, 92.12852176804981, 30.500000000000163, 127.61727537822064, 112.68650400285725, 366.91930098343215, 24.673904764359268, 70.22850417811203, 62.42895635168755, 83.43947967641883, 17.72739582869392, 36.70000000000025, 127.22212362790964, 187.79999999999941, 160.73069079725553, 373.6, 39.20000000000029, -92.13303036804359, 77.10000000000004, 33.916116523517054, 60.40000000000014, 319.6779405128691, 159.69999999999942, 108.29999999999936, 146.5716115245361, 111.99999999999966, 15.866226840445007, 173.3999999999995, 316.5, 298.95425793195176, 166.25816613664716, 129.75243567173553, 156.89999999999947, 38.10000000000027, 43.56986034192398, 57.84001669002955, 245.3081133302189, 148.8999999999995, 362.6, 188.29999999999933, 142.49999999999943, 129.29999999999941, 101.34670712700363, 111.43548041068382, 67.34541866480882, 66.92777559378796, 167.0999999999993, 140.15689260808222, 69.61638351527533, 54.17395038083672, -14.287496410923035, 112.52049427430326, 101.09697507101475, 122.5225558311818, 94.19999999999939, 124.09999999999968, -81.5207566551618, 69.20000000000002, -177.3378163096813, 56.49360825186213, 75.99999999999952, 340.25727341548384, 123.30908812054327, -3.3835403031831874, 36.8852144886548, 68.08279157644324, 135.6609574711267, 204.99999999999935, 201.905107500648, 175.17121928068303, 327.05726679529903, 112.6999999999995, 112.32377686235452, 205.6999999999995, 64.10000000000022, 44.00000000000024, 96.89999999999975, 37.48351144519895, 81.15543345416425, -62.69532136818618, 34.70000000000022, 202.99999999999932, 376.7, 16.86000256501718, 83.79999999999964, 204.5999999999994, 125.7, 12.229979785398365, 88.5999999999998], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-209.12334218656562, -144.80927083585027, -35.21615034457602, -200.52765387161483, -9.45435338639762, 163.50686305304603, 128.74873786003607, -286.6224847849584, 140.31293157237124, 162.9347839316414, -278.03309101479476, 0.8784253003191735, -451.82181335785424, -389.61256075700896, -146.31742779975357, -312.4147302676231, -115.35256869503488, -70.64389272668056, -142.3198469203642, -291.06939939757865, 131.06073287964824, -123.02514465167192, 147.59459111803392, 200.0, -66.05431881810395, -355.57213683438187, -177.81259844469426, -39.42708087769646, -434.0562472517838, 17.812502442664055, -70.80522690647791, -234.24825031146156, 118.7827987075041, 178.77459917761752, -128.91110210598183, -96.73636227826557, -287.1119018729734, -24.48621946737785, -283.852598291221, -174.55633303187798, -52.65114733801449, -303.19320639905624, -14.741968623619742, -49.53589787963512, -56.22167638731857, 18.93836078855526, -28.816924685928797, -60.223856983602076, 106.00579637646557, -83.62545763227851, 50.33562406878253, 18.730690797256027, 184.55866213941067, 158.1356557500557, 10.200723171770967, 19.01611652351682, -157.29628858616516, -192.10147899455453, -91.64865398533857, -133.59969887486986, -3.3386003013104575, -14.166923646902346, -13.136719838039214, -428.97781710671654, 88.48649358341416, 135.29610106403587, -3.1686108790039227, 78.99495507371157, -76.21158262371195, -6.273986786144587, 4.056981544207163, -150.2966277799385, -106.21880480007032, -44.69621073813308, -91.18005690294432, -149.67857731937772, -67.69654453324092, 106.58111396918426, 119.79230279223273, 165.77634513074878, 112.87447770101294, 76.99664294391619, -62.07537178731974, -58.70555191758692, -14.50022025445074, -95.92934878101036, 18.890341083377923, 64.4278978889768, 8.155444376052758, 6.7145698462086045, 20.000000000000014, -28.684579230199013, -117.65129601831069, -343.87010970041007, 93.89750512150171, -18.211171048626895, 37.158628501506044, 18.941553220526743, 123.7634397991452, 156.62564389323342, 18.933308282542054, 143.9568809549167, 52.24144515576665, -40.973851262324025, -55.44530361756782, -5.443134581256295, -298.10789300535174, 14.430091171149869, -101.2484326268854, 9.041913262692438, -531.368853532871, -400.7790422613616, -103.21291444087304, -196.44828586913454, 97.47417275102956, 19.07053979897312, -56.417132906037324, -157.42960273068178, -72.33497180267132, -262.28017523570986, 11.72497413540012, -329.6480820633849, -170.3058881159309, -620.6607916566848, -246.21946154536752, 20.000000000000014, -180.5779545277649, 20.000000000000014, -111.87260790724808, -32.41201737149821, -226.97809970950522, -5.607093781350091, 4.444590018969251, -146.8662750985182, -272.8979416657729, -491.9277797380746, -303.5352687874578, -10.469848164761778, -534.6197527435213, -244.75238838871783, -240.60856751108307, -131.86632456649355, -80.1589888358343, -220.23552468807557, 155.0086681068805, 143.9274754205082, 14.713509907635979, -385.380509493838, -115.99895356666408, -167.87767554175454, -60.64078837698781, -125.05338712482336, -558.7199955633172, -41.42726172745805, 5.562452358520655, -79.76100103367392, -13.454865288730247, 169.20227585170915, -65.84964860780059, 65.42525119472013, -81.62119218042967, 127.27361997346448, 132.7375365187392, 122.05679464096835, -46.47367839744105, -36.74586675656422, -167.11554306151436, -54.34000473463309, 190.49815340547224, -134.28935687959964, -282.467256918355, 10.031121933303892, -16.822068680143907, -425.9372239546531, -67.14120973813681, -165.74112299731405, 10.949393262329293, 14.392804761989431, -222.24294049960133, -60.28579476787441, -184.97947757906826, -276.0460879094474, -61.83981640807902, -54.87063889778966, -72.41508635278834, 174.0360882545253, 148.15755744514266, 189.58622515941045, -154.0687079582573, -378.87415096631173, 6.961306263980122, -17.42332435219295, -153.44737290631485, 183.57808045568194, -14.337390854068486, -804.4655116551647, -49.599338796489995, -82.54684426830306, -136.30538672524045, 13.998082074780791], "policy_predator_policy_reward": [398.50754488591434, 0.0, 115.69546360392094, 244.16527608950233, 28.054353386397768, 24.493136946953975, 7.212163306793889, 333.8746761448618, 28.85758325022059, 32.65472234617713, 116.06343777954345, 237.41697309516647, 70.62275010296102, 566.893527238621, 225.93855241573985, 288.48400464249863, 216.3238495429969, 0.8726118787170261, 344.59025014930506, 64.95624730304763, 39.939267120351765, 135.7251446516712, 33.40540888196609, 0.0, 367.88939794340814, 145.86557947712657, 25.77274584944799, 221.96693347294254, 433.19651279914353, 110.66450738819702, 144.31867102019132, 273.421310200605, 46.27929428891354, 23.08260880939699, 49.01262609045241, 201.30874305815277, 364.27029185770937, 17.556333660754035, 103.3193730341156, 417.51851464067073, 37.99121352535234, 401.2926198881369, 13.851935755629054, 68.15332657632004, 73.02167638731817, 0.9616392114447394, 149.43994356274368, 66.82296173469763, 65.99420362353443, 99.42545763227766, 9.011124960111728, 82.65325097110578, 5.841337860589339, 25.064344249944313, 9.099276828228998, 0.8838834764831843, 13.708259375143564, 243.55647783753196, 105.2486539853379, 197.09969887486972, 22.438600301310398, 28.98304017041938, 30.53671983803941, 471.97781710671666, 65.27496975847212, 30.62037610694694, 56.41779537596723, 27.455860429325142, 11.261728889290906, 179.5238405205657, 179.98040433373075, 112.8308534265372, 120.21880480006952, 142.69621073813292, 180.11603893800117, 76.60882212476429, 84.19654453323999, 50.31888603081576, 24.30769720776719, 6.623654869251226, 4.147086314339062, 104.93605097268359, 2.3456461654441156, 284.6934436761103, 8.143664831076972, 232.03833987611998, 69.80907767516622, 3.772683352479069, 7.1769809981668375, 16.053004779571733, 22.72006524114312, 29.534374330979748, 259.75844595327806, 259.602976455473, 27.85695275698397, 141.7648265003601, 91.84137149849401, 0.9584467794732594, 49.44171435052702, 32.769201957094374, 15.822516912613548, 9.58729384992772, 72.75855484423334, 58.473851262324274, 166.44530361756784, 23.743134581256317, 213.37245212887726, 171.6520568323284, 154.29534784694587, 49.346651927931276, 312.0226646822134, 687.4706497768273, 62.72996055621434, 303.8590153475811, 6.460711729660086, 44.094575720337275, 354.0036282448016, 0.0, 348.498299995362, 55.73323055829452, 95.84555296758597, 276.25150534123526, 143.00123163757783, 633.6779517241151, 33.72857800039657, 305.0113778192746, 240.57795452776512, 21.096975071014977, 242.99763074698964, 23.809550362938534, 102.96292101772427, 223.8222724731311, 104.55540998103076, 161.96627509851734, 145.2942091201577, 538.010755628528, 354.53526878745794, 28.669848164761937, 599.681835314309, 2.3524895082488504, 276.6512157260811, 152.3172846033574, 94.1589888358337, 282.23552468807566, 35.724969069095536, 5.596160818999669, 65.84650247993403, 428.12958522681146, 40.955161393205884, 239.53792741202875, 0.9433926234759257, 221.6359973669898, 561.7199955633172, 106.51005330390153, 132.6693508662491, 77.1901552800308, 31.15486528873044, 18.09772414829084, 47.73369580304018, 154.59580911068832, 43.62681058117876, 85.8919809064696, 54.52740448836589, 17.735531147225615, 62.47367839744102, 133.44586675656424, 78.8907443697943, 254.88858028870752, 4.501846594527759, 144.98935687959914, 34.01840203548553, 302.5177329495656, 34.82206868014415, 451.9372239546532, 146.6023409412672, 183.17999179418283, 8.76068978754935, 3.3806236333305417, 248.22862124820819, 115.455547473431, 398.33024412032927, 0.0, 79.33981640807818, 72.07063889778934, 88.41508635278743, 12.96391174547468, 35.24244255485735, 3.713774840589562, 230.88871896859092, 318.9141425209956, 67.63195124484307, 26.630066843369807, 165.74737290631415, 8.72191954431805, 139.3373908540684, 805.1655116551648, 141.3950763329512, 2.9810865172394427, 205.3053867252404, 5.601917925219173]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4254663589057481, "mean_inference_ms": 4.588627449220639, "mean_action_processing_ms": 2.4445474193782077, "mean_env_wait_ms": 0.9351714570544607, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009214043617248535, "StateBufferConnector_ms": 0.004896640777587891, "ViewRequirementAgentConnector_ms": 0.12179183959960938}, "num_episodes": 22, "episode_return_max": 381.0, "episode_return_min": -203.91809677328123, "episode_return_mean": 115.85497585415636, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 864000, "num_agent_steps_trained": 864000, "num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 83.19285020187358, "num_env_steps_trained_throughput_per_sec": 83.19285020187358, "timesteps_total": 216000, "num_env_steps_sampled_lifetime": 216000, "num_agent_steps_sampled_lifetime": 864000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 864000, "timers": {"training_iteration_time_ms": 49500.627, "restore_workers_time_ms": 0.014, "training_step_time_ms": 49500.562, "sample_time_ms": 1337.591, "learn_time_ms": 48143.164, "learn_throughput": 83.086, "synch_weights_time_ms": 16.008}, "counters": {"num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_agent_steps_sampled": 864000, "num_agent_steps_trained": 864000}, "done": false, "training_iteration": 54, "trial_id": "cf3bb_00000", "date": "2024-08-20_09-29-22", "timestamp": 1724126362, "time_this_iter_s": 48.12367606163025, "time_total_s": 10625.377676010132, "pid": 25777, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39f782d30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 10625.377676010132, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 37.189855072463764, "ram_util_percent": 82.4710144927536}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4777578067842614, "cur_kl_coeff": 0.013348388671874996, "cur_lr": 0.00010000000000000003, "total_loss": 6.5305988553970575, "policy_loss": -0.003263097047490418, "vf_loss": 6.5337698023155255, "vf_explained_var": 0.020342717378858535, "kl": 0.006902832094680567, "entropy": 1.2799150155965613, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 103005.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.991146940812863, "cur_kl_coeff": 0.0421875, "cur_lr": 0.00010000000000000003, "total_loss": 7.933910529071061, "policy_loss": -0.0030133394145027354, "vf_loss": 7.936576703238109, "vf_explained_var": -0.20551390666810293, "kl": 0.00822933401364499, "entropy": 1.2061573637856378, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 103005.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_agent_steps_sampled": 880000, "num_agent_steps_trained": 880000}, "env_runners": {"episode_reward_max": 376.7, "episode_reward_min": -226.4860897051025, "episode_reward_mean": 104.49723949669082, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -804.4655116551647, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 198.04550425271512, "predator_policy": 805.1655116551648}, "policy_reward_mean": {"prey_policy": -89.53797426586566, "predator_policy": 141.78659401421112}, "custom_metrics": {}, "hist_stats": {"episode_reward": [127.22212362790964, 187.79999999999941, 160.73069079725553, 373.6, 39.20000000000029, -92.13303036804359, 77.10000000000004, 33.916116523517054, 60.40000000000014, 319.6779405128691, 159.69999999999942, 108.29999999999936, 146.5716115245361, 111.99999999999966, 15.866226840445007, 173.3999999999995, 316.5, 298.95425793195176, 166.25816613664716, 129.75243567173553, 156.89999999999947, 38.10000000000027, 43.56986034192398, 57.84001669002955, 245.3081133302189, 148.8999999999995, 362.6, 188.29999999999933, 142.49999999999943, 129.29999999999941, 101.34670712700363, 111.43548041068382, 67.34541866480882, 66.92777559378796, 167.0999999999993, 140.15689260808222, 69.61638351527533, 54.17395038083672, -14.287496410923035, 112.52049427430326, 101.09697507101475, 122.5225558311818, 94.19999999999939, 124.09999999999968, -81.5207566551618, 69.20000000000002, -177.3378163096813, 56.49360825186213, 75.99999999999952, 340.25727341548384, 123.30908812054327, -3.3835403031831874, 36.8852144886548, 68.08279157644324, 135.6609574711267, 204.99999999999935, 201.905107500648, 175.17121928068303, 327.05726679529903, 112.6999999999995, 112.32377686235452, 205.6999999999995, 64.10000000000022, 44.00000000000024, 96.89999999999975, 37.48351144519895, 81.15543345416425, -62.69532136818618, 34.70000000000022, 202.99999999999932, 376.7, 16.86000256501718, 83.79999999999964, 204.5999999999994, 125.7, 12.229979785398365, 88.5999999999998, 226.0247684437508, 167.7999999999998, 18.251788619055233, -226.4860897051025, 19.689218573181105, 91.49999999999997, 88.69999999999939, 72.79999999999998, 178.59999999999937, -19.65342369055839, 221.4477134136766, 138.81961784957562, -78.8674001439853, -90.27715789818895, -78.1256632963782, -28.60887388255018, 49.00000000000006, 93.29999999999987, -39.998361327163835, 55.30000000000005, 115.15463100799344, 208.02571870207257, 130.29999999999941], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-28.816924685928797, -60.223856983602076, 106.00579637646557, -83.62545763227851, 50.33562406878253, 18.730690797256027, 184.55866213941067, 158.1356557500557, 10.200723171770967, 19.01611652351682, -157.29628858616516, -192.10147899455453, -91.64865398533857, -133.59969887486986, -3.3386003013104575, -14.166923646902346, -13.136719838039214, -428.97781710671654, 88.48649358341416, 135.29610106403587, -3.1686108790039227, 78.99495507371157, -76.21158262371195, -6.273986786144587, 4.056981544207163, -150.2966277799385, -106.21880480007032, -44.69621073813308, -91.18005690294432, -149.67857731937772, -67.69654453324092, 106.58111396918426, 119.79230279223273, 165.77634513074878, 112.87447770101294, 76.99664294391619, -62.07537178731974, -58.70555191758692, -14.50022025445074, -95.92934878101036, 18.890341083377923, 64.4278978889768, 8.155444376052758, 6.7145698462086045, 20.000000000000014, -28.684579230199013, -117.65129601831069, -343.87010970041007, 93.89750512150171, -18.211171048626895, 37.158628501506044, 18.941553220526743, 123.7634397991452, 156.62564389323342, 18.933308282542054, 143.9568809549167, 52.24144515576665, -40.973851262324025, -55.44530361756782, -5.443134581256295, -298.10789300535174, 14.430091171149869, -101.2484326268854, 9.041913262692438, -531.368853532871, -400.7790422613616, -103.21291444087304, -196.44828586913454, 97.47417275102956, 19.07053979897312, -56.417132906037324, -157.42960273068178, -72.33497180267132, -262.28017523570986, 11.72497413540012, -329.6480820633849, -170.3058881159309, -620.6607916566848, -246.21946154536752, 20.000000000000014, -180.5779545277649, 20.000000000000014, -111.87260790724808, -32.41201737149821, -226.97809970950522, -5.607093781350091, 4.444590018969251, -146.8662750985182, -272.8979416657729, -491.9277797380746, -303.5352687874578, -10.469848164761778, -534.6197527435213, -244.75238838871783, -240.60856751108307, -131.86632456649355, -80.1589888358343, -220.23552468807557, 155.0086681068805, 143.9274754205082, 14.713509907635979, -385.380509493838, -115.99895356666408, -167.87767554175454, -60.64078837698781, -125.05338712482336, -558.7199955633172, -41.42726172745805, 5.562452358520655, -79.76100103367392, -13.454865288730247, 169.20227585170915, -65.84964860780059, 65.42525119472013, -81.62119218042967, 127.27361997346448, 132.7375365187392, 122.05679464096835, -46.47367839744105, -36.74586675656422, -167.11554306151436, -54.34000473463309, 190.49815340547224, -134.28935687959964, -282.467256918355, 10.031121933303892, -16.822068680143907, -425.9372239546531, -67.14120973813681, -165.74112299731405, 10.949393262329293, 14.392804761989431, -222.24294049960133, -60.28579476787441, -184.97947757906826, -276.0460879094474, -61.83981640807902, -54.87063889778966, -72.41508635278834, 174.0360882545253, 148.15755744514266, 189.58622515941045, -154.0687079582573, -378.87415096631173, 6.961306263980122, -17.42332435219295, -153.44737290631485, 183.57808045568194, -14.337390854068486, -804.4655116551647, -49.599338796489995, -82.54684426830306, -136.30538672524045, 13.998082074780791, 34.4927699931039, -19.959647837772806, 115.90900087902078, -284.50643843617087, -236.2314810586069, -89.72347687262996, -341.84385904642954, -363.4668759303478, -116.23638081222798, -177.25771085770344, 14.540076639223498, -91.65888382657855, 2.7245307573552284, -219.70917455520146, 17.428919080390816, -133.53276510663878, 123.89146661403304, -87.80528533613239, -76.50334496668282, -204.2691947768754, -253.28415248478615, 198.04550425271512, 12.56795102384624, -307.826822789362, -117.41437032312103, -227.14632695884498, -518.4279814638408, -468.37691170403997, -279.8772121110214, -165.43585516515714, -326.3972243768504, -416.1754947452861, -263.9836094717841, -58.01225394066162, -0.526798444572461, -87.98055906489289, -245.3120277488179, -257.7062275904331, -208.4524275962498, -27.0217366719749, -221.62877200975018, -298.58551580060816, 132.84743540051753, -167.5739179328557, -94.33595619629835, -37.386048686801495], "policy_predator_policy_reward": [149.43994356274368, 66.82296173469763, 65.99420362353443, 99.42545763227766, 9.011124960111728, 82.65325097110578, 5.841337860589339, 25.064344249944313, 9.099276828228998, 0.8838834764831843, 13.708259375143564, 243.55647783753196, 105.2486539853379, 197.09969887486972, 22.438600301310398, 28.98304017041938, 30.53671983803941, 471.97781710671666, 65.27496975847212, 30.62037610694694, 56.41779537596723, 27.455860429325142, 11.261728889290906, 179.5238405205657, 179.98040433373075, 112.8308534265372, 120.21880480006952, 142.69621073813292, 180.11603893800117, 76.60882212476429, 84.19654453323999, 50.31888603081576, 24.30769720776719, 6.623654869251226, 4.147086314339062, 104.93605097268359, 2.3456461654441156, 284.6934436761103, 8.143664831076972, 232.03833987611998, 69.80907767516622, 3.772683352479069, 7.1769809981668375, 16.053004779571733, 22.72006524114312, 29.534374330979748, 259.75844595327806, 259.602976455473, 27.85695275698397, 141.7648265003601, 91.84137149849401, 0.9584467794732594, 49.44171435052702, 32.769201957094374, 15.822516912613548, 9.58729384992772, 72.75855484423334, 58.473851262324274, 166.44530361756784, 23.743134581256317, 213.37245212887726, 171.6520568323284, 154.29534784694587, 49.346651927931276, 312.0226646822134, 687.4706497768273, 62.72996055621434, 303.8590153475811, 6.460711729660086, 44.094575720337275, 354.0036282448016, 0.0, 348.498299995362, 55.73323055829452, 95.84555296758597, 276.25150534123526, 143.00123163757783, 633.6779517241151, 33.72857800039657, 305.0113778192746, 240.57795452776512, 21.096975071014977, 242.99763074698964, 23.809550362938534, 102.96292101772427, 223.8222724731311, 104.55540998103076, 161.96627509851734, 145.2942091201577, 538.010755628528, 354.53526878745794, 28.669848164761937, 599.681835314309, 2.3524895082488504, 276.6512157260811, 152.3172846033574, 94.1589888358337, 282.23552468807566, 35.724969069095536, 5.596160818999669, 65.84650247993403, 428.12958522681146, 40.955161393205884, 239.53792741202875, 0.9433926234759257, 221.6359973669898, 561.7199955633172, 106.51005330390153, 132.6693508662491, 77.1901552800308, 31.15486528873044, 18.09772414829084, 47.73369580304018, 154.59580911068832, 43.62681058117876, 85.8919809064696, 54.52740448836589, 17.735531147225615, 62.47367839744102, 133.44586675656424, 78.8907443697943, 254.88858028870752, 4.501846594527759, 144.98935687959914, 34.01840203548553, 302.5177329495656, 34.82206868014415, 451.9372239546532, 146.6023409412672, 183.17999179418283, 8.76068978754935, 3.3806236333305417, 248.22862124820819, 115.455547473431, 398.33024412032927, 0.0, 79.33981640807818, 72.07063889778934, 88.41508635278743, 12.96391174547468, 35.24244255485735, 3.713774840589562, 230.88871896859092, 318.9141425209956, 67.63195124484307, 26.630066843369807, 165.74737290631415, 8.72191954431805, 139.3373908540684, 805.1655116551648, 141.3950763329512, 2.9810865172394427, 205.3053867252404, 5.601917925219173, 58.76860987889216, 152.72303640952742, 48.090999120979305, 288.3064384361715, 320.4661914772691, 23.74055507302278, 168.83151260992085, 309.99313266175756, 54.83531634694575, 258.3479938961668, 4.95992336077647, 163.65888382657826, 15.975469242644733, 289.7091745552018, 2.371080919609164, 186.53276510663903, 40.10853338596695, 102.40528533613156, 7.15730036498254, 253.9618156880173, 140.0347127374855, 136.65164890826512, 183.44037771042795, 250.63811190466402, 178.50987430367448, 87.18342283430628, 512.44129233785, 384.086442931842, 12.494397256034526, 354.6930067237659, 342.17941246924, 371.78443277034654, 297.9836094717841, 73.01225394066165, 174.24678823143407, 7.560569278031051, 150.9790639148384, 312.0408300972488, 246.4524275962498, 44.321736671975145, 283.538338021812, 351.8305807965395, 19.26549331930255, 223.48670791510818, 208.33595619629853, 53.686048686801726]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4069271198575652, "mean_inference_ms": 4.530477152218347, "mean_action_processing_ms": 2.3950177826085066, "mean_env_wait_ms": 0.9167039817483907, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005266308784484863, "StateBufferConnector_ms": 0.004701018333435059, "ViewRequirementAgentConnector_ms": 0.11043226718902588}, "num_episodes": 23, "episode_return_max": 376.7, "episode_return_min": -226.4860897051025, "episode_return_mean": 104.49723949669082, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 880000, "num_agent_steps_trained": 880000, "num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 81.68845471330619, "num_env_steps_trained_throughput_per_sec": 81.68845471330619, "timesteps_total": 220000, "num_env_steps_sampled_lifetime": 220000, "num_agent_steps_sampled_lifetime": 880000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 880000, "timers": {"training_iteration_time_ms": 49596.163, "restore_workers_time_ms": 0.014, "training_step_time_ms": 49596.099, "sample_time_ms": 1321.036, "learn_time_ms": 48255.469, "learn_throughput": 82.892, "synch_weights_time_ms": 15.859}, "counters": {"num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_agent_steps_sampled": 880000, "num_agent_steps_trained": 880000}, "done": false, "training_iteration": 55, "trial_id": "cf3bb_00000", "date": "2024-08-20_09-30-11", "timestamp": 1724126411, "time_this_iter_s": 48.99019002914429, "time_total_s": 10674.367866039276, "pid": 25777, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39f78f160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 10674.367866039276, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 40.457971014492756, "ram_util_percent": 82.01304347826088}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.8581148102958367, "cur_kl_coeff": 0.013348388671874996, "cur_lr": 0.00010000000000000003, "total_loss": 6.0584658605081065, "policy_loss": -0.008770352647585607, "vf_loss": 6.066940851312466, "vf_explained_var": 0.004749036497539944, "kl": 0.022127718334031307, "entropy": 1.304182921263276, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 104895.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 17.869661765313023, "cur_kl_coeff": 0.0421875, "cur_lr": 0.00010000000000000003, "total_loss": 7.780093948929398, "policy_loss": -0.0023433595347568076, "vf_loss": 7.7820299373101935, "vf_explained_var": 0.18577465869131543, "kl": 0.00965653830616269, "entropy": 1.1239338134331678, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 104895.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_agent_steps_sampled": 896000, "num_agent_steps_trained": 896000}, "env_runners": {"episode_reward_max": 380.8, "episode_reward_min": -226.4860897051025, "episode_reward_mean": 97.51627374835732, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1095.504848430838, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 198.04550425271512, "predator_policy": 1095.504848430838}, "policy_reward_mean": {"prey_policy": -120.0288669048835, "predator_policy": 168.78700377906225}, "custom_metrics": {}, "hist_stats": {"episode_reward": [166.25816613664716, 129.75243567173553, 156.89999999999947, 38.10000000000027, 43.56986034192398, 57.84001669002955, 245.3081133302189, 148.8999999999995, 362.6, 188.29999999999933, 142.49999999999943, 129.29999999999941, 101.34670712700363, 111.43548041068382, 67.34541866480882, 66.92777559378796, 167.0999999999993, 140.15689260808222, 69.61638351527533, 54.17395038083672, -14.287496410923035, 112.52049427430326, 101.09697507101475, 122.5225558311818, 94.19999999999939, 124.09999999999968, -81.5207566551618, 69.20000000000002, -177.3378163096813, 56.49360825186213, 75.99999999999952, 340.25727341548384, 123.30908812054327, -3.3835403031831874, 36.8852144886548, 68.08279157644324, 135.6609574711267, 204.99999999999935, 201.905107500648, 175.17121928068303, 327.05726679529903, 112.6999999999995, 112.32377686235452, 205.6999999999995, 64.10000000000022, 44.00000000000024, 96.89999999999975, 37.48351144519895, 81.15543345416425, -62.69532136818618, 34.70000000000022, 202.99999999999932, 376.7, 16.86000256501718, 83.79999999999964, 204.5999999999994, 125.7, 12.229979785398365, 88.5999999999998, 226.0247684437508, 167.7999999999998, 18.251788619055233, -226.4860897051025, 19.689218573181105, 91.49999999999997, 88.69999999999939, 72.79999999999998, 178.59999999999937, -19.65342369055839, 221.4477134136766, 138.81961784957562, -78.8674001439853, -90.27715789818895, -78.1256632963782, -28.60887388255018, 49.00000000000006, 93.29999999999987, -39.998361327163835, 55.30000000000005, 115.15463100799344, 208.02571870207257, 130.29999999999941, -31.72461524695493, 186.3588558962258, -14.491337568194016, 137.79999999999995, 131.09999999999937, 211.10833166812733, 89.5548826887298, 380.8, 128.09999999999974, 92.0, 56.46683245877613, 75.39999999999998, 27.523295997987386, -74.62303458229306, 248.19565789996366, 19.340493344722546, 50.00000000000001, 207.7999999999993], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-62.07537178731974, -58.70555191758692, -14.50022025445074, -95.92934878101036, 18.890341083377923, 64.4278978889768, 8.155444376052758, 6.7145698462086045, 20.000000000000014, -28.684579230199013, -117.65129601831069, -343.87010970041007, 93.89750512150171, -18.211171048626895, 37.158628501506044, 18.941553220526743, 123.7634397991452, 156.62564389323342, 18.933308282542054, 143.9568809549167, 52.24144515576665, -40.973851262324025, -55.44530361756782, -5.443134581256295, -298.10789300535174, 14.430091171149869, -101.2484326268854, 9.041913262692438, -531.368853532871, -400.7790422613616, -103.21291444087304, -196.44828586913454, 97.47417275102956, 19.07053979897312, -56.417132906037324, -157.42960273068178, -72.33497180267132, -262.28017523570986, 11.72497413540012, -329.6480820633849, -170.3058881159309, -620.6607916566848, -246.21946154536752, 20.000000000000014, -180.5779545277649, 20.000000000000014, -111.87260790724808, -32.41201737149821, -226.97809970950522, -5.607093781350091, 4.444590018969251, -146.8662750985182, -272.8979416657729, -491.9277797380746, -303.5352687874578, -10.469848164761778, -534.6197527435213, -244.75238838871783, -240.60856751108307, -131.86632456649355, -80.1589888358343, -220.23552468807557, 155.0086681068805, 143.9274754205082, 14.713509907635979, -385.380509493838, -115.99895356666408, -167.87767554175454, -60.64078837698781, -125.05338712482336, -558.7199955633172, -41.42726172745805, 5.562452358520655, -79.76100103367392, -13.454865288730247, 169.20227585170915, -65.84964860780059, 65.42525119472013, -81.62119218042967, 127.27361997346448, 132.7375365187392, 122.05679464096835, -46.47367839744105, -36.74586675656422, -167.11554306151436, -54.34000473463309, 190.49815340547224, -134.28935687959964, -282.467256918355, 10.031121933303892, -16.822068680143907, -425.9372239546531, -67.14120973813681, -165.74112299731405, 10.949393262329293, 14.392804761989431, -222.24294049960133, -60.28579476787441, -184.97947757906826, -276.0460879094474, -61.83981640807902, -54.87063889778966, -72.41508635278834, 174.0360882545253, 148.15755744514266, 189.58622515941045, -154.0687079582573, -378.87415096631173, 6.961306263980122, -17.42332435219295, -153.44737290631485, 183.57808045568194, -14.337390854068486, -804.4655116551647, -49.599338796489995, -82.54684426830306, -136.30538672524045, 13.998082074780791, 34.4927699931039, -19.959647837772806, 115.90900087902078, -284.50643843617087, -236.2314810586069, -89.72347687262996, -341.84385904642954, -363.4668759303478, -116.23638081222798, -177.25771085770344, 14.540076639223498, -91.65888382657855, 2.7245307573552284, -219.70917455520146, 17.428919080390816, -133.53276510663878, 123.89146661403304, -87.80528533613239, -76.50334496668282, -204.2691947768754, -253.28415248478615, 198.04550425271512, 12.56795102384624, -307.826822789362, -117.41437032312103, -227.14632695884498, -518.4279814638408, -468.37691170403997, -279.8772121110214, -165.43585516515714, -326.3972243768504, -416.1754947452861, -263.9836094717841, -58.01225394066162, -0.526798444572461, -87.98055906489289, -245.3120277488179, -257.7062275904331, -208.4524275962498, -27.0217366719749, -221.62877200975018, -298.58551580060816, 132.84743540051753, -167.5739179328557, -94.33595619629835, -37.386048686801495, -326.76815265980565, -417.7942785030481, -1.898323141951213, -3.2473455835867284, -131.75647313747564, -217.26961871131869, -29.25405011635715, -161.60900216290398, -83.00779532519356, -55.00800475845119, 193.97748693419004, -121.51080591678041, -354.6626223458782, 20.000000000000014, 195.31226065907003, 182.48405329656762, -30.041632807587604, -117.13525569433418, -987.4315548135141, -146.44918311267259, -103.43627820780455, -102.6391947625295, -975.8510608792182, -130.60604411136984, -197.90254683076873, -304.58659129792375, -168.479840429428, -235.28298295300888, 79.28391732587923, 33.43839429705933, -332.996487084253, -265.5756152560191, -1095.504848430838, -277.6850409282788, 190.80783196463398, -84.60658268722341], "policy_predator_policy_reward": [2.3456461654441156, 284.6934436761103, 8.143664831076972, 232.03833987611998, 69.80907767516622, 3.772683352479069, 7.1769809981668375, 16.053004779571733, 22.72006524114312, 29.534374330979748, 259.75844595327806, 259.602976455473, 27.85695275698397, 141.7648265003601, 91.84137149849401, 0.9584467794732594, 49.44171435052702, 32.769201957094374, 15.822516912613548, 9.58729384992772, 72.75855484423334, 58.473851262324274, 166.44530361756784, 23.743134581256317, 213.37245212887726, 171.6520568323284, 154.29534784694587, 49.346651927931276, 312.0226646822134, 687.4706497768273, 62.72996055621434, 303.8590153475811, 6.460711729660086, 44.094575720337275, 354.0036282448016, 0.0, 348.498299995362, 55.73323055829452, 95.84555296758597, 276.25150534123526, 143.00123163757783, 633.6779517241151, 33.72857800039657, 305.0113778192746, 240.57795452776512, 21.096975071014977, 242.99763074698964, 23.809550362938534, 102.96292101772427, 223.8222724731311, 104.55540998103076, 161.96627509851734, 145.2942091201577, 538.010755628528, 354.53526878745794, 28.669848164761937, 599.681835314309, 2.3524895082488504, 276.6512157260811, 152.3172846033574, 94.1589888358337, 282.23552468807566, 35.724969069095536, 5.596160818999669, 65.84650247993403, 428.12958522681146, 40.955161393205884, 239.53792741202875, 0.9433926234759257, 221.6359973669898, 561.7199955633172, 106.51005330390153, 132.6693508662491, 77.1901552800308, 31.15486528873044, 18.09772414829084, 47.73369580304018, 154.59580911068832, 43.62681058117876, 85.8919809064696, 54.52740448836589, 17.735531147225615, 62.47367839744102, 133.44586675656424, 78.8907443697943, 254.88858028870752, 4.501846594527759, 144.98935687959914, 34.01840203548553, 302.5177329495656, 34.82206868014415, 451.9372239546532, 146.6023409412672, 183.17999179418283, 8.76068978754935, 3.3806236333305417, 248.22862124820819, 115.455547473431, 398.33024412032927, 0.0, 79.33981640807818, 72.07063889778934, 88.41508635278743, 12.96391174547468, 35.24244255485735, 3.713774840589562, 230.88871896859092, 318.9141425209956, 67.63195124484307, 26.630066843369807, 165.74737290631415, 8.72191954431805, 139.3373908540684, 805.1655116551648, 141.3950763329512, 2.9810865172394427, 205.3053867252404, 5.601917925219173, 58.76860987889216, 152.72303640952742, 48.090999120979305, 288.3064384361715, 320.4661914772691, 23.74055507302278, 168.83151260992085, 309.99313266175756, 54.83531634694575, 258.3479938961668, 4.95992336077647, 163.65888382657826, 15.975469242644733, 289.7091745552018, 2.371080919609164, 186.53276510663903, 40.10853338596695, 102.40528533613156, 7.15730036498254, 253.9618156880173, 140.0347127374855, 136.65164890826512, 183.44037771042795, 250.63811190466402, 178.50987430367448, 87.18342283430628, 512.44129233785, 384.086442931842, 12.494397256034526, 354.6930067237659, 342.17941246924, 371.78443277034654, 297.9836094717841, 73.01225394066165, 174.24678823143407, 7.560569278031051, 150.9790639148384, 312.0408300972488, 246.4524275962498, 44.321736671975145, 283.538338021812, 351.8305807965395, 19.26549331930255, 223.48670791510818, 208.33595619629853, 53.686048686801726, 391.3220087889232, 321.515807126975, 178.65775111621383, 12.846773505549994, 2.14762331031352, 332.3871309702866, 158.25405011635715, 170.4090021629039, 198.00779532519357, 71.10800475845092, 40.30650251310307, 98.33514813761452, 353.7827212799458, 70.4347837546624, 0.9877393409299676, 2.015946703432381, 44.48998237813831, 230.78690612378375, 987.4315548135141, 238.44918311267264, 262.54230542911034, 0.0, 975.9510608792182, 205.9060441113697, 183.67899810412504, 346.3334360225543, 315.67308156921865, 13.466707230925316, 57.847024013404535, 77.62632226362051, 348.1011813953601, 269.81141428963446, 1095.504848430838, 327.68504092827885, 0.9921680353660393, 100.60658268722254]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3943725405524423, "mean_inference_ms": 4.479627167561198, "mean_action_processing_ms": 2.359121824220514, "mean_env_wait_ms": 0.9047071652335721, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004961371421813965, "StateBufferConnector_ms": 0.00454401969909668, "ViewRequirementAgentConnector_ms": 0.1044011116027832}, "num_episodes": 18, "episode_return_max": 380.8, "episode_return_min": -226.4860897051025, "episode_return_mean": 97.51627374835732, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 896000, "num_agent_steps_trained": 896000, "num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 82.53592920780284, "num_env_steps_trained_throughput_per_sec": 82.53592920780284, "timesteps_total": 224000, "num_env_steps_sampled_lifetime": 224000, "num_agent_steps_sampled_lifetime": 896000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 896000, "timers": {"training_iteration_time_ms": 49536.603, "restore_workers_time_ms": 0.014, "training_step_time_ms": 49536.539, "sample_time_ms": 1305.448, "learn_time_ms": 48211.512, "learn_throughput": 82.968, "synch_weights_time_ms": 15.802}, "counters": {"num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_agent_steps_sampled": 896000, "num_agent_steps_trained": 896000}, "done": false, "training_iteration": 56, "trial_id": "cf3bb_00000", "date": "2024-08-20_09-30-59", "timestamp": 1724126459, "time_this_iter_s": 48.49358510971069, "time_total_s": 10722.861451148987, "pid": 25777, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39fe3d280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 10722.861451148987, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 50.627142857142864, "ram_util_percent": 82.6957142857143}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6166950936512972, "cur_kl_coeff": 0.020022583007812504, "cur_lr": 0.00010000000000000003, "total_loss": 6.683887617424052, "policy_loss": -0.004710169708252781, "vf_loss": 6.68833182476185, "vf_explained_var": 0.0014044788148668077, "kl": 0.013282538707240265, "entropy": 1.2861044643417237, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 106785.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 17.6233483286131, "cur_kl_coeff": 0.0421875, "cur_lr": 0.00010000000000000003, "total_loss": 8.074733621607383, "policy_loss": -0.00823944057214749, "vf_loss": 8.082405096387106, "vf_explained_var": 0.23953473025528843, "kl": 0.013462695424787202, "entropy": 1.1088497689161352, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 106785.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_agent_steps_sampled": 912000, "num_agent_steps_trained": 912000}, "env_runners": {"episode_reward_max": 428.4011776204216, "episode_reward_min": -226.4860897051025, "episode_reward_mean": 92.50536403290738, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1300.94750279114, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 1301.4475027911399}, "policy_reward_mean": {"prey_policy": -155.92891693320246, "predator_policy": 202.18159894965618}, "custom_metrics": {}, "hist_stats": {"episode_reward": [69.61638351527533, 54.17395038083672, -14.287496410923035, 112.52049427430326, 101.09697507101475, 122.5225558311818, 94.19999999999939, 124.09999999999968, -81.5207566551618, 69.20000000000002, -177.3378163096813, 56.49360825186213, 75.99999999999952, 340.25727341548384, 123.30908812054327, -3.3835403031831874, 36.8852144886548, 68.08279157644324, 135.6609574711267, 204.99999999999935, 201.905107500648, 175.17121928068303, 327.05726679529903, 112.6999999999995, 112.32377686235452, 205.6999999999995, 64.10000000000022, 44.00000000000024, 96.89999999999975, 37.48351144519895, 81.15543345416425, -62.69532136818618, 34.70000000000022, 202.99999999999932, 376.7, 16.86000256501718, 83.79999999999964, 204.5999999999994, 125.7, 12.229979785398365, 88.5999999999998, 226.0247684437508, 167.7999999999998, 18.251788619055233, -226.4860897051025, 19.689218573181105, 91.49999999999997, 88.69999999999939, 72.79999999999998, 178.59999999999937, -19.65342369055839, 221.4477134136766, 138.81961784957562, -78.8674001439853, -90.27715789818895, -78.1256632963782, -28.60887388255018, 49.00000000000006, 93.29999999999987, -39.998361327163835, 55.30000000000005, 115.15463100799344, 208.02571870207257, 130.29999999999941, -31.72461524695493, 186.3588558962258, -14.491337568194016, 137.79999999999995, 131.09999999999937, 211.10833166812733, 89.5548826887298, 380.8, 128.09999999999974, 92.0, 56.46683245877613, 75.39999999999998, 27.523295997987386, -74.62303458229306, 248.19565789996366, 19.340493344722546, 50.00000000000001, 207.7999999999993, -96.31174523824153, 117.5, -42.2680960851769, 165.77535625036333, -54.86910220831129, -112.01593975808322, 428.4011776204216, 185.5999999999998, -72.98964548078722, -59.34087151254692, 152.49548220024872, 352.0, 24.40000000000001, 400.0, 98.90000000000006, -102.22672075796288, 193.40000000000003, 384.1], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-72.33497180267132, -262.28017523570986, 11.72497413540012, -329.6480820633849, -170.3058881159309, -620.6607916566848, -246.21946154536752, 20.000000000000014, -180.5779545277649, 20.000000000000014, -111.87260790724808, -32.41201737149821, -226.97809970950522, -5.607093781350091, 4.444590018969251, -146.8662750985182, -272.8979416657729, -491.9277797380746, -303.5352687874578, -10.469848164761778, -534.6197527435213, -244.75238838871783, -240.60856751108307, -131.86632456649355, -80.1589888358343, -220.23552468807557, 155.0086681068805, 143.9274754205082, 14.713509907635979, -385.380509493838, -115.99895356666408, -167.87767554175454, -60.64078837698781, -125.05338712482336, -558.7199955633172, -41.42726172745805, 5.562452358520655, -79.76100103367392, -13.454865288730247, 169.20227585170915, -65.84964860780059, 65.42525119472013, -81.62119218042967, 127.27361997346448, 132.7375365187392, 122.05679464096835, -46.47367839744105, -36.74586675656422, -167.11554306151436, -54.34000473463309, 190.49815340547224, -134.28935687959964, -282.467256918355, 10.031121933303892, -16.822068680143907, -425.9372239546531, -67.14120973813681, -165.74112299731405, 10.949393262329293, 14.392804761989431, -222.24294049960133, -60.28579476787441, -184.97947757906826, -276.0460879094474, -61.83981640807902, -54.87063889778966, -72.41508635278834, 174.0360882545253, 148.15755744514266, 189.58622515941045, -154.0687079582573, -378.87415096631173, 6.961306263980122, -17.42332435219295, -153.44737290631485, 183.57808045568194, -14.337390854068486, -804.4655116551647, -49.599338796489995, -82.54684426830306, -136.30538672524045, 13.998082074780791, 34.4927699931039, -19.959647837772806, 115.90900087902078, -284.50643843617087, -236.2314810586069, -89.72347687262996, -341.84385904642954, -363.4668759303478, -116.23638081222798, -177.25771085770344, 14.540076639223498, -91.65888382657855, 2.7245307573552284, -219.70917455520146, 17.428919080390816, -133.53276510663878, 123.89146661403304, -87.80528533613239, -76.50334496668282, -204.2691947768754, -253.28415248478615, 198.04550425271512, 12.56795102384624, -307.826822789362, -117.41437032312103, -227.14632695884498, -518.4279814638408, -468.37691170403997, -279.8772121110214, -165.43585516515714, -326.3972243768504, -416.1754947452861, -263.9836094717841, -58.01225394066162, -0.526798444572461, -87.98055906489289, -245.3120277488179, -257.7062275904331, -208.4524275962498, -27.0217366719749, -221.62877200975018, -298.58551580060816, 132.84743540051753, -167.5739179328557, -94.33595619629835, -37.386048686801495, -326.76815265980565, -417.7942785030481, -1.898323141951213, -3.2473455835867284, -131.75647313747564, -217.26961871131869, -29.25405011635715, -161.60900216290398, -83.00779532519356, -55.00800475845119, 193.97748693419004, -121.51080591678041, -354.6626223458782, 20.000000000000014, 195.31226065907003, 182.48405329656762, -30.041632807587604, -117.13525569433418, -987.4315548135141, -146.44918311267259, -103.43627820780455, -102.6391947625295, -975.8510608792182, -130.60604411136984, -197.90254683076873, -304.58659129792375, -168.479840429428, -235.28298295300888, 79.28391732587923, 33.43839429705933, -332.996487084253, -265.5756152560191, -1095.504848430838, -277.6850409282788, 190.80783196463398, -84.60658268722341, -232.48355048424776, -968.0994271412314, -9.16398216294312, -1300.94750279114, -331.88833782999785, -366.9831879942964, 99.02111161634791, -708.5346662348352, -324.3463366873916, -249.71163128870938, -532.0892196464946, -312.0520398611161, 193.9983053171864, -555.2839860203321, -173.40521347452523, 139.49180620880807, -497.2005102798149, -298.3425928143353, -307.7708924371626, -386.0316487214693, 2.1670286376802803, -36.82407380305629, 133.8301907945934, 129.13886099051342, -355.2608817907012, -148.40809749960695, 200.0, 200.0, -53.426976491744284, -672.4790134090279, -484.511632144515, -391.7709895497415, 161.36217728905456, -879.6644070558681, 195.2738268141588, 159.60876381751788], "policy_predator_policy_reward": [348.498299995362, 55.73323055829452, 95.84555296758597, 276.25150534123526, 143.00123163757783, 633.6779517241151, 33.72857800039657, 305.0113778192746, 240.57795452776512, 21.096975071014977, 242.99763074698964, 23.809550362938534, 102.96292101772427, 223.8222724731311, 104.55540998103076, 161.96627509851734, 145.2942091201577, 538.010755628528, 354.53526878745794, 28.669848164761937, 599.681835314309, 2.3524895082488504, 276.6512157260811, 152.3172846033574, 94.1589888358337, 282.23552468807566, 35.724969069095536, 5.596160818999669, 65.84650247993403, 428.12958522681146, 40.955161393205884, 239.53792741202875, 0.9433926234759257, 221.6359973669898, 561.7199955633172, 106.51005330390153, 132.6693508662491, 77.1901552800308, 31.15486528873044, 18.09772414829084, 47.73369580304018, 154.59580911068832, 43.62681058117876, 85.8919809064696, 54.52740448836589, 17.735531147225615, 62.47367839744102, 133.44586675656424, 78.8907443697943, 254.88858028870752, 4.501846594527759, 144.98935687959914, 34.01840203548553, 302.5177329495656, 34.82206868014415, 451.9372239546532, 146.6023409412672, 183.17999179418283, 8.76068978754935, 3.3806236333305417, 248.22862124820819, 115.455547473431, 398.33024412032927, 0.0, 79.33981640807818, 72.07063889778934, 88.41508635278743, 12.96391174547468, 35.24244255485735, 3.713774840589562, 230.88871896859092, 318.9141425209956, 67.63195124484307, 26.630066843369807, 165.74737290631415, 8.72191954431805, 139.3373908540684, 805.1655116551648, 141.3950763329512, 2.9810865172394427, 205.3053867252404, 5.601917925219173, 58.76860987889216, 152.72303640952742, 48.090999120979305, 288.3064384361715, 320.4661914772691, 23.74055507302278, 168.83151260992085, 309.99313266175756, 54.83531634694575, 258.3479938961668, 4.95992336077647, 163.65888382657826, 15.975469242644733, 289.7091745552018, 2.371080919609164, 186.53276510663903, 40.10853338596695, 102.40528533613156, 7.15730036498254, 253.9618156880173, 140.0347127374855, 136.65164890826512, 183.44037771042795, 250.63811190466402, 178.50987430367448, 87.18342283430628, 512.44129233785, 384.086442931842, 12.494397256034526, 354.6930067237659, 342.17941246924, 371.78443277034654, 297.9836094717841, 73.01225394066165, 174.24678823143407, 7.560569278031051, 150.9790639148384, 312.0408300972488, 246.4524275962498, 44.321736671975145, 283.538338021812, 351.8305807965395, 19.26549331930255, 223.48670791510818, 208.33595619629853, 53.686048686801726, 391.3220087889232, 321.515807126975, 178.65775111621383, 12.846773505549994, 2.14762331031352, 332.3871309702866, 158.25405011635715, 170.4090021629039, 198.00779532519357, 71.10800475845092, 40.30650251310307, 98.33514813761452, 353.7827212799458, 70.4347837546624, 0.9877393409299676, 2.015946703432381, 44.48998237813831, 230.78690612378375, 987.4315548135141, 238.44918311267264, 262.54230542911034, 0.0, 975.9510608792182, 205.9060441113697, 183.67899810412504, 346.3334360225543, 315.67308156921865, 13.466707230925316, 57.847024013404535, 77.62632226362051, 348.1011813953601, 269.81141428963446, 1095.504848430838, 327.68504092827885, 0.9921680353660393, 100.60658268722254, 136.17180524600553, 968.0994271412314, 126.16398216294306, 1301.4475027911399, 440.61237502028314, 215.99105471883453, 64.25424463401544, 711.0346662348352, 163.94148422333234, 355.2473815444573, 256.8976031655954, 475.22771658393225, 348.90715827458706, 440.77970004898043, 0.0, 219.5134072657171, 452.6876452197077, 269.86581239365444, 414.93187709150806, 219.52979255457672, 180.06592592131236, 7.086601444312562, 38.1698092054066, 50.861139009486564, 367.2608817907012, 160.80809749960625, 0.0, 0.0, 147.22697649174415, 677.579013409028, 572.931973558619, 201.1239273776748, 28.637822710945443, 883.0644070558678, 1.8261731858411925, 27.39123618248212]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.381909234301977, "mean_inference_ms": 4.429532507404026, "mean_action_processing_ms": 2.324427476235812, "mean_env_wait_ms": 0.8930861792775364, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004392027854919434, "StateBufferConnector_ms": 0.004506230354309082, "ViewRequirementAgentConnector_ms": 0.10299170017242432}, "num_episodes": 18, "episode_return_max": 428.4011776204216, "episode_return_min": -226.4860897051025, "episode_return_mean": 92.50536403290738, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 912000, "num_agent_steps_trained": 912000, "num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 82.66357581696474, "num_env_steps_trained_throughput_per_sec": 82.66357581696474, "timesteps_total": 228000, "num_env_steps_sampled_lifetime": 228000, "num_agent_steps_sampled_lifetime": 912000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 912000, "timers": {"training_iteration_time_ms": 49800.867, "restore_workers_time_ms": 0.014, "training_step_time_ms": 49800.802, "sample_time_ms": 1315.685, "learn_time_ms": 48465.601, "learn_throughput": 82.533, "synch_weights_time_ms": 15.67}, "counters": {"num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_agent_steps_sampled": 912000, "num_agent_steps_trained": 912000}, "done": false, "training_iteration": 57, "trial_id": "cf3bb_00000", "date": "2024-08-20_09-31-48", "timestamp": 1724126508, "time_this_iter_s": 48.50324010848999, "time_total_s": 10771.364691257477, "pid": 25777, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39ffd5790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 10771.364691257477, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 50.51159420289856, "ram_util_percent": 82.5768115942029}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.963420421736581, "cur_kl_coeff": 0.020022583007812504, "cur_lr": 0.00010000000000000003, "total_loss": 7.028880830795046, "policy_loss": -0.001442156642645834, "vf_loss": 7.030084255006578, "vf_explained_var": -0.0032323524119362, "kl": 0.011923279689962013, "entropy": 1.2465408113267686, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 108675.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 16.041478565414117, "cur_kl_coeff": 0.0421875, "cur_lr": 0.00010000000000000003, "total_loss": 8.31609229991045, "policy_loss": -0.002403735326080726, "vf_loss": 8.318174444430719, "vf_explained_var": 0.27412113862693627, "kl": 0.007623524282580763, "entropy": 1.106060167847487, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 108675.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_agent_steps_sampled": 928000, "num_agent_steps_trained": 928000}, "env_runners": {"episode_reward_max": 657.0293832459636, "episode_reward_min": -583.4554096340432, "episode_reward_mean": 91.01364966869757, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1363.4825858860752, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 1363.4825858860752}, "policy_reward_mean": {"prey_policy": -192.97241612478464, "predator_policy": 238.47924095913345}, "custom_metrics": {}, "hist_stats": {"episode_reward": [327.05726679529903, 112.6999999999995, 112.32377686235452, 205.6999999999995, 64.10000000000022, 44.00000000000024, 96.89999999999975, 37.48351144519895, 81.15543345416425, -62.69532136818618, 34.70000000000022, 202.99999999999932, 376.7, 16.86000256501718, 83.79999999999964, 204.5999999999994, 125.7, 12.229979785398365, 88.5999999999998, 226.0247684437508, 167.7999999999998, 18.251788619055233, -226.4860897051025, 19.689218573181105, 91.49999999999997, 88.69999999999939, 72.79999999999998, 178.59999999999937, -19.65342369055839, 221.4477134136766, 138.81961784957562, -78.8674001439853, -90.27715789818895, -78.1256632963782, -28.60887388255018, 49.00000000000006, 93.29999999999987, -39.998361327163835, 55.30000000000005, 115.15463100799344, 208.02571870207257, 130.29999999999941, -31.72461524695493, 186.3588558962258, -14.491337568194016, 137.79999999999995, 131.09999999999937, 211.10833166812733, 89.5548826887298, 380.8, 128.09999999999974, 92.0, 56.46683245877613, 75.39999999999998, 27.523295997987386, -74.62303458229306, 248.19565789996366, 19.340493344722546, 50.00000000000001, 207.7999999999993, -96.31174523824153, 117.5, -42.2680960851769, 165.77535625036333, -54.86910220831129, -112.01593975808322, 428.4011776204216, 185.5999999999998, -72.98964548078722, -59.34087151254692, 152.49548220024872, 352.0, 24.40000000000001, 400.0, 98.90000000000006, -102.22672075796288, 193.40000000000003, 384.1, 132.2739048004288, -46.827541766875186, 3.5892258972032787, 64.0442417402625, 355.4015105596152, 171.42634119813889, 164.78433241611572, 35.3, 25.9, 77.27739354095539, 177.18317471917908, 61.10000000000004, 657.0293832459636, 94.02267493629816, -583.4554096340432, 93.39999999999998, -458.90122014996416, 127.60000000000002, 70.89999999999998, 195.2, 78.0999999999998, 245.14656157484524], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [132.7375365187392, 122.05679464096835, -46.47367839744105, -36.74586675656422, -167.11554306151436, -54.34000473463309, 190.49815340547224, -134.28935687959964, -282.467256918355, 10.031121933303892, -16.822068680143907, -425.9372239546531, -67.14120973813681, -165.74112299731405, 10.949393262329293, 14.392804761989431, -222.24294049960133, -60.28579476787441, -184.97947757906826, -276.0460879094474, -61.83981640807902, -54.87063889778966, -72.41508635278834, 174.0360882545253, 148.15755744514266, 189.58622515941045, -154.0687079582573, -378.87415096631173, 6.961306263980122, -17.42332435219295, -153.44737290631485, 183.57808045568194, -14.337390854068486, -804.4655116551647, -49.599338796489995, -82.54684426830306, -136.30538672524045, 13.998082074780791, 34.4927699931039, -19.959647837772806, 115.90900087902078, -284.50643843617087, -236.2314810586069, -89.72347687262996, -341.84385904642954, -363.4668759303478, -116.23638081222798, -177.25771085770344, 14.540076639223498, -91.65888382657855, 2.7245307573552284, -219.70917455520146, 17.428919080390816, -133.53276510663878, 123.89146661403304, -87.80528533613239, -76.50334496668282, -204.2691947768754, -253.28415248478615, 198.04550425271512, 12.56795102384624, -307.826822789362, -117.41437032312103, -227.14632695884498, -518.4279814638408, -468.37691170403997, -279.8772121110214, -165.43585516515714, -326.3972243768504, -416.1754947452861, -263.9836094717841, -58.01225394066162, -0.526798444572461, -87.98055906489289, -245.3120277488179, -257.7062275904331, -208.4524275962498, -27.0217366719749, -221.62877200975018, -298.58551580060816, 132.84743540051753, -167.5739179328557, -94.33595619629835, -37.386048686801495, -326.76815265980565, -417.7942785030481, -1.898323141951213, -3.2473455835867284, -131.75647313747564, -217.26961871131869, -29.25405011635715, -161.60900216290398, -83.00779532519356, -55.00800475845119, 193.97748693419004, -121.51080591678041, -354.6626223458782, 20.000000000000014, 195.31226065907003, 182.48405329656762, -30.041632807587604, -117.13525569433418, -987.4315548135141, -146.44918311267259, -103.43627820780455, -102.6391947625295, -975.8510608792182, -130.60604411136984, -197.90254683076873, -304.58659129792375, -168.479840429428, -235.28298295300888, 79.28391732587923, 33.43839429705933, -332.996487084253, -265.5756152560191, -1095.504848430838, -277.6850409282788, 190.80783196463398, -84.60658268722341, -232.48355048424776, -968.0994271412314, -9.16398216294312, -1300.94750279114, -331.88833782999785, -366.9831879942964, 99.02111161634791, -708.5346662348352, -324.3463366873916, -249.71163128870938, -532.0892196464946, -312.0520398611161, 193.9983053171864, -555.2839860203321, -173.40521347452523, 139.49180620880807, -497.2005102798149, -298.3425928143353, -307.7708924371626, -386.0316487214693, 2.1670286376802803, -36.82407380305629, 133.8301907945934, 129.13886099051342, -355.2608817907012, -148.40809749960695, 200.0, 200.0, -53.426976491744284, -672.4790134090279, -484.511632144515, -391.7709895497415, 161.36217728905456, -879.6644070558681, 195.2738268141588, 159.60876381751788, -114.01353264822313, 45.43472838485635, -232.69251131209913, -296.7270742399903, -121.43528271293363, -150.80939061175317, -121.56743707712884, -493.53258923910835, 138.24270123546046, 165.36328417373724, -172.49852295479312, 52.62378511632914, -383.0892776258843, 18.21742711303157, -245.1855493980617, -1180.7255982227034, -387.7944764778108, -166.3788351927438, -139.98041255068472, -167.6367958469247, -47.187026739392934, -41.0506801951515, -161.09867350713733, -724.5243978819334, 193.98776009534768, -1307.124863217215, -169.102983459617, -268.9706060973471, -899.4349218709391, -681.4416254455081, -120.12978648280546, -956.5742073267191, -688.6654636937444, -759.9450718923927, -685.831982998154, -98.07246388049012, -232.32692093800085, 3.3127172000187337, 192.3865140772039, -1363.4825858860752, -408.1948656859723, -179.0595393358169, 66.61382289752521, -13.934891407796052], "policy_predator_policy_reward": [54.52740448836589, 17.735531147225615, 62.47367839744102, 133.44586675656424, 78.8907443697943, 254.88858028870752, 4.501846594527759, 144.98935687959914, 34.01840203548553, 302.5177329495656, 34.82206868014415, 451.9372239546532, 146.6023409412672, 183.17999179418283, 8.76068978754935, 3.3806236333305417, 248.22862124820819, 115.455547473431, 398.33024412032927, 0.0, 79.33981640807818, 72.07063889778934, 88.41508635278743, 12.96391174547468, 35.24244255485735, 3.713774840589562, 230.88871896859092, 318.9141425209956, 67.63195124484307, 26.630066843369807, 165.74737290631415, 8.72191954431805, 139.3373908540684, 805.1655116551648, 141.3950763329512, 2.9810865172394427, 205.3053867252404, 5.601917925219173, 58.76860987889216, 152.72303640952742, 48.090999120979305, 288.3064384361715, 320.4661914772691, 23.74055507302278, 168.83151260992085, 309.99313266175756, 54.83531634694575, 258.3479938961668, 4.95992336077647, 163.65888382657826, 15.975469242644733, 289.7091745552018, 2.371080919609164, 186.53276510663903, 40.10853338596695, 102.40528533613156, 7.15730036498254, 253.9618156880173, 140.0347127374855, 136.65164890826512, 183.44037771042795, 250.63811190466402, 178.50987430367448, 87.18342283430628, 512.44129233785, 384.086442931842, 12.494397256034526, 354.6930067237659, 342.17941246924, 371.78443277034654, 297.9836094717841, 73.01225394066165, 174.24678823143407, 7.560569278031051, 150.9790639148384, 312.0408300972488, 246.4524275962498, 44.321736671975145, 283.538338021812, 351.8305807965395, 19.26549331930255, 223.48670791510818, 208.33595619629853, 53.686048686801726, 391.3220087889232, 321.515807126975, 178.65775111621383, 12.846773505549994, 2.14762331031352, 332.3871309702866, 158.25405011635715, 170.4090021629039, 198.00779532519357, 71.10800475845092, 40.30650251310307, 98.33514813761452, 353.7827212799458, 70.4347837546624, 0.9877393409299676, 2.015946703432381, 44.48998237813831, 230.78690612378375, 987.4315548135141, 238.44918311267264, 262.54230542911034, 0.0, 975.9510608792182, 205.9060441113697, 183.67899810412504, 346.3334360225543, 315.67308156921865, 13.466707230925316, 57.847024013404535, 77.62632226362051, 348.1011813953601, 269.81141428963446, 1095.504848430838, 327.68504092827885, 0.9921680353660393, 100.60658268722254, 136.17180524600553, 968.0994271412314, 126.16398216294306, 1301.4475027911399, 440.61237502028314, 215.99105471883453, 64.25424463401544, 711.0346662348352, 163.94148422333234, 355.2473815444573, 256.8976031655954, 475.22771658393225, 348.90715827458706, 440.77970004898043, 0.0, 219.5134072657171, 452.6876452197077, 269.86581239365444, 414.93187709150806, 219.52979255457672, 180.06592592131236, 7.086601444312562, 38.1698092054066, 50.861139009486564, 367.2608817907012, 160.80809749960625, 0.0, 0.0, 147.22697649174415, 677.579013409028, 572.931973558619, 201.1239273776748, 28.637822710945443, 883.0644070558678, 1.8261731858411925, 27.39123618248212, 1.6774555517876995, 199.17525351200794, 317.00328917586495, 165.58875460934945, 215.8913571901761, 59.94254203171365, 333.429668095363, 345.714599961137, 39.30063451387998, 12.494890636537527, 248.74445261173378, 42.556626424869165, 399.2924203926418, 130.36376253632722, 280.2855493980618, 1180.9255982227035, 401.7944764778108, 178.27883519274312, 276.9892213088933, 107.90538062967134, 205.06407701011887, 60.35680464360465, 217.0986735071371, 729.6243978819334, 520.4994875268852, 1249.666998840946, 292.0374234255978, 240.05884106766462, 994.6131908583016, 2.8079468241021677, 212.02978648280552, 958.074207326719, 495.87342539489833, 493.8358900412736, 691.431982998154, 220.07246388049012, 284.326920938001, 15.587282799981232, 2.8134859227960964, 1363.4825858860752, 415.29486568597196, 250.05953933581694, 45.52754426645575, 146.94008581866032]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3690129412328356, "mean_inference_ms": 4.302781651191034, "mean_action_processing_ms": 2.3495313364550783, "mean_env_wait_ms": 0.881820507402021, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004183530807495117, "StateBufferConnector_ms": 0.003285527229309082, "ViewRequirementAgentConnector_ms": 0.11776888370513916}, "num_episodes": 22, "episode_return_max": 657.0293832459636, "episode_return_min": -583.4554096340432, "episode_return_mean": 91.01364966869757, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 928000, "num_agent_steps_trained": 928000, "num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 80.86572417690434, "num_env_steps_trained_throughput_per_sec": 80.86572417690434, "timesteps_total": 232000, "num_env_steps_sampled_lifetime": 232000, "num_agent_steps_sampled_lifetime": 928000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 928000, "timers": {"training_iteration_time_ms": 49509.446, "restore_workers_time_ms": 0.014, "training_step_time_ms": 49509.394, "sample_time_ms": 1363.381, "learn_time_ms": 48127.325, "learn_throughput": 83.113, "synch_weights_time_ms": 15.099}, "counters": {"num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_agent_steps_sampled": 928000, "num_agent_steps_trained": 928000}, "done": false, "training_iteration": 58, "trial_id": "cf3bb_00000", "date": "2024-08-20_09-32-38", "timestamp": 1724126558, "time_this_iter_s": 49.516643047332764, "time_total_s": 10820.88133430481, "pid": 25777, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39f81a3a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 10820.88133430481, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 40.23043478260869, "ram_util_percent": 82.92463768115944}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0652247443795204, "cur_kl_coeff": 0.020022583007812504, "cur_lr": 0.00010000000000000003, "total_loss": 7.9446885570647225, "policy_loss": -0.00696637790117945, "vf_loss": 7.95123017174857, "vf_explained_var": -0.002332296510222097, "kl": 0.021213676795110707, "entropy": 1.326509114989528, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 110565.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 11.414884371558825, "cur_kl_coeff": 0.0421875, "cur_lr": 0.00010000000000000003, "total_loss": 8.645856001768163, "policy_loss": -0.006479384892289995, "vf_loss": 8.651713457813969, "vf_explained_var": 0.2533301752711099, "kl": 0.01474219888820383, "entropy": 1.0158354514805727, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 110565.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_agent_steps_sampled": 944000, "num_agent_steps_trained": 944000}, "env_runners": {"episode_reward_max": 689.7185633947763, "episode_reward_min": -1017.5248519729216, "episode_reward_mean": 72.94551291798071, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1643.238366313578, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 1576.7739002195106}, "policy_reward_mean": {"prey_policy": -256.91103106065253, "predator_policy": 293.38378751964285}, "custom_metrics": {}, "hist_stats": {"episode_reward": [88.5999999999998, 226.0247684437508, 167.7999999999998, 18.251788619055233, -226.4860897051025, 19.689218573181105, 91.49999999999997, 88.69999999999939, 72.79999999999998, 178.59999999999937, -19.65342369055839, 221.4477134136766, 138.81961784957562, -78.8674001439853, -90.27715789818895, -78.1256632963782, -28.60887388255018, 49.00000000000006, 93.29999999999987, -39.998361327163835, 55.30000000000005, 115.15463100799344, 208.02571870207257, 130.29999999999941, -31.72461524695493, 186.3588558962258, -14.491337568194016, 137.79999999999995, 131.09999999999937, 211.10833166812733, 89.5548826887298, 380.8, 128.09999999999974, 92.0, 56.46683245877613, 75.39999999999998, 27.523295997987386, -74.62303458229306, 248.19565789996366, 19.340493344722546, 50.00000000000001, 207.7999999999993, -96.31174523824153, 117.5, -42.2680960851769, 165.77535625036333, -54.86910220831129, -112.01593975808322, 428.4011776204216, 185.5999999999998, -72.98964548078722, -59.34087151254692, 152.49548220024872, 352.0, 24.40000000000001, 400.0, 98.90000000000006, -102.22672075796288, 193.40000000000003, 384.1, 132.2739048004288, -46.827541766875186, 3.5892258972032787, 64.0442417402625, 355.4015105596152, 171.42634119813889, 164.78433241611572, 35.3, 25.9, 77.27739354095539, 177.18317471917908, 61.10000000000004, 657.0293832459636, 94.02267493629816, -583.4554096340432, 93.39999999999998, -458.90122014996416, 127.60000000000002, 70.89999999999998, 195.2, 78.0999999999998, 245.14656157484524, 55.0, -1017.5248519729216, 92.56527427814169, 548.9740118659074, -224.50858377598735, 3.9965908508580488, 105.10000000000004, 689.7185633947763, 232.70208108183573, 128.53557937382394, -90.66615041461402, 118.15471120719957, -808.8390441792928, 0.8859905554322742, 113.70000000000016, 240.45921607009066, 29.947586132309773, 51.3], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-136.30538672524045, 13.998082074780791, 34.4927699931039, -19.959647837772806, 115.90900087902078, -284.50643843617087, -236.2314810586069, -89.72347687262996, -341.84385904642954, -363.4668759303478, -116.23638081222798, -177.25771085770344, 14.540076639223498, -91.65888382657855, 2.7245307573552284, -219.70917455520146, 17.428919080390816, -133.53276510663878, 123.89146661403304, -87.80528533613239, -76.50334496668282, -204.2691947768754, -253.28415248478615, 198.04550425271512, 12.56795102384624, -307.826822789362, -117.41437032312103, -227.14632695884498, -518.4279814638408, -468.37691170403997, -279.8772121110214, -165.43585516515714, -326.3972243768504, -416.1754947452861, -263.9836094717841, -58.01225394066162, -0.526798444572461, -87.98055906489289, -245.3120277488179, -257.7062275904331, -208.4524275962498, -27.0217366719749, -221.62877200975018, -298.58551580060816, 132.84743540051753, -167.5739179328557, -94.33595619629835, -37.386048686801495, -326.76815265980565, -417.7942785030481, -1.898323141951213, -3.2473455835867284, -131.75647313747564, -217.26961871131869, -29.25405011635715, -161.60900216290398, -83.00779532519356, -55.00800475845119, 193.97748693419004, -121.51080591678041, -354.6626223458782, 20.000000000000014, 195.31226065907003, 182.48405329656762, -30.041632807587604, -117.13525569433418, -987.4315548135141, -146.44918311267259, -103.43627820780455, -102.6391947625295, -975.8510608792182, -130.60604411136984, -197.90254683076873, -304.58659129792375, -168.479840429428, -235.28298295300888, 79.28391732587923, 33.43839429705933, -332.996487084253, -265.5756152560191, -1095.504848430838, -277.6850409282788, 190.80783196463398, -84.60658268722341, -232.48355048424776, -968.0994271412314, -9.16398216294312, -1300.94750279114, -331.88833782999785, -366.9831879942964, 99.02111161634791, -708.5346662348352, -324.3463366873916, -249.71163128870938, -532.0892196464946, -312.0520398611161, 193.9983053171864, -555.2839860203321, -173.40521347452523, 139.49180620880807, -497.2005102798149, -298.3425928143353, -307.7708924371626, -386.0316487214693, 2.1670286376802803, -36.82407380305629, 133.8301907945934, 129.13886099051342, -355.2608817907012, -148.40809749960695, 200.0, 200.0, -53.426976491744284, -672.4790134090279, -484.511632144515, -391.7709895497415, 161.36217728905456, -879.6644070558681, 195.2738268141588, 159.60876381751788, -114.01353264822313, 45.43472838485635, -232.69251131209913, -296.7270742399903, -121.43528271293363, -150.80939061175317, -121.56743707712884, -493.53258923910835, 138.24270123546046, 165.36328417373724, -172.49852295479312, 52.62378511632914, -383.0892776258843, 18.21742711303157, -245.1855493980617, -1180.7255982227034, -387.7944764778108, -166.3788351927438, -139.98041255068472, -167.6367958469247, -47.187026739392934, -41.0506801951515, -161.09867350713733, -724.5243978819334, 193.98776009534768, -1307.124863217215, -169.102983459617, -268.9706060973471, -899.4349218709391, -681.4416254455081, -120.12978648280546, -956.5742073267191, -688.6654636937444, -759.9450718923927, -685.831982998154, -98.07246388049012, -232.32692093800085, 3.3127172000187337, 192.3865140772039, -1363.4825858860752, -408.1948656859723, -179.0595393358169, 66.61382289752521, -13.934891407796052, -159.70769586158679, -1199.1151660075732, -1058.6603858788544, -1247.4666128169506, 4.322246611629687, -272.49007459004696, -1138.8617115328616, 175.37740473519352, -404.75239344059065, -571.9409402870549, -290.1989532704503, -247.58474225551208, -509.06128922206346, -34.64964686935811, 196.25029152073387, -1241.484609726244, -48.23899142118199, 112.49325216094668, -482.1413620059482, -1.8654693188254408, -403.43644346790546, -232.45951270935075, -23.71976986160591, -119.77431197496037, -1538.5604134542507, -1643.238366313578, -428.2314658653164, -484.589921602304, -60.626321209417, -387.98136502937723, 53.02911993066512, 74.68122991467663, -304.15118802455413, -332.15615643810986, -1042.311389077327, -295.9506167028149], "policy_predator_policy_reward": [205.3053867252404, 5.601917925219173, 58.76860987889216, 152.72303640952742, 48.090999120979305, 288.3064384361715, 320.4661914772691, 23.74055507302278, 168.83151260992085, 309.99313266175756, 54.83531634694575, 258.3479938961668, 4.95992336077647, 163.65888382657826, 15.975469242644733, 289.7091745552018, 2.371080919609164, 186.53276510663903, 40.10853338596695, 102.40528533613156, 7.15730036498254, 253.9618156880173, 140.0347127374855, 136.65164890826512, 183.44037771042795, 250.63811190466402, 178.50987430367448, 87.18342283430628, 512.44129233785, 384.086442931842, 12.494397256034526, 354.6930067237659, 342.17941246924, 371.78443277034654, 297.9836094717841, 73.01225394066165, 174.24678823143407, 7.560569278031051, 150.9790639148384, 312.0408300972488, 246.4524275962498, 44.321736671975145, 283.538338021812, 351.8305807965395, 19.26549331930255, 223.48670791510818, 208.33595619629853, 53.686048686801726, 391.3220087889232, 321.515807126975, 178.65775111621383, 12.846773505549994, 2.14762331031352, 332.3871309702866, 158.25405011635715, 170.4090021629039, 198.00779532519357, 71.10800475845092, 40.30650251310307, 98.33514813761452, 353.7827212799458, 70.4347837546624, 0.9877393409299676, 2.015946703432381, 44.48998237813831, 230.78690612378375, 987.4315548135141, 238.44918311267264, 262.54230542911034, 0.0, 975.9510608792182, 205.9060441113697, 183.67899810412504, 346.3334360225543, 315.67308156921865, 13.466707230925316, 57.847024013404535, 77.62632226362051, 348.1011813953601, 269.81141428963446, 1095.504848430838, 327.68504092827885, 0.9921680353660393, 100.60658268722254, 136.17180524600553, 968.0994271412314, 126.16398216294306, 1301.4475027911399, 440.61237502028314, 215.99105471883453, 64.25424463401544, 711.0346662348352, 163.94148422333234, 355.2473815444573, 256.8976031655954, 475.22771658393225, 348.90715827458706, 440.77970004898043, 0.0, 219.5134072657171, 452.6876452197077, 269.86581239365444, 414.93187709150806, 219.52979255457672, 180.06592592131236, 7.086601444312562, 38.1698092054066, 50.861139009486564, 367.2608817907012, 160.80809749960625, 0.0, 0.0, 147.22697649174415, 677.579013409028, 572.931973558619, 201.1239273776748, 28.637822710945443, 883.0644070558678, 1.8261731858411925, 27.39123618248212, 1.6774555517876995, 199.17525351200794, 317.00328917586495, 165.58875460934945, 215.8913571901761, 59.94254203171365, 333.429668095363, 345.714599961137, 39.30063451387998, 12.494890636537527, 248.74445261173378, 42.556626424869165, 399.2924203926418, 130.36376253632722, 280.2855493980618, 1180.9255982227035, 401.7944764778108, 178.27883519274312, 276.9892213088933, 107.90538062967134, 205.06407701011887, 60.35680464360465, 217.0986735071371, 729.6243978819334, 520.4994875268852, 1249.666998840946, 292.0374234255978, 240.05884106766462, 994.6131908583016, 2.8079468241021677, 212.02978648280552, 958.074207326719, 495.87342539489833, 493.8358900412736, 691.431982998154, 220.07246388049012, 284.326920938001, 15.587282799981232, 2.8134859227960964, 1363.4825858860752, 415.29486568597196, 250.05953933581694, 45.52754426645575, 146.94008581866032, 213.70769586158676, 1200.1151660075732, 0.0, 1288.6021467228834, 134.3860539627943, 226.34704829376415, 511.75988718414135, 1000.6984314794344, 262.0777952530908, 490.1069546985677, 371.4806792137395, 170.29960716308085, 512.6612892220633, 136.14964686935807, 1226.5343182055099, 508.4185633947765, 160.64661714721174, 7.801203194859294, 259.9451996181262, 352.5972110804719, 175.70625415045868, 369.5235516121832, 250.68028406419745, 10.968508979568345, 796.1858353690247, 1576.7739002195106, 459.0699396951493, 454.6374383279033, 165.626321209417, 396.6813650293772, 25.613239432509403, 87.1356267922395, 433.4548990132427, 232.80003158173147, 1042.5113890773273, 347.0506167028149]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3581187540383666, "mean_inference_ms": 4.32101834565326, "mean_action_processing_ms": 2.2542718413967164, "mean_env_wait_ms": 0.8709674096538776, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035094022750854492, "StateBufferConnector_ms": 0.003307342529296875, "ViewRequirementAgentConnector_ms": 0.11998462677001953}, "num_episodes": 18, "episode_return_max": 689.7185633947763, "episode_return_min": -1017.5248519729216, "episode_return_mean": 72.94551291798071, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 944000, "num_agent_steps_trained": 944000, "num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 82.95071488163389, "num_env_steps_trained_throughput_per_sec": 82.95071488163389, "timesteps_total": 236000, "num_env_steps_sampled_lifetime": 236000, "num_agent_steps_sampled_lifetime": 944000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 944000, "timers": {"training_iteration_time_ms": 49276.017, "restore_workers_time_ms": 0.013, "training_step_time_ms": 49275.965, "sample_time_ms": 1345.26, "learn_time_ms": 47912.382, "learn_throughput": 83.486, "synch_weights_time_ms": 14.746}, "counters": {"num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_agent_steps_sampled": 944000, "num_agent_steps_trained": 944000}, "done": false, "training_iteration": 59, "trial_id": "cf3bb_00000", "date": "2024-08-20_09-33-26", "timestamp": 1724126606, "time_this_iter_s": 48.26838994026184, "time_total_s": 10869.149724245071, "pid": 25777, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39f78f280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 10869.149724245071, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 35.97391304347828, "ram_util_percent": 82.76811594202901}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6718809709741325, "cur_kl_coeff": 0.030033874511718742, "cur_lr": 0.00010000000000000003, "total_loss": 8.046767106384197, "policy_loss": -0.004056751701448645, "vf_loss": 8.050372181998359, "vf_explained_var": -0.0021125356356302897, "kl": 0.015038960422602537, "entropy": 1.2952262124687275, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 112455.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 12.094023271622481, "cur_kl_coeff": 0.0421875, "cur_lr": 0.00010000000000000003, "total_loss": 8.238873025601503, "policy_loss": -0.00178864664193637, "vf_loss": 8.240204489168036, "vf_explained_var": 0.21502519454905597, "kl": 0.01083688874812503, "entropy": 0.9227256018648703, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 112455.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_agent_steps_sampled": 960000, "num_agent_steps_trained": 960000}, "env_runners": {"episode_reward_max": 951.057426925226, "episode_reward_min": -1017.5248519729216, "episode_reward_mean": 89.83707847771119, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1764.2829891345593, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 1603.0207236130914}, "policy_reward_mean": {"prey_policy": -333.4042369755144, "predator_policy": 378.3227762143699}, "custom_metrics": {}, "hist_stats": {"episode_reward": [130.29999999999941, -31.72461524695493, 186.3588558962258, -14.491337568194016, 137.79999999999995, 131.09999999999937, 211.10833166812733, 89.5548826887298, 380.8, 128.09999999999974, 92.0, 56.46683245877613, 75.39999999999998, 27.523295997987386, -74.62303458229306, 248.19565789996366, 19.340493344722546, 50.00000000000001, 207.7999999999993, -96.31174523824153, 117.5, -42.2680960851769, 165.77535625036333, -54.86910220831129, -112.01593975808322, 428.4011776204216, 185.5999999999998, -72.98964548078722, -59.34087151254692, 152.49548220024872, 352.0, 24.40000000000001, 400.0, 98.90000000000006, -102.22672075796288, 193.40000000000003, 384.1, 132.2739048004288, -46.827541766875186, 3.5892258972032787, 64.0442417402625, 355.4015105596152, 171.42634119813889, 164.78433241611572, 35.3, 25.9, 77.27739354095539, 177.18317471917908, 61.10000000000004, 657.0293832459636, 94.02267493629816, -583.4554096340432, 93.39999999999998, -458.90122014996416, 127.60000000000002, 70.89999999999998, 195.2, 78.0999999999998, 245.14656157484524, 55.0, -1017.5248519729216, 92.56527427814169, 548.9740118659074, -224.50858377598735, 3.9965908508580488, 105.10000000000004, 689.7185633947763, 232.70208108183573, 128.53557937382394, -90.66615041461402, 118.15471120719957, -808.8390441792928, 0.8859905554322742, 113.70000000000016, 240.45921607009066, 29.947586132309773, 51.3, 106.20000000000006, 5.318254353937693, 25.300000000000004, 114.49999999999982, 82.62754328757579, 133.8, 81.3, 381.4, -42.956956151016215, -84.30354616216945, 94.49999999999974, 37.35488202820935, -137.2260049821877, 951.057426925226, 133.9000000000001, -311.0524151291321, 778.0945691152099, 108.07119681509262, 211.64229609061954, 86.7289623629614, 249.25961955235613, 200.43514095612952, -245.79792642439008], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-94.33595619629835, -37.386048686801495, -326.76815265980565, -417.7942785030481, -1.898323141951213, -3.2473455835867284, -131.75647313747564, -217.26961871131869, -29.25405011635715, -161.60900216290398, -83.00779532519356, -55.00800475845119, 193.97748693419004, -121.51080591678041, -354.6626223458782, 20.000000000000014, 195.31226065907003, 182.48405329656762, -30.041632807587604, -117.13525569433418, -987.4315548135141, -146.44918311267259, -103.43627820780455, -102.6391947625295, -975.8510608792182, -130.60604411136984, -197.90254683076873, -304.58659129792375, -168.479840429428, -235.28298295300888, 79.28391732587923, 33.43839429705933, -332.996487084253, -265.5756152560191, -1095.504848430838, -277.6850409282788, 190.80783196463398, -84.60658268722341, -232.48355048424776, -968.0994271412314, -9.16398216294312, -1300.94750279114, -331.88833782999785, -366.9831879942964, 99.02111161634791, -708.5346662348352, -324.3463366873916, -249.71163128870938, -532.0892196464946, -312.0520398611161, 193.9983053171864, -555.2839860203321, -173.40521347452523, 139.49180620880807, -497.2005102798149, -298.3425928143353, -307.7708924371626, -386.0316487214693, 2.1670286376802803, -36.82407380305629, 133.8301907945934, 129.13886099051342, -355.2608817907012, -148.40809749960695, 200.0, 200.0, -53.426976491744284, -672.4790134090279, -484.511632144515, -391.7709895497415, 161.36217728905456, -879.6644070558681, 195.2738268141588, 159.60876381751788, -114.01353264822313, 45.43472838485635, -232.69251131209913, -296.7270742399903, -121.43528271293363, -150.80939061175317, -121.56743707712884, -493.53258923910835, 138.24270123546046, 165.36328417373724, -172.49852295479312, 52.62378511632914, -383.0892776258843, 18.21742711303157, -245.1855493980617, -1180.7255982227034, -387.7944764778108, -166.3788351927438, -139.98041255068472, -167.6367958469247, -47.187026739392934, -41.0506801951515, -161.09867350713733, -724.5243978819334, 193.98776009534768, -1307.124863217215, -169.102983459617, -268.9706060973471, -899.4349218709391, -681.4416254455081, -120.12978648280546, -956.5742073267191, -688.6654636937444, -759.9450718923927, -685.831982998154, -98.07246388049012, -232.32692093800085, 3.3127172000187337, 192.3865140772039, -1363.4825858860752, -408.1948656859723, -179.0595393358169, 66.61382289752521, -13.934891407796052, -159.70769586158679, -1199.1151660075732, -1058.6603858788544, -1247.4666128169506, 4.322246611629687, -272.49007459004696, -1138.8617115328616, 175.37740473519352, -404.75239344059065, -571.9409402870549, -290.1989532704503, -247.58474225551208, -509.06128922206346, -34.64964686935811, 196.25029152073387, -1241.484609726244, -48.23899142118199, 112.49325216094668, -482.1413620059482, -1.8654693188254408, -403.43644346790546, -232.45951270935075, -23.71976986160591, -119.77431197496037, -1538.5604134542507, -1643.238366313578, -428.2314658653164, -484.589921602304, -60.626321209417, -387.98136502937723, 53.02911993066512, 74.68122991467663, -304.15118802455413, -332.15615643810986, -1042.311389077327, -295.9506167028149, -40.106893465257414, -775.5581483117093, -365.4034955029921, -335.7259687437632, -350.46909404100995, -856.7569323179274, -75.82923214495247, -75.67161482329266, -485.68823469017855, 31.587138519422137, -1440.6005540300423, 68.93841836626606, -1476.2576647678175, -87.80024278440112, 171.28280425621824, 190.70708915421224, -111.10671178148837, -286.3843678200389, -1309.547863141498, -1566.3687451624016, -111.32782111685847, -524.2227260461771, -69.61427890909403, -270.91988868202134, -1000.8853007327837, -1181.1584152308571, -1239.4576354687647, 187.2170786367233, -29.423384767629642, -845.6214804155793, -1383.5028356063056, -861.6070685261849, -1267.8815742828647, 167.01734304732787, -370.60211678446245, -217.34647872877653, 20.000000000000014, -357.908198179765, -159.37011451462104, -39.999543633365434, 107.1149397687146, -43.17976378635444, -125.58536962452125, -122.90805599412528, -1446.13555885198, -1764.2829891345593], "policy_predator_policy_reward": [208.33595619629853, 53.686048686801726, 391.3220087889232, 321.515807126975, 178.65775111621383, 12.846773505549994, 2.14762331031352, 332.3871309702866, 158.25405011635715, 170.4090021629039, 198.00779532519357, 71.10800475845092, 40.30650251310307, 98.33514813761452, 353.7827212799458, 70.4347837546624, 0.9877393409299676, 2.015946703432381, 44.48998237813831, 230.78690612378375, 987.4315548135141, 238.44918311267264, 262.54230542911034, 0.0, 975.9510608792182, 205.9060441113697, 183.67899810412504, 346.3334360225543, 315.67308156921865, 13.466707230925316, 57.847024013404535, 77.62632226362051, 348.1011813953601, 269.81141428963446, 1095.504848430838, 327.68504092827885, 0.9921680353660393, 100.60658268722254, 136.17180524600553, 968.0994271412314, 126.16398216294306, 1301.4475027911399, 440.61237502028314, 215.99105471883453, 64.25424463401544, 711.0346662348352, 163.94148422333234, 355.2473815444573, 256.8976031655954, 475.22771658393225, 348.90715827458706, 440.77970004898043, 0.0, 219.5134072657171, 452.6876452197077, 269.86581239365444, 414.93187709150806, 219.52979255457672, 180.06592592131236, 7.086601444312562, 38.1698092054066, 50.861139009486564, 367.2608817907012, 160.80809749960625, 0.0, 0.0, 147.22697649174415, 677.579013409028, 572.931973558619, 201.1239273776748, 28.637822710945443, 883.0644070558678, 1.8261731858411925, 27.39123618248212, 1.6774555517876995, 199.17525351200794, 317.00328917586495, 165.58875460934945, 215.8913571901761, 59.94254203171365, 333.429668095363, 345.714599961137, 39.30063451387998, 12.494890636537527, 248.74445261173378, 42.556626424869165, 399.2924203926418, 130.36376253632722, 280.2855493980618, 1180.9255982227035, 401.7944764778108, 178.27883519274312, 276.9892213088933, 107.90538062967134, 205.06407701011887, 60.35680464360465, 217.0986735071371, 729.6243978819334, 520.4994875268852, 1249.666998840946, 292.0374234255978, 240.05884106766462, 994.6131908583016, 2.8079468241021677, 212.02978648280552, 958.074207326719, 495.87342539489833, 493.8358900412736, 691.431982998154, 220.07246388049012, 284.326920938001, 15.587282799981232, 2.8134859227960964, 1363.4825858860752, 415.29486568597196, 250.05953933581694, 45.52754426645575, 146.94008581866032, 213.70769586158676, 1200.1151660075732, 0.0, 1288.6021467228834, 134.3860539627943, 226.34704829376415, 511.75988718414135, 1000.6984314794344, 262.0777952530908, 490.1069546985677, 371.4806792137395, 170.29960716308085, 512.6612892220633, 136.14964686935807, 1226.5343182055099, 508.4185633947765, 160.64661714721174, 7.801203194859294, 259.9451996181262, 352.5972110804719, 175.70625415045868, 369.5235516121832, 250.68028406419745, 10.968508979568345, 796.1858353690247, 1576.7739002195106, 459.0699396951493, 454.6374383279033, 165.626321209417, 396.6813650293772, 25.613239432509403, 87.1356267922395, 433.4548990132427, 232.80003158173147, 1042.5113890773273, 347.0506167028149, 786.7013562181799, 135.16368555878668, 451.9078942858377, 254.5398243148551, 374.66909404100994, 857.8569323179273, 176.82923214495247, 89.17161482329197, 501.68823469017843, 35.04040476815362, 1440.6005540300423, 64.861581633734, 1476.5576647678174, 168.80024278440118, 15.917195743781749, 3.492910845787757, 353.4726593955645, 1.0614640549463696, 1494.0231117756691, 1297.5899503660612, 195.32782111685847, 534.7227260461773, 14.230722173263755, 363.658327446061, 1146.8348174854718, 897.9828934959813, 1066.0355660754074, 937.2624176818599, 154.42338476762976, 854.5214804155794, 1396.9028356063054, 537.1546533970529, 712.1546340640782, 1166.8041662866685, 351.7462922408013, 344.27350008753024, 227.46804748004462, 322.08244679034016, 107.87082606835405, 178.22779444259376, 179.27502702528972, 6.049416544706038, 225.41311331541667, 223.51545325935922, 1361.5998979490578, 1603.0207236130914]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3427500861352528, "mean_inference_ms": 4.272842957591999, "mean_action_processing_ms": 2.2132481078037873, "mean_env_wait_ms": 0.8555810966394485, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003915667533874512, "StateBufferConnector_ms": 0.00419163703918457, "ViewRequirementAgentConnector_ms": 0.15343976020812988}, "num_episodes": 23, "episode_return_max": 951.057426925226, "episode_return_min": -1017.5248519729216, "episode_return_mean": 89.83707847771119, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 960000, "num_agent_steps_trained": 960000, "num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 83.19231887081813, "num_env_steps_trained_throughput_per_sec": 83.19231887081813, "timesteps_total": 240000, "num_env_steps_sampled_lifetime": 240000, "num_agent_steps_sampled_lifetime": 960000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 960000, "timers": {"training_iteration_time_ms": 49069.138, "restore_workers_time_ms": 0.014, "training_step_time_ms": 49069.084, "sample_time_ms": 1368.745, "learn_time_ms": 47681.166, "learn_throughput": 83.891, "synch_weights_time_ms": 15.087}, "counters": {"num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_agent_steps_sampled": 960000, "num_agent_steps_trained": 960000}, "done": false, "training_iteration": 60, "trial_id": "cf3bb_00000", "date": "2024-08-20_09-34-14", "timestamp": 1724126654, "time_this_iter_s": 48.1277539730072, "time_total_s": 10917.277478218079, "pid": 25777, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39f7820d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 10917.277478218079, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 35.937681159420286, "ram_util_percent": 82.5927536231884}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9847805534563367, "cur_kl_coeff": 0.030033874511718742, "cur_lr": 0.00010000000000000003, "total_loss": 6.632146491953936, "policy_loss": -0.0029129375736894354, "vf_loss": 6.634607266875171, "vf_explained_var": -0.002164507542968427, "kl": 0.015055066954453003, "entropy": 1.29563394318182, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 114345.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 19.388400428604196, "cur_kl_coeff": 0.0421875, "cur_lr": 0.00010000000000000003, "total_loss": 7.777649198007332, "policy_loss": -0.001357030064833385, "vf_loss": 7.7786934991362235, "vf_explained_var": 0.2251435866116216, "kl": 0.007412536349190986, "entropy": 0.8405767232337326, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 114345.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_agent_steps_sampled": 976000, "num_agent_steps_trained": 976000}, "env_runners": {"episode_reward_max": 951.057426925226, "episode_reward_min": -1017.5248519729216, "episode_reward_mean": 105.76345384331547, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1764.2829891345593, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 1603.0207236130914}, "policy_reward_mean": {"prey_policy": -344.8370069338987, "predator_policy": 397.7187338555565}, "custom_metrics": {}, "hist_stats": {"episode_reward": [207.7999999999993, -96.31174523824153, 117.5, -42.2680960851769, 165.77535625036333, -54.86910220831129, -112.01593975808322, 428.4011776204216, 185.5999999999998, -72.98964548078722, -59.34087151254692, 152.49548220024872, 352.0, 24.40000000000001, 400.0, 98.90000000000006, -102.22672075796288, 193.40000000000003, 384.1, 132.2739048004288, -46.827541766875186, 3.5892258972032787, 64.0442417402625, 355.4015105596152, 171.42634119813889, 164.78433241611572, 35.3, 25.9, 77.27739354095539, 177.18317471917908, 61.10000000000004, 657.0293832459636, 94.02267493629816, -583.4554096340432, 93.39999999999998, -458.90122014996416, 127.60000000000002, 70.89999999999998, 195.2, 78.0999999999998, 245.14656157484524, 55.0, -1017.5248519729216, 92.56527427814169, 548.9740118659074, -224.50858377598735, 3.9965908508580488, 105.10000000000004, 689.7185633947763, 232.70208108183573, 128.53557937382394, -90.66615041461402, 118.15471120719957, -808.8390441792928, 0.8859905554322742, 113.70000000000016, 240.45921607009066, 29.947586132309773, 51.3, 106.20000000000006, 5.318254353937693, 25.300000000000004, 114.49999999999982, 82.62754328757579, 133.8, 81.3, 381.4, -42.956956151016215, -84.30354616216945, 94.49999999999974, 37.35488202820935, -137.2260049821877, 951.057426925226, 133.9000000000001, -311.0524151291321, 778.0945691152099, 108.07119681509262, 211.64229609061954, 86.7289623629614, 249.25961955235613, 200.43514095612952, -245.79792642439008, 168.19345716851836, 102.5, 224.77158080245, 237.86194755764967, 249.4777502059469, 188.9999999999996, 35.30000000000023, 66.34234265344742, 21.0, 245.79431128080736, 175.5999999999996, 466.2521205565849, 481.1236402748877, 214.49999999999926, 111.32153798772671, 85.09999999999982, 251.53603195889008, 110.17217867061048], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [190.80783196463398, -84.60658268722341, -232.48355048424776, -968.0994271412314, -9.16398216294312, -1300.94750279114, -331.88833782999785, -366.9831879942964, 99.02111161634791, -708.5346662348352, -324.3463366873916, -249.71163128870938, -532.0892196464946, -312.0520398611161, 193.9983053171864, -555.2839860203321, -173.40521347452523, 139.49180620880807, -497.2005102798149, -298.3425928143353, -307.7708924371626, -386.0316487214693, 2.1670286376802803, -36.82407380305629, 133.8301907945934, 129.13886099051342, -355.2608817907012, -148.40809749960695, 200.0, 200.0, -53.426976491744284, -672.4790134090279, -484.511632144515, -391.7709895497415, 161.36217728905456, -879.6644070558681, 195.2738268141588, 159.60876381751788, -114.01353264822313, 45.43472838485635, -232.69251131209913, -296.7270742399903, -121.43528271293363, -150.80939061175317, -121.56743707712884, -493.53258923910835, 138.24270123546046, 165.36328417373724, -172.49852295479312, 52.62378511632914, -383.0892776258843, 18.21742711303157, -245.1855493980617, -1180.7255982227034, -387.7944764778108, -166.3788351927438, -139.98041255068472, -167.6367958469247, -47.187026739392934, -41.0506801951515, -161.09867350713733, -724.5243978819334, 193.98776009534768, -1307.124863217215, -169.102983459617, -268.9706060973471, -899.4349218709391, -681.4416254455081, -120.12978648280546, -956.5742073267191, -688.6654636937444, -759.9450718923927, -685.831982998154, -98.07246388049012, -232.32692093800085, 3.3127172000187337, 192.3865140772039, -1363.4825858860752, -408.1948656859723, -179.0595393358169, 66.61382289752521, -13.934891407796052, -159.70769586158679, -1199.1151660075732, -1058.6603858788544, -1247.4666128169506, 4.322246611629687, -272.49007459004696, -1138.8617115328616, 175.37740473519352, -404.75239344059065, -571.9409402870549, -290.1989532704503, -247.58474225551208, -509.06128922206346, -34.64964686935811, 196.25029152073387, -1241.484609726244, -48.23899142118199, 112.49325216094668, -482.1413620059482, -1.8654693188254408, -403.43644346790546, -232.45951270935075, -23.71976986160591, -119.77431197496037, -1538.5604134542507, -1643.238366313578, -428.2314658653164, -484.589921602304, -60.626321209417, -387.98136502937723, 53.02911993066512, 74.68122991467663, -304.15118802455413, -332.15615643810986, -1042.311389077327, -295.9506167028149, -40.106893465257414, -775.5581483117093, -365.4034955029921, -335.7259687437632, -350.46909404100995, -856.7569323179274, -75.82923214495247, -75.67161482329266, -485.68823469017855, 31.587138519422137, -1440.6005540300423, 68.93841836626606, -1476.2576647678175, -87.80024278440112, 171.28280425621824, 190.70708915421224, -111.10671178148837, -286.3843678200389, -1309.547863141498, -1566.3687451624016, -111.32782111685847, -524.2227260461771, -69.61427890909403, -270.91988868202134, -1000.8853007327837, -1181.1584152308571, -1239.4576354687647, 187.2170786367233, -29.423384767629642, -845.6214804155793, -1383.5028356063056, -861.6070685261849, -1267.8815742828647, 167.01734304732787, -370.60211678446245, -217.34647872877653, 20.000000000000014, -357.908198179765, -159.37011451462104, -39.999543633365434, 107.1149397687146, -43.17976378635444, -125.58536962452125, -122.90805599412528, -1446.13555885198, -1764.2829891345593, -18.275373980406002, 61.91099256985319, -816.3009130281584, -100.14722568339869, 86.33252927904589, -161.54375130379782, -111.86268614847731, 46.10721819813392, 31.259252408839224, -6.645958967533474, 120.45970577207108, -276.71267113769176, 20.000000000000014, -175.93686080766614, -233.04405576543363, -332.73987619295133, -310.1315821099161, -1111.3396270335586, -188.2077442194059, -44.49767157124259, 118.24547621004743, -114.68064506644683, -398.9756130025986, -1492.97832414666, -1577.1384138691612, 149.1954347217781, -53.69129494527316, 199.1, -38.97003852733433, 18.76240232753737, -113.19479955469798, 20.000000000000014, -438.490195950874, -1007.4538399163059, -438.636520136427, -398.94784243138844], "policy_predator_policy_reward": [0.9921680353660393, 100.60658268722254, 136.17180524600553, 968.0994271412314, 126.16398216294306, 1301.4475027911399, 440.61237502028314, 215.99105471883453, 64.25424463401544, 711.0346662348352, 163.94148422333234, 355.2473815444573, 256.8976031655954, 475.22771658393225, 348.90715827458706, 440.77970004898043, 0.0, 219.5134072657171, 452.6876452197077, 269.86581239365444, 414.93187709150806, 219.52979255457672, 180.06592592131236, 7.086601444312562, 38.1698092054066, 50.861139009486564, 367.2608817907012, 160.80809749960625, 0.0, 0.0, 147.22697649174415, 677.579013409028, 572.931973558619, 201.1239273776748, 28.637822710945443, 883.0644070558678, 1.8261731858411925, 27.39123618248212, 1.6774555517876995, 199.17525351200794, 317.00328917586495, 165.58875460934945, 215.8913571901761, 59.94254203171365, 333.429668095363, 345.714599961137, 39.30063451387998, 12.494890636537527, 248.74445261173378, 42.556626424869165, 399.2924203926418, 130.36376253632722, 280.2855493980618, 1180.9255982227035, 401.7944764778108, 178.27883519274312, 276.9892213088933, 107.90538062967134, 205.06407701011887, 60.35680464360465, 217.0986735071371, 729.6243978819334, 520.4994875268852, 1249.666998840946, 292.0374234255978, 240.05884106766462, 994.6131908583016, 2.8079468241021677, 212.02978648280552, 958.074207326719, 495.87342539489833, 493.8358900412736, 691.431982998154, 220.07246388049012, 284.326920938001, 15.587282799981232, 2.8134859227960964, 1363.4825858860752, 415.29486568597196, 250.05953933581694, 45.52754426645575, 146.94008581866032, 213.70769586158676, 1200.1151660075732, 0.0, 1288.6021467228834, 134.3860539627943, 226.34704829376415, 511.75988718414135, 1000.6984314794344, 262.0777952530908, 490.1069546985677, 371.4806792137395, 170.29960716308085, 512.6612892220633, 136.14964686935807, 1226.5343182055099, 508.4185633947765, 160.64661714721174, 7.801203194859294, 259.9451996181262, 352.5972110804719, 175.70625415045868, 369.5235516121832, 250.68028406419745, 10.968508979568345, 796.1858353690247, 1576.7739002195106, 459.0699396951493, 454.6374383279033, 165.626321209417, 396.6813650293772, 25.613239432509403, 87.1356267922395, 433.4548990132427, 232.80003158173147, 1042.5113890773273, 347.0506167028149, 786.7013562181799, 135.16368555878668, 451.9078942858377, 254.5398243148551, 374.66909404100994, 857.8569323179273, 176.82923214495247, 89.17161482329197, 501.68823469017843, 35.04040476815362, 1440.6005540300423, 64.861581633734, 1476.5576647678174, 168.80024278440118, 15.917195743781749, 3.492910845787757, 353.4726593955645, 1.0614640549463696, 1494.0231117756691, 1297.5899503660612, 195.32782111685847, 534.7227260461773, 14.230722173263755, 363.658327446061, 1146.8348174854718, 897.9828934959813, 1066.0355660754074, 937.2624176818599, 154.42338476762976, 854.5214804155794, 1396.9028356063054, 537.1546533970529, 712.1546340640782, 1166.8041662866685, 351.7462922408013, 344.27350008753024, 227.46804748004462, 322.08244679034016, 107.87082606835405, 178.22779444259376, 179.27502702528972, 6.049416544706038, 225.41311331541667, 223.51545325935922, 1361.5998979490578, 1603.0207236130914, 108.69048455459335, 15.867354024478637, 817.8009130281584, 201.1472256833987, 299.98280282720185, 0.0, 188.89269856021855, 114.7247169477745, 151.1600194645667, 73.70443730007442, 56.540294227928925, 288.7126711376919, 0.0, 191.2368608076653, 351.8664025591988, 280.2598720526336, 331.1315821099161, 1111.3396270335586, 205.6391887400205, 272.8605383314352, 43.75452378995252, 128.280645066447, 1065.2479277432512, 1292.958129962592, 1508.6942870000548, 400.3723324222153, 69.09129494527302, 0.0, 32.62449183084517, 98.9046823566789, 0.0, 178.2947995546981, 685.6262279097657, 1011.853839916306, 461.9356841978732, 485.82085704055294]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3329299648161645, "mean_inference_ms": 4.23169107745289, "mean_action_processing_ms": 2.183539775992396, "mean_env_wait_ms": 0.8457011319737782, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004137158393859863, "StateBufferConnector_ms": 0.004238486289978027, "ViewRequirementAgentConnector_ms": 0.15576159954071045}, "num_episodes": 18, "episode_return_max": 951.057426925226, "episode_return_min": -1017.5248519729216, "episode_return_mean": 105.76345384331547, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 976000, "num_agent_steps_trained": 976000, "num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 84.08748213283044, "num_env_steps_trained_throughput_per_sec": 84.08748213283044, "timesteps_total": 244000, "num_env_steps_sampled_lifetime": 244000, "num_agent_steps_sampled_lifetime": 976000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 976000, "timers": {"training_iteration_time_ms": 48788.201, "restore_workers_time_ms": 0.014, "training_step_time_ms": 48788.148, "sample_time_ms": 1349.205, "learn_time_ms": 47419.762, "learn_throughput": 84.353, "synch_weights_time_ms": 15.052}, "counters": {"num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_agent_steps_sampled": 976000, "num_agent_steps_trained": 976000}, "done": false, "training_iteration": 61, "trial_id": "cf3bb_00000", "date": "2024-08-20_09-35-02", "timestamp": 1724126702, "time_this_iter_s": 47.59177803993225, "time_total_s": 10964.86925625801, "pid": 25777, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39f78fb80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 10964.86925625801, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 34.00597014925374, "ram_util_percent": 82.26417910447762}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6221217429630025, "cur_kl_coeff": 0.030033874511718742, "cur_lr": 0.00010000000000000003, "total_loss": 6.868164118761738, "policy_loss": -0.0018073366212082052, "vf_loss": 6.8696448656617015, "vf_explained_var": -0.001927873823377821, "kl": 0.01087463751220378, "entropy": 1.22459521154878, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 116235.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 15.071616209436346, "cur_kl_coeff": 0.0421875, "cur_lr": 0.00010000000000000003, "total_loss": 7.634466982392407, "policy_loss": -0.0062942884650534735, "vf_loss": 7.640369991524509, "vf_explained_var": 0.24689049846911557, "kl": 0.009274446844218525, "entropy": 0.846615612191498, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 116235.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_agent_steps_sampled": 992000, "num_agent_steps_trained": 992000}, "env_runners": {"episode_reward_max": 951.057426925226, "episode_reward_min": -1017.5248519729216, "episode_reward_mean": 123.29496811408852, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1764.2829891345593, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 199.1, "predator_policy": 1603.0207236130914}, "policy_reward_mean": {"prey_policy": -354.0724225290227, "predator_policy": 415.71990658606694}, "custom_metrics": {}, "hist_stats": {"episode_reward": [384.1, 132.2739048004288, -46.827541766875186, 3.5892258972032787, 64.0442417402625, 355.4015105596152, 171.42634119813889, 164.78433241611572, 35.3, 25.9, 77.27739354095539, 177.18317471917908, 61.10000000000004, 657.0293832459636, 94.02267493629816, -583.4554096340432, 93.39999999999998, -458.90122014996416, 127.60000000000002, 70.89999999999998, 195.2, 78.0999999999998, 245.14656157484524, 55.0, -1017.5248519729216, 92.56527427814169, 548.9740118659074, -224.50858377598735, 3.9965908508580488, 105.10000000000004, 689.7185633947763, 232.70208108183573, 128.53557937382394, -90.66615041461402, 118.15471120719957, -808.8390441792928, 0.8859905554322742, 113.70000000000016, 240.45921607009066, 29.947586132309773, 51.3, 106.20000000000006, 5.318254353937693, 25.300000000000004, 114.49999999999982, 82.62754328757579, 133.8, 81.3, 381.4, -42.956956151016215, -84.30354616216945, 94.49999999999974, 37.35488202820935, -137.2260049821877, 951.057426925226, 133.9000000000001, -311.0524151291321, 778.0945691152099, 108.07119681509262, 211.64229609061954, 86.7289623629614, 249.25961955235613, 200.43514095612952, -245.79792642439008, 168.19345716851836, 102.5, 224.77158080245, 237.86194755764967, 249.4777502059469, 188.9999999999996, 35.30000000000023, 66.34234265344742, 21.0, 245.79431128080736, 175.5999999999996, 466.2521205565849, 481.1236402748877, 214.49999999999926, 111.32153798772671, 85.09999999999982, 251.53603195889008, 110.17217867061048, 311.20868216389346, -40.327544917535604, 57.599999999999994, 248.95378721600056, 60.10000000000001, 45.52711704124903, 259.1278852570492, -90.12914156322148, 318.44096034307125, 897.3901915430515, 392.112428770412, 43.34257111589913, 61.900000000000006, 80.96859952979294, 142.3, 55.30000000000001, 312.18578560756794, 383.4], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [195.2738268141588, 159.60876381751788, -114.01353264822313, 45.43472838485635, -232.69251131209913, -296.7270742399903, -121.43528271293363, -150.80939061175317, -121.56743707712884, -493.53258923910835, 138.24270123546046, 165.36328417373724, -172.49852295479312, 52.62378511632914, -383.0892776258843, 18.21742711303157, -245.1855493980617, -1180.7255982227034, -387.7944764778108, -166.3788351927438, -139.98041255068472, -167.6367958469247, -47.187026739392934, -41.0506801951515, -161.09867350713733, -724.5243978819334, 193.98776009534768, -1307.124863217215, -169.102983459617, -268.9706060973471, -899.4349218709391, -681.4416254455081, -120.12978648280546, -956.5742073267191, -688.6654636937444, -759.9450718923927, -685.831982998154, -98.07246388049012, -232.32692093800085, 3.3127172000187337, 192.3865140772039, -1363.4825858860752, -408.1948656859723, -179.0595393358169, 66.61382289752521, -13.934891407796052, -159.70769586158679, -1199.1151660075732, -1058.6603858788544, -1247.4666128169506, 4.322246611629687, -272.49007459004696, -1138.8617115328616, 175.37740473519352, -404.75239344059065, -571.9409402870549, -290.1989532704503, -247.58474225551208, -509.06128922206346, -34.64964686935811, 196.25029152073387, -1241.484609726244, -48.23899142118199, 112.49325216094668, -482.1413620059482, -1.8654693188254408, -403.43644346790546, -232.45951270935075, -23.71976986160591, -119.77431197496037, -1538.5604134542507, -1643.238366313578, -428.2314658653164, -484.589921602304, -60.626321209417, -387.98136502937723, 53.02911993066512, 74.68122991467663, -304.15118802455413, -332.15615643810986, -1042.311389077327, -295.9506167028149, -40.106893465257414, -775.5581483117093, -365.4034955029921, -335.7259687437632, -350.46909404100995, -856.7569323179274, -75.82923214495247, -75.67161482329266, -485.68823469017855, 31.587138519422137, -1440.6005540300423, 68.93841836626606, -1476.2576647678175, -87.80024278440112, 171.28280425621824, 190.70708915421224, -111.10671178148837, -286.3843678200389, -1309.547863141498, -1566.3687451624016, -111.32782111685847, -524.2227260461771, -69.61427890909403, -270.91988868202134, -1000.8853007327837, -1181.1584152308571, -1239.4576354687647, 187.2170786367233, -29.423384767629642, -845.6214804155793, -1383.5028356063056, -861.6070685261849, -1267.8815742828647, 167.01734304732787, -370.60211678446245, -217.34647872877653, 20.000000000000014, -357.908198179765, -159.37011451462104, -39.999543633365434, 107.1149397687146, -43.17976378635444, -125.58536962452125, -122.90805599412528, -1446.13555885198, -1764.2829891345593, -18.275373980406002, 61.91099256985319, -816.3009130281584, -100.14722568339869, 86.33252927904589, -161.54375130379782, -111.86268614847731, 46.10721819813392, 31.259252408839224, -6.645958967533474, 120.45970577207108, -276.71267113769176, 20.000000000000014, -175.93686080766614, -233.04405576543363, -332.73987619295133, -310.1315821099161, -1111.3396270335586, -188.2077442194059, -44.49767157124259, 118.24547621004743, -114.68064506644683, -398.9756130025986, -1492.97832414666, -1577.1384138691612, 149.1954347217781, -53.69129494527316, 199.1, -38.97003852733433, 18.76240232753737, -113.19479955469798, 20.000000000000014, -438.490195950874, -1007.4538399163059, -438.636520136427, -398.94784243138844, 96.41197037438039, 116.80449482982146, -419.12697456118116, -368.51270700350125, -1144.9227768673147, -207.14730565508947, 118.41880124534394, -46.775358127534645, -135.29148383385953, -1156.33171322274, -248.4485139101213, -309.43093683301106, 49.17112129666612, 71.70748050662988, -463.0425016885767, -215.0260650626507, -1026.5969578380777, -1594.590148320566, 193.7, -1190.2921349810763, -759.3116685441536, 72.3158132881988, 15.475090311731485, 20.000000000000014, -984.2421870456177, -209.19049051247987, -195.66838386259437, -21.52540580607736, -911.2181083378274, 45.96799950973393, -571.796715688756, -272.6417512913635, 162.9082790668319, 64.32714388128349, 184.59289308161777, 180.77601509442263], "policy_predator_policy_reward": [1.8261731858411925, 27.39123618248212, 1.6774555517876995, 199.17525351200794, 317.00328917586495, 165.58875460934945, 215.8913571901761, 59.94254203171365, 333.429668095363, 345.714599961137, 39.30063451387998, 12.494890636537527, 248.74445261173378, 42.556626424869165, 399.2924203926418, 130.36376253632722, 280.2855493980618, 1180.9255982227035, 401.7944764778108, 178.27883519274312, 276.9892213088933, 107.90538062967134, 205.06407701011887, 60.35680464360465, 217.0986735071371, 729.6243978819334, 520.4994875268852, 1249.666998840946, 292.0374234255978, 240.05884106766462, 994.6131908583016, 2.8079468241021677, 212.02978648280552, 958.074207326719, 495.87342539489833, 493.8358900412736, 691.431982998154, 220.07246388049012, 284.326920938001, 15.587282799981232, 2.8134859227960964, 1363.4825858860752, 415.29486568597196, 250.05953933581694, 45.52754426645575, 146.94008581866032, 213.70769586158676, 1200.1151660075732, 0.0, 1288.6021467228834, 134.3860539627943, 226.34704829376415, 511.75988718414135, 1000.6984314794344, 262.0777952530908, 490.1069546985677, 371.4806792137395, 170.29960716308085, 512.6612892220633, 136.14964686935807, 1226.5343182055099, 508.4185633947765, 160.64661714721174, 7.801203194859294, 259.9451996181262, 352.5972110804719, 175.70625415045868, 369.5235516121832, 250.68028406419745, 10.968508979568345, 796.1858353690247, 1576.7739002195106, 459.0699396951493, 454.6374383279033, 165.626321209417, 396.6813650293772, 25.613239432509403, 87.1356267922395, 433.4548990132427, 232.80003158173147, 1042.5113890773273, 347.0506167028149, 786.7013562181799, 135.16368555878668, 451.9078942858377, 254.5398243148551, 374.66909404100994, 857.8569323179273, 176.82923214495247, 89.17161482329197, 501.68823469017843, 35.04040476815362, 1440.6005540300423, 64.861581633734, 1476.5576647678174, 168.80024278440118, 15.917195743781749, 3.492910845787757, 353.4726593955645, 1.0614640549463696, 1494.0231117756691, 1297.5899503660612, 195.32782111685847, 534.7227260461773, 14.230722173263755, 363.658327446061, 1146.8348174854718, 897.9828934959813, 1066.0355660754074, 937.2624176818599, 154.42338476762976, 854.5214804155794, 1396.9028356063054, 537.1546533970529, 712.1546340640782, 1166.8041662866685, 351.7462922408013, 344.27350008753024, 227.46804748004462, 322.08244679034016, 107.87082606835405, 178.22779444259376, 179.27502702528972, 6.049416544706038, 225.41311331541667, 223.51545325935922, 1361.5998979490578, 1603.0207236130914, 108.69048455459335, 15.867354024478637, 817.8009130281584, 201.1472256833987, 299.98280282720185, 0.0, 188.89269856021855, 114.7247169477745, 151.1600194645667, 73.70443730007442, 56.540294227928925, 288.7126711376919, 0.0, 191.2368608076653, 351.8664025591988, 280.2598720526336, 331.1315821099161, 1111.3396270335586, 205.6391887400205, 272.8605383314352, 43.75452378995252, 128.280645066447, 1065.2479277432512, 1292.958129962592, 1508.6942870000548, 400.3723324222153, 69.09129494527302, 0.0, 32.62449183084517, 98.9046823566789, 0.0, 178.2947995546981, 685.6262279097657, 1011.853839916306, 461.9356841978732, 485.82085704055294, 85.8182122552765, 12.174004704415044, 253.27952716486334, 494.03260948228376, 1145.5227768673149, 264.14730565508967, 36.659022174005486, 140.65132192418577, 191.19148383385942, 1160.53171322274, 335.187369502282, 268.2191982820989, 138.24928345375315, 0.0, 43.577710378248476, 544.3617148097569, 1516.2434106449125, 1423.3846558568025, 809.4405718125724, 1084.5417547115553, 678.3472024500863, 400.76108157628056, 4.224909688268479, 3.6425711158987863, 988.1421870456177, 267.19049051247976, 13.771718223821631, 284.3906709746429, 912.5181083378274, 95.0320004902661, 574.0967156887559, 325.6417512913634, 44.70227502525546, 40.2480876341971, 6.707106918382229, 11.32398490557737]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3232197396224563, "mean_inference_ms": 4.191393619496647, "mean_action_processing_ms": 2.1547287269315984, "mean_env_wait_ms": 0.8360517498806697, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0042351484298706055, "StateBufferConnector_ms": 0.0044214725494384766, "ViewRequirementAgentConnector_ms": 0.15463340282440186}, "num_episodes": 18, "episode_return_max": 951.057426925226, "episode_return_min": -1017.5248519729216, "episode_return_mean": 123.29496811408852, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 992000, "num_agent_steps_trained": 992000, "num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 84.64856378912951, "num_env_steps_trained_throughput_per_sec": 84.64856378912951, "timesteps_total": 248000, "num_env_steps_sampled_lifetime": 248000, "num_agent_steps_sampled_lifetime": 992000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 992000, "timers": {"training_iteration_time_ms": 48474.624, "restore_workers_time_ms": 0.014, "training_step_time_ms": 48474.575, "sample_time_ms": 1309.666, "learn_time_ms": 47145.922, "learn_throughput": 84.843, "synch_weights_time_ms": 14.773}, "counters": {"num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_agent_steps_sampled": 992000, "num_agent_steps_trained": 992000}, "done": false, "training_iteration": 62, "trial_id": "cf3bb_00000", "date": "2024-08-20_09-35-49", "timestamp": 1724126749, "time_this_iter_s": 47.299325942993164, "time_total_s": 11012.168582201004, "pid": 25777, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39ffcc4c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 11012.168582201004, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 35.5, "ram_util_percent": 82.3529411764706}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7515688477093896, "cur_kl_coeff": 0.030033874511718742, "cur_lr": 0.00010000000000000003, "total_loss": 5.70172488525431, "policy_loss": -0.006109059428815883, "vf_loss": 5.707335705731912, "vf_explained_var": 0.0012424234359983415, "kl": 0.016588599683537767, "entropy": 1.1759787826311021, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 118125.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 17.101065701498555, "cur_kl_coeff": 0.0421875, "cur_lr": 0.00010000000000000003, "total_loss": 7.024970386898707, "policy_loss": -0.0020219854893478214, "vf_loss": 7.026790284101295, "vf_explained_var": 0.16864503987882504, "kl": 0.004790142160904985, "entropy": 0.8315404542224117, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 118125.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_agent_steps_sampled": 1008000, "num_agent_steps_trained": 1008000}, "env_runners": {"episode_reward_max": 951.057426925226, "episode_reward_min": -1017.5248519729216, "episode_reward_mean": 132.96516719618626, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1764.2829891345593, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 1603.0207236130914}, "policy_reward_mean": {"prey_policy": -339.14398751375455, "predator_policy": 405.62657111184774}, "custom_metrics": {}, "hist_stats": {"episode_reward": [245.14656157484524, 55.0, -1017.5248519729216, 92.56527427814169, 548.9740118659074, -224.50858377598735, 3.9965908508580488, 105.10000000000004, 689.7185633947763, 232.70208108183573, 128.53557937382394, -90.66615041461402, 118.15471120719957, -808.8390441792928, 0.8859905554322742, 113.70000000000016, 240.45921607009066, 29.947586132309773, 51.3, 106.20000000000006, 5.318254353937693, 25.300000000000004, 114.49999999999982, 82.62754328757579, 133.8, 81.3, 381.4, -42.956956151016215, -84.30354616216945, 94.49999999999974, 37.35488202820935, -137.2260049821877, 951.057426925226, 133.9000000000001, -311.0524151291321, 778.0945691152099, 108.07119681509262, 211.64229609061954, 86.7289623629614, 249.25961955235613, 200.43514095612952, -245.79792642439008, 168.19345716851836, 102.5, 224.77158080245, 237.86194755764967, 249.4777502059469, 188.9999999999996, 35.30000000000023, 66.34234265344742, 21.0, 245.79431128080736, 175.5999999999996, 466.2521205565849, 481.1236402748877, 214.49999999999926, 111.32153798772671, 85.09999999999982, 251.53603195889008, 110.17217867061048, 311.20868216389346, -40.327544917535604, 57.599999999999994, 248.95378721600056, 60.10000000000001, 45.52711704124903, 259.1278852570492, -90.12914156322148, 318.44096034307125, 897.3901915430515, 392.112428770412, 43.34257111589913, 61.900000000000006, 80.96859952979294, 142.3, 55.30000000000001, 312.18578560756794, 383.4, 28.00000000000013, 26.5978602647155, 43.01913439576501, 20.900000000000034, 18.399999999999995, 264.89999999999964, 95.79999999999986, 20.000000000000014, 179.895306973353, 259.6581861266826, 388.0, 122.3399029989163, 195.29999999999964, 1.1000000000000014, 317.0336478778611, -48.2841694332369, 165.4051941004937, 105.99999999999953, 19.5, 384.3, 159.23724441056837, 79.36561199793441], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [66.61382289752521, -13.934891407796052, -159.70769586158679, -1199.1151660075732, -1058.6603858788544, -1247.4666128169506, 4.322246611629687, -272.49007459004696, -1138.8617115328616, 175.37740473519352, -404.75239344059065, -571.9409402870549, -290.1989532704503, -247.58474225551208, -509.06128922206346, -34.64964686935811, 196.25029152073387, -1241.484609726244, -48.23899142118199, 112.49325216094668, -482.1413620059482, -1.8654693188254408, -403.43644346790546, -232.45951270935075, -23.71976986160591, -119.77431197496037, -1538.5604134542507, -1643.238366313578, -428.2314658653164, -484.589921602304, -60.626321209417, -387.98136502937723, 53.02911993066512, 74.68122991467663, -304.15118802455413, -332.15615643810986, -1042.311389077327, -295.9506167028149, -40.106893465257414, -775.5581483117093, -365.4034955029921, -335.7259687437632, -350.46909404100995, -856.7569323179274, -75.82923214495247, -75.67161482329266, -485.68823469017855, 31.587138519422137, -1440.6005540300423, 68.93841836626606, -1476.2576647678175, -87.80024278440112, 171.28280425621824, 190.70708915421224, -111.10671178148837, -286.3843678200389, -1309.547863141498, -1566.3687451624016, -111.32782111685847, -524.2227260461771, -69.61427890909403, -270.91988868202134, -1000.8853007327837, -1181.1584152308571, -1239.4576354687647, 187.2170786367233, -29.423384767629642, -845.6214804155793, -1383.5028356063056, -861.6070685261849, -1267.8815742828647, 167.01734304732787, -370.60211678446245, -217.34647872877653, 20.000000000000014, -357.908198179765, -159.37011451462104, -39.999543633365434, 107.1149397687146, -43.17976378635444, -125.58536962452125, -122.90805599412528, -1446.13555885198, -1764.2829891345593, -18.275373980406002, 61.91099256985319, -816.3009130281584, -100.14722568339869, 86.33252927904589, -161.54375130379782, -111.86268614847731, 46.10721819813392, 31.259252408839224, -6.645958967533474, 120.45970577207108, -276.71267113769176, 20.000000000000014, -175.93686080766614, -233.04405576543363, -332.73987619295133, -310.1315821099161, -1111.3396270335586, -188.2077442194059, -44.49767157124259, 118.24547621004743, -114.68064506644683, -398.9756130025986, -1492.97832414666, -1577.1384138691612, 149.1954347217781, -53.69129494527316, 199.1, -38.97003852733433, 18.76240232753737, -113.19479955469798, 20.000000000000014, -438.490195950874, -1007.4538399163059, -438.636520136427, -398.94784243138844, 96.41197037438039, 116.80449482982146, -419.12697456118116, -368.51270700350125, -1144.9227768673147, -207.14730565508947, 118.41880124534394, -46.775358127534645, -135.29148383385953, -1156.33171322274, -248.4485139101213, -309.43093683301106, 49.17112129666612, 71.70748050662988, -463.0425016885767, -215.0260650626507, -1026.5969578380777, -1594.590148320566, 193.7, -1190.2921349810763, -759.3116685441536, 72.3158132881988, 15.475090311731485, 20.000000000000014, -984.2421870456177, -209.19049051247987, -195.66838386259437, -21.52540580607736, -911.2181083378274, 45.96799950973393, -571.796715688756, -272.6417512913635, 162.9082790668319, 64.32714388128349, 184.59289308161777, 180.77601509442263, 18.076687771813827, -752.0925447617774, -27.343204789355497, -243.4809451780451, -277.8193681175785, -264.8377643440439, -812.2505246796592, -361.3461256011596, -275.06550998720184, -102.07139749410159, 190.70509015467988, 11.966683348714149, -78.98310602445018, -571.8966093168835, 20.000000000000014, -1158.0588537402498, 106.13578845906504, -329.17526929169406, -194.52147026773275, 192.46686480849922, 200.0, 160.19205323307918, -136.35279856342595, -227.44814672219567, -642.6896456178865, 177.39409355456075, -649.9007732967162, -1066.9716314523462, 72.67740308305387, -576.8753979834144, -205.85686330432134, -347.7577922975891, -101.18725130482747, -367.504894855943, -100.27681332837456, -14.640769496874857, -1031.4728724717827, 14.270802484263916, 191.0, 189.54951483127672, -128.90568594592187, -53.84037839019766, -220.09363993479545, -239.864374732423], "policy_predator_policy_reward": [45.52754426645575, 146.94008581866032, 213.70769586158676, 1200.1151660075732, 0.0, 1288.6021467228834, 134.3860539627943, 226.34704829376415, 511.75988718414135, 1000.6984314794344, 262.0777952530908, 490.1069546985677, 371.4806792137395, 170.29960716308085, 512.6612892220633, 136.14964686935807, 1226.5343182055099, 508.4185633947765, 160.64661714721174, 7.801203194859294, 259.9451996181262, 352.5972110804719, 175.70625415045868, 369.5235516121832, 250.68028406419745, 10.968508979568345, 796.1858353690247, 1576.7739002195106, 459.0699396951493, 454.6374383279033, 165.626321209417, 396.6813650293772, 25.613239432509403, 87.1356267922395, 433.4548990132427, 232.80003158173147, 1042.5113890773273, 347.0506167028149, 786.7013562181799, 135.16368555878668, 451.9078942858377, 254.5398243148551, 374.66909404100994, 857.8569323179273, 176.82923214495247, 89.17161482329197, 501.68823469017843, 35.04040476815362, 1440.6005540300423, 64.861581633734, 1476.5576647678174, 168.80024278440118, 15.917195743781749, 3.492910845787757, 353.4726593955645, 1.0614640549463696, 1494.0231117756691, 1297.5899503660612, 195.32782111685847, 534.7227260461773, 14.230722173263755, 363.658327446061, 1146.8348174854718, 897.9828934959813, 1066.0355660754074, 937.2624176818599, 154.42338476762976, 854.5214804155794, 1396.9028356063054, 537.1546533970529, 712.1546340640782, 1166.8041662866685, 351.7462922408013, 344.27350008753024, 227.46804748004462, 322.08244679034016, 107.87082606835405, 178.22779444259376, 179.27502702528972, 6.049416544706038, 225.41311331541667, 223.51545325935922, 1361.5998979490578, 1603.0207236130914, 108.69048455459335, 15.867354024478637, 817.8009130281584, 201.1472256833987, 299.98280282720185, 0.0, 188.89269856021855, 114.7247169477745, 151.1600194645667, 73.70443730007442, 56.540294227928925, 288.7126711376919, 0.0, 191.2368608076653, 351.8664025591988, 280.2598720526336, 331.1315821099161, 1111.3396270335586, 205.6391887400205, 272.8605383314352, 43.75452378995252, 128.280645066447, 1065.2479277432512, 1292.958129962592, 1508.6942870000548, 400.3723324222153, 69.09129494527302, 0.0, 32.62449183084517, 98.9046823566789, 0.0, 178.2947995546981, 685.6262279097657, 1011.853839916306, 461.9356841978732, 485.82085704055294, 85.8182122552765, 12.174004704415044, 253.27952716486334, 494.03260948228376, 1145.5227768673149, 264.14730565508967, 36.659022174005486, 140.65132192418577, 191.19148383385942, 1160.53171322274, 335.187369502282, 268.2191982820989, 138.24928345375315, 0.0, 43.577710378248476, 544.3617148097569, 1516.2434106449125, 1423.3846558568025, 809.4405718125724, 1084.5417547115553, 678.3472024500863, 400.76108157628056, 4.224909688268479, 3.6425711158987863, 988.1421870456177, 267.19049051247976, 13.771718223821631, 284.3906709746429, 912.5181083378274, 95.0320004902661, 574.0967156887559, 325.6417512913634, 44.70227502525546, 40.2480876341971, 6.707106918382229, 11.32398490557737, 1.7233122281861615, 760.2925447617773, 235.50915224094396, 61.912857991171684, 584.8666986188204, 0.8095682385670626, 816.5505246796602, 377.9461256011595, 280.0655099872019, 115.47139749410083, 5.294909845320112, 56.93331665128602, 166.98310602445028, 579.6966093168853, 0.0, 1158.0588537402498, 398.41130601304235, 4.52348179293984, 186.9973541001421, 74.71543748577406, 0.0, 27.80794676692082, 259.98322625774153, 226.15762202679636, 648.989645617888, 11.60590644543923, 651.0007732967164, 1066.9716314523462, 439.9034884354055, 381.3281543428164, 175.5109043228327, 329.8195818458406, 385.91461346500716, 248.18272679625687, 188.47681332837453, 32.440769496875085, 1031.4728724717827, 5.2291975157360495, 0.8119060180647638, 2.938579150658504, 257.4335552467395, 84.54975349994861, 231.40830598201484, 307.9153206831379]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3131495827146358, "mean_inference_ms": 4.136608890870358, "mean_action_processing_ms": 2.1219140651745168, "mean_env_wait_ms": 0.826477076274558, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004425764083862305, "StateBufferConnector_ms": 0.0044738054275512695, "ViewRequirementAgentConnector_ms": 0.13422608375549316}, "num_episodes": 22, "episode_return_max": 951.057426925226, "episode_return_min": -1017.5248519729216, "episode_return_mean": 132.96516719618626, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1008000, "num_agent_steps_trained": 1008000, "num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 84.93035476588065, "num_env_steps_trained_throughput_per_sec": 84.93035476588065, "timesteps_total": 252000, "num_env_steps_sampled_lifetime": 252000, "num_agent_steps_sampled_lifetime": 1008000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1008000, "timers": {"training_iteration_time_ms": 48158.89, "restore_workers_time_ms": 0.014, "training_step_time_ms": 48158.842, "sample_time_ms": 1284.274, "learn_time_ms": 46856.563, "learn_throughput": 85.367, "synch_weights_time_ms": 14.599}, "counters": {"num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_agent_steps_sampled": 1008000, "num_agent_steps_trained": 1008000}, "done": false, "training_iteration": 63, "trial_id": "cf3bb_00000", "date": "2024-08-20_09-36-36", "timestamp": 1724126796, "time_this_iter_s": 47.12956714630127, "time_total_s": 11059.298149347305, "pid": 25777, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39fe35550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 11059.298149347305, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 33.204477611940305, "ram_util_percent": 81.86119402985075}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9407522630360391, "cur_kl_coeff": 0.030033874511718742, "cur_lr": 0.00010000000000000003, "total_loss": 6.191677456053476, "policy_loss": -0.0013453003740992652, "vf_loss": 6.192644504012254, "vf_explained_var": 0.0006004206402591927, "kl": 0.012593843184814062, "entropy": 1.1434865411627229, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 120015.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 12.947883535850616, "cur_kl_coeff": 0.02109375, "cur_lr": 0.00010000000000000003, "total_loss": 7.43103568919752, "policy_loss": -0.0052148133479354404, "vf_loss": 7.43606911790434, "vf_explained_var": 0.21634777837960179, "kl": 0.008599261883109395, "entropy": 0.8172262795387752, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 120015.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 256000, "num_env_steps_trained": 256000, "num_agent_steps_sampled": 1024000, "num_agent_steps_trained": 1024000}, "env_runners": {"episode_reward_max": 951.057426925226, "episode_reward_min": -311.0524151291321, "episode_reward_mean": 166.953890993673, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1764.2829891345593, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 1603.0207236130914}, "policy_reward_mean": {"prey_policy": -288.7268600718813, "predator_policy": 372.2038055687178}, "custom_metrics": {}, "hist_stats": {"episode_reward": [82.62754328757579, 133.8, 81.3, 381.4, -42.956956151016215, -84.30354616216945, 94.49999999999974, 37.35488202820935, -137.2260049821877, 951.057426925226, 133.9000000000001, -311.0524151291321, 778.0945691152099, 108.07119681509262, 211.64229609061954, 86.7289623629614, 249.25961955235613, 200.43514095612952, -245.79792642439008, 168.19345716851836, 102.5, 224.77158080245, 237.86194755764967, 249.4777502059469, 188.9999999999996, 35.30000000000023, 66.34234265344742, 21.0, 245.79431128080736, 175.5999999999996, 466.2521205565849, 481.1236402748877, 214.49999999999926, 111.32153798772671, 85.09999999999982, 251.53603195889008, 110.17217867061048, 311.20868216389346, -40.327544917535604, 57.599999999999994, 248.95378721600056, 60.10000000000001, 45.52711704124903, 259.1278852570492, -90.12914156322148, 318.44096034307125, 897.3901915430515, 392.112428770412, 43.34257111589913, 61.900000000000006, 80.96859952979294, 142.3, 55.30000000000001, 312.18578560756794, 383.4, 28.00000000000013, 26.5978602647155, 43.01913439576501, 20.900000000000034, 18.399999999999995, 264.89999999999964, 95.79999999999986, 20.000000000000014, 179.895306973353, 259.6581861266826, 388.0, 122.3399029989163, 195.29999999999964, 1.1000000000000014, 317.0336478778611, -48.2841694332369, 165.4051941004937, 105.99999999999953, 19.5, 384.3, 159.23724441056837, 79.36561199793441, -44.80916925294588, 43.19448945303683, 347.0, 94.61599164935255, 237.3510685527645, 197.7999999999996, 770.5763566534055, 143.0, 196.0999999999994, 210.09999999999934, 119.99257133963515, 206.1999999999996, 226.5523229402796, 31.40000000000014, 29.338581188048003, 14.599999999999964, 129.25783652682856, 19.162588194258635, 179.60390467532017, 52.53576655392157, 394.3, 186.62262946002957, 380.3432322110856], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-485.68823469017855, 31.587138519422137, -1440.6005540300423, 68.93841836626606, -1476.2576647678175, -87.80024278440112, 171.28280425621824, 190.70708915421224, -111.10671178148837, -286.3843678200389, -1309.547863141498, -1566.3687451624016, -111.32782111685847, -524.2227260461771, -69.61427890909403, -270.91988868202134, -1000.8853007327837, -1181.1584152308571, -1239.4576354687647, 187.2170786367233, -29.423384767629642, -845.6214804155793, -1383.5028356063056, -861.6070685261849, -1267.8815742828647, 167.01734304732787, -370.60211678446245, -217.34647872877653, 20.000000000000014, -357.908198179765, -159.37011451462104, -39.999543633365434, 107.1149397687146, -43.17976378635444, -125.58536962452125, -122.90805599412528, -1446.13555885198, -1764.2829891345593, -18.275373980406002, 61.91099256985319, -816.3009130281584, -100.14722568339869, 86.33252927904589, -161.54375130379782, -111.86268614847731, 46.10721819813392, 31.259252408839224, -6.645958967533474, 120.45970577207108, -276.71267113769176, 20.000000000000014, -175.93686080766614, -233.04405576543363, -332.73987619295133, -310.1315821099161, -1111.3396270335586, -188.2077442194059, -44.49767157124259, 118.24547621004743, -114.68064506644683, -398.9756130025986, -1492.97832414666, -1577.1384138691612, 149.1954347217781, -53.69129494527316, 199.1, -38.97003852733433, 18.76240232753737, -113.19479955469798, 20.000000000000014, -438.490195950874, -1007.4538399163059, -438.636520136427, -398.94784243138844, 96.41197037438039, 116.80449482982146, -419.12697456118116, -368.51270700350125, -1144.9227768673147, -207.14730565508947, 118.41880124534394, -46.775358127534645, -135.29148383385953, -1156.33171322274, -248.4485139101213, -309.43093683301106, 49.17112129666612, 71.70748050662988, -463.0425016885767, -215.0260650626507, -1026.5969578380777, -1594.590148320566, 193.7, -1190.2921349810763, -759.3116685441536, 72.3158132881988, 15.475090311731485, 20.000000000000014, -984.2421870456177, -209.19049051247987, -195.66838386259437, -21.52540580607736, -911.2181083378274, 45.96799950973393, -571.796715688756, -272.6417512913635, 162.9082790668319, 64.32714388128349, 184.59289308161777, 180.77601509442263, 18.076687771813827, -752.0925447617774, -27.343204789355497, -243.4809451780451, -277.8193681175785, -264.8377643440439, -812.2505246796592, -361.3461256011596, -275.06550998720184, -102.07139749410159, 190.70509015467988, 11.966683348714149, -78.98310602445018, -571.8966093168835, 20.000000000000014, -1158.0588537402498, 106.13578845906504, -329.17526929169406, -194.52147026773275, 192.46686480849922, 200.0, 160.19205323307918, -136.35279856342595, -227.44814672219567, -642.6896456178865, 177.39409355456075, -649.9007732967162, -1066.9716314523462, 72.67740308305387, -576.8753979834144, -205.85686330432134, -347.7577922975891, -101.18725130482747, -367.504894855943, -100.27681332837456, -14.640769496874857, -1031.4728724717827, 14.270802484263916, 191.0, 189.54951483127672, -128.90568594592187, -53.84037839019766, -220.09363993479545, -239.864374732423, -1049.13947356494, -1063.6472926068252, -276.9245680158564, -223.2934531663464, 81.78765168795523, 171.6745305862751, -357.20791043550645, -21.047985857563383, -71.51501328022017, 138.14422072130645, 166.41473476288223, -172.3417845199006, -1387.8171033747508, 195.5496997352102, -851.6166223392689, -52.81097229787011, 174.13418420361984, -501.0661494865795, 183.498034493143, 7.874093606486773, -185.75576242232796, 8.603837214734808, -107.55880101882558, 177.96877335091668, -152.09215217705272, 195.76609739596176, -70.1088092945674, -500.42940007363734, -286.7133407533563, -233.53244910057157, -198.3272980212948, -722.9870788566487, -102.27042046202907, 24.289548268950956, -411.7804960755663, -590.9543600891694, 17.367830212547798, 85.33621800626806, -45.441855755352776, -409.0606164466988, 193.65327002640157, 198.06183736829826, 17.46746413610602, 24.624858531306444, -161.8148239228496, -183.63159174144658], "policy_predator_policy_reward": [501.68823469017843, 35.04040476815362, 1440.6005540300423, 64.861581633734, 1476.5576647678174, 168.80024278440118, 15.917195743781749, 3.492910845787757, 353.4726593955645, 1.0614640549463696, 1494.0231117756691, 1297.5899503660612, 195.32782111685847, 534.7227260461773, 14.230722173263755, 363.658327446061, 1146.8348174854718, 897.9828934959813, 1066.0355660754074, 937.2624176818599, 154.42338476762976, 854.5214804155794, 1396.9028356063054, 537.1546533970529, 712.1546340640782, 1166.8041662866685, 351.7462922408013, 344.27350008753024, 227.46804748004462, 322.08244679034016, 107.87082606835405, 178.22779444259376, 179.27502702528972, 6.049416544706038, 225.41311331541667, 223.51545325935922, 1361.5998979490578, 1603.0207236130914, 108.69048455459335, 15.867354024478637, 817.8009130281584, 201.1472256833987, 299.98280282720185, 0.0, 188.89269856021855, 114.7247169477745, 151.1600194645667, 73.70443730007442, 56.540294227928925, 288.7126711376919, 0.0, 191.2368608076653, 351.8664025591988, 280.2598720526336, 331.1315821099161, 1111.3396270335586, 205.6391887400205, 272.8605383314352, 43.75452378995252, 128.280645066447, 1065.2479277432512, 1292.958129962592, 1508.6942870000548, 400.3723324222153, 69.09129494527302, 0.0, 32.62449183084517, 98.9046823566789, 0.0, 178.2947995546981, 685.6262279097657, 1011.853839916306, 461.9356841978732, 485.82085704055294, 85.8182122552765, 12.174004704415044, 253.27952716486334, 494.03260948228376, 1145.5227768673149, 264.14730565508967, 36.659022174005486, 140.65132192418577, 191.19148383385942, 1160.53171322274, 335.187369502282, 268.2191982820989, 138.24928345375315, 0.0, 43.577710378248476, 544.3617148097569, 1516.2434106449125, 1423.3846558568025, 809.4405718125724, 1084.5417547115553, 678.3472024500863, 400.76108157628056, 4.224909688268479, 3.6425711158987863, 988.1421870456177, 267.19049051247976, 13.771718223821631, 284.3906709746429, 912.5181083378274, 95.0320004902661, 574.0967156887559, 325.6417512913634, 44.70227502525546, 40.2480876341971, 6.707106918382229, 11.32398490557737, 1.7233122281861615, 760.2925447617773, 235.50915224094396, 61.912857991171684, 584.8666986188204, 0.8095682385670626, 816.5505246796602, 377.9461256011595, 280.0655099872019, 115.47139749410083, 5.294909845320112, 56.93331665128602, 166.98310602445028, 579.6966093168853, 0.0, 1158.0588537402498, 398.41130601304235, 4.52348179293984, 186.9973541001421, 74.71543748577406, 0.0, 27.80794676692082, 259.98322625774153, 226.15762202679636, 648.989645617888, 11.60590644543923, 651.0007732967164, 1066.9716314523462, 439.9034884354055, 381.3281543428164, 175.5109043228327, 329.8195818458406, 385.91461346500716, 248.18272679625687, 188.47681332837453, 32.440769496875085, 1031.4728724717827, 5.2291975157360495, 0.8119060180647638, 2.938579150658504, 257.4335552467395, 84.54975349994861, 231.40830598201484, 307.9153206831379, 1274.3941188282756, 793.5834780905465, 541.3764688821066, 2.0360417531337456, 83.21234831204477, 10.325469413724901, 467.8970847584164, 4.974803184006042, 0.874812090442773, 169.84704902123548, 191.4220871390812, 12.3049626179371, 1212.9515169899196, 749.8922433030278, 851.6166223392689, 195.81097229787008, 11.365815796380137, 511.6661494865819, 4.988233268328448, 13.739638632041752, 171.8831117918297, 125.26138475539918, 121.65880101882551, 14.131226649083324, 164.49215217705202, 18.386225544318542, 84.50880929456662, 517.4294000736372, 324.1541126603632, 225.43025838161213, 210.62729802129473, 725.2870788566488, 206.45574621549417, 0.7829625044125454, 434.7105300874298, 587.186914271565, 33.874380540295896, 43.02547591620897, 502.5990680351943, 4.439170720778641, 1.6467299735984362, 0.9381626317017274, 115.18749718020405, 29.342809612413582, 320.21235436950724, 405.57729350587493]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3577429640138832, "mean_inference_ms": 3.983731290902372, "mean_action_processing_ms": 2.0885225270504586, "mean_env_wait_ms": 0.8706516076202214, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004408121109008789, "StateBufferConnector_ms": 0.0038346052169799805, "ViewRequirementAgentConnector_ms": 0.12849688529968262}, "num_episodes": 23, "episode_return_max": 951.057426925226, "episode_return_min": -311.0524151291321, "episode_return_mean": 166.953890993673, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1024000, "num_agent_steps_trained": 1024000, "num_env_steps_sampled": 256000, "num_env_steps_trained": 256000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 84.48469078505259, "num_env_steps_trained_throughput_per_sec": 84.48469078505259, "timesteps_total": 256000, "num_env_steps_sampled_lifetime": 256000, "num_agent_steps_sampled_lifetime": 1024000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1024000, "timers": {"training_iteration_time_ms": 48085.37, "restore_workers_time_ms": 0.014, "training_step_time_ms": 48085.323, "sample_time_ms": 1253.783, "learn_time_ms": 46813.319, "learn_throughput": 85.446, "synch_weights_time_ms": 14.863}, "counters": {"num_env_steps_sampled": 256000, "num_env_steps_trained": 256000, "num_agent_steps_sampled": 1024000, "num_agent_steps_trained": 1024000}, "done": false, "training_iteration": 64, "trial_id": "cf3bb_00000", "date": "2024-08-20_09-37-24", "timestamp": 1724126844, "time_this_iter_s": 47.38754725456238, "time_total_s": 11106.685696601868, "pid": 25777, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39fe3d9d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 11106.685696601868, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 38.55223880597014, "ram_util_percent": 82.25223880597014}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8911203061146711, "cur_kl_coeff": 0.030033874511718742, "cur_lr": 0.00010000000000000003, "total_loss": 6.762643380644461, "policy_loss": -0.004439031631099405, "vf_loss": 6.766560539114412, "vf_explained_var": 0.002120405498635832, "kl": 0.017376012006035526, "entropy": 1.2029735528602803, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 121905.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 15.662818845617709, "cur_kl_coeff": 0.02109375, "cur_lr": 0.00010000000000000003, "total_loss": 8.750507755885048, "policy_loss": -0.005661273333022282, "vf_loss": 8.755996612770847, "vf_explained_var": 0.18862525517978365, "kl": 0.008174933763734791, "entropy": 0.871807982335015, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 121905.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 260000, "num_env_steps_trained": 260000, "num_agent_steps_sampled": 1040000, "num_agent_steps_trained": 1040000}, "env_runners": {"episode_reward_max": 897.3901915430515, "episode_reward_min": -245.79792642439008, "episode_reward_mean": 164.19052877871854, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1764.2829891345593, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 1603.0207236130914}, "policy_reward_mean": {"prey_policy": -246.94330554566616, "predator_policy": 329.0385699350255}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-245.79792642439008, 168.19345716851836, 102.5, 224.77158080245, 237.86194755764967, 249.4777502059469, 188.9999999999996, 35.30000000000023, 66.34234265344742, 21.0, 245.79431128080736, 175.5999999999996, 466.2521205565849, 481.1236402748877, 214.49999999999926, 111.32153798772671, 85.09999999999982, 251.53603195889008, 110.17217867061048, 311.20868216389346, -40.327544917535604, 57.599999999999994, 248.95378721600056, 60.10000000000001, 45.52711704124903, 259.1278852570492, -90.12914156322148, 318.44096034307125, 897.3901915430515, 392.112428770412, 43.34257111589913, 61.900000000000006, 80.96859952979294, 142.3, 55.30000000000001, 312.18578560756794, 383.4, 28.00000000000013, 26.5978602647155, 43.01913439576501, 20.900000000000034, 18.399999999999995, 264.89999999999964, 95.79999999999986, 20.000000000000014, 179.895306973353, 259.6581861266826, 388.0, 122.3399029989163, 195.29999999999964, 1.1000000000000014, 317.0336478778611, -48.2841694332369, 165.4051941004937, 105.99999999999953, 19.5, 384.3, 159.23724441056837, 79.36561199793441, -44.80916925294588, 43.19448945303683, 347.0, 94.61599164935255, 237.3510685527645, 197.7999999999996, 770.5763566534055, 143.0, 196.0999999999994, 210.09999999999934, 119.99257133963515, 206.1999999999996, 226.5523229402796, 31.40000000000014, 29.338581188048003, 14.599999999999964, 129.25783652682856, 19.162588194258635, 179.60390467532017, 52.53576655392157, 394.3, 186.62262946002957, 380.3432322110856, 53.500000000000185, 23.500000000000064, 218.77511624498547, 92.0822157708042, 37.09999999999999, 190.29999999999993, -16.719082464905128, 256.60355044630717, 98.1486382452508, 87.73584571580376, 172.7999999999995, 219.7508546796317, 197.15719452219128, 273.38803730426804, 201.50000000000003, 113.66012633321455, 122.71399641587628, 336.3], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-1446.13555885198, -1764.2829891345593, -18.275373980406002, 61.91099256985319, -816.3009130281584, -100.14722568339869, 86.33252927904589, -161.54375130379782, -111.86268614847731, 46.10721819813392, 31.259252408839224, -6.645958967533474, 120.45970577207108, -276.71267113769176, 20.000000000000014, -175.93686080766614, -233.04405576543363, -332.73987619295133, -310.1315821099161, -1111.3396270335586, -188.2077442194059, -44.49767157124259, 118.24547621004743, -114.68064506644683, -398.9756130025986, -1492.97832414666, -1577.1384138691612, 149.1954347217781, -53.69129494527316, 199.1, -38.97003852733433, 18.76240232753737, -113.19479955469798, 20.000000000000014, -438.490195950874, -1007.4538399163059, -438.636520136427, -398.94784243138844, 96.41197037438039, 116.80449482982146, -419.12697456118116, -368.51270700350125, -1144.9227768673147, -207.14730565508947, 118.41880124534394, -46.775358127534645, -135.29148383385953, -1156.33171322274, -248.4485139101213, -309.43093683301106, 49.17112129666612, 71.70748050662988, -463.0425016885767, -215.0260650626507, -1026.5969578380777, -1594.590148320566, 193.7, -1190.2921349810763, -759.3116685441536, 72.3158132881988, 15.475090311731485, 20.000000000000014, -984.2421870456177, -209.19049051247987, -195.66838386259437, -21.52540580607736, -911.2181083378274, 45.96799950973393, -571.796715688756, -272.6417512913635, 162.9082790668319, 64.32714388128349, 184.59289308161777, 180.77601509442263, 18.076687771813827, -752.0925447617774, -27.343204789355497, -243.4809451780451, -277.8193681175785, -264.8377643440439, -812.2505246796592, -361.3461256011596, -275.06550998720184, -102.07139749410159, 190.70509015467988, 11.966683348714149, -78.98310602445018, -571.8966093168835, 20.000000000000014, -1158.0588537402498, 106.13578845906504, -329.17526929169406, -194.52147026773275, 192.46686480849922, 200.0, 160.19205323307918, -136.35279856342595, -227.44814672219567, -642.6896456178865, 177.39409355456075, -649.9007732967162, -1066.9716314523462, 72.67740308305387, -576.8753979834144, -205.85686330432134, -347.7577922975891, -101.18725130482747, -367.504894855943, -100.27681332837456, -14.640769496874857, -1031.4728724717827, 14.270802484263916, 191.0, 189.54951483127672, -128.90568594592187, -53.84037839019766, -220.09363993479545, -239.864374732423, -1049.13947356494, -1063.6472926068252, -276.9245680158564, -223.2934531663464, 81.78765168795523, 171.6745305862751, -357.20791043550645, -21.047985857563383, -71.51501328022017, 138.14422072130645, 166.41473476288223, -172.3417845199006, -1387.8171033747508, 195.5496997352102, -851.6166223392689, -52.81097229787011, 174.13418420361984, -501.0661494865795, 183.498034493143, 7.874093606486773, -185.75576242232796, 8.603837214734808, -107.55880101882558, 177.96877335091668, -152.09215217705272, 195.76609739596176, -70.1088092945674, -500.42940007363734, -286.7133407533563, -233.53244910057157, -198.3272980212948, -722.9870788566487, -102.27042046202907, 24.289548268950956, -411.7804960755663, -590.9543600891694, 17.367830212547798, 85.33621800626806, -45.441855755352776, -409.0606164466988, 193.65327002640157, 198.06183736829826, 17.46746413610602, 24.624858531306444, -161.8148239228496, -183.63159174144658, -214.21986948401272, -209.20932768191284, -380.3546744176106, 0.8950310803053977, -455.7060273025651, 58.318931972865876, -334.2434495493099, 44.118543736156155, -502.57855917331614, -507.594515191623, 160.13011827015262, -516.2966368773946, -301.4280414460542, -319.81880841221, -97.6931068708015, 6.961331322130718, -415.78999319893984, -1.3023145538805991, -80.5569281905487, -924.0628395386118, -200.1833080399258, 156.1028071641409, 188.17486761343756, -312.8401555918899, -74.0430867059271, 100.31885332925444, -432.5744733180259, 76.6232326692774, -694.142076930604, 189.52651222809823, -766.2055006218411, -241.60344910064748, -454.9162544391406, -527.379194192912, 165.1208180204468, 132.75082520636687], "policy_predator_policy_reward": [1361.5998979490578, 1603.0207236130914, 108.69048455459335, 15.867354024478637, 817.8009130281584, 201.1472256833987, 299.98280282720185, 0.0, 188.89269856021855, 114.7247169477745, 151.1600194645667, 73.70443730007442, 56.540294227928925, 288.7126711376919, 0.0, 191.2368608076653, 351.8664025591988, 280.2598720526336, 331.1315821099161, 1111.3396270335586, 205.6391887400205, 272.8605383314352, 43.75452378995252, 128.280645066447, 1065.2479277432512, 1292.958129962592, 1508.6942870000548, 400.3723324222153, 69.09129494527302, 0.0, 32.62449183084517, 98.9046823566789, 0.0, 178.2947995546981, 685.6262279097657, 1011.853839916306, 461.9356841978732, 485.82085704055294, 85.8182122552765, 12.174004704415044, 253.27952716486334, 494.03260948228376, 1145.5227768673149, 264.14730565508967, 36.659022174005486, 140.65132192418577, 191.19148383385942, 1160.53171322274, 335.187369502282, 268.2191982820989, 138.24928345375315, 0.0, 43.577710378248476, 544.3617148097569, 1516.2434106449125, 1423.3846558568025, 809.4405718125724, 1084.5417547115553, 678.3472024500863, 400.76108157628056, 4.224909688268479, 3.6425711158987863, 988.1421870456177, 267.19049051247976, 13.771718223821631, 284.3906709746429, 912.5181083378274, 95.0320004902661, 574.0967156887559, 325.6417512913634, 44.70227502525546, 40.2480876341971, 6.707106918382229, 11.32398490557737, 1.7233122281861615, 760.2925447617773, 235.50915224094396, 61.912857991171684, 584.8666986188204, 0.8095682385670626, 816.5505246796602, 377.9461256011595, 280.0655099872019, 115.47139749410083, 5.294909845320112, 56.93331665128602, 166.98310602445028, 579.6966093168853, 0.0, 1158.0588537402498, 398.41130601304235, 4.52348179293984, 186.9973541001421, 74.71543748577406, 0.0, 27.80794676692082, 259.98322625774153, 226.15762202679636, 648.989645617888, 11.60590644543923, 651.0007732967164, 1066.9716314523462, 439.9034884354055, 381.3281543428164, 175.5109043228327, 329.8195818458406, 385.91461346500716, 248.18272679625687, 188.47681332837453, 32.440769496875085, 1031.4728724717827, 5.2291975157360495, 0.8119060180647638, 2.938579150658504, 257.4335552467395, 84.54975349994861, 231.40830598201484, 307.9153206831379, 1274.3941188282756, 793.5834780905465, 541.3764688821066, 2.0360417531337456, 83.21234831204477, 10.325469413724901, 467.8970847584164, 4.974803184006042, 0.874812090442773, 169.84704902123548, 191.4220871390812, 12.3049626179371, 1212.9515169899196, 749.8922433030278, 851.6166223392689, 195.81097229787008, 11.365815796380137, 511.6661494865819, 4.988233268328448, 13.739638632041752, 171.8831117918297, 125.26138475539918, 121.65880101882551, 14.131226649083324, 164.49215217705202, 18.386225544318542, 84.50880929456662, 517.4294000736372, 324.1541126603632, 225.43025838161213, 210.62729802129473, 725.2870788566488, 206.45574621549417, 0.7829625044125454, 434.7105300874298, 587.186914271565, 33.874380540295896, 43.02547591620897, 502.5990680351943, 4.439170720778641, 1.6467299735984362, 0.9381626317017274, 115.18749718020405, 29.342809612413582, 320.21235436950724, 405.57729350587493, 258.2198694840131, 218.7093276819123, 385.3546744176107, 17.604968919694585, 301.8815873427629, 314.2806242319214, 354.8915069561152, 27.315614627842894, 509.67855917331616, 537.5945151916231, 396.826501524505, 149.64001708273676, 365.69182524327834, 238.8359421500807, 29.724535134875662, 317.61079086010216, 73.96799713110532, 441.2729488669659, 925.9628395386118, 166.39277390635235, 213.78330803992503, 3.0971928358591003, 1.5759870661941269, 342.84015559189004, 5.598563271819088, 165.2828646270446, 318.2968980936119, 311.04237985940506, 700.642076930604, 5.473487771901756, 397.6184187105856, 723.8506573451176, 527.391291187618, 577.6181538603103, 17.879181979553216, 20.549174793633156]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2894318667699585, "mean_inference_ms": 4.05319011693807, "mean_action_processing_ms": 2.0607165259436955, "mean_env_wait_ms": 0.8044435593551283, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004101157188415527, "StateBufferConnector_ms": 0.003517746925354004, "ViewRequirementAgentConnector_ms": 0.09720230102539062}, "num_episodes": 18, "episode_return_max": 897.3901915430515, "episode_return_min": -245.79792642439008, "episode_return_mean": 164.19052877871854, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1040000, "num_agent_steps_trained": 1040000, "num_env_steps_sampled": 260000, "num_env_steps_trained": 260000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 82.97954834937468, "num_env_steps_trained_throughput_per_sec": 82.97954834937468, "timesteps_total": 260000, "num_env_steps_sampled_lifetime": 260000, "num_agent_steps_sampled_lifetime": 1040000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1040000, "timers": {"training_iteration_time_ms": 48009.183, "restore_workers_time_ms": 0.014, "training_step_time_ms": 48009.135, "sample_time_ms": 1263.515, "learn_time_ms": 46727.019, "learn_throughput": 85.604, "synch_weights_time_ms": 15.005}, "counters": {"num_env_steps_sampled": 260000, "num_env_steps_trained": 260000, "num_agent_steps_sampled": 1040000, "num_agent_steps_trained": 1040000}, "done": false, "training_iteration": 65, "trial_id": "cf3bb_00000", "date": "2024-08-20_09-38-12", "timestamp": 1724126892, "time_this_iter_s": 48.25574994087219, "time_total_s": 11154.94144654274, "pid": 25777, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39f782dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 11154.94144654274, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 44.241176470588236, "ram_util_percent": 82.91617647058825}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6958471418491432, "cur_kl_coeff": 0.030033874511718742, "cur_lr": 0.00010000000000000003, "total_loss": 6.200038685622038, "policy_loss": -0.002519715949153853, "vf_loss": 6.202412054526112, "vf_explained_var": -0.0005584163640542005, "kl": 0.004872010847660605, "entropy": 1.190491163352179, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 123795.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 12.793275982551474, "cur_kl_coeff": 0.02109375, "cur_lr": 0.00010000000000000003, "total_loss": 7.559660548507852, "policy_loss": -0.0035373051281249713, "vf_loss": 7.562933011282058, "vf_explained_var": 0.1728900014408051, "kl": 0.012556046735400537, "entropy": 0.9548838128173162, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 123795.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_agent_steps_sampled": 1056000, "num_agent_steps_trained": 1056000}, "env_runners": {"episode_reward_max": 897.3901915430515, "episode_reward_min": -583.3839869751869, "episode_reward_mean": 144.84963264541292, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1594.590148320566, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 1516.2434106449125}, "policy_reward_mean": {"prey_policy": -244.7047247342221, "predator_policy": 317.12954105692864}, "custom_metrics": {}, "hist_stats": {"episode_reward": [110.17217867061048, 311.20868216389346, -40.327544917535604, 57.599999999999994, 248.95378721600056, 60.10000000000001, 45.52711704124903, 259.1278852570492, -90.12914156322148, 318.44096034307125, 897.3901915430515, 392.112428770412, 43.34257111589913, 61.900000000000006, 80.96859952979294, 142.3, 55.30000000000001, 312.18578560756794, 383.4, 28.00000000000013, 26.5978602647155, 43.01913439576501, 20.900000000000034, 18.399999999999995, 264.89999999999964, 95.79999999999986, 20.000000000000014, 179.895306973353, 259.6581861266826, 388.0, 122.3399029989163, 195.29999999999964, 1.1000000000000014, 317.0336478778611, -48.2841694332369, 165.4051941004937, 105.99999999999953, 19.5, 384.3, 159.23724441056837, 79.36561199793441, -44.80916925294588, 43.19448945303683, 347.0, 94.61599164935255, 237.3510685527645, 197.7999999999996, 770.5763566534055, 143.0, 196.0999999999994, 210.09999999999934, 119.99257133963515, 206.1999999999996, 226.5523229402796, 31.40000000000014, 29.338581188048003, 14.599999999999964, 129.25783652682856, 19.162588194258635, 179.60390467532017, 52.53576655392157, 394.3, 186.62262946002957, 380.3432322110856, 53.500000000000185, 23.500000000000064, 218.77511624498547, 92.0822157708042, 37.09999999999999, 190.29999999999993, -16.719082464905128, 256.60355044630717, 98.1486382452508, 87.73584571580376, 172.7999999999995, 219.7508546796317, 197.15719452219128, 273.38803730426804, 201.50000000000003, 113.66012633321455, 122.71399641587628, 336.3, 103.34360751610113, 138.0, 169.38619258914377, 143.2, 189.2, 37.71436829253889, -583.3839869751869, 253.2702670799306, 102.75140865946533, 52.634913348532265, 45.70000000000022, 198.89999999999998, 191.7, 26.600000000000108, 197.79999999999933, -51.96199347643157, -295.75777949458114, 226.690183152443], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-438.636520136427, -398.94784243138844, 96.41197037438039, 116.80449482982146, -419.12697456118116, -368.51270700350125, -1144.9227768673147, -207.14730565508947, 118.41880124534394, -46.775358127534645, -135.29148383385953, -1156.33171322274, -248.4485139101213, -309.43093683301106, 49.17112129666612, 71.70748050662988, -463.0425016885767, -215.0260650626507, -1026.5969578380777, -1594.590148320566, 193.7, -1190.2921349810763, -759.3116685441536, 72.3158132881988, 15.475090311731485, 20.000000000000014, -984.2421870456177, -209.19049051247987, -195.66838386259437, -21.52540580607736, -911.2181083378274, 45.96799950973393, -571.796715688756, -272.6417512913635, 162.9082790668319, 64.32714388128349, 184.59289308161777, 180.77601509442263, 18.076687771813827, -752.0925447617774, -27.343204789355497, -243.4809451780451, -277.8193681175785, -264.8377643440439, -812.2505246796592, -361.3461256011596, -275.06550998720184, -102.07139749410159, 190.70509015467988, 11.966683348714149, -78.98310602445018, -571.8966093168835, 20.000000000000014, -1158.0588537402498, 106.13578845906504, -329.17526929169406, -194.52147026773275, 192.46686480849922, 200.0, 160.19205323307918, -136.35279856342595, -227.44814672219567, -642.6896456178865, 177.39409355456075, -649.9007732967162, -1066.9716314523462, 72.67740308305387, -576.8753979834144, -205.85686330432134, -347.7577922975891, -101.18725130482747, -367.504894855943, -100.27681332837456, -14.640769496874857, -1031.4728724717827, 14.270802484263916, 191.0, 189.54951483127672, -128.90568594592187, -53.84037839019766, -220.09363993479545, -239.864374732423, -1049.13947356494, -1063.6472926068252, -276.9245680158564, -223.2934531663464, 81.78765168795523, 171.6745305862751, -357.20791043550645, -21.047985857563383, -71.51501328022017, 138.14422072130645, 166.41473476288223, -172.3417845199006, -1387.8171033747508, 195.5496997352102, -851.6166223392689, -52.81097229787011, 174.13418420361984, -501.0661494865795, 183.498034493143, 7.874093606486773, -185.75576242232796, 8.603837214734808, -107.55880101882558, 177.96877335091668, -152.09215217705272, 195.76609739596176, -70.1088092945674, -500.42940007363734, -286.7133407533563, -233.53244910057157, -198.3272980212948, -722.9870788566487, -102.27042046202907, 24.289548268950956, -411.7804960755663, -590.9543600891694, 17.367830212547798, 85.33621800626806, -45.441855755352776, -409.0606164466988, 193.65327002640157, 198.06183736829826, 17.46746413610602, 24.624858531306444, -161.8148239228496, -183.63159174144658, -214.21986948401272, -209.20932768191284, -380.3546744176106, 0.8950310803053977, -455.7060273025651, 58.318931972865876, -334.2434495493099, 44.118543736156155, -502.57855917331614, -507.594515191623, 160.13011827015262, -516.2966368773946, -301.4280414460542, -319.81880841221, -97.6931068708015, 6.961331322130718, -415.78999319893984, -1.3023145538805991, -80.5569281905487, -924.0628395386118, -200.1833080399258, 156.1028071641409, 188.17486761343756, -312.8401555918899, -74.0430867059271, 100.31885332925444, -432.5744733180259, 76.6232326692774, -694.142076930604, 189.52651222809823, -766.2055006218411, -241.60344910064748, -454.9162544391406, -527.379194192912, 165.1208180204468, 132.75082520636687, -415.33601217961376, -251.1934576748493, 45.360650584993124, -1329.6443506011174, -56.31612825222288, -327.48823401204936, -735.3246700290683, 22.91917496358066, 162.81107550365226, -691.3144734361018, 17.84726150430332, 16.814057898428324, -862.8458280035264, -1065.8230779554597, 14.915576012415531, -517.859649196494, 1.8981481672698566, -137.3433288189966, -254.4013442037774, -28.045450539998072, -61.05078408929681, -407.4733647699383, 183.57119012324182, -786.5639371734449, -715.173360240824, 178.5603209234319, -353.8520223363513, -19.047335501341145, 124.00920038768095, -120.38768815299247, -245.75537196711105, -342.0193334734799, -495.1000514303783, -744.1544000208369, -159.29338473838934, -660.1881544107524], "policy_predator_policy_reward": [461.9356841978732, 485.82085704055294, 85.8182122552765, 12.174004704415044, 253.27952716486334, 494.03260948228376, 1145.5227768673149, 264.14730565508967, 36.659022174005486, 140.65132192418577, 191.19148383385942, 1160.53171322274, 335.187369502282, 268.2191982820989, 138.24928345375315, 0.0, 43.577710378248476, 544.3617148097569, 1516.2434106449125, 1423.3846558568025, 809.4405718125724, 1084.5417547115553, 678.3472024500863, 400.76108157628056, 4.224909688268479, 3.6425711158987863, 988.1421870456177, 267.19049051247976, 13.771718223821631, 284.3906709746429, 912.5181083378274, 95.0320004902661, 574.0967156887559, 325.6417512913634, 44.70227502525546, 40.2480876341971, 6.707106918382229, 11.32398490557737, 1.7233122281861615, 760.2925447617773, 235.50915224094396, 61.912857991171684, 584.8666986188204, 0.8095682385670626, 816.5505246796602, 377.9461256011595, 280.0655099872019, 115.47139749410083, 5.294909845320112, 56.93331665128602, 166.98310602445028, 579.6966093168853, 0.0, 1158.0588537402498, 398.41130601304235, 4.52348179293984, 186.9973541001421, 74.71543748577406, 0.0, 27.80794676692082, 259.98322625774153, 226.15762202679636, 648.989645617888, 11.60590644543923, 651.0007732967164, 1066.9716314523462, 439.9034884354055, 381.3281543428164, 175.5109043228327, 329.8195818458406, 385.91461346500716, 248.18272679625687, 188.47681332837453, 32.440769496875085, 1031.4728724717827, 5.2291975157360495, 0.8119060180647638, 2.938579150658504, 257.4335552467395, 84.54975349994861, 231.40830598201484, 307.9153206831379, 1274.3941188282756, 793.5834780905465, 541.3764688821066, 2.0360417531337456, 83.21234831204477, 10.325469413724901, 467.8970847584164, 4.974803184006042, 0.874812090442773, 169.84704902123548, 191.4220871390812, 12.3049626179371, 1212.9515169899196, 749.8922433030278, 851.6166223392689, 195.81097229787008, 11.365815796380137, 511.6661494865819, 4.988233268328448, 13.739638632041752, 171.8831117918297, 125.26138475539918, 121.65880101882551, 14.131226649083324, 164.49215217705202, 18.386225544318542, 84.50880929456662, 517.4294000736372, 324.1541126603632, 225.43025838161213, 210.62729802129473, 725.2870788566488, 206.45574621549417, 0.7829625044125454, 434.7105300874298, 587.186914271565, 33.874380540295896, 43.02547591620897, 502.5990680351943, 4.439170720778641, 1.6467299735984362, 0.9381626317017274, 115.18749718020405, 29.342809612413582, 320.21235436950724, 405.57729350587493, 258.2198694840131, 218.7093276819123, 385.3546744176107, 17.604968919694585, 301.8815873427629, 314.2806242319214, 354.8915069561152, 27.315614627842894, 509.67855917331616, 537.5945151916231, 396.826501524505, 149.64001708273676, 365.69182524327834, 238.8359421500807, 29.724535134875662, 317.61079086010216, 73.96799713110532, 441.2729488669659, 925.9628395386118, 166.39277390635235, 213.78330803992503, 3.0971928358591003, 1.5759870661941269, 342.84015559189004, 5.598563271819088, 165.2828646270446, 318.2968980936119, 311.04237985940506, 700.642076930604, 5.473487771901756, 397.6184187105856, 723.8506573451176, 527.391291187618, 577.6181538603103, 17.879181979553216, 20.549174793633156, 524.9395615431713, 244.9335158273929, 92.63934941500688, 1329.6443506011174, 293.17492419809423, 260.0156306553217, 313.19044676508315, 542.4150483004039, 26.18892449634775, 691.5144734361018, 1.100310394110277, 1.952738495696667, 985.1786485479506, 360.10627043584844, 408.70843194360793, 347.50590832040217, 21.853260492195655, 216.34332881899664, 0.0, 335.08170809230796, 76.75078408929642, 437.47336476993837, 8.428809876758177, 793.4639371734448, 716.8733602408239, 11.43967907656809, 11.925554985531507, 387.5738028521611, 58.99079961231906, 135.18768815299163, 261.87265858317954, 273.94005338098, 943.4966719566343, 0.0, 427.8604122130689, 618.3113100885182]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2795128650200498, "mean_inference_ms": 4.013949841523331, "mean_action_processing_ms": 2.034742628134481, "mean_env_wait_ms": 0.7955504254020418, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00395655632019043, "StateBufferConnector_ms": 0.003996372222900391, "ViewRequirementAgentConnector_ms": 0.09969949722290039}, "num_episodes": 18, "episode_return_max": 897.3901915430515, "episode_return_min": -583.3839869751869, "episode_return_mean": 144.84963264541292, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1056000, "num_agent_steps_trained": 1056000, "num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 84.07936079379918, "num_env_steps_trained_throughput_per_sec": 84.07936079379918, "timesteps_total": 264000, "num_env_steps_sampled_lifetime": 264000, "num_agent_steps_sampled_lifetime": 1056000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1056000, "timers": {"training_iteration_time_ms": 47920.219, "restore_workers_time_ms": 0.014, "training_step_time_ms": 47920.17, "sample_time_ms": 1263.45, "learn_time_ms": 46637.23, "learn_throughput": 85.768, "synch_weights_time_ms": 15.852}, "counters": {"num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_agent_steps_sampled": 1056000, "num_agent_steps_trained": 1056000}, "done": false, "training_iteration": 66, "trial_id": "cf3bb_00000", "date": "2024-08-20_09-39-00", "timestamp": 1724126940, "time_this_iter_s": 47.61869835853577, "time_total_s": 11202.560144901276, "pid": 25777, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39ffac160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 11202.560144901276, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 43.12941176470588, "ram_util_percent": 82.3264705882353}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7093782080938577, "cur_kl_coeff": 0.015016937255859371, "cur_lr": 0.00010000000000000003, "total_loss": 7.0703960643243535, "policy_loss": -0.0015901293968978935, "vf_loss": 7.071901627444716, "vf_explained_var": -0.0006968806029627563, "kl": 0.005631460593582956, "entropy": 1.2489863481471148, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 125685.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 12.433136611262327, "cur_kl_coeff": 0.02109375, "cur_lr": 0.00010000000000000003, "total_loss": 8.461425258242894, "policy_loss": -0.004321835890520738, "vf_loss": 8.465526063353927, "vf_explained_var": 0.20157359649264622, "kl": 0.01047696783280815, "entropy": 0.8869485089703212, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 125685.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 268000, "num_env_steps_trained": 268000, "num_agent_steps_sampled": 1072000, "num_agent_steps_trained": 1072000}, "env_runners": {"episode_reward_max": 770.5763566534055, "episode_reward_min": -752.9064668278286, "episode_reward_mean": 117.11212719542675, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1387.8171033747508, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 1410.2987433165258}, "policy_reward_mean": {"prey_policy": -241.03554799986898, "predator_policy": 299.59161159758247}, "custom_metrics": {}, "hist_stats": {"episode_reward": [20.900000000000034, 18.399999999999995, 264.89999999999964, 95.79999999999986, 20.000000000000014, 179.895306973353, 259.6581861266826, 388.0, 122.3399029989163, 195.29999999999964, 1.1000000000000014, 317.0336478778611, -48.2841694332369, 165.4051941004937, 105.99999999999953, 19.5, 384.3, 159.23724441056837, 79.36561199793441, -44.80916925294588, 43.19448945303683, 347.0, 94.61599164935255, 237.3510685527645, 197.7999999999996, 770.5763566534055, 143.0, 196.0999999999994, 210.09999999999934, 119.99257133963515, 206.1999999999996, 226.5523229402796, 31.40000000000014, 29.338581188048003, 14.599999999999964, 129.25783652682856, 19.162588194258635, 179.60390467532017, 52.53576655392157, 394.3, 186.62262946002957, 380.3432322110856, 53.500000000000185, 23.500000000000064, 218.77511624498547, 92.0822157708042, 37.09999999999999, 190.29999999999993, -16.719082464905128, 256.60355044630717, 98.1486382452508, 87.73584571580376, 172.7999999999995, 219.7508546796317, 197.15719452219128, 273.38803730426804, 201.50000000000003, 113.66012633321455, 122.71399641587628, 336.3, 103.34360751610113, 138.0, 169.38619258914377, 143.2, 189.2, 37.71436829253889, -583.3839869751869, 253.2702670799306, 102.75140865946533, 52.634913348532265, 45.70000000000022, 198.89999999999998, 191.7, 26.600000000000108, 197.79999999999933, -51.96199347643157, -295.75777949458114, 226.690183152443, 334.0277944969747, -120.21135007144309, 35.4, 60.30000000000015, 154.17029003260402, 115.65750008113854, -41.64594480656966, 83.1999999999995, 181.80497636583812, 124.4999999999994, -741.5835794455355, 106.64107736038324, -46.05576032314012, 306.48286312478444, 386.5150542300307, 52.199999999999974, -752.9064668278286, 77.1, 69.9, 220.19231335256978, 215.09999999999928, 152.65118286989753], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-812.2505246796592, -361.3461256011596, -275.06550998720184, -102.07139749410159, 190.70509015467988, 11.966683348714149, -78.98310602445018, -571.8966093168835, 20.000000000000014, -1158.0588537402498, 106.13578845906504, -329.17526929169406, -194.52147026773275, 192.46686480849922, 200.0, 160.19205323307918, -136.35279856342595, -227.44814672219567, -642.6896456178865, 177.39409355456075, -649.9007732967162, -1066.9716314523462, 72.67740308305387, -576.8753979834144, -205.85686330432134, -347.7577922975891, -101.18725130482747, -367.504894855943, -100.27681332837456, -14.640769496874857, -1031.4728724717827, 14.270802484263916, 191.0, 189.54951483127672, -128.90568594592187, -53.84037839019766, -220.09363993479545, -239.864374732423, -1049.13947356494, -1063.6472926068252, -276.9245680158564, -223.2934531663464, 81.78765168795523, 171.6745305862751, -357.20791043550645, -21.047985857563383, -71.51501328022017, 138.14422072130645, 166.41473476288223, -172.3417845199006, -1387.8171033747508, 195.5496997352102, -851.6166223392689, -52.81097229787011, 174.13418420361984, -501.0661494865795, 183.498034493143, 7.874093606486773, -185.75576242232796, 8.603837214734808, -107.55880101882558, 177.96877335091668, -152.09215217705272, 195.76609739596176, -70.1088092945674, -500.42940007363734, -286.7133407533563, -233.53244910057157, -198.3272980212948, -722.9870788566487, -102.27042046202907, 24.289548268950956, -411.7804960755663, -590.9543600891694, 17.367830212547798, 85.33621800626806, -45.441855755352776, -409.0606164466988, 193.65327002640157, 198.06183736829826, 17.46746413610602, 24.624858531306444, -161.8148239228496, -183.63159174144658, -214.21986948401272, -209.20932768191284, -380.3546744176106, 0.8950310803053977, -455.7060273025651, 58.318931972865876, -334.2434495493099, 44.118543736156155, -502.57855917331614, -507.594515191623, 160.13011827015262, -516.2966368773946, -301.4280414460542, -319.81880841221, -97.6931068708015, 6.961331322130718, -415.78999319893984, -1.3023145538805991, -80.5569281905487, -924.0628395386118, -200.1833080399258, 156.1028071641409, 188.17486761343756, -312.8401555918899, -74.0430867059271, 100.31885332925444, -432.5744733180259, 76.6232326692774, -694.142076930604, 189.52651222809823, -766.2055006218411, -241.60344910064748, -454.9162544391406, -527.379194192912, 165.1208180204468, 132.75082520636687, -415.33601217961376, -251.1934576748493, 45.360650584993124, -1329.6443506011174, -56.31612825222288, -327.48823401204936, -735.3246700290683, 22.91917496358066, 162.81107550365226, -691.3144734361018, 17.84726150430332, 16.814057898428324, -862.8458280035264, -1065.8230779554597, 14.915576012415531, -517.859649196494, 1.8981481672698566, -137.3433288189966, -254.4013442037774, -28.045450539998072, -61.05078408929681, -407.4733647699383, 183.57119012324182, -786.5639371734449, -715.173360240824, 178.5603209234319, -353.8520223363513, -19.047335501341145, 124.00920038768095, -120.38768815299247, -245.75537196711105, -342.0193334734799, -495.1000514303783, -744.1544000208369, -159.29338473838934, -660.1881544107524, -477.7077109206815, 185.20802654418122, -402.1103100560447, -283.74948305910124, -190.23485119016365, -906.8451639319926, -173.12628003299727, -84.6705328073819, 80.4193620297208, -238.79802954292938, -158.37333208317938, -59.591582939149674, -286.55569639020194, -352.9827367865297, -198.77976904465692, -221.93178781502397, 146.72711049053927, -161.12595841070865, -19.574726163191592, -63.25766474699048, -871.6097235586037, -1280.2725992034575, 16.104557078258683, -293.3299939353016, -375.0213786121852, -299.96153734721736, -255.1763211336949, 35.48247870716496, -940.6663287303062, 131.70395402794557, -408.8959426525332, -216.51267812518168, -1032.5287104245003, -913.0015990312526, -1169.4262710209348, -112.85571137294946, -110.46908982790237, -688.2117665501063, 53.08073035578423, -260.5370724484719, 194.16045926660826, 6.576557870653865, 39.87693992410929, -91.2471780231233], "policy_predator_policy_reward": [816.5505246796602, 377.9461256011595, 280.0655099872019, 115.47139749410083, 5.294909845320112, 56.93331665128602, 166.98310602445028, 579.6966093168853, 0.0, 1158.0588537402498, 398.41130601304235, 4.52348179293984, 186.9973541001421, 74.71543748577406, 0.0, 27.80794676692082, 259.98322625774153, 226.15762202679636, 648.989645617888, 11.60590644543923, 651.0007732967164, 1066.9716314523462, 439.9034884354055, 381.3281543428164, 175.5109043228327, 329.8195818458406, 385.91461346500716, 248.18272679625687, 188.47681332837453, 32.440769496875085, 1031.4728724717827, 5.2291975157360495, 0.8119060180647638, 2.938579150658504, 257.4335552467395, 84.54975349994861, 231.40830598201484, 307.9153206831379, 1274.3941188282756, 793.5834780905465, 541.3764688821066, 2.0360417531337456, 83.21234831204477, 10.325469413724901, 467.8970847584164, 4.974803184006042, 0.874812090442773, 169.84704902123548, 191.4220871390812, 12.3049626179371, 1212.9515169899196, 749.8922433030278, 851.6166223392689, 195.81097229787008, 11.365815796380137, 511.6661494865819, 4.988233268328448, 13.739638632041752, 171.8831117918297, 125.26138475539918, 121.65880101882551, 14.131226649083324, 164.49215217705202, 18.386225544318542, 84.50880929456662, 517.4294000736372, 324.1541126603632, 225.43025838161213, 210.62729802129473, 725.2870788566488, 206.45574621549417, 0.7829625044125454, 434.7105300874298, 587.186914271565, 33.874380540295896, 43.02547591620897, 502.5990680351943, 4.439170720778641, 1.6467299735984362, 0.9381626317017274, 115.18749718020405, 29.342809612413582, 320.21235436950724, 405.57729350587493, 258.2198694840131, 218.7093276819123, 385.3546744176107, 17.604968919694585, 301.8815873427629, 314.2806242319214, 354.8915069561152, 27.315614627842894, 509.67855917331616, 537.5945151916231, 396.826501524505, 149.64001708273676, 365.69182524327834, 238.8359421500807, 29.724535134875662, 317.61079086010216, 73.96799713110532, 441.2729488669659, 925.9628395386118, 166.39277390635235, 213.78330803992503, 3.0971928358591003, 1.5759870661941269, 342.84015559189004, 5.598563271819088, 165.2828646270446, 318.2968980936119, 311.04237985940506, 700.642076930604, 5.473487771901756, 397.6184187105856, 723.8506573451176, 527.391291187618, 577.6181538603103, 17.879181979553216, 20.549174793633156, 524.9395615431713, 244.9335158273929, 92.63934941500688, 1329.6443506011174, 293.17492419809423, 260.0156306553217, 313.19044676508315, 542.4150483004039, 26.18892449634775, 691.5144734361018, 1.100310394110277, 1.952738495696667, 985.1786485479506, 360.10627043584844, 408.70843194360793, 347.50590832040217, 21.853260492195655, 216.34332881899664, 0.0, 335.08170809230796, 76.75078408929642, 437.47336476993837, 8.428809876758177, 793.4639371734448, 716.8733602408239, 11.43967907656809, 11.925554985531507, 387.5738028521611, 58.99079961231906, 135.18768815299163, 261.87265858317954, 273.94005338098, 943.4966719566343, 0.0, 427.8604122130689, 618.3113100885182, 386.1430540120622, 240.38442486141307, 565.6484430437027, 0.0, 225.23485119016365, 907.2451639319925, 220.12628003299722, 97.97053280738115, 2.9831063449928847, 309.5658512008198, 37.94240810361474, 295.68000699985276, 597.8924883701619, 0.0, 213.97976904465608, 289.93178781502405, 128.3578390687281, 67.84598521727905, 37.0747261631918, 170.25766474699049, 0.0, 1410.2987433165258, 323.75427553126974, 60.11223868615661, 222.58213997432884, 406.34501566193376, 200.97976953426257, 325.1969360170517, 451.0438976028502, 744.4335313295406, 436.1228978853006, 241.4857228924144, 1191.6949462520402, 0.9288963758842768, 1170.526271020935, 188.85571137294932, 178.46908982790214, 690.1117665501062, 145.51912665556983, 282.1295287896874, 2.0395407333917572, 12.323442129346102, 1.1819171081702737, 202.83950386074133]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2688666242651225, "mean_inference_ms": 3.9096635909056947, "mean_action_processing_ms": 2.060084864343904, "mean_env_wait_ms": 0.7867775643105794, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038198232650756836, "StateBufferConnector_ms": 0.003717660903930664, "ViewRequirementAgentConnector_ms": 0.10201883316040039}, "num_episodes": 22, "episode_return_max": 770.5763566534055, "episode_return_min": -752.9064668278286, "episode_return_mean": 117.11212719542675, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1072000, "num_agent_steps_trained": 1072000, "num_env_steps_sampled": 268000, "num_env_steps_trained": 268000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 83.57543762015527, "num_env_steps_trained_throughput_per_sec": 83.57543762015527, "timesteps_total": 268000, "num_env_steps_sampled_lifetime": 268000, "num_agent_steps_sampled_lifetime": 1072000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1072000, "timers": {"training_iteration_time_ms": 47867.423, "restore_workers_time_ms": 0.014, "training_step_time_ms": 47867.375, "sample_time_ms": 1248.91, "learn_time_ms": 46599.26, "learn_throughput": 85.838, "synch_weights_time_ms": 15.574}, "counters": {"num_env_steps_sampled": 268000, "num_env_steps_trained": 268000, "num_agent_steps_sampled": 1072000, "num_agent_steps_trained": 1072000}, "done": false, "training_iteration": 67, "trial_id": "cf3bb_00000", "date": "2024-08-20_09-39-47", "timestamp": 1724126987, "time_this_iter_s": 47.89105010032654, "time_total_s": 11250.451195001602, "pid": 25777, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39f782940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 11250.451195001602, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 42.008823529411764, "ram_util_percent": 82.14264705882354}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7208800575759992, "cur_kl_coeff": 0.015016937255859371, "cur_lr": 0.00010000000000000003, "total_loss": 6.923667905696486, "policy_loss": -0.0043288194867609825, "vf_loss": 6.927679183748033, "vf_explained_var": -0.000542492841286634, "kl": 0.0211452130712591, "entropy": 1.2400094432174844, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 127575.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 18.812997461626768, "cur_kl_coeff": 0.02109375, "cur_lr": 0.00010000000000000003, "total_loss": 8.101126494735636, "policy_loss": -0.002647086592864186, "vf_loss": 8.103506728833315, "vf_explained_var": 0.22981596327332593, "kl": 0.012651367927908422, "entropy": 0.940817435960921, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 127575.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 272000, "num_env_steps_trained": 272000, "num_agent_steps_sampled": 1088000, "num_agent_steps_trained": 1088000}, "env_runners": {"episode_reward_max": 770.5763566534055, "episode_reward_min": -752.9064668278286, "episode_reward_mean": 118.3545626249466, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1539.7888496645396, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 198.06183736829826, "predator_policy": 1573.9617271869693}, "policy_reward_mean": {"prey_policy": -260.6888583389732, "predator_policy": 319.86613965144653}, "custom_metrics": {}, "hist_stats": {"episode_reward": [79.36561199793441, -44.80916925294588, 43.19448945303683, 347.0, 94.61599164935255, 237.3510685527645, 197.7999999999996, 770.5763566534055, 143.0, 196.0999999999994, 210.09999999999934, 119.99257133963515, 206.1999999999996, 226.5523229402796, 31.40000000000014, 29.338581188048003, 14.599999999999964, 129.25783652682856, 19.162588194258635, 179.60390467532017, 52.53576655392157, 394.3, 186.62262946002957, 380.3432322110856, 53.500000000000185, 23.500000000000064, 218.77511624498547, 92.0822157708042, 37.09999999999999, 190.29999999999993, -16.719082464905128, 256.60355044630717, 98.1486382452508, 87.73584571580376, 172.7999999999995, 219.7508546796317, 197.15719452219128, 273.38803730426804, 201.50000000000003, 113.66012633321455, 122.71399641587628, 336.3, 103.34360751610113, 138.0, 169.38619258914377, 143.2, 189.2, 37.71436829253889, -583.3839869751869, 253.2702670799306, 102.75140865946533, 52.634913348532265, 45.70000000000022, 198.89999999999998, 191.7, 26.600000000000108, 197.79999999999933, -51.96199347643157, -295.75777949458114, 226.690183152443, 334.0277944969747, -120.21135007144309, 35.4, 60.30000000000015, 154.17029003260402, 115.65750008113854, -41.64594480656966, 83.1999999999995, 181.80497636583812, 124.4999999999994, -741.5835794455355, 106.64107736038324, -46.05576032314012, 306.48286312478444, 386.5150542300307, 52.199999999999974, -752.9064668278286, 77.1, 69.9, 220.19231335256978, 215.09999999999928, 152.65118286989753, 96.31660541845721, 109.50000000000004, -33.97538994278162, 73.00000000000014, 595.2879845744435, -171.53114482356, 505.9915073268889, 171.11776695296635, 139.78993815999553, 192.38362231685704, 14.7, 312.70470010490175, -18.712423115342588, 202.74202291702997, 129.41845037752995, 72.82302767694826, 283.02988493276564, 119.14230312952063], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-220.09363993479545, -239.864374732423, -1049.13947356494, -1063.6472926068252, -276.9245680158564, -223.2934531663464, 81.78765168795523, 171.6745305862751, -357.20791043550645, -21.047985857563383, -71.51501328022017, 138.14422072130645, 166.41473476288223, -172.3417845199006, -1387.8171033747508, 195.5496997352102, -851.6166223392689, -52.81097229787011, 174.13418420361984, -501.0661494865795, 183.498034493143, 7.874093606486773, -185.75576242232796, 8.603837214734808, -107.55880101882558, 177.96877335091668, -152.09215217705272, 195.76609739596176, -70.1088092945674, -500.42940007363734, -286.7133407533563, -233.53244910057157, -198.3272980212948, -722.9870788566487, -102.27042046202907, 24.289548268950956, -411.7804960755663, -590.9543600891694, 17.367830212547798, 85.33621800626806, -45.441855755352776, -409.0606164466988, 193.65327002640157, 198.06183736829826, 17.46746413610602, 24.624858531306444, -161.8148239228496, -183.63159174144658, -214.21986948401272, -209.20932768191284, -380.3546744176106, 0.8950310803053977, -455.7060273025651, 58.318931972865876, -334.2434495493099, 44.118543736156155, -502.57855917331614, -507.594515191623, 160.13011827015262, -516.2966368773946, -301.4280414460542, -319.81880841221, -97.6931068708015, 6.961331322130718, -415.78999319893984, -1.3023145538805991, -80.5569281905487, -924.0628395386118, -200.1833080399258, 156.1028071641409, 188.17486761343756, -312.8401555918899, -74.0430867059271, 100.31885332925444, -432.5744733180259, 76.6232326692774, -694.142076930604, 189.52651222809823, -766.2055006218411, -241.60344910064748, -454.9162544391406, -527.379194192912, 165.1208180204468, 132.75082520636687, -415.33601217961376, -251.1934576748493, 45.360650584993124, -1329.6443506011174, -56.31612825222288, -327.48823401204936, -735.3246700290683, 22.91917496358066, 162.81107550365226, -691.3144734361018, 17.84726150430332, 16.814057898428324, -862.8458280035264, -1065.8230779554597, 14.915576012415531, -517.859649196494, 1.8981481672698566, -137.3433288189966, -254.4013442037774, -28.045450539998072, -61.05078408929681, -407.4733647699383, 183.57119012324182, -786.5639371734449, -715.173360240824, 178.5603209234319, -353.8520223363513, -19.047335501341145, 124.00920038768095, -120.38768815299247, -245.75537196711105, -342.0193334734799, -495.1000514303783, -744.1544000208369, -159.29338473838934, -660.1881544107524, -477.7077109206815, 185.20802654418122, -402.1103100560447, -283.74948305910124, -190.23485119016365, -906.8451639319926, -173.12628003299727, -84.6705328073819, 80.4193620297208, -238.79802954292938, -158.37333208317938, -59.591582939149674, -286.55569639020194, -352.9827367865297, -198.77976904465692, -221.93178781502397, 146.72711049053927, -161.12595841070865, -19.574726163191592, -63.25766474699048, -871.6097235586037, -1280.2725992034575, 16.104557078258683, -293.3299939353016, -375.0213786121852, -299.96153734721736, -255.1763211336949, 35.48247870716496, -940.6663287303062, 131.70395402794557, -408.8959426525332, -216.51267812518168, -1032.5287104245003, -913.0015990312526, -1169.4262710209348, -112.85571137294946, -110.46908982790237, -688.2117665501063, 53.08073035578423, -260.5370724484719, 194.16045926660826, 6.576557870653865, 39.87693992410929, -91.2471780231233, -126.17188044073174, -47.324257184002434, -870.5724511809408, -63.89653260349505, -1539.7888496645396, -1473.685009549571, 20.000000000000014, -274.0229573290822, 151.85490100615206, -846.0587354126974, -198.63055982734443, -867.8531028494631, 162.61374835534014, -977.9059451988674, 8.44403907964869, -856.0274137394942, -99.75575632662387, -197.84613357474782, -49.54724435973907, 62.27414158215238, -492.43921445337696, -703.0561820771638, 93.2603683935546, 121.69260874441989, -137.07644806884485, -357.2192665152543, 168.47352051477665, -1178.7580839189013, -99.13303821334704, -402.6637027205637, -9.988407150761944, -180.04202827652924, 13.91659059390058, -456.5577172939074, -24.153649063597733, -211.7097065749562], "policy_predator_policy_reward": [231.40830598201484, 307.9153206831379, 1274.3941188282756, 793.5834780905465, 541.3764688821066, 2.0360417531337456, 83.21234831204477, 10.325469413724901, 467.8970847584164, 4.974803184006042, 0.874812090442773, 169.84704902123548, 191.4220871390812, 12.3049626179371, 1212.9515169899196, 749.8922433030278, 851.6166223392689, 195.81097229787008, 11.365815796380137, 511.6661494865819, 4.988233268328448, 13.739638632041752, 171.8831117918297, 125.26138475539918, 121.65880101882551, 14.131226649083324, 164.49215217705202, 18.386225544318542, 84.50880929456662, 517.4294000736372, 324.1541126603632, 225.43025838161213, 210.62729802129473, 725.2870788566488, 206.45574621549417, 0.7829625044125454, 434.7105300874298, 587.186914271565, 33.874380540295896, 43.02547591620897, 502.5990680351943, 4.439170720778641, 1.6467299735984362, 0.9381626317017274, 115.18749718020405, 29.342809612413582, 320.21235436950724, 405.57729350587493, 258.2198694840131, 218.7093276819123, 385.3546744176107, 17.604968919694585, 301.8815873427629, 314.2806242319214, 354.8915069561152, 27.315614627842894, 509.67855917331616, 537.5945151916231, 396.826501524505, 149.64001708273676, 365.69182524327834, 238.8359421500807, 29.724535134875662, 317.61079086010216, 73.96799713110532, 441.2729488669659, 925.9628395386118, 166.39277390635235, 213.78330803992503, 3.0971928358591003, 1.5759870661941269, 342.84015559189004, 5.598563271819088, 165.2828646270446, 318.2968980936119, 311.04237985940506, 700.642076930604, 5.473487771901756, 397.6184187105856, 723.8506573451176, 527.391291187618, 577.6181538603103, 17.879181979553216, 20.549174793633156, 524.9395615431713, 244.9335158273929, 92.63934941500688, 1329.6443506011174, 293.17492419809423, 260.0156306553217, 313.19044676508315, 542.4150483004039, 26.18892449634775, 691.5144734361018, 1.100310394110277, 1.952738495696667, 985.1786485479506, 360.10627043584844, 408.70843194360793, 347.50590832040217, 21.853260492195655, 216.34332881899664, 0.0, 335.08170809230796, 76.75078408929642, 437.47336476993837, 8.428809876758177, 793.4639371734448, 716.8733602408239, 11.43967907656809, 11.925554985531507, 387.5738028521611, 58.99079961231906, 135.18768815299163, 261.87265858317954, 273.94005338098, 943.4966719566343, 0.0, 427.8604122130689, 618.3113100885182, 386.1430540120622, 240.38442486141307, 565.6484430437027, 0.0, 225.23485119016365, 907.2451639319925, 220.12628003299722, 97.97053280738115, 2.9831063449928847, 309.5658512008198, 37.94240810361474, 295.68000699985276, 597.8924883701619, 0.0, 213.97976904465608, 289.93178781502405, 128.3578390687281, 67.84598521727905, 37.0747261631918, 170.25766474699049, 0.0, 1410.2987433165258, 323.75427553126974, 60.11223868615661, 222.58213997432884, 406.34501566193376, 200.97976953426257, 325.1969360170517, 451.0438976028502, 744.4335313295406, 436.1228978853006, 241.4857228924144, 1191.6949462520402, 0.9288963758842768, 1170.526271020935, 188.85571137294932, 178.46908982790214, 690.1117665501062, 145.51912665556983, 282.1295287896874, 2.0395407333917572, 12.323442129346102, 1.1819171081702737, 202.83950386074133, 264.9393893986406, 4.8733536445509635, 875.0724511809408, 168.8965326034949, 1405.5367420843595, 1573.9617271869693, 0.0, 327.02295732908215, 521.6565464680932, 767.8352725128957, 894.9525178532474, 0.0, 830.5877632269312, 490.69594094348497, 162.5737278733177, 856.1274137394943, 437.3918280613673, 0.0, 34.04331680578049, 145.61340828866327, 505.43921445337696, 704.7561820771637, 26.989446005200804, 70.76227696172647, 82.40668982608794, 393.17660164267016, 33.86850240225335, 1179.1580839189014, 403.8454218723806, 227.3697694390599, 9.412789218039938, 253.4406738861994, 337.15061621368346, 388.52039541908897, 265.2870543075727, 89.71860446050253]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2605882689178454, "mean_inference_ms": 3.929258838457829, "mean_action_processing_ms": 1.9818666723266438, "mean_env_wait_ms": 0.7785307282266563, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037459135055541992, "StateBufferConnector_ms": 0.003646373748779297, "ViewRequirementAgentConnector_ms": 0.10334694385528564}, "num_episodes": 18, "episode_return_max": 770.5763566534055, "episode_return_min": -752.9064668278286, "episode_return_mean": 118.3545626249466, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1088000, "num_agent_steps_trained": 1088000, "num_env_steps_sampled": 272000, "num_env_steps_trained": 272000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 84.11387171999041, "num_env_steps_trained_throughput_per_sec": 84.11387171999041, "timesteps_total": 272000, "num_env_steps_sampled_lifetime": 272000, "num_agent_steps_sampled_lifetime": 1088000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1088000, "timers": {"training_iteration_time_ms": 47676.41, "restore_workers_time_ms": 0.014, "training_step_time_ms": 47676.362, "sample_time_ms": 1208.909, "learn_time_ms": 46447.569, "learn_throughput": 86.119, "synch_weights_time_ms": 16.269}, "counters": {"num_env_steps_sampled": 272000, "num_env_steps_trained": 272000, "num_agent_steps_sampled": 1088000, "num_agent_steps_trained": 1088000}, "done": false, "training_iteration": 68, "trial_id": "cf3bb_00000", "date": "2024-08-20_09-40-35", "timestamp": 1724127035, "time_this_iter_s": 47.57001280784607, "time_total_s": 11298.021207809448, "pid": 25777, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39f79ddc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 11298.021207809448, "iterations_since_restore": 68, "perf": {"cpu_util_percent": 43.156716417910445, "ram_util_percent": 82.57014925373134}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7634116998740605, "cur_kl_coeff": 0.02252540588378906, "cur_lr": 0.00010000000000000003, "total_loss": 7.215957878758668, "policy_loss": -0.0019628727478443317, "vf_loss": 7.217790279438887, "vf_explained_var": -0.001527140600971444, "kl": 0.005792563454894019, "entropy": 1.3030443903630373, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 129465.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.3596893389389, "cur_kl_coeff": 0.02109375, "cur_lr": 0.00010000000000000003, "total_loss": 8.879853370202282, "policy_loss": -0.004574835075006362, "vf_loss": 8.884229006842961, "vf_explained_var": 0.2197515488617004, "kl": 0.009443709830054013, "entropy": 0.9045762088248339, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 129465.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_agent_steps_sampled": 1104000, "num_agent_steps_trained": 1104000}, "env_runners": {"episode_reward_max": 595.2879845744435, "episode_reward_min": -752.9064668278286, "episode_reward_mean": 102.38482775689738, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1539.7888496645396, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 194.16045926660826, "predator_policy": 1573.9617271869693}, "policy_reward_mean": {"prey_policy": -298.3728073330894, "predator_policy": 349.565221211538}, "custom_metrics": {}, "hist_stats": {"episode_reward": [380.3432322110856, 53.500000000000185, 23.500000000000064, 218.77511624498547, 92.0822157708042, 37.09999999999999, 190.29999999999993, -16.719082464905128, 256.60355044630717, 98.1486382452508, 87.73584571580376, 172.7999999999995, 219.7508546796317, 197.15719452219128, 273.38803730426804, 201.50000000000003, 113.66012633321455, 122.71399641587628, 336.3, 103.34360751610113, 138.0, 169.38619258914377, 143.2, 189.2, 37.71436829253889, -583.3839869751869, 253.2702670799306, 102.75140865946533, 52.634913348532265, 45.70000000000022, 198.89999999999998, 191.7, 26.600000000000108, 197.79999999999933, -51.96199347643157, -295.75777949458114, 226.690183152443, 334.0277944969747, -120.21135007144309, 35.4, 60.30000000000015, 154.17029003260402, 115.65750008113854, -41.64594480656966, 83.1999999999995, 181.80497636583812, 124.4999999999994, -741.5835794455355, 106.64107736038324, -46.05576032314012, 306.48286312478444, 386.5150542300307, 52.199999999999974, -752.9064668278286, 77.1, 69.9, 220.19231335256978, 215.09999999999928, 152.65118286989753, 96.31660541845721, 109.50000000000004, -33.97538994278162, 73.00000000000014, 595.2879845744435, -171.53114482356, 505.9915073268889, 171.11776695296635, 139.78993815999553, 192.38362231685704, 14.7, 312.70470010490175, -18.712423115342588, 202.74202291702997, 129.41845037752995, 72.82302767694826, 283.02988493276564, 119.14230312952063, 259.17739223367215, 166.35749854505124, -210.97551594601197, -28.713809632387942, 42.000000000000014, 187.4107884230157, 41.0, 26.0, 102.19999999999985, 67.10582166660998, 277.56547896647294, 139.31666666666666, 449.8200710886061, 108.2430293001666, 20.30000000000001, 157.1, 75.82431077600556, 71.98477996938966, 37.3667360176687, 126.77148733768382, 37.181177064216136, 62.500000000000185, 51.35115065012074], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-161.8148239228496, -183.63159174144658, -214.21986948401272, -209.20932768191284, -380.3546744176106, 0.8950310803053977, -455.7060273025651, 58.318931972865876, -334.2434495493099, 44.118543736156155, -502.57855917331614, -507.594515191623, 160.13011827015262, -516.2966368773946, -301.4280414460542, -319.81880841221, -97.6931068708015, 6.961331322130718, -415.78999319893984, -1.3023145538805991, -80.5569281905487, -924.0628395386118, -200.1833080399258, 156.1028071641409, 188.17486761343756, -312.8401555918899, -74.0430867059271, 100.31885332925444, -432.5744733180259, 76.6232326692774, -694.142076930604, 189.52651222809823, -766.2055006218411, -241.60344910064748, -454.9162544391406, -527.379194192912, 165.1208180204468, 132.75082520636687, -415.33601217961376, -251.1934576748493, 45.360650584993124, -1329.6443506011174, -56.31612825222288, -327.48823401204936, -735.3246700290683, 22.91917496358066, 162.81107550365226, -691.3144734361018, 17.84726150430332, 16.814057898428324, -862.8458280035264, -1065.8230779554597, 14.915576012415531, -517.859649196494, 1.8981481672698566, -137.3433288189966, -254.4013442037774, -28.045450539998072, -61.05078408929681, -407.4733647699383, 183.57119012324182, -786.5639371734449, -715.173360240824, 178.5603209234319, -353.8520223363513, -19.047335501341145, 124.00920038768095, -120.38768815299247, -245.75537196711105, -342.0193334734799, -495.1000514303783, -744.1544000208369, -159.29338473838934, -660.1881544107524, -477.7077109206815, 185.20802654418122, -402.1103100560447, -283.74948305910124, -190.23485119016365, -906.8451639319926, -173.12628003299727, -84.6705328073819, 80.4193620297208, -238.79802954292938, -158.37333208317938, -59.591582939149674, -286.55569639020194, -352.9827367865297, -198.77976904465692, -221.93178781502397, 146.72711049053927, -161.12595841070865, -19.574726163191592, -63.25766474699048, -871.6097235586037, -1280.2725992034575, 16.104557078258683, -293.3299939353016, -375.0213786121852, -299.96153734721736, -255.1763211336949, 35.48247870716496, -940.6663287303062, 131.70395402794557, -408.8959426525332, -216.51267812518168, -1032.5287104245003, -913.0015990312526, -1169.4262710209348, -112.85571137294946, -110.46908982790237, -688.2117665501063, 53.08073035578423, -260.5370724484719, 194.16045926660826, 6.576557870653865, 39.87693992410929, -91.2471780231233, -126.17188044073174, -47.324257184002434, -870.5724511809408, -63.89653260349505, -1539.7888496645396, -1473.685009549571, 20.000000000000014, -274.0229573290822, 151.85490100615206, -846.0587354126974, -198.63055982734443, -867.8531028494631, 162.61374835534014, -977.9059451988674, 8.44403907964869, -856.0274137394942, -99.75575632662387, -197.84613357474782, -49.54724435973907, 62.27414158215238, -492.43921445337696, -703.0561820771638, 93.2603683935546, 121.69260874441989, -137.07644806884485, -357.2192665152543, 168.47352051477665, -1178.7580839189013, -99.13303821334704, -402.6637027205637, -9.988407150761944, -180.04202827652924, 13.91659059390058, -456.5577172939074, -24.153649063597733, -211.7097065749562, 98.89840678216436, -65.05076012652768, -0.5077981642202591, -96.19807146048183, -548.0270878762431, -510.7107822199348, -1455.33780419234, -1294.8225489760798, -1418.1034474469438, -374.7187487489788, -29.015904585037088, -314.2712253708627, -438.7319044445062, -1002.4266240634951, -1200.714188724665, -352.9054145200296, -4.790429157421594, -187.6882660226932, 26.423594274763527, -92.52024686990045, -99.50494471091534, -49.02240065297292, -1026.1651810655856, -38.26188000847105, -821.3405493335241, 132.40423465032745, -264.63284337538533, 69.2370170084473, -987.5182678076503, -1.0944074917951374, -1099.1159320879217, 93.9824945468969, -38.015029767738696, -265.45233240685695, -434.3896662799671, 61.380165809276626, -341.6580084751209, -111.32732166496021, -54.052395874741194, -39.451168162723036, -57.23355299465217, -315.3032261543856, -324.74640850893087, -226.46187810920074, 47.92383082793754, -528.9331946707695], "policy_predator_policy_reward": [320.21235436950724, 405.57729350587493, 258.2198694840131, 218.7093276819123, 385.3546744176107, 17.604968919694585, 301.8815873427629, 314.2806242319214, 354.8915069561152, 27.315614627842894, 509.67855917331616, 537.5945151916231, 396.826501524505, 149.64001708273676, 365.69182524327834, 238.8359421500807, 29.724535134875662, 317.61079086010216, 73.96799713110532, 441.2729488669659, 925.9628395386118, 166.39277390635235, 213.78330803992503, 3.0971928358591003, 1.5759870661941269, 342.84015559189004, 5.598563271819088, 165.2828646270446, 318.2968980936119, 311.04237985940506, 700.642076930604, 5.473487771901756, 397.6184187105856, 723.8506573451176, 527.391291187618, 577.6181538603103, 17.879181979553216, 20.549174793633156, 524.9395615431713, 244.9335158273929, 92.63934941500688, 1329.6443506011174, 293.17492419809423, 260.0156306553217, 313.19044676508315, 542.4150483004039, 26.18892449634775, 691.5144734361018, 1.100310394110277, 1.952738495696667, 985.1786485479506, 360.10627043584844, 408.70843194360793, 347.50590832040217, 21.853260492195655, 216.34332881899664, 0.0, 335.08170809230796, 76.75078408929642, 437.47336476993837, 8.428809876758177, 793.4639371734448, 716.8733602408239, 11.43967907656809, 11.925554985531507, 387.5738028521611, 58.99079961231906, 135.18768815299163, 261.87265858317954, 273.94005338098, 943.4966719566343, 0.0, 427.8604122130689, 618.3113100885182, 386.1430540120622, 240.38442486141307, 565.6484430437027, 0.0, 225.23485119016365, 907.2451639319925, 220.12628003299722, 97.97053280738115, 2.9831063449928847, 309.5658512008198, 37.94240810361474, 295.68000699985276, 597.8924883701619, 0.0, 213.97976904465608, 289.93178781502405, 128.3578390687281, 67.84598521727905, 37.0747261631918, 170.25766474699049, 0.0, 1410.2987433165258, 323.75427553126974, 60.11223868615661, 222.58213997432884, 406.34501566193376, 200.97976953426257, 325.1969360170517, 451.0438976028502, 744.4335313295406, 436.1228978853006, 241.4857228924144, 1191.6949462520402, 0.9288963758842768, 1170.526271020935, 188.85571137294932, 178.46908982790214, 690.1117665501062, 145.51912665556983, 282.1295287896874, 2.0395407333917572, 12.323442129346102, 1.1819171081702737, 202.83950386074133, 264.9393893986406, 4.8733536445509635, 875.0724511809408, 168.8965326034949, 1405.5367420843595, 1573.9617271869693, 0.0, 327.02295732908215, 521.6565464680932, 767.8352725128957, 894.9525178532474, 0.0, 830.5877632269312, 490.69594094348497, 162.5737278733177, 856.1274137394943, 437.3918280613673, 0.0, 34.04331680578049, 145.61340828866327, 505.43921445337696, 704.7561820771637, 26.989446005200804, 70.76227696172647, 82.40668982608794, 393.17660164267016, 33.86850240225335, 1179.1580839189014, 403.8454218723806, 227.3697694390599, 9.412789218039938, 253.4406738861994, 337.15061621368346, 388.52039541908897, 265.2870543075727, 89.71860446050253, 23.58255533225081, 201.74719024578468, 13.969882279942942, 249.0934858898102, 379.7070084871323, 468.0553456630338, 1493.2814747566933, 1228.1650687793378, 1418.1034474469438, 416.71874874897884, 354.98803530712996, 175.70988307178538, 479.7319044445062, 1002.4266240634951, 1200.714188724665, 378.9054145200293, 22.99042915742163, 271.6882660226932, 25.482227391846397, 107.72024686989958, 224.46209404296627, 201.6307302873951, 1027.0651810655854, 176.6785466751377, 713.9335029540564, 424.82288281774646, 270.30635483053777, 33.332500836566744, 989.3182678076503, 19.594407491795103, 1099.1159320879217, 63.117505453103114, 230.77895744254582, 148.5127155080553, 444.9942804400802, 0.0, 140.2691615582697, 350.0829045994803, 197.97994395761367, 22.29510741753438, 138.6842875707854, 271.0336686424683, 374.7464085089306, 238.96187810920003, 0.0, 532.3605144929525]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2477294380371946, "mean_inference_ms": 3.88916527939974, "mean_action_processing_ms": 1.9503643852681067, "mean_env_wait_ms": 0.7665290416816777, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0051288604736328125, "StateBufferConnector_ms": 0.0038901567459106445, "ViewRequirementAgentConnector_ms": 0.11087322235107422}, "num_episodes": 23, "episode_return_max": 595.2879845744435, "episode_return_min": -752.9064668278286, "episode_return_mean": 102.38482775689738, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1104000, "num_agent_steps_trained": 1104000, "num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 84.96798629108292, "num_env_steps_trained_throughput_per_sec": 84.96798629108292, "timesteps_total": 276000, "num_env_steps_sampled_lifetime": 276000, "num_agent_steps_sampled_lifetime": 1104000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1104000, "timers": {"training_iteration_time_ms": 47561.925, "restore_workers_time_ms": 0.014, "training_step_time_ms": 47561.876, "sample_time_ms": 1209.165, "learn_time_ms": 46333.249, "learn_throughput": 86.331, "synch_weights_time_ms": 15.836}, "counters": {"num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_agent_steps_sampled": 1104000, "num_agent_steps_trained": 1104000}, "done": false, "training_iteration": 69, "trial_id": "cf3bb_00000", "date": "2024-08-20_09-41-22", "timestamp": 1724127082, "time_this_iter_s": 47.11927080154419, "time_total_s": 11345.140478610992, "pid": 25777, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39fe29940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 11345.140478610992, "iterations_since_restore": 69, "perf": {"cpu_util_percent": 40.208955223880594, "ram_util_percent": 82.21940298507464}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2932165753983316, "cur_kl_coeff": 0.02252540588378906, "cur_lr": 0.00010000000000000003, "total_loss": 8.416924382012988, "policy_loss": -0.005602113528438307, "vf_loss": 8.42211799041304, "vf_explained_var": -0.0031146182269646376, "kl": 0.018134856619613032, "entropy": 1.345312445441251, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 131355.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.95887156182496, "cur_kl_coeff": 0.02109375, "cur_lr": 0.00010000000000000003, "total_loss": 9.517863250409485, "policy_loss": -0.0032769989692877054, "vf_loss": 9.520942704639738, "vf_explained_var": 0.25619109477946367, "kl": 0.009365818389553629, "entropy": 0.9157601449224684, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 131355.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 280000, "num_env_steps_trained": 280000, "num_agent_steps_sampled": 1120000, "num_agent_steps_trained": 1120000}, "env_runners": {"episode_reward_max": 595.2879845744435, "episode_reward_min": -752.9064668278286, "episode_reward_mean": 86.77023745305671, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1539.7888496645396, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 194.16045926660826, "predator_policy": 1573.9617271869693}, "policy_reward_mean": {"prey_policy": -312.383146463282, "predator_policy": 355.76826518981034}, "custom_metrics": {}, "hist_stats": {"episode_reward": [336.3, 103.34360751610113, 138.0, 169.38619258914377, 143.2, 189.2, 37.71436829253889, -583.3839869751869, 253.2702670799306, 102.75140865946533, 52.634913348532265, 45.70000000000022, 198.89999999999998, 191.7, 26.600000000000108, 197.79999999999933, -51.96199347643157, -295.75777949458114, 226.690183152443, 334.0277944969747, -120.21135007144309, 35.4, 60.30000000000015, 154.17029003260402, 115.65750008113854, -41.64594480656966, 83.1999999999995, 181.80497636583812, 124.4999999999994, -741.5835794455355, 106.64107736038324, -46.05576032314012, 306.48286312478444, 386.5150542300307, 52.199999999999974, -752.9064668278286, 77.1, 69.9, 220.19231335256978, 215.09999999999928, 152.65118286989753, 96.31660541845721, 109.50000000000004, -33.97538994278162, 73.00000000000014, 595.2879845744435, -171.53114482356, 505.9915073268889, 171.11776695296635, 139.78993815999553, 192.38362231685704, 14.7, 312.70470010490175, -18.712423115342588, 202.74202291702997, 129.41845037752995, 72.82302767694826, 283.02988493276564, 119.14230312952063, 259.17739223367215, 166.35749854505124, -210.97551594601197, -28.713809632387942, 42.000000000000014, 187.4107884230157, 41.0, 26.0, 102.19999999999985, 67.10582166660998, 277.56547896647294, 139.31666666666666, 449.8200710886061, 108.2430293001666, 20.30000000000001, 157.1, 75.82431077600556, 71.98477996938966, 37.3667360176687, 126.77148733768382, 37.181177064216136, 62.500000000000185, 51.35115065012074, -72.67905980345225, -48.26738430621522, 55.099999999999994, 111.7077969007608, 54.63104927410561, 78.10000000000014, 358.6083772708219, 65.6, 76.08353735701314, 3.29452664619542, -231.97509078260734, 109.0507618758971, 18.012765488537894, 253.99797582101775, 70.83383759620642, -85.06749751595665, 102.57140553799519, 241.27769368012525], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [165.1208180204468, 132.75082520636687, -415.33601217961376, -251.1934576748493, 45.360650584993124, -1329.6443506011174, -56.31612825222288, -327.48823401204936, -735.3246700290683, 22.91917496358066, 162.81107550365226, -691.3144734361018, 17.84726150430332, 16.814057898428324, -862.8458280035264, -1065.8230779554597, 14.915576012415531, -517.859649196494, 1.8981481672698566, -137.3433288189966, -254.4013442037774, -28.045450539998072, -61.05078408929681, -407.4733647699383, 183.57119012324182, -786.5639371734449, -715.173360240824, 178.5603209234319, -353.8520223363513, -19.047335501341145, 124.00920038768095, -120.38768815299247, -245.75537196711105, -342.0193334734799, -495.1000514303783, -744.1544000208369, -159.29338473838934, -660.1881544107524, -477.7077109206815, 185.20802654418122, -402.1103100560447, -283.74948305910124, -190.23485119016365, -906.8451639319926, -173.12628003299727, -84.6705328073819, 80.4193620297208, -238.79802954292938, -158.37333208317938, -59.591582939149674, -286.55569639020194, -352.9827367865297, -198.77976904465692, -221.93178781502397, 146.72711049053927, -161.12595841070865, -19.574726163191592, -63.25766474699048, -871.6097235586037, -1280.2725992034575, 16.104557078258683, -293.3299939353016, -375.0213786121852, -299.96153734721736, -255.1763211336949, 35.48247870716496, -940.6663287303062, 131.70395402794557, -408.8959426525332, -216.51267812518168, -1032.5287104245003, -913.0015990312526, -1169.4262710209348, -112.85571137294946, -110.46908982790237, -688.2117665501063, 53.08073035578423, -260.5370724484719, 194.16045926660826, 6.576557870653865, 39.87693992410929, -91.2471780231233, -126.17188044073174, -47.324257184002434, -870.5724511809408, -63.89653260349505, -1539.7888496645396, -1473.685009549571, 20.000000000000014, -274.0229573290822, 151.85490100615206, -846.0587354126974, -198.63055982734443, -867.8531028494631, 162.61374835534014, -977.9059451988674, 8.44403907964869, -856.0274137394942, -99.75575632662387, -197.84613357474782, -49.54724435973907, 62.27414158215238, -492.43921445337696, -703.0561820771638, 93.2603683935546, 121.69260874441989, -137.07644806884485, -357.2192665152543, 168.47352051477665, -1178.7580839189013, -99.13303821334704, -402.6637027205637, -9.988407150761944, -180.04202827652924, 13.91659059390058, -456.5577172939074, -24.153649063597733, -211.7097065749562, 98.89840678216436, -65.05076012652768, -0.5077981642202591, -96.19807146048183, -548.0270878762431, -510.7107822199348, -1455.33780419234, -1294.8225489760798, -1418.1034474469438, -374.7187487489788, -29.015904585037088, -314.2712253708627, -438.7319044445062, -1002.4266240634951, -1200.714188724665, -352.9054145200296, -4.790429157421594, -187.6882660226932, 26.423594274763527, -92.52024686990045, -99.50494471091534, -49.02240065297292, -1026.1651810655856, -38.26188000847105, -821.3405493335241, 132.40423465032745, -264.63284337538533, 69.2370170084473, -987.5182678076503, -1.0944074917951374, -1099.1159320879217, 93.9824945468969, -38.015029767738696, -265.45233240685695, -434.3896662799671, 61.380165809276626, -341.6580084751209, -111.32732166496021, -54.052395874741194, -39.451168162723036, -57.23355299465217, -315.3032261543856, -324.74640850893087, -226.46187810920074, 47.92383082793754, -528.9331946707695, -329.3793706257987, -199.17328670883532, -173.86498912664138, -336.5247341842154, -173.95023807159353, -1113.0915655999736, -122.65230009980891, -348.1335156682935, -433.5397759707188, 11.867564862418412, -194.11356548767225, -154.9637043698008, 100.60782991910574, -450.0866757838698, -154.5995313558811, -980.2970365086976, -656.6255664406845, -285.14664789262997, -505.79612390233, -340.37579464091243, -809.2129524367581, -669.993318181506, -193.44386458858182, -271.8386003731309, -237.57161367058157, -91.90969665948543, -8.614079165765954, -610.8010167705338, -265.22913400763775, -189.35206009749447, -237.656884236531, -338.7982415053559, -38.72739525940661, -433.2863989374675, 18.48647760240719, 86.70120279795537], "policy_predator_policy_reward": [17.879181979553216, 20.549174793633156, 524.9395615431713, 244.9335158273929, 92.63934941500688, 1329.6443506011174, 293.17492419809423, 260.0156306553217, 313.19044676508315, 542.4150483004039, 26.18892449634775, 691.5144734361018, 1.100310394110277, 1.952738495696667, 985.1786485479506, 360.10627043584844, 408.70843194360793, 347.50590832040217, 21.853260492195655, 216.34332881899664, 0.0, 335.08170809230796, 76.75078408929642, 437.47336476993837, 8.428809876758177, 793.4639371734448, 716.8733602408239, 11.43967907656809, 11.925554985531507, 387.5738028521611, 58.99079961231906, 135.18768815299163, 261.87265858317954, 273.94005338098, 943.4966719566343, 0.0, 427.8604122130689, 618.3113100885182, 386.1430540120622, 240.38442486141307, 565.6484430437027, 0.0, 225.23485119016365, 907.2451639319925, 220.12628003299722, 97.97053280738115, 2.9831063449928847, 309.5658512008198, 37.94240810361474, 295.68000699985276, 597.8924883701619, 0.0, 213.97976904465608, 289.93178781502405, 128.3578390687281, 67.84598521727905, 37.0747261631918, 170.25766474699049, 0.0, 1410.2987433165258, 323.75427553126974, 60.11223868615661, 222.58213997432884, 406.34501566193376, 200.97976953426257, 325.1969360170517, 451.0438976028502, 744.4335313295406, 436.1228978853006, 241.4857228924144, 1191.6949462520402, 0.9288963758842768, 1170.526271020935, 188.85571137294932, 178.46908982790214, 690.1117665501062, 145.51912665556983, 282.1295287896874, 2.0395407333917572, 12.323442129346102, 1.1819171081702737, 202.83950386074133, 264.9393893986406, 4.8733536445509635, 875.0724511809408, 168.8965326034949, 1405.5367420843595, 1573.9617271869693, 0.0, 327.02295732908215, 521.6565464680932, 767.8352725128957, 894.9525178532474, 0.0, 830.5877632269312, 490.69594094348497, 162.5737278733177, 856.1274137394943, 437.3918280613673, 0.0, 34.04331680578049, 145.61340828866327, 505.43921445337696, 704.7561820771637, 26.989446005200804, 70.76227696172647, 82.40668982608794, 393.17660164267016, 33.86850240225335, 1179.1580839189014, 403.8454218723806, 227.3697694390599, 9.412789218039938, 253.4406738861994, 337.15061621368346, 388.52039541908897, 265.2870543075727, 89.71860446050253, 23.58255533225081, 201.74719024578468, 13.969882279942942, 249.0934858898102, 379.7070084871323, 468.0553456630338, 1493.2814747566933, 1228.1650687793378, 1418.1034474469438, 416.71874874897884, 354.98803530712996, 175.70988307178538, 479.7319044445062, 1002.4266240634951, 1200.714188724665, 378.9054145200293, 22.99042915742163, 271.6882660226932, 25.482227391846397, 107.72024686989958, 224.46209404296627, 201.6307302873951, 1027.0651810655854, 176.6785466751377, 713.9335029540564, 424.82288281774646, 270.30635483053777, 33.332500836566744, 989.3182678076503, 19.594407491795103, 1099.1159320879217, 63.117505453103114, 230.77895744254582, 148.5127155080553, 444.9942804400802, 0.0, 140.2691615582697, 350.0829045994803, 197.97994395761367, 22.29510741753438, 138.6842875707854, 271.0336686424683, 374.7464085089306, 238.96187810920003, 0.0, 532.3605144929525, 158.50881386277618, 297.3647836684057, 4.9364396476712304, 457.1858993569699, 229.05023807159353, 1113.0915655999736, 275.018446175261, 307.475166493602, 2.9537347945888537, 473.3495255878169, 259.11356548767225, 168.06370436980063, 366.3168855167201, 341.7703376188652, 218.79953135588104, 981.6970365086976, 258.88812221761685, 758.9676294727107, 372.4225889990809, 477.04385619035685, 515.2097279846471, 732.02145185101, 8.25571644502211, 566.0775103925873, 7.4035272080811945, 340.09054861052385, 315.2601266832492, 558.1529450740685, 280.0074621234886, 245.4075695778502, 252.2426547727296, 239.14497345320106, 383.0280858994622, 191.55711383540634, 100.41352239759281, 35.67649088216992]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2392190372158647, "mean_inference_ms": 3.854910066716071, "mean_action_processing_ms": 1.927413059527721, "mean_env_wait_ms": 0.7587404343186605, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0054503679275512695, "StateBufferConnector_ms": 0.003861546516418457, "ViewRequirementAgentConnector_ms": 0.10832488536834717}, "num_episodes": 18, "episode_return_max": 595.2879845744435, "episode_return_min": -752.9064668278286, "episode_return_mean": 86.77023745305671, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1120000, "num_agent_steps_trained": 1120000, "num_env_steps_sampled": 280000, "num_env_steps_trained": 280000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 84.0452671990173, "num_env_steps_trained_throughput_per_sec": 84.0452671990173, "timesteps_total": 280000, "num_env_steps_sampled_lifetime": 280000, "num_agent_steps_sampled_lifetime": 1120000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1120000, "timers": {"training_iteration_time_ms": 47513.128, "restore_workers_time_ms": 0.014, "training_step_time_ms": 47513.082, "sample_time_ms": 1135.318, "learn_time_ms": 46359.477, "learn_throughput": 86.282, "synch_weights_time_ms": 15.381}, "counters": {"num_env_steps_sampled": 280000, "num_env_steps_trained": 280000, "num_agent_steps_sampled": 1120000, "num_agent_steps_trained": 1120000}, "done": false, "training_iteration": 70, "trial_id": "cf3bb_00000", "date": "2024-08-20_09-42-10", "timestamp": 1724127130, "time_this_iter_s": 47.62934970855713, "time_total_s": 11392.76982831955, "pid": 25777, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39ffb8550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 11392.76982831955, "iterations_since_restore": 70, "perf": {"cpu_util_percent": 34.90441176470589, "ram_util_percent": 81.2529411764706}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3044327392622277, "cur_kl_coeff": 0.02252540588378906, "cur_lr": 0.00010000000000000003, "total_loss": 7.016202568629431, "policy_loss": -0.001798970070815394, "vf_loss": 7.0177786466305845, "vf_explained_var": -4.447348534114777e-05, "kl": 0.009895636291145265, "entropy": 1.283214668559019, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 133245.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 14.0523963046137, "cur_kl_coeff": 0.02109375, "cur_lr": 0.00010000000000000003, "total_loss": 8.464566997497801, "policy_loss": -0.008163511827982292, "vf_loss": 8.47240316401083, "vf_explained_var": 0.22593626525036242, "kl": 0.015519654117064246, "entropy": 0.869711789252266, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 133245.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 284000, "num_env_steps_trained": 284000, "num_agent_steps_sampled": 1136000, "num_agent_steps_trained": 1136000}, "env_runners": {"episode_reward_max": 595.2879845744435, "episode_reward_min": -752.9064668278286, "episode_reward_mean": 91.42799580883455, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1539.7888496645396, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 194.16045926660826, "predator_policy": 1573.9617271869693}, "policy_reward_mean": {"prey_policy": -317.2146918514973, "predator_policy": 362.9286897559146}, "custom_metrics": {}, "hist_stats": {"episode_reward": [226.690183152443, 334.0277944969747, -120.21135007144309, 35.4, 60.30000000000015, 154.17029003260402, 115.65750008113854, -41.64594480656966, 83.1999999999995, 181.80497636583812, 124.4999999999994, -741.5835794455355, 106.64107736038324, -46.05576032314012, 306.48286312478444, 386.5150542300307, 52.199999999999974, -752.9064668278286, 77.1, 69.9, 220.19231335256978, 215.09999999999928, 152.65118286989753, 96.31660541845721, 109.50000000000004, -33.97538994278162, 73.00000000000014, 595.2879845744435, -171.53114482356, 505.9915073268889, 171.11776695296635, 139.78993815999553, 192.38362231685704, 14.7, 312.70470010490175, -18.712423115342588, 202.74202291702997, 129.41845037752995, 72.82302767694826, 283.02988493276564, 119.14230312952063, 259.17739223367215, 166.35749854505124, -210.97551594601197, -28.713809632387942, 42.000000000000014, 187.4107884230157, 41.0, 26.0, 102.19999999999985, 67.10582166660998, 277.56547896647294, 139.31666666666666, 449.8200710886061, 108.2430293001666, 20.30000000000001, 157.1, 75.82431077600556, 71.98477996938966, 37.3667360176687, 126.77148733768382, 37.181177064216136, 62.500000000000185, 51.35115065012074, -72.67905980345225, -48.26738430621522, 55.099999999999994, 111.7077969007608, 54.63104927410561, 78.10000000000014, 358.6083772708219, 65.6, 76.08353735701314, 3.29452664619542, -231.97509078260734, 109.0507618758971, 18.012765488537894, 253.99797582101775, 70.83383759620642, -85.06749751595665, 102.57140553799519, 241.27769368012525, -72.65524806751989, 70.47890678955407, -302.5112167691644, 167.19999999999936, 65.20000000000005, 76.0, 96.26730257371017, 315.0, 54.74018843612965, 32.50360768730866, 235.83682543914944, 332.3, -14.275693045652545, 99.9082537651974, 357.7635649623778, 229.19019201418138, -138.4738506679736, 116.69999999999958], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-159.29338473838934, -660.1881544107524, -477.7077109206815, 185.20802654418122, -402.1103100560447, -283.74948305910124, -190.23485119016365, -906.8451639319926, -173.12628003299727, -84.6705328073819, 80.4193620297208, -238.79802954292938, -158.37333208317938, -59.591582939149674, -286.55569639020194, -352.9827367865297, -198.77976904465692, -221.93178781502397, 146.72711049053927, -161.12595841070865, -19.574726163191592, -63.25766474699048, -871.6097235586037, -1280.2725992034575, 16.104557078258683, -293.3299939353016, -375.0213786121852, -299.96153734721736, -255.1763211336949, 35.48247870716496, -940.6663287303062, 131.70395402794557, -408.8959426525332, -216.51267812518168, -1032.5287104245003, -913.0015990312526, -1169.4262710209348, -112.85571137294946, -110.46908982790237, -688.2117665501063, 53.08073035578423, -260.5370724484719, 194.16045926660826, 6.576557870653865, 39.87693992410929, -91.2471780231233, -126.17188044073174, -47.324257184002434, -870.5724511809408, -63.89653260349505, -1539.7888496645396, -1473.685009549571, 20.000000000000014, -274.0229573290822, 151.85490100615206, -846.0587354126974, -198.63055982734443, -867.8531028494631, 162.61374835534014, -977.9059451988674, 8.44403907964869, -856.0274137394942, -99.75575632662387, -197.84613357474782, -49.54724435973907, 62.27414158215238, -492.43921445337696, -703.0561820771638, 93.2603683935546, 121.69260874441989, -137.07644806884485, -357.2192665152543, 168.47352051477665, -1178.7580839189013, -99.13303821334704, -402.6637027205637, -9.988407150761944, -180.04202827652924, 13.91659059390058, -456.5577172939074, -24.153649063597733, -211.7097065749562, 98.89840678216436, -65.05076012652768, -0.5077981642202591, -96.19807146048183, -548.0270878762431, -510.7107822199348, -1455.33780419234, -1294.8225489760798, -1418.1034474469438, -374.7187487489788, -29.015904585037088, -314.2712253708627, -438.7319044445062, -1002.4266240634951, -1200.714188724665, -352.9054145200296, -4.790429157421594, -187.6882660226932, 26.423594274763527, -92.52024686990045, -99.50494471091534, -49.02240065297292, -1026.1651810655856, -38.26188000847105, -821.3405493335241, 132.40423465032745, -264.63284337538533, 69.2370170084473, -987.5182678076503, -1.0944074917951374, -1099.1159320879217, 93.9824945468969, -38.015029767738696, -265.45233240685695, -434.3896662799671, 61.380165809276626, -341.6580084751209, -111.32732166496021, -54.052395874741194, -39.451168162723036, -57.23355299465217, -315.3032261543856, -324.74640850893087, -226.46187810920074, 47.92383082793754, -528.9331946707695, -329.3793706257987, -199.17328670883532, -173.86498912664138, -336.5247341842154, -173.95023807159353, -1113.0915655999736, -122.65230009980891, -348.1335156682935, -433.5397759707188, 11.867564862418412, -194.11356548767225, -154.9637043698008, 100.60782991910574, -450.0866757838698, -154.5995313558811, -980.2970365086976, -656.6255664406845, -285.14664789262997, -505.79612390233, -340.37579464091243, -809.2129524367581, -669.993318181506, -193.44386458858182, -271.8386003731309, -237.57161367058157, -91.90969665948543, -8.614079165765954, -610.8010167705338, -265.22913400763775, -189.35206009749447, -237.656884236531, -338.7982415053559, -38.72739525940661, -433.2863989374675, 18.48647760240719, 86.70120279795537, -289.44596124225956, -419.5094234761639, -63.86610470348272, -192.84140117213386, -1144.6506211010037, -1019.6694996541032, 82.39968692199446, 9.765473828823751, -189.5090173092604, -832.5317769405056, -1163.4876667284318, -206.1383224455883, -197.15710345743867, -138.15772009526248, 91.01098676581617, 121.52237743722797, -308.02627942880423, -435.2291413924916, -295.5820896456433, -379.7119820720253, -1076.7693538823908, -1073.509118606617, 153.4415846586528, 133.6701103134113, -354.3706337309182, -89.90117759387283, -88.65900290317188, -84.81994614074125, 66.12407420093918, -119.81805698189467, -91.9828213767936, -101.61276129065223, -311.3941211828772, -463.7142155297404, -123.30323947770208, -265.81016697141524], "policy_predator_policy_reward": [427.8604122130689, 618.3113100885182, 386.1430540120622, 240.38442486141307, 565.6484430437027, 0.0, 225.23485119016365, 907.2451639319925, 220.12628003299722, 97.97053280738115, 2.9831063449928847, 309.5658512008198, 37.94240810361474, 295.68000699985276, 597.8924883701619, 0.0, 213.97976904465608, 289.93178781502405, 128.3578390687281, 67.84598521727905, 37.0747261631918, 170.25766474699049, 0.0, 1410.2987433165258, 323.75427553126974, 60.11223868615661, 222.58213997432884, 406.34501566193376, 200.97976953426257, 325.1969360170517, 451.0438976028502, 744.4335313295406, 436.1228978853006, 241.4857228924144, 1191.6949462520402, 0.9288963758842768, 1170.526271020935, 188.85571137294932, 178.46908982790214, 690.1117665501062, 145.51912665556983, 282.1295287896874, 2.0395407333917572, 12.323442129346102, 1.1819171081702737, 202.83950386074133, 264.9393893986406, 4.8733536445509635, 875.0724511809408, 168.8965326034949, 1405.5367420843595, 1573.9617271869693, 0.0, 327.02295732908215, 521.6565464680932, 767.8352725128957, 894.9525178532474, 0.0, 830.5877632269312, 490.69594094348497, 162.5737278733177, 856.1274137394943, 437.3918280613673, 0.0, 34.04331680578049, 145.61340828866327, 505.43921445337696, 704.7561820771637, 26.989446005200804, 70.76227696172647, 82.40668982608794, 393.17660164267016, 33.86850240225335, 1179.1580839189014, 403.8454218723806, 227.3697694390599, 9.412789218039938, 253.4406738861994, 337.15061621368346, 388.52039541908897, 265.2870543075727, 89.71860446050253, 23.58255533225081, 201.74719024578468, 13.969882279942942, 249.0934858898102, 379.7070084871323, 468.0553456630338, 1493.2814747566933, 1228.1650687793378, 1418.1034474469438, 416.71874874897884, 354.98803530712996, 175.70988307178538, 479.7319044445062, 1002.4266240634951, 1200.714188724665, 378.9054145200293, 22.99042915742163, 271.6882660226932, 25.482227391846397, 107.72024686989958, 224.46209404296627, 201.6307302873951, 1027.0651810655854, 176.6785466751377, 713.9335029540564, 424.82288281774646, 270.30635483053777, 33.332500836566744, 989.3182678076503, 19.594407491795103, 1099.1159320879217, 63.117505453103114, 230.77895744254582, 148.5127155080553, 444.9942804400802, 0.0, 140.2691615582697, 350.0829045994803, 197.97994395761367, 22.29510741753438, 138.6842875707854, 271.0336686424683, 374.7464085089306, 238.96187810920003, 0.0, 532.3605144929525, 158.50881386277618, 297.3647836684057, 4.9364396476712304, 457.1858993569699, 229.05023807159353, 1113.0915655999736, 275.018446175261, 307.475166493602, 2.9537347945888537, 473.3495255878169, 259.11356548767225, 168.06370436980063, 366.3168855167201, 341.7703376188652, 218.79953135588104, 981.6970365086976, 258.88812221761685, 758.9676294727107, 372.4225889990809, 477.04385619035685, 515.2097279846471, 732.02145185101, 8.25571644502211, 566.0775103925873, 7.4035272080811945, 340.09054861052385, 315.2601266832492, 558.1529450740685, 280.0074621234886, 245.4075695778502, 252.2426547727296, 239.14497345320106, 383.0280858994622, 191.55711383540634, 100.41352239759281, 35.67649088216992, 239.27985193667647, 397.02028471422733, 25.44683587250989, 301.7395767926605, 1156.891882272071, 704.9170217138726, 25.532782473119337, 49.50205677606248, 254.50901730926043, 832.7317769405056, 1163.4876667284318, 282.13832244558836, 106.09121313838784, 325.4909129880238, 60.98901323418384, 41.47762256277203, 351.5537908056053, 446.44181845182027, 449.37854743162023, 258.4191319733568, 1147.2930888259507, 1238.8222091022062, 45.1883050279359, 0.0, 219.832916207746, 210.16320207139245, 261.19902592970647, 12.188176879404356, 229.5575858534886, 181.89996188984475, 242.06554375561615, 180.72023092601094, 250.07072595592473, 386.563760088719, 225.30323947770216, 280.5101669714152]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.230889328951524, "mean_inference_ms": 3.8217459604210102, "mean_action_processing_ms": 1.9051207211614816, "mean_env_wait_ms": 0.7511729613347756, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006284117698669434, "StateBufferConnector_ms": 0.003954052925109863, "ViewRequirementAgentConnector_ms": 0.10824251174926758}, "num_episodes": 18, "episode_return_max": 595.2879845744435, "episode_return_min": -752.9064668278286, "episode_return_mean": 91.42799580883455, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1136000, "num_agent_steps_trained": 1136000, "num_env_steps_sampled": 284000, "num_env_steps_trained": 284000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 83.97477625805317, "num_env_steps_trained_throughput_per_sec": 83.97477625805317, "timesteps_total": 284000, "num_env_steps_sampled_lifetime": 284000, "num_agent_steps_sampled_lifetime": 1136000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1136000, "timers": {"training_iteration_time_ms": 47519.513, "restore_workers_time_ms": 0.014, "training_step_time_ms": 47519.466, "sample_time_ms": 1130.316, "learn_time_ms": 46370.822, "learn_throughput": 86.261, "synch_weights_time_ms": 14.878}, "counters": {"num_env_steps_sampled": 284000, "num_env_steps_trained": 284000, "num_agent_steps_sampled": 1136000, "num_agent_steps_trained": 1136000}, "done": false, "training_iteration": 71, "trial_id": "cf3bb_00000", "date": "2024-08-20_09-42-58", "timestamp": 1724127178, "time_this_iter_s": 47.67740321159363, "time_total_s": 11440.447231531143, "pid": 25777, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39fe38ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 11440.447231531143, "iterations_since_restore": 71, "perf": {"cpu_util_percent": 33.90588235294118, "ram_util_percent": 81.59411764705882}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0038116924819491, "cur_kl_coeff": 0.02252540588378906, "cur_lr": 0.00010000000000000003, "total_loss": 4.799584940753917, "policy_loss": -0.005845145672490751, "vf_loss": 4.8050248664522925, "vf_explained_var": 0.003952505664219932, "kl": 0.017989532049127507, "entropy": 1.2351164836101431, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 135135.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 17.216915972743717, "cur_kl_coeff": 0.02109375, "cur_lr": 0.00010000000000000003, "total_loss": 6.778578965626066, "policy_loss": -0.003184173791299737, "vf_loss": 6.781607234288776, "vf_explained_var": 0.16133143775677555, "kl": 0.0073910406776697204, "entropy": 0.859977999849925, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 135135.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_agent_steps_sampled": 1152000, "num_agent_steps_trained": 1152000}, "env_runners": {"episode_reward_max": 745.1419923877354, "episode_reward_min": -302.5112167691644, "episode_reward_mean": 122.90858882118346, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1539.7888496645396, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 168.47352051477665, "predator_policy": 1573.9617271869693}, "policy_reward_mean": {"prey_policy": -291.0833881787578, "predator_policy": 352.5376825893496}, "custom_metrics": {}, "hist_stats": {"episode_reward": [152.65118286989753, 96.31660541845721, 109.50000000000004, -33.97538994278162, 73.00000000000014, 595.2879845744435, -171.53114482356, 505.9915073268889, 171.11776695296635, 139.78993815999553, 192.38362231685704, 14.7, 312.70470010490175, -18.712423115342588, 202.74202291702997, 129.41845037752995, 72.82302767694826, 283.02988493276564, 119.14230312952063, 259.17739223367215, 166.35749854505124, -210.97551594601197, -28.713809632387942, 42.000000000000014, 187.4107884230157, 41.0, 26.0, 102.19999999999985, 67.10582166660998, 277.56547896647294, 139.31666666666666, 449.8200710886061, 108.2430293001666, 20.30000000000001, 157.1, 75.82431077600556, 71.98477996938966, 37.3667360176687, 126.77148733768382, 37.181177064216136, 62.500000000000185, 51.35115065012074, -72.67905980345225, -48.26738430621522, 55.099999999999994, 111.7077969007608, 54.63104927410561, 78.10000000000014, 358.6083772708219, 65.6, 76.08353735701314, 3.29452664619542, -231.97509078260734, 109.0507618758971, 18.012765488537894, 253.99797582101775, 70.83383759620642, -85.06749751595665, 102.57140553799519, 241.27769368012525, -72.65524806751989, 70.47890678955407, -302.5112167691644, 167.19999999999936, 65.20000000000005, 76.0, 96.26730257371017, 315.0, 54.74018843612965, 32.50360768730866, 235.83682543914944, 332.3, -14.275693045652545, 99.9082537651974, 357.7635649623778, 229.19019201418138, -138.4738506679736, 116.69999999999958, 148.7094166837412, 182.49999999999943, 117.43933429396918, 214.34704684677703, 7.413288696452412, -99.78220118806271, 44.099999999999994, 152.33234999456513, 102.19999999999985, 373.37060932533814, 179.1039538528258, 286.0999999999999, 137.88139251764414, 335.40000000000003, 50.80000000000012, 111.29340751711321, 200.8653178883077, 745.1419923877354, 32.483313990859926, 168.10390969563693, 516.135119454237, 189.5999999999994], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [39.87693992410929, -91.2471780231233, -126.17188044073174, -47.324257184002434, -870.5724511809408, -63.89653260349505, -1539.7888496645396, -1473.685009549571, 20.000000000000014, -274.0229573290822, 151.85490100615206, -846.0587354126974, -198.63055982734443, -867.8531028494631, 162.61374835534014, -977.9059451988674, 8.44403907964869, -856.0274137394942, -99.75575632662387, -197.84613357474782, -49.54724435973907, 62.27414158215238, -492.43921445337696, -703.0561820771638, 93.2603683935546, 121.69260874441989, -137.07644806884485, -357.2192665152543, 168.47352051477665, -1178.7580839189013, -99.13303821334704, -402.6637027205637, -9.988407150761944, -180.04202827652924, 13.91659059390058, -456.5577172939074, -24.153649063597733, -211.7097065749562, 98.89840678216436, -65.05076012652768, -0.5077981642202591, -96.19807146048183, -548.0270878762431, -510.7107822199348, -1455.33780419234, -1294.8225489760798, -1418.1034474469438, -374.7187487489788, -29.015904585037088, -314.2712253708627, -438.7319044445062, -1002.4266240634951, -1200.714188724665, -352.9054145200296, -4.790429157421594, -187.6882660226932, 26.423594274763527, -92.52024686990045, -99.50494471091534, -49.02240065297292, -1026.1651810655856, -38.26188000847105, -821.3405493335241, 132.40423465032745, -264.63284337538533, 69.2370170084473, -987.5182678076503, -1.0944074917951374, -1099.1159320879217, 93.9824945468969, -38.015029767738696, -265.45233240685695, -434.3896662799671, 61.380165809276626, -341.6580084751209, -111.32732166496021, -54.052395874741194, -39.451168162723036, -57.23355299465217, -315.3032261543856, -324.74640850893087, -226.46187810920074, 47.92383082793754, -528.9331946707695, -329.3793706257987, -199.17328670883532, -173.86498912664138, -336.5247341842154, -173.95023807159353, -1113.0915655999736, -122.65230009980891, -348.1335156682935, -433.5397759707188, 11.867564862418412, -194.11356548767225, -154.9637043698008, 100.60782991910574, -450.0866757838698, -154.5995313558811, -980.2970365086976, -656.6255664406845, -285.14664789262997, -505.79612390233, -340.37579464091243, -809.2129524367581, -669.993318181506, -193.44386458858182, -271.8386003731309, -237.57161367058157, -91.90969665948543, -8.614079165765954, -610.8010167705338, -265.22913400763775, -189.35206009749447, -237.656884236531, -338.7982415053559, -38.72739525940661, -433.2863989374675, 18.48647760240719, 86.70120279795537, -289.44596124225956, -419.5094234761639, -63.86610470348272, -192.84140117213386, -1144.6506211010037, -1019.6694996541032, 82.39968692199446, 9.765473828823751, -189.5090173092604, -832.5317769405056, -1163.4876667284318, -206.1383224455883, -197.15710345743867, -138.15772009526248, 91.01098676581617, 121.52237743722797, -308.02627942880423, -435.2291413924916, -295.5820896456433, -379.7119820720253, -1076.7693538823908, -1073.509118606617, 153.4415846586528, 133.6701103134113, -354.3706337309182, -89.90117759387283, -88.65900290317188, -84.81994614074125, 66.12407420093918, -119.81805698189467, -91.9828213767936, -101.61276129065223, -311.3941211828772, -463.7142155297404, -123.30323947770208, -265.81016697141524, -412.39924278040206, -65.79557765797702, 142.2634284710179, -234.8951929432402, -308.27986509204214, -53.718800065705935, -626.7895614579104, -102.6697686142075, -215.47295887659232, -301.2157123256867, -352.0566887982571, -289.3406350894477, -1274.8784285822885, -429.7199495056951, -91.16431355779781, -326.8396984122706, -175.5836833547112, -82.0129604350073, 39.61946758106632, -425.3151575017194, -244.01831428095716, 108.23537289795873, 92.22131750578984, 154.21067619956258, -297.8539336303314, -200.48996697546065, 165.05918471625287, 143.80152223888373, -207.65821198228826, -208.896290769654, 11.76665260524875, -228.8424708215273, -71.03272730533001, 44.03836905622613, 103.04109662975245, -1249.4020984234107, 13.383313990859705, 7.79306846933649, 10.636250139725899, 5.806695133628375, -824.8170461902386, -61.0355093007052, -88.27195559649027, 156.94039656613916], "policy_predator_policy_reward": [1.1819171081702737, 202.83950386074133, 264.9393893986406, 4.8733536445509635, 875.0724511809408, 168.8965326034949, 1405.5367420843595, 1573.9617271869693, 0.0, 327.02295732908215, 521.6565464680932, 767.8352725128957, 894.9525178532474, 0.0, 830.5877632269312, 490.69594094348497, 162.5737278733177, 856.1274137394943, 437.3918280613673, 0.0, 34.04331680578049, 145.61340828866327, 505.43921445337696, 704.7561820771637, 26.989446005200804, 70.76227696172647, 82.40668982608794, 393.17660164267016, 33.86850240225335, 1179.1580839189014, 403.8454218723806, 227.3697694390599, 9.412789218039938, 253.4406738861994, 337.15061621368346, 388.52039541908897, 265.2870543075727, 89.71860446050253, 23.58255533225081, 201.74719024578468, 13.969882279942942, 249.0934858898102, 379.7070084871323, 468.0553456630338, 1493.2814747566933, 1228.1650687793378, 1418.1034474469438, 416.71874874897884, 354.98803530712996, 175.70988307178538, 479.7319044445062, 1002.4266240634951, 1200.714188724665, 378.9054145200293, 22.99042915742163, 271.6882660226932, 25.482227391846397, 107.72024686989958, 224.46209404296627, 201.6307302873951, 1027.0651810655854, 176.6785466751377, 713.9335029540564, 424.82288281774646, 270.30635483053777, 33.332500836566744, 989.3182678076503, 19.594407491795103, 1099.1159320879217, 63.117505453103114, 230.77895744254582, 148.5127155080553, 444.9942804400802, 0.0, 140.2691615582697, 350.0829045994803, 197.97994395761367, 22.29510741753438, 138.6842875707854, 271.0336686424683, 374.7464085089306, 238.96187810920003, 0.0, 532.3605144929525, 158.50881386277618, 297.3647836684057, 4.9364396476712304, 457.1858993569699, 229.05023807159353, 1113.0915655999736, 275.018446175261, 307.475166493602, 2.9537347945888537, 473.3495255878169, 259.11356548767225, 168.06370436980063, 366.3168855167201, 341.7703376188652, 218.79953135588104, 981.6970365086976, 258.88812221761685, 758.9676294727107, 372.4225889990809, 477.04385619035685, 515.2097279846471, 732.02145185101, 8.25571644502211, 566.0775103925873, 7.4035272080811945, 340.09054861052385, 315.2601266832492, 558.1529450740685, 280.0074621234886, 245.4075695778502, 252.2426547727296, 239.14497345320106, 383.0280858994622, 191.55711383540634, 100.41352239759281, 35.67649088216992, 239.27985193667647, 397.02028471422733, 25.44683587250989, 301.7395767926605, 1156.891882272071, 704.9170217138726, 25.532782473119337, 49.50205677606248, 254.50901730926043, 832.7317769405056, 1163.4876667284318, 282.13832244558836, 106.09121313838784, 325.4909129880238, 60.98901323418384, 41.47762256277203, 351.5537908056053, 446.44181845182027, 449.37854743162023, 258.4191319733568, 1147.2930888259507, 1238.8222091022062, 45.1883050279359, 0.0, 219.832916207746, 210.16320207139245, 261.19902592970647, 12.188176879404356, 229.5575858534886, 181.89996188984475, 242.06554375561615, 180.72023092601094, 250.07072595592473, 386.563760088719, 225.30323947770216, 280.5101669714152, 279.88390397719695, 347.0203331449228, 51.947092196011454, 223.1846722762101, 387.6286011449614, 91.80939830675558, 478.2529070304264, 465.55346988846907, 109.54975435123688, 414.55220554749457, 4.504885777531433, 537.1102369221111, 1274.8784285822885, 473.81994950569504, 375.08710371846246, 195.2492582461714, 262.58368335471124, 97.2129604350065, 320.7151888382501, 438.35111040774103, 13.93821193345293, 300.94868330237136, 3.0639272643097257, 36.60407903033787, 436.57958052444235, 199.6457125989934, 21.04081528374713, 5.498477761116254, 248.65821198228826, 218.69629076965353, 240.9531486872507, 87.41607704614094, 37.36330649469729, 190.49636964271417, 739.7587601342522, 1151.7442340471418, 0.0, 11.306931530663476, 129.2944760676614, 22.36648835462181, 815.5457645981671, 586.4419103470137, 103.5719555964894, 17.35960343386087]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.222518170836204, "mean_inference_ms": 3.7781378564971977, "mean_action_processing_ms": 1.8798399105111698, "mean_env_wait_ms": 0.7437289849220449, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006780505180358887, "StateBufferConnector_ms": 0.0039179325103759766, "ViewRequirementAgentConnector_ms": 0.10374414920806885}, "num_episodes": 22, "episode_return_max": 745.1419923877354, "episode_return_min": -302.5112167691644, "episode_return_mean": 122.90858882118346, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1152000, "num_agent_steps_trained": 1152000, "num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 84.3481594610861, "num_env_steps_trained_throughput_per_sec": 84.3481594610861, "timesteps_total": 288000, "num_env_steps_sampled_lifetime": 288000, "num_agent_steps_sampled_lifetime": 1152000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1152000, "timers": {"training_iteration_time_ms": 47536.342, "restore_workers_time_ms": 0.014, "training_step_time_ms": 47536.296, "sample_time_ms": 1135.333, "learn_time_ms": 46383.002, "learn_throughput": 86.238, "synch_weights_time_ms": 14.816}, "counters": {"num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_agent_steps_sampled": 1152000, "num_agent_steps_trained": 1152000}, "done": false, "training_iteration": 72, "trial_id": "cf3bb_00000", "date": "2024-08-20_09-43-45", "timestamp": 1724127225, "time_this_iter_s": 47.460805892944336, "time_total_s": 11487.908037424088, "pid": 25777, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39ffac310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 11487.908037424088, "iterations_since_restore": 72, "perf": {"cpu_util_percent": 37.007462686567166, "ram_util_percent": 81.86119402985075}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9370107094762187, "cur_kl_coeff": 0.02252540588378906, "cur_lr": 0.00010000000000000003, "total_loss": 5.309203728670797, "policy_loss": -0.005269334272841218, "vf_loss": 5.31402315021192, "vf_explained_var": 0.008801188197716203, "kl": 0.019973703656557085, "entropy": 1.1919585656867455, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 137025.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 16.68411989104811, "cur_kl_coeff": 0.02109375, "cur_lr": 0.00010000000000000003, "total_loss": 7.779276063454845, "policy_loss": -0.004326216019221911, "vf_loss": 7.783471628723952, "vf_explained_var": -0.02734397362779688, "kl": 0.00619388930828668, "entropy": 0.8105563988445927, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 137025.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 292000, "num_env_steps_trained": 292000, "num_agent_steps_sampled": 1168000, "num_agent_steps_trained": 1168000}, "env_runners": {"episode_reward_max": 745.1419923877354, "episode_reward_min": -302.5112167691644, "episode_reward_mean": 131.44089815296863, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1418.1034474469438, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 194.6, "predator_policy": 1418.1034474469438}, "policy_reward_mean": {"prey_policy": -232.22879110044724, "predator_policy": 297.9492401769315}, "custom_metrics": {}, "hist_stats": {"episode_reward": [42.000000000000014, 187.4107884230157, 41.0, 26.0, 102.19999999999985, 67.10582166660998, 277.56547896647294, 139.31666666666666, 449.8200710886061, 108.2430293001666, 20.30000000000001, 157.1, 75.82431077600556, 71.98477996938966, 37.3667360176687, 126.77148733768382, 37.181177064216136, 62.500000000000185, 51.35115065012074, -72.67905980345225, -48.26738430621522, 55.099999999999994, 111.7077969007608, 54.63104927410561, 78.10000000000014, 358.6083772708219, 65.6, 76.08353735701314, 3.29452664619542, -231.97509078260734, 109.0507618758971, 18.012765488537894, 253.99797582101775, 70.83383759620642, -85.06749751595665, 102.57140553799519, 241.27769368012525, -72.65524806751989, 70.47890678955407, -302.5112167691644, 167.19999999999936, 65.20000000000005, 76.0, 96.26730257371017, 315.0, 54.74018843612965, 32.50360768730866, 235.83682543914944, 332.3, -14.275693045652545, 99.9082537651974, 357.7635649623778, 229.19019201418138, -138.4738506679736, 116.69999999999958, 148.7094166837412, 182.49999999999943, 117.43933429396918, 214.34704684677703, 7.413288696452412, -99.78220118806271, 44.099999999999994, 152.33234999456513, 102.19999999999985, 373.37060932533814, 179.1039538528258, 286.0999999999999, 137.88139251764414, 335.40000000000003, 50.80000000000012, 111.29340751711321, 200.8653178883077, 745.1419923877354, 32.483313990859926, 168.10390969563693, 516.135119454237, 189.5999999999994, 249.04664215300653, 7.216763534567761, 90.86264780393503, 101.7999999999997, 278.70000000000005, 50.96508054219411, 186.08241287577002, 389.13497475397503, 353.30000000000007, 205.45251824266842, 154.06374938900998, 33.000000000000085, 150.70445095381032, 53.000000000000185, 159.39999999999958, 186.35335776245427, 282.7332650563386, 142.43031597660953, 151.49999999999957, 116.9999999999999, 336.02056437677504, 182.52477261743914, 124.16502121680797], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-1418.1034474469438, -374.7187487489788, -29.015904585037088, -314.2712253708627, -438.7319044445062, -1002.4266240634951, -1200.714188724665, -352.9054145200296, -4.790429157421594, -187.6882660226932, 26.423594274763527, -92.52024686990045, -99.50494471091534, -49.02240065297292, -1026.1651810655856, -38.26188000847105, -821.3405493335241, 132.40423465032745, -264.63284337538533, 69.2370170084473, -987.5182678076503, -1.0944074917951374, -1099.1159320879217, 93.9824945468969, -38.015029767738696, -265.45233240685695, -434.3896662799671, 61.380165809276626, -341.6580084751209, -111.32732166496021, -54.052395874741194, -39.451168162723036, -57.23355299465217, -315.3032261543856, -324.74640850893087, -226.46187810920074, 47.92383082793754, -528.9331946707695, -329.3793706257987, -199.17328670883532, -173.86498912664138, -336.5247341842154, -173.95023807159353, -1113.0915655999736, -122.65230009980891, -348.1335156682935, -433.5397759707188, 11.867564862418412, -194.11356548767225, -154.9637043698008, 100.60782991910574, -450.0866757838698, -154.5995313558811, -980.2970365086976, -656.6255664406845, -285.14664789262997, -505.79612390233, -340.37579464091243, -809.2129524367581, -669.993318181506, -193.44386458858182, -271.8386003731309, -237.57161367058157, -91.90969665948543, -8.614079165765954, -610.8010167705338, -265.22913400763775, -189.35206009749447, -237.656884236531, -338.7982415053559, -38.72739525940661, -433.2863989374675, 18.48647760240719, 86.70120279795537, -289.44596124225956, -419.5094234761639, -63.86610470348272, -192.84140117213386, -1144.6506211010037, -1019.6694996541032, 82.39968692199446, 9.765473828823751, -189.5090173092604, -832.5317769405056, -1163.4876667284318, -206.1383224455883, -197.15710345743867, -138.15772009526248, 91.01098676581617, 121.52237743722797, -308.02627942880423, -435.2291413924916, -295.5820896456433, -379.7119820720253, -1076.7693538823908, -1073.509118606617, 153.4415846586528, 133.6701103134113, -354.3706337309182, -89.90117759387283, -88.65900290317188, -84.81994614074125, 66.12407420093918, -119.81805698189467, -91.9828213767936, -101.61276129065223, -311.3941211828772, -463.7142155297404, -123.30323947770208, -265.81016697141524, -412.39924278040206, -65.79557765797702, 142.2634284710179, -234.8951929432402, -308.27986509204214, -53.718800065705935, -626.7895614579104, -102.6697686142075, -215.47295887659232, -301.2157123256867, -352.0566887982571, -289.3406350894477, -1274.8784285822885, -429.7199495056951, -91.16431355779781, -326.8396984122706, -175.5836833547112, -82.0129604350073, 39.61946758106632, -425.3151575017194, -244.01831428095716, 108.23537289795873, 92.22131750578984, 154.21067619956258, -297.8539336303314, -200.48996697546065, 165.05918471625287, 143.80152223888373, -207.65821198228826, -208.896290769654, 11.76665260524875, -228.8424708215273, -71.03272730533001, 44.03836905622613, 103.04109662975245, -1249.4020984234107, 13.383313990859705, 7.79306846933649, 10.636250139725899, 5.806695133628375, -824.8170461902386, -61.0355093007052, -88.27195559649027, 156.94039656613916, 55.221968024836066, -112.15330286075587, -398.60975377854004, -243.5769259761891, -53.312505286754686, 30.988169323009416, 0.26358570014442306, -101.81419880013274, 88.83080525559447, 75.40600474321367, -518.670611597713, 46.766809069617395, -106.84711684831362, 69.09471637956327, 125.63058563761061, -453.1520926631207, 194.6, 127.64294014690756, 122.2213230382686, -70.14735204700573, -201.7233272585811, -131.0724792623705, 10.82470999035286, -417.93654029339916, -474.7856625738597, -93.59394716633844, 5.229794062674884, -90.84640182040589, 10.852083441047352, -27.477818342302385, -189.02149687647278, 78.35449492235217, 179.92457763288013, -149.34114893161598, -341.452804110668, 73.13933744238507, 13.395121662907577, 127.66178100618639, -548.8767963033465, 24.618037512482744, 135.86402476306608, 85.58722307550808, -689.40732882381, -104.87609589611637, -349.25137237866045, 94.26736309670376], "policy_predator_policy_reward": [1418.1034474469438, 416.71874874897884, 354.98803530712996, 175.70988307178538, 479.7319044445062, 1002.4266240634951, 1200.714188724665, 378.9054145200293, 22.99042915742163, 271.6882660226932, 25.482227391846397, 107.72024686989958, 224.46209404296627, 201.6307302873951, 1027.0651810655854, 176.6785466751377, 713.9335029540564, 424.82288281774646, 270.30635483053777, 33.332500836566744, 989.3182678076503, 19.594407491795103, 1099.1159320879217, 63.117505453103114, 230.77895744254582, 148.5127155080553, 444.9942804400802, 0.0, 140.2691615582697, 350.0829045994803, 197.97994395761367, 22.29510741753438, 138.6842875707854, 271.0336686424683, 374.7464085089306, 238.96187810920003, 0.0, 532.3605144929525, 158.50881386277618, 297.3647836684057, 4.9364396476712304, 457.1858993569699, 229.05023807159353, 1113.0915655999736, 275.018446175261, 307.475166493602, 2.9537347945888537, 473.3495255878169, 259.11356548767225, 168.06370436980063, 366.3168855167201, 341.7703376188652, 218.79953135588104, 981.6970365086976, 258.88812221761685, 758.9676294727107, 372.4225889990809, 477.04385619035685, 515.2097279846471, 732.02145185101, 8.25571644502211, 566.0775103925873, 7.4035272080811945, 340.09054861052385, 315.2601266832492, 558.1529450740685, 280.0074621234886, 245.4075695778502, 252.2426547727296, 239.14497345320106, 383.0280858994622, 191.55711383540634, 100.41352239759281, 35.67649088216992, 239.27985193667647, 397.02028471422733, 25.44683587250989, 301.7395767926605, 1156.891882272071, 704.9170217138726, 25.532782473119337, 49.50205677606248, 254.50901730926043, 832.7317769405056, 1163.4876667284318, 282.13832244558836, 106.09121313838784, 325.4909129880238, 60.98901323418384, 41.47762256277203, 351.5537908056053, 446.44181845182027, 449.37854743162023, 258.4191319733568, 1147.2930888259507, 1238.8222091022062, 45.1883050279359, 0.0, 219.832916207746, 210.16320207139245, 261.19902592970647, 12.188176879404356, 229.5575858534886, 181.89996188984475, 242.06554375561615, 180.72023092601094, 250.07072595592473, 386.563760088719, 225.30323947770216, 280.5101669714152, 279.88390397719695, 347.0203331449228, 51.947092196011454, 223.1846722762101, 387.6286011449614, 91.80939830675558, 478.2529070304264, 465.55346988846907, 109.54975435123688, 414.55220554749457, 4.504885777531433, 537.1102369221111, 1274.8784285822885, 473.81994950569504, 375.08710371846246, 195.2492582461714, 262.58368335471124, 97.2129604350065, 320.7151888382501, 438.35111040774103, 13.93821193345293, 300.94868330237136, 3.0639272643097257, 36.60407903033787, 436.57958052444235, 199.6457125989934, 21.04081528374713, 5.498477761116254, 248.65821198228826, 218.69629076965353, 240.9531486872507, 87.41607704614094, 37.36330649469729, 190.49636964271417, 739.7587601342522, 1151.7442340471418, 0.0, 11.306931530663476, 129.2944760676614, 22.36648835462181, 815.5457645981671, 586.4419103470137, 103.5719555964894, 17.35960343386087, 102.18946320364331, 203.78851378528284, 2.8835173699728323, 646.5199259193236, 9.448251036679272, 103.73873273100016, 84.83641429985556, 118.5141988001318, 21.869194744405604, 92.59399525678633, 522.8688830702895, 0.0, 190.27391646356725, 33.56089688095317, 291.9728796168004, 424.683602162685, 0.0, 31.057059853092476, 60.65024974328322, 92.72829750812213, 219.63777234017945, 267.2217835697825, 224.65349361087783, 215.45833669216876, 288.3480875007925, 430.73597319321607, 31.170205937325317, 107.44640182040494, 8.547916558952613, 167.47781834230238, 233.0214968764729, 63.99886284010208, 3.7086874234585094, 248.44114893161594, 357.4507108210067, 53.29307182388572, 6.1048783370923925, 4.338218993813619, 550.7767963033469, 90.48196248751717, 50.78198386089515, 63.78733267730572, 510.4702488762546, 466.33794846111164, 34.37905088036683, 344.769979618398]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2625786727393862, "mean_inference_ms": 3.649087120986617, "mean_action_processing_ms": 1.854324800963736, "mean_env_wait_ms": 0.7833760242444693, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006948351860046387, "StateBufferConnector_ms": 0.003858804702758789, "ViewRequirementAgentConnector_ms": 0.09972357749938965}, "num_episodes": 23, "episode_return_max": 745.1419923877354, "episode_return_min": -302.5112167691644, "episode_return_mean": 131.44089815296863, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1168000, "num_agent_steps_trained": 1168000, "num_env_steps_sampled": 292000, "num_env_steps_trained": 292000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 84.95982348921254, "num_env_steps_trained_throughput_per_sec": 84.95982348921254, "timesteps_total": 292000, "num_env_steps_sampled_lifetime": 292000, "num_agent_steps_sampled_lifetime": 1168000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1168000, "timers": {"training_iteration_time_ms": 47534.709, "restore_workers_time_ms": 0.013, "training_step_time_ms": 47534.665, "sample_time_ms": 1143.12, "learn_time_ms": 46373.428, "learn_throughput": 86.256, "synch_weights_time_ms": 15.001}, "counters": {"num_env_steps_sampled": 292000, "num_env_steps_trained": 292000, "num_agent_steps_sampled": 1168000, "num_agent_steps_trained": 1168000}, "done": false, "training_iteration": 73, "trial_id": "cf3bb_00000", "date": "2024-08-20_09-44-32", "timestamp": 1724127272, "time_this_iter_s": 47.117595911026, "time_total_s": 11535.025633335114, "pid": 25777, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39fe381f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 11535.025633335114, "iterations_since_restore": 73, "perf": {"cpu_util_percent": 40.93636363636363, "ram_util_percent": 81.86363636363636}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7794059536878079, "cur_kl_coeff": 0.02252540588378906, "cur_lr": 0.00010000000000000003, "total_loss": 5.079728712480535, "policy_loss": -0.0023980725960677895, "vf_loss": 5.0818583898443395, "vf_explained_var": 0.012221217533898732, "kl": 0.011915846202501482, "entropy": 1.1109752206575303, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 138915.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 18.08469845655734, "cur_kl_coeff": 0.02109375, "cur_lr": 0.00010000000000000003, "total_loss": 6.567573960622152, "policy_loss": -0.002659664755790598, "vf_loss": 6.569991574464021, "vf_explained_var": -0.12033259313573282, "kl": 0.011474177265706813, "entropy": 0.7724246087213041, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 138915.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 296000, "num_env_steps_trained": 296000, "num_agent_steps_sampled": 1184000, "num_agent_steps_trained": 1184000}, "env_runners": {"episode_reward_max": 745.1419923877354, "episode_reward_min": -302.5112167691644, "episode_reward_mean": 135.69244810844847, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1274.8784285822885, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 196.03446463419917, "predator_policy": 1274.8784285822885}, "policy_reward_mean": {"prey_policy": -184.9379670961033, "predator_policy": 252.78419115032753}, "custom_metrics": {}, "hist_stats": {"episode_reward": [51.35115065012074, -72.67905980345225, -48.26738430621522, 55.099999999999994, 111.7077969007608, 54.63104927410561, 78.10000000000014, 358.6083772708219, 65.6, 76.08353735701314, 3.29452664619542, -231.97509078260734, 109.0507618758971, 18.012765488537894, 253.99797582101775, 70.83383759620642, -85.06749751595665, 102.57140553799519, 241.27769368012525, -72.65524806751989, 70.47890678955407, -302.5112167691644, 167.19999999999936, 65.20000000000005, 76.0, 96.26730257371017, 315.0, 54.74018843612965, 32.50360768730866, 235.83682543914944, 332.3, -14.275693045652545, 99.9082537651974, 357.7635649623778, 229.19019201418138, -138.4738506679736, 116.69999999999958, 148.7094166837412, 182.49999999999943, 117.43933429396918, 214.34704684677703, 7.413288696452412, -99.78220118806271, 44.099999999999994, 152.33234999456513, 102.19999999999985, 373.37060932533814, 179.1039538528258, 286.0999999999999, 137.88139251764414, 335.40000000000003, 50.80000000000012, 111.29340751711321, 200.8653178883077, 745.1419923877354, 32.483313990859926, 168.10390969563693, 516.135119454237, 189.5999999999994, 249.04664215300653, 7.216763534567761, 90.86264780393503, 101.7999999999997, 278.70000000000005, 50.96508054219411, 186.08241287577002, 389.13497475397503, 353.30000000000007, 205.45251824266842, 154.06374938900998, 33.000000000000085, 150.70445095381032, 53.000000000000185, 159.39999999999958, 186.35335776245427, 282.7332650563386, 142.43031597660953, 151.49999999999957, 116.9999999999999, 336.02056437677504, 182.52477261743914, 124.16502121680797, 80.26178765413198, 254.39999999999998, 173.18989137826512, 38.70000000000028, 150.59999999999962, 77.47780275747357, 180.39999999999944, 44.70000000000012, 129.89999999999932, 112.77852756844149, -49.82821302873859, 124.49999999999967, 52.5444957294649, 55.37891242354879, 369.0, 270.24213834189834, 294.9999999999998, 95.6], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [47.92383082793754, -528.9331946707695, -329.3793706257987, -199.17328670883532, -173.86498912664138, -336.5247341842154, -173.95023807159353, -1113.0915655999736, -122.65230009980891, -348.1335156682935, -433.5397759707188, 11.867564862418412, -194.11356548767225, -154.9637043698008, 100.60782991910574, -450.0866757838698, -154.5995313558811, -980.2970365086976, -656.6255664406845, -285.14664789262997, -505.79612390233, -340.37579464091243, -809.2129524367581, -669.993318181506, -193.44386458858182, -271.8386003731309, -237.57161367058157, -91.90969665948543, -8.614079165765954, -610.8010167705338, -265.22913400763775, -189.35206009749447, -237.656884236531, -338.7982415053559, -38.72739525940661, -433.2863989374675, 18.48647760240719, 86.70120279795537, -289.44596124225956, -419.5094234761639, -63.86610470348272, -192.84140117213386, -1144.6506211010037, -1019.6694996541032, 82.39968692199446, 9.765473828823751, -189.5090173092604, -832.5317769405056, -1163.4876667284318, -206.1383224455883, -197.15710345743867, -138.15772009526248, 91.01098676581617, 121.52237743722797, -308.02627942880423, -435.2291413924916, -295.5820896456433, -379.7119820720253, -1076.7693538823908, -1073.509118606617, 153.4415846586528, 133.6701103134113, -354.3706337309182, -89.90117759387283, -88.65900290317188, -84.81994614074125, 66.12407420093918, -119.81805698189467, -91.9828213767936, -101.61276129065223, -311.3941211828772, -463.7142155297404, -123.30323947770208, -265.81016697141524, -412.39924278040206, -65.79557765797702, 142.2634284710179, -234.8951929432402, -308.27986509204214, -53.718800065705935, -626.7895614579104, -102.6697686142075, -215.47295887659232, -301.2157123256867, -352.0566887982571, -289.3406350894477, -1274.8784285822885, -429.7199495056951, -91.16431355779781, -326.8396984122706, -175.5836833547112, -82.0129604350073, 39.61946758106632, -425.3151575017194, -244.01831428095716, 108.23537289795873, 92.22131750578984, 154.21067619956258, -297.8539336303314, -200.48996697546065, 165.05918471625287, 143.80152223888373, -207.65821198228826, -208.896290769654, 11.76665260524875, -228.8424708215273, -71.03272730533001, 44.03836905622613, 103.04109662975245, -1249.4020984234107, 13.383313990859705, 7.79306846933649, 10.636250139725899, 5.806695133628375, -824.8170461902386, -61.0355093007052, -88.27195559649027, 156.94039656613916, 55.221968024836066, -112.15330286075587, -398.60975377854004, -243.5769259761891, -53.312505286754686, 30.988169323009416, 0.26358570014442306, -101.81419880013274, 88.83080525559447, 75.40600474321367, -518.670611597713, 46.766809069617395, -106.84711684831362, 69.09471637956327, 125.63058563761061, -453.1520926631207, 194.6, 127.64294014690756, 122.2213230382686, -70.14735204700573, -201.7233272585811, -131.0724792623705, 10.82470999035286, -417.93654029339916, -474.7856625738597, -93.59394716633844, 5.229794062674884, -90.84640182040589, 10.852083441047352, -27.477818342302385, -189.02149687647278, 78.35449492235217, 179.92457763288013, -149.34114893161598, -341.452804110668, 73.13933744238507, 13.395121662907577, 127.66178100618639, -548.8767963033465, 24.618037512482744, 135.86402476306608, 85.58722307550808, -689.40732882381, -104.87609589611637, -349.25137237866045, 94.26736309670376, -551.4217220584522, 10.160888673657826, -137.95264104624843, 154.86254221970637, 41.66511711648883, -49.65323231545937, 6.242471615096742, 20.000000000000014, -299.87050110489645, 107.44754555356643, -81.68046369763424, -72.56411437851382, -124.5413849941817, 157.56351959578384, -242.86885675766047, -167.50414741983198, 18.706958992550174, -17.231486831014568, -44.77441636579685, -305.77975931109825, -247.15551227352802, -170.88925196605106, -21.25309681108127, -56.84522163956676, -380.6357537557137, 3.487560768170056, -240.83240140054565, -301.27784508446456, 143.40318500155917, 196.03446463419917, 165.67085240284936, -48.96140664444816, 190.79271336972573, 97.30906287053821, 4.604845312756897, 76.69999999999996], "policy_predator_policy_reward": [0.0, 532.3605144929525, 158.50881386277618, 297.3647836684057, 4.9364396476712304, 457.1858993569699, 229.05023807159353, 1113.0915655999736, 275.018446175261, 307.475166493602, 2.9537347945888537, 473.3495255878169, 259.11356548767225, 168.06370436980063, 366.3168855167201, 341.7703376188652, 218.79953135588104, 981.6970365086976, 258.88812221761685, 758.9676294727107, 372.4225889990809, 477.04385619035685, 515.2097279846471, 732.02145185101, 8.25571644502211, 566.0775103925873, 7.4035272080811945, 340.09054861052385, 315.2601266832492, 558.1529450740685, 280.0074621234886, 245.4075695778502, 252.2426547727296, 239.14497345320106, 383.0280858994622, 191.55711383540634, 100.41352239759281, 35.67649088216992, 239.27985193667647, 397.02028471422733, 25.44683587250989, 301.7395767926605, 1156.891882272071, 704.9170217138726, 25.532782473119337, 49.50205677606248, 254.50901730926043, 832.7317769405056, 1163.4876667284318, 282.13832244558836, 106.09121313838784, 325.4909129880238, 60.98901323418384, 41.47762256277203, 351.5537908056053, 446.44181845182027, 449.37854743162023, 258.4191319733568, 1147.2930888259507, 1238.8222091022062, 45.1883050279359, 0.0, 219.832916207746, 210.16320207139245, 261.19902592970647, 12.188176879404356, 229.5575858534886, 181.89996188984475, 242.06554375561615, 180.72023092601094, 250.07072595592473, 386.563760088719, 225.30323947770216, 280.5101669714152, 279.88390397719695, 347.0203331449228, 51.947092196011454, 223.1846722762101, 387.6286011449614, 91.80939830675558, 478.2529070304264, 465.55346988846907, 109.54975435123688, 414.55220554749457, 4.504885777531433, 537.1102369221111, 1274.8784285822885, 473.81994950569504, 375.08710371846246, 195.2492582461714, 262.58368335471124, 97.2129604350065, 320.7151888382501, 438.35111040774103, 13.93821193345293, 300.94868330237136, 3.0639272643097257, 36.60407903033787, 436.57958052444235, 199.6457125989934, 21.04081528374713, 5.498477761116254, 248.65821198228826, 218.69629076965353, 240.9531486872507, 87.41607704614094, 37.36330649469729, 190.49636964271417, 739.7587601342522, 1151.7442340471418, 0.0, 11.306931530663476, 129.2944760676614, 22.36648835462181, 815.5457645981671, 586.4419103470137, 103.5719555964894, 17.35960343386087, 102.18946320364331, 203.78851378528284, 2.8835173699728323, 646.5199259193236, 9.448251036679272, 103.73873273100016, 84.83641429985556, 118.5141988001318, 21.869194744405604, 92.59399525678633, 522.8688830702895, 0.0, 190.27391646356725, 33.56089688095317, 291.9728796168004, 424.683602162685, 0.0, 31.057059853092476, 60.65024974328322, 92.72829750812213, 219.63777234017945, 267.2217835697825, 224.65349361087783, 215.45833669216876, 288.3480875007925, 430.73597319321607, 31.170205937325317, 107.44640182040494, 8.547916558952613, 167.47781834230238, 233.0214968764729, 63.99886284010208, 3.7086874234585094, 248.44114893161594, 357.4507108210067, 53.29307182388572, 6.1048783370923925, 4.338218993813619, 550.7767963033469, 90.48196248751717, 50.78198386089515, 63.78733267730572, 510.4702488762546, 466.33794846111164, 34.37905088036683, 344.769979618398, 550.6822198528107, 70.84040118611577, 211.9526410462483, 25.53745778029362, 179.6994122698754, 1.47859430736008, 12.457528384903226, 0.0, 313.1705011048995, 29.852454446433633, 42.94970286639098, 188.77267796723052, 139.1413849941809, 8.236480404216142, 253.5688567576599, 201.50414741983198, 115.89360256040843, 12.530925278055916, 277.197147822777, 186.13555542255958, 6.420311148697454, 361.7962400621432, 129.6530968110813, 72.94522163956692, 57.391767253054816, 372.3009214639537, 235.92319181192912, 361.56596709662983, 10.266290956787968, 19.296059407453704, 15.57128593904896, 137.96140664444823, 5.207286630274262, 1.6909371294617686, 14.29515468724307, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2045265951912345, "mean_inference_ms": 3.7139190765278896, "mean_action_processing_ms": 1.8330256174771538, "mean_env_wait_ms": 0.7268444277784873, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005722641944885254, "StateBufferConnector_ms": 0.00365447998046875, "ViewRequirementAgentConnector_ms": 0.09434139728546143}, "num_episodes": 18, "episode_return_max": 745.1419923877354, "episode_return_min": -302.5112167691644, "episode_return_mean": 135.69244810844847, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1184000, "num_agent_steps_trained": 1184000, "num_env_steps_sampled": 296000, "num_env_steps_trained": 296000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 84.84440519264741, "num_env_steps_trained_throughput_per_sec": 84.84440519264741, "timesteps_total": 296000, "num_env_steps_sampled_lifetime": 296000, "num_agent_steps_sampled_lifetime": 1184000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1184000, "timers": {"training_iteration_time_ms": 47514.636, "restore_workers_time_ms": 0.013, "training_step_time_ms": 47514.591, "sample_time_ms": 1176.286, "learn_time_ms": 46318.563, "learn_throughput": 86.358, "synch_weights_time_ms": 16.303}, "counters": {"num_env_steps_sampled": 296000, "num_env_steps_trained": 296000, "num_agent_steps_sampled": 1184000, "num_agent_steps_trained": 1184000}, "done": false, "training_iteration": 74, "trial_id": "cf3bb_00000", "date": "2024-08-20_09-45-19", "timestamp": 1724127319, "time_this_iter_s": 47.19685482978821, "time_total_s": 11582.222488164902, "pid": 25777, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39f79daf0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 11582.222488164902, "iterations_since_restore": 74, "perf": {"cpu_util_percent": 41.089552238805965, "ram_util_percent": 82.11343283582092}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9201015300220914, "cur_kl_coeff": 0.02252540588378906, "cur_lr": 0.00010000000000000003, "total_loss": 7.124840324391764, "policy_loss": -0.007246826070843747, "vf_loss": 7.131672830934877, "vf_explained_var": 0.0012182148045332974, "kl": 0.018392722932582428, "entropy": 0.9506298555268182, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 140805.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 15.492141649142775, "cur_kl_coeff": 0.02109375, "cur_lr": 0.00010000000000000003, "total_loss": 7.962944803540669, "policy_loss": -0.0057103366783214, "vf_loss": 7.968496776762462, "vf_explained_var": 0.18274595863604673, "kl": 0.007507780800261099, "entropy": 0.6464700894381004, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 140805.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_agent_steps_sampled": 1200000, "num_agent_steps_trained": 1200000}, "env_runners": {"episode_reward_max": 745.1419923877354, "episode_reward_min": -302.5112167691644, "episode_reward_mean": 162.09300429504054, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1274.8784285822885, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 196.03446463419917, "predator_policy": 1274.8784285822885}, "policy_reward_mean": {"prey_policy": -151.26519293300709, "predator_policy": 232.31169508052736}, "custom_metrics": {}, "hist_stats": {"episode_reward": [241.27769368012525, -72.65524806751989, 70.47890678955407, -302.5112167691644, 167.19999999999936, 65.20000000000005, 76.0, 96.26730257371017, 315.0, 54.74018843612965, 32.50360768730866, 235.83682543914944, 332.3, -14.275693045652545, 99.9082537651974, 357.7635649623778, 229.19019201418138, -138.4738506679736, 116.69999999999958, 148.7094166837412, 182.49999999999943, 117.43933429396918, 214.34704684677703, 7.413288696452412, -99.78220118806271, 44.099999999999994, 152.33234999456513, 102.19999999999985, 373.37060932533814, 179.1039538528258, 286.0999999999999, 137.88139251764414, 335.40000000000003, 50.80000000000012, 111.29340751711321, 200.8653178883077, 745.1419923877354, 32.483313990859926, 168.10390969563693, 516.135119454237, 189.5999999999994, 249.04664215300653, 7.216763534567761, 90.86264780393503, 101.7999999999997, 278.70000000000005, 50.96508054219411, 186.08241287577002, 389.13497475397503, 353.30000000000007, 205.45251824266842, 154.06374938900998, 33.000000000000085, 150.70445095381032, 53.000000000000185, 159.39999999999958, 186.35335776245427, 282.7332650563386, 142.43031597660953, 151.49999999999957, 116.9999999999999, 336.02056437677504, 182.52477261743914, 124.16502121680797, 80.26178765413198, 254.39999999999998, 173.18989137826512, 38.70000000000028, 150.59999999999962, 77.47780275747357, 180.39999999999944, 44.70000000000012, 129.89999999999932, 112.77852756844149, -49.82821302873859, 124.49999999999967, 52.5444957294649, 55.37891242354879, 369.0, 270.24213834189834, 294.9999999999998, 95.6, 125.09999999999945, 138.01827498274866, 92.52251942827223, 205.51639724679794, 162.10245259253904, 240.22275322741604, 236.05366771176648, 304.82724980406545, 340.0145719717176, 259.23508570628286, 222.79999999999995, 205.77271361480726, 250.1534807113894, 301.3382577792036, 131.50842367424207, 51.60680154884834, 139.23948826376466, 204.9776324057868], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [18.48647760240719, 86.70120279795537, -289.44596124225956, -419.5094234761639, -63.86610470348272, -192.84140117213386, -1144.6506211010037, -1019.6694996541032, 82.39968692199446, 9.765473828823751, -189.5090173092604, -832.5317769405056, -1163.4876667284318, -206.1383224455883, -197.15710345743867, -138.15772009526248, 91.01098676581617, 121.52237743722797, -308.02627942880423, -435.2291413924916, -295.5820896456433, -379.7119820720253, -1076.7693538823908, -1073.509118606617, 153.4415846586528, 133.6701103134113, -354.3706337309182, -89.90117759387283, -88.65900290317188, -84.81994614074125, 66.12407420093918, -119.81805698189467, -91.9828213767936, -101.61276129065223, -311.3941211828772, -463.7142155297404, -123.30323947770208, -265.81016697141524, -412.39924278040206, -65.79557765797702, 142.2634284710179, -234.8951929432402, -308.27986509204214, -53.718800065705935, -626.7895614579104, -102.6697686142075, -215.47295887659232, -301.2157123256867, -352.0566887982571, -289.3406350894477, -1274.8784285822885, -429.7199495056951, -91.16431355779781, -326.8396984122706, -175.5836833547112, -82.0129604350073, 39.61946758106632, -425.3151575017194, -244.01831428095716, 108.23537289795873, 92.22131750578984, 154.21067619956258, -297.8539336303314, -200.48996697546065, 165.05918471625287, 143.80152223888373, -207.65821198228826, -208.896290769654, 11.76665260524875, -228.8424708215273, -71.03272730533001, 44.03836905622613, 103.04109662975245, -1249.4020984234107, 13.383313990859705, 7.79306846933649, 10.636250139725899, 5.806695133628375, -824.8170461902386, -61.0355093007052, -88.27195559649027, 156.94039656613916, 55.221968024836066, -112.15330286075587, -398.60975377854004, -243.5769259761891, -53.312505286754686, 30.988169323009416, 0.26358570014442306, -101.81419880013274, 88.83080525559447, 75.40600474321367, -518.670611597713, 46.766809069617395, -106.84711684831362, 69.09471637956327, 125.63058563761061, -453.1520926631207, 194.6, 127.64294014690756, 122.2213230382686, -70.14735204700573, -201.7233272585811, -131.0724792623705, 10.82470999035286, -417.93654029339916, -474.7856625738597, -93.59394716633844, 5.229794062674884, -90.84640182040589, 10.852083441047352, -27.477818342302385, -189.02149687647278, 78.35449492235217, 179.92457763288013, -149.34114893161598, -341.452804110668, 73.13933744238507, 13.395121662907577, 127.66178100618639, -548.8767963033465, 24.618037512482744, 135.86402476306608, 85.58722307550808, -689.40732882381, -104.87609589611637, -349.25137237866045, 94.26736309670376, -551.4217220584522, 10.160888673657826, -137.95264104624843, 154.86254221970637, 41.66511711648883, -49.65323231545937, 6.242471615096742, 20.000000000000014, -299.87050110489645, 107.44754555356643, -81.68046369763424, -72.56411437851382, -124.5413849941817, 157.56351959578384, -242.86885675766047, -167.50414741983198, 18.706958992550174, -17.231486831014568, -44.77441636579685, -305.77975931109825, -247.15551227352802, -170.88925196605106, -21.25309681108127, -56.84522163956676, -380.6357537557137, 3.487560768170056, -240.83240140054565, -301.27784508446456, 143.40318500155917, 196.03446463419917, 165.67085240284936, -48.96140664444816, 190.79271336972573, 97.30906287053821, 4.604845312756897, 76.69999999999996, -40.50503052804813, -42.120523435676176, -945.9969496802463, -18.771741427218757, 5.765750160426206, -574.250704734499, -438.09681168694124, -25.950240282550848, 20.000000000000014, -199.74441273624615, 109.9938988947514, -306.53998566074705, 67.84402580609735, -81.52172073718316, 57.96205930717469, -524.6551488206156, 171.79084787451177, -180.0074162790843, 98.14364583448913, 49.02270265793005, -245.356563993905, 177.12490042833258, -46.23631617184324, -368.2722304621207, 40.334396146947256, 75.58713479026765, 177.25497161741077, -504.90011999091564, 40.57656271318319, -347.42035683026495, -435.7480383661033, -444.68063573283195, 97.04629137804928, -336.3151022735656, 121.2789486381695, -185.36490118778985], "policy_predator_policy_reward": [100.41352239759281, 35.67649088216992, 239.27985193667647, 397.02028471422733, 25.44683587250989, 301.7395767926605, 1156.891882272071, 704.9170217138726, 25.532782473119337, 49.50205677606248, 254.50901730926043, 832.7317769405056, 1163.4876667284318, 282.13832244558836, 106.09121313838784, 325.4909129880238, 60.98901323418384, 41.47762256277203, 351.5537908056053, 446.44181845182027, 449.37854743162023, 258.4191319733568, 1147.2930888259507, 1238.8222091022062, 45.1883050279359, 0.0, 219.832916207746, 210.16320207139245, 261.19902592970647, 12.188176879404356, 229.5575858534886, 181.89996188984475, 242.06554375561615, 180.72023092601094, 250.07072595592473, 386.563760088719, 225.30323947770216, 280.5101669714152, 279.88390397719695, 347.0203331449228, 51.947092196011454, 223.1846722762101, 387.6286011449614, 91.80939830675558, 478.2529070304264, 465.55346988846907, 109.54975435123688, 414.55220554749457, 4.504885777531433, 537.1102369221111, 1274.8784285822885, 473.81994950569504, 375.08710371846246, 195.2492582461714, 262.58368335471124, 97.2129604350065, 320.7151888382501, 438.35111040774103, 13.93821193345293, 300.94868330237136, 3.0639272643097257, 36.60407903033787, 436.57958052444235, 199.6457125989934, 21.04081528374713, 5.498477761116254, 248.65821198228826, 218.69629076965353, 240.9531486872507, 87.41607704614094, 37.36330649469729, 190.49636964271417, 739.7587601342522, 1151.7442340471418, 0.0, 11.306931530663476, 129.2944760676614, 22.36648835462181, 815.5457645981671, 586.4419103470137, 103.5719555964894, 17.35960343386087, 102.18946320364331, 203.78851378528284, 2.8835173699728323, 646.5199259193236, 9.448251036679272, 103.73873273100016, 84.83641429985556, 118.5141988001318, 21.869194744405604, 92.59399525678633, 522.8688830702895, 0.0, 190.27391646356725, 33.56089688095317, 291.9728796168004, 424.683602162685, 0.0, 31.057059853092476, 60.65024974328322, 92.72829750812213, 219.63777234017945, 267.2217835697825, 224.65349361087783, 215.45833669216876, 288.3480875007925, 430.73597319321607, 31.170205937325317, 107.44640182040494, 8.547916558952613, 167.47781834230238, 233.0214968764729, 63.99886284010208, 3.7086874234585094, 248.44114893161594, 357.4507108210067, 53.29307182388572, 6.1048783370923925, 4.338218993813619, 550.7767963033469, 90.48196248751717, 50.78198386089515, 63.78733267730572, 510.4702488762546, 466.33794846111164, 34.37905088036683, 344.769979618398, 550.6822198528107, 70.84040118611577, 211.9526410462483, 25.53745778029362, 179.6994122698754, 1.47859430736008, 12.457528384903226, 0.0, 313.1705011048995, 29.852454446433633, 42.94970286639098, 188.77267796723052, 139.1413849941809, 8.236480404216142, 253.5688567576599, 201.50414741983198, 115.89360256040843, 12.530925278055916, 277.197147822777, 186.13555542255958, 6.420311148697454, 361.7962400621432, 129.6530968110813, 72.94522163956692, 57.391767253054816, 372.3009214639537, 235.92319181192912, 361.56596709662983, 10.266290956787968, 19.296059407453704, 15.57128593904896, 137.96140664444823, 5.207286630274262, 1.6909371294617686, 14.29515468724307, 0.0, 158.2779442785317, 49.44760968519293, 946.2969496802464, 156.4900164099674, 100.6477463315014, 560.3597276708437, 457.58707218868636, 211.97637702760352, 108.10396595930999, 233.74289936947568, 150.76189354715308, 286.0069464462581, 71.75925221587916, 177.97211042697316, 347.425098606306, 424.09524071120126, 224.5009641589057, 123.73017621738408, 47.41830105313442, 64.65043616072941, 283.35656399390456, 7.675099571667399, 294.75792464811707, 325.5233356006539, 38.9401476047576, 95.29180216941694, 173.20622912939527, 455.77717702331324, 96.16063418370057, 342.19158360762333, 537.0792174134493, 394.9562582343334, 36.19319688571545, 342.3151022735657, 247.3560320453513, 21.70755291005583]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1983880457002654, "mean_inference_ms": 3.687230438694324, "mean_action_processing_ms": 1.8135720167528782, "mean_env_wait_ms": 0.7204077367908358, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008418440818786621, "StateBufferConnector_ms": 0.012410163879394531, "ViewRequirementAgentConnector_ms": 0.1175616979598999}, "num_episodes": 18, "episode_return_max": 745.1419923877354, "episode_return_min": -302.5112167691644, "episode_return_mean": 162.09300429504054, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1200000, "num_agent_steps_trained": 1200000, "num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 83.18102556605342, "num_env_steps_trained_throughput_per_sec": 83.18102556605342, "timesteps_total": 300000, "num_env_steps_sampled_lifetime": 300000, "num_agent_steps_sampled_lifetime": 1200000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1200000, "timers": {"training_iteration_time_ms": 47502.96, "restore_workers_time_ms": 0.013, "training_step_time_ms": 47502.916, "sample_time_ms": 1245.957, "learn_time_ms": 46237.551, "learn_throughput": 86.51, "synch_weights_time_ms": 16.089}, "counters": {"num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_agent_steps_sampled": 1200000, "num_agent_steps_trained": 1200000}, "done": false, "training_iteration": 75, "trial_id": "cf3bb_00000", "date": "2024-08-20_09-46-08", "timestamp": 1724127368, "time_this_iter_s": 48.127604961395264, "time_total_s": 11630.350093126297, "pid": 25777, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3aaaccb80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 11630.350093126297, "iterations_since_restore": 75, "perf": {"cpu_util_percent": 37.574999999999996, "ram_util_percent": 82.4573529411765}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9120242373889716, "cur_kl_coeff": 0.02252540588378906, "cur_lr": 0.00010000000000000003, "total_loss": 6.030124282836914, "policy_loss": -0.0017494129793097575, "vf_loss": 6.031742423678201, "vf_explained_var": 0.00022845479546400606, "kl": 0.005828519245075803, "entropy": 0.9052293504356708, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 142695.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 18.118057190299666, "cur_kl_coeff": 0.02109375, "cur_lr": 0.00010000000000000003, "total_loss": 6.950715130851382, "policy_loss": -0.003384997786968828, "vf_loss": 6.953932379414796, "vf_explained_var": 0.017046913741126893, "kl": 0.007952754909467176, "entropy": 0.8067921449898412, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 142695.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 304000, "num_env_steps_trained": 304000, "num_agent_steps_sampled": 1216000, "num_agent_steps_trained": 1216000}, "env_runners": {"episode_reward_max": 745.1419923877354, "episode_reward_min": -99.78220118806271, "episode_reward_mean": 161.10725545256787, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1274.8784285822885, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 196.03446463419917, "predator_policy": 1274.8784285822885}, "policy_reward_mean": {"prey_policy": -118.8075545479276, "predator_policy": 199.36118227421156}, "custom_metrics": {}, "hist_stats": {"episode_reward": [214.34704684677703, 7.413288696452412, -99.78220118806271, 44.099999999999994, 152.33234999456513, 102.19999999999985, 373.37060932533814, 179.1039538528258, 286.0999999999999, 137.88139251764414, 335.40000000000003, 50.80000000000012, 111.29340751711321, 200.8653178883077, 745.1419923877354, 32.483313990859926, 168.10390969563693, 516.135119454237, 189.5999999999994, 249.04664215300653, 7.216763534567761, 90.86264780393503, 101.7999999999997, 278.70000000000005, 50.96508054219411, 186.08241287577002, 389.13497475397503, 353.30000000000007, 205.45251824266842, 154.06374938900998, 33.000000000000085, 150.70445095381032, 53.000000000000185, 159.39999999999958, 186.35335776245427, 282.7332650563386, 142.43031597660953, 151.49999999999957, 116.9999999999999, 336.02056437677504, 182.52477261743914, 124.16502121680797, 80.26178765413198, 254.39999999999998, 173.18989137826512, 38.70000000000028, 150.59999999999962, 77.47780275747357, 180.39999999999944, 44.70000000000012, 129.89999999999932, 112.77852756844149, -49.82821302873859, 124.49999999999967, 52.5444957294649, 55.37891242354879, 369.0, 270.24213834189834, 294.9999999999998, 95.6, 125.09999999999945, 138.01827498274866, 92.52251942827223, 205.51639724679794, 162.10245259253904, 240.22275322741604, 236.05366771176648, 304.82724980406545, 340.0145719717176, 259.23508570628286, 222.79999999999995, 205.77271361480726, 250.1534807113894, 301.3382577792036, 131.50842367424207, 51.60680154884834, 139.23948826376466, 204.9776324057868, -89.32480523819076, 101.25730791787703, 220.02721135565017, 187.39999999999947, 172.59999999999948, 185.39999999999995, 4.724905072313266, 112.45454942002193, 118.79999999999933, 230.99999999999983, 52.34218985189816, -57.806304953807576, 83.37360989386572, -0.9312416100419982, 206.88117965253124, 147.4428642191571, -51.2431098567128, 144.63823984722026, 157.36415807744936, 28.90000000000014, 281.3236398786349, 75.89999999999975], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-626.7895614579104, -102.6697686142075, -215.47295887659232, -301.2157123256867, -352.0566887982571, -289.3406350894477, -1274.8784285822885, -429.7199495056951, -91.16431355779781, -326.8396984122706, -175.5836833547112, -82.0129604350073, 39.61946758106632, -425.3151575017194, -244.01831428095716, 108.23537289795873, 92.22131750578984, 154.21067619956258, -297.8539336303314, -200.48996697546065, 165.05918471625287, 143.80152223888373, -207.65821198228826, -208.896290769654, 11.76665260524875, -228.8424708215273, -71.03272730533001, 44.03836905622613, 103.04109662975245, -1249.4020984234107, 13.383313990859705, 7.79306846933649, 10.636250139725899, 5.806695133628375, -824.8170461902386, -61.0355093007052, -88.27195559649027, 156.94039656613916, 55.221968024836066, -112.15330286075587, -398.60975377854004, -243.5769259761891, -53.312505286754686, 30.988169323009416, 0.26358570014442306, -101.81419880013274, 88.83080525559447, 75.40600474321367, -518.670611597713, 46.766809069617395, -106.84711684831362, 69.09471637956327, 125.63058563761061, -453.1520926631207, 194.6, 127.64294014690756, 122.2213230382686, -70.14735204700573, -201.7233272585811, -131.0724792623705, 10.82470999035286, -417.93654029339916, -474.7856625738597, -93.59394716633844, 5.229794062674884, -90.84640182040589, 10.852083441047352, -27.477818342302385, -189.02149687647278, 78.35449492235217, 179.92457763288013, -149.34114893161598, -341.452804110668, 73.13933744238507, 13.395121662907577, 127.66178100618639, -548.8767963033465, 24.618037512482744, 135.86402476306608, 85.58722307550808, -689.40732882381, -104.87609589611637, -349.25137237866045, 94.26736309670376, -551.4217220584522, 10.160888673657826, -137.95264104624843, 154.86254221970637, 41.66511711648883, -49.65323231545937, 6.242471615096742, 20.000000000000014, -299.87050110489645, 107.44754555356643, -81.68046369763424, -72.56411437851382, -124.5413849941817, 157.56351959578384, -242.86885675766047, -167.50414741983198, 18.706958992550174, -17.231486831014568, -44.77441636579685, -305.77975931109825, -247.15551227352802, -170.88925196605106, -21.25309681108127, -56.84522163956676, -380.6357537557137, 3.487560768170056, -240.83240140054565, -301.27784508446456, 143.40318500155917, 196.03446463419917, 165.67085240284936, -48.96140664444816, 190.79271336972573, 97.30906287053821, 4.604845312756897, 76.69999999999996, -40.50503052804813, -42.120523435676176, -945.9969496802463, -18.771741427218757, 5.765750160426206, -574.250704734499, -438.09681168694124, -25.950240282550848, 20.000000000000014, -199.74441273624615, 109.9938988947514, -306.53998566074705, 67.84402580609735, -81.52172073718316, 57.96205930717469, -524.6551488206156, 171.79084787451177, -180.0074162790843, 98.14364583448913, 49.02270265793005, -245.356563993905, 177.12490042833258, -46.23631617184324, -368.2722304621207, 40.334396146947256, 75.58713479026765, 177.25497161741077, -504.90011999091564, 40.57656271318319, -347.42035683026495, -435.7480383661033, -444.68063573283195, 97.04629137804928, -336.3151022735656, 121.2789486381695, -185.36490118778985, -224.86421452215401, -205.41161862410146, -199.9557881659612, -435.71720090343615, -219.35955059155464, 169.96700057016395, 101.57650647318606, -185.4272366726772, 129.2025276460433, -58.74487770470703, -446.67080294557024, 173.8633561771697, -287.1514323262658, -228.2708996094993, -74.01531660412888, 16.242106218021178, -7.989166090653219, -110.02103767835764, 56.853458224525156, 106.83283768403903, -165.48701280769242, -180.0611841785376, -347.5489885170969, -446.277251852491, -442.7324403894132, -181.72665885654365, -409.67534245452566, -94.12056534797786, 17.597682095294388, 81.33792554603421, -31.691783165702653, 81.66631738775853, -365.24226434469404, -206.0074305210693, -133.52652660319953, -4.729757734059376, -541.0883360102266, 154.36415807744942, -22.736771100297474, -89.99414561679818, 119.10802491409514, 113.29611769031433, -25.272208285262387, -149.74453353804748], "policy_predator_policy_reward": [478.2529070304264, 465.55346988846907, 109.54975435123688, 414.55220554749457, 4.504885777531433, 537.1102369221111, 1274.8784285822885, 473.81994950569504, 375.08710371846246, 195.2492582461714, 262.58368335471124, 97.2129604350065, 320.7151888382501, 438.35111040774103, 13.93821193345293, 300.94868330237136, 3.0639272643097257, 36.60407903033787, 436.57958052444235, 199.6457125989934, 21.04081528374713, 5.498477761116254, 248.65821198228826, 218.69629076965353, 240.9531486872507, 87.41607704614094, 37.36330649469729, 190.49636964271417, 739.7587601342522, 1151.7442340471418, 0.0, 11.306931530663476, 129.2944760676614, 22.36648835462181, 815.5457645981671, 586.4419103470137, 103.5719555964894, 17.35960343386087, 102.18946320364331, 203.78851378528284, 2.8835173699728323, 646.5199259193236, 9.448251036679272, 103.73873273100016, 84.83641429985556, 118.5141988001318, 21.869194744405604, 92.59399525678633, 522.8688830702895, 0.0, 190.27391646356725, 33.56089688095317, 291.9728796168004, 424.683602162685, 0.0, 31.057059853092476, 60.65024974328322, 92.72829750812213, 219.63777234017945, 267.2217835697825, 224.65349361087783, 215.45833669216876, 288.3480875007925, 430.73597319321607, 31.170205937325317, 107.44640182040494, 8.547916558952613, 167.47781834230238, 233.0214968764729, 63.99886284010208, 3.7086874234585094, 248.44114893161594, 357.4507108210067, 53.29307182388572, 6.1048783370923925, 4.338218993813619, 550.7767963033469, 90.48196248751717, 50.78198386089515, 63.78733267730572, 510.4702488762546, 466.33794846111164, 34.37905088036683, 344.769979618398, 550.6822198528107, 70.84040118611577, 211.9526410462483, 25.53745778029362, 179.6994122698754, 1.47859430736008, 12.457528384903226, 0.0, 313.1705011048995, 29.852454446433633, 42.94970286639098, 188.77267796723052, 139.1413849941809, 8.236480404216142, 253.5688567576599, 201.50414741983198, 115.89360256040843, 12.530925278055916, 277.197147822777, 186.13555542255958, 6.420311148697454, 361.7962400621432, 129.6530968110813, 72.94522163956692, 57.391767253054816, 372.3009214639537, 235.92319181192912, 361.56596709662983, 10.266290956787968, 19.296059407453704, 15.57128593904896, 137.96140664444823, 5.207286630274262, 1.6909371294617686, 14.29515468724307, 0.0, 158.2779442785317, 49.44760968519293, 946.2969496802464, 156.4900164099674, 100.6477463315014, 560.3597276708437, 457.58707218868636, 211.97637702760352, 108.10396595930999, 233.74289936947568, 150.76189354715308, 286.0069464462581, 71.75925221587916, 177.97211042697316, 347.425098606306, 424.09524071120126, 224.5009641589057, 123.73017621738408, 47.41830105313442, 64.65043616072941, 283.35656399390456, 7.675099571667399, 294.75792464811707, 325.5233356006539, 38.9401476047576, 95.29180216941694, 173.20622912939527, 455.77717702331324, 96.16063418370057, 342.19158360762333, 537.0792174134493, 394.9562582343334, 36.19319688571545, 342.3151022735657, 247.3560320453513, 21.70755291005583, 336.1918888664478, 4.759139041617155, 351.2769005640409, 385.65339642323386, 258.1527477526422, 11.267013624398745, 76.42349352681394, 194.82723667267666, 26.89747235395669, 75.24487770470647, 447.6708029455703, 10.53664382283032, 501.9977151942436, 18.14952181383621, 72.772841034635, 97.45491877149479, 223.0720660516629, 13.73813771734779, 17.14654177547482, 50.16716231596099, 94.72031639261034, 303.17007044551787, 598.7980944943697, 137.22184092141296, 145.44239395799823, 562.3903151818246, 84.12254000062771, 418.74212619183356, 61.23081313031866, 46.71475888088452, 33.010302257615436, 64.45802773948655, 181.72812421961248, 338.27846078943804, 97.62541855833366, 185.26910562614592, 544.0883360102266, 0.0, 39.93677110029772, 101.69414561679751, 48.91949727422542, 0.0, 41.17220828526261, 209.74453353804762]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1915994661461007, "mean_inference_ms": 3.604381596596864, "mean_action_processing_ms": 1.839206856331049, "mean_env_wait_ms": 0.7139484668538798, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0074874162673950195, "StateBufferConnector_ms": 0.011888265609741211, "ViewRequirementAgentConnector_ms": 0.11695730686187744}, "num_episodes": 22, "episode_return_max": 745.1419923877354, "episode_return_min": -99.78220118806271, "episode_return_mean": 161.10725545256787, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1216000, "num_agent_steps_trained": 1216000, "num_env_steps_sampled": 304000, "num_env_steps_trained": 304000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 84.90802535140726, "num_env_steps_trained_throughput_per_sec": 84.90802535140726, "timesteps_total": 304000, "num_env_steps_sampled_lifetime": 304000, "num_agent_steps_sampled_lifetime": 1216000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1216000, "timers": {"training_iteration_time_ms": 47456.529, "restore_workers_time_ms": 0.013, "training_step_time_ms": 47456.484, "sample_time_ms": 1243.421, "learn_time_ms": 46193.922, "learn_throughput": 86.591, "synch_weights_time_ms": 15.377}, "counters": {"num_env_steps_sampled": 304000, "num_env_steps_trained": 304000, "num_agent_steps_sampled": 1216000, "num_agent_steps_trained": 1216000}, "done": false, "training_iteration": 76, "trial_id": "cf3bb_00000", "date": "2024-08-20_09-46-55", "timestamp": 1724127415, "time_this_iter_s": 47.1473331451416, "time_total_s": 11677.497426271439, "pid": 25777, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39fe38160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 11677.497426271439, "iterations_since_restore": 76, "perf": {"cpu_util_percent": 32.722388059701494, "ram_util_percent": 82.26417910447762}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8275797459498915, "cur_kl_coeff": 0.02252540588378906, "cur_lr": 0.00010000000000000003, "total_loss": 6.7420850592315515, "policy_loss": -0.0020211225732786474, "vf_loss": 6.744039297608471, "vf_explained_var": 0.0026111707170173603, "kl": 0.0029693023460925054, "entropy": 0.9118200354159824, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 144585.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 14.032859791018975, "cur_kl_coeff": 0.02109375, "cur_lr": 0.00010000000000000003, "total_loss": 7.9095571775285025, "policy_loss": -0.0015824947904095684, "vf_loss": 7.911030164345232, "vf_explained_var": 0.02473435748821844, "kl": 0.005190955461680902, "entropy": 0.8170372329691731, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 144585.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 308000, "num_env_steps_trained": 308000, "num_agent_steps_sampled": 1232000, "num_agent_steps_trained": 1232000}, "env_runners": {"episode_reward_max": 389.13497475397503, "episode_reward_min": -190.14997935902528, "episode_reward_mean": 143.51689035472785, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -945.9969496802463, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 196.03446463419917, "predator_policy": 946.2969496802464}, "policy_reward_mean": {"prey_policy": -110.51565059531895, "predator_policy": 182.27409577268293}, "custom_metrics": {}, "hist_stats": {"episode_reward": [189.5999999999994, 249.04664215300653, 7.216763534567761, 90.86264780393503, 101.7999999999997, 278.70000000000005, 50.96508054219411, 186.08241287577002, 389.13497475397503, 353.30000000000007, 205.45251824266842, 154.06374938900998, 33.000000000000085, 150.70445095381032, 53.000000000000185, 159.39999999999958, 186.35335776245427, 282.7332650563386, 142.43031597660953, 151.49999999999957, 116.9999999999999, 336.02056437677504, 182.52477261743914, 124.16502121680797, 80.26178765413198, 254.39999999999998, 173.18989137826512, 38.70000000000028, 150.59999999999962, 77.47780275747357, 180.39999999999944, 44.70000000000012, 129.89999999999932, 112.77852756844149, -49.82821302873859, 124.49999999999967, 52.5444957294649, 55.37891242354879, 369.0, 270.24213834189834, 294.9999999999998, 95.6, 125.09999999999945, 138.01827498274866, 92.52251942827223, 205.51639724679794, 162.10245259253904, 240.22275322741604, 236.05366771176648, 304.82724980406545, 340.0145719717176, 259.23508570628286, 222.79999999999995, 205.77271361480726, 250.1534807113894, 301.3382577792036, 131.50842367424207, 51.60680154884834, 139.23948826376466, 204.9776324057868, -89.32480523819076, 101.25730791787703, 220.02721135565017, 187.39999999999947, 172.59999999999948, 185.39999999999995, 4.724905072313266, 112.45454942002193, 118.79999999999933, 230.99999999999983, 52.34218985189816, -57.806304953807576, 83.37360989386572, -0.9312416100419982, 206.88117965253124, 147.4428642191571, -51.2431098567128, 144.63823984722026, 157.36415807744936, 28.90000000000014, 281.3236398786349, 75.89999999999975, 164.06231006992934, 131.39999999999966, -190.14997935902528, 205.82040904173385, 77.6905633935074, 167.79999999999973, 157.4, 142.51430008165116, 243.15840812233142, 84.57619069448918, 55.31029635588096, 6.708038681802445, 68.50000000000011, 34.621848010851984, 37.10000000000026, 123.39999999999995, 222.39848156794415, 65.9421245343312], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-88.27195559649027, 156.94039656613916, 55.221968024836066, -112.15330286075587, -398.60975377854004, -243.5769259761891, -53.312505286754686, 30.988169323009416, 0.26358570014442306, -101.81419880013274, 88.83080525559447, 75.40600474321367, -518.670611597713, 46.766809069617395, -106.84711684831362, 69.09471637956327, 125.63058563761061, -453.1520926631207, 194.6, 127.64294014690756, 122.2213230382686, -70.14735204700573, -201.7233272585811, -131.0724792623705, 10.82470999035286, -417.93654029339916, -474.7856625738597, -93.59394716633844, 5.229794062674884, -90.84640182040589, 10.852083441047352, -27.477818342302385, -189.02149687647278, 78.35449492235217, 179.92457763288013, -149.34114893161598, -341.452804110668, 73.13933744238507, 13.395121662907577, 127.66178100618639, -548.8767963033465, 24.618037512482744, 135.86402476306608, 85.58722307550808, -689.40732882381, -104.87609589611637, -349.25137237866045, 94.26736309670376, -551.4217220584522, 10.160888673657826, -137.95264104624843, 154.86254221970637, 41.66511711648883, -49.65323231545937, 6.242471615096742, 20.000000000000014, -299.87050110489645, 107.44754555356643, -81.68046369763424, -72.56411437851382, -124.5413849941817, 157.56351959578384, -242.86885675766047, -167.50414741983198, 18.706958992550174, -17.231486831014568, -44.77441636579685, -305.77975931109825, -247.15551227352802, -170.88925196605106, -21.25309681108127, -56.84522163956676, -380.6357537557137, 3.487560768170056, -240.83240140054565, -301.27784508446456, 143.40318500155917, 196.03446463419917, 165.67085240284936, -48.96140664444816, 190.79271336972573, 97.30906287053821, 4.604845312756897, 76.69999999999996, -40.50503052804813, -42.120523435676176, -945.9969496802463, -18.771741427218757, 5.765750160426206, -574.250704734499, -438.09681168694124, -25.950240282550848, 20.000000000000014, -199.74441273624615, 109.9938988947514, -306.53998566074705, 67.84402580609735, -81.52172073718316, 57.96205930717469, -524.6551488206156, 171.79084787451177, -180.0074162790843, 98.14364583448913, 49.02270265793005, -245.356563993905, 177.12490042833258, -46.23631617184324, -368.2722304621207, 40.334396146947256, 75.58713479026765, 177.25497161741077, -504.90011999091564, 40.57656271318319, -347.42035683026495, -435.7480383661033, -444.68063573283195, 97.04629137804928, -336.3151022735656, 121.2789486381695, -185.36490118778985, -224.86421452215401, -205.41161862410146, -199.9557881659612, -435.71720090343615, -219.35955059155464, 169.96700057016395, 101.57650647318606, -185.4272366726772, 129.2025276460433, -58.74487770470703, -446.67080294557024, 173.8633561771697, -287.1514323262658, -228.2708996094993, -74.01531660412888, 16.242106218021178, -7.989166090653219, -110.02103767835764, 56.853458224525156, 106.83283768403903, -165.48701280769242, -180.0611841785376, -347.5489885170969, -446.277251852491, -442.7324403894132, -181.72665885654365, -409.67534245452566, -94.12056534797786, 17.597682095294388, 81.33792554603421, -31.691783165702653, 81.66631738775853, -365.24226434469404, -206.0074305210693, -133.52652660319953, -4.729757734059376, -541.0883360102266, 154.36415807744942, -22.736771100297474, -89.99414561679818, 119.10802491409514, 113.29611769031433, -25.272208285262387, -149.74453353804748, -664.2866047430982, -76.95579484284285, 113.55318699835045, -30.847692167814152, -531.3567585048143, -698.7829874838843, 4.21745995697551, -93.64362301960229, -502.1081728945087, 11.006890945623978, 105.36233079755007, 35.26943112845419, 51.589412648537404, -678.7317146148125, -219.01999004687323, -14.630095142625528, 9.947354062227589, 96.60228763875102, -97.38450180035204, -367.19257045982727, -250.12321449583365, -73.4269205597678, -124.29291154808195, -83.67536619092796, 8.56347875396554, -203.81715346366875, -236.23124635607365, -234.85648692301868, 19.1479617490585, -16.722096339070752, -180.45492044394007, 13.606641587402919, -487.8528583081754, -39.58575137105591, -277.26612952021566, -14.733183531486823], "policy_predator_policy_reward": [103.5719555964894, 17.35960343386087, 102.18946320364331, 203.78851378528284, 2.8835173699728323, 646.5199259193236, 9.448251036679272, 103.73873273100016, 84.83641429985556, 118.5141988001318, 21.869194744405604, 92.59399525678633, 522.8688830702895, 0.0, 190.27391646356725, 33.56089688095317, 291.9728796168004, 424.683602162685, 0.0, 31.057059853092476, 60.65024974328322, 92.72829750812213, 219.63777234017945, 267.2217835697825, 224.65349361087783, 215.45833669216876, 288.3480875007925, 430.73597319321607, 31.170205937325317, 107.44640182040494, 8.547916558952613, 167.47781834230238, 233.0214968764729, 63.99886284010208, 3.7086874234585094, 248.44114893161594, 357.4507108210067, 53.29307182388572, 6.1048783370923925, 4.338218993813619, 550.7767963033469, 90.48196248751717, 50.78198386089515, 63.78733267730572, 510.4702488762546, 466.33794846111164, 34.37905088036683, 344.769979618398, 550.6822198528107, 70.84040118611577, 211.9526410462483, 25.53745778029362, 179.6994122698754, 1.47859430736008, 12.457528384903226, 0.0, 313.1705011048995, 29.852454446433633, 42.94970286639098, 188.77267796723052, 139.1413849941809, 8.236480404216142, 253.5688567576599, 201.50414741983198, 115.89360256040843, 12.530925278055916, 277.197147822777, 186.13555542255958, 6.420311148697454, 361.7962400621432, 129.6530968110813, 72.94522163956692, 57.391767253054816, 372.3009214639537, 235.92319181192912, 361.56596709662983, 10.266290956787968, 19.296059407453704, 15.57128593904896, 137.96140664444823, 5.207286630274262, 1.6909371294617686, 14.29515468724307, 0.0, 158.2779442785317, 49.44760968519293, 946.2969496802464, 156.4900164099674, 100.6477463315014, 560.3597276708437, 457.58707218868636, 211.97637702760352, 108.10396595930999, 233.74289936947568, 150.76189354715308, 286.0069464462581, 71.75925221587916, 177.97211042697316, 347.425098606306, 424.09524071120126, 224.5009641589057, 123.73017621738408, 47.41830105313442, 64.65043616072941, 283.35656399390456, 7.675099571667399, 294.75792464811707, 325.5233356006539, 38.9401476047576, 95.29180216941694, 173.20622912939527, 455.77717702331324, 96.16063418370057, 342.19158360762333, 537.0792174134493, 394.9562582343334, 36.19319688571545, 342.3151022735657, 247.3560320453513, 21.70755291005583, 336.1918888664478, 4.759139041617155, 351.2769005640409, 385.65339642323386, 258.1527477526422, 11.267013624398745, 76.42349352681394, 194.82723667267666, 26.89747235395669, 75.24487770470647, 447.6708029455703, 10.53664382283032, 501.9977151942436, 18.14952181383621, 72.772841034635, 97.45491877149479, 223.0720660516629, 13.73813771734779, 17.14654177547482, 50.16716231596099, 94.72031639261034, 303.17007044551787, 598.7980944943697, 137.22184092141296, 145.44239395799823, 562.3903151818246, 84.12254000062771, 418.74212619183356, 61.23081313031866, 46.71475888088452, 33.010302257615436, 64.45802773948655, 181.72812421961248, 338.27846078943804, 97.62541855833366, 185.26910562614592, 544.0883360102266, 0.0, 39.93677110029772, 101.69414561679751, 48.91949727422542, 0.0, 41.17220828526261, 209.74453353804762, 645.168928198798, 260.1357814570733, 0.8468130016495287, 47.847692167814394, 339.1434151633229, 700.8463514663507, 292.13224229144447, 3.114329812916784, 416.9771812165941, 151.81466412579826, 23.037669202450004, 4.1305688715457896, 105.4105873514626, 679.1317146148126, 49.84161568072159, 326.32276959042906, 117.9862200163847, 18.622546404967885, 373.7845527179803, 175.36871023668837, 261.0344198272787, 117.82601158420385, 163.41529674526006, 51.26101967555111, 245.90094873528136, 17.85272597442175, 212.30298129493067, 293.4065999950133, 0.752038250941506, 33.922096339071, 188.25492044393962, 101.99335841259715, 324.2179903071025, 425.6191009400729, 29.667634598313846, 328.2738029877194]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.186621819697599, "mean_inference_ms": 3.628723773575333, "mean_action_processing_ms": 1.773779976149002, "mean_env_wait_ms": 0.7080181480864995, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007074117660522461, "StateBufferConnector_ms": 0.011927008628845215, "ViewRequirementAgentConnector_ms": 0.11610281467437744}, "num_episodes": 18, "episode_return_max": 389.13497475397503, "episode_return_min": -190.14997935902528, "episode_return_mean": 143.51689035472785, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1232000, "num_agent_steps_trained": 1232000, "num_env_steps_sampled": 308000, "num_env_steps_trained": 308000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 84.2239545003527, "num_env_steps_trained_throughput_per_sec": 84.2239545003527, "timesteps_total": 308000, "num_env_steps_sampled_lifetime": 308000, "num_agent_steps_sampled_lifetime": 1232000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1232000, "timers": {"training_iteration_time_ms": 47419.677, "restore_workers_time_ms": 0.013, "training_step_time_ms": 47419.631, "sample_time_ms": 1250.782, "learn_time_ms": 46149.429, "learn_throughput": 86.675, "synch_weights_time_ms": 15.469}, "counters": {"num_env_steps_sampled": 308000, "num_env_steps_trained": 308000, "num_agent_steps_sampled": 1232000, "num_agent_steps_trained": 1232000}, "done": false, "training_iteration": 77, "trial_id": "cf3bb_00000", "date": "2024-08-20_09-47-42", "timestamp": 1724127462, "time_this_iter_s": 47.51551818847656, "time_total_s": 11725.012944459915, "pid": 25777, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3aaaccaf0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 11725.012944459915, "iterations_since_restore": 77, "perf": {"cpu_util_percent": 35.48208955223881, "ram_util_percent": 82.35223880597016}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0568483864267668, "cur_kl_coeff": 0.01126270294189453, "cur_lr": 0.00010000000000000003, "total_loss": 6.22169196138937, "policy_loss": -0.00348697579096234, "vf_loss": 6.225127720454383, "vf_explained_var": 0.01031658312000295, "kl": 0.004548430267584943, "entropy": 0.9647627302263149, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 146475.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 19.667244384339245, "cur_kl_coeff": 0.02109375, "cur_lr": 0.00010000000000000003, "total_loss": 6.547211110654962, "policy_loss": -0.0027324783748814037, "vf_loss": 6.549708321737865, "vf_explained_var": -0.10437150269589096, "kl": 0.011152983830044705, "entropy": 0.8462663536033933, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 146475.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_agent_steps_sampled": 1248000, "num_agent_steps_trained": 1248000}, "env_runners": {"episode_reward_max": 369.0, "episode_reward_min": -190.14997935902528, "episode_reward_mean": 137.42246114404708, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -945.9969496802463, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 196.03446463419917, "predator_policy": 946.2969496802464}, "policy_reward_mean": {"prey_policy": -110.20252430336598, "predator_policy": 178.91375487538957}, "custom_metrics": {}, "hist_stats": {"episode_reward": [124.16502121680797, 80.26178765413198, 254.39999999999998, 173.18989137826512, 38.70000000000028, 150.59999999999962, 77.47780275747357, 180.39999999999944, 44.70000000000012, 129.89999999999932, 112.77852756844149, -49.82821302873859, 124.49999999999967, 52.5444957294649, 55.37891242354879, 369.0, 270.24213834189834, 294.9999999999998, 95.6, 125.09999999999945, 138.01827498274866, 92.52251942827223, 205.51639724679794, 162.10245259253904, 240.22275322741604, 236.05366771176648, 304.82724980406545, 340.0145719717176, 259.23508570628286, 222.79999999999995, 205.77271361480726, 250.1534807113894, 301.3382577792036, 131.50842367424207, 51.60680154884834, 139.23948826376466, 204.9776324057868, -89.32480523819076, 101.25730791787703, 220.02721135565017, 187.39999999999947, 172.59999999999948, 185.39999999999995, 4.724905072313266, 112.45454942002193, 118.79999999999933, 230.99999999999983, 52.34218985189816, -57.806304953807576, 83.37360989386572, -0.9312416100419982, 206.88117965253124, 147.4428642191571, -51.2431098567128, 144.63823984722026, 157.36415807744936, 28.90000000000014, 281.3236398786349, 75.89999999999975, 164.06231006992934, 131.39999999999966, -190.14997935902528, 205.82040904173385, 77.6905633935074, 167.79999999999973, 157.4, 142.51430008165116, 243.15840812233142, 84.57619069448918, 55.31029635588096, 6.708038681802445, 68.50000000000011, 34.621848010851984, 37.10000000000026, 123.39999999999995, 222.39848156794415, 65.9421245343312, 204.7523350275109, 38.07359880534451, 58.5000000000002, 160.0088072757577, 24.696235065073424, 134.9999999999997, 193.95248876986128, 255.89999999999992, 95.47566023991969, 254.22857995235384, 254.54833748825288, 64.45505757115438, 33.42822215245294, 16.750655199943857, 68.83510220084172, 229.2575213655624, 211.49999999999926, 118.99999999999933, 308.71697596176756, 201.51241658049864, 273.1, 258.6105456943266, -18.853944380144704], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-349.25137237866045, 94.26736309670376, -551.4217220584522, 10.160888673657826, -137.95264104624843, 154.86254221970637, 41.66511711648883, -49.65323231545937, 6.242471615096742, 20.000000000000014, -299.87050110489645, 107.44754555356643, -81.68046369763424, -72.56411437851382, -124.5413849941817, 157.56351959578384, -242.86885675766047, -167.50414741983198, 18.706958992550174, -17.231486831014568, -44.77441636579685, -305.77975931109825, -247.15551227352802, -170.88925196605106, -21.25309681108127, -56.84522163956676, -380.6357537557137, 3.487560768170056, -240.83240140054565, -301.27784508446456, 143.40318500155917, 196.03446463419917, 165.67085240284936, -48.96140664444816, 190.79271336972573, 97.30906287053821, 4.604845312756897, 76.69999999999996, -40.50503052804813, -42.120523435676176, -945.9969496802463, -18.771741427218757, 5.765750160426206, -574.250704734499, -438.09681168694124, -25.950240282550848, 20.000000000000014, -199.74441273624615, 109.9938988947514, -306.53998566074705, 67.84402580609735, -81.52172073718316, 57.96205930717469, -524.6551488206156, 171.79084787451177, -180.0074162790843, 98.14364583448913, 49.02270265793005, -245.356563993905, 177.12490042833258, -46.23631617184324, -368.2722304621207, 40.334396146947256, 75.58713479026765, 177.25497161741077, -504.90011999091564, 40.57656271318319, -347.42035683026495, -435.7480383661033, -444.68063573283195, 97.04629137804928, -336.3151022735656, 121.2789486381695, -185.36490118778985, -224.86421452215401, -205.41161862410146, -199.9557881659612, -435.71720090343615, -219.35955059155464, 169.96700057016395, 101.57650647318606, -185.4272366726772, 129.2025276460433, -58.74487770470703, -446.67080294557024, 173.8633561771697, -287.1514323262658, -228.2708996094993, -74.01531660412888, 16.242106218021178, -7.989166090653219, -110.02103767835764, 56.853458224525156, 106.83283768403903, -165.48701280769242, -180.0611841785376, -347.5489885170969, -446.277251852491, -442.7324403894132, -181.72665885654365, -409.67534245452566, -94.12056534797786, 17.597682095294388, 81.33792554603421, -31.691783165702653, 81.66631738775853, -365.24226434469404, -206.0074305210693, -133.52652660319953, -4.729757734059376, -541.0883360102266, 154.36415807744942, -22.736771100297474, -89.99414561679818, 119.10802491409514, 113.29611769031433, -25.272208285262387, -149.74453353804748, -664.2866047430982, -76.95579484284285, 113.55318699835045, -30.847692167814152, -531.3567585048143, -698.7829874838843, 4.21745995697551, -93.64362301960229, -502.1081728945087, 11.006890945623978, 105.36233079755007, 35.26943112845419, 51.589412648537404, -678.7317146148125, -219.01999004687323, -14.630095142625528, 9.947354062227589, 96.60228763875102, -97.38450180035204, -367.19257045982727, -250.12321449583365, -73.4269205597678, -124.29291154808195, -83.67536619092796, 8.56347875396554, -203.81715346366875, -236.23124635607365, -234.85648692301868, 19.1479617490585, -16.722096339070752, -180.45492044394007, 13.606641587402919, -487.8528583081754, -39.58575137105591, -277.26612952021566, -14.733183531486823, -7.252975982013908, -527.106621502367, 8.700437028074559, 18.77359880534424, -288.2124687142863, -1.8376156477206271, -3.4124886692551186, 26.07387736645051, -111.58131833441325, -302.05906232218354, 11.599979242636053, -15.38994427168999, -269.50135935090884, 4.139911611774721, -142.16005824561847, 115.73287494889928, -244.82605498091297, -144.29527883733243, 159.80184538737484, -387.64078797655964, -334.07037991414876, 20.000000000000014, -19.597760711724646, -282.66092070328034, -220.59029135380004, -76.17014691944462, -308.2705555324923, 6.064490867422988, -188.00571685934477, -84.78523262101797, -171.28688163372723, 183.2575213655624, -52.891485469684255, 194.62325868075493, 20.000000000000014, -64.99219948846608, 70.7591882895036, 103.95888574645774, -59.59295785195337, 14.354760056376831, 23.938849926347235, 13.71457827687152, 49.61193401354575, -283.5293941424403, -103.43555137308687, -55.234397530484316], "policy_predator_policy_reward": [34.37905088036683, 344.769979618398, 550.6822198528107, 70.84040118611577, 211.9526410462483, 25.53745778029362, 179.6994122698754, 1.47859430736008, 12.457528384903226, 0.0, 313.1705011048995, 29.852454446433633, 42.94970286639098, 188.77267796723052, 139.1413849941809, 8.236480404216142, 253.5688567576599, 201.50414741983198, 115.89360256040843, 12.530925278055916, 277.197147822777, 186.13555542255958, 6.420311148697454, 361.7962400621432, 129.6530968110813, 72.94522163956692, 57.391767253054816, 372.3009214639537, 235.92319181192912, 361.56596709662983, 10.266290956787968, 19.296059407453704, 15.57128593904896, 137.96140664444823, 5.207286630274262, 1.6909371294617686, 14.29515468724307, 0.0, 158.2779442785317, 49.44760968519293, 946.2969496802464, 156.4900164099674, 100.6477463315014, 560.3597276708437, 457.58707218868636, 211.97637702760352, 108.10396595930999, 233.74289936947568, 150.76189354715308, 286.0069464462581, 71.75925221587916, 177.97211042697316, 347.425098606306, 424.09524071120126, 224.5009641589057, 123.73017621738408, 47.41830105313442, 64.65043616072941, 283.35656399390456, 7.675099571667399, 294.75792464811707, 325.5233356006539, 38.9401476047576, 95.29180216941694, 173.20622912939527, 455.77717702331324, 96.16063418370057, 342.19158360762333, 537.0792174134493, 394.9562582343334, 36.19319688571545, 342.3151022735657, 247.3560320453513, 21.70755291005583, 336.1918888664478, 4.759139041617155, 351.2769005640409, 385.65339642323386, 258.1527477526422, 11.267013624398745, 76.42349352681394, 194.82723667267666, 26.89747235395669, 75.24487770470647, 447.6708029455703, 10.53664382283032, 501.9977151942436, 18.14952181383621, 72.772841034635, 97.45491877149479, 223.0720660516629, 13.73813771734779, 17.14654177547482, 50.16716231596099, 94.72031639261034, 303.17007044551787, 598.7980944943697, 137.22184092141296, 145.44239395799823, 562.3903151818246, 84.12254000062771, 418.74212619183356, 61.23081313031866, 46.71475888088452, 33.010302257615436, 64.45802773948655, 181.72812421961248, 338.27846078943804, 97.62541855833366, 185.26910562614592, 544.0883360102266, 0.0, 39.93677110029772, 101.69414561679751, 48.91949727422542, 0.0, 41.17220828526261, 209.74453353804762, 645.168928198798, 260.1357814570733, 0.8468130016495287, 47.847692167814394, 339.1434151633229, 700.8463514663507, 292.13224229144447, 3.114329812916784, 416.9771812165941, 151.81466412579826, 23.037669202450004, 4.1305688715457896, 105.4105873514626, 679.1317146148126, 49.84161568072159, 326.32276959042906, 117.9862200163847, 18.622546404967885, 373.7845527179803, 175.36871023668837, 261.0344198272787, 117.82601158420385, 163.41529674526006, 51.26101967555111, 245.90094873528136, 17.85272597442175, 212.30298129493067, 293.4065999950133, 0.752038250941506, 33.922096339071, 188.25492044393962, 101.99335841259715, 324.2179903071025, 425.6191009400729, 29.667634598313846, 328.2738029877194, 553.8367858768412, 185.27514663505028, 0.0, 10.599562971925407, 328.2124687142867, 20.33761564772062, 49.42027367014458, 87.92714490841803, 64.46708896745197, 373.8695267542184, 105.40002075736395, 33.38994427169023, 207.63524497054686, 251.678691538449, 230.86005824561838, 51.46712505110072, 299.29397037933956, 185.30302367882572, 95.63389805999365, 386.4336244815449, 354.1912400234804, 214.42747737892165, 81.2528182828792, 285.46092070328035, 51.526366499368216, 278.66229392632937, 318.95671986501554, 0.0, 277.7905844851585, 63.835467196046274, 217.2868816337272, 0.0, 67.39148546968423, 2.376741319245073, 149.1640766089962, 14.828122879470012, 64.92437450156102, 69.07452742424525, 128.67857638425954, 118.07203799181632, 114.48341963045048, 120.96315216633074, 238.59394412899735, 253.93406169422357, 132.94684488089968, 6.869159642525409]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1780154296968082, "mean_inference_ms": 3.6014687094744393, "mean_action_processing_ms": 1.749787740234816, "mean_env_wait_ms": 0.6991564480577728, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006749272346496582, "StateBufferConnector_ms": 0.01216113567352295, "ViewRequirementAgentConnector_ms": 0.11769449710845947}, "num_episodes": 23, "episode_return_max": 369.0, "episode_return_min": -190.14997935902528, "episode_return_mean": 137.42246114404708, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1248000, "num_agent_steps_trained": 1248000, "num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 82.9556740465956, "num_env_steps_trained_throughput_per_sec": 82.9556740465956, "timesteps_total": 312000, "num_env_steps_sampled_lifetime": 312000, "num_agent_steps_sampled_lifetime": 1248000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1248000, "timers": {"training_iteration_time_ms": 47486.071, "restore_workers_time_ms": 0.014, "training_step_time_ms": 47485.997, "sample_time_ms": 1253.121, "learn_time_ms": 46213.626, "learn_throughput": 86.555, "synch_weights_time_ms": 14.877}, "counters": {"num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_agent_steps_sampled": 1248000, "num_agent_steps_trained": 1248000}, "done": false, "training_iteration": 78, "trial_id": "cf3bb_00000", "date": "2024-08-20_09-48-31", "timestamp": 1724127511, "time_this_iter_s": 48.25915718078613, "time_total_s": 11773.272101640701, "pid": 25777, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39fe35430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 11773.272101640701, "iterations_since_restore": 78, "perf": {"cpu_util_percent": 38.0927536231884, "ram_util_percent": 82.54637681159421}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8610592213966859, "cur_kl_coeff": 0.005631351470947265, "cur_lr": 0.00010000000000000003, "total_loss": 6.871484553877008, "policy_loss": -0.0029062213350294365, "vf_loss": 6.874348875076052, "vf_explained_var": 0.0014404205733506137, "kl": 0.007440031413449402, "entropy": 0.9740190321490878, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 148365.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.491244101902796, "cur_kl_coeff": 0.02109375, "cur_lr": 0.00010000000000000003, "total_loss": 7.641440244957253, "policy_loss": -0.002606667179328503, "vf_loss": 7.643882157310607, "vf_explained_var": 0.13248018007429818, "kl": 0.007809612646636366, "entropy": 0.9024063791547503, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 148365.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 316000, "num_env_steps_trained": 316000, "num_agent_steps_sampled": 1264000, "num_agent_steps_trained": 1264000}, "env_runners": {"episode_reward_max": 340.0145719717176, "episode_reward_min": -191.26158557174634, "episode_reward_mean": 135.23132368170226, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -945.9969496802463, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 194.62325868075493, "predator_policy": 946.2969496802464}, "policy_reward_mean": {"prey_policy": -131.86159754086802, "predator_policy": 199.47725938171922}, "custom_metrics": {}, "hist_stats": {"episode_reward": [95.6, 125.09999999999945, 138.01827498274866, 92.52251942827223, 205.51639724679794, 162.10245259253904, 240.22275322741604, 236.05366771176648, 304.82724980406545, 340.0145719717176, 259.23508570628286, 222.79999999999995, 205.77271361480726, 250.1534807113894, 301.3382577792036, 131.50842367424207, 51.60680154884834, 139.23948826376466, 204.9776324057868, -89.32480523819076, 101.25730791787703, 220.02721135565017, 187.39999999999947, 172.59999999999948, 185.39999999999995, 4.724905072313266, 112.45454942002193, 118.79999999999933, 230.99999999999983, 52.34218985189816, -57.806304953807576, 83.37360989386572, -0.9312416100419982, 206.88117965253124, 147.4428642191571, -51.2431098567128, 144.63823984722026, 157.36415807744936, 28.90000000000014, 281.3236398786349, 75.89999999999975, 164.06231006992934, 131.39999999999966, -190.14997935902528, 205.82040904173385, 77.6905633935074, 167.79999999999973, 157.4, 142.51430008165116, 243.15840812233142, 84.57619069448918, 55.31029635588096, 6.708038681802445, 68.50000000000011, 34.621848010851984, 37.10000000000026, 123.39999999999995, 222.39848156794415, 65.9421245343312, 204.7523350275109, 38.07359880534451, 58.5000000000002, 160.0088072757577, 24.696235065073424, 134.9999999999997, 193.95248876986128, 255.89999999999992, 95.47566023991969, 254.22857995235384, 254.54833748825288, 64.45505757115438, 33.42822215245294, 16.750655199943857, 68.83510220084172, 229.2575213655624, 211.49999999999926, 118.99999999999933, 308.71697596176756, 201.51241658049864, 273.1, 258.6105456943266, -18.853944380144704, 69.87274914836891, -191.26158557174634, 115.99999999999977, 139.7999999999997, 222.82962826000244, 146.84457733992804, 202.2049026871024, 216.39232881297707, 84.42094860430414, -7.035189133730251, 164.99999999999997, 259.8999999999999, 196.0, 55.000000000000185, 94.2, 200.34372706817885, 107.5362388527436, 186.24829173868446], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [4.604845312756897, 76.69999999999996, -40.50503052804813, -42.120523435676176, -945.9969496802463, -18.771741427218757, 5.765750160426206, -574.250704734499, -438.09681168694124, -25.950240282550848, 20.000000000000014, -199.74441273624615, 109.9938988947514, -306.53998566074705, 67.84402580609735, -81.52172073718316, 57.96205930717469, -524.6551488206156, 171.79084787451177, -180.0074162790843, 98.14364583448913, 49.02270265793005, -245.356563993905, 177.12490042833258, -46.23631617184324, -368.2722304621207, 40.334396146947256, 75.58713479026765, 177.25497161741077, -504.90011999091564, 40.57656271318319, -347.42035683026495, -435.7480383661033, -444.68063573283195, 97.04629137804928, -336.3151022735656, 121.2789486381695, -185.36490118778985, -224.86421452215401, -205.41161862410146, -199.9557881659612, -435.71720090343615, -219.35955059155464, 169.96700057016395, 101.57650647318606, -185.4272366726772, 129.2025276460433, -58.74487770470703, -446.67080294557024, 173.8633561771697, -287.1514323262658, -228.2708996094993, -74.01531660412888, 16.242106218021178, -7.989166090653219, -110.02103767835764, 56.853458224525156, 106.83283768403903, -165.48701280769242, -180.0611841785376, -347.5489885170969, -446.277251852491, -442.7324403894132, -181.72665885654365, -409.67534245452566, -94.12056534797786, 17.597682095294388, 81.33792554603421, -31.691783165702653, 81.66631738775853, -365.24226434469404, -206.0074305210693, -133.52652660319953, -4.729757734059376, -541.0883360102266, 154.36415807744942, -22.736771100297474, -89.99414561679818, 119.10802491409514, 113.29611769031433, -25.272208285262387, -149.74453353804748, -664.2866047430982, -76.95579484284285, 113.55318699835045, -30.847692167814152, -531.3567585048143, -698.7829874838843, 4.21745995697551, -93.64362301960229, -502.1081728945087, 11.006890945623978, 105.36233079755007, 35.26943112845419, 51.589412648537404, -678.7317146148125, -219.01999004687323, -14.630095142625528, 9.947354062227589, 96.60228763875102, -97.38450180035204, -367.19257045982727, -250.12321449583365, -73.4269205597678, -124.29291154808195, -83.67536619092796, 8.56347875396554, -203.81715346366875, -236.23124635607365, -234.85648692301868, 19.1479617490585, -16.722096339070752, -180.45492044394007, 13.606641587402919, -487.8528583081754, -39.58575137105591, -277.26612952021566, -14.733183531486823, -7.252975982013908, -527.106621502367, 8.700437028074559, 18.77359880534424, -288.2124687142863, -1.8376156477206271, -3.4124886692551186, 26.07387736645051, -111.58131833441325, -302.05906232218354, 11.599979242636053, -15.38994427168999, -269.50135935090884, 4.139911611774721, -142.16005824561847, 115.73287494889928, -244.82605498091297, -144.29527883733243, 159.80184538737484, -387.64078797655964, -334.07037991414876, 20.000000000000014, -19.597760711724646, -282.66092070328034, -220.59029135380004, -76.17014691944462, -308.2705555324923, 6.064490867422988, -188.00571685934477, -84.78523262101797, -171.28688163372723, 183.2575213655624, -52.891485469684255, 194.62325868075493, 20.000000000000014, -64.99219948846608, 70.7591882895036, 103.95888574645774, -59.59295785195337, 14.354760056376831, 23.938849926347235, 13.71457827687152, 49.61193401354575, -283.5293941424403, -103.43555137308687, -55.234397530484316, -159.44393793947836, -106.43106451888633, -665.9891812810034, -251.63900740833503, -31.91892681561876, -46.54508676472466, 41.432134082923106, -7.029078494036888, -64.45619969252198, -618.0914396197084, -202.92372011419567, -294.9042497292256, -350.7001724450351, -16.653398502512694, -84.21858574482796, -747.7738571625827, -9.717860373266014, -233.03408622057816, -228.76617140018803, -394.3522311194581, -145.44354618655476, 37.78849811124641, 46.36783483400138, 85.36888357921394, -756.1030535863173, 191.82699065553308, -147.70637723342801, -156.5341223919255, -298.8907791065365, -128.96572080168627, -173.66804676972072, -463.2769378590111, -2.223888154574122, -348.725291849807, -193.1660814975032, 89.36276969567112], "policy_predator_policy_reward": [14.29515468724307, 0.0, 158.2779442785317, 49.44760968519293, 946.2969496802464, 156.4900164099674, 100.6477463315014, 560.3597276708437, 457.58707218868636, 211.97637702760352, 108.10396595930999, 233.74289936947568, 150.76189354715308, 286.0069464462581, 71.75925221587916, 177.97211042697316, 347.425098606306, 424.09524071120126, 224.5009641589057, 123.73017621738408, 47.41830105313442, 64.65043616072941, 283.35656399390456, 7.675099571667399, 294.75792464811707, 325.5233356006539, 38.9401476047576, 95.29180216941694, 173.20622912939527, 455.77717702331324, 96.16063418370057, 342.19158360762333, 537.0792174134493, 394.9562582343334, 36.19319688571545, 342.3151022735657, 247.3560320453513, 21.70755291005583, 336.1918888664478, 4.759139041617155, 351.2769005640409, 385.65339642323386, 258.1527477526422, 11.267013624398745, 76.42349352681394, 194.82723667267666, 26.89747235395669, 75.24487770470647, 447.6708029455703, 10.53664382283032, 501.9977151942436, 18.14952181383621, 72.772841034635, 97.45491877149479, 223.0720660516629, 13.73813771734779, 17.14654177547482, 50.16716231596099, 94.72031639261034, 303.17007044551787, 598.7980944943697, 137.22184092141296, 145.44239395799823, 562.3903151818246, 84.12254000062771, 418.74212619183356, 61.23081313031866, 46.71475888088452, 33.010302257615436, 64.45802773948655, 181.72812421961248, 338.27846078943804, 97.62541855833366, 185.26910562614592, 544.0883360102266, 0.0, 39.93677110029772, 101.69414561679751, 48.91949727422542, 0.0, 41.17220828526261, 209.74453353804762, 645.168928198798, 260.1357814570733, 0.8468130016495287, 47.847692167814394, 339.1434151633229, 700.8463514663507, 292.13224229144447, 3.114329812916784, 416.9771812165941, 151.81466412579826, 23.037669202450004, 4.1305688715457896, 105.4105873514626, 679.1317146148126, 49.84161568072159, 326.32276959042906, 117.9862200163847, 18.622546404967885, 373.7845527179803, 175.36871023668837, 261.0344198272787, 117.82601158420385, 163.41529674526006, 51.26101967555111, 245.90094873528136, 17.85272597442175, 212.30298129493067, 293.4065999950133, 0.752038250941506, 33.922096339071, 188.25492044393962, 101.99335841259715, 324.2179903071025, 425.6191009400729, 29.667634598313846, 328.2738029877194, 553.8367858768412, 185.27514663505028, 0.0, 10.599562971925407, 328.2124687142867, 20.33761564772062, 49.42027367014458, 87.92714490841803, 64.46708896745197, 373.8695267542184, 105.40002075736395, 33.38994427169023, 207.63524497054686, 251.678691538449, 230.86005824561838, 51.46712505110072, 299.29397037933956, 185.30302367882572, 95.63389805999365, 386.4336244815449, 354.1912400234804, 214.42747737892165, 81.2528182828792, 285.46092070328035, 51.526366499368216, 278.66229392632937, 318.95671986501554, 0.0, 277.7905844851585, 63.835467196046274, 217.2868816337272, 0.0, 67.39148546968423, 2.376741319245073, 149.1640766089962, 14.828122879470012, 64.92437450156102, 69.07452742424525, 128.67857638425954, 118.07203799181632, 114.48341963045048, 120.96315216633074, 238.59394412899735, 253.93406169422357, 132.94684488089968, 6.869159642525409, 263.4338521951637, 72.31389941156974, 719.5492315310705, 6.81737158652151, 49.91892681561902, 144.54508676472466, 80.66786591707684, 24.729078494036965, 422.27594480790736, 483.10132276432523, 280.0923743532649, 364.5801728300848, 284.4430780331975, 285.11539560145394, 717.8963992212855, 330.48837249910366, 270.034086220578, 57.13880897757018, 262.6062723164664, 353.47694106944874, 189.44354618655476, 83.21150188875359, 55.15885742420929, 73.00442416257546, 756.1030535863173, 4.173009344466927, 189.70637723342824, 169.53412239192477, 306.990779106536, 215.0657208016863, 556.7654905205532, 280.52322117635714, 247.93887993033826, 210.5465389267862, 287.43122055388534, 2.6203829866314163]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1720848494446612, "mean_inference_ms": 3.5770009512565673, "mean_action_processing_ms": 1.732209272769104, "mean_env_wait_ms": 0.6933299313065474, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0067975521087646484, "StateBufferConnector_ms": 0.012187838554382324, "ViewRequirementAgentConnector_ms": 0.11979031562805176}, "num_episodes": 18, "episode_return_max": 340.0145719717176, "episode_return_min": -191.26158557174634, "episode_return_mean": 135.23132368170226, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1264000, "num_agent_steps_trained": 1264000, "num_env_steps_sampled": 316000, "num_env_steps_trained": 316000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 84.4403209345179, "num_env_steps_trained_throughput_per_sec": 84.4403209345179, "timesteps_total": 316000, "num_env_steps_sampled_lifetime": 316000, "num_agent_steps_sampled_lifetime": 1264000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1264000, "timers": {"training_iteration_time_ms": 47515.489, "restore_workers_time_ms": 0.014, "training_step_time_ms": 47515.408, "sample_time_ms": 1252.759, "learn_time_ms": 46243.418, "learn_throughput": 86.499, "synch_weights_time_ms": 14.813}, "counters": {"num_env_steps_sampled": 316000, "num_env_steps_trained": 316000, "num_agent_steps_sampled": 1264000, "num_agent_steps_trained": 1264000}, "done": false, "training_iteration": 79, "trial_id": "cf3bb_00000", "date": "2024-08-20_09-49-18", "timestamp": 1724127558, "time_this_iter_s": 47.41779375076294, "time_total_s": 11820.689895391464, "pid": 25777, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39fe383a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 11820.689895391464, "iterations_since_restore": 79, "perf": {"cpu_util_percent": 35.09552238805971, "ram_util_percent": 81.9044776119403}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9813213955315333, "cur_kl_coeff": 0.005631351470947265, "cur_lr": 0.00010000000000000003, "total_loss": 6.333799883928249, "policy_loss": -0.0029688912785055224, "vf_loss": 6.336709051283579, "vf_explained_var": 0.0001928305499768131, "kl": 0.010605114457054577, "entropy": 1.015393425831719, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 150255.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.938567079059661, "cur_kl_coeff": 0.02109375, "cur_lr": 0.00010000000000000003, "total_loss": 6.778184016041024, "policy_loss": -0.0022993801393245577, "vf_loss": 6.7802916885053035, "vf_explained_var": 0.11797518376950865, "kl": 0.009088029461577395, "entropy": 0.956992861833522, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 150255.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 320000, "num_env_steps_trained": 320000, "num_agent_steps_sampled": 1280000, "num_agent_steps_trained": 1280000}, "env_runners": {"episode_reward_max": 486.16337042258334, "episode_reward_min": -191.26158557174634, "episode_reward_mean": 125.64520708369233, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1339.80760127957, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 197.98411363008717, "predator_policy": 1342.50760127957}, "policy_reward_mean": {"prey_policy": -148.85594635757042, "predator_policy": 211.67854989941668}, "custom_metrics": {}, "hist_stats": {"episode_reward": [187.39999999999947, 172.59999999999948, 185.39999999999995, 4.724905072313266, 112.45454942002193, 118.79999999999933, 230.99999999999983, 52.34218985189816, -57.806304953807576, 83.37360989386572, -0.9312416100419982, 206.88117965253124, 147.4428642191571, -51.2431098567128, 144.63823984722026, 157.36415807744936, 28.90000000000014, 281.3236398786349, 75.89999999999975, 164.06231006992934, 131.39999999999966, -190.14997935902528, 205.82040904173385, 77.6905633935074, 167.79999999999973, 157.4, 142.51430008165116, 243.15840812233142, 84.57619069448918, 55.31029635588096, 6.708038681802445, 68.50000000000011, 34.621848010851984, 37.10000000000026, 123.39999999999995, 222.39848156794415, 65.9421245343312, 204.7523350275109, 38.07359880534451, 58.5000000000002, 160.0088072757577, 24.696235065073424, 134.9999999999997, 193.95248876986128, 255.89999999999992, 95.47566023991969, 254.22857995235384, 254.54833748825288, 64.45505757115438, 33.42822215245294, 16.750655199943857, 68.83510220084172, 229.2575213655624, 211.49999999999926, 118.99999999999933, 308.71697596176756, 201.51241658049864, 273.1, 258.6105456943266, -18.853944380144704, 69.87274914836891, -191.26158557174634, 115.99999999999977, 139.7999999999997, 222.82962826000244, 146.84457733992804, 202.2049026871024, 216.39232881297707, 84.42094860430414, -7.035189133730251, 164.99999999999997, 259.8999999999999, 196.0, 55.000000000000185, 94.2, 200.34372706817885, 107.5362388527436, 186.24829173868446, 186.99999999999943, 215.88874003250953, 163.136212406626, 254.02221199186022, 196.9999999999993, 19.099999999999994, 25.700000000000088, 139.09999999999968, 247.68990484369746, 24.700000000000045, 199.8, 35.13619607179967, 178.70000000000002, 134.86847914751786, 153.9895757621708, 52.100000000000165, 33.400000000000205, 185.90964469174287, 486.16337042258334, 39.99999999999999, -131.73554181047547, 138.28903134395637], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [101.57650647318606, -185.4272366726772, 129.2025276460433, -58.74487770470703, -446.67080294557024, 173.8633561771697, -287.1514323262658, -228.2708996094993, -74.01531660412888, 16.242106218021178, -7.989166090653219, -110.02103767835764, 56.853458224525156, 106.83283768403903, -165.48701280769242, -180.0611841785376, -347.5489885170969, -446.277251852491, -442.7324403894132, -181.72665885654365, -409.67534245452566, -94.12056534797786, 17.597682095294388, 81.33792554603421, -31.691783165702653, 81.66631738775853, -365.24226434469404, -206.0074305210693, -133.52652660319953, -4.729757734059376, -541.0883360102266, 154.36415807744942, -22.736771100297474, -89.99414561679818, 119.10802491409514, 113.29611769031433, -25.272208285262387, -149.74453353804748, -664.2866047430982, -76.95579484284285, 113.55318699835045, -30.847692167814152, -531.3567585048143, -698.7829874838843, 4.21745995697551, -93.64362301960229, -502.1081728945087, 11.006890945623978, 105.36233079755007, 35.26943112845419, 51.589412648537404, -678.7317146148125, -219.01999004687323, -14.630095142625528, 9.947354062227589, 96.60228763875102, -97.38450180035204, -367.19257045982727, -250.12321449583365, -73.4269205597678, -124.29291154808195, -83.67536619092796, 8.56347875396554, -203.81715346366875, -236.23124635607365, -234.85648692301868, 19.1479617490585, -16.722096339070752, -180.45492044394007, 13.606641587402919, -487.8528583081754, -39.58575137105591, -277.26612952021566, -14.733183531486823, -7.252975982013908, -527.106621502367, 8.700437028074559, 18.77359880534424, -288.2124687142863, -1.8376156477206271, -3.4124886692551186, 26.07387736645051, -111.58131833441325, -302.05906232218354, 11.599979242636053, -15.38994427168999, -269.50135935090884, 4.139911611774721, -142.16005824561847, 115.73287494889928, -244.82605498091297, -144.29527883733243, 159.80184538737484, -387.64078797655964, -334.07037991414876, 20.000000000000014, -19.597760711724646, -282.66092070328034, -220.59029135380004, -76.17014691944462, -308.2705555324923, 6.064490867422988, -188.00571685934477, -84.78523262101797, -171.28688163372723, 183.2575213655624, -52.891485469684255, 194.62325868075493, 20.000000000000014, -64.99219948846608, 70.7591882895036, 103.95888574645774, -59.59295785195337, 14.354760056376831, 23.938849926347235, 13.71457827687152, 49.61193401354575, -283.5293941424403, -103.43555137308687, -55.234397530484316, -159.44393793947836, -106.43106451888633, -665.9891812810034, -251.63900740833503, -31.91892681561876, -46.54508676472466, 41.432134082923106, -7.029078494036888, -64.45619969252198, -618.0914396197084, -202.92372011419567, -294.9042497292256, -350.7001724450351, -16.653398502512694, -84.21858574482796, -747.7738571625827, -9.717860373266014, -233.03408622057816, -228.76617140018803, -394.3522311194581, -145.44354618655476, 37.78849811124641, 46.36783483400138, 85.36888357921394, -756.1030535863173, 191.82699065553308, -147.70637723342801, -156.5341223919255, -298.8907791065365, -128.96572080168627, -173.66804676972072, -463.2769378590111, -2.223888154574122, -348.725291849807, -193.1660814975032, 89.36276969567112, -60.99166658333423, 120.07837602188461, 147.38425314356218, -57.353016969497695, -438.3533404905865, -52.76489584226654, 121.41380859710071, -5.781034426728269, 18.316335621528093, 151.63665228867836, 7.635139707679471, -343.718172743954, -327.4863232143863, 16.182725723989044, -71.91353946209009, 20.000000000000014, 18.184285094572, -680.5249428811427, -303.0337567962025, 16.892656233803464, 197.7657500991529, -1234.1520420560005, -192.86141245142528, -110.75685087083869, -1339.80760127957, 155.73691722138793, 104.52645240811225, -310.5823910811702, -561.5401032235502, -1019.9972575019949, -330.96901037343946, -58.0887562900907, -59.514542095786105, -84.14111081826246, -94.46686292020537, 73.7659249748516, -419.8745813085567, 197.98411363008717, -806.1293607841798, -266.0871579983017, -370.3487889496869, -362.7879547588353, -423.67371020293353, -395.4383114268033], "policy_predator_policy_reward": [76.42349352681394, 194.82723667267666, 26.89747235395669, 75.24487770470647, 447.6708029455703, 10.53664382283032, 501.9977151942436, 18.14952181383621, 72.772841034635, 97.45491877149479, 223.0720660516629, 13.73813771734779, 17.14654177547482, 50.16716231596099, 94.72031639261034, 303.17007044551787, 598.7980944943697, 137.22184092141296, 145.44239395799823, 562.3903151818246, 84.12254000062771, 418.74212619183356, 61.23081313031866, 46.71475888088452, 33.010302257615436, 64.45802773948655, 181.72812421961248, 338.27846078943804, 97.62541855833366, 185.26910562614592, 544.0883360102266, 0.0, 39.93677110029772, 101.69414561679751, 48.91949727422542, 0.0, 41.17220828526261, 209.74453353804762, 645.168928198798, 260.1357814570733, 0.8468130016495287, 47.847692167814394, 339.1434151633229, 700.8463514663507, 292.13224229144447, 3.114329812916784, 416.9771812165941, 151.81466412579826, 23.037669202450004, 4.1305688715457896, 105.4105873514626, 679.1317146148126, 49.84161568072159, 326.32276959042906, 117.9862200163847, 18.622546404967885, 373.7845527179803, 175.36871023668837, 261.0344198272787, 117.82601158420385, 163.41529674526006, 51.26101967555111, 245.90094873528136, 17.85272597442175, 212.30298129493067, 293.4065999950133, 0.752038250941506, 33.922096339071, 188.25492044393962, 101.99335841259715, 324.2179903071025, 425.6191009400729, 29.667634598313846, 328.2738029877194, 553.8367858768412, 185.27514663505028, 0.0, 10.599562971925407, 328.2124687142867, 20.33761564772062, 49.42027367014458, 87.92714490841803, 64.46708896745197, 373.8695267542184, 105.40002075736395, 33.38994427169023, 207.63524497054686, 251.678691538449, 230.86005824561838, 51.46712505110072, 299.29397037933956, 185.30302367882572, 95.63389805999365, 386.4336244815449, 354.1912400234804, 214.42747737892165, 81.2528182828792, 285.46092070328035, 51.526366499368216, 278.66229392632937, 318.95671986501554, 0.0, 277.7905844851585, 63.835467196046274, 217.2868816337272, 0.0, 67.39148546968423, 2.376741319245073, 149.1640766089962, 14.828122879470012, 64.92437450156102, 69.07452742424525, 128.67857638425954, 118.07203799181632, 114.48341963045048, 120.96315216633074, 238.59394412899735, 253.93406169422357, 132.94684488089968, 6.869159642525409, 263.4338521951637, 72.31389941156974, 719.5492315310705, 6.81737158652151, 49.91892681561902, 144.54508676472466, 80.66786591707684, 24.729078494036965, 422.27594480790736, 483.10132276432523, 280.0923743532649, 364.5801728300848, 284.4430780331975, 285.11539560145394, 717.8963992212855, 330.48837249910366, 270.034086220578, 57.13880897757018, 262.6062723164664, 353.47694106944874, 189.44354618655476, 83.21150188875359, 55.15885742420929, 73.00442416257546, 756.1030535863173, 4.173009344466927, 189.70637723342824, 169.53412239192477, 306.990779106536, 215.0657208016863, 556.7654905205532, 280.52322117635714, 247.93887993033826, 210.5465389267862, 287.43122055388534, 2.6203829866314163, 78.99166658333344, 48.921623978115406, 71.75120721257254, 54.10629664587294, 420.9519288112161, 233.30251992826243, 138.38943782148777, 0.0, 21.30694754780131, 5.740064541992254, 11.464860292320495, 343.718172743954, 333.48632321438623, 3.5172742760109204, 191.01353946209014, 0.0, 415.5980018772302, 494.43256075303873, 308.0337567962025, 2.8073437661965093, 1146.1399370586714, 90.04635489817623, 270.6388796070027, 68.11557978706091, 1342.50760127957, 20.263082778612052, 5.189064325084425, 335.73535349549155, 989.8157045520959, 745.7112319356195, 365.96901037343946, 75.18875629009015, 75.71454209578562, 101.34111081826148, 166.88397408542147, 39.72660855167521, 402.46296753210487, 305.5908705689469, 806.1293607841798, 306.0871579983017, 577.161869197851, 24.23933270019649, 413.853676257451, 543.5473767162416]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1643085466722274, "mean_inference_ms": 3.4971358228269986, "mean_action_processing_ms": 1.75698092863672, "mean_env_wait_ms": 0.6870439497361227, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036553144454956055, "StateBufferConnector_ms": 0.0034285783767700195, "ViewRequirementAgentConnector_ms": 0.09619700908660889}, "num_episodes": 22, "episode_return_max": 486.16337042258334, "episode_return_min": -191.26158557174634, "episode_return_mean": 125.64520708369233, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1280000, "num_agent_steps_trained": 1280000, "num_env_steps_sampled": 320000, "num_env_steps_trained": 320000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 85.40808626039474, "num_env_steps_trained_throughput_per_sec": 85.40808626039474, "timesteps_total": 320000, "num_env_steps_sampled_lifetime": 320000, "num_agent_steps_sampled_lifetime": 1280000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1280000, "timers": {"training_iteration_time_ms": 47439.546, "restore_workers_time_ms": 0.014, "training_step_time_ms": 47439.465, "sample_time_ms": 1247.739, "learn_time_ms": 46172.808, "learn_throughput": 86.631, "synch_weights_time_ms": 14.531}, "counters": {"num_env_steps_sampled": 320000, "num_env_steps_trained": 320000, "num_agent_steps_sampled": 1280000, "num_agent_steps_trained": 1280000}, "done": false, "training_iteration": 80, "trial_id": "cf3bb_00000", "date": "2024-08-20_09-50-05", "timestamp": 1724127605, "time_this_iter_s": 46.90797281265259, "time_total_s": 11867.597868204117, "pid": 25777, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39ffcc9d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 11867.597868204117, "iterations_since_restore": 80, "perf": {"cpu_util_percent": 33.028787878787874, "ram_util_percent": 81.91666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8543608871874986, "cur_kl_coeff": 0.005631351470947265, "cur_lr": 0.00010000000000000003, "total_loss": 6.6981960241126, "policy_loss": -0.002900426931526492, "vf_loss": 6.701076067061651, "vf_explained_var": 0.0005251425283926504, "kl": 0.0036183432008690068, "entropy": 1.0607459159755201, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 152145.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 17.10652936529861, "cur_kl_coeff": 0.02109375, "cur_lr": 0.00010000000000000003, "total_loss": 8.221551781608945, "policy_loss": -0.005842569742287711, "vf_loss": 8.22710849418842, "vf_explained_var": 0.22890265700678347, "kl": 0.013551475604547735, "entropy": 0.8850683704885857, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 152145.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_agent_steps_sampled": 1296000, "num_agent_steps_trained": 1296000}, "env_runners": {"episode_reward_max": 486.16337042258334, "episode_reward_min": -320.5997169503991, "episode_reward_mean": 123.55696479118565, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1339.80760127957, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 197.98411363008717, "predator_policy": 1342.50760127957}, "policy_reward_mean": {"prey_policy": -165.3056986446046, "predator_policy": 227.08418104019745}, "custom_metrics": {}, "hist_stats": {"episode_reward": [75.89999999999975, 164.06231006992934, 131.39999999999966, -190.14997935902528, 205.82040904173385, 77.6905633935074, 167.79999999999973, 157.4, 142.51430008165116, 243.15840812233142, 84.57619069448918, 55.31029635588096, 6.708038681802445, 68.50000000000011, 34.621848010851984, 37.10000000000026, 123.39999999999995, 222.39848156794415, 65.9421245343312, 204.7523350275109, 38.07359880534451, 58.5000000000002, 160.0088072757577, 24.696235065073424, 134.9999999999997, 193.95248876986128, 255.89999999999992, 95.47566023991969, 254.22857995235384, 254.54833748825288, 64.45505757115438, 33.42822215245294, 16.750655199943857, 68.83510220084172, 229.2575213655624, 211.49999999999926, 118.99999999999933, 308.71697596176756, 201.51241658049864, 273.1, 258.6105456943266, -18.853944380144704, 69.87274914836891, -191.26158557174634, 115.99999999999977, 139.7999999999997, 222.82962826000244, 146.84457733992804, 202.2049026871024, 216.39232881297707, 84.42094860430414, -7.035189133730251, 164.99999999999997, 259.8999999999999, 196.0, 55.000000000000185, 94.2, 200.34372706817885, 107.5362388527436, 186.24829173868446, 186.99999999999943, 215.88874003250953, 163.136212406626, 254.02221199186022, 196.9999999999993, 19.099999999999994, 25.700000000000088, 139.09999999999968, 247.68990484369746, 24.700000000000045, 199.8, 35.13619607179967, 178.70000000000002, 134.86847914751786, 153.9895757621708, 52.100000000000165, 33.400000000000205, 185.90964469174287, 486.16337042258334, 39.99999999999999, -131.73554181047547, 138.28903134395637, 132.1110671373662, 87.7999999999999, 122.75088621671826, 10.899999999999984, 294.9975740104046, 455.36659891156825, -181.7264115838643, 86.4999999999998, 166.49999999999952, 298.6, 34.99999999999997, -91.04009409148061, 200.49999999999935, 137.98054659154926, 49.30000000000019, 127.8999999999995, 183.0, -320.5997169503991], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-25.272208285262387, -149.74453353804748, -664.2866047430982, -76.95579484284285, 113.55318699835045, -30.847692167814152, -531.3567585048143, -698.7829874838843, 4.21745995697551, -93.64362301960229, -502.1081728945087, 11.006890945623978, 105.36233079755007, 35.26943112845419, 51.589412648537404, -678.7317146148125, -219.01999004687323, -14.630095142625528, 9.947354062227589, 96.60228763875102, -97.38450180035204, -367.19257045982727, -250.12321449583365, -73.4269205597678, -124.29291154808195, -83.67536619092796, 8.56347875396554, -203.81715346366875, -236.23124635607365, -234.85648692301868, 19.1479617490585, -16.722096339070752, -180.45492044394007, 13.606641587402919, -487.8528583081754, -39.58575137105591, -277.26612952021566, -14.733183531486823, -7.252975982013908, -527.106621502367, 8.700437028074559, 18.77359880534424, -288.2124687142863, -1.8376156477206271, -3.4124886692551186, 26.07387736645051, -111.58131833441325, -302.05906232218354, 11.599979242636053, -15.38994427168999, -269.50135935090884, 4.139911611774721, -142.16005824561847, 115.73287494889928, -244.82605498091297, -144.29527883733243, 159.80184538737484, -387.64078797655964, -334.07037991414876, 20.000000000000014, -19.597760711724646, -282.66092070328034, -220.59029135380004, -76.17014691944462, -308.2705555324923, 6.064490867422988, -188.00571685934477, -84.78523262101797, -171.28688163372723, 183.2575213655624, -52.891485469684255, 194.62325868075493, 20.000000000000014, -64.99219948846608, 70.7591882895036, 103.95888574645774, -59.59295785195337, 14.354760056376831, 23.938849926347235, 13.71457827687152, 49.61193401354575, -283.5293941424403, -103.43555137308687, -55.234397530484316, -159.44393793947836, -106.43106451888633, -665.9891812810034, -251.63900740833503, -31.91892681561876, -46.54508676472466, 41.432134082923106, -7.029078494036888, -64.45619969252198, -618.0914396197084, -202.92372011419567, -294.9042497292256, -350.7001724450351, -16.653398502512694, -84.21858574482796, -747.7738571625827, -9.717860373266014, -233.03408622057816, -228.76617140018803, -394.3522311194581, -145.44354618655476, 37.78849811124641, 46.36783483400138, 85.36888357921394, -756.1030535863173, 191.82699065553308, -147.70637723342801, -156.5341223919255, -298.8907791065365, -128.96572080168627, -173.66804676972072, -463.2769378590111, -2.223888154574122, -348.725291849807, -193.1660814975032, 89.36276969567112, -60.99166658333423, 120.07837602188461, 147.38425314356218, -57.353016969497695, -438.3533404905865, -52.76489584226654, 121.41380859710071, -5.781034426728269, 18.316335621528093, 151.63665228867836, 7.635139707679471, -343.718172743954, -327.4863232143863, 16.182725723989044, -71.91353946209009, 20.000000000000014, 18.184285094572, -680.5249428811427, -303.0337567962025, 16.892656233803464, 197.7657500991529, -1234.1520420560005, -192.86141245142528, -110.75685087083869, -1339.80760127957, 155.73691722138793, 104.52645240811225, -310.5823910811702, -561.5401032235502, -1019.9972575019949, -330.96901037343946, -58.0887562900907, -59.514542095786105, -84.14111081826246, -94.46686292020537, 73.7659249748516, -419.8745813085567, 197.98411363008717, -806.1293607841798, -266.0871579983017, -370.3487889496869, -362.7879547588353, -423.67371020293353, -395.4383114268033, -17.74853789030313, -94.08252763001119, -74.95806856961272, 3.696604811246262, -404.4948564972504, 88.34993565643073, -333.6853351082348, -768.8401712382131, -16.822972372605253, 183.9983107891082, -569.6464770621734, 176.50303051947898, -206.68879447709082, -535.7272015122394, -307.69107516005386, -100.17598840150684, -65.28729700897242, 96.9974908032428, 154.55140683819275, 106.21462369176044, -394.0593149281053, -279.61298924588874, -208.21121363584723, -332.62248121613226, -50.95562566097153, 170.49060461876644, -20.520663478159186, -479.1936530835357, -10.243888463777715, -360.82479726600275, 5.237675707781529, -16.120404274020927, -887.4202009007482, 160.76571982679155, -648.0297062029812, -1162.087830383448], "policy_predator_policy_reward": [41.17220828526261, 209.74453353804762, 645.168928198798, 260.1357814570733, 0.8468130016495287, 47.847692167814394, 339.1434151633229, 700.8463514663507, 292.13224229144447, 3.114329812916784, 416.9771812165941, 151.81466412579826, 23.037669202450004, 4.1305688715457896, 105.4105873514626, 679.1317146148126, 49.84161568072159, 326.32276959042906, 117.9862200163847, 18.622546404967885, 373.7845527179803, 175.36871023668837, 261.0344198272787, 117.82601158420385, 163.41529674526006, 51.26101967555111, 245.90094873528136, 17.85272597442175, 212.30298129493067, 293.4065999950133, 0.752038250941506, 33.922096339071, 188.25492044393962, 101.99335841259715, 324.2179903071025, 425.6191009400729, 29.667634598313846, 328.2738029877194, 553.8367858768412, 185.27514663505028, 0.0, 10.599562971925407, 328.2124687142867, 20.33761564772062, 49.42027367014458, 87.92714490841803, 64.46708896745197, 373.8695267542184, 105.40002075736395, 33.38994427169023, 207.63524497054686, 251.678691538449, 230.86005824561838, 51.46712505110072, 299.29397037933956, 185.30302367882572, 95.63389805999365, 386.4336244815449, 354.1912400234804, 214.42747737892165, 81.2528182828792, 285.46092070328035, 51.526366499368216, 278.66229392632937, 318.95671986501554, 0.0, 277.7905844851585, 63.835467196046274, 217.2868816337272, 0.0, 67.39148546968423, 2.376741319245073, 149.1640766089962, 14.828122879470012, 64.92437450156102, 69.07452742424525, 128.67857638425954, 118.07203799181632, 114.48341963045048, 120.96315216633074, 238.59394412899735, 253.93406169422357, 132.94684488089968, 6.869159642525409, 263.4338521951637, 72.31389941156974, 719.5492315310705, 6.81737158652151, 49.91892681561902, 144.54508676472466, 80.66786591707684, 24.729078494036965, 422.27594480790736, 483.10132276432523, 280.0923743532649, 364.5801728300848, 284.4430780331975, 285.11539560145394, 717.8963992212855, 330.48837249910366, 270.034086220578, 57.13880897757018, 262.6062723164664, 353.47694106944874, 189.44354618655476, 83.21150188875359, 55.15885742420929, 73.00442416257546, 756.1030535863173, 4.173009344466927, 189.70637723342824, 169.53412239192477, 306.990779106536, 215.0657208016863, 556.7654905205532, 280.52322117635714, 247.93887993033826, 210.5465389267862, 287.43122055388534, 2.6203829866314163, 78.99166658333344, 48.921623978115406, 71.75120721257254, 54.10629664587294, 420.9519288112161, 233.30251992826243, 138.38943782148777, 0.0, 21.30694754780131, 5.740064541992254, 11.464860292320495, 343.718172743954, 333.48632321438623, 3.5172742760109204, 191.01353946209014, 0.0, 415.5980018772302, 494.43256075303873, 308.0337567962025, 2.8073437661965093, 1146.1399370586714, 90.04635489817623, 270.6388796070027, 68.11557978706091, 1342.50760127957, 20.263082778612052, 5.189064325084425, 335.73535349549155, 989.8157045520959, 745.7112319356195, 365.96901037343946, 75.18875629009015, 75.71454209578562, 101.34111081826148, 166.88397408542147, 39.72660855167521, 402.46296753210487, 305.5908705689469, 806.1293607841798, 306.0871579983017, 577.161869197851, 24.23933270019649, 413.853676257451, 543.5473767162416, 199.98255756328476, 43.959575094396065, 143.95806856961278, 15.103395188753703, 25.625925958029367, 413.26988109950844, 336.6853351082348, 776.7401712382126, 125.82297237260528, 1.999263221296522, 533.4782172641762, 315.0318281900863, 0.0, 560.6895844054659, 377.691075160054, 116.6759884015059, 78.78729700897165, 56.0025091967572, 22.448593161807235, 15.385376308239545, 395.0593149281053, 313.6129892458886, 449.79360076049954, 0.0, 68.15562566097155, 12.809395381233552, 513.4078506126455, 124.28701254059871, 28.543888463777872, 391.8247972660027, 105.3623242922184, 33.42040427402117, 887.4202009007482, 22.234280173208443, 1291.5795291492693, 197.9382904867597]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.158497287609172, "mean_inference_ms": 3.5185560750719262, "mean_action_processing_ms": 1.6954460328752747, "mean_env_wait_ms": 0.681443259992199, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035982131958007812, "StateBufferConnector_ms": 0.0033416748046875, "ViewRequirementAgentConnector_ms": 0.09366512298583984}, "num_episodes": 18, "episode_return_max": 486.16337042258334, "episode_return_min": -320.5997169503991, "episode_return_mean": 123.55696479118565, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1296000, "num_agent_steps_trained": 1296000, "num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 83.87494560097147, "num_env_steps_trained_throughput_per_sec": 83.87494560097147, "timesteps_total": 324000, "num_env_steps_sampled_lifetime": 324000, "num_agent_steps_sampled_lifetime": 1296000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1296000, "timers": {"training_iteration_time_ms": 47445.216, "restore_workers_time_ms": 0.013, "training_step_time_ms": 47445.135, "sample_time_ms": 1241.827, "learn_time_ms": 46183.874, "learn_throughput": 86.61, "synch_weights_time_ms": 14.665}, "counters": {"num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_agent_steps_sampled": 1296000, "num_agent_steps_trained": 1296000}, "done": false, "training_iteration": 81, "trial_id": "cf3bb_00000", "date": "2024-08-20_09-50-53", "timestamp": 1724127653, "time_this_iter_s": 47.728946924209595, "time_total_s": 11915.326815128326, "pid": 25777, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39fcc8c10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 11915.326815128326, "iterations_since_restore": 81, "perf": {"cpu_util_percent": 34.19705882352941, "ram_util_percent": 81.63529411764705}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.800069294546647, "cur_kl_coeff": 0.0028156757354736326, "cur_lr": 0.00010000000000000003, "total_loss": 7.487750898088728, "policy_loss": -0.005355232939735134, "vf_loss": 7.493054180548936, "vf_explained_var": -0.0028702434093233137, "kl": 0.01845022037154655, "entropy": 0.9747185342841678, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 154035.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 14.372032949281117, "cur_kl_coeff": 0.02109375, "cur_lr": 0.00010000000000000003, "total_loss": 7.817308471316383, "policy_loss": -0.003785388825569676, "vf_loss": 7.82094026747204, "vf_explained_var": 0.19457434869947887, "kl": 0.007281971747263199, "entropy": 0.8390906056083699, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 154035.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 328000, "num_env_steps_trained": 328000, "num_agent_steps_sampled": 1312000, "num_agent_steps_trained": 1312000}, "env_runners": {"episode_reward_max": 583.91234938604, "episode_reward_min": -947.624802673162, "episode_reward_mean": 122.64873363548557, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1586.9359985878968, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 197.98411363008717, "predator_policy": 1715.869331668619}, "policy_reward_mean": {"prey_policy": -202.7453590562479, "predator_policy": 264.0697258739907}, "custom_metrics": {}, "hist_stats": {"episode_reward": [24.696235065073424, 134.9999999999997, 193.95248876986128, 255.89999999999992, 95.47566023991969, 254.22857995235384, 254.54833748825288, 64.45505757115438, 33.42822215245294, 16.750655199943857, 68.83510220084172, 229.2575213655624, 211.49999999999926, 118.99999999999933, 308.71697596176756, 201.51241658049864, 273.1, 258.6105456943266, -18.853944380144704, 69.87274914836891, -191.26158557174634, 115.99999999999977, 139.7999999999997, 222.82962826000244, 146.84457733992804, 202.2049026871024, 216.39232881297707, 84.42094860430414, -7.035189133730251, 164.99999999999997, 259.8999999999999, 196.0, 55.000000000000185, 94.2, 200.34372706817885, 107.5362388527436, 186.24829173868446, 186.99999999999943, 215.88874003250953, 163.136212406626, 254.02221199186022, 196.9999999999993, 19.099999999999994, 25.700000000000088, 139.09999999999968, 247.68990484369746, 24.700000000000045, 199.8, 35.13619607179967, 178.70000000000002, 134.86847914751786, 153.9895757621708, 52.100000000000165, 33.400000000000205, 185.90964469174287, 486.16337042258334, 39.99999999999999, -131.73554181047547, 138.28903134395637, 132.1110671373662, 87.7999999999999, 122.75088621671826, 10.899999999999984, 294.9975740104046, 455.36659891156825, -181.7264115838643, 86.4999999999998, 166.49999999999952, 298.6, 34.99999999999997, -91.04009409148061, 200.49999999999935, 137.98054659154926, 49.30000000000019, 127.8999999999995, 183.0, -320.5997169503991, 66.48158857821204, 267.48835633707426, 236.96219666347957, 155.1572423834244, 197.1999999999998, 256.9860043128038, 76.39438155917438, 320.5368076120752, 67.77981799312234, -947.624802673162, 89.69496100012478, 152.30964186147523, -289.1826604335829, 303.84955440037896, 162.60000000000002, 25.299999999999983, 109.43617033608649, 135.63035261524902, 583.91234938604, 41.9000000000001, -20.647345197941206, 54.90000000000001, 197.60000000000002], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-111.58131833441325, -302.05906232218354, 11.599979242636053, -15.38994427168999, -269.50135935090884, 4.139911611774721, -142.16005824561847, 115.73287494889928, -244.82605498091297, -144.29527883733243, 159.80184538737484, -387.64078797655964, -334.07037991414876, 20.000000000000014, -19.597760711724646, -282.66092070328034, -220.59029135380004, -76.17014691944462, -308.2705555324923, 6.064490867422988, -188.00571685934477, -84.78523262101797, -171.28688163372723, 183.2575213655624, -52.891485469684255, 194.62325868075493, 20.000000000000014, -64.99219948846608, 70.7591882895036, 103.95888574645774, -59.59295785195337, 14.354760056376831, 23.938849926347235, 13.71457827687152, 49.61193401354575, -283.5293941424403, -103.43555137308687, -55.234397530484316, -159.44393793947836, -106.43106451888633, -665.9891812810034, -251.63900740833503, -31.91892681561876, -46.54508676472466, 41.432134082923106, -7.029078494036888, -64.45619969252198, -618.0914396197084, -202.92372011419567, -294.9042497292256, -350.7001724450351, -16.653398502512694, -84.21858574482796, -747.7738571625827, -9.717860373266014, -233.03408622057816, -228.76617140018803, -394.3522311194581, -145.44354618655476, 37.78849811124641, 46.36783483400138, 85.36888357921394, -756.1030535863173, 191.82699065553308, -147.70637723342801, -156.5341223919255, -298.8907791065365, -128.96572080168627, -173.66804676972072, -463.2769378590111, -2.223888154574122, -348.725291849807, -193.1660814975032, 89.36276969567112, -60.99166658333423, 120.07837602188461, 147.38425314356218, -57.353016969497695, -438.3533404905865, -52.76489584226654, 121.41380859710071, -5.781034426728269, 18.316335621528093, 151.63665228867836, 7.635139707679471, -343.718172743954, -327.4863232143863, 16.182725723989044, -71.91353946209009, 20.000000000000014, 18.184285094572, -680.5249428811427, -303.0337567962025, 16.892656233803464, 197.7657500991529, -1234.1520420560005, -192.86141245142528, -110.75685087083869, -1339.80760127957, 155.73691722138793, 104.52645240811225, -310.5823910811702, -561.5401032235502, -1019.9972575019949, -330.96901037343946, -58.0887562900907, -59.514542095786105, -84.14111081826246, -94.46686292020537, 73.7659249748516, -419.8745813085567, 197.98411363008717, -806.1293607841798, -266.0871579983017, -370.3487889496869, -362.7879547588353, -423.67371020293353, -395.4383114268033, -17.74853789030313, -94.08252763001119, -74.95806856961272, 3.696604811246262, -404.4948564972504, 88.34993565643073, -333.6853351082348, -768.8401712382131, -16.822972372605253, 183.9983107891082, -569.6464770621734, 176.50303051947898, -206.68879447709082, -535.7272015122394, -307.69107516005386, -100.17598840150684, -65.28729700897242, 96.9974908032428, 154.55140683819275, 106.21462369176044, -394.0593149281053, -279.61298924588874, -208.21121363584723, -332.62248121613226, -50.95562566097153, 170.49060461876644, -20.520663478159186, -479.1936530835357, -10.243888463777715, -360.82479726600275, 5.237675707781529, -16.120404274020927, -887.4202009007482, 160.76571982679155, -648.0297062029812, -1162.087830383448, 12.117373535074597, -310.2828109426463, 41.24891503988422, -502.62691710945745, -137.52969342998364, -209.73141654313525, 5.887356372051352, 34.14735884319951, -229.3708621478197, 169.68383538283, -198.28521504524502, 171.7929849968455, -169.34714505767982, -146.50370177141303, 172.02385504075434, -653.1483386852339, -349.89273984813656, -177.86243813922192, -1439.7781923106033, -1586.9359985878968, -16.472181378255943, -331.0254202762497, -408.70237966896195, -24.558440645140138, -1192.1620822788382, -324.4644740879229, -414.9688203485062, 123.6240677221073, 94.85647997656068, -900.4382097794462, -301.02503152189263, -915.5139945348249, -416.727995345355, 18.219077774413744, -231.74522365570158, -470.52577634498596, -943.265578521484, 197.3, -12.325231985785338, -283.7443607233531, -202.21162507149228, -261.08506250880794, -264.69770975783337, -20.254913635500365, 190.47971475422187, -1350.5064277223485], "policy_predator_policy_reward": [64.46708896745197, 373.8695267542184, 105.40002075736395, 33.38994427169023, 207.63524497054686, 251.678691538449, 230.86005824561838, 51.46712505110072, 299.29397037933956, 185.30302367882572, 95.63389805999365, 386.4336244815449, 354.1912400234804, 214.42747737892165, 81.2528182828792, 285.46092070328035, 51.526366499368216, 278.66229392632937, 318.95671986501554, 0.0, 277.7905844851585, 63.835467196046274, 217.2868816337272, 0.0, 67.39148546968423, 2.376741319245073, 149.1640766089962, 14.828122879470012, 64.92437450156102, 69.07452742424525, 128.67857638425954, 118.07203799181632, 114.48341963045048, 120.96315216633074, 238.59394412899735, 253.93406169422357, 132.94684488089968, 6.869159642525409, 263.4338521951637, 72.31389941156974, 719.5492315310705, 6.81737158652151, 49.91892681561902, 144.54508676472466, 80.66786591707684, 24.729078494036965, 422.27594480790736, 483.10132276432523, 280.0923743532649, 364.5801728300848, 284.4430780331975, 285.11539560145394, 717.8963992212855, 330.48837249910366, 270.034086220578, 57.13880897757018, 262.6062723164664, 353.47694106944874, 189.44354618655476, 83.21150188875359, 55.15885742420929, 73.00442416257546, 756.1030535863173, 4.173009344466927, 189.70637723342824, 169.53412239192477, 306.990779106536, 215.0657208016863, 556.7654905205532, 280.52322117635714, 247.93887993033826, 210.5465389267862, 287.43122055388534, 2.6203829866314163, 78.99166658333344, 48.921623978115406, 71.75120721257254, 54.10629664587294, 420.9519288112161, 233.30251992826243, 138.38943782148777, 0.0, 21.30694754780131, 5.740064541992254, 11.464860292320495, 343.718172743954, 333.48632321438623, 3.5172742760109204, 191.01353946209014, 0.0, 415.5980018772302, 494.43256075303873, 308.0337567962025, 2.8073437661965093, 1146.1399370586714, 90.04635489817623, 270.6388796070027, 68.11557978706091, 1342.50760127957, 20.263082778612052, 5.189064325084425, 335.73535349549155, 989.8157045520959, 745.7112319356195, 365.96901037343946, 75.18875629009015, 75.71454209578562, 101.34111081826148, 166.88397408542147, 39.72660855167521, 402.46296753210487, 305.5908705689469, 806.1293607841798, 306.0871579983017, 577.161869197851, 24.23933270019649, 413.853676257451, 543.5473767162416, 199.98255756328476, 43.959575094396065, 143.95806856961278, 15.103395188753703, 25.625925958029367, 413.26988109950844, 336.6853351082348, 776.7401712382126, 125.82297237260528, 1.999263221296522, 533.4782172641762, 315.0318281900863, 0.0, 560.6895844054659, 377.691075160054, 116.6759884015059, 78.78729700897165, 56.0025091967572, 22.448593161807235, 15.385376308239545, 395.0593149281053, 313.6129892458886, 449.79360076049954, 0.0, 68.15562566097155, 12.809395381233552, 513.4078506126455, 124.28701254059871, 28.543888463777872, 391.8247972660027, 105.3623242922184, 33.42040427402117, 887.4202009007482, 22.234280173208443, 1291.5795291492693, 197.9382904867597, 6.364215043137369, 358.2828109426463, 206.4667715882049, 522.3995868184423, 298.17085395683665, 286.0524526797616, 9.26988601137342, 105.85264115680049, 238.57086214781987, 18.31616461716998, 191.5772727041526, 91.90096165705098, 143.3676165081359, 248.87761188013062, 182.0123744089826, 619.6489168475733, 228.37904308608532, 367.1559528943955, 363.2200565567192, 1715.869331668619, 291.4170213283011, 145.77554132632966, 222.05198557902807, 363.5184765965495, 10.44805414271013, 1216.9958417904681, 372.4837462877949, 222.71056073898356, 65.14352002343931, 903.0382097794461, 326.0250315218927, 915.8139945348248, 136.1078326849322, 371.837255222095, 439.106146165135, 398.79520645080095, 398.11230250379697, 931.7656254037269, 32.493598601545706, 305.4759941075929, 415.1234007167185, 27.525941665640353, 302.6977097578334, 37.15491363550036, 1325.303234802324, 32.323478165802804]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1947750025738297, "mean_inference_ms": 3.407934660863313, "mean_action_processing_ms": 1.6753514192483383, "mean_env_wait_ms": 0.7173268072923975, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037119388580322266, "StateBufferConnector_ms": 0.003283977508544922, "ViewRequirementAgentConnector_ms": 0.09593486785888672}, "num_episodes": 23, "episode_return_max": 583.91234938604, "episode_return_min": -947.624802673162, "episode_return_mean": 122.64873363548557, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1312000, "num_agent_steps_trained": 1312000, "num_env_steps_sampled": 328000, "num_env_steps_trained": 328000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 85.30062365408057, "num_env_steps_trained_throughput_per_sec": 85.30062365408057, "timesteps_total": 328000, "num_env_steps_sampled_lifetime": 328000, "num_agent_steps_sampled_lifetime": 1312000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1312000, "timers": {"training_iteration_time_ms": 47392.264, "restore_workers_time_ms": 0.013, "training_step_time_ms": 47392.172, "sample_time_ms": 1239.308, "learn_time_ms": 46133.345, "learn_throughput": 86.705, "synch_weights_time_ms": 14.728}, "counters": {"num_env_steps_sampled": 328000, "num_env_steps_trained": 328000, "num_agent_steps_sampled": 1312000, "num_agent_steps_trained": 1312000}, "done": false, "training_iteration": 82, "trial_id": "cf3bb_00000", "date": "2024-08-20_09-51-40", "timestamp": 1724127700, "time_this_iter_s": 46.93209981918335, "time_total_s": 11962.25891494751, "pid": 25777, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39ffb8d30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 11962.25891494751, "iterations_since_restore": 82, "perf": {"cpu_util_percent": 32.27424242424242, "ram_util_percent": 81.84242424242423}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9201200425151794, "cur_kl_coeff": 0.0028156757354736326, "cur_lr": 0.00010000000000000003, "total_loss": 6.751022047718997, "policy_loss": -0.0034381122031451137, "vf_loss": 6.75443938547972, "vf_explained_var": 0.002079745827528535, "kl": 0.007370193843319612, "entropy": 0.951482478462199, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 155925.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 18.006078986011484, "cur_kl_coeff": 0.02109375, "cur_lr": 0.00010000000000000003, "total_loss": 7.42595239114509, "policy_loss": -0.0015186864737342432, "vf_loss": 7.427403683132596, "vf_explained_var": 0.0035502255593658125, "kl": 0.0031952976888341574, "entropy": 0.7984167448427312, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 155925.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 332000, "num_env_steps_trained": 332000, "num_agent_steps_sampled": 1328000, "num_agent_steps_trained": 1328000}, "env_runners": {"episode_reward_max": 583.91234938604, "episode_reward_min": -947.624802673162, "episode_reward_mean": 110.28355480321916, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1586.9359985878968, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 197.98411363008717, "predator_policy": 1715.869331668619}, "policy_reward_mean": {"prey_policy": -219.2188582298676, "predator_policy": 274.3606356314772}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-18.853944380144704, 69.87274914836891, -191.26158557174634, 115.99999999999977, 139.7999999999997, 222.82962826000244, 146.84457733992804, 202.2049026871024, 216.39232881297707, 84.42094860430414, -7.035189133730251, 164.99999999999997, 259.8999999999999, 196.0, 55.000000000000185, 94.2, 200.34372706817885, 107.5362388527436, 186.24829173868446, 186.99999999999943, 215.88874003250953, 163.136212406626, 254.02221199186022, 196.9999999999993, 19.099999999999994, 25.700000000000088, 139.09999999999968, 247.68990484369746, 24.700000000000045, 199.8, 35.13619607179967, 178.70000000000002, 134.86847914751786, 153.9895757621708, 52.100000000000165, 33.400000000000205, 185.90964469174287, 486.16337042258334, 39.99999999999999, -131.73554181047547, 138.28903134395637, 132.1110671373662, 87.7999999999999, 122.75088621671826, 10.899999999999984, 294.9975740104046, 455.36659891156825, -181.7264115838643, 86.4999999999998, 166.49999999999952, 298.6, 34.99999999999997, -91.04009409148061, 200.49999999999935, 137.98054659154926, 49.30000000000019, 127.8999999999995, 183.0, -320.5997169503991, 66.48158857821204, 267.48835633707426, 236.96219666347957, 155.1572423834244, 197.1999999999998, 256.9860043128038, 76.39438155917438, 320.5368076120752, 67.77981799312234, -947.624802673162, 89.69496100012478, 152.30964186147523, -289.1826604335829, 303.84955440037896, 162.60000000000002, 25.299999999999983, 109.43617033608649, 135.63035261524902, 583.91234938604, 41.9000000000001, -20.647345197941206, 54.90000000000001, 197.60000000000002, 41.700000000000074, 102.67746375790068, 213.7, 25.397256641021972, 108.75190417402413, 69.73354502186827, 6.9921721014580225, 37.30000000000026, 192.6, 156.39632543639217, 16.99999999999995, 101.73198062301144, 146.82893332581259, 121.0, 22.91140628632571, 176.2289276475496, 122.19999999999999, 99.29999999999964], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-103.43555137308687, -55.234397530484316, -159.44393793947836, -106.43106451888633, -665.9891812810034, -251.63900740833503, -31.91892681561876, -46.54508676472466, 41.432134082923106, -7.029078494036888, -64.45619969252198, -618.0914396197084, -202.92372011419567, -294.9042497292256, -350.7001724450351, -16.653398502512694, -84.21858574482796, -747.7738571625827, -9.717860373266014, -233.03408622057816, -228.76617140018803, -394.3522311194581, -145.44354618655476, 37.78849811124641, 46.36783483400138, 85.36888357921394, -756.1030535863173, 191.82699065553308, -147.70637723342801, -156.5341223919255, -298.8907791065365, -128.96572080168627, -173.66804676972072, -463.2769378590111, -2.223888154574122, -348.725291849807, -193.1660814975032, 89.36276969567112, -60.99166658333423, 120.07837602188461, 147.38425314356218, -57.353016969497695, -438.3533404905865, -52.76489584226654, 121.41380859710071, -5.781034426728269, 18.316335621528093, 151.63665228867836, 7.635139707679471, -343.718172743954, -327.4863232143863, 16.182725723989044, -71.91353946209009, 20.000000000000014, 18.184285094572, -680.5249428811427, -303.0337567962025, 16.892656233803464, 197.7657500991529, -1234.1520420560005, -192.86141245142528, -110.75685087083869, -1339.80760127957, 155.73691722138793, 104.52645240811225, -310.5823910811702, -561.5401032235502, -1019.9972575019949, -330.96901037343946, -58.0887562900907, -59.514542095786105, -84.14111081826246, -94.46686292020537, 73.7659249748516, -419.8745813085567, 197.98411363008717, -806.1293607841798, -266.0871579983017, -370.3487889496869, -362.7879547588353, -423.67371020293353, -395.4383114268033, -17.74853789030313, -94.08252763001119, -74.95806856961272, 3.696604811246262, -404.4948564972504, 88.34993565643073, -333.6853351082348, -768.8401712382131, -16.822972372605253, 183.9983107891082, -569.6464770621734, 176.50303051947898, -206.68879447709082, -535.7272015122394, -307.69107516005386, -100.17598840150684, -65.28729700897242, 96.9974908032428, 154.55140683819275, 106.21462369176044, -394.0593149281053, -279.61298924588874, -208.21121363584723, -332.62248121613226, -50.95562566097153, 170.49060461876644, -20.520663478159186, -479.1936530835357, -10.243888463777715, -360.82479726600275, 5.237675707781529, -16.120404274020927, -887.4202009007482, 160.76571982679155, -648.0297062029812, -1162.087830383448, 12.117373535074597, -310.2828109426463, 41.24891503988422, -502.62691710945745, -137.52969342998364, -209.73141654313525, 5.887356372051352, 34.14735884319951, -229.3708621478197, 169.68383538283, -198.28521504524502, 171.7929849968455, -169.34714505767982, -146.50370177141303, 172.02385504075434, -653.1483386852339, -349.89273984813656, -177.86243813922192, -1439.7781923106033, -1586.9359985878968, -16.472181378255943, -331.0254202762497, -408.70237966896195, -24.558440645140138, -1192.1620822788382, -324.4644740879229, -414.9688203485062, 123.6240677221073, 94.85647997656068, -900.4382097794462, -301.02503152189263, -915.5139945348249, -416.727995345355, 18.219077774413744, -231.74522365570158, -470.52577634498596, -943.265578521484, 197.3, -12.325231985785338, -283.7443607233531, -202.21162507149228, -261.08506250880794, -264.69770975783337, -20.254913635500365, 190.47971475422187, -1350.5064277223485, -415.08850111409214, -11.747076805785726, -172.29767336883972, -163.52499609252573, -12.54620264597574, 84.35712682233373, -304.549525200248, -261.3785801089869, -150.06014790439315, -27.613387115380746, -407.6836211053215, -198.36943292622684, -117.3354489439322, -356.5942925933556, 6.332611797640407, -24.248211957690224, 138.61746510063003, -247.84198176416143, -66.052512706211, -50.76012981654087, -102.30379426797496, -441.741507176618, -228.70113255292463, 51.736869062774055, -445.93191068284204, 20.000000000000014, 42.38338655882736, -1097.1161001407668, 21.796773138953984, -497.7721082966572, 16.992870943445233, -175.14984241700984, 34.51629860008627, -474.2573980778569, -52.043857825016055, 18.936427751081425], "policy_predator_policy_reward": [132.94684488089968, 6.869159642525409, 263.4338521951637, 72.31389941156974, 719.5492315310705, 6.81737158652151, 49.91892681561902, 144.54508676472466, 80.66786591707684, 24.729078494036965, 422.27594480790736, 483.10132276432523, 280.0923743532649, 364.5801728300848, 284.4430780331975, 285.11539560145394, 717.8963992212855, 330.48837249910366, 270.034086220578, 57.13880897757018, 262.6062723164664, 353.47694106944874, 189.44354618655476, 83.21150188875359, 55.15885742420929, 73.00442416257546, 756.1030535863173, 4.173009344466927, 189.70637723342824, 169.53412239192477, 306.990779106536, 215.0657208016863, 556.7654905205532, 280.52322117635714, 247.93887993033826, 210.5465389267862, 287.43122055388534, 2.6203829866314163, 78.99166658333344, 48.921623978115406, 71.75120721257254, 54.10629664587294, 420.9519288112161, 233.30251992826243, 138.38943782148777, 0.0, 21.30694754780131, 5.740064541992254, 11.464860292320495, 343.718172743954, 333.48632321438623, 3.5172742760109204, 191.01353946209014, 0.0, 415.5980018772302, 494.43256075303873, 308.0337567962025, 2.8073437661965093, 1146.1399370586714, 90.04635489817623, 270.6388796070027, 68.11557978706091, 1342.50760127957, 20.263082778612052, 5.189064325084425, 335.73535349549155, 989.8157045520959, 745.7112319356195, 365.96901037343946, 75.18875629009015, 75.71454209578562, 101.34111081826148, 166.88397408542147, 39.72660855167521, 402.46296753210487, 305.5908705689469, 806.1293607841798, 306.0871579983017, 577.161869197851, 24.23933270019649, 413.853676257451, 543.5473767162416, 199.98255756328476, 43.959575094396065, 143.95806856961278, 15.103395188753703, 25.625925958029367, 413.26988109950844, 336.6853351082348, 776.7401712382126, 125.82297237260528, 1.999263221296522, 533.4782172641762, 315.0318281900863, 0.0, 560.6895844054659, 377.691075160054, 116.6759884015059, 78.78729700897165, 56.0025091967572, 22.448593161807235, 15.385376308239545, 395.0593149281053, 313.6129892458886, 449.79360076049954, 0.0, 68.15562566097155, 12.809395381233552, 513.4078506126455, 124.28701254059871, 28.543888463777872, 391.8247972660027, 105.3623242922184, 33.42040427402117, 887.4202009007482, 22.234280173208443, 1291.5795291492693, 197.9382904867597, 6.364215043137369, 358.2828109426463, 206.4667715882049, 522.3995868184423, 298.17085395683665, 286.0524526797616, 9.26988601137342, 105.85264115680049, 238.57086214781987, 18.31616461716998, 191.5772727041526, 91.90096165705098, 143.3676165081359, 248.87761188013062, 182.0123744089826, 619.6489168475733, 228.37904308608532, 367.1559528943955, 363.2200565567192, 1715.869331668619, 291.4170213283011, 145.77554132632966, 222.05198557902807, 363.5184765965495, 10.44805414271013, 1216.9958417904681, 372.4837462877949, 222.71056073898356, 65.14352002343931, 903.0382097794461, 326.0250315218927, 915.8139945348248, 136.1078326849322, 371.837255222095, 439.106146165135, 398.79520645080095, 398.11230250379697, 931.7656254037269, 32.493598601545706, 305.4759941075929, 415.1234007167185, 27.525941665640353, 302.6977097578334, 37.15491363550036, 1325.303234802324, 32.323478165802804, 438.08850111409214, 30.447076805785915, 306.0179329290743, 132.4822002901917, 132.54620264597594, 9.34287317766625, 246.55919746801342, 344.7661644822454, 88.3307809066356, 198.09465828716299, 460.0604204396996, 215.72617861371685, 478.897840636914, 2.0240730018320647, 12.66738820235956, 42.54821195769049, 0.9825348993699701, 300.84198176416135, 134.7602687436091, 138.4486992155344, 116.30379426797417, 444.74150717661803, 258.9793171753027, 19.716926937859448, 472.56786253937184, 100.19298146928274, 78.61661344117257, 1097.1161001407668, 0.997546295943164, 497.88919514808583, 101.29977243141872, 233.0861266896962, 86.48370139991377, 475.45739807785685, 6.859695815243727, 125.54773425869107]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1432093770048828, "mean_inference_ms": 3.466117530391827, "mean_action_processing_ms": 1.6582425290289484, "mean_env_wait_ms": 0.6678726529876244, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00369870662689209, "StateBufferConnector_ms": 0.0030733346939086914, "ViewRequirementAgentConnector_ms": 0.10252702236175537}, "num_episodes": 18, "episode_return_max": 583.91234938604, "episode_return_min": -947.624802673162, "episode_return_mean": 110.28355480321916, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1328000, "num_agent_steps_trained": 1328000, "num_env_steps_sampled": 332000, "num_env_steps_trained": 332000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 83.92738696167787, "num_env_steps_trained_throughput_per_sec": 83.92738696167787, "timesteps_total": 332000, "num_env_steps_sampled_lifetime": 332000, "num_agent_steps_sampled_lifetime": 1328000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1328000, "timers": {"training_iteration_time_ms": 47450.181, "restore_workers_time_ms": 0.013, "training_step_time_ms": 47450.081, "sample_time_ms": 1235.287, "learn_time_ms": 46194.928, "learn_throughput": 86.59, "synch_weights_time_ms": 14.554}, "counters": {"num_env_steps_sampled": 332000, "num_env_steps_trained": 332000, "num_agent_steps_sampled": 1328000, "num_agent_steps_trained": 1328000}, "done": false, "training_iteration": 83, "trial_id": "cf3bb_00000", "date": "2024-08-20_09-52-27", "timestamp": 1724127747, "time_this_iter_s": 47.68544292449951, "time_total_s": 12009.94435787201, "pid": 25777, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39fe023a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 12009.94435787201, "iterations_since_restore": 83, "perf": {"cpu_util_percent": 35.341791044776116, "ram_util_percent": 82.12835820895523}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7469909971313817, "cur_kl_coeff": 0.0028156757354736326, "cur_lr": 0.00010000000000000003, "total_loss": 4.980677739653007, "policy_loss": -0.004250139127874737, "vf_loss": 4.984894830209238, "vf_explained_var": -5.4475807008289156e-05, "kl": 0.011740744499613777, "entropy": 0.7670392719210771, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 157815.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 18.884407808194084, "cur_kl_coeff": 0.010546875, "cur_lr": 0.00010000000000000003, "total_loss": 6.785215215329771, "policy_loss": -0.0016857772543237954, "vf_loss": 6.7868453482471445, "vf_explained_var": 0.23267580478910416, "kl": 0.005273488230222267, "entropy": 0.8540132116073023, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 157815.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_agent_steps_sampled": 1344000, "num_agent_steps_trained": 1344000}, "env_runners": {"episode_reward_max": 583.91234938604, "episode_reward_min": -947.624802673162, "episode_reward_mean": 112.11292169369297, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1586.9359985878968, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 197.98411363008717, "predator_policy": 1715.869331668619}, "policy_reward_mean": {"prey_policy": -211.67967720410576, "predator_policy": 267.73613805095226}, "custom_metrics": {}, "hist_stats": {"episode_reward": [186.24829173868446, 186.99999999999943, 215.88874003250953, 163.136212406626, 254.02221199186022, 196.9999999999993, 19.099999999999994, 25.700000000000088, 139.09999999999968, 247.68990484369746, 24.700000000000045, 199.8, 35.13619607179967, 178.70000000000002, 134.86847914751786, 153.9895757621708, 52.100000000000165, 33.400000000000205, 185.90964469174287, 486.16337042258334, 39.99999999999999, -131.73554181047547, 138.28903134395637, 132.1110671373662, 87.7999999999999, 122.75088621671826, 10.899999999999984, 294.9975740104046, 455.36659891156825, -181.7264115838643, 86.4999999999998, 166.49999999999952, 298.6, 34.99999999999997, -91.04009409148061, 200.49999999999935, 137.98054659154926, 49.30000000000019, 127.8999999999995, 183.0, -320.5997169503991, 66.48158857821204, 267.48835633707426, 236.96219666347957, 155.1572423834244, 197.1999999999998, 256.9860043128038, 76.39438155917438, 320.5368076120752, 67.77981799312234, -947.624802673162, 89.69496100012478, 152.30964186147523, -289.1826604335829, 303.84955440037896, 162.60000000000002, 25.299999999999983, 109.43617033608649, 135.63035261524902, 583.91234938604, 41.9000000000001, -20.647345197941206, 54.90000000000001, 197.60000000000002, 41.700000000000074, 102.67746375790068, 213.7, 25.397256641021972, 108.75190417402413, 69.73354502186827, 6.9921721014580225, 37.30000000000026, 192.6, 156.39632543639217, 16.99999999999995, 101.73198062301144, 146.82893332581259, 121.0, 22.91140628632571, 176.2289276475496, 122.19999999999999, 99.29999999999964, -12.980488036237565, 395.0, 68.56983164486688, 83.50558439040853, 55.19999999999997, 82.64841935464648, 97.29999999999974, 141.79999999999953, 110.29999999999978, 134.2999999999999, 91.00000000000001, 204.93772338168344, 12.999999999999998, 17.850000000000172, 25.400000000000095, 194.49999999999935, 387.0, 152.79999999999933], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-193.1660814975032, 89.36276969567112, -60.99166658333423, 120.07837602188461, 147.38425314356218, -57.353016969497695, -438.3533404905865, -52.76489584226654, 121.41380859710071, -5.781034426728269, 18.316335621528093, 151.63665228867836, 7.635139707679471, -343.718172743954, -327.4863232143863, 16.182725723989044, -71.91353946209009, 20.000000000000014, 18.184285094572, -680.5249428811427, -303.0337567962025, 16.892656233803464, 197.7657500991529, -1234.1520420560005, -192.86141245142528, -110.75685087083869, -1339.80760127957, 155.73691722138793, 104.52645240811225, -310.5823910811702, -561.5401032235502, -1019.9972575019949, -330.96901037343946, -58.0887562900907, -59.514542095786105, -84.14111081826246, -94.46686292020537, 73.7659249748516, -419.8745813085567, 197.98411363008717, -806.1293607841798, -266.0871579983017, -370.3487889496869, -362.7879547588353, -423.67371020293353, -395.4383114268033, -17.74853789030313, -94.08252763001119, -74.95806856961272, 3.696604811246262, -404.4948564972504, 88.34993565643073, -333.6853351082348, -768.8401712382131, -16.822972372605253, 183.9983107891082, -569.6464770621734, 176.50303051947898, -206.68879447709082, -535.7272015122394, -307.69107516005386, -100.17598840150684, -65.28729700897242, 96.9974908032428, 154.55140683819275, 106.21462369176044, -394.0593149281053, -279.61298924588874, -208.21121363584723, -332.62248121613226, -50.95562566097153, 170.49060461876644, -20.520663478159186, -479.1936530835357, -10.243888463777715, -360.82479726600275, 5.237675707781529, -16.120404274020927, -887.4202009007482, 160.76571982679155, -648.0297062029812, -1162.087830383448, 12.117373535074597, -310.2828109426463, 41.24891503988422, -502.62691710945745, -137.52969342998364, -209.73141654313525, 5.887356372051352, 34.14735884319951, -229.3708621478197, 169.68383538283, -198.28521504524502, 171.7929849968455, -169.34714505767982, -146.50370177141303, 172.02385504075434, -653.1483386852339, -349.89273984813656, -177.86243813922192, -1439.7781923106033, -1586.9359985878968, -16.472181378255943, -331.0254202762497, -408.70237966896195, -24.558440645140138, -1192.1620822788382, -324.4644740879229, -414.9688203485062, 123.6240677221073, 94.85647997656068, -900.4382097794462, -301.02503152189263, -915.5139945348249, -416.727995345355, 18.219077774413744, -231.74522365570158, -470.52577634498596, -943.265578521484, 197.3, -12.325231985785338, -283.7443607233531, -202.21162507149228, -261.08506250880794, -264.69770975783337, -20.254913635500365, 190.47971475422187, -1350.5064277223485, -415.08850111409214, -11.747076805785726, -172.29767336883972, -163.52499609252573, -12.54620264597574, 84.35712682233373, -304.549525200248, -261.3785801089869, -150.06014790439315, -27.613387115380746, -407.6836211053215, -198.36943292622684, -117.3354489439322, -356.5942925933556, 6.332611797640407, -24.248211957690224, 138.61746510063003, -247.84198176416143, -66.052512706211, -50.76012981654087, -102.30379426797496, -441.741507176618, -228.70113255292463, 51.736869062774055, -445.93191068284204, 20.000000000000014, 42.38338655882736, -1097.1161001407668, 21.796773138953984, -497.7721082966572, 16.992870943445233, -175.14984241700984, 34.51629860008627, -474.2573980778569, -52.043857825016055, 18.936427751081425, -469.84807232187984, -463.8423125389415, 193.5762654353972, 195.56634954362895, -135.29793451545547, -498.83096408620213, -223.45836377519413, -42.40886833514705, -469.0123779272912, -222.95989265828428, -96.83560025963126, -171.84282724523672, -27.127752817861722, 3.592420722130942, 40.99632341088583, -5.081230228236862, 12.721726328858852, -92.16919959376364, 67.9855135460783, -497.98827927902323, -690.8081970632088, -75.95918511636398, -43.4966944049499, 131.95229144131315, -916.2124094177086, -270.44558148014437, -47.88496261665022, -12.959234452699652, -3.978930863082199, -1026.3335797783793, 150.564030662773, -97.1794974664457, 174.79361220825706, 197.85545429030594, 59.99020281863163, -11.807663940501811], "policy_predator_policy_reward": [287.43122055388534, 2.6203829866314163, 78.99166658333344, 48.921623978115406, 71.75120721257254, 54.10629664587294, 420.9519288112161, 233.30251992826243, 138.38943782148777, 0.0, 21.30694754780131, 5.740064541992254, 11.464860292320495, 343.718172743954, 333.48632321438623, 3.5172742760109204, 191.01353946209014, 0.0, 415.5980018772302, 494.43256075303873, 308.0337567962025, 2.8073437661965093, 1146.1399370586714, 90.04635489817623, 270.6388796070027, 68.11557978706091, 1342.50760127957, 20.263082778612052, 5.189064325084425, 335.73535349549155, 989.8157045520959, 745.7112319356195, 365.96901037343946, 75.18875629009015, 75.71454209578562, 101.34111081826148, 166.88397408542147, 39.72660855167521, 402.46296753210487, 305.5908705689469, 806.1293607841798, 306.0871579983017, 577.161869197851, 24.23933270019649, 413.853676257451, 543.5473767162416, 199.98255756328476, 43.959575094396065, 143.95806856961278, 15.103395188753703, 25.625925958029367, 413.26988109950844, 336.6853351082348, 776.7401712382126, 125.82297237260528, 1.999263221296522, 533.4782172641762, 315.0318281900863, 0.0, 560.6895844054659, 377.691075160054, 116.6759884015059, 78.78729700897165, 56.0025091967572, 22.448593161807235, 15.385376308239545, 395.0593149281053, 313.6129892458886, 449.79360076049954, 0.0, 68.15562566097155, 12.809395381233552, 513.4078506126455, 124.28701254059871, 28.543888463777872, 391.8247972660027, 105.3623242922184, 33.42040427402117, 887.4202009007482, 22.234280173208443, 1291.5795291492693, 197.9382904867597, 6.364215043137369, 358.2828109426463, 206.4667715882049, 522.3995868184423, 298.17085395683665, 286.0524526797616, 9.26988601137342, 105.85264115680049, 238.57086214781987, 18.31616461716998, 191.5772727041526, 91.90096165705098, 143.3676165081359, 248.87761188013062, 182.0123744089826, 619.6489168475733, 228.37904308608532, 367.1559528943955, 363.2200565567192, 1715.869331668619, 291.4170213283011, 145.77554132632966, 222.05198557902807, 363.5184765965495, 10.44805414271013, 1216.9958417904681, 372.4837462877949, 222.71056073898356, 65.14352002343931, 903.0382097794461, 326.0250315218927, 915.8139945348248, 136.1078326849322, 371.837255222095, 439.106146165135, 398.79520645080095, 398.11230250379697, 931.7656254037269, 32.493598601545706, 305.4759941075929, 415.1234007167185, 27.525941665640353, 302.6977097578334, 37.15491363550036, 1325.303234802324, 32.323478165802804, 438.08850111409214, 30.447076805785915, 306.0179329290743, 132.4822002901917, 132.54620264597594, 9.34287317766625, 246.55919746801342, 344.7661644822454, 88.3307809066356, 198.09465828716299, 460.0604204396996, 215.72617861371685, 478.897840636914, 2.0240730018320647, 12.66738820235956, 42.54821195769049, 0.9825348993699701, 300.84198176416135, 134.7602687436091, 138.4486992155344, 116.30379426797417, 444.74150717661803, 258.9793171753027, 19.716926937859448, 472.56786253937184, 100.19298146928274, 78.61661344117257, 1097.1161001407668, 0.997546295943164, 497.88919514808583, 101.29977243141872, 233.0861266896962, 86.48370139991377, 475.45739807785685, 6.859695815243727, 125.54773425869107, 633.0171488553916, 287.6927479691916, 3.4237345646028112, 2.433650456371062, 496.38268443163184, 206.31604581489265, 0.0, 349.37281650074976, 476.21237792729136, 270.9598926582843, 349.2988827932524, 2.0279640662615863, 105.42775281786172, 15.407579277869022, 82.00367658911411, 23.881230228236934, 166.8781864921852, 22.869286772719544, 58.5144864539217, 505.78827927902444, 690.8081970632088, 166.95918511636407, 61.48676266498467, 54.99536368033644, 916.2124094177086, 283.44558148014437, 75.2182959499838, 3.4759011193662896, 1054.7688659142138, 0.94364472724773, 30.435969337226975, 110.67949746644493, 13.206387791742952, 1.1445457096940646, 8.028321871892357, 96.58913924997799]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1369434519021682, "mean_inference_ms": 3.4420861565072296, "mean_action_processing_ms": 1.6424100997824445, "mean_env_wait_ms": 0.6624062527607139, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003787398338317871, "StateBufferConnector_ms": 0.003087759017944336, "ViewRequirementAgentConnector_ms": 0.10345792770385742}, "num_episodes": 18, "episode_return_max": 583.91234938604, "episode_return_min": -947.624802673162, "episode_return_mean": 112.11292169369297, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1344000, "num_agent_steps_trained": 1344000, "num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 85.62249521254849, "num_env_steps_trained_throughput_per_sec": 85.62249521254849, "timesteps_total": 336000, "num_env_steps_sampled_lifetime": 336000, "num_agent_steps_sampled_lifetime": 1344000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1344000, "timers": {"training_iteration_time_ms": 47407.338, "restore_workers_time_ms": 0.013, "training_step_time_ms": 47407.238, "sample_time_ms": 1202.635, "learn_time_ms": 46184.788, "learn_throughput": 86.609, "synch_weights_time_ms": 13.854}, "counters": {"num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_agent_steps_sampled": 1344000, "num_agent_steps_trained": 1344000}, "done": false, "training_iteration": 84, "trial_id": "cf3bb_00000", "date": "2024-08-20_09-53-14", "timestamp": 1724127794, "time_this_iter_s": 46.742238998413086, "time_total_s": 12056.686596870422, "pid": 25777, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3aaa93550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 12056.686596870422, "iterations_since_restore": 84, "perf": {"cpu_util_percent": 31.57611940298508, "ram_util_percent": 82.52985074626865}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8317130724194819, "cur_kl_coeff": 0.0028156757354736326, "cur_lr": 0.00010000000000000003, "total_loss": 6.163655114300036, "policy_loss": -0.002390189398641861, "vf_loss": 6.166031183767571, "vf_explained_var": -0.0002185129614734145, "kl": 0.005019076254640979, "entropy": 0.7609436743789249, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 159705.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 15.767762529850007, "cur_kl_coeff": 0.010546875, "cur_lr": 0.00010000000000000003, "total_loss": 7.454414711805878, "policy_loss": -0.0032899783283629747, "vf_loss": 7.457618668975023, "vf_explained_var": 0.1601867294185376, "kl": 0.008155803669250738, "entropy": 0.8195375198725039, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 159705.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 340000, "num_env_steps_trained": 340000, "num_agent_steps_sampled": 1360000, "num_agent_steps_trained": 1360000}, "env_runners": {"episode_reward_max": 583.91234938604, "episode_reward_min": -947.624802673162, "episode_reward_mean": 101.9928459653952, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1586.9359985878968, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 198.13344209465097, "predator_policy": 1715.869331668619}, "policy_reward_mean": {"prey_policy": -205.93298223969015, "predator_policy": 256.9294052223878}, "custom_metrics": {}, "hist_stats": {"episode_reward": [138.28903134395637, 132.1110671373662, 87.7999999999999, 122.75088621671826, 10.899999999999984, 294.9975740104046, 455.36659891156825, -181.7264115838643, 86.4999999999998, 166.49999999999952, 298.6, 34.99999999999997, -91.04009409148061, 200.49999999999935, 137.98054659154926, 49.30000000000019, 127.8999999999995, 183.0, -320.5997169503991, 66.48158857821204, 267.48835633707426, 236.96219666347957, 155.1572423834244, 197.1999999999998, 256.9860043128038, 76.39438155917438, 320.5368076120752, 67.77981799312234, -947.624802673162, 89.69496100012478, 152.30964186147523, -289.1826604335829, 303.84955440037896, 162.60000000000002, 25.299999999999983, 109.43617033608649, 135.63035261524902, 583.91234938604, 41.9000000000001, -20.647345197941206, 54.90000000000001, 197.60000000000002, 41.700000000000074, 102.67746375790068, 213.7, 25.397256641021972, 108.75190417402413, 69.73354502186827, 6.9921721014580225, 37.30000000000026, 192.6, 156.39632543639217, 16.99999999999995, 101.73198062301144, 146.82893332581259, 121.0, 22.91140628632571, 176.2289276475496, 122.19999999999999, 99.29999999999964, -12.980488036237565, 395.0, 68.56983164486688, 83.50558439040853, 55.19999999999997, 82.64841935464648, 97.29999999999974, 141.79999999999953, 110.29999999999978, 134.2999999999999, 91.00000000000001, 204.93772338168344, 12.999999999999998, 17.850000000000172, 25.400000000000095, 194.49999999999935, 387.0, 152.79999999999933, 17.79363522305318, 57.25331167780425, -7.298557561180488, 21.424323149292782, 189.60000000000005, 341.86700796562843, 61.52808599544346, -93.25536072425182, 20.866331102403212, 65.22474234103696, 324.62321337407025, 35.20000000000023, 156.49569257024206, 396.0, -915.7873886743674, 106.0, 25.200000000000088, 74.38817765436542, 141.7999999999997, 421.71514779631786, 358.2, 217.07115057908086], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-423.67371020293353, -395.4383114268033, -17.74853789030313, -94.08252763001119, -74.95806856961272, 3.696604811246262, -404.4948564972504, 88.34993565643073, -333.6853351082348, -768.8401712382131, -16.822972372605253, 183.9983107891082, -569.6464770621734, 176.50303051947898, -206.68879447709082, -535.7272015122394, -307.69107516005386, -100.17598840150684, -65.28729700897242, 96.9974908032428, 154.55140683819275, 106.21462369176044, -394.0593149281053, -279.61298924588874, -208.21121363584723, -332.62248121613226, -50.95562566097153, 170.49060461876644, -20.520663478159186, -479.1936530835357, -10.243888463777715, -360.82479726600275, 5.237675707781529, -16.120404274020927, -887.4202009007482, 160.76571982679155, -648.0297062029812, -1162.087830383448, 12.117373535074597, -310.2828109426463, 41.24891503988422, -502.62691710945745, -137.52969342998364, -209.73141654313525, 5.887356372051352, 34.14735884319951, -229.3708621478197, 169.68383538283, -198.28521504524502, 171.7929849968455, -169.34714505767982, -146.50370177141303, 172.02385504075434, -653.1483386852339, -349.89273984813656, -177.86243813922192, -1439.7781923106033, -1586.9359985878968, -16.472181378255943, -331.0254202762497, -408.70237966896195, -24.558440645140138, -1192.1620822788382, -324.4644740879229, -414.9688203485062, 123.6240677221073, 94.85647997656068, -900.4382097794462, -301.02503152189263, -915.5139945348249, -416.727995345355, 18.219077774413744, -231.74522365570158, -470.52577634498596, -943.265578521484, 197.3, -12.325231985785338, -283.7443607233531, -202.21162507149228, -261.08506250880794, -264.69770975783337, -20.254913635500365, 190.47971475422187, -1350.5064277223485, -415.08850111409214, -11.747076805785726, -172.29767336883972, -163.52499609252573, -12.54620264597574, 84.35712682233373, -304.549525200248, -261.3785801089869, -150.06014790439315, -27.613387115380746, -407.6836211053215, -198.36943292622684, -117.3354489439322, -356.5942925933556, 6.332611797640407, -24.248211957690224, 138.61746510063003, -247.84198176416143, -66.052512706211, -50.76012981654087, -102.30379426797496, -441.741507176618, -228.70113255292463, 51.736869062774055, -445.93191068284204, 20.000000000000014, 42.38338655882736, -1097.1161001407668, 21.796773138953984, -497.7721082966572, 16.992870943445233, -175.14984241700984, 34.51629860008627, -474.2573980778569, -52.043857825016055, 18.936427751081425, -469.84807232187984, -463.8423125389415, 193.5762654353972, 195.56634954362895, -135.29793451545547, -498.83096408620213, -223.45836377519413, -42.40886833514705, -469.0123779272912, -222.95989265828428, -96.83560025963126, -171.84282724523672, -27.127752817861722, 3.592420722130942, 40.99632341088583, -5.081230228236862, 12.721726328858852, -92.16919959376364, 67.9855135460783, -497.98827927902323, -690.8081970632088, -75.95918511636398, -43.4966944049499, 131.95229144131315, -916.2124094177086, -270.44558148014437, -47.88496261665022, -12.959234452699652, -3.978930863082199, -1026.3335797783793, 150.564030662773, -97.1794974664457, 174.79361220825706, 197.85545429030594, 59.99020281863163, -11.807663940501811, -56.42120530325404, -119.92334580264612, -107.53978010148245, -239.2463990712916, -328.9286858255174, -229.58907037731663, -201.95269615089185, -420.4217957185434, 173.622625248595, -258.7385187959354, 37.83527150068518, -465.97251834541856, -173.76141176908763, -72.64558362216984, -536.3373391207891, -100.79514789402234, -213.28091323246275, -107.51473114942935, -62.415184200536714, -259.3992628002678, 120.84292631342059, 149.93619214413602, -56.62044758616308, -19.87550672713224, -7.192278211180101, 48.41009263344728, 193.00820853035813, 198.13344209465097, -1484.7086886223099, -1183.635635386952, -474.8631529215492, -28.387541297356634, -53.01694202820654, -447.1023386995911, -229.0576192159159, 18.155263050594346, 34.14703712807855, 7.4975083216713525, -30.413384241989647, -731.1388817368961, 162.67151152201654, 149.40996498882632, 110.97564104618563, -254.73708089076322], "policy_predator_policy_reward": [413.853676257451, 543.5473767162416, 199.98255756328476, 43.959575094396065, 143.95806856961278, 15.103395188753703, 25.625925958029367, 413.26988109950844, 336.6853351082348, 776.7401712382126, 125.82297237260528, 1.999263221296522, 533.4782172641762, 315.0318281900863, 0.0, 560.6895844054659, 377.691075160054, 116.6759884015059, 78.78729700897165, 56.0025091967572, 22.448593161807235, 15.385376308239545, 395.0593149281053, 313.6129892458886, 449.79360076049954, 0.0, 68.15562566097155, 12.809395381233552, 513.4078506126455, 124.28701254059871, 28.543888463777872, 391.8247972660027, 105.3623242922184, 33.42040427402117, 887.4202009007482, 22.234280173208443, 1291.5795291492693, 197.9382904867597, 6.364215043137369, 358.2828109426463, 206.4667715882049, 522.3995868184423, 298.17085395683665, 286.0524526797616, 9.26988601137342, 105.85264115680049, 238.57086214781987, 18.31616461716998, 191.5772727041526, 91.90096165705098, 143.3676165081359, 248.87761188013062, 182.0123744089826, 619.6489168475733, 228.37904308608532, 367.1559528943955, 363.2200565567192, 1715.869331668619, 291.4170213283011, 145.77554132632966, 222.05198557902807, 363.5184765965495, 10.44805414271013, 1216.9958417904681, 372.4837462877949, 222.71056073898356, 65.14352002343931, 903.0382097794461, 326.0250315218927, 915.8139945348248, 136.1078326849322, 371.837255222095, 439.106146165135, 398.79520645080095, 398.11230250379697, 931.7656254037269, 32.493598601545706, 305.4759941075929, 415.1234007167185, 27.525941665640353, 302.6977097578334, 37.15491363550036, 1325.303234802324, 32.323478165802804, 438.08850111409214, 30.447076805785915, 306.0179329290743, 132.4822002901917, 132.54620264597594, 9.34287317766625, 246.55919746801342, 344.7661644822454, 88.3307809066356, 198.09465828716299, 460.0604204396996, 215.72617861371685, 478.897840636914, 2.0240730018320647, 12.66738820235956, 42.54821195769049, 0.9825348993699701, 300.84198176416135, 134.7602687436091, 138.4486992155344, 116.30379426797417, 444.74150717661803, 258.9793171753027, 19.716926937859448, 472.56786253937184, 100.19298146928274, 78.61661344117257, 1097.1161001407668, 0.997546295943164, 497.88919514808583, 101.29977243141872, 233.0861266896962, 86.48370139991377, 475.45739807785685, 6.859695815243727, 125.54773425869107, 633.0171488553916, 287.6927479691916, 3.4237345646028112, 2.433650456371062, 496.38268443163184, 206.31604581489265, 0.0, 349.37281650074976, 476.21237792729136, 270.9598926582843, 349.2988827932524, 2.0279640662615863, 105.42775281786172, 15.407579277869022, 82.00367658911411, 23.881230228236934, 166.8781864921852, 22.869286772719544, 58.5144864539217, 505.78827927902444, 690.8081970632088, 166.95918511636407, 61.48676266498467, 54.99536368033644, 916.2124094177086, 283.44558148014437, 75.2182959499838, 3.4759011193662896, 1054.7688659142138, 0.94364472724773, 30.435969337226975, 110.67949746644493, 13.206387791742952, 1.1445457096940646, 8.028321871892357, 96.58913924997799, 161.42923292657042, 32.708953402382576, 91.7791188766887, 312.26037197388956, 399.1090767344767, 152.11012190717662, 264.29003167126444, 379.5087833474629, 10.87737475140502, 263.83851879593556, 365.95815909362767, 404.04609571673444, 294.9933791402071, 12.941702246494021, 536.4021864538987, 7.47493983666092, 4.4284257488379195, 337.23354973545764, 330.15308556206134, 56.88610377978052, 23.31650874567926, 30.527586170834347, 74.62044758616258, 37.07550672713248, 66.05816806663852, 49.219710081337006, 3.9917914696418624, 0.8665579053490272, 1699.7792125890055, 52.777722745888596, 474.8631529215492, 134.38754129735662, 467.8893080790923, 57.42997264870534, 165.95821637198497, 119.33231744770214, 88.85296287192152, 11.302491678328614, 682.0483335233018, 501.2190802519019, 21.328488477983445, 24.79003501117369, 10.004202320723198, 350.82838810293487]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1307215835061313, "mean_inference_ms": 3.41078105565508, "mean_action_processing_ms": 1.6244209150453015, "mean_env_wait_ms": 0.657049754571791, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004082798957824707, "StateBufferConnector_ms": 0.0031386613845825195, "ViewRequirementAgentConnector_ms": 0.10581517219543457}, "num_episodes": 22, "episode_return_max": 583.91234938604, "episode_return_min": -947.624802673162, "episode_return_mean": 101.9928459653952, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1360000, "num_agent_steps_trained": 1360000, "num_env_steps_sampled": 340000, "num_env_steps_trained": 340000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 84.87141162757263, "num_env_steps_trained_throughput_per_sec": 84.87141162757263, "timesteps_total": 340000, "num_env_steps_sampled_lifetime": 340000, "num_agent_steps_sampled_lifetime": 1360000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1360000, "timers": {"training_iteration_time_ms": 47311.561, "restore_workers_time_ms": 0.013, "training_step_time_ms": 47311.462, "sample_time_ms": 1131.856, "learn_time_ms": 46159.829, "learn_throughput": 86.655, "synch_weights_time_ms": 13.913}, "counters": {"num_env_steps_sampled": 340000, "num_env_steps_trained": 340000, "num_agent_steps_sampled": 1360000, "num_agent_steps_trained": 1360000}, "done": false, "training_iteration": 85, "trial_id": "cf3bb_00000", "date": "2024-08-20_09-54-01", "timestamp": 1724127841, "time_this_iter_s": 47.17278814315796, "time_total_s": 12103.85938501358, "pid": 25777, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39f7820d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 12103.85938501358, "iterations_since_restore": 85, "perf": {"cpu_util_percent": 34.14848484848485, "ram_util_percent": 82.59848484848484}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9093686970532255, "cur_kl_coeff": 0.0028156757354736326, "cur_lr": 0.00010000000000000003, "total_loss": 6.030057218844298, "policy_loss": -0.0033932166692687486, "vf_loss": 6.033423813562544, "vf_explained_var": 0.0015245776643198004, "kl": 0.00945432737980328, "entropy": 0.6575937126994764, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 161595.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 18.424610709639452, "cur_kl_coeff": 0.010546875, "cur_lr": 0.00010000000000000003, "total_loss": 7.51629381255498, "policy_loss": -0.0017577151700154578, "vf_loss": 7.517984824962717, "vf_explained_var": 0.19840863693958868, "kl": 0.0063240151738400115, "entropy": 0.8318208780238238, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 161595.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 344000, "num_env_steps_trained": 344000, "num_agent_steps_sampled": 1376000, "num_agent_steps_trained": 1376000}, "env_runners": {"episode_reward_max": 583.91234938604, "episode_reward_min": -947.624802673162, "episode_reward_mean": 100.08126779301826, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1586.9359985878968, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 198.13344209465097, "predator_policy": 1715.869331668619}, "policy_reward_mean": {"prey_policy": -197.2768512499773, "predator_policy": 247.31748514648646}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-320.5997169503991, 66.48158857821204, 267.48835633707426, 236.96219666347957, 155.1572423834244, 197.1999999999998, 256.9860043128038, 76.39438155917438, 320.5368076120752, 67.77981799312234, -947.624802673162, 89.69496100012478, 152.30964186147523, -289.1826604335829, 303.84955440037896, 162.60000000000002, 25.299999999999983, 109.43617033608649, 135.63035261524902, 583.91234938604, 41.9000000000001, -20.647345197941206, 54.90000000000001, 197.60000000000002, 41.700000000000074, 102.67746375790068, 213.7, 25.397256641021972, 108.75190417402413, 69.73354502186827, 6.9921721014580225, 37.30000000000026, 192.6, 156.39632543639217, 16.99999999999995, 101.73198062301144, 146.82893332581259, 121.0, 22.91140628632571, 176.2289276475496, 122.19999999999999, 99.29999999999964, -12.980488036237565, 395.0, 68.56983164486688, 83.50558439040853, 55.19999999999997, 82.64841935464648, 97.29999999999974, 141.79999999999953, 110.29999999999978, 134.2999999999999, 91.00000000000001, 204.93772338168344, 12.999999999999998, 17.850000000000172, 25.400000000000095, 194.49999999999935, 387.0, 152.79999999999933, 17.79363522305318, 57.25331167780425, -7.298557561180488, 21.424323149292782, 189.60000000000005, 341.86700796562843, 61.52808599544346, -93.25536072425182, 20.866331102403212, 65.22474234103696, 324.62321337407025, 35.20000000000023, 156.49569257024206, 396.0, -915.7873886743674, 106.0, 25.200000000000088, 74.38817765436542, 141.7999999999997, 421.71514779631786, 358.2, 217.07115057908086, 336.6041606467007, 389.0, 79.8782433512015, 38.02613542810574, -154.3294123596147, 336.3876999508194, 32.6622070867909, 5.489366400863672, -48.846056095789905, 338.0, 124.39999999999941, 131.77366816662789, 271.93629520746333, 16.29999999999998, -68.66597884122842, 135.65505235658114, 70.3, 29.000000000000142], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-648.0297062029812, -1162.087830383448, 12.117373535074597, -310.2828109426463, 41.24891503988422, -502.62691710945745, -137.52969342998364, -209.73141654313525, 5.887356372051352, 34.14735884319951, -229.3708621478197, 169.68383538283, -198.28521504524502, 171.7929849968455, -169.34714505767982, -146.50370177141303, 172.02385504075434, -653.1483386852339, -349.89273984813656, -177.86243813922192, -1439.7781923106033, -1586.9359985878968, -16.472181378255943, -331.0254202762497, -408.70237966896195, -24.558440645140138, -1192.1620822788382, -324.4644740879229, -414.9688203485062, 123.6240677221073, 94.85647997656068, -900.4382097794462, -301.02503152189263, -915.5139945348249, -416.727995345355, 18.219077774413744, -231.74522365570158, -470.52577634498596, -943.265578521484, 197.3, -12.325231985785338, -283.7443607233531, -202.21162507149228, -261.08506250880794, -264.69770975783337, -20.254913635500365, 190.47971475422187, -1350.5064277223485, -415.08850111409214, -11.747076805785726, -172.29767336883972, -163.52499609252573, -12.54620264597574, 84.35712682233373, -304.549525200248, -261.3785801089869, -150.06014790439315, -27.613387115380746, -407.6836211053215, -198.36943292622684, -117.3354489439322, -356.5942925933556, 6.332611797640407, -24.248211957690224, 138.61746510063003, -247.84198176416143, -66.052512706211, -50.76012981654087, -102.30379426797496, -441.741507176618, -228.70113255292463, 51.736869062774055, -445.93191068284204, 20.000000000000014, 42.38338655882736, -1097.1161001407668, 21.796773138953984, -497.7721082966572, 16.992870943445233, -175.14984241700984, 34.51629860008627, -474.2573980778569, -52.043857825016055, 18.936427751081425, -469.84807232187984, -463.8423125389415, 193.5762654353972, 195.56634954362895, -135.29793451545547, -498.83096408620213, -223.45836377519413, -42.40886833514705, -469.0123779272912, -222.95989265828428, -96.83560025963126, -171.84282724523672, -27.127752817861722, 3.592420722130942, 40.99632341088583, -5.081230228236862, 12.721726328858852, -92.16919959376364, 67.9855135460783, -497.98827927902323, -690.8081970632088, -75.95918511636398, -43.4966944049499, 131.95229144131315, -916.2124094177086, -270.44558148014437, -47.88496261665022, -12.959234452699652, -3.978930863082199, -1026.3335797783793, 150.564030662773, -97.1794974664457, 174.79361220825706, 197.85545429030594, 59.99020281863163, -11.807663940501811, -56.42120530325404, -119.92334580264612, -107.53978010148245, -239.2463990712916, -328.9286858255174, -229.58907037731663, -201.95269615089185, -420.4217957185434, 173.622625248595, -258.7385187959354, 37.83527150068518, -465.97251834541856, -173.76141176908763, -72.64558362216984, -536.3373391207891, -100.79514789402234, -213.28091323246275, -107.51473114942935, -62.415184200536714, -259.3992628002678, 120.84292631342059, 149.93619214413602, -56.62044758616308, -19.87550672713224, -7.192278211180101, 48.41009263344728, 193.00820853035813, 198.13344209465097, -1484.7086886223099, -1183.635635386952, -474.8631529215492, -28.387541297356634, -53.01694202820654, -447.1023386995911, -229.0576192159159, 18.155263050594346, 34.14703712807855, 7.4975083216713525, -30.413384241989647, -731.1388817368961, 162.67151152201654, 149.40996498882632, 110.97564104618563, -254.73708089076322, 155.17888161537584, 145.4714028454018, 179.8402467366496, 198.07008017913995, -102.74851052748753, -134.74275022556304, -113.21806931059436, -273.3841752723751, -370.395453860487, -209.13100857976772, 144.24400460486325, 137.3966577218477, -277.9656401025575, -39.10872445891952, -275.48347997713694, -155.14654533669218, -398.05694329619945, -218.4482946623095, 180.59423866057642, 84.65048704208318, -5.938514883811049, -41.55363148315483, 18.126851705570477, 1.3897091055809507, -31.29863844625813, -575.4031674328648, -164.8561112100676, -505.3506487188604, -113.63211886007888, -95.35034120979238, -560.4574193272778, 116.03855829310022, -37.71477907251227, -1007.0944632863457, -36.84398921031343, -94.39265526459145], "policy_predator_policy_reward": [1291.5795291492693, 197.9382904867597, 6.364215043137369, 358.2828109426463, 206.4667715882049, 522.3995868184423, 298.17085395683665, 286.0524526797616, 9.26988601137342, 105.85264115680049, 238.57086214781987, 18.31616461716998, 191.5772727041526, 91.90096165705098, 143.3676165081359, 248.87761188013062, 182.0123744089826, 619.6489168475733, 228.37904308608532, 367.1559528943955, 363.2200565567192, 1715.869331668619, 291.4170213283011, 145.77554132632966, 222.05198557902807, 363.5184765965495, 10.44805414271013, 1216.9958417904681, 372.4837462877949, 222.71056073898356, 65.14352002343931, 903.0382097794461, 326.0250315218927, 915.8139945348248, 136.1078326849322, 371.837255222095, 439.106146165135, 398.79520645080095, 398.11230250379697, 931.7656254037269, 32.493598601545706, 305.4759941075929, 415.1234007167185, 27.525941665640353, 302.6977097578334, 37.15491363550036, 1325.303234802324, 32.323478165802804, 438.08850111409214, 30.447076805785915, 306.0179329290743, 132.4822002901917, 132.54620264597594, 9.34287317766625, 246.55919746801342, 344.7661644822454, 88.3307809066356, 198.09465828716299, 460.0604204396996, 215.72617861371685, 478.897840636914, 2.0240730018320647, 12.66738820235956, 42.54821195769049, 0.9825348993699701, 300.84198176416135, 134.7602687436091, 138.4486992155344, 116.30379426797417, 444.74150717661803, 258.9793171753027, 19.716926937859448, 472.56786253937184, 100.19298146928274, 78.61661344117257, 1097.1161001407668, 0.997546295943164, 497.88919514808583, 101.29977243141872, 233.0861266896962, 86.48370139991377, 475.45739807785685, 6.859695815243727, 125.54773425869107, 633.0171488553916, 287.6927479691916, 3.4237345646028112, 2.433650456371062, 496.38268443163184, 206.31604581489265, 0.0, 349.37281650074976, 476.21237792729136, 270.9598926582843, 349.2988827932524, 2.0279640662615863, 105.42775281786172, 15.407579277869022, 82.00367658911411, 23.881230228236934, 166.8781864921852, 22.869286772719544, 58.5144864539217, 505.78827927902444, 690.8081970632088, 166.95918511636407, 61.48676266498467, 54.99536368033644, 916.2124094177086, 283.44558148014437, 75.2182959499838, 3.4759011193662896, 1054.7688659142138, 0.94364472724773, 30.435969337226975, 110.67949746644493, 13.206387791742952, 1.1445457096940646, 8.028321871892357, 96.58913924997799, 161.42923292657042, 32.708953402382576, 91.7791188766887, 312.26037197388956, 399.1090767344767, 152.11012190717662, 264.29003167126444, 379.5087833474629, 10.87737475140502, 263.83851879593556, 365.95815909362767, 404.04609571673444, 294.9933791402071, 12.941702246494021, 536.4021864538987, 7.47493983666092, 4.4284257488379195, 337.23354973545764, 330.15308556206134, 56.88610377978052, 23.31650874567926, 30.527586170834347, 74.62044758616258, 37.07550672713248, 66.05816806663852, 49.219710081337006, 3.9917914696418624, 0.8665579053490272, 1699.7792125890055, 52.777722745888596, 474.8631529215492, 134.38754129735662, 467.8893080790923, 57.42997264870534, 165.95821637198497, 119.33231744770214, 88.85296287192152, 11.302491678328614, 682.0483335233018, 501.2190802519019, 21.328488477983445, 24.79003501117369, 10.004202320723198, 350.82838810293487, 35.95387618592302, 0.0, 10.159753263350403, 0.9299198208600424, 16.198723861355564, 301.1707802428967, 141.27929339794468, 283.3490866131295, 424.1722618468313, 1.024788233808655, 54.747037624108444, 0.0, 54.08666218056613, 295.64990946770183, 111.90242086199174, 324.21697085270125, 450.65247689580184, 117.0067049669169, 10.405761339423591, 62.34951295791691, 113.93851488381097, 57.953631483155064, 34.4499462456111, 77.80716110986583, 438.62625682463045, 440.0118442619568, 172.1561112100672, 514.3506487188605, 23.336280967674142, 116.98020026096859, 563.7574193272785, 16.316494063481056, 108.0147790725123, 1007.0944632863457, 54.14398921031368, 106.09265526459163]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.125178446255004, "mean_inference_ms": 3.388895519266471, "mean_action_processing_ms": 1.6095192908197302, "mean_env_wait_ms": 0.6519821749851477, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00422358512878418, "StateBufferConnector_ms": 0.0032984018325805664, "ViewRequirementAgentConnector_ms": 0.1089015007019043}, "num_episodes": 18, "episode_return_max": 583.91234938604, "episode_return_min": -947.624802673162, "episode_return_mean": 100.08126779301826, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1376000, "num_agent_steps_trained": 1376000, "num_env_steps_sampled": 344000, "num_env_steps_trained": 344000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 84.29063628045348, "num_env_steps_trained_throughput_per_sec": 84.29063628045348, "timesteps_total": 344000, "num_env_steps_sampled_lifetime": 344000, "num_agent_steps_sampled_lifetime": 1376000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1376000, "timers": {"training_iteration_time_ms": 47346.066, "restore_workers_time_ms": 0.013, "training_step_time_ms": 47345.969, "sample_time_ms": 1164.844, "learn_time_ms": 46161.742, "learn_throughput": 86.652, "synch_weights_time_ms": 13.873}, "counters": {"num_env_steps_sampled": 344000, "num_env_steps_trained": 344000, "num_agent_steps_sampled": 1376000, "num_agent_steps_trained": 1376000}, "done": false, "training_iteration": 86, "trial_id": "cf3bb_00000", "date": "2024-08-20_09-54-49", "timestamp": 1724127889, "time_this_iter_s": 47.49677109718323, "time_total_s": 12151.356156110764, "pid": 25777, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39fcc89d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 12151.356156110764, "iterations_since_restore": 86, "perf": {"cpu_util_percent": 33.07313432835821, "ram_util_percent": 82.5731343283582}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8035971751761815, "cur_kl_coeff": 0.0028156757354736326, "cur_lr": 0.00010000000000000003, "total_loss": 6.517994361453586, "policy_loss": -0.0010016153278272777, "vf_loss": 6.518988257867319, "vf_explained_var": -0.002199055246575169, "kl": 0.0027353569291915423, "entropy": 0.7136975534063168, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 163485.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 17.20771846071122, "cur_kl_coeff": 0.010546875, "cur_lr": 0.00010000000000000003, "total_loss": 7.574933390894895, "policy_loss": -0.0023968587203256823, "vf_loss": 7.577264747670088, "vf_explained_var": 0.20659426242586165, "kl": 0.006210636131619914, "entropy": 0.8430158385839411, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 163485.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_agent_steps_sampled": 1392000, "num_agent_steps_trained": 1392000}, "env_runners": {"episode_reward_max": 421.71514779631786, "episode_reward_min": -915.7873886743674, "episode_reward_mean": 103.46104224229013, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1484.7086886223099, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 1699.7792125890055}, "policy_reward_mean": {"prey_policy": -160.86370308432473, "predator_policy": 212.59422420546983}, "custom_metrics": {}, "hist_stats": {"episode_reward": [197.60000000000002, 41.700000000000074, 102.67746375790068, 213.7, 25.397256641021972, 108.75190417402413, 69.73354502186827, 6.9921721014580225, 37.30000000000026, 192.6, 156.39632543639217, 16.99999999999995, 101.73198062301144, 146.82893332581259, 121.0, 22.91140628632571, 176.2289276475496, 122.19999999999999, 99.29999999999964, -12.980488036237565, 395.0, 68.56983164486688, 83.50558439040853, 55.19999999999997, 82.64841935464648, 97.29999999999974, 141.79999999999953, 110.29999999999978, 134.2999999999999, 91.00000000000001, 204.93772338168344, 12.999999999999998, 17.850000000000172, 25.400000000000095, 194.49999999999935, 387.0, 152.79999999999933, 17.79363522305318, 57.25331167780425, -7.298557561180488, 21.424323149292782, 189.60000000000005, 341.86700796562843, 61.52808599544346, -93.25536072425182, 20.866331102403212, 65.22474234103696, 324.62321337407025, 35.20000000000023, 156.49569257024206, 396.0, -915.7873886743674, 106.0, 25.200000000000088, 74.38817765436542, 141.7999999999997, 421.71514779631786, 358.2, 217.07115057908086, 336.6041606467007, 389.0, 79.8782433512015, 38.02613542810574, -154.3294123596147, 336.3876999508194, 32.6622070867909, 5.489366400863672, -48.846056095789905, 338.0, 124.39999999999941, 131.77366816662789, 271.93629520746333, 16.29999999999998, -68.66597884122842, 135.65505235658114, 70.3, 29.000000000000142, 101.72683961204618, 394.3, 148.38407821254856, 186.3999999999999, 380.4, 139.17817956749667, -84.56884678732854, 38.80000000000028, 73.7795523438279, 57.89085135543368, 154.76190687586904, -361.67799592438104, 19.900000000000006, 40.4000000000002, 32.60000000000011, 20.600000000000065, 16.98268798856316, 150.10000000000002, 157.2, 106.01114276154932, 159.60846970874172, -66.3345210035437, 198.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [190.47971475422187, -1350.5064277223485, -415.08850111409214, -11.747076805785726, -172.29767336883972, -163.52499609252573, -12.54620264597574, 84.35712682233373, -304.549525200248, -261.3785801089869, -150.06014790439315, -27.613387115380746, -407.6836211053215, -198.36943292622684, -117.3354489439322, -356.5942925933556, 6.332611797640407, -24.248211957690224, 138.61746510063003, -247.84198176416143, -66.052512706211, -50.76012981654087, -102.30379426797496, -441.741507176618, -228.70113255292463, 51.736869062774055, -445.93191068284204, 20.000000000000014, 42.38338655882736, -1097.1161001407668, 21.796773138953984, -497.7721082966572, 16.992870943445233, -175.14984241700984, 34.51629860008627, -474.2573980778569, -52.043857825016055, 18.936427751081425, -469.84807232187984, -463.8423125389415, 193.5762654353972, 195.56634954362895, -135.29793451545547, -498.83096408620213, -223.45836377519413, -42.40886833514705, -469.0123779272912, -222.95989265828428, -96.83560025963126, -171.84282724523672, -27.127752817861722, 3.592420722130942, 40.99632341088583, -5.081230228236862, 12.721726328858852, -92.16919959376364, 67.9855135460783, -497.98827927902323, -690.8081970632088, -75.95918511636398, -43.4966944049499, 131.95229144131315, -916.2124094177086, -270.44558148014437, -47.88496261665022, -12.959234452699652, -3.978930863082199, -1026.3335797783793, 150.564030662773, -97.1794974664457, 174.79361220825706, 197.85545429030594, 59.99020281863163, -11.807663940501811, -56.42120530325404, -119.92334580264612, -107.53978010148245, -239.2463990712916, -328.9286858255174, -229.58907037731663, -201.95269615089185, -420.4217957185434, 173.622625248595, -258.7385187959354, 37.83527150068518, -465.97251834541856, -173.76141176908763, -72.64558362216984, -536.3373391207891, -100.79514789402234, -213.28091323246275, -107.51473114942935, -62.415184200536714, -259.3992628002678, 120.84292631342059, 149.93619214413602, -56.62044758616308, -19.87550672713224, -7.192278211180101, 48.41009263344728, 193.00820853035813, 198.13344209465097, -1484.7086886223099, -1183.635635386952, -474.8631529215492, -28.387541297356634, -53.01694202820654, -447.1023386995911, -229.0576192159159, 18.155263050594346, 34.14703712807855, 7.4975083216713525, -30.413384241989647, -731.1388817368961, 162.67151152201654, 149.40996498882632, 110.97564104618563, -254.73708089076322, 155.17888161537584, 145.4714028454018, 179.8402467366496, 198.07008017913995, -102.74851052748753, -134.74275022556304, -113.21806931059436, -273.3841752723751, -370.395453860487, -209.13100857976772, 144.24400460486325, 137.3966577218477, -277.9656401025575, -39.10872445891952, -275.48347997713694, -155.14654533669218, -398.05694329619945, -218.4482946623095, 180.59423866057642, 84.65048704208318, -5.938514883811049, -41.55363148315483, 18.126851705570477, 1.3897091055809507, -31.29863844625813, -575.4031674328648, -164.8561112100676, -505.3506487188604, -113.63211886007888, -95.35034120979238, -560.4574193272778, 116.03855829310022, -37.71477907251227, -1007.0944632863457, -36.84398921031343, -94.39265526459145, -97.00246297414483, -59.00668196817043, 193.61740069124886, 197.3, 20.000000000000014, -27.842145919570275, 145.71167921725498, -522.6190411611809, 172.68022733973237, 200.0, -100.9885531271439, -269.120838600631, -234.15548991255798, -436.450386777194, 14.123242484059388, 13.313336860078508, -230.33084252991426, -75.44838439036242, -141.62154581184018, -407.85412740067704, -75.89990448589573, 48.87853691236274, -507.46344027170176, -824.1385857556576, 19.03168826888922, -629.9987442747159, -150.0442816413444, -204.01758196768336, 15.700856073420097, -408.44370603153305, -238.53864534072972, -278.95246971308273, -177.66524069945712, -95.10125087503096, -439.95441352067144, 72.17799101085994, 30.167242664698506, -613.6233582001181, -173.0817612759116, -5.226367719947665, -2.9370416858352257, -76.51848131348332, -319.171471553039, -239.97526860409403, 195.68411528422172, -808.9903817645084], "policy_predator_policy_reward": [1325.303234802324, 32.323478165802804, 438.08850111409214, 30.447076805785915, 306.0179329290743, 132.4822002901917, 132.54620264597594, 9.34287317766625, 246.55919746801342, 344.7661644822454, 88.3307809066356, 198.09465828716299, 460.0604204396996, 215.72617861371685, 478.897840636914, 2.0240730018320647, 12.66738820235956, 42.54821195769049, 0.9825348993699701, 300.84198176416135, 134.7602687436091, 138.4486992155344, 116.30379426797417, 444.74150717661803, 258.9793171753027, 19.716926937859448, 472.56786253937184, 100.19298146928274, 78.61661344117257, 1097.1161001407668, 0.997546295943164, 497.88919514808583, 101.29977243141872, 233.0861266896962, 86.48370139991377, 475.45739807785685, 6.859695815243727, 125.54773425869107, 633.0171488553916, 287.6927479691916, 3.4237345646028112, 2.433650456371062, 496.38268443163184, 206.31604581489265, 0.0, 349.37281650074976, 476.21237792729136, 270.9598926582843, 349.2988827932524, 2.0279640662615863, 105.42775281786172, 15.407579277869022, 82.00367658911411, 23.881230228236934, 166.8781864921852, 22.869286772719544, 58.5144864539217, 505.78827927902444, 690.8081970632088, 166.95918511636407, 61.48676266498467, 54.99536368033644, 916.2124094177086, 283.44558148014437, 75.2182959499838, 3.4759011193662896, 1054.7688659142138, 0.94364472724773, 30.435969337226975, 110.67949746644493, 13.206387791742952, 1.1445457096940646, 8.028321871892357, 96.58913924997799, 161.42923292657042, 32.708953402382576, 91.7791188766887, 312.26037197388956, 399.1090767344767, 152.11012190717662, 264.29003167126444, 379.5087833474629, 10.87737475140502, 263.83851879593556, 365.95815909362767, 404.04609571673444, 294.9933791402071, 12.941702246494021, 536.4021864538987, 7.47493983666092, 4.4284257488379195, 337.23354973545764, 330.15308556206134, 56.88610377978052, 23.31650874567926, 30.527586170834347, 74.62044758616258, 37.07550672713248, 66.05816806663852, 49.219710081337006, 3.9917914696418624, 0.8665579053490272, 1699.7792125890055, 52.777722745888596, 474.8631529215492, 134.38754129735662, 467.8893080790923, 57.42997264870534, 165.95821637198497, 119.33231744770214, 88.85296287192152, 11.302491678328614, 682.0483335233018, 501.2190802519019, 21.328488477983445, 24.79003501117369, 10.004202320723198, 350.82838810293487, 35.95387618592302, 0.0, 10.159753263350403, 0.9299198208600424, 16.198723861355564, 301.1707802428967, 141.27929339794468, 283.3490866131295, 424.1722618468313, 1.024788233808655, 54.747037624108444, 0.0, 54.08666218056613, 295.64990946770183, 111.90242086199174, 324.21697085270125, 450.65247689580184, 117.0067049669169, 10.405761339423591, 62.34951295791691, 113.93851488381097, 57.953631483155064, 34.4499462456111, 77.80716110986583, 438.62625682463045, 440.0118442619568, 172.1561112100672, 514.3506487188605, 23.336280967674142, 116.98020026096859, 563.7574193272785, 16.316494063481056, 108.0147790725123, 1007.0944632863457, 54.14398921031368, 106.09265526459163, 51.68499329138146, 206.0509912629797, 0.0, 3.382599308751148, 16.036673004508764, 140.18955112761057, 33.28832078274502, 530.019041161181, 7.7197726602676235, 0.0, 189.20157806550304, 320.0859932297682, 478.22194659079616, 107.81508331162823, 5.276757515940578, 6.086663139921457, 173.92659629087962, 205.63218297322427, 184.5692170077244, 422.7973075602265, 111.37595906579867, 70.40731538360366, 72.58134927340073, 897.3426808295768, 0.8683117311107852, 629.9987442747159, 164.4442816413436, 230.01758196768336, 3.899143926579866, 421.44370603153305, 257.53864534072966, 280.55246971308304, 101.8751324832475, 187.87404707980383, 440.05441352067146, 77.82200898914004, 95.8327573353015, 644.8233582001182, 239.93919981194153, 44.38007194546704, 225.86919510635565, 13.194797601704575, 257.19873576195687, 235.61348339163249, 2.315884715778287, 808.9903817645084]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.117265945295825, "mean_inference_ms": 3.364758459018119, "mean_action_processing_ms": 1.590160294190897, "mean_env_wait_ms": 0.6446251233471619, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004113316535949707, "StateBufferConnector_ms": 0.0033179521560668945, "ViewRequirementAgentConnector_ms": 0.10696291923522949}, "num_episodes": 23, "episode_return_max": 421.71514779631786, "episode_return_min": -915.7873886743674, "episode_return_mean": 103.46104224229013, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1392000, "num_agent_steps_trained": 1392000, "num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 84.97963490813912, "num_env_steps_trained_throughput_per_sec": 84.97963490813912, "timesteps_total": 348000, "num_env_steps_sampled_lifetime": 348000, "num_agent_steps_sampled_lifetime": 1392000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1392000, "timers": {"training_iteration_time_ms": 47303.834, "restore_workers_time_ms": 0.013, "training_step_time_ms": 47303.723, "sample_time_ms": 1155.787, "learn_time_ms": 46128.157, "learn_throughput": 86.715, "synch_weights_time_ms": 14.258}, "counters": {"num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_agent_steps_sampled": 1392000, "num_agent_steps_trained": 1392000}, "done": false, "training_iteration": 87, "trial_id": "cf3bb_00000", "date": "2024-08-20_09-55-36", "timestamp": 1724127936, "time_this_iter_s": 47.115732192993164, "time_total_s": 12198.471888303757, "pid": 25777, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39fc9b0d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 12198.471888303757, "iterations_since_restore": 87, "perf": {"cpu_util_percent": 34.32089552238805, "ram_util_percent": 82.16716417910447}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.869324863784843, "cur_kl_coeff": 0.0014078378677368163, "cur_lr": 0.00010000000000000003, "total_loss": 7.060874602151295, "policy_loss": -0.00207540770948288, "vf_loss": 7.062937567726014, "vf_explained_var": 0.0015693512858537138, "kl": 0.008841561110283504, "entropy": 0.5917912902024688, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 165375.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.459433333898978, "cur_kl_coeff": 0.010546875, "cur_lr": 0.00010000000000000003, "total_loss": 8.239635137023118, "policy_loss": -0.0014435964190553892, "vf_loss": 8.2410367347576, "vf_explained_var": 0.06921393041888242, "kl": 0.0039839419647998905, "entropy": 0.8132927180282653, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 165375.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 352000, "num_env_steps_trained": 352000, "num_agent_steps_sampled": 1408000, "num_agent_steps_trained": 1408000}, "env_runners": {"episode_reward_max": 421.71514779631786, "episode_reward_min": -915.7873886743674, "episode_reward_mean": 100.21473285315146, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1484.7086886223099, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 1699.7792125890055}, "policy_reward_mean": {"prey_policy": -155.29070558041704, "predator_policy": 205.39807200699272}, "custom_metrics": {}, "hist_stats": {"episode_reward": [99.29999999999964, -12.980488036237565, 395.0, 68.56983164486688, 83.50558439040853, 55.19999999999997, 82.64841935464648, 97.29999999999974, 141.79999999999953, 110.29999999999978, 134.2999999999999, 91.00000000000001, 204.93772338168344, 12.999999999999998, 17.850000000000172, 25.400000000000095, 194.49999999999935, 387.0, 152.79999999999933, 17.79363522305318, 57.25331167780425, -7.298557561180488, 21.424323149292782, 189.60000000000005, 341.86700796562843, 61.52808599544346, -93.25536072425182, 20.866331102403212, 65.22474234103696, 324.62321337407025, 35.20000000000023, 156.49569257024206, 396.0, -915.7873886743674, 106.0, 25.200000000000088, 74.38817765436542, 141.7999999999997, 421.71514779631786, 358.2, 217.07115057908086, 336.6041606467007, 389.0, 79.8782433512015, 38.02613542810574, -154.3294123596147, 336.3876999508194, 32.6622070867909, 5.489366400863672, -48.846056095789905, 338.0, 124.39999999999941, 131.77366816662789, 271.93629520746333, 16.29999999999998, -68.66597884122842, 135.65505235658114, 70.3, 29.000000000000142, 101.72683961204618, 394.3, 148.38407821254856, 186.3999999999999, 380.4, 139.17817956749667, -84.56884678732854, 38.80000000000028, 73.7795523438279, 57.89085135543368, 154.76190687586904, -361.67799592438104, 19.900000000000006, 40.4000000000002, 32.60000000000011, 20.600000000000065, 16.98268798856316, 150.10000000000002, 157.2, 106.01114276154932, 159.60846970874172, -66.3345210035437, 198.0, 186.10000000000002, 18.399999999999984, 29.200000000000134, 186.3, 120.89999999999927, 48.0, 58.32891192849348, 28.570962624801396, 4.9403942731545625, 100.53363830358064, 194.5423313012341, -33.10094329842799, -104.41862121657401, 253.25834087741939, -5.3263637812091895, 141.58063140468306, 59.22513672758254, 249.0845569567593], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-52.043857825016055, 18.936427751081425, -469.84807232187984, -463.8423125389415, 193.5762654353972, 195.56634954362895, -135.29793451545547, -498.83096408620213, -223.45836377519413, -42.40886833514705, -469.0123779272912, -222.95989265828428, -96.83560025963126, -171.84282724523672, -27.127752817861722, 3.592420722130942, 40.99632341088583, -5.081230228236862, 12.721726328858852, -92.16919959376364, 67.9855135460783, -497.98827927902323, -690.8081970632088, -75.95918511636398, -43.4966944049499, 131.95229144131315, -916.2124094177086, -270.44558148014437, -47.88496261665022, -12.959234452699652, -3.978930863082199, -1026.3335797783793, 150.564030662773, -97.1794974664457, 174.79361220825706, 197.85545429030594, 59.99020281863163, -11.807663940501811, -56.42120530325404, -119.92334580264612, -107.53978010148245, -239.2463990712916, -328.9286858255174, -229.58907037731663, -201.95269615089185, -420.4217957185434, 173.622625248595, -258.7385187959354, 37.83527150068518, -465.97251834541856, -173.76141176908763, -72.64558362216984, -536.3373391207891, -100.79514789402234, -213.28091323246275, -107.51473114942935, -62.415184200536714, -259.3992628002678, 120.84292631342059, 149.93619214413602, -56.62044758616308, -19.87550672713224, -7.192278211180101, 48.41009263344728, 193.00820853035813, 198.13344209465097, -1484.7086886223099, -1183.635635386952, -474.8631529215492, -28.387541297356634, -53.01694202820654, -447.1023386995911, -229.0576192159159, 18.155263050594346, 34.14703712807855, 7.4975083216713525, -30.413384241989647, -731.1388817368961, 162.67151152201654, 149.40996498882632, 110.97564104618563, -254.73708089076322, 155.17888161537584, 145.4714028454018, 179.8402467366496, 198.07008017913995, -102.74851052748753, -134.74275022556304, -113.21806931059436, -273.3841752723751, -370.395453860487, -209.13100857976772, 144.24400460486325, 137.3966577218477, -277.9656401025575, -39.10872445891952, -275.48347997713694, -155.14654533669218, -398.05694329619945, -218.4482946623095, 180.59423866057642, 84.65048704208318, -5.938514883811049, -41.55363148315483, 18.126851705570477, 1.3897091055809507, -31.29863844625813, -575.4031674328648, -164.8561112100676, -505.3506487188604, -113.63211886007888, -95.35034120979238, -560.4574193272778, 116.03855829310022, -37.71477907251227, -1007.0944632863457, -36.84398921031343, -94.39265526459145, -97.00246297414483, -59.00668196817043, 193.61740069124886, 197.3, 20.000000000000014, -27.842145919570275, 145.71167921725498, -522.6190411611809, 172.68022733973237, 200.0, -100.9885531271439, -269.120838600631, -234.15548991255798, -436.450386777194, 14.123242484059388, 13.313336860078508, -230.33084252991426, -75.44838439036242, -141.62154581184018, -407.85412740067704, -75.89990448589573, 48.87853691236274, -507.46344027170176, -824.1385857556576, 19.03168826888922, -629.9987442747159, -150.0442816413444, -204.01758196768336, 15.700856073420097, -408.44370603153305, -238.53864534072972, -278.95246971308273, -177.66524069945712, -95.10125087503096, -439.95441352067144, 72.17799101085994, 30.167242664698506, -613.6233582001181, -173.0817612759116, -5.226367719947665, -2.9370416858352257, -76.51848131348332, -319.171471553039, -239.97526860409403, 195.68411528422172, -808.9903817645084, -290.9812520163911, 156.8238851983208, -58.08928885369686, -481.6747181507553, 17.29744656932563, -116.9019194002029, 166.98772203801207, -978.2003124047467, -56.24711771008104, -7.856620611954217, -347.68658659235103, -240.83358557337667, -436.5506361185909, 55.977967650582045, -220.57598655145054, -48.44865215109856, -37.23860410944726, -294.2043464826807, -86.6475398034745, -667.2987683548392, 29.1482391037681, 10.908704493975597, -349.1624438267262, -357.3443180721118, -247.38779247078338, -334.17049614695503, 193.57839482608156, -344.27357626707686, -235.58550023499632, -88.1501194027713, -198.81410598998653, 66.28650983393916, -218.91279329164348, -117.06486175166495, 16.21536936877027, 67.71837731286118], "policy_predator_policy_reward": [6.859695815243727, 125.54773425869107, 633.0171488553916, 287.6927479691916, 3.4237345646028112, 2.433650456371062, 496.38268443163184, 206.31604581489265, 0.0, 349.37281650074976, 476.21237792729136, 270.9598926582843, 349.2988827932524, 2.0279640662615863, 105.42775281786172, 15.407579277869022, 82.00367658911411, 23.881230228236934, 166.8781864921852, 22.869286772719544, 58.5144864539217, 505.78827927902444, 690.8081970632088, 166.95918511636407, 61.48676266498467, 54.99536368033644, 916.2124094177086, 283.44558148014437, 75.2182959499838, 3.4759011193662896, 1054.7688659142138, 0.94364472724773, 30.435969337226975, 110.67949746644493, 13.206387791742952, 1.1445457096940646, 8.028321871892357, 96.58913924997799, 161.42923292657042, 32.708953402382576, 91.7791188766887, 312.26037197388956, 399.1090767344767, 152.11012190717662, 264.29003167126444, 379.5087833474629, 10.87737475140502, 263.83851879593556, 365.95815909362767, 404.04609571673444, 294.9933791402071, 12.941702246494021, 536.4021864538987, 7.47493983666092, 4.4284257488379195, 337.23354973545764, 330.15308556206134, 56.88610377978052, 23.31650874567926, 30.527586170834347, 74.62044758616258, 37.07550672713248, 66.05816806663852, 49.219710081337006, 3.9917914696418624, 0.8665579053490272, 1699.7792125890055, 52.777722745888596, 474.8631529215492, 134.38754129735662, 467.8893080790923, 57.42997264870534, 165.95821637198497, 119.33231744770214, 88.85296287192152, 11.302491678328614, 682.0483335233018, 501.2190802519019, 21.328488477983445, 24.79003501117369, 10.004202320723198, 350.82838810293487, 35.95387618592302, 0.0, 10.159753263350403, 0.9299198208600424, 16.198723861355564, 301.1707802428967, 141.27929339794468, 283.3490866131295, 424.1722618468313, 1.024788233808655, 54.747037624108444, 0.0, 54.08666218056613, 295.64990946770183, 111.90242086199174, 324.21697085270125, 450.65247689580184, 117.0067049669169, 10.405761339423591, 62.34951295791691, 113.93851488381097, 57.953631483155064, 34.4499462456111, 77.80716110986583, 438.62625682463045, 440.0118442619568, 172.1561112100672, 514.3506487188605, 23.336280967674142, 116.98020026096859, 563.7574193272785, 16.316494063481056, 108.0147790725123, 1007.0944632863457, 54.14398921031368, 106.09265526459163, 51.68499329138146, 206.0509912629797, 0.0, 3.382599308751148, 16.036673004508764, 140.18955112761057, 33.28832078274502, 530.019041161181, 7.7197726602676235, 0.0, 189.20157806550304, 320.0859932297682, 478.22194659079616, 107.81508331162823, 5.276757515940578, 6.086663139921457, 173.92659629087962, 205.63218297322427, 184.5692170077244, 422.7973075602265, 111.37595906579867, 70.40731538360366, 72.58134927340073, 897.3426808295768, 0.8683117311107852, 629.9987442747159, 164.4442816413436, 230.01758196768336, 3.899143926579866, 421.44370603153305, 257.53864534072966, 280.55246971308304, 101.8751324832475, 187.87404707980383, 440.05441352067146, 77.82200898914004, 95.8327573353015, 644.8233582001182, 239.93919981194153, 44.38007194546704, 225.86919510635565, 13.194797601704575, 257.19873576195687, 235.61348339163249, 2.315884715778287, 808.9903817645084, 296.0812520163911, 24.17611480167921, 75.4892888536963, 482.6747181507553, 120.42455127846739, 8.379921552409295, 18.012277961987923, 979.5003124047468, 1.637755896145655, 183.3659824258896, 347.68658659235103, 288.8335855733764, 436.5506361185909, 2.3509442779114247, 233.47598655145026, 64.11961477589996, 31.224584116295798, 305.1587607489869, 203.68022754776985, 650.7997189141248, 4.921181195820333, 149.56420650767004, 309.5696053382527, 363.83621326215723, 118.88886194779909, 358.25080545336436, 339.1217933655644, 64.83172895285043, 30.2335131021134, 288.1757427544446, 24.636467638882113, 249.47175992184816, 189.04220611132817, 206.1605856595622, 43.488628584563614, 121.66218169056424]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1120049582218683, "mean_inference_ms": 3.3439565929278685, "mean_action_processing_ms": 1.5759786637160296, "mean_env_wait_ms": 0.6398285896084759, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004149675369262695, "StateBufferConnector_ms": 0.0034302473068237305, "ViewRequirementAgentConnector_ms": 0.100189208984375}, "num_episodes": 18, "episode_return_max": 421.71514779631786, "episode_return_min": -915.7873886743674, "episode_return_mean": 100.21473285315146, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1408000, "num_agent_steps_trained": 1408000, "num_env_steps_sampled": 352000, "num_env_steps_trained": 352000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 84.78784793979149, "num_env_steps_trained_throughput_per_sec": 84.78784793979149, "timesteps_total": 352000, "num_env_steps_sampled_lifetime": 352000, "num_agent_steps_sampled_lifetime": 1408000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1408000, "timers": {"training_iteration_time_ms": 47199.639, "restore_workers_time_ms": 0.013, "training_step_time_ms": 47199.556, "sample_time_ms": 1157.153, "learn_time_ms": 46022.286, "learn_throughput": 86.914, "synch_weights_time_ms": 14.485}, "counters": {"num_env_steps_sampled": 352000, "num_env_steps_trained": 352000, "num_agent_steps_sampled": 1408000, "num_agent_steps_trained": 1408000}, "done": false, "training_iteration": 88, "trial_id": "cf3bb_00000", "date": "2024-08-20_09-56-23", "timestamp": 1724127983, "time_this_iter_s": 47.2270929813385, "time_total_s": 12245.698981285095, "pid": 25777, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39fcc8d30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 12245.698981285095, "iterations_since_restore": 88, "perf": {"cpu_util_percent": 32.77462686567164, "ram_util_percent": 81.14029850746269}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7565878328349855, "cur_kl_coeff": 0.0014078378677368163, "cur_lr": 0.00010000000000000003, "total_loss": 7.058647160050731, "policy_loss": -0.0030314692456235802, "vf_loss": 7.061672350969264, "vf_explained_var": 0.0005002106623674826, "kl": 0.0044550347584431296, "entropy": 0.5837632314868705, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 167265.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 16.713424025578473, "cur_kl_coeff": 0.0052734375, "cur_lr": 0.00010000000000000003, "total_loss": 7.847524202689923, "policy_loss": -0.0022979310355223125, "vf_loss": 7.849786127433575, "vf_explained_var": 0.060177757658024945, "kl": 0.0068287331601092046, "entropy": 0.7935612516743796, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 167265.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 356000, "num_env_steps_trained": 356000, "num_agent_steps_sampled": 1424000, "num_agent_steps_trained": 1424000}, "env_runners": {"episode_reward_max": 421.71514779631786, "episode_reward_min": -915.7873886743674, "episode_reward_mean": 92.96207642266614, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1484.7086886223099, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 1699.7792125890055}, "policy_reward_mean": {"prey_policy": -161.06774537861784, "predator_policy": 207.54878358995092}, "custom_metrics": {}, "hist_stats": {"episode_reward": [21.424323149292782, 189.60000000000005, 341.86700796562843, 61.52808599544346, -93.25536072425182, 20.866331102403212, 65.22474234103696, 324.62321337407025, 35.20000000000023, 156.49569257024206, 396.0, -915.7873886743674, 106.0, 25.200000000000088, 74.38817765436542, 141.7999999999997, 421.71514779631786, 358.2, 217.07115057908086, 336.6041606467007, 389.0, 79.8782433512015, 38.02613542810574, -154.3294123596147, 336.3876999508194, 32.6622070867909, 5.489366400863672, -48.846056095789905, 338.0, 124.39999999999941, 131.77366816662789, 271.93629520746333, 16.29999999999998, -68.66597884122842, 135.65505235658114, 70.3, 29.000000000000142, 101.72683961204618, 394.3, 148.38407821254856, 186.3999999999999, 380.4, 139.17817956749667, -84.56884678732854, 38.80000000000028, 73.7795523438279, 57.89085135543368, 154.76190687586904, -361.67799592438104, 19.900000000000006, 40.4000000000002, 32.60000000000011, 20.600000000000065, 16.98268798856316, 150.10000000000002, 157.2, 106.01114276154932, 159.60846970874172, -66.3345210035437, 198.0, 186.10000000000002, 18.399999999999984, 29.200000000000134, 186.3, 120.89999999999927, 48.0, 58.32891192849348, 28.570962624801396, 4.9403942731545625, 100.53363830358064, 194.5423313012341, -33.10094329842799, -104.41862121657401, 253.25834087741939, -5.3263637812091895, 141.58063140468306, 59.22513672758254, 249.0845569567593, 22.107695277109066, 156.19999999999925, -46.970580603141656, 142.73517454417694, 11.528357854734871, -69.39747129763194, 95.9, 45.00000000000003, 131.24552763963084, 140.27050563134836, -306.0296024753268, 270.63011941207935, -109.1588489219, 341.0642983737574, 200.09999999999928, 167.69999999999928, 142.50764830071387, 69.50976298470844, 385.0, -254.43989103066886, 250.5, -102.08887866307697], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-201.95269615089185, -420.4217957185434, 173.622625248595, -258.7385187959354, 37.83527150068518, -465.97251834541856, -173.76141176908763, -72.64558362216984, -536.3373391207891, -100.79514789402234, -213.28091323246275, -107.51473114942935, -62.415184200536714, -259.3992628002678, 120.84292631342059, 149.93619214413602, -56.62044758616308, -19.87550672713224, -7.192278211180101, 48.41009263344728, 193.00820853035813, 198.13344209465097, -1484.7086886223099, -1183.635635386952, -474.8631529215492, -28.387541297356634, -53.01694202820654, -447.1023386995911, -229.0576192159159, 18.155263050594346, 34.14703712807855, 7.4975083216713525, -30.413384241989647, -731.1388817368961, 162.67151152201654, 149.40996498882632, 110.97564104618563, -254.73708089076322, 155.17888161537584, 145.4714028454018, 179.8402467366496, 198.07008017913995, -102.74851052748753, -134.74275022556304, -113.21806931059436, -273.3841752723751, -370.395453860487, -209.13100857976772, 144.24400460486325, 137.3966577218477, -277.9656401025575, -39.10872445891952, -275.48347997713694, -155.14654533669218, -398.05694329619945, -218.4482946623095, 180.59423866057642, 84.65048704208318, -5.938514883811049, -41.55363148315483, 18.126851705570477, 1.3897091055809507, -31.29863844625813, -575.4031674328648, -164.8561112100676, -505.3506487188604, -113.63211886007888, -95.35034120979238, -560.4574193272778, 116.03855829310022, -37.71477907251227, -1007.0944632863457, -36.84398921031343, -94.39265526459145, -97.00246297414483, -59.00668196817043, 193.61740069124886, 197.3, 20.000000000000014, -27.842145919570275, 145.71167921725498, -522.6190411611809, 172.68022733973237, 200.0, -100.9885531271439, -269.120838600631, -234.15548991255798, -436.450386777194, 14.123242484059388, 13.313336860078508, -230.33084252991426, -75.44838439036242, -141.62154581184018, -407.85412740067704, -75.89990448589573, 48.87853691236274, -507.46344027170176, -824.1385857556576, 19.03168826888922, -629.9987442747159, -150.0442816413444, -204.01758196768336, 15.700856073420097, -408.44370603153305, -238.53864534072972, -278.95246971308273, -177.66524069945712, -95.10125087503096, -439.95441352067144, 72.17799101085994, 30.167242664698506, -613.6233582001181, -173.0817612759116, -5.226367719947665, -2.9370416858352257, -76.51848131348332, -319.171471553039, -239.97526860409403, 195.68411528422172, -808.9903817645084, -290.9812520163911, 156.8238851983208, -58.08928885369686, -481.6747181507553, 17.29744656932563, -116.9019194002029, 166.98772203801207, -978.2003124047467, -56.24711771008104, -7.856620611954217, -347.68658659235103, -240.83358557337667, -436.5506361185909, 55.977967650582045, -220.57598655145054, -48.44865215109856, -37.23860410944726, -294.2043464826807, -86.6475398034745, -667.2987683548392, 29.1482391037681, 10.908704493975597, -349.1624438267262, -357.3443180721118, -247.38779247078338, -334.17049614695503, 193.57839482608156, -344.27357626707686, -235.58550023499632, -88.1501194027713, -198.81410598998653, 66.28650983393916, -218.91279329164348, -117.06486175166495, 16.21536936877027, 67.71837731286118, -45.50508364926877, -338.17751617028927, 7.735745330286604, -34.87473579744847, -607.98196085806, -249.42007128675772, -225.72021691741924, 78.37268493844823, -486.38629416143823, -686.8205972380689, -307.4355289033004, -188.59176702236527, 0.8266444598155402, -529.2129380818205, -21.71382840449725, -340.49371930274407, -11.55749254927043, -354.89498688617766, -40.74033678360237, -19.820222175490855, -1064.5242709469537, -587.132250422103, 85.17480752036526, 27.62643021385311, -147.52707985761475, -440.3582704550505, 154.9583770749298, 129.3607891175197, 163.73565835200088, 0.8672350600529949, 30.942081231546062, 13.988183919113089, -170.10439391229747, -93.36957491546363, -288.83333858205594, -19.737364795193898, 185.44503512430336, 183.64771477177277, -433.77165208360714, -360.2212760885875, 90.92781729557117, -27.748641851279643, -339.4878981499513, -345.7851941310282], "policy_predator_policy_reward": [264.29003167126444, 379.5087833474629, 10.87737475140502, 263.83851879593556, 365.95815909362767, 404.04609571673444, 294.9933791402071, 12.941702246494021, 536.4021864538987, 7.47493983666092, 4.4284257488379195, 337.23354973545764, 330.15308556206134, 56.88610377978052, 23.31650874567926, 30.527586170834347, 74.62044758616258, 37.07550672713248, 66.05816806663852, 49.219710081337006, 3.9917914696418624, 0.8665579053490272, 1699.7792125890055, 52.777722745888596, 474.8631529215492, 134.38754129735662, 467.8893080790923, 57.42997264870534, 165.95821637198497, 119.33231744770214, 88.85296287192152, 11.302491678328614, 682.0483335233018, 501.2190802519019, 21.328488477983445, 24.79003501117369, 10.004202320723198, 350.82838810293487, 35.95387618592302, 0.0, 10.159753263350403, 0.9299198208600424, 16.198723861355564, 301.1707802428967, 141.27929339794468, 283.3490866131295, 424.1722618468313, 1.024788233808655, 54.747037624108444, 0.0, 54.08666218056613, 295.64990946770183, 111.90242086199174, 324.21697085270125, 450.65247689580184, 117.0067049669169, 10.405761339423591, 62.34951295791691, 113.93851488381097, 57.953631483155064, 34.4499462456111, 77.80716110986583, 438.62625682463045, 440.0118442619568, 172.1561112100672, 514.3506487188605, 23.336280967674142, 116.98020026096859, 563.7574193272785, 16.316494063481056, 108.0147790725123, 1007.0944632863457, 54.14398921031368, 106.09265526459163, 51.68499329138146, 206.0509912629797, 0.0, 3.382599308751148, 16.036673004508764, 140.18955112761057, 33.28832078274502, 530.019041161181, 7.7197726602676235, 0.0, 189.20157806550304, 320.0859932297682, 478.22194659079616, 107.81508331162823, 5.276757515940578, 6.086663139921457, 173.92659629087962, 205.63218297322427, 184.5692170077244, 422.7973075602265, 111.37595906579867, 70.40731538360366, 72.58134927340073, 897.3426808295768, 0.8683117311107852, 629.9987442747159, 164.4442816413436, 230.01758196768336, 3.899143926579866, 421.44370603153305, 257.53864534072966, 280.55246971308304, 101.8751324832475, 187.87404707980383, 440.05441352067146, 77.82200898914004, 95.8327573353015, 644.8233582001182, 239.93919981194153, 44.38007194546704, 225.86919510635565, 13.194797601704575, 257.19873576195687, 235.61348339163249, 2.315884715778287, 808.9903817645084, 296.0812520163911, 24.17611480167921, 75.4892888536963, 482.6747181507553, 120.42455127846739, 8.379921552409295, 18.012277961987923, 979.5003124047468, 1.637755896145655, 183.3659824258896, 347.68658659235103, 288.8335855733764, 436.5506361185909, 2.3509442779114247, 233.47598655145026, 64.11961477589996, 31.224584116295798, 305.1587607489869, 203.68022754776985, 650.7997189141248, 4.921181195820333, 149.56420650767004, 309.5696053382527, 363.83621326215723, 118.88886194779909, 358.25080545336436, 339.1217933655644, 64.83172895285043, 30.2335131021134, 288.1757427544446, 24.636467638882113, 249.47175992184816, 189.04220611132817, 206.1605856595622, 43.488628584563614, 121.66218169056424, 62.159164334597804, 343.6311307620692, 13.685404035901714, 169.65358643126024, 589.8212353042051, 220.61021623747106, 195.34116333698876, 94.7415431861592, 332.3069051220556, 852.4283441321867, 119.89031521675322, 306.7395094112806, 95.07335554018461, 529.2129380818205, 38.71382840449749, 368.49371930274407, 203.19294473707626, 294.5050623380038, 152.49623306265033, 48.334831527792126, 1218.7928518039669, 126.83406708976318, 62.501745220841194, 95.32713645701976, 29.00893435683175, 449.7175670339331, 56.745132181307845, 0.0, 18.26434164799921, 17.232764939946982, 1.0660579675185684, 121.70367688182222, 200.5488462998193, 205.43277082865532, 353.81048882129323, 24.269977540664577, 13.424065216231195, 2.4831848876926688, 508.1733907144186, 31.379646427106714, 23.572182704428936, 163.7486418512796, 232.1398114252894, 351.0444021926131]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1060232275206807, "mean_inference_ms": 3.2762710109050746, "mean_action_processing_ms": 1.6001327017165639, "mean_env_wait_ms": 0.6348524039892106, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004051923751831055, "StateBufferConnector_ms": 0.003375411033630371, "ViewRequirementAgentConnector_ms": 0.09952259063720703}, "num_episodes": 22, "episode_return_max": 421.71514779631786, "episode_return_min": -915.7873886743674, "episode_return_mean": 92.96207642266614, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1424000, "num_agent_steps_trained": 1424000, "num_env_steps_sampled": 356000, "num_env_steps_trained": 356000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 84.42955643193461, "num_env_steps_trained_throughput_per_sec": 84.42955643193461, "timesteps_total": 356000, "num_env_steps_sampled_lifetime": 356000, "num_agent_steps_sampled_lifetime": 1424000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1424000, "timers": {"training_iteration_time_ms": 47200.243, "restore_workers_time_ms": 0.013, "training_step_time_ms": 47200.164, "sample_time_ms": 1151.344, "learn_time_ms": 46026.584, "learn_throughput": 86.906, "synch_weights_time_ms": 16.533}, "counters": {"num_env_steps_sampled": 356000, "num_env_steps_trained": 356000, "num_agent_steps_sampled": 1424000, "num_agent_steps_trained": 1424000}, "done": false, "training_iteration": 89, "trial_id": "cf3bb_00000", "date": "2024-08-20_09-57-11", "timestamp": 1724128031, "time_this_iter_s": 47.4315242767334, "time_total_s": 12293.130505561829, "pid": 25777, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39fe383a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 12293.130505561829, "iterations_since_restore": 89, "perf": {"cpu_util_percent": 32.41791044776119, "ram_util_percent": 81.47462686567164}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6860840995318045, "cur_kl_coeff": 0.0007039189338684082, "cur_lr": 0.00010000000000000003, "total_loss": 7.716441564711314, "policy_loss": -0.0001550741222682138, "vf_loss": 7.716595439305381, "vf_explained_var": 0.0015088667314519326, "kl": 0.0016970404760903411, "entropy": 0.6460855407374245, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 169155.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 14.723062527621234, "cur_kl_coeff": 0.0052734375, "cur_lr": 0.00010000000000000003, "total_loss": 8.55855970458379, "policy_loss": -0.0027646243601800904, "vf_loss": 8.561285127659954, "vf_explained_var": 0.10423907385301337, "kl": 0.007433174991852357, "entropy": 0.7841333887249073, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 169155.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_agent_steps_sampled": 1440000, "num_agent_steps_trained": 1440000}, "env_runners": {"episode_reward_max": 461.06330490865906, "episode_reward_min": -361.67799592438104, "episode_reward_mean": 98.2978890911295, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1064.5242709469537, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 1218.7928518039669}, "policy_reward_mean": {"prey_policy": -168.39948129878377, "predator_policy": 217.54842584434854}, "custom_metrics": {}, "hist_stats": {"episode_reward": [217.07115057908086, 336.6041606467007, 389.0, 79.8782433512015, 38.02613542810574, -154.3294123596147, 336.3876999508194, 32.6622070867909, 5.489366400863672, -48.846056095789905, 338.0, 124.39999999999941, 131.77366816662789, 271.93629520746333, 16.29999999999998, -68.66597884122842, 135.65505235658114, 70.3, 29.000000000000142, 101.72683961204618, 394.3, 148.38407821254856, 186.3999999999999, 380.4, 139.17817956749667, -84.56884678732854, 38.80000000000028, 73.7795523438279, 57.89085135543368, 154.76190687586904, -361.67799592438104, 19.900000000000006, 40.4000000000002, 32.60000000000011, 20.600000000000065, 16.98268798856316, 150.10000000000002, 157.2, 106.01114276154932, 159.60846970874172, -66.3345210035437, 198.0, 186.10000000000002, 18.399999999999984, 29.200000000000134, 186.3, 120.89999999999927, 48.0, 58.32891192849348, 28.570962624801396, 4.9403942731545625, 100.53363830358064, 194.5423313012341, -33.10094329842799, -104.41862121657401, 253.25834087741939, -5.3263637812091895, 141.58063140468306, 59.22513672758254, 249.0845569567593, 22.107695277109066, 156.19999999999925, -46.970580603141656, 142.73517454417694, 11.528357854734871, -69.39747129763194, 95.9, 45.00000000000003, 131.24552763963084, 140.27050563134836, -306.0296024753268, 270.63011941207935, -109.1588489219, 341.0642983737574, 200.09999999999928, 167.69999999999928, 142.50764830071387, 69.50976298470844, 385.0, -254.43989103066886, 250.5, -102.08887866307697, 173.6, 96.0076623962982, 127.26971968301409, 169.59999999999977, 206.91880841439703, 80.60265548068097, 144.20226610216739, -1.7155393762348699, 78.39999999999998, 20.324643749636813, 461.06330490865906, 265.27526373494715, 73.4000000000002, 200.3, -67.79748241582999, 29.41993671878239, 39.5, 168.29999999999998], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [110.97564104618563, -254.73708089076322, 155.17888161537584, 145.4714028454018, 179.8402467366496, 198.07008017913995, -102.74851052748753, -134.74275022556304, -113.21806931059436, -273.3841752723751, -370.395453860487, -209.13100857976772, 144.24400460486325, 137.3966577218477, -277.9656401025575, -39.10872445891952, -275.48347997713694, -155.14654533669218, -398.05694329619945, -218.4482946623095, 180.59423866057642, 84.65048704208318, -5.938514883811049, -41.55363148315483, 18.126851705570477, 1.3897091055809507, -31.29863844625813, -575.4031674328648, -164.8561112100676, -505.3506487188604, -113.63211886007888, -95.35034120979238, -560.4574193272778, 116.03855829310022, -37.71477907251227, -1007.0944632863457, -36.84398921031343, -94.39265526459145, -97.00246297414483, -59.00668196817043, 193.61740069124886, 197.3, 20.000000000000014, -27.842145919570275, 145.71167921725498, -522.6190411611809, 172.68022733973237, 200.0, -100.9885531271439, -269.120838600631, -234.15548991255798, -436.450386777194, 14.123242484059388, 13.313336860078508, -230.33084252991426, -75.44838439036242, -141.62154581184018, -407.85412740067704, -75.89990448589573, 48.87853691236274, -507.46344027170176, -824.1385857556576, 19.03168826888922, -629.9987442747159, -150.0442816413444, -204.01758196768336, 15.700856073420097, -408.44370603153305, -238.53864534072972, -278.95246971308273, -177.66524069945712, -95.10125087503096, -439.95441352067144, 72.17799101085994, 30.167242664698506, -613.6233582001181, -173.0817612759116, -5.226367719947665, -2.9370416858352257, -76.51848131348332, -319.171471553039, -239.97526860409403, 195.68411528422172, -808.9903817645084, -290.9812520163911, 156.8238851983208, -58.08928885369686, -481.6747181507553, 17.29744656932563, -116.9019194002029, 166.98772203801207, -978.2003124047467, -56.24711771008104, -7.856620611954217, -347.68658659235103, -240.83358557337667, -436.5506361185909, 55.977967650582045, -220.57598655145054, -48.44865215109856, -37.23860410944726, -294.2043464826807, -86.6475398034745, -667.2987683548392, 29.1482391037681, 10.908704493975597, -349.1624438267262, -357.3443180721118, -247.38779247078338, -334.17049614695503, 193.57839482608156, -344.27357626707686, -235.58550023499632, -88.1501194027713, -198.81410598998653, 66.28650983393916, -218.91279329164348, -117.06486175166495, 16.21536936877027, 67.71837731286118, -45.50508364926877, -338.17751617028927, 7.735745330286604, -34.87473579744847, -607.98196085806, -249.42007128675772, -225.72021691741924, 78.37268493844823, -486.38629416143823, -686.8205972380689, -307.4355289033004, -188.59176702236527, 0.8266444598155402, -529.2129380818205, -21.71382840449725, -340.49371930274407, -11.55749254927043, -354.89498688617766, -40.74033678360237, -19.820222175490855, -1064.5242709469537, -587.132250422103, 85.17480752036526, 27.62643021385311, -147.52707985761475, -440.3582704550505, 154.9583770749298, 129.3607891175197, 163.73565835200088, 0.8672350600529949, 30.942081231546062, 13.988183919113089, -170.10439391229747, -93.36957491546363, -288.83333858205594, -19.737364795193898, 185.44503512430336, 183.64771477177277, -433.77165208360714, -360.2212760885875, 90.92781729557117, -27.748641851279643, -339.4878981499513, -345.7851941310282, 158.92009602994028, -886.1652367955716, -327.6362545072313, -114.45283645181567, -50.79866745762842, -255.7434095413912, 131.68038847527473, -433.4081641442841, 34.62111056115455, 79.98800516450095, -378.7823363079479, -157.07017747504023, -332.33314918081425, -18.01109011697193, -696.534079194756, -174.12207074376715, -411.2746998964989, -312.0084377473125, -39.84171747895486, -229.72706040517852, 51.93448708512348, -563.4664585292448, -813.1154351871812, 20.000000000000014, 12.19934843153379, -141.47144520895793, 200.0, -347.5112322580103, -284.7970468318931, -385.28195382486666, -175.175134426658, -47.20361368107813, -230.63679365893353, -457.5960685588127, -194.332269896563, -22.77125627165823], "policy_predator_policy_reward": [10.004202320723198, 350.82838810293487, 35.95387618592302, 0.0, 10.159753263350403, 0.9299198208600424, 16.198723861355564, 301.1707802428967, 141.27929339794468, 283.3490866131295, 424.1722618468313, 1.024788233808655, 54.747037624108444, 0.0, 54.08666218056613, 295.64990946770183, 111.90242086199174, 324.21697085270125, 450.65247689580184, 117.0067049669169, 10.405761339423591, 62.34951295791691, 113.93851488381097, 57.953631483155064, 34.4499462456111, 77.80716110986583, 438.62625682463045, 440.0118442619568, 172.1561112100672, 514.3506487188605, 23.336280967674142, 116.98020026096859, 563.7574193272785, 16.316494063481056, 108.0147790725123, 1007.0944632863457, 54.14398921031368, 106.09265526459163, 51.68499329138146, 206.0509912629797, 0.0, 3.382599308751148, 16.036673004508764, 140.18955112761057, 33.28832078274502, 530.019041161181, 7.7197726602676235, 0.0, 189.20157806550304, 320.0859932297682, 478.22194659079616, 107.81508331162823, 5.276757515940578, 6.086663139921457, 173.92659629087962, 205.63218297322427, 184.5692170077244, 422.7973075602265, 111.37595906579867, 70.40731538360366, 72.58134927340073, 897.3426808295768, 0.8683117311107852, 629.9987442747159, 164.4442816413436, 230.01758196768336, 3.899143926579866, 421.44370603153305, 257.53864534072966, 280.55246971308304, 101.8751324832475, 187.87404707980383, 440.05441352067146, 77.82200898914004, 95.8327573353015, 644.8233582001182, 239.93919981194153, 44.38007194546704, 225.86919510635565, 13.194797601704575, 257.19873576195687, 235.61348339163249, 2.315884715778287, 808.9903817645084, 296.0812520163911, 24.17611480167921, 75.4892888536963, 482.6747181507553, 120.42455127846739, 8.379921552409295, 18.012277961987923, 979.5003124047468, 1.637755896145655, 183.3659824258896, 347.68658659235103, 288.8335855733764, 436.5506361185909, 2.3509442779114247, 233.47598655145026, 64.11961477589996, 31.224584116295798, 305.1587607489869, 203.68022754776985, 650.7997189141248, 4.921181195820333, 149.56420650767004, 309.5696053382527, 363.83621326215723, 118.88886194779909, 358.25080545336436, 339.1217933655644, 64.83172895285043, 30.2335131021134, 288.1757427544446, 24.636467638882113, 249.47175992184816, 189.04220611132817, 206.1605856595622, 43.488628584563614, 121.66218169056424, 62.159164334597804, 343.6311307620692, 13.685404035901714, 169.65358643126024, 589.8212353042051, 220.61021623747106, 195.34116333698876, 94.7415431861592, 332.3069051220556, 852.4283441321867, 119.89031521675322, 306.7395094112806, 95.07335554018461, 529.2129380818205, 38.71382840449749, 368.49371930274407, 203.19294473707626, 294.5050623380038, 152.49623306265033, 48.334831527792126, 1218.7928518039669, 126.83406708976318, 62.501745220841194, 95.32713645701976, 29.00893435683175, 449.7175670339331, 56.745132181307845, 0.0, 18.26434164799921, 17.232764939946982, 1.0660579675185684, 121.70367688182222, 200.5488462998193, 205.43277082865532, 353.81048882129323, 24.269977540664577, 13.424065216231195, 2.4831848876926688, 508.1733907144186, 31.379646427106714, 23.572182704428936, 163.7486418512796, 232.1398114252894, 351.0444021926131, 14.679903970059721, 886.1652367955716, 446.4696197187831, 91.62713363656218, 272.61877002181143, 161.19302666022253, 33.41961152472531, 437.9081641442851, 26.29769785324291, 66.01199483549898, 233.90610118718746, 382.54906807648143, 212.89838027614377, 281.64812512381036, 707.5427068714296, 161.39790369085853, 90.65373265263338, 711.0294049911784, 178.09180115362514, 111.80162048014465, 443.1351386336432, 529.4601377191376, 690.8406048417452, 367.55009408038234, 183.80634058113813, 18.865756196285908, 0.0, 347.8112322580103, 168.22215272611038, 434.0593655148212, 250.93236989323225, 0.8663149332864403, 266.6367936589336, 461.0960685588127, 255.3322698965633, 130.07125627165826]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1036691891283439, "mean_inference_ms": 3.303648733992657, "mean_action_processing_ms": 1.5477266164201229, "mean_env_wait_ms": 0.6313417093505918, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003932476043701172, "StateBufferConnector_ms": 0.0034165382385253906, "ViewRequirementAgentConnector_ms": 0.12981164455413818}, "num_episodes": 18, "episode_return_max": 461.06330490865906, "episode_return_min": -361.67799592438104, "episode_return_mean": 98.2978890911295, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1440000, "num_agent_steps_trained": 1440000, "num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 76.96044566593223, "num_env_steps_trained_throughput_per_sec": 76.96044566593223, "timesteps_total": 360000, "num_env_steps_sampled_lifetime": 360000, "num_agent_steps_sampled_lifetime": 1440000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1440000, "timers": {"training_iteration_time_ms": 47714.324, "restore_workers_time_ms": 0.014, "training_step_time_ms": 47714.236, "sample_time_ms": 1380.171, "learn_time_ms": 46309.301, "learn_throughput": 86.376, "synch_weights_time_ms": 18.509}, "counters": {"num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_agent_steps_sampled": 1440000, "num_agent_steps_trained": 1440000}, "done": false, "training_iteration": 90, "trial_id": "cf3bb_00000", "date": "2024-08-20_09-58-03", "timestamp": 1724128083, "time_this_iter_s": 52.04300093650818, "time_total_s": 12345.173506498337, "pid": 25777, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39fcb9790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 12345.173506498337, "iterations_since_restore": 90, "perf": {"cpu_util_percent": 45.462162162162166, "ram_util_percent": 80.87567567567568}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9279718685638968, "cur_kl_coeff": 0.0003519594669342041, "cur_lr": 0.00010000000000000003, "total_loss": 6.8616236913771855, "policy_loss": -0.0016170343172258485, "vf_loss": 6.863239397826018, "vf_explained_var": 0.0043628508767122945, "kl": 0.0036806012943788368, "entropy": 0.6507210534401041, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 171045.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 16.7652316884389, "cur_kl_coeff": 0.0052734375, "cur_lr": 0.00010000000000000003, "total_loss": 8.017970689642366, "policy_loss": -0.002311910414900729, "vf_loss": 8.02025101424525, "vf_explained_var": 0.046774807146617345, "kl": 0.005989203536916296, "entropy": 0.7950431754349401, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 171045.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 364000, "num_env_steps_trained": 364000, "num_agent_steps_sampled": 1456000, "num_agent_steps_trained": 1456000}, "env_runners": {"episode_reward_max": 461.06330490865906, "episode_reward_min": -361.67799592438104, "episode_reward_mean": 99.60063539917957, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1272.5539820671302, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 1272.5539820671302}, "policy_reward_mean": {"prey_policy": -186.56685835644706, "predator_policy": 236.36717605603684}, "custom_metrics": {}, "hist_stats": {"episode_reward": [380.4, 139.17817956749667, -84.56884678732854, 38.80000000000028, 73.7795523438279, 57.89085135543368, 154.76190687586904, -361.67799592438104, 19.900000000000006, 40.4000000000002, 32.60000000000011, 20.600000000000065, 16.98268798856316, 150.10000000000002, 157.2, 106.01114276154932, 159.60846970874172, -66.3345210035437, 198.0, 186.10000000000002, 18.399999999999984, 29.200000000000134, 186.3, 120.89999999999927, 48.0, 58.32891192849348, 28.570962624801396, 4.9403942731545625, 100.53363830358064, 194.5423313012341, -33.10094329842799, -104.41862121657401, 253.25834087741939, -5.3263637812091895, 141.58063140468306, 59.22513672758254, 249.0845569567593, 22.107695277109066, 156.19999999999925, -46.970580603141656, 142.73517454417694, 11.528357854734871, -69.39747129763194, 95.9, 45.00000000000003, 131.24552763963084, 140.27050563134836, -306.0296024753268, 270.63011941207935, -109.1588489219, 341.0642983737574, 200.09999999999928, 167.69999999999928, 142.50764830071387, 69.50976298470844, 385.0, -254.43989103066886, 250.5, -102.08887866307697, 173.6, 96.0076623962982, 127.26971968301409, 169.59999999999977, 206.91880841439703, 80.60265548068097, 144.20226610216739, -1.7155393762348699, 78.39999999999998, 20.324643749636813, 461.06330490865906, 265.27526373494715, 73.4000000000002, 200.3, -67.79748241582999, 29.41993671878239, 39.5, 168.29999999999998, 396.04247951772345, 185.000179117077, 394.0, 212.08309417229555, 20.73552048312325, 99.32217971313302, 30.068859845140196, -71.08662834655861, 157.6, 49.0, 91.561934723108, 100.96219155217965, 378.2, 171.28806826286552, 38.71852248969779, 93.98957041706493, 47.50000000000015, -8.199301098606815, 240.49791700058216, 278.4124757950109, 27.431016863366928, 196.4999999999994, 112.1000000000002], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [172.68022733973237, 200.0, -100.9885531271439, -269.120838600631, -234.15548991255798, -436.450386777194, 14.123242484059388, 13.313336860078508, -230.33084252991426, -75.44838439036242, -141.62154581184018, -407.85412740067704, -75.89990448589573, 48.87853691236274, -507.46344027170176, -824.1385857556576, 19.03168826888922, -629.9987442747159, -150.0442816413444, -204.01758196768336, 15.700856073420097, -408.44370603153305, -238.53864534072972, -278.95246971308273, -177.66524069945712, -95.10125087503096, -439.95441352067144, 72.17799101085994, 30.167242664698506, -613.6233582001181, -173.0817612759116, -5.226367719947665, -2.9370416858352257, -76.51848131348332, -319.171471553039, -239.97526860409403, 195.68411528422172, -808.9903817645084, -290.9812520163911, 156.8238851983208, -58.08928885369686, -481.6747181507553, 17.29744656932563, -116.9019194002029, 166.98772203801207, -978.2003124047467, -56.24711771008104, -7.856620611954217, -347.68658659235103, -240.83358557337667, -436.5506361185909, 55.977967650582045, -220.57598655145054, -48.44865215109856, -37.23860410944726, -294.2043464826807, -86.6475398034745, -667.2987683548392, 29.1482391037681, 10.908704493975597, -349.1624438267262, -357.3443180721118, -247.38779247078338, -334.17049614695503, 193.57839482608156, -344.27357626707686, -235.58550023499632, -88.1501194027713, -198.81410598998653, 66.28650983393916, -218.91279329164348, -117.06486175166495, 16.21536936877027, 67.71837731286118, -45.50508364926877, -338.17751617028927, 7.735745330286604, -34.87473579744847, -607.98196085806, -249.42007128675772, -225.72021691741924, 78.37268493844823, -486.38629416143823, -686.8205972380689, -307.4355289033004, -188.59176702236527, 0.8266444598155402, -529.2129380818205, -21.71382840449725, -340.49371930274407, -11.55749254927043, -354.89498688617766, -40.74033678360237, -19.820222175490855, -1064.5242709469537, -587.132250422103, 85.17480752036526, 27.62643021385311, -147.52707985761475, -440.3582704550505, 154.9583770749298, 129.3607891175197, 163.73565835200088, 0.8672350600529949, 30.942081231546062, 13.988183919113089, -170.10439391229747, -93.36957491546363, -288.83333858205594, -19.737364795193898, 185.44503512430336, 183.64771477177277, -433.77165208360714, -360.2212760885875, 90.92781729557117, -27.748641851279643, -339.4878981499513, -345.7851941310282, 158.92009602994028, -886.1652367955716, -327.6362545072313, -114.45283645181567, -50.79866745762842, -255.7434095413912, 131.68038847527473, -433.4081641442841, 34.62111056115455, 79.98800516450095, -378.7823363079479, -157.07017747504023, -332.33314918081425, -18.01109011697193, -696.534079194756, -174.12207074376715, -411.2746998964989, -312.0084377473125, -39.84171747895486, -229.72706040517852, 51.93448708512348, -563.4664585292448, -813.1154351871812, 20.000000000000014, 12.19934843153379, -141.47144520895793, 200.0, -347.5112322580103, -284.7970468318931, -385.28195382486666, -175.175134426658, -47.20361368107813, -230.63679365893353, -457.5960685588127, -194.332269896563, -22.77125627165823, 198.04247951772345, 195.9441943679368, -185.78066022875763, -1.110192210956223, 195.27895051383035, 189.15887853479174, -101.39903974000848, 112.08309417229523, -390.43393389383306, -197.9995235686182, 0.36168387276899505, -266.4293579855226, -451.45131512690654, -231.3732651101086, -425.45306526091446, -324.7362311148423, 111.54880360935095, -1272.5539820671302, -719.5154242029363, -222.07041975944924, -339.84949514257954, -110.9554518037124, -381.9057125074413, -539.1521234388247, 186.22578254971876, 142.9143021217676, -560.090218023035, -609.5231892881476, -222.7630566735469, -64.532569245295, -220.75353559378942, -97.74698917319355, -32.73024120367007, -406.8441685819788, -69.48305357034188, -659.5071564841398, 88.27829593355452, 30.564217709873148, -563.4966372196376, 66.01957052573232, -88.20870564736154, -83.69944585391823, -31.044458034853022, 158.76372836203075, -21.323371208302227, -185.06105182525462], "policy_predator_policy_reward": [7.7197726602676235, 0.0, 189.20157806550304, 320.0859932297682, 478.22194659079616, 107.81508331162823, 5.276757515940578, 6.086663139921457, 173.92659629087962, 205.63218297322427, 184.5692170077244, 422.7973075602265, 111.37595906579867, 70.40731538360366, 72.58134927340073, 897.3426808295768, 0.8683117311107852, 629.9987442747159, 164.4442816413436, 230.01758196768336, 3.899143926579866, 421.44370603153305, 257.53864534072966, 280.55246971308304, 101.8751324832475, 187.87404707980383, 440.05441352067146, 77.82200898914004, 95.8327573353015, 644.8233582001182, 239.93919981194153, 44.38007194546704, 225.86919510635565, 13.194797601704575, 257.19873576195687, 235.61348339163249, 2.315884715778287, 808.9903817645084, 296.0812520163911, 24.17611480167921, 75.4892888536963, 482.6747181507553, 120.42455127846739, 8.379921552409295, 18.012277961987923, 979.5003124047468, 1.637755896145655, 183.3659824258896, 347.68658659235103, 288.8335855733764, 436.5506361185909, 2.3509442779114247, 233.47598655145026, 64.11961477589996, 31.224584116295798, 305.1587607489869, 203.68022754776985, 650.7997189141248, 4.921181195820333, 149.56420650767004, 309.5696053382527, 363.83621326215723, 118.88886194779909, 358.25080545336436, 339.1217933655644, 64.83172895285043, 30.2335131021134, 288.1757427544446, 24.636467638882113, 249.47175992184816, 189.04220611132817, 206.1605856595622, 43.488628584563614, 121.66218169056424, 62.159164334597804, 343.6311307620692, 13.685404035901714, 169.65358643126024, 589.8212353042051, 220.61021623747106, 195.34116333698876, 94.7415431861592, 332.3069051220556, 852.4283441321867, 119.89031521675322, 306.7395094112806, 95.07335554018461, 529.2129380818205, 38.71382840449749, 368.49371930274407, 203.19294473707626, 294.5050623380038, 152.49623306265033, 48.334831527792126, 1218.7928518039669, 126.83406708976318, 62.501745220841194, 95.32713645701976, 29.00893435683175, 449.7175670339331, 56.745132181307845, 0.0, 18.26434164799921, 17.232764939946982, 1.0660579675185684, 121.70367688182222, 200.5488462998193, 205.43277082865532, 353.81048882129323, 24.269977540664577, 13.424065216231195, 2.4831848876926688, 508.1733907144186, 31.379646427106714, 23.572182704428936, 163.7486418512796, 232.1398114252894, 351.0444021926131, 14.679903970059721, 886.1652367955716, 446.4696197187831, 91.62713363656218, 272.61877002181143, 161.19302666022253, 33.41961152472531, 437.9081641442851, 26.29769785324291, 66.01199483549898, 233.90610118718746, 382.54906807648143, 212.89838027614377, 281.64812512381036, 707.5427068714296, 161.39790369085853, 90.65373265263338, 711.0294049911784, 178.09180115362514, 111.80162048014465, 443.1351386336432, 529.4601377191376, 690.8406048417452, 367.55009408038234, 183.80634058113813, 18.865756196285908, 0.0, 347.8112322580103, 168.22215272611038, 434.0593655148212, 250.93236989323225, 0.8663149332864403, 266.6367936589336, 461.0960685588127, 255.3322698965633, 130.07125627165826, 2.0558056320631812, 0.0, 232.06611917061483, 139.82491238617604, 2.7210494861696617, 6.841121465208259, 201.39903974000836, 0.0, 273.1031097580055, 336.0658681875693, 45.96049584036398, 319.4293579855226, 450.598565583138, 262.2948744990173, 522.5813793081808, 156.52128872101733, 46.05119639064905, 1272.5539820671302, 719.5154242029363, 271.0704197594494, 354.1410327571951, 188.2258489122047, 388.15639382134117, 633.863633677103, 5.9742174502812375, 43.08569787823241, 788.9425983424699, 551.9588772315775, 313.95573181134506, 12.05841659719482, 134.7014071636742, 277.78868802037294, 48.23024120367029, 438.84416858197875, 612.3040171923741, 108.48689176350072, 8.555327990332774, 113.10007536682184, 255.9757389711308, 519.9138035177854, 8.506209118451965, 190.83295924619443, 48.444458034853284, 20.336271637969237, 79.42337120830226, 239.06105182525454]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.140715158340138, "mean_inference_ms": 3.21744244482306, "mean_action_processing_ms": 1.5333697791302006, "mean_env_wait_ms": 0.6657123031339153, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004547834396362305, "StateBufferConnector_ms": 0.003520965576171875, "ViewRequirementAgentConnector_ms": 0.13999450206756592}, "num_episodes": 23, "episode_return_max": 461.06330490865906, "episode_return_min": -361.67799592438104, "episode_return_mean": 99.60063539917957, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1456000, "num_agent_steps_trained": 1456000, "num_env_steps_sampled": 364000, "num_env_steps_trained": 364000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 80.66356454659615, "num_env_steps_trained_throughput_per_sec": 80.66356454659615, "timesteps_total": 364000, "num_env_steps_sampled_lifetime": 364000, "num_agent_steps_sampled_lifetime": 1456000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1456000, "timers": {"training_iteration_time_ms": 47904.188, "restore_workers_time_ms": 0.014, "training_step_time_ms": 47904.099, "sample_time_ms": 1471.942, "learn_time_ms": 46408.118, "learn_throughput": 86.192, "synch_weights_time_ms": 18.729}, "counters": {"num_env_steps_sampled": 364000, "num_env_steps_trained": 364000, "num_agent_steps_sampled": 1456000, "num_agent_steps_trained": 1456000}, "done": false, "training_iteration": 91, "trial_id": "cf3bb_00000", "date": "2024-08-20_09-58-53", "timestamp": 1724128133, "time_this_iter_s": 49.618995904922485, "time_total_s": 12394.79250240326, "pid": 25777, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39fcc8c10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 12394.79250240326, "iterations_since_restore": 91, "perf": {"cpu_util_percent": 40.49718309859155, "ram_util_percent": 80.02957746478874}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5077092790729785, "cur_kl_coeff": 0.00017597973346710204, "cur_lr": 0.00010000000000000003, "total_loss": 7.532816858140249, "policy_loss": -0.0040038975955987415, "vf_loss": 7.536819920211872, "vf_explained_var": -0.00017249634656956586, "kl": 0.00504451078060216, "entropy": 0.6785356833821251, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 172935.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 14.713496735360888, "cur_kl_coeff": 0.0052734375, "cur_lr": 0.00010000000000000003, "total_loss": 8.763301535258217, "policy_loss": -0.003279872738544351, "vf_loss": 8.766535373970314, "vf_explained_var": 0.16914338904713827, "kl": 0.008726884267890879, "entropy": 0.8646727323532104, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 172935.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 368000, "num_env_steps_trained": 368000, "num_agent_steps_sampled": 1472000, "num_agent_steps_trained": 1472000}, "env_runners": {"episode_reward_max": 461.06330490865906, "episode_reward_min": -306.0296024753268, "episode_reward_mean": 103.49567782681217, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1272.5539820671302, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 1272.5539820671302}, "policy_reward_mean": {"prey_policy": -194.82233129212463, "predator_policy": 246.5701702055307}, "custom_metrics": {}, "hist_stats": {"episode_reward": [198.0, 186.10000000000002, 18.399999999999984, 29.200000000000134, 186.3, 120.89999999999927, 48.0, 58.32891192849348, 28.570962624801396, 4.9403942731545625, 100.53363830358064, 194.5423313012341, -33.10094329842799, -104.41862121657401, 253.25834087741939, -5.3263637812091895, 141.58063140468306, 59.22513672758254, 249.0845569567593, 22.107695277109066, 156.19999999999925, -46.970580603141656, 142.73517454417694, 11.528357854734871, -69.39747129763194, 95.9, 45.00000000000003, 131.24552763963084, 140.27050563134836, -306.0296024753268, 270.63011941207935, -109.1588489219, 341.0642983737574, 200.09999999999928, 167.69999999999928, 142.50764830071387, 69.50976298470844, 385.0, -254.43989103066886, 250.5, -102.08887866307697, 173.6, 96.0076623962982, 127.26971968301409, 169.59999999999977, 206.91880841439703, 80.60265548068097, 144.20226610216739, -1.7155393762348699, 78.39999999999998, 20.324643749636813, 461.06330490865906, 265.27526373494715, 73.4000000000002, 200.3, -67.79748241582999, 29.41993671878239, 39.5, 168.29999999999998, 396.04247951772345, 185.000179117077, 394.0, 212.08309417229555, 20.73552048312325, 99.32217971313302, 30.068859845140196, -71.08662834655861, 157.6, 49.0, 91.561934723108, 100.96219155217965, 378.2, 171.28806826286552, 38.71852248969779, 93.98957041706493, 47.50000000000015, -8.199301098606815, 240.49791700058216, 278.4124757950109, 27.431016863366928, 196.4999999999994, 112.1000000000002, 155.6833333333333, 63.70000000000012, 32.000000000000185, 33.4000000000002, 143.14315367108438, 3.465731464246806, 44.21205133055691, 145.98450807376022, -160.18785922699215, 204.6137132392938, 132.94062476544312, 122.38555938252564, 281.6, 45.200000000000074, 40.699483501085595, 90.89521669728111, 46.0, -0.5998465821306593], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [195.68411528422172, -808.9903817645084, -290.9812520163911, 156.8238851983208, -58.08928885369686, -481.6747181507553, 17.29744656932563, -116.9019194002029, 166.98772203801207, -978.2003124047467, -56.24711771008104, -7.856620611954217, -347.68658659235103, -240.83358557337667, -436.5506361185909, 55.977967650582045, -220.57598655145054, -48.44865215109856, -37.23860410944726, -294.2043464826807, -86.6475398034745, -667.2987683548392, 29.1482391037681, 10.908704493975597, -349.1624438267262, -357.3443180721118, -247.38779247078338, -334.17049614695503, 193.57839482608156, -344.27357626707686, -235.58550023499632, -88.1501194027713, -198.81410598998653, 66.28650983393916, -218.91279329164348, -117.06486175166495, 16.21536936877027, 67.71837731286118, -45.50508364926877, -338.17751617028927, 7.735745330286604, -34.87473579744847, -607.98196085806, -249.42007128675772, -225.72021691741924, 78.37268493844823, -486.38629416143823, -686.8205972380689, -307.4355289033004, -188.59176702236527, 0.8266444598155402, -529.2129380818205, -21.71382840449725, -340.49371930274407, -11.55749254927043, -354.89498688617766, -40.74033678360237, -19.820222175490855, -1064.5242709469537, -587.132250422103, 85.17480752036526, 27.62643021385311, -147.52707985761475, -440.3582704550505, 154.9583770749298, 129.3607891175197, 163.73565835200088, 0.8672350600529949, 30.942081231546062, 13.988183919113089, -170.10439391229747, -93.36957491546363, -288.83333858205594, -19.737364795193898, 185.44503512430336, 183.64771477177277, -433.77165208360714, -360.2212760885875, 90.92781729557117, -27.748641851279643, -339.4878981499513, -345.7851941310282, 158.92009602994028, -886.1652367955716, -327.6362545072313, -114.45283645181567, -50.79866745762842, -255.7434095413912, 131.68038847527473, -433.4081641442841, 34.62111056115455, 79.98800516450095, -378.7823363079479, -157.07017747504023, -332.33314918081425, -18.01109011697193, -696.534079194756, -174.12207074376715, -411.2746998964989, -312.0084377473125, -39.84171747895486, -229.72706040517852, 51.93448708512348, -563.4664585292448, -813.1154351871812, 20.000000000000014, 12.19934843153379, -141.47144520895793, 200.0, -347.5112322580103, -284.7970468318931, -385.28195382486666, -175.175134426658, -47.20361368107813, -230.63679365893353, -457.5960685588127, -194.332269896563, -22.77125627165823, 198.04247951772345, 195.9441943679368, -185.78066022875763, -1.110192210956223, 195.27895051383035, 189.15887853479174, -101.39903974000848, 112.08309417229523, -390.43393389383306, -197.9995235686182, 0.36168387276899505, -266.4293579855226, -451.45131512690654, -231.3732651101086, -425.45306526091446, -324.7362311148423, 111.54880360935095, -1272.5539820671302, -719.5154242029363, -222.07041975944924, -339.84949514257954, -110.9554518037124, -381.9057125074413, -539.1521234388247, 186.22578254971876, 142.9143021217676, -560.090218023035, -609.5231892881476, -222.7630566735469, -64.532569245295, -220.75353559378942, -97.74698917319355, -32.73024120367007, -406.8441685819788, -69.48305357034188, -659.5071564841398, 88.27829593355452, 30.564217709873148, -563.4966372196376, 66.01957052573232, -88.20870564736154, -83.69944585391823, -31.044458034853022, 158.76372836203075, -21.323371208302227, -185.06105182525462, -922.2839787959228, 138.79999999999998, -204.5913760652595, -164.40777175312223, -54.72930430315536, 7.250710831941289, 13.249999999999993, -168.5945603691484, -97.2520115484468, -594.3108396115033, -483.8033634404431, -139.67165059461286, -513.1676991398992, -562.975264754235, 66.20284566693476, -378.99411071339676, -328.6753925682281, -425.46400834190035, 21.619681058392644, 59.52764435558813, -88.22150251283693, -434.4868059529849, -243.55340612342454, -313.1919240139102, 25.16904203170455, 67.84818472873434, 0.504417959214494, -335.3282851716343, -212.79976964303566, -143.88650705087835, -644.5612330562352, -84.02548190177282, -169.7471753127274, -552.6467841296861, -271.5349310570055, -289.0110377087677], "policy_predator_policy_reward": [2.315884715778287, 808.9903817645084, 296.0812520163911, 24.17611480167921, 75.4892888536963, 482.6747181507553, 120.42455127846739, 8.379921552409295, 18.012277961987923, 979.5003124047468, 1.637755896145655, 183.3659824258896, 347.68658659235103, 288.8335855733764, 436.5506361185909, 2.3509442779114247, 233.47598655145026, 64.11961477589996, 31.224584116295798, 305.1587607489869, 203.68022754776985, 650.7997189141248, 4.921181195820333, 149.56420650767004, 309.5696053382527, 363.83621326215723, 118.88886194779909, 358.25080545336436, 339.1217933655644, 64.83172895285043, 30.2335131021134, 288.1757427544446, 24.636467638882113, 249.47175992184816, 189.04220611132817, 206.1605856595622, 43.488628584563614, 121.66218169056424, 62.159164334597804, 343.6311307620692, 13.685404035901714, 169.65358643126024, 589.8212353042051, 220.61021623747106, 195.34116333698876, 94.7415431861592, 332.3069051220556, 852.4283441321867, 119.89031521675322, 306.7395094112806, 95.07335554018461, 529.2129380818205, 38.71382840449749, 368.49371930274407, 203.19294473707626, 294.5050623380038, 152.49623306265033, 48.334831527792126, 1218.7928518039669, 126.83406708976318, 62.501745220841194, 95.32713645701976, 29.00893435683175, 449.7175670339331, 56.745132181307845, 0.0, 18.26434164799921, 17.232764939946982, 1.0660579675185684, 121.70367688182222, 200.5488462998193, 205.43277082865532, 353.81048882129323, 24.269977540664577, 13.424065216231195, 2.4831848876926688, 508.1733907144186, 31.379646427106714, 23.572182704428936, 163.7486418512796, 232.1398114252894, 351.0444021926131, 14.679903970059721, 886.1652367955716, 446.4696197187831, 91.62713363656218, 272.61877002181143, 161.19302666022253, 33.41961152472531, 437.9081641442851, 26.29769785324291, 66.01199483549898, 233.90610118718746, 382.54906807648143, 212.89838027614377, 281.64812512381036, 707.5427068714296, 161.39790369085853, 90.65373265263338, 711.0294049911784, 178.09180115362514, 111.80162048014465, 443.1351386336432, 529.4601377191376, 690.8406048417452, 367.55009408038234, 183.80634058113813, 18.865756196285908, 0.0, 347.8112322580103, 168.22215272611038, 434.0593655148212, 250.93236989323225, 0.8663149332864403, 266.6367936589336, 461.0960685588127, 255.3322698965633, 130.07125627165826, 2.0558056320631812, 0.0, 232.06611917061483, 139.82491238617604, 2.7210494861696617, 6.841121465208259, 201.39903974000836, 0.0, 273.1031097580055, 336.0658681875693, 45.96049584036398, 319.4293579855226, 450.598565583138, 262.2948744990173, 522.5813793081808, 156.52128872101733, 46.05119639064905, 1272.5539820671302, 719.5154242029363, 271.0704197594494, 354.1410327571951, 188.2258489122047, 388.15639382134117, 633.863633677103, 5.9742174502812375, 43.08569787823241, 788.9425983424699, 551.9588772315775, 313.95573181134506, 12.05841659719482, 134.7014071636742, 277.78868802037294, 48.23024120367029, 438.84416858197875, 612.3040171923741, 108.48689176350072, 8.555327990332774, 113.10007536682184, 255.9757389711308, 519.9138035177854, 8.506209118451965, 190.83295924619443, 48.444458034853284, 20.336271637969237, 79.42337120830226, 239.06105182525454, 61.53485225331905, 877.6324598759372, 194.46910957245393, 238.23003824592752, 12.579668320655706, 66.89892515055838, 0.7726244092958185, 187.9719359598518, 297.0197609807994, 537.6862438502363, 484.2033634404431, 142.73738205885928, 661.9697939717756, 458.38522125291706, 81.67783111418011, 377.0979420060423, 583.0373764658381, 10.914165217298953, 38.43189509531024, 85.03449273000287, 320.13281700270716, 335.5161162285574, 305.35423661944355, 373.77665290041693, 91.43095796829525, 97.15181527126566, 268.8435668927072, 111.18030031971283, 279.80279500707934, 117.58296518792032, 176.61246780754075, 642.8694638477485, 215.74717531272734, 552.6467841296861, 462.02224126563203, 97.9238809180107]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0976157000702482, "mean_inference_ms": 3.2791824474860083, "mean_action_processing_ms": 1.520699528681169, "mean_env_wait_ms": 0.6230454889666314, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004989027976989746, "StateBufferConnector_ms": 0.0035533905029296875, "ViewRequirementAgentConnector_ms": 0.14288508892059326}, "num_episodes": 18, "episode_return_max": 461.06330490865906, "episode_return_min": -306.0296024753268, "episode_return_mean": 103.49567782681217, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1472000, "num_agent_steps_trained": 1472000, "num_env_steps_sampled": 368000, "num_env_steps_trained": 368000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 81.27803724937522, "num_env_steps_trained_throughput_per_sec": 81.27803724937522, "timesteps_total": 368000, "num_env_steps_sampled_lifetime": 368000, "num_agent_steps_sampled_lifetime": 1472000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1472000, "timers": {"training_iteration_time_ms": 48136.269, "restore_workers_time_ms": 0.015, "training_step_time_ms": 48136.191, "sample_time_ms": 1504.331, "learn_time_ms": 46607.743, "learn_throughput": 85.823, "synch_weights_time_ms": 18.986}, "counters": {"num_env_steps_sampled": 368000, "num_env_steps_trained": 368000, "num_agent_steps_sampled": 1472000, "num_agent_steps_trained": 1472000}, "done": false, "training_iteration": 92, "trial_id": "cf3bb_00000", "date": "2024-08-20_09-59-42", "timestamp": 1724128182, "time_this_iter_s": 49.25575613975525, "time_total_s": 12444.048258543015, "pid": 25777, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39f79daf0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 12444.048258543015, "iterations_since_restore": 92, "perf": {"cpu_util_percent": 39.86571428571429, "ram_util_percent": 79.99285714285716}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.19279061955592, "cur_kl_coeff": 0.00017597973346710204, "cur_lr": 0.00010000000000000003, "total_loss": 7.357190007002896, "policy_loss": -0.0017507648575932734, "vf_loss": 7.358940178502804, "vf_explained_var": 0.015517763895963235, "kl": 0.0032551598762383853, "entropy": 0.7090267497395712, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 174825.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.89503991105569, "cur_kl_coeff": 0.0052734375, "cur_lr": 0.00010000000000000003, "total_loss": 8.598928819383893, "policy_loss": -0.0041138536757518536, "vf_loss": 8.602986134675445, "vf_explained_var": 0.05593011524311449, "kl": 0.010722454530373498, "entropy": 0.8296069488323555, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 174825.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_agent_steps_sampled": 1488000, "num_agent_steps_trained": 1488000}, "env_runners": {"episode_reward_max": 461.06330490865906, "episode_reward_min": -306.0296024753268, "episode_reward_mean": 103.9506953554676, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1272.5539820671302, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 1272.5539820671302}, "policy_reward_mean": {"prey_policy": -195.7752662094226, "predator_policy": 247.75061388715642}, "custom_metrics": {}, "hist_stats": {"episode_reward": [249.0845569567593, 22.107695277109066, 156.19999999999925, -46.970580603141656, 142.73517454417694, 11.528357854734871, -69.39747129763194, 95.9, 45.00000000000003, 131.24552763963084, 140.27050563134836, -306.0296024753268, 270.63011941207935, -109.1588489219, 341.0642983737574, 200.09999999999928, 167.69999999999928, 142.50764830071387, 69.50976298470844, 385.0, -254.43989103066886, 250.5, -102.08887866307697, 173.6, 96.0076623962982, 127.26971968301409, 169.59999999999977, 206.91880841439703, 80.60265548068097, 144.20226610216739, -1.7155393762348699, 78.39999999999998, 20.324643749636813, 461.06330490865906, 265.27526373494715, 73.4000000000002, 200.3, -67.79748241582999, 29.41993671878239, 39.5, 168.29999999999998, 396.04247951772345, 185.000179117077, 394.0, 212.08309417229555, 20.73552048312325, 99.32217971313302, 30.068859845140196, -71.08662834655861, 157.6, 49.0, 91.561934723108, 100.96219155217965, 378.2, 171.28806826286552, 38.71852248969779, 93.98957041706493, 47.50000000000015, -8.199301098606815, 240.49791700058216, 278.4124757950109, 27.431016863366928, 196.4999999999994, 112.1000000000002, 155.6833333333333, 63.70000000000012, 32.000000000000185, 33.4000000000002, 143.14315367108438, 3.465731464246806, 44.21205133055691, 145.98450807376022, -160.18785922699215, 204.6137132392938, 132.94062476544312, 122.38555938252564, 281.6, 45.200000000000074, 40.699483501085595, 90.89521669728111, 46.0, -0.5998465821306593, -35.01424213790849, 211.7506290909326, 242.4842815056454, 200.0, 2.999999999999999, -79.24614183946657, 73.8, 29.400000000000063, 180.57798976255842, 45.691914476273794, 75.02082750975376, 28.9383237334836, 12.79884096465077, 112.91850649074841, 175.30165211300488, -59.591521918879835, 76.19999999999968, 236.50511225948418], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [16.21536936877027, 67.71837731286118, -45.50508364926877, -338.17751617028927, 7.735745330286604, -34.87473579744847, -607.98196085806, -249.42007128675772, -225.72021691741924, 78.37268493844823, -486.38629416143823, -686.8205972380689, -307.4355289033004, -188.59176702236527, 0.8266444598155402, -529.2129380818205, -21.71382840449725, -340.49371930274407, -11.55749254927043, -354.89498688617766, -40.74033678360237, -19.820222175490855, -1064.5242709469537, -587.132250422103, 85.17480752036526, 27.62643021385311, -147.52707985761475, -440.3582704550505, 154.9583770749298, 129.3607891175197, 163.73565835200088, 0.8672350600529949, 30.942081231546062, 13.988183919113089, -170.10439391229747, -93.36957491546363, -288.83333858205594, -19.737364795193898, 185.44503512430336, 183.64771477177277, -433.77165208360714, -360.2212760885875, 90.92781729557117, -27.748641851279643, -339.4878981499513, -345.7851941310282, 158.92009602994028, -886.1652367955716, -327.6362545072313, -114.45283645181567, -50.79866745762842, -255.7434095413912, 131.68038847527473, -433.4081641442841, 34.62111056115455, 79.98800516450095, -378.7823363079479, -157.07017747504023, -332.33314918081425, -18.01109011697193, -696.534079194756, -174.12207074376715, -411.2746998964989, -312.0084377473125, -39.84171747895486, -229.72706040517852, 51.93448708512348, -563.4664585292448, -813.1154351871812, 20.000000000000014, 12.19934843153379, -141.47144520895793, 200.0, -347.5112322580103, -284.7970468318931, -385.28195382486666, -175.175134426658, -47.20361368107813, -230.63679365893353, -457.5960685588127, -194.332269896563, -22.77125627165823, 198.04247951772345, 195.9441943679368, -185.78066022875763, -1.110192210956223, 195.27895051383035, 189.15887853479174, -101.39903974000848, 112.08309417229523, -390.43393389383306, -197.9995235686182, 0.36168387276899505, -266.4293579855226, -451.45131512690654, -231.3732651101086, -425.45306526091446, -324.7362311148423, 111.54880360935095, -1272.5539820671302, -719.5154242029363, -222.07041975944924, -339.84949514257954, -110.9554518037124, -381.9057125074413, -539.1521234388247, 186.22578254971876, 142.9143021217676, -560.090218023035, -609.5231892881476, -222.7630566735469, -64.532569245295, -220.75353559378942, -97.74698917319355, -32.73024120367007, -406.8441685819788, -69.48305357034188, -659.5071564841398, 88.27829593355452, 30.564217709873148, -563.4966372196376, 66.01957052573232, -88.20870564736154, -83.69944585391823, -31.044458034853022, 158.76372836203075, -21.323371208302227, -185.06105182525462, -922.2839787959228, 138.79999999999998, -204.5913760652595, -164.40777175312223, -54.72930430315536, 7.250710831941289, 13.249999999999993, -168.5945603691484, -97.2520115484468, -594.3108396115033, -483.8033634404431, -139.67165059461286, -513.1676991398992, -562.975264754235, 66.20284566693476, -378.99411071339676, -328.6753925682281, -425.46400834190035, 21.619681058392644, 59.52764435558813, -88.22150251283693, -434.4868059529849, -243.55340612342454, -313.1919240139102, 25.16904203170455, 67.84818472873434, 0.504417959214494, -335.3282851716343, -212.79976964303566, -143.88650705087835, -644.5612330562352, -84.02548190177282, -169.7471753127274, -552.6467841296861, -271.5349310570055, -289.0110377087677, -300.0483732952514, -204.32367472386974, 71.32210532103157, -73.69398127066937, 109.6664257609629, 53.26614168483642, 200.0, -610.3797754470131, -735.0851814394664, -428.63972633427994, -434.56132834710337, -465.15514398025516, -323.53240655474906, -191.71030864442096, 14.119969418707045, -410.3066301127114, -382.73940462698465, 2.447000553490925, -245.259893700292, -232.09136949005207, -122.26328973375954, -196.93292711900966, -72.58836410672465, -225.15740458786567, -131.3027366480106, -289.06114609421496, -57.543403251563525, -303.129436170203, -7.3561696095102995, -5.185124603384947, -484.74393124564693, -266.3935868470097, -93.1873126731429, -57.975441046527756, 33.13112332204488, -100.79161692311169], "policy_predator_policy_reward": [43.488628584563614, 121.66218169056424, 62.159164334597804, 343.6311307620692, 13.685404035901714, 169.65358643126024, 589.8212353042051, 220.61021623747106, 195.34116333698876, 94.7415431861592, 332.3069051220556, 852.4283441321867, 119.89031521675322, 306.7395094112806, 95.07335554018461, 529.2129380818205, 38.71382840449749, 368.49371930274407, 203.19294473707626, 294.5050623380038, 152.49623306265033, 48.334831527792126, 1218.7928518039669, 126.83406708976318, 62.501745220841194, 95.32713645701976, 29.00893435683175, 449.7175670339331, 56.745132181307845, 0.0, 18.26434164799921, 17.232764939946982, 1.0660579675185684, 121.70367688182222, 200.5488462998193, 205.43277082865532, 353.81048882129323, 24.269977540664577, 13.424065216231195, 2.4831848876926688, 508.1733907144186, 31.379646427106714, 23.572182704428936, 163.7486418512796, 232.1398114252894, 351.0444021926131, 14.679903970059721, 886.1652367955716, 446.4696197187831, 91.62713363656218, 272.61877002181143, 161.19302666022253, 33.41961152472531, 437.9081641442851, 26.29769785324291, 66.01199483549898, 233.90610118718746, 382.54906807648143, 212.89838027614377, 281.64812512381036, 707.5427068714296, 161.39790369085853, 90.65373265263338, 711.0294049911784, 178.09180115362514, 111.80162048014465, 443.1351386336432, 529.4601377191376, 690.8406048417452, 367.55009408038234, 183.80634058113813, 18.865756196285908, 0.0, 347.8112322580103, 168.22215272611038, 434.0593655148212, 250.93236989323225, 0.8663149332864403, 266.6367936589336, 461.0960685588127, 255.3322698965633, 130.07125627165826, 2.0558056320631812, 0.0, 232.06611917061483, 139.82491238617604, 2.7210494861696617, 6.841121465208259, 201.39903974000836, 0.0, 273.1031097580055, 336.0658681875693, 45.96049584036398, 319.4293579855226, 450.598565583138, 262.2948744990173, 522.5813793081808, 156.52128872101733, 46.05119639064905, 1272.5539820671302, 719.5154242029363, 271.0704197594494, 354.1410327571951, 188.2258489122047, 388.15639382134117, 633.863633677103, 5.9742174502812375, 43.08569787823241, 788.9425983424699, 551.9588772315775, 313.95573181134506, 12.05841659719482, 134.7014071636742, 277.78868802037294, 48.23024120367029, 438.84416858197875, 612.3040171923741, 108.48689176350072, 8.555327990332774, 113.10007536682184, 255.9757389711308, 519.9138035177854, 8.506209118451965, 190.83295924619443, 48.444458034853284, 20.336271637969237, 79.42337120830226, 239.06105182525454, 61.53485225331905, 877.6324598759372, 194.46910957245393, 238.23003824592752, 12.579668320655706, 66.89892515055838, 0.7726244092958185, 187.9719359598518, 297.0197609807994, 537.6862438502363, 484.2033634404431, 142.73738205885928, 661.9697939717756, 458.38522125291706, 81.67783111418011, 377.0979420060423, 583.0373764658381, 10.914165217298953, 38.43189509531024, 85.03449273000287, 320.13281700270716, 335.5161162285574, 305.35423661944355, 373.77665290041693, 91.43095796829525, 97.15181527126566, 268.8435668927072, 111.18030031971283, 279.80279500707934, 117.58296518792032, 176.61246780754075, 642.8694638477485, 215.74717531272734, 552.6467841296861, 462.02224126563203, 97.9238809180107, 420.85748615960966, 48.50031972160308, 213.34997858690463, 0.77252645366573, 0.0, 79.5517140598461, 0.0, 610.3797754470131, 735.0851814394664, 431.63972633427994, 202.13965191541033, 618.3306785724803, 323.7324065547491, 265.3103086444208, 5.2800305812929205, 420.3066301127114, 385.38166060544773, 175.4887332306046, 144.58932522086516, 378.4538524457515, 345.32842953770063, 48.88861482482226, 150.588687903072, 176.09540452500195, 36.32188658253674, 396.84083712433886, 125.26190974231206, 348.3294361702029, 187.8429463259002, 0.0, 423.6524093267669, 267.89358684700966, 154.18731267314283, 73.1754410465274, 21.622360259000367, 282.5432456015507]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0955803078923796, "mean_inference_ms": 3.268456472840943, "mean_action_processing_ms": 1.509287721754202, "mean_env_wait_ms": 0.6198874928288681, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007976770401000977, "StateBufferConnector_ms": 0.003709077835083008, "ViewRequirementAgentConnector_ms": 0.15124797821044922}, "num_episodes": 18, "episode_return_max": 461.06330490865906, "episode_return_min": -306.0296024753268, "episode_return_mean": 103.9506953554676, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1488000, "num_agent_steps_trained": 1488000, "num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 81.82088965321479, "num_env_steps_trained_throughput_per_sec": 81.82088965321479, "timesteps_total": 372000, "num_env_steps_sampled_lifetime": 372000, "num_agent_steps_sampled_lifetime": 1488000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1488000, "timers": {"training_iteration_time_ms": 48258.971, "restore_workers_time_ms": 0.015, "training_step_time_ms": 48258.901, "sample_time_ms": 1526.852, "learn_time_ms": 46707.949, "learn_throughput": 85.639, "synch_weights_time_ms": 19.541}, "counters": {"num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_agent_steps_sampled": 1488000, "num_agent_steps_trained": 1488000}, "done": false, "training_iteration": 93, "trial_id": "cf3bb_00000", "date": "2024-08-20_10-00-31", "timestamp": 1724128231, "time_this_iter_s": 48.95506930351257, "time_total_s": 12493.003327846527, "pid": 25777, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3aaa84310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 12493.003327846527, "iterations_since_restore": 93, "perf": {"cpu_util_percent": 38.53478260869565, "ram_util_percent": 80.02753623188406}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.631404117546069, "cur_kl_coeff": 8.798986673355102e-05, "cur_lr": 0.00010000000000000003, "total_loss": 7.488991553442819, "policy_loss": -0.0004728999737866972, "vf_loss": 7.489464219411214, "vf_explained_var": -0.005865717659551631, "kl": 0.002702216515147872, "entropy": 0.7030059205161201, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 176715.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 19.076554909679626, "cur_kl_coeff": 0.0052734375, "cur_lr": 0.00010000000000000003, "total_loss": 8.337032573942155, "policy_loss": -0.006127330970275339, "vf_loss": 8.34311119942438, "vf_explained_var": 0.23019337509044263, "kl": 0.009234893846778914, "entropy": 0.7572305714011823, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 176715.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 376000, "num_env_steps_trained": 376000, "num_agent_steps_sampled": 1504000, "num_agent_steps_trained": 1504000}, "env_runners": {"episode_reward_max": 461.06330490865906, "episode_reward_min": -160.18785922699215, "episode_reward_mean": 101.51659785233049, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1272.5539820671302, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 1272.5539820671302}, "policy_reward_mean": {"prey_policy": -213.84848296086435, "predator_policy": 264.6067818870296}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-102.08887866307697, 173.6, 96.0076623962982, 127.26971968301409, 169.59999999999977, 206.91880841439703, 80.60265548068097, 144.20226610216739, -1.7155393762348699, 78.39999999999998, 20.324643749636813, 461.06330490865906, 265.27526373494715, 73.4000000000002, 200.3, -67.79748241582999, 29.41993671878239, 39.5, 168.29999999999998, 396.04247951772345, 185.000179117077, 394.0, 212.08309417229555, 20.73552048312325, 99.32217971313302, 30.068859845140196, -71.08662834655861, 157.6, 49.0, 91.561934723108, 100.96219155217965, 378.2, 171.28806826286552, 38.71852248969779, 93.98957041706493, 47.50000000000015, -8.199301098606815, 240.49791700058216, 278.4124757950109, 27.431016863366928, 196.4999999999994, 112.1000000000002, 155.6833333333333, 63.70000000000012, 32.000000000000185, 33.4000000000002, 143.14315367108438, 3.465731464246806, 44.21205133055691, 145.98450807376022, -160.18785922699215, 204.6137132392938, 132.94062476544312, 122.38555938252564, 281.6, 45.200000000000074, 40.699483501085595, 90.89521669728111, 46.0, -0.5998465821306593, -35.01424213790849, 211.7506290909326, 242.4842815056454, 200.0, 2.999999999999999, -79.24614183946657, 73.8, 29.400000000000063, 180.57798976255842, 45.691914476273794, 75.02082750975376, 28.9383237334836, 12.79884096465077, 112.91850649074841, 175.30165211300488, -59.591521918879835, 76.19999999999968, 236.50511225948418, 166.78461275515025, 78.40000000000003, 205.5999999999995, 192.3, 104.77064899663252, 85.97738752938943, 55.28032873587104, 55.09533647677217, -101.21511981656268, 188.9406894758945, 196.6999999999998, -3.552713678800501e-15, -80.37228305348344, 113.59999999999998, 0.656462618709047, 19.29999999999997, 115.0, 13.699124347297902, 54.75287663001053, 80.12736895756737, 97.08006867938822, 149.19999999999956], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-339.4878981499513, -345.7851941310282, 158.92009602994028, -886.1652367955716, -327.6362545072313, -114.45283645181567, -50.79866745762842, -255.7434095413912, 131.68038847527473, -433.4081641442841, 34.62111056115455, 79.98800516450095, -378.7823363079479, -157.07017747504023, -332.33314918081425, -18.01109011697193, -696.534079194756, -174.12207074376715, -411.2746998964989, -312.0084377473125, -39.84171747895486, -229.72706040517852, 51.93448708512348, -563.4664585292448, -813.1154351871812, 20.000000000000014, 12.19934843153379, -141.47144520895793, 200.0, -347.5112322580103, -284.7970468318931, -385.28195382486666, -175.175134426658, -47.20361368107813, -230.63679365893353, -457.5960685588127, -194.332269896563, -22.77125627165823, 198.04247951772345, 195.9441943679368, -185.78066022875763, -1.110192210956223, 195.27895051383035, 189.15887853479174, -101.39903974000848, 112.08309417229523, -390.43393389383306, -197.9995235686182, 0.36168387276899505, -266.4293579855226, -451.45131512690654, -231.3732651101086, -425.45306526091446, -324.7362311148423, 111.54880360935095, -1272.5539820671302, -719.5154242029363, -222.07041975944924, -339.84949514257954, -110.9554518037124, -381.9057125074413, -539.1521234388247, 186.22578254971876, 142.9143021217676, -560.090218023035, -609.5231892881476, -222.7630566735469, -64.532569245295, -220.75353559378942, -97.74698917319355, -32.73024120367007, -406.8441685819788, -69.48305357034188, -659.5071564841398, 88.27829593355452, 30.564217709873148, -563.4966372196376, 66.01957052573232, -88.20870564736154, -83.69944585391823, -31.044458034853022, 158.76372836203075, -21.323371208302227, -185.06105182525462, -922.2839787959228, 138.79999999999998, -204.5913760652595, -164.40777175312223, -54.72930430315536, 7.250710831941289, 13.249999999999993, -168.5945603691484, -97.2520115484468, -594.3108396115033, -483.8033634404431, -139.67165059461286, -513.1676991398992, -562.975264754235, 66.20284566693476, -378.99411071339676, -328.6753925682281, -425.46400834190035, 21.619681058392644, 59.52764435558813, -88.22150251283693, -434.4868059529849, -243.55340612342454, -313.1919240139102, 25.16904203170455, 67.84818472873434, 0.504417959214494, -335.3282851716343, -212.79976964303566, -143.88650705087835, -644.5612330562352, -84.02548190177282, -169.7471753127274, -552.6467841296861, -271.5349310570055, -289.0110377087677, -300.0483732952514, -204.32367472386974, 71.32210532103157, -73.69398127066937, 109.6664257609629, 53.26614168483642, 200.0, -610.3797754470131, -735.0851814394664, -428.63972633427994, -434.56132834710337, -465.15514398025516, -323.53240655474906, -191.71030864442096, 14.119969418707045, -410.3066301127114, -382.73940462698465, 2.447000553490925, -245.259893700292, -232.09136949005207, -122.26328973375954, -196.93292711900966, -72.58836410672465, -225.15740458786567, -131.3027366480106, -289.06114609421496, -57.543403251563525, -303.129436170203, -7.3561696095102995, -5.185124603384947, -484.74393124564693, -266.3935868470097, -93.1873126731429, -57.975441046527756, 33.13112332204488, -100.79161692311169, 18.475789313233584, -424.19926252940405, -28.590517817664995, -86.25979498423321, 194.5471881402678, -535.4962224777386, 181.00974613079757, -471.01616073994234, -151.56431478705088, -190.3584924628141, -255.51203931100798, -290.5904307983863, -153.3301530073522, -126.7731235877832, -107.81786141611333, -169.5799923054214, -618.0287525017625, -713.330804475579, -219.1982035783287, 1.2921873928495826, 182.15938780514097, -173.9274618972366, -919.1872881165002, -694.87893176663, -198.66944395841014, -300.9528753522496, 113.59999999999998, -788.858728563626, -215.79742003870297, -220.96610391388663, -877.3866898214113, -2.536766686408227, -431.46911953759854, 6.8092587534077635, -411.24729180432814, -357.3571202480828, -280.07899763343784, -98.07700258729596, -271.2309928608916, 19.504695618809777, 3.3244182006077563, -201.8758271189478, 74.06665399176995, -308.42094595602106], "policy_predator_policy_reward": [232.1398114252894, 351.0444021926131, 14.679903970059721, 886.1652367955716, 446.4696197187831, 91.62713363656218, 272.61877002181143, 161.19302666022253, 33.41961152472531, 437.9081641442851, 26.29769785324291, 66.01199483549898, 233.90610118718746, 382.54906807648143, 212.89838027614377, 281.64812512381036, 707.5427068714296, 161.39790369085853, 90.65373265263338, 711.0294049911784, 178.09180115362514, 111.80162048014465, 443.1351386336432, 529.4601377191376, 690.8406048417452, 367.55009408038234, 183.80634058113813, 18.865756196285908, 0.0, 347.8112322580103, 168.22215272611038, 434.0593655148212, 250.93236989323225, 0.8663149332864403, 266.6367936589336, 461.0960685588127, 255.3322698965633, 130.07125627165826, 2.0558056320631812, 0.0, 232.06611917061483, 139.82491238617604, 2.7210494861696617, 6.841121465208259, 201.39903974000836, 0.0, 273.1031097580055, 336.0658681875693, 45.96049584036398, 319.4293579855226, 450.598565583138, 262.2948744990173, 522.5813793081808, 156.52128872101733, 46.05119639064905, 1272.5539820671302, 719.5154242029363, 271.0704197594494, 354.1410327571951, 188.2258489122047, 388.15639382134117, 633.863633677103, 5.9742174502812375, 43.08569787823241, 788.9425983424699, 551.9588772315775, 313.95573181134506, 12.05841659719482, 134.7014071636742, 277.78868802037294, 48.23024120367029, 438.84416858197875, 612.3040171923741, 108.48689176350072, 8.555327990332774, 113.10007536682184, 255.9757389711308, 519.9138035177854, 8.506209118451965, 190.83295924619443, 48.444458034853284, 20.336271637969237, 79.42337120830226, 239.06105182525454, 61.53485225331905, 877.6324598759372, 194.46910957245393, 238.23003824592752, 12.579668320655706, 66.89892515055838, 0.7726244092958185, 187.9719359598518, 297.0197609807994, 537.6862438502363, 484.2033634404431, 142.73738205885928, 661.9697939717756, 458.38522125291706, 81.67783111418011, 377.0979420060423, 583.0373764658381, 10.914165217298953, 38.43189509531024, 85.03449273000287, 320.13281700270716, 335.5161162285574, 305.35423661944355, 373.77665290041693, 91.43095796829525, 97.15181527126566, 268.8435668927072, 111.18030031971283, 279.80279500707934, 117.58296518792032, 176.61246780754075, 642.8694638477485, 215.74717531272734, 552.6467841296861, 462.02224126563203, 97.9238809180107, 420.85748615960966, 48.50031972160308, 213.34997858690463, 0.77252645366573, 0.0, 79.5517140598461, 0.0, 610.3797754470131, 735.0851814394664, 431.63972633427994, 202.13965191541033, 618.3306785724803, 323.7324065547491, 265.3103086444208, 5.2800305812929205, 420.3066301127114, 385.38166060544773, 175.4887332306046, 144.58932522086516, 378.4538524457515, 345.32842953770063, 48.88861482482226, 150.588687903072, 176.09540452500195, 36.32188658253674, 396.84083712433886, 125.26190974231206, 348.3294361702029, 187.8429463259002, 0.0, 423.6524093267669, 267.89358684700966, 154.18731267314283, 73.1754410465274, 21.622360259000367, 282.5432456015507, 82.30882344191647, 490.19926252940377, 44.99051781766513, 148.25979498423317, 2.4528118597322095, 544.0962224777405, 10.990253869202421, 471.31616073994235, 148.52160058504523, 298.17185566145207, 597.6405086805613, 34.43934895822284, 335.3836053310072, 0.0, 2.3457717734030252, 330.1474184249039, 653.0299063289882, 577.114530831792, 150.19578417960025, 256.6509214817742, 8.940612194859035, 179.52746189723644, 919.1872881165002, 694.87893176663, 97.78210231820259, 321.4679339389748, 0.0, 788.858728563626, 265.8392040921, 171.58078247919892, 878.2866898214115, 20.936766686408255, 431.46911953759854, 108.19074124659224, 402.1362054449747, 380.167330954734, 271.63666970929927, 161.2722071414478, 14.980744492811008, 316.87292170683816, 249.95557064328125, 45.67590695444713, 63.133346008230056, 320.4209459560212]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0943617248823154, "mean_inference_ms": 3.2540239394428965, "mean_action_processing_ms": 1.4964070928269286, "mean_env_wait_ms": 0.6171799087441393, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009401440620422363, "StateBufferConnector_ms": 0.0040187835693359375, "ViewRequirementAgentConnector_ms": 0.15282809734344482}, "num_episodes": 22, "episode_return_max": 461.06330490865906, "episode_return_min": -160.18785922699215, "episode_return_mean": 101.51659785233049, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1504000, "num_agent_steps_trained": 1504000, "num_env_steps_sampled": 376000, "num_env_steps_trained": 376000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 80.84366021862009, "num_env_steps_trained_throughput_per_sec": 80.84366021862009, "timesteps_total": 376000, "num_env_steps_sampled_lifetime": 376000, "num_agent_steps_sampled_lifetime": 1504000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1504000, "timers": {"training_iteration_time_ms": 48535.123, "restore_workers_time_ms": 0.015, "training_step_time_ms": 48535.054, "sample_time_ms": 1556.392, "learn_time_ms": 46955.821, "learn_throughput": 85.186, "synch_weights_time_ms": 19.294}, "counters": {"num_env_steps_sampled": 376000, "num_env_steps_trained": 376000, "num_agent_steps_sampled": 1504000, "num_agent_steps_trained": 1504000}, "done": false, "training_iteration": 94, "trial_id": "cf3bb_00000", "date": "2024-08-20_10-01-21", "timestamp": 1724128281, "time_this_iter_s": 49.52725410461426, "time_total_s": 12542.530581951141, "pid": 25777, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39fcb0700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 12542.530581951141, "iterations_since_restore": 94, "perf": {"cpu_util_percent": 39.94366197183099, "ram_util_percent": 80.13380281690138}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1893802359069465, "cur_kl_coeff": 4.399493336677551e-05, "cur_lr": 0.00010000000000000003, "total_loss": 7.591250735994369, "policy_loss": -0.002638885897963687, "vf_loss": 7.5938892715191715, "vf_explained_var": -0.006312402530952737, "kl": 0.007678238812463635, "entropy": 0.6049492496977408, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 178605.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 16.84914716576773, "cur_kl_coeff": 0.0052734375, "cur_lr": 0.00010000000000000003, "total_loss": 7.9063147895550605, "policy_loss": -0.0016257774407566381, "vf_loss": 7.907913359384688, "vf_explained_var": 0.23579623692880863, "kl": 0.005156455515873006, "entropy": 0.6991704548162128, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 178605.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 380000, "num_env_steps_trained": 380000, "num_agent_steps_sampled": 1520000, "num_agent_steps_trained": 1520000}, "env_runners": {"episode_reward_max": 397.0, "episode_reward_min": -160.18785922699215, "episode_reward_mean": 105.47400186392517, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1272.5539820671302, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 1272.5539820671302}, "policy_reward_mean": {"prey_policy": -215.2346061125071, "predator_policy": 267.9716070444697}, "custom_metrics": {}, "hist_stats": {"episode_reward": [168.29999999999998, 396.04247951772345, 185.000179117077, 394.0, 212.08309417229555, 20.73552048312325, 99.32217971313302, 30.068859845140196, -71.08662834655861, 157.6, 49.0, 91.561934723108, 100.96219155217965, 378.2, 171.28806826286552, 38.71852248969779, 93.98957041706493, 47.50000000000015, -8.199301098606815, 240.49791700058216, 278.4124757950109, 27.431016863366928, 196.4999999999994, 112.1000000000002, 155.6833333333333, 63.70000000000012, 32.000000000000185, 33.4000000000002, 143.14315367108438, 3.465731464246806, 44.21205133055691, 145.98450807376022, -160.18785922699215, 204.6137132392938, 132.94062476544312, 122.38555938252564, 281.6, 45.200000000000074, 40.699483501085595, 90.89521669728111, 46.0, -0.5998465821306593, -35.01424213790849, 211.7506290909326, 242.4842815056454, 200.0, 2.999999999999999, -79.24614183946657, 73.8, 29.400000000000063, 180.57798976255842, 45.691914476273794, 75.02082750975376, 28.9383237334836, 12.79884096465077, 112.91850649074841, 175.30165211300488, -59.591521918879835, 76.19999999999968, 236.50511225948418, 166.78461275515025, 78.40000000000003, 205.5999999999995, 192.3, 104.77064899663252, 85.97738752938943, 55.28032873587104, 55.09533647677217, -101.21511981656268, 188.9406894758945, 196.6999999999998, -3.552713678800501e-15, -80.37228305348344, 113.59999999999998, 0.656462618709047, 19.29999999999997, 115.0, 13.699124347297902, 54.75287663001053, 80.12736895756737, 97.08006867938822, 149.19999999999956, 128.2468052981752, 73.60000000000004, 103.50523461015433, 34.999999999999886, 65.10000000000004, -151.98409095303674, 64.36938238880204, 26.600000000000065, 140.0, 170.08714637890645, 322.7661270692904, 19.0, 132.1439592630684, 397.0, 130.0869811701893, 367.6784553852599, 88.1, 278.7227612821009], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-194.332269896563, -22.77125627165823, 198.04247951772345, 195.9441943679368, -185.78066022875763, -1.110192210956223, 195.27895051383035, 189.15887853479174, -101.39903974000848, 112.08309417229523, -390.43393389383306, -197.9995235686182, 0.36168387276899505, -266.4293579855226, -451.45131512690654, -231.3732651101086, -425.45306526091446, -324.7362311148423, 111.54880360935095, -1272.5539820671302, -719.5154242029363, -222.07041975944924, -339.84949514257954, -110.9554518037124, -381.9057125074413, -539.1521234388247, 186.22578254971876, 142.9143021217676, -560.090218023035, -609.5231892881476, -222.7630566735469, -64.532569245295, -220.75353559378942, -97.74698917319355, -32.73024120367007, -406.8441685819788, -69.48305357034188, -659.5071564841398, 88.27829593355452, 30.564217709873148, -563.4966372196376, 66.01957052573232, -88.20870564736154, -83.69944585391823, -31.044458034853022, 158.76372836203075, -21.323371208302227, -185.06105182525462, -922.2839787959228, 138.79999999999998, -204.5913760652595, -164.40777175312223, -54.72930430315536, 7.250710831941289, 13.249999999999993, -168.5945603691484, -97.2520115484468, -594.3108396115033, -483.8033634404431, -139.67165059461286, -513.1676991398992, -562.975264754235, 66.20284566693476, -378.99411071339676, -328.6753925682281, -425.46400834190035, 21.619681058392644, 59.52764435558813, -88.22150251283693, -434.4868059529849, -243.55340612342454, -313.1919240139102, 25.16904203170455, 67.84818472873434, 0.504417959214494, -335.3282851716343, -212.79976964303566, -143.88650705087835, -644.5612330562352, -84.02548190177282, -169.7471753127274, -552.6467841296861, -271.5349310570055, -289.0110377087677, -300.0483732952514, -204.32367472386974, 71.32210532103157, -73.69398127066937, 109.6664257609629, 53.26614168483642, 200.0, -610.3797754470131, -735.0851814394664, -428.63972633427994, -434.56132834710337, -465.15514398025516, -323.53240655474906, -191.71030864442096, 14.119969418707045, -410.3066301127114, -382.73940462698465, 2.447000553490925, -245.259893700292, -232.09136949005207, -122.26328973375954, -196.93292711900966, -72.58836410672465, -225.15740458786567, -131.3027366480106, -289.06114609421496, -57.543403251563525, -303.129436170203, -7.3561696095102995, -5.185124603384947, -484.74393124564693, -266.3935868470097, -93.1873126731429, -57.975441046527756, 33.13112332204488, -100.79161692311169, 18.475789313233584, -424.19926252940405, -28.590517817664995, -86.25979498423321, 194.5471881402678, -535.4962224777386, 181.00974613079757, -471.01616073994234, -151.56431478705088, -190.3584924628141, -255.51203931100798, -290.5904307983863, -153.3301530073522, -126.7731235877832, -107.81786141611333, -169.5799923054214, -618.0287525017625, -713.330804475579, -219.1982035783287, 1.2921873928495826, 182.15938780514097, -173.9274618972366, -919.1872881165002, -694.87893176663, -198.66944395841014, -300.9528753522496, 113.59999999999998, -788.858728563626, -215.79742003870297, -220.96610391388663, -877.3866898214113, -2.536766686408227, -431.46911953759854, 6.8092587534077635, -411.24729180432814, -357.3571202480828, -280.07899763343784, -98.07700258729596, -271.2309928608916, 19.504695618809777, 3.3244182006077563, -201.8758271189478, 74.06665399176995, -308.42094595602106, -402.19425071706837, -21.528027459389758, -469.3255368224719, -71.53409771760401, -1.1487107044851967, -170.39067593452998, -745.2598882499358, -220.80584021056643, -144.15782256953415, -584.9542176215425, -472.15475065910687, -329.07585809952104, -292.22448372396894, -195.87672287447614, -478.9993714357074, 17.345643711480317, -468.9450701641858, 3.9876476765801954, -102.75700420123651, 53.67206062990939, -558.8024721875042, 44.026936284352615, -1213.673025496771, 6.287293568697898, -1.789259253183984, -382.11903280946694, 200.0, 194.00705246962067, -262.873690062937, 18.122847811786013, -688.7138379910014, 199.1, -609.3048618029959, -85.64075363274449, -493.2992998443417, 193.6802236210397], "policy_predator_policy_reward": [255.3322698965633, 130.07125627165826, 2.0558056320631812, 0.0, 232.06611917061483, 139.82491238617604, 2.7210494861696617, 6.841121465208259, 201.39903974000836, 0.0, 273.1031097580055, 336.0658681875693, 45.96049584036398, 319.4293579855226, 450.598565583138, 262.2948744990173, 522.5813793081808, 156.52128872101733, 46.05119639064905, 1272.5539820671302, 719.5154242029363, 271.0704197594494, 354.1410327571951, 188.2258489122047, 388.15639382134117, 633.863633677103, 5.9742174502812375, 43.08569787823241, 788.9425983424699, 551.9588772315775, 313.95573181134506, 12.05841659719482, 134.7014071636742, 277.78868802037294, 48.23024120367029, 438.84416858197875, 612.3040171923741, 108.48689176350072, 8.555327990332774, 113.10007536682184, 255.9757389711308, 519.9138035177854, 8.506209118451965, 190.83295924619443, 48.444458034853284, 20.336271637969237, 79.42337120830226, 239.06105182525454, 61.53485225331905, 877.6324598759372, 194.46910957245393, 238.23003824592752, 12.579668320655706, 66.89892515055838, 0.7726244092958185, 187.9719359598518, 297.0197609807994, 537.6862438502363, 484.2033634404431, 142.73738205885928, 661.9697939717756, 458.38522125291706, 81.67783111418011, 377.0979420060423, 583.0373764658381, 10.914165217298953, 38.43189509531024, 85.03449273000287, 320.13281700270716, 335.5161162285574, 305.35423661944355, 373.77665290041693, 91.43095796829525, 97.15181527126566, 268.8435668927072, 111.18030031971283, 279.80279500707934, 117.58296518792032, 176.61246780754075, 642.8694638477485, 215.74717531272734, 552.6467841296861, 462.02224126563203, 97.9238809180107, 420.85748615960966, 48.50031972160308, 213.34997858690463, 0.77252645366573, 0.0, 79.5517140598461, 0.0, 610.3797754470131, 735.0851814394664, 431.63972633427994, 202.13965191541033, 618.3306785724803, 323.7324065547491, 265.3103086444208, 5.2800305812929205, 420.3066301127114, 385.38166060544773, 175.4887332306046, 144.58932522086516, 378.4538524457515, 345.32842953770063, 48.88861482482226, 150.588687903072, 176.09540452500195, 36.32188658253674, 396.84083712433886, 125.26190974231206, 348.3294361702029, 187.8429463259002, 0.0, 423.6524093267669, 267.89358684700966, 154.18731267314283, 73.1754410465274, 21.622360259000367, 282.5432456015507, 82.30882344191647, 490.19926252940377, 44.99051781766513, 148.25979498423317, 2.4528118597322095, 544.0962224777405, 10.990253869202421, 471.31616073994235, 148.52160058504523, 298.17185566145207, 597.6405086805613, 34.43934895822284, 335.3836053310072, 0.0, 2.3457717734030252, 330.1474184249039, 653.0299063289882, 577.114530831792, 150.19578417960025, 256.6509214817742, 8.940612194859035, 179.52746189723644, 919.1872881165002, 694.87893176663, 97.78210231820259, 321.4679339389748, 0.0, 788.858728563626, 265.8392040921, 171.58078247919892, 878.2866898214115, 20.936766686408255, 431.46911953759854, 108.19074124659224, 402.1362054449747, 380.167330954734, 271.63666970929927, 161.2722071414478, 14.980744492811008, 316.87292170683816, 249.95557064328125, 45.67590695444713, 63.133346008230056, 320.4209459560212, 400.8717764891165, 151.0973069855178, 525.3255368224719, 89.13409771760399, 25.6388314102002, 249.40578983896927, 749.2598882499358, 251.80584021056637, 207.35782256953408, 586.8542176215425, 571.7493932206002, 77.49712458499039, 322.2366012384164, 230.2339877488311, 488.25372772422713, 0.0, 468.9450701641858, 136.0123523234198, 40.51253338116785, 178.65955656906564, 397.3592419470226, 440.1824210254195, 1213.973025496771, 12.41270643130207, 158.87565158727497, 357.1765997384448, 2.9929475303793183, 0.0, 104.19710628539092, 270.6407171359499, 254.75333563172373, 602.5389577445382, 613.7048618029958, 169.34075363274448, 499.8992998443418, 78.44253766106125]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0910863686040546, "mean_inference_ms": 3.239954663304013, "mean_action_processing_ms": 1.484766021308853, "mean_env_wait_ms": 0.6135996663289228, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009825587272644043, "StateBufferConnector_ms": 0.0041741132736206055, "ViewRequirementAgentConnector_ms": 0.13142812252044678}, "num_episodes": 18, "episode_return_max": 397.0, "episode_return_min": -160.18785922699215, "episode_return_mean": 105.47400186392517, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1520000, "num_agent_steps_trained": 1520000, "num_env_steps_sampled": 380000, "num_env_steps_trained": 380000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 81.26392711219941, "num_env_steps_trained_throughput_per_sec": 81.26392711219941, "timesteps_total": 380000, "num_env_steps_sampled_lifetime": 380000, "num_agent_steps_sampled_lifetime": 1520000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1520000, "timers": {"training_iteration_time_ms": 48744.344, "restore_workers_time_ms": 0.015, "training_step_time_ms": 48744.274, "sample_time_ms": 1571.931, "learn_time_ms": 47149.3, "learn_throughput": 84.837, "synch_weights_time_ms": 19.576}, "counters": {"num_env_steps_sampled": 380000, "num_env_steps_trained": 380000, "num_agent_steps_sampled": 1520000, "num_agent_steps_trained": 1520000}, "done": false, "training_iteration": 95, "trial_id": "cf3bb_00000", "date": "2024-08-20_10-02-10", "timestamp": 1724128330, "time_this_iter_s": 49.29097008705139, "time_total_s": 12591.821552038193, "pid": 25777, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39fe38dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 12591.821552038193, "iterations_since_restore": 95, "perf": {"cpu_util_percent": 39.21142857142857, "ram_util_percent": 80.2714285714286}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0688092750452813, "cur_kl_coeff": 4.399493336677551e-05, "cur_lr": 0.00010000000000000003, "total_loss": 8.173321834947696, "policy_loss": -0.0007659043823541314, "vf_loss": 8.174087711364503, "vf_explained_var": -0.005097093626304909, "kl": 0.002775756830340346, "entropy": 0.6004845091274806, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 180495.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 15.572042067593367, "cur_kl_coeff": 0.0052734375, "cur_lr": 0.00010000000000000003, "total_loss": 8.309353940953653, "policy_loss": -0.003479443721364809, "vf_loss": 8.31279842134506, "vf_explained_var": 0.19135712170727037, "kl": 0.006628246877060466, "entropy": 0.7810218932452025, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 180495.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_agent_steps_sampled": 1536000, "num_agent_steps_trained": 1536000}, "env_runners": {"episode_reward_max": 483.8650709359632, "episode_reward_min": -160.18785922699215, "episode_reward_mean": 97.35121530653382, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1395.459829145455, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 1266.1569549839944}, "policy_reward_mean": {"prey_policy": -242.1024952180145, "predator_policy": 290.7781028712814}, "custom_metrics": {}, "hist_stats": {"episode_reward": [112.1000000000002, 155.6833333333333, 63.70000000000012, 32.000000000000185, 33.4000000000002, 143.14315367108438, 3.465731464246806, 44.21205133055691, 145.98450807376022, -160.18785922699215, 204.6137132392938, 132.94062476544312, 122.38555938252564, 281.6, 45.200000000000074, 40.699483501085595, 90.89521669728111, 46.0, -0.5998465821306593, -35.01424213790849, 211.7506290909326, 242.4842815056454, 200.0, 2.999999999999999, -79.24614183946657, 73.8, 29.400000000000063, 180.57798976255842, 45.691914476273794, 75.02082750975376, 28.9383237334836, 12.79884096465077, 112.91850649074841, 175.30165211300488, -59.591521918879835, 76.19999999999968, 236.50511225948418, 166.78461275515025, 78.40000000000003, 205.5999999999995, 192.3, 104.77064899663252, 85.97738752938943, 55.28032873587104, 55.09533647677217, -101.21511981656268, 188.9406894758945, 196.6999999999998, -3.552713678800501e-15, -80.37228305348344, 113.59999999999998, 0.656462618709047, 19.29999999999997, 115.0, 13.699124347297902, 54.75287663001053, 80.12736895756737, 97.08006867938822, 149.19999999999956, 128.2468052981752, 73.60000000000004, 103.50523461015433, 34.999999999999886, 65.10000000000004, -151.98409095303674, 64.36938238880204, 26.600000000000065, 140.0, 170.08714637890645, 322.7661270692904, 19.0, 132.1439592630684, 397.0, 130.0869811701893, 367.6784553852599, 88.1, 278.7227612821009, 164.89717741129311, 138.8043297493104, 86.29999999999998, 74.15273835645843, 200.0, 16.89999999999999, 164.4711483969342, 483.8650709359632, 178.11491345955085, 43.48080398610283, 16.899999999999967, 59.43795763101094, 160.69999999999956, 95.49138514620009, -51.3024843770784, 115.0, 4.0, 146.0, 91.07678697693002, 112.09999999999926, 98.35959709539193, 13.100000000000001, 73.8], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-21.323371208302227, -185.06105182525462, -922.2839787959228, 138.79999999999998, -204.5913760652595, -164.40777175312223, -54.72930430315536, 7.250710831941289, 13.249999999999993, -168.5945603691484, -97.2520115484468, -594.3108396115033, -483.8033634404431, -139.67165059461286, -513.1676991398992, -562.975264754235, 66.20284566693476, -378.99411071339676, -328.6753925682281, -425.46400834190035, 21.619681058392644, 59.52764435558813, -88.22150251283693, -434.4868059529849, -243.55340612342454, -313.1919240139102, 25.16904203170455, 67.84818472873434, 0.504417959214494, -335.3282851716343, -212.79976964303566, -143.88650705087835, -644.5612330562352, -84.02548190177282, -169.7471753127274, -552.6467841296861, -271.5349310570055, -289.0110377087677, -300.0483732952514, -204.32367472386974, 71.32210532103157, -73.69398127066937, 109.6664257609629, 53.26614168483642, 200.0, -610.3797754470131, -735.0851814394664, -428.63972633427994, -434.56132834710337, -465.15514398025516, -323.53240655474906, -191.71030864442096, 14.119969418707045, -410.3066301127114, -382.73940462698465, 2.447000553490925, -245.259893700292, -232.09136949005207, -122.26328973375954, -196.93292711900966, -72.58836410672465, -225.15740458786567, -131.3027366480106, -289.06114609421496, -57.543403251563525, -303.129436170203, -7.3561696095102995, -5.185124603384947, -484.74393124564693, -266.3935868470097, -93.1873126731429, -57.975441046527756, 33.13112332204488, -100.79161692311169, 18.475789313233584, -424.19926252940405, -28.590517817664995, -86.25979498423321, 194.5471881402678, -535.4962224777386, 181.00974613079757, -471.01616073994234, -151.56431478705088, -190.3584924628141, -255.51203931100798, -290.5904307983863, -153.3301530073522, -126.7731235877832, -107.81786141611333, -169.5799923054214, -618.0287525017625, -713.330804475579, -219.1982035783287, 1.2921873928495826, 182.15938780514097, -173.9274618972366, -919.1872881165002, -694.87893176663, -198.66944395841014, -300.9528753522496, 113.59999999999998, -788.858728563626, -215.79742003870297, -220.96610391388663, -877.3866898214113, -2.536766686408227, -431.46911953759854, 6.8092587534077635, -411.24729180432814, -357.3571202480828, -280.07899763343784, -98.07700258729596, -271.2309928608916, 19.504695618809777, 3.3244182006077563, -201.8758271189478, 74.06665399176995, -308.42094595602106, -402.19425071706837, -21.528027459389758, -469.3255368224719, -71.53409771760401, -1.1487107044851967, -170.39067593452998, -745.2598882499358, -220.80584021056643, -144.15782256953415, -584.9542176215425, -472.15475065910687, -329.07585809952104, -292.22448372396894, -195.87672287447614, -478.9993714357074, 17.345643711480317, -468.9450701641858, 3.9876476765801954, -102.75700420123651, 53.67206062990939, -558.8024721875042, 44.026936284352615, -1213.673025496771, 6.287293568697898, -1.789259253183984, -382.11903280946694, 200.0, 194.00705246962067, -262.873690062937, 18.122847811786013, -688.7138379910014, 199.1, -609.3048618029959, -85.64075363274449, -493.2992998443417, 193.6802236210397, 122.53528157266628, -387.9026751639511, -15.98534385295757, -225.96108763523944, -833.5709422209476, -119.00030856125154, -247.53536801295016, 19.00177739592496, -970.5272053637989, 200.0, -501.9473622692648, -397.36643893212243, -17.703824475638413, -368.2785835934109, 196.92848151261887, -1395.459829145455, -248.5382336865968, -1.0381454756034296, -462.16391422310693, -164.63047616232916, -654.4214672997443, -8.201614892418998, -234.67735962970005, -243.45160447277283, -135.06186348683974, 104.97301324140898, -124.63611218354248, -455.4985077876567, -303.6637861562893, -167.11833206761986, -918.5345759928363, -15.827725226873417, -583.4914143935496, -408.501467685498, -749.9424119076708, 93.15716608849829, -146.82343527973066, -738.5421296930657, -75.47830348529425, -55.873747355942655, -17.279759974344785, -319.6255774061023, -370.19785628945783, -616.3210860199163, -463.64636207979964, -360.2594635036005], "policy_predator_policy_reward": [79.42337120830226, 239.06105182525454, 61.53485225331905, 877.6324598759372, 194.46910957245393, 238.23003824592752, 12.579668320655706, 66.89892515055838, 0.7726244092958185, 187.9719359598518, 297.0197609807994, 537.6862438502363, 484.2033634404431, 142.73738205885928, 661.9697939717756, 458.38522125291706, 81.67783111418011, 377.0979420060423, 583.0373764658381, 10.914165217298953, 38.43189509531024, 85.03449273000287, 320.13281700270716, 335.5161162285574, 305.35423661944355, 373.77665290041693, 91.43095796829525, 97.15181527126566, 268.8435668927072, 111.18030031971283, 279.80279500707934, 117.58296518792032, 176.61246780754075, 642.8694638477485, 215.74717531272734, 552.6467841296861, 462.02224126563203, 97.9238809180107, 420.85748615960966, 48.50031972160308, 213.34997858690463, 0.77252645366573, 0.0, 79.5517140598461, 0.0, 610.3797754470131, 735.0851814394664, 431.63972633427994, 202.13965191541033, 618.3306785724803, 323.7324065547491, 265.3103086444208, 5.2800305812929205, 420.3066301127114, 385.38166060544773, 175.4887332306046, 144.58932522086516, 378.4538524457515, 345.32842953770063, 48.88861482482226, 150.588687903072, 176.09540452500195, 36.32188658253674, 396.84083712433886, 125.26190974231206, 348.3294361702029, 187.8429463259002, 0.0, 423.6524093267669, 267.89358684700966, 154.18731267314283, 73.1754410465274, 21.622360259000367, 282.5432456015507, 82.30882344191647, 490.19926252940377, 44.99051781766513, 148.25979498423317, 2.4528118597322095, 544.0962224777405, 10.990253869202421, 471.31616073994235, 148.52160058504523, 298.17185566145207, 597.6405086805613, 34.43934895822284, 335.3836053310072, 0.0, 2.3457717734030252, 330.1474184249039, 653.0299063289882, 577.114530831792, 150.19578417960025, 256.6509214817742, 8.940612194859035, 179.52746189723644, 919.1872881165002, 694.87893176663, 97.78210231820259, 321.4679339389748, 0.0, 788.858728563626, 265.8392040921, 171.58078247919892, 878.2866898214115, 20.936766686408255, 431.46911953759854, 108.19074124659224, 402.1362054449747, 380.167330954734, 271.63666970929927, 161.2722071414478, 14.980744492811008, 316.87292170683816, 249.95557064328125, 45.67590695444713, 63.133346008230056, 320.4209459560212, 400.8717764891165, 151.0973069855178, 525.3255368224719, 89.13409771760399, 25.6388314102002, 249.40578983896927, 749.2598882499358, 251.80584021056637, 207.35782256953408, 586.8542176215425, 571.7493932206002, 77.49712458499039, 322.2366012384164, 230.2339877488311, 488.25372772422713, 0.0, 468.9450701641858, 136.0123523234198, 40.51253338116785, 178.65955656906564, 397.3592419470226, 440.1824210254195, 1213.973025496771, 12.41270643130207, 158.87565158727497, 357.1765997384448, 2.9929475303793183, 0.0, 104.19710628539092, 270.6407171359499, 254.75333563172373, 602.5389577445382, 613.7048618029958, 169.34075363274448, 499.8992998443418, 78.44253766106125, 36.95197372708326, 393.3125972754947, 380.7507612375073, 0.0, 836.8709422209474, 202.00030856125147, 240.8438344056341, 61.84249456784944, 970.5272053637989, 0.0, 518.1473622692648, 398.0664389321226, 408.2444479928479, 142.20910847313615, 416.2394635848005, 1266.1569549839944, 137.48466339964378, 290.20662922210755, 269.20596503817575, 401.0692293333633, 654.4214672997443, 25.101614892418972, 165.80720249001496, 371.75971924346993, 145.96186348683912, 44.82698675859107, 234.33974520797207, 441.28625990942703, 381.6014872677201, 37.87814657911023, 918.5345759928363, 130.82772522687347, 583.4914143935496, 412.501467685498, 749.9424119076708, 52.84283391150168, 263.51875907364956, 712.9235928760776, 169.4783034852944, 73.97374735594221, 208.49327523425276, 226.77165924158626, 377.1978562894579, 622.4210860199163, 464.44636207979966, 433.2594635036004]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0854105757809118, "mean_inference_ms": 3.223019490471651, "mean_action_processing_ms": 1.4692746278086246, "mean_env_wait_ms": 0.6080678599324076, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010866403579711914, "StateBufferConnector_ms": 0.0041245222091674805, "ViewRequirementAgentConnector_ms": 0.12604796886444092}, "num_episodes": 23, "episode_return_max": 483.8650709359632, "episode_return_min": -160.18785922699215, "episode_return_mean": 97.35121530653382, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1536000, "num_agent_steps_trained": 1536000, "num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 79.24515299225953, "num_env_steps_trained_throughput_per_sec": 79.24515299225953, "timesteps_total": 384000, "num_env_steps_sampled_lifetime": 384000, "num_agent_steps_sampled_lifetime": 1536000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1536000, "timers": {"training_iteration_time_ms": 49046.486, "restore_workers_time_ms": 0.015, "training_step_time_ms": 49046.416, "sample_time_ms": 1571.626, "learn_time_ms": 47450.743, "learn_throughput": 84.298, "synch_weights_time_ms": 20.706}, "counters": {"num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_agent_steps_sampled": 1536000, "num_agent_steps_trained": 1536000}, "done": false, "training_iteration": 96, "trial_id": "cf3bb_00000", "date": "2024-08-20_10-03-00", "timestamp": 1724128380, "time_this_iter_s": 50.52952980995178, "time_total_s": 12642.351081848145, "pid": 25777, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3aab1cb80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 12642.351081848145, "iterations_since_restore": 96, "perf": {"cpu_util_percent": 41.897183098591555, "ram_util_percent": 80.13521126760564}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5642484529150857, "cur_kl_coeff": 2.1997466683387755e-05, "cur_lr": 0.00010000000000000003, "total_loss": 7.154548711625356, "policy_loss": -0.003327629511323437, "vf_loss": 7.157876009411282, "vf_explained_var": -0.005893637768175236, "kl": 0.01697478531860994, "entropy": 0.6985890055459644, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 182385.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 11.45727305276684, "cur_kl_coeff": 0.0052734375, "cur_lr": 0.00010000000000000003, "total_loss": 8.170022476287116, "policy_loss": -0.0026215854886840416, "vf_loss": 8.172611874625796, "vf_explained_var": 0.2657797738673195, "kl": 0.006101996031329162, "entropy": 0.7274616633458112, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 182385.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 388000, "num_env_steps_trained": 388000, "num_agent_steps_sampled": 1552000, "num_agent_steps_trained": 1552000}, "env_runners": {"episode_reward_max": 483.8650709359632, "episode_reward_min": -151.98409095303674, "episode_reward_mean": 104.97389074104476, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1395.708340482001, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 1395.708340482001}, "policy_reward_mean": {"prey_policy": -242.28347403211203, "predator_policy": 294.77041940263445}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.5998465821306593, -35.01424213790849, 211.7506290909326, 242.4842815056454, 200.0, 2.999999999999999, -79.24614183946657, 73.8, 29.400000000000063, 180.57798976255842, 45.691914476273794, 75.02082750975376, 28.9383237334836, 12.79884096465077, 112.91850649074841, 175.30165211300488, -59.591521918879835, 76.19999999999968, 236.50511225948418, 166.78461275515025, 78.40000000000003, 205.5999999999995, 192.3, 104.77064899663252, 85.97738752938943, 55.28032873587104, 55.09533647677217, -101.21511981656268, 188.9406894758945, 196.6999999999998, -3.552713678800501e-15, -80.37228305348344, 113.59999999999998, 0.656462618709047, 19.29999999999997, 115.0, 13.699124347297902, 54.75287663001053, 80.12736895756737, 97.08006867938822, 149.19999999999956, 128.2468052981752, 73.60000000000004, 103.50523461015433, 34.999999999999886, 65.10000000000004, -151.98409095303674, 64.36938238880204, 26.600000000000065, 140.0, 170.08714637890645, 322.7661270692904, 19.0, 132.1439592630684, 397.0, 130.0869811701893, 367.6784553852599, 88.1, 278.7227612821009, 164.89717741129311, 138.8043297493104, 86.29999999999998, 74.15273835645843, 200.0, 16.89999999999999, 164.4711483969342, 483.8650709359632, 178.11491345955085, 43.48080398610283, 16.899999999999967, 59.43795763101094, 160.69999999999956, 95.49138514620009, -51.3024843770784, 115.0, 4.0, 146.0, 91.07678697693002, 112.09999999999926, 98.35959709539193, 13.100000000000001, 73.8, 72.10000000000001, 117.0, 16.99999999999997, 355.0, 117.90000000000002, 93.40846714088771, -133.60280424300757, 114.69999999999973, 103.35255939916229, 44.79999999999998, 100.26836368473946, 101.1, 310.4853702296249, 73.64506005479649, 202.40473247762478, 202.53036604885156, 158.0, 250.01094489003256], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-271.5349310570055, -289.0110377087677, -300.0483732952514, -204.32367472386974, 71.32210532103157, -73.69398127066937, 109.6664257609629, 53.26614168483642, 200.0, -610.3797754470131, -735.0851814394664, -428.63972633427994, -434.56132834710337, -465.15514398025516, -323.53240655474906, -191.71030864442096, 14.119969418707045, -410.3066301127114, -382.73940462698465, 2.447000553490925, -245.259893700292, -232.09136949005207, -122.26328973375954, -196.93292711900966, -72.58836410672465, -225.15740458786567, -131.3027366480106, -289.06114609421496, -57.543403251563525, -303.129436170203, -7.3561696095102995, -5.185124603384947, -484.74393124564693, -266.3935868470097, -93.1873126731429, -57.975441046527756, 33.13112332204488, -100.79161692311169, 18.475789313233584, -424.19926252940405, -28.590517817664995, -86.25979498423321, 194.5471881402678, -535.4962224777386, 181.00974613079757, -471.01616073994234, -151.56431478705088, -190.3584924628141, -255.51203931100798, -290.5904307983863, -153.3301530073522, -126.7731235877832, -107.81786141611333, -169.5799923054214, -618.0287525017625, -713.330804475579, -219.1982035783287, 1.2921873928495826, 182.15938780514097, -173.9274618972366, -919.1872881165002, -694.87893176663, -198.66944395841014, -300.9528753522496, 113.59999999999998, -788.858728563626, -215.79742003870297, -220.96610391388663, -877.3866898214113, -2.536766686408227, -431.46911953759854, 6.8092587534077635, -411.24729180432814, -357.3571202480828, -280.07899763343784, -98.07700258729596, -271.2309928608916, 19.504695618809777, 3.3244182006077563, -201.8758271189478, 74.06665399176995, -308.42094595602106, -402.19425071706837, -21.528027459389758, -469.3255368224719, -71.53409771760401, -1.1487107044851967, -170.39067593452998, -745.2598882499358, -220.80584021056643, -144.15782256953415, -584.9542176215425, -472.15475065910687, -329.07585809952104, -292.22448372396894, -195.87672287447614, -478.9993714357074, 17.345643711480317, -468.9450701641858, 3.9876476765801954, -102.75700420123651, 53.67206062990939, -558.8024721875042, 44.026936284352615, -1213.673025496771, 6.287293568697898, -1.789259253183984, -382.11903280946694, 200.0, 194.00705246962067, -262.873690062937, 18.122847811786013, -688.7138379910014, 199.1, -609.3048618029959, -85.64075363274449, -493.2992998443417, 193.6802236210397, 122.53528157266628, -387.9026751639511, -15.98534385295757, -225.96108763523944, -833.5709422209476, -119.00030856125154, -247.53536801295016, 19.00177739592496, -970.5272053637989, 200.0, -501.9473622692648, -397.36643893212243, -17.703824475638413, -368.2785835934109, 196.92848151261887, -1395.459829145455, -248.5382336865968, -1.0381454756034296, -462.16391422310693, -164.63047616232916, -654.4214672997443, -8.201614892418998, -234.67735962970005, -243.45160447277283, -135.06186348683974, 104.97301324140898, -124.63611218354248, -455.4985077876567, -303.6637861562893, -167.11833206761986, -918.5345759928363, -15.827725226873417, -583.4914143935496, -408.501467685498, -749.9424119076708, 93.15716608849829, -146.82343527973066, -738.5421296930657, -75.47830348529425, -55.873747355942655, -17.279759974344785, -319.6255774061023, -370.19785628945783, -616.3210860199163, -463.64636207979964, -360.2594635036005, -185.8368871998774, -117.26913291596586, -1113.2904558733994, -102.30811700866767, -683.2308008797581, -60.41184557794308, 200.0, 81.20478091603864, -346.64804254525916, -39.528490631463555, -67.99960368325759, -45.53673647868505, -465.39336259076384, -314.3299043677142, -83.00143971900627, -483.93210850927073, -111.47872690309865, -79.32487955678072, -286.4097793699517, -496.85442424117673, -246.49695166100312, -176.97412364096732, -18.0282437038856, -1395.708340482001, 143.84484721950304, 106.80480262141963, 8.045804175807975, -465.67920949859155, -268.98099084362934, 130.90580978663587, 118.1731717176101, -194.79689160762135, -612.8776869161528, 118.87271998006658, -67.32867306231135, -481.973953037829], "policy_predator_policy_reward": [462.02224126563203, 97.9238809180107, 420.85748615960966, 48.50031972160308, 213.34997858690463, 0.77252645366573, 0.0, 79.5517140598461, 0.0, 610.3797754470131, 735.0851814394664, 431.63972633427994, 202.13965191541033, 618.3306785724803, 323.7324065547491, 265.3103086444208, 5.2800305812929205, 420.3066301127114, 385.38166060544773, 175.4887332306046, 144.58932522086516, 378.4538524457515, 345.32842953770063, 48.88861482482226, 150.588687903072, 176.09540452500195, 36.32188658253674, 396.84083712433886, 125.26190974231206, 348.3294361702029, 187.8429463259002, 0.0, 423.6524093267669, 267.89358684700966, 154.18731267314283, 73.1754410465274, 21.622360259000367, 282.5432456015507, 82.30882344191647, 490.19926252940377, 44.99051781766513, 148.25979498423317, 2.4528118597322095, 544.0962224777405, 10.990253869202421, 471.31616073994235, 148.52160058504523, 298.17185566145207, 597.6405086805613, 34.43934895822284, 335.3836053310072, 0.0, 2.3457717734030252, 330.1474184249039, 653.0299063289882, 577.114530831792, 150.19578417960025, 256.6509214817742, 8.940612194859035, 179.52746189723644, 919.1872881165002, 694.87893176663, 97.78210231820259, 321.4679339389748, 0.0, 788.858728563626, 265.8392040921, 171.58078247919892, 878.2866898214115, 20.936766686408255, 431.46911953759854, 108.19074124659224, 402.1362054449747, 380.167330954734, 271.63666970929927, 161.2722071414478, 14.980744492811008, 316.87292170683816, 249.95557064328125, 45.67590695444713, 63.133346008230056, 320.4209459560212, 400.8717764891165, 151.0973069855178, 525.3255368224719, 89.13409771760399, 25.6388314102002, 249.40578983896927, 749.2598882499358, 251.80584021056637, 207.35782256953408, 586.8542176215425, 571.7493932206002, 77.49712458499039, 322.2366012384164, 230.2339877488311, 488.25372772422713, 0.0, 468.9450701641858, 136.0123523234198, 40.51253338116785, 178.65955656906564, 397.3592419470226, 440.1824210254195, 1213.973025496771, 12.41270643130207, 158.87565158727497, 357.1765997384448, 2.9929475303793183, 0.0, 104.19710628539092, 270.6407171359499, 254.75333563172373, 602.5389577445382, 613.7048618029958, 169.34075363274448, 499.8992998443418, 78.44253766106125, 36.95197372708326, 393.3125972754947, 380.7507612375073, 0.0, 836.8709422209474, 202.00030856125147, 240.8438344056341, 61.84249456784944, 970.5272053637989, 0.0, 518.1473622692648, 398.0664389321226, 408.2444479928479, 142.20910847313615, 416.2394635848005, 1266.1569549839944, 137.48466339964378, 290.20662922210755, 269.20596503817575, 401.0692293333633, 654.4214672997443, 25.101614892418972, 165.80720249001496, 371.75971924346993, 145.96186348683912, 44.82698675859107, 234.33974520797207, 441.28625990942703, 381.6014872677201, 37.87814657911023, 918.5345759928363, 130.82772522687347, 583.4914143935496, 412.501467685498, 749.9424119076708, 52.84283391150168, 263.51875907364956, 712.9235928760776, 169.4783034852944, 73.97374735594221, 208.49327523425276, 226.77165924158626, 377.1978562894579, 622.4210860199163, 464.44636207979966, 433.2594635036004, 251.54014401110413, 123.66587610473873, 1113.2904558733994, 219.30811700866764, 683.2308008797581, 77.41184557794237, 0.0, 73.79521908396136, 352.24804254525924, 151.8284906314636, 4.288155029797675, 202.65665227303293, 319.0217700676621, 327.09869264780866, 190.00143971900624, 491.6321085092725, 270.7036525457115, 23.45251331333012, 330.50977936995184, 497.5544242411769, 260.3134823910477, 263.4259565956627, 119.12824370388553, 1395.708340482001, 54.90231821334509, 4.9334021753571555, 479.0388281763828, 52.239637201197205, 246.29712454993907, 94.18278898467922, 9.35719433124137, 269.79689160762103, 612.8776869161528, 39.127280019933416, 317.883786194854, 481.4297847953195]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0822771385550032, "mean_inference_ms": 3.209771506941322, "mean_action_processing_ms": 1.4581463035620477, "mean_env_wait_ms": 0.6047396649030375, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010708451271057129, "StateBufferConnector_ms": 0.004211902618408203, "ViewRequirementAgentConnector_ms": 0.14001500606536865}, "num_episodes": 18, "episode_return_max": 483.8650709359632, "episode_return_min": -151.98409095303674, "episode_return_mean": 104.97389074104476, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1552000, "num_agent_steps_trained": 1552000, "num_env_steps_sampled": 388000, "num_env_steps_trained": 388000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 78.77263069408227, "num_env_steps_trained_throughput_per_sec": 78.77263069408227, "timesteps_total": 388000, "num_env_steps_sampled_lifetime": 388000, "num_agent_steps_sampled_lifetime": 1552000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1552000, "timers": {"training_iteration_time_ms": 49417.382, "restore_workers_time_ms": 0.015, "training_step_time_ms": 49417.314, "sample_time_ms": 1663.304, "learn_time_ms": 47730.158, "learn_throughput": 83.804, "synch_weights_time_ms": 20.572}, "counters": {"num_env_steps_sampled": 388000, "num_env_steps_trained": 388000, "num_agent_steps_sampled": 1552000, "num_agent_steps_trained": 1552000}, "done": false, "training_iteration": 97, "trial_id": "cf3bb_00000", "date": "2024-08-20_10-03-51", "timestamp": 1724128431, "time_this_iter_s": 50.81040382385254, "time_total_s": 12693.161485671997, "pid": 25777, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39f79daf0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 12693.161485671997, "iterations_since_restore": 97, "perf": {"cpu_util_percent": 40.56388888888889, "ram_util_percent": 79.98750000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.813798354593692, "cur_kl_coeff": 2.1997466683387755e-05, "cur_lr": 0.00010000000000000003, "total_loss": 7.098128675026868, "policy_loss": -0.00394475517927536, "vf_loss": 7.102073409822252, "vf_explained_var": -0.0016071235692059552, "kl": 0.005551120269196957, "entropy": 0.8297287875382358, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 184275.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.652792869799983, "cur_kl_coeff": 0.0052734375, "cur_lr": 0.00010000000000000003, "total_loss": 7.877364626132622, "policy_loss": -0.0024739573825466096, "vf_loss": 7.879799679347447, "vf_explained_var": 0.06724991940316699, "kl": 0.007377395410561825, "entropy": 0.6742381088002019, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 184275.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 392000, "num_env_steps_trained": 392000, "num_agent_steps_sampled": 1568000, "num_agent_steps_trained": 1568000}, "env_runners": {"episode_reward_max": 483.8650709359632, "episode_reward_min": -529.8294972918713, "episode_reward_mean": 95.35341697324502, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1609.8020260507324, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 1609.8020260507324}, "policy_reward_mean": {"prey_policy": -262.4026170072717, "predator_policy": 310.07932549389426}, "custom_metrics": {}, "hist_stats": {"episode_reward": [192.3, 104.77064899663252, 85.97738752938943, 55.28032873587104, 55.09533647677217, -101.21511981656268, 188.9406894758945, 196.6999999999998, -3.552713678800501e-15, -80.37228305348344, 113.59999999999998, 0.656462618709047, 19.29999999999997, 115.0, 13.699124347297902, 54.75287663001053, 80.12736895756737, 97.08006867938822, 149.19999999999956, 128.2468052981752, 73.60000000000004, 103.50523461015433, 34.999999999999886, 65.10000000000004, -151.98409095303674, 64.36938238880204, 26.600000000000065, 140.0, 170.08714637890645, 322.7661270692904, 19.0, 132.1439592630684, 397.0, 130.0869811701893, 367.6784553852599, 88.1, 278.7227612821009, 164.89717741129311, 138.8043297493104, 86.29999999999998, 74.15273835645843, 200.0, 16.89999999999999, 164.4711483969342, 483.8650709359632, 178.11491345955085, 43.48080398610283, 16.899999999999967, 59.43795763101094, 160.69999999999956, 95.49138514620009, -51.3024843770784, 115.0, 4.0, 146.0, 91.07678697693002, 112.09999999999926, 98.35959709539193, 13.100000000000001, 73.8, 72.10000000000001, 117.0, 16.99999999999997, 355.0, 117.90000000000002, 93.40846714088771, -133.60280424300757, 114.69999999999973, 103.35255939916229, 44.79999999999998, 100.26836368473946, 101.1, 310.4853702296249, 73.64506005479649, 202.40473247762478, 202.53036604885156, 158.0, 250.01094489003256, -529.8294972918713, 123.99999999999989, -88.47895112274756, 164.03265167929624, 93.29999999999933, 28.500000000000135, 142.0, 37.600000000000264, 35.345105466176854, 114.99999999999997, 91.0, 19.400000000000034, 64.40000000000008, -27.989783085714436, -257.83472130990475, 234.15020491898952, 131.34414577246076, 216.19999999999928, 148.80610942436238, 85.99946453204024, 81.09999999999958, 110.6288324202402], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [181.00974613079757, -471.01616073994234, -151.56431478705088, -190.3584924628141, -255.51203931100798, -290.5904307983863, -153.3301530073522, -126.7731235877832, -107.81786141611333, -169.5799923054214, -618.0287525017625, -713.330804475579, -219.1982035783287, 1.2921873928495826, 182.15938780514097, -173.9274618972366, -919.1872881165002, -694.87893176663, -198.66944395841014, -300.9528753522496, 113.59999999999998, -788.858728563626, -215.79742003870297, -220.96610391388663, -877.3866898214113, -2.536766686408227, -431.46911953759854, 6.8092587534077635, -411.24729180432814, -357.3571202480828, -280.07899763343784, -98.07700258729596, -271.2309928608916, 19.504695618809777, 3.3244182006077563, -201.8758271189478, 74.06665399176995, -308.42094595602106, -402.19425071706837, -21.528027459389758, -469.3255368224719, -71.53409771760401, -1.1487107044851967, -170.39067593452998, -745.2598882499358, -220.80584021056643, -144.15782256953415, -584.9542176215425, -472.15475065910687, -329.07585809952104, -292.22448372396894, -195.87672287447614, -478.9993714357074, 17.345643711480317, -468.9450701641858, 3.9876476765801954, -102.75700420123651, 53.67206062990939, -558.8024721875042, 44.026936284352615, -1213.673025496771, 6.287293568697898, -1.789259253183984, -382.11903280946694, 200.0, 194.00705246962067, -262.873690062937, 18.122847811786013, -688.7138379910014, 199.1, -609.3048618029959, -85.64075363274449, -493.2992998443417, 193.6802236210397, 122.53528157266628, -387.9026751639511, -15.98534385295757, -225.96108763523944, -833.5709422209476, -119.00030856125154, -247.53536801295016, 19.00177739592496, -970.5272053637989, 200.0, -501.9473622692648, -397.36643893212243, -17.703824475638413, -368.2785835934109, 196.92848151261887, -1395.459829145455, -248.5382336865968, -1.0381454756034296, -462.16391422310693, -164.63047616232916, -654.4214672997443, -8.201614892418998, -234.67735962970005, -243.45160447277283, -135.06186348683974, 104.97301324140898, -124.63611218354248, -455.4985077876567, -303.6637861562893, -167.11833206761986, -918.5345759928363, -15.827725226873417, -583.4914143935496, -408.501467685498, -749.9424119076708, 93.15716608849829, -146.82343527973066, -738.5421296930657, -75.47830348529425, -55.873747355942655, -17.279759974344785, -319.6255774061023, -370.19785628945783, -616.3210860199163, -463.64636207979964, -360.2594635036005, -185.8368871998774, -117.26913291596586, -1113.2904558733994, -102.30811700866767, -683.2308008797581, -60.41184557794308, 200.0, 81.20478091603864, -346.64804254525916, -39.528490631463555, -67.99960368325759, -45.53673647868505, -465.39336259076384, -314.3299043677142, -83.00143971900627, -483.93210850927073, -111.47872690309865, -79.32487955678072, -286.4097793699517, -496.85442424117673, -246.49695166100312, -176.97412364096732, -18.0282437038856, -1395.708340482001, 143.84484721950304, 106.80480262141963, 8.045804175807975, -465.67920949859155, -268.98099084362934, 130.90580978663587, 118.1731717176101, -194.79689160762135, -612.8776869161528, 118.87271998006658, -67.32867306231135, -481.973953037829, -631.3655558406156, -830.1160783698948, -173.85853487026796, -36.64387917707892, -98.25478658718582, -516.1599677091599, -266.5810310139559, -83.79345421887453, -7.811480492728194, -183.3911011638796, 3.5187043733867287, -374.14480306354864, -816.8519664178344, 27.228788560409907, 18.98848878971452, -18.120896316761147, -124.88106734490283, -415.56215165769856, 24.229071845730328, -742.5676308555779, -21.134176792862853, -1609.8020260507324, -372.72765194638055, 1.04931710354638, -229.29235583007983, -156.5848280109588, -549.1891555532956, -638.1658788378065, -921.1726641154074, -361.13699146715925, 48.280508078217984, -330.9269548009093, -171.05831831521132, -580.9102205656721, -21.152173324417085, 197.19359353711224, -278.139775867452, -10.724769076054969, -90.82714102102322, -603.823998942695, -336.246376253285, -56.094869787128864, 3.5913835046562883, -77.94885085325616], "policy_predator_policy_reward": [10.990253869202421, 471.31616073994235, 148.52160058504523, 298.17185566145207, 597.6405086805613, 34.43934895822284, 335.3836053310072, 0.0, 2.3457717734030252, 330.1474184249039, 653.0299063289882, 577.114530831792, 150.19578417960025, 256.6509214817742, 8.940612194859035, 179.52746189723644, 919.1872881165002, 694.87893176663, 97.78210231820259, 321.4679339389748, 0.0, 788.858728563626, 265.8392040921, 171.58078247919892, 878.2866898214115, 20.936766686408255, 431.46911953759854, 108.19074124659224, 402.1362054449747, 380.167330954734, 271.63666970929927, 161.2722071414478, 14.980744492811008, 316.87292170683816, 249.95557064328125, 45.67590695444713, 63.133346008230056, 320.4209459560212, 400.8717764891165, 151.0973069855178, 525.3255368224719, 89.13409771760399, 25.6388314102002, 249.40578983896927, 749.2598882499358, 251.80584021056637, 207.35782256953408, 586.8542176215425, 571.7493932206002, 77.49712458499039, 322.2366012384164, 230.2339877488311, 488.25372772422713, 0.0, 468.9450701641858, 136.0123523234198, 40.51253338116785, 178.65955656906564, 397.3592419470226, 440.1824210254195, 1213.973025496771, 12.41270643130207, 158.87565158727497, 357.1765997384448, 2.9929475303793183, 0.0, 104.19710628539092, 270.6407171359499, 254.75333563172373, 602.5389577445382, 613.7048618029958, 169.34075363274448, 499.8992998443418, 78.44253766106125, 36.95197372708326, 393.3125972754947, 380.7507612375073, 0.0, 836.8709422209474, 202.00030856125147, 240.8438344056341, 61.84249456784944, 970.5272053637989, 0.0, 518.1473622692648, 398.0664389321226, 408.2444479928479, 142.20910847313615, 416.2394635848005, 1266.1569549839944, 137.48466339964378, 290.20662922210755, 269.20596503817575, 401.0692293333633, 654.4214672997443, 25.101614892418972, 165.80720249001496, 371.75971924346993, 145.96186348683912, 44.82698675859107, 234.33974520797207, 441.28625990942703, 381.6014872677201, 37.87814657911023, 918.5345759928363, 130.82772522687347, 583.4914143935496, 412.501467685498, 749.9424119076708, 52.84283391150168, 263.51875907364956, 712.9235928760776, 169.4783034852944, 73.97374735594221, 208.49327523425276, 226.77165924158626, 377.1978562894579, 622.4210860199163, 464.44636207979966, 433.2594635036004, 251.54014401110413, 123.66587610473873, 1113.2904558733994, 219.30811700866764, 683.2308008797581, 77.41184557794237, 0.0, 73.79521908396136, 352.24804254525924, 151.8284906314636, 4.288155029797675, 202.65665227303293, 319.0217700676621, 327.09869264780866, 190.00143971900624, 491.6321085092725, 270.7036525457115, 23.45251331333012, 330.50977936995184, 497.5544242411769, 260.3134823910477, 263.4259565956627, 119.12824370388553, 1395.708340482001, 54.90231821334509, 4.9334021753571555, 479.0388281763828, 52.239637201197205, 246.29712454993907, 94.18278898467922, 9.35719433124137, 269.79689160762103, 612.8776869161528, 39.127280019933416, 317.883786194854, 481.4297847953195, 5.208061701663104, 926.4440752169745, 183.85853487026796, 150.643879177079, 1.7758354644383347, 524.1599677091598, 107.74542182648577, 406.6617150856414, 26.111480492728308, 258.3911011638796, 15.381295626613236, 383.7448030635488, 816.8519664178344, 114.7712114395901, 0.9115112102854807, 35.8208963167614, 217.761755253715, 358.02656921506264, 90.77092815426985, 742.5676308555779, 112.13417679286282, 1609.8020260507324, 373.72765194638055, 17.3506828964536, 235.6923558300794, 214.5848280109589, 2.4576674092437503, 1156.9075838961444, 922.2426120413213, 102.23232223134058, 160.8674424290904, 355.9292092125905, 283.6340794781347, 599.6786051752094, 39.25217332441734, 0.9064064628877493, 437.670654367869, 0.0, 159.06208150527664, 621.5885229904823, 403.2463762532847, 70.19486978712878, 59.78462602842904, 125.20167374041185]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0783385174312807, "mean_inference_ms": 3.1547258693157776, "mean_action_processing_ms": 1.4818403893529135, "mean_env_wait_ms": 0.6013400628239214, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007743358612060547, "StateBufferConnector_ms": 0.004202485084533691, "ViewRequirementAgentConnector_ms": 0.13731813430786133}, "num_episodes": 22, "episode_return_max": 483.8650709359632, "episode_return_min": -529.8294972918713, "episode_return_mean": 95.35341697324502, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1568000, "num_agent_steps_trained": 1568000, "num_env_steps_sampled": 392000, "num_env_steps_trained": 392000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 80.66529040128337, "num_env_steps_trained_throughput_per_sec": 80.66529040128337, "timesteps_total": 392000, "num_env_steps_sampled_lifetime": 392000, "num_agent_steps_sampled_lifetime": 1568000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1568000, "timers": {"training_iteration_time_ms": 49658.487, "restore_workers_time_ms": 0.015, "training_step_time_ms": 49658.419, "sample_time_ms": 1685.866, "learn_time_ms": 47949.13, "learn_throughput": 83.422, "synch_weights_time_ms": 20.358}, "counters": {"num_env_steps_sampled": 392000, "num_env_steps_trained": 392000, "num_agent_steps_sampled": 1568000, "num_agent_steps_trained": 1568000}, "done": false, "training_iteration": 98, "trial_id": "cf3bb_00000", "date": "2024-08-20_10-04-41", "timestamp": 1724128481, "time_this_iter_s": 49.6417977809906, "time_total_s": 12742.803283452988, "pid": 25777, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39fcb9dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 12742.803283452988, "iterations_since_restore": 98, "perf": {"cpu_util_percent": 43.25492957746478, "ram_util_percent": 80.14084507042253}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6113439347930055, "cur_kl_coeff": 2.1997466683387755e-05, "cur_lr": 0.00010000000000000003, "total_loss": 8.363199882154111, "policy_loss": -0.0030930344493340246, "vf_loss": 8.366292916908465, "vf_explained_var": -0.0015711143849388002, "kl": 0.008528258503320368, "entropy": 0.8252163937167516, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 186165.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.10699803658894, "cur_kl_coeff": 0.0052734375, "cur_lr": 0.00010000000000000003, "total_loss": 8.861513003848849, "policy_loss": -0.0036500256074957116, "vf_loss": 8.86512182175167, "vf_explained_var": 0.051215637676299566, "kl": 0.007813811482199971, "entropy": 0.6834775012006205, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 186165.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_agent_steps_sampled": 1584000, "num_agent_steps_trained": 1584000}, "env_runners": {"episode_reward_max": 483.8650709359632, "episode_reward_min": -529.8294972918713, "episode_reward_mean": 89.54923752831007, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1609.8020260507324, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 1609.8020260507324}, "policy_reward_mean": {"prey_policy": -288.13083904736675, "predator_policy": 332.90545781152184}, "custom_metrics": {}, "hist_stats": {"episode_reward": [149.19999999999956, 128.2468052981752, 73.60000000000004, 103.50523461015433, 34.999999999999886, 65.10000000000004, -151.98409095303674, 64.36938238880204, 26.600000000000065, 140.0, 170.08714637890645, 322.7661270692904, 19.0, 132.1439592630684, 397.0, 130.0869811701893, 367.6784553852599, 88.1, 278.7227612821009, 164.89717741129311, 138.8043297493104, 86.29999999999998, 74.15273835645843, 200.0, 16.89999999999999, 164.4711483969342, 483.8650709359632, 178.11491345955085, 43.48080398610283, 16.899999999999967, 59.43795763101094, 160.69999999999956, 95.49138514620009, -51.3024843770784, 115.0, 4.0, 146.0, 91.07678697693002, 112.09999999999926, 98.35959709539193, 13.100000000000001, 73.8, 72.10000000000001, 117.0, 16.99999999999997, 355.0, 117.90000000000002, 93.40846714088771, -133.60280424300757, 114.69999999999973, 103.35255939916229, 44.79999999999998, 100.26836368473946, 101.1, 310.4853702296249, 73.64506005479649, 202.40473247762478, 202.53036604885156, 158.0, 250.01094489003256, -529.8294972918713, 123.99999999999989, -88.47895112274756, 164.03265167929624, 93.29999999999933, 28.500000000000135, 142.0, 37.600000000000264, 35.345105466176854, 114.99999999999997, 91.0, 19.400000000000034, 64.40000000000008, -27.989783085714436, -257.83472130990475, 234.15020491898952, 131.34414577246076, 216.19999999999928, 148.80610942436238, 85.99946453204024, 81.09999999999958, 110.6288324202402, 120.0, 34.200000000000216, -13.798931363675958, 94.01992238316855, 137.05458688698178, 102.37241529784856, 4.647544990891619, 65.47672770870655, -13.518459275787144, 68.03840367583524, 0.1999999999999993, 223.96629354389898, 81.77866347083058, 77.00000000000004, -308.449893271393, -304.89999999999986, 161.1876710366877, 82.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [74.06665399176995, -308.42094595602106, -402.19425071706837, -21.528027459389758, -469.3255368224719, -71.53409771760401, -1.1487107044851967, -170.39067593452998, -745.2598882499358, -220.80584021056643, -144.15782256953415, -584.9542176215425, -472.15475065910687, -329.07585809952104, -292.22448372396894, -195.87672287447614, -478.9993714357074, 17.345643711480317, -468.9450701641858, 3.9876476765801954, -102.75700420123651, 53.67206062990939, -558.8024721875042, 44.026936284352615, -1213.673025496771, 6.287293568697898, -1.789259253183984, -382.11903280946694, 200.0, 194.00705246962067, -262.873690062937, 18.122847811786013, -688.7138379910014, 199.1, -609.3048618029959, -85.64075363274449, -493.2992998443417, 193.6802236210397, 122.53528157266628, -387.9026751639511, -15.98534385295757, -225.96108763523944, -833.5709422209476, -119.00030856125154, -247.53536801295016, 19.00177739592496, -970.5272053637989, 200.0, -501.9473622692648, -397.36643893212243, -17.703824475638413, -368.2785835934109, 196.92848151261887, -1395.459829145455, -248.5382336865968, -1.0381454756034296, -462.16391422310693, -164.63047616232916, -654.4214672997443, -8.201614892418998, -234.67735962970005, -243.45160447277283, -135.06186348683974, 104.97301324140898, -124.63611218354248, -455.4985077876567, -303.6637861562893, -167.11833206761986, -918.5345759928363, -15.827725226873417, -583.4914143935496, -408.501467685498, -749.9424119076708, 93.15716608849829, -146.82343527973066, -738.5421296930657, -75.47830348529425, -55.873747355942655, -17.279759974344785, -319.6255774061023, -370.19785628945783, -616.3210860199163, -463.64636207979964, -360.2594635036005, -185.8368871998774, -117.26913291596586, -1113.2904558733994, -102.30811700866767, -683.2308008797581, -60.41184557794308, 200.0, 81.20478091603864, -346.64804254525916, -39.528490631463555, -67.99960368325759, -45.53673647868505, -465.39336259076384, -314.3299043677142, -83.00143971900627, -483.93210850927073, -111.47872690309865, -79.32487955678072, -286.4097793699517, -496.85442424117673, -246.49695166100312, -176.97412364096732, -18.0282437038856, -1395.708340482001, 143.84484721950304, 106.80480262141963, 8.045804175807975, -465.67920949859155, -268.98099084362934, 130.90580978663587, 118.1731717176101, -194.79689160762135, -612.8776869161528, 118.87271998006658, -67.32867306231135, -481.973953037829, -631.3655558406156, -830.1160783698948, -173.85853487026796, -36.64387917707892, -98.25478658718582, -516.1599677091599, -266.5810310139559, -83.79345421887453, -7.811480492728194, -183.3911011638796, 3.5187043733867287, -374.14480306354864, -816.8519664178344, 27.228788560409907, 18.98848878971452, -18.120896316761147, -124.88106734490283, -415.56215165769856, 24.229071845730328, -742.5676308555779, -21.134176792862853, -1609.8020260507324, -372.72765194638055, 1.04931710354638, -229.29235583007983, -156.5848280109588, -549.1891555532956, -638.1658788378065, -921.1726641154074, -361.13699146715925, 48.280508078217984, -330.9269548009093, -171.05831831521132, -580.9102205656721, -21.152173324417085, 197.19359353711224, -278.139775867452, -10.724769076054969, -90.82714102102322, -603.823998942695, -336.246376253285, -56.094869787128864, 3.5913835046562883, -77.94885085325616, -3.599265503601033, -839.5249325078565, -13.475252559449615, -40.647816446934634, -387.00994872580367, -330.0266235885045, -96.17760877259636, -502.32613019234896, -511.2552849840097, -380.2734092077969, -438.5753334987566, -138.92890170176935, -378.4300140815294, -344.3557730604146, -314.80566625744956, -252.0950896644533, -480.78273659969767, -210.10899451397262, -287.53619979366937, -357.4960101877501, -1242.3190782739555, -872.9630719116719, -133.37694687561157, -726.8265905962122, -231.24800980784542, -361.3874513673859, -1262.1644976966672, -209.83501600331152, -505.9483089708391, -692.2614214414791, -332.751990886577, -339.092715547357, -611.1382273148646, -129.63059383530185, -543.338358501286, -47.829834115861786], "policy_predator_policy_reward": [63.133346008230056, 320.4209459560212, 400.8717764891165, 151.0973069855178, 525.3255368224719, 89.13409771760399, 25.6388314102002, 249.40578983896927, 749.2598882499358, 251.80584021056637, 207.35782256953408, 586.8542176215425, 571.7493932206002, 77.49712458499039, 322.2366012384164, 230.2339877488311, 488.25372772422713, 0.0, 468.9450701641858, 136.0123523234198, 40.51253338116785, 178.65955656906564, 397.3592419470226, 440.1824210254195, 1213.973025496771, 12.41270643130207, 158.87565158727497, 357.1765997384448, 2.9929475303793183, 0.0, 104.19710628539092, 270.6407171359499, 254.75333563172373, 602.5389577445382, 613.7048618029958, 169.34075363274448, 499.8992998443418, 78.44253766106125, 36.95197372708326, 393.3125972754947, 380.7507612375073, 0.0, 836.8709422209474, 202.00030856125147, 240.8438344056341, 61.84249456784944, 970.5272053637989, 0.0, 518.1473622692648, 398.0664389321226, 408.2444479928479, 142.20910847313615, 416.2394635848005, 1266.1569549839944, 137.48466339964378, 290.20662922210755, 269.20596503817575, 401.0692293333633, 654.4214672997443, 25.101614892418972, 165.80720249001496, 371.75971924346993, 145.96186348683912, 44.82698675859107, 234.33974520797207, 441.28625990942703, 381.6014872677201, 37.87814657911023, 918.5345759928363, 130.82772522687347, 583.4914143935496, 412.501467685498, 749.9424119076708, 52.84283391150168, 263.51875907364956, 712.9235928760776, 169.4783034852944, 73.97374735594221, 208.49327523425276, 226.77165924158626, 377.1978562894579, 622.4210860199163, 464.44636207979966, 433.2594635036004, 251.54014401110413, 123.66587610473873, 1113.2904558733994, 219.30811700866764, 683.2308008797581, 77.41184557794237, 0.0, 73.79521908396136, 352.24804254525924, 151.8284906314636, 4.288155029797675, 202.65665227303293, 319.0217700676621, 327.09869264780866, 190.00143971900624, 491.6321085092725, 270.7036525457115, 23.45251331333012, 330.50977936995184, 497.5544242411769, 260.3134823910477, 263.4259565956627, 119.12824370388553, 1395.708340482001, 54.90231821334509, 4.9334021753571555, 479.0388281763828, 52.239637201197205, 246.29712454993907, 94.18278898467922, 9.35719433124137, 269.79689160762103, 612.8776869161528, 39.127280019933416, 317.883786194854, 481.4297847953195, 5.208061701663104, 926.4440752169745, 183.85853487026796, 150.643879177079, 1.7758354644383347, 524.1599677091598, 107.74542182648577, 406.6617150856414, 26.111480492728308, 258.3911011638796, 15.381295626613236, 383.7448030635488, 816.8519664178344, 114.7712114395901, 0.9115112102854807, 35.8208963167614, 217.761755253715, 358.02656921506264, 90.77092815426985, 742.5676308555779, 112.13417679286282, 1609.8020260507324, 373.72765194638055, 17.3506828964536, 235.6923558300794, 214.5848280109589, 2.4576674092437503, 1156.9075838961444, 922.2426120413213, 102.23232223134058, 160.8674424290904, 355.9292092125905, 283.6340794781347, 599.6786051752094, 39.25217332441734, 0.9064064628877493, 437.670654367869, 0.0, 159.06208150527664, 621.5885229904823, 403.2463762532847, 70.19486978712878, 59.78462602842904, 125.20167374041185, 123.59926550360103, 839.5249325078565, 31.87525255944983, 56.44781644693465, 75.19638998729019, 628.0412509633411, 408.92096797868754, 283.60269336942645, 395.5106694136898, 633.0726116650987, 379.49013909800664, 300.38651140036745, 337.8965469575612, 389.5367851752748, 312.00519369015484, 320.37228994045455, 36.912922685150875, 640.4603491527315, 223.0760648510231, 489.9945488062328, 1242.5190782739555, 872.9630719116719, 520.478691077126, 563.6911399385963, 458.5589944745658, 215.85513017149572, 1262.1644976966672, 286.8350160033119, 10.473650469185273, 879.2861866717378, 2.1686575532436683, 364.77604888069027, 549.469052095616, 352.48744009123783, 543.338358501286, 129.8298341158617]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.07621382738503, "mean_inference_ms": 3.1800246153553644, "mean_action_processing_ms": 1.4351276674772233, "mean_env_wait_ms": 0.5983257776032119, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006647944450378418, "StateBufferConnector_ms": 0.004395246505737305, "ViewRequirementAgentConnector_ms": 0.14302313327789307}, "num_episodes": 18, "episode_return_max": 483.8650709359632, "episode_return_min": -529.8294972918713, "episode_return_mean": 89.54923752831007, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1584000, "num_agent_steps_trained": 1584000, "num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 81.44682180359031, "num_env_steps_trained_throughput_per_sec": 81.44682180359031, "timesteps_total": 396000, "num_env_steps_sampled_lifetime": 396000, "num_agent_steps_sampled_lifetime": 1584000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1584000, "timers": {"training_iteration_time_ms": 49831.99, "restore_workers_time_ms": 0.015, "training_step_time_ms": 49831.923, "sample_time_ms": 1712.73, "learn_time_ms": 48097.762, "learn_throughput": 83.164, "synch_weights_time_ms": 18.541}, "counters": {"num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_agent_steps_sampled": 1584000, "num_agent_steps_trained": 1584000}, "done": false, "training_iteration": 99, "trial_id": "cf3bb_00000", "date": "2024-08-20_10-05-30", "timestamp": 1724128530, "time_this_iter_s": 49.17973494529724, "time_total_s": 12791.983018398285, "pid": 25777, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3aaa84430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 12791.983018398285, "iterations_since_restore": 99, "perf": {"cpu_util_percent": 38.630434782608695, "ram_util_percent": 80.10434782608696}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6791572945813338, "cur_kl_coeff": 2.1997466683387755e-05, "cur_lr": 0.00010000000000000003, "total_loss": 7.255394665652482, "policy_loss": -0.0026548443603570814, "vf_loss": 7.258049510774159, "vf_explained_var": -0.001635865811948423, "kl": 0.0071358089739610026, "entropy": 0.6879890453247797, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 188055.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.067399152340712, "cur_kl_coeff": 0.0052734375, "cur_lr": 0.00010000000000000003, "total_loss": 7.448824421817033, "policy_loss": -0.003541819671065443, "vf_loss": 7.452333721534285, "vf_explained_var": 0.051411610904824795, "kl": 0.006165952927101602, "entropy": 0.6306886588770245, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 188055.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 400000, "num_env_steps_trained": 400000, "num_agent_steps_sampled": 1600000, "num_agent_steps_trained": 1600000}, "env_runners": {"episode_reward_max": 483.8650709359632, "episode_reward_min": -529.8294972918713, "episode_reward_mean": 73.73922139781851, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1609.8020260507324, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 1609.8020260507324}, "policy_reward_mean": {"prey_policy": -294.2988569929103, "predator_policy": 331.16846769181956}, "custom_metrics": {}, "hist_stats": {"episode_reward": [200.0, 16.89999999999999, 164.4711483969342, 483.8650709359632, 178.11491345955085, 43.48080398610283, 16.899999999999967, 59.43795763101094, 160.69999999999956, 95.49138514620009, -51.3024843770784, 115.0, 4.0, 146.0, 91.07678697693002, 112.09999999999926, 98.35959709539193, 13.100000000000001, 73.8, 72.10000000000001, 117.0, 16.99999999999997, 355.0, 117.90000000000002, 93.40846714088771, -133.60280424300757, 114.69999999999973, 103.35255939916229, 44.79999999999998, 100.26836368473946, 101.1, 310.4853702296249, 73.64506005479649, 202.40473247762478, 202.53036604885156, 158.0, 250.01094489003256, -529.8294972918713, 123.99999999999989, -88.47895112274756, 164.03265167929624, 93.29999999999933, 28.500000000000135, 142.0, 37.600000000000264, 35.345105466176854, 114.99999999999997, 91.0, 19.400000000000034, 64.40000000000008, -27.989783085714436, -257.83472130990475, 234.15020491898952, 131.34414577246076, 216.19999999999928, 148.80610942436238, 85.99946453204024, 81.09999999999958, 110.6288324202402, 120.0, 34.200000000000216, -13.798931363675958, 94.01992238316855, 137.05458688698178, 102.37241529784856, 4.647544990891619, 65.47672770870655, -13.518459275787144, 68.03840367583524, 0.1999999999999993, 223.96629354389898, 81.77866347083058, 77.00000000000004, -308.449893271393, -304.89999999999986, 161.1876710366877, 82.0, 59.931720407757936, 58.70000000000008, 150.54669677587484, 126.72597040012491, 37.10000000000026, 32.00000000000018, 214.9581511705941, -101.96997218037478, 116.30230353970731, -1.904917581602962, 137.84610178713817, -114.03365302400057, -57.137516123984526, 39.673179670013944, 57.500000000000185, 134.0, 212.99999999999946, 101.87085684660192, 142.8751112388119, -26.561741782016984, 18.18402196704696, 45.16908124912086, 37.600000000000264], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-970.5272053637989, 200.0, -501.9473622692648, -397.36643893212243, -17.703824475638413, -368.2785835934109, 196.92848151261887, -1395.459829145455, -248.5382336865968, -1.0381454756034296, -462.16391422310693, -164.63047616232916, -654.4214672997443, -8.201614892418998, -234.67735962970005, -243.45160447277283, -135.06186348683974, 104.97301324140898, -124.63611218354248, -455.4985077876567, -303.6637861562893, -167.11833206761986, -918.5345759928363, -15.827725226873417, -583.4914143935496, -408.501467685498, -749.9424119076708, 93.15716608849829, -146.82343527973066, -738.5421296930657, -75.47830348529425, -55.873747355942655, -17.279759974344785, -319.6255774061023, -370.19785628945783, -616.3210860199163, -463.64636207979964, -360.2594635036005, -185.8368871998774, -117.26913291596586, -1113.2904558733994, -102.30811700866767, -683.2308008797581, -60.41184557794308, 200.0, 81.20478091603864, -346.64804254525916, -39.528490631463555, -67.99960368325759, -45.53673647868505, -465.39336259076384, -314.3299043677142, -83.00143971900627, -483.93210850927073, -111.47872690309865, -79.32487955678072, -286.4097793699517, -496.85442424117673, -246.49695166100312, -176.97412364096732, -18.0282437038856, -1395.708340482001, 143.84484721950304, 106.80480262141963, 8.045804175807975, -465.67920949859155, -268.98099084362934, 130.90580978663587, 118.1731717176101, -194.79689160762135, -612.8776869161528, 118.87271998006658, -67.32867306231135, -481.973953037829, -631.3655558406156, -830.1160783698948, -173.85853487026796, -36.64387917707892, -98.25478658718582, -516.1599677091599, -266.5810310139559, -83.79345421887453, -7.811480492728194, -183.3911011638796, 3.5187043733867287, -374.14480306354864, -816.8519664178344, 27.228788560409907, 18.98848878971452, -18.120896316761147, -124.88106734490283, -415.56215165769856, 24.229071845730328, -742.5676308555779, -21.134176792862853, -1609.8020260507324, -372.72765194638055, 1.04931710354638, -229.29235583007983, -156.5848280109588, -549.1891555532956, -638.1658788378065, -921.1726641154074, -361.13699146715925, 48.280508078217984, -330.9269548009093, -171.05831831521132, -580.9102205656721, -21.152173324417085, 197.19359353711224, -278.139775867452, -10.724769076054969, -90.82714102102322, -603.823998942695, -336.246376253285, -56.094869787128864, 3.5913835046562883, -77.94885085325616, -3.599265503601033, -839.5249325078565, -13.475252559449615, -40.647816446934634, -387.00994872580367, -330.0266235885045, -96.17760877259636, -502.32613019234896, -511.2552849840097, -380.2734092077969, -438.5753334987566, -138.92890170176935, -378.4300140815294, -344.3557730604146, -314.80566625744956, -252.0950896644533, -480.78273659969767, -210.10899451397262, -287.53619979366937, -357.4960101877501, -1242.3190782739555, -872.9630719116719, -133.37694687561157, -726.8265905962122, -231.24800980784542, -361.3874513673859, -1262.1644976966672, -209.83501600331152, -505.9483089708391, -692.2614214414791, -332.751990886577, -339.092715547357, -611.1382273148646, -129.63059383530185, -543.338358501286, -47.829834115861786, -230.98006192348763, -399.9662852355658, -340.8530128703281, -309.4363709876236, 18.991363390468006, -510.58440137580624, -586.8597028054213, -41.06555454274281, -2.9175742966744704, -6.254670686795297, -384.4842435647717, 20.000000000000014, -422.2637747641129, -159.478034278389, -102.75857183674101, -753.979182650259, -151.37760201192225, -5.2464471323218405, -32.3326573039184, -251.33682903034978, -101.44060667324383, -168.61239868610502, -361.3469644533887, -229.29443273785213, -124.42206776465234, -504.8807023900211, -414.15812461429067, -112.12249589025278, 1.4282369392870315, -216.3516105670417, -1534.7127697204699, 35.811170176404055, 200.0, -143.94078993395297, -112.11245931108355, -59.60840385556821, -330.11168847478973, -286.47434962669934, -326.16751490330427, -376.5299178437816, -255.80452998876532, -542.892265995038, -926.655151077066, -164.67003759766442, 8.553979338967654, 6.004105532659574], "policy_predator_policy_reward": [970.5272053637989, 0.0, 518.1473622692648, 398.0664389321226, 408.2444479928479, 142.20910847313615, 416.2394635848005, 1266.1569549839944, 137.48466339964378, 290.20662922210755, 269.20596503817575, 401.0692293333633, 654.4214672997443, 25.101614892418972, 165.80720249001496, 371.75971924346993, 145.96186348683912, 44.82698675859107, 234.33974520797207, 441.28625990942703, 381.6014872677201, 37.87814657911023, 918.5345759928363, 130.82772522687347, 583.4914143935496, 412.501467685498, 749.9424119076708, 52.84283391150168, 263.51875907364956, 712.9235928760776, 169.4783034852944, 73.97374735594221, 208.49327523425276, 226.77165924158626, 377.1978562894579, 622.4210860199163, 464.44636207979966, 433.2594635036004, 251.54014401110413, 123.66587610473873, 1113.2904558733994, 219.30811700866764, 683.2308008797581, 77.41184557794237, 0.0, 73.79521908396136, 352.24804254525924, 151.8284906314636, 4.288155029797675, 202.65665227303293, 319.0217700676621, 327.09869264780866, 190.00143971900624, 491.6321085092725, 270.7036525457115, 23.45251331333012, 330.50977936995184, 497.5544242411769, 260.3134823910477, 263.4259565956627, 119.12824370388553, 1395.708340482001, 54.90231821334509, 4.9334021753571555, 479.0388281763828, 52.239637201197205, 246.29712454993907, 94.18278898467922, 9.35719433124137, 269.79689160762103, 612.8776869161528, 39.127280019933416, 317.883786194854, 481.4297847953195, 5.208061701663104, 926.4440752169745, 183.85853487026796, 150.643879177079, 1.7758354644383347, 524.1599677091598, 107.74542182648577, 406.6617150856414, 26.111480492728308, 258.3911011638796, 15.381295626613236, 383.7448030635488, 816.8519664178344, 114.7712114395901, 0.9115112102854807, 35.8208963167614, 217.761755253715, 358.02656921506264, 90.77092815426985, 742.5676308555779, 112.13417679286282, 1609.8020260507324, 373.72765194638055, 17.3506828964536, 235.6923558300794, 214.5848280109589, 2.4576674092437503, 1156.9075838961444, 922.2426120413213, 102.23232223134058, 160.8674424290904, 355.9292092125905, 283.6340794781347, 599.6786051752094, 39.25217332441734, 0.9064064628877493, 437.670654367869, 0.0, 159.06208150527664, 621.5885229904823, 403.2463762532847, 70.19486978712878, 59.78462602842904, 125.20167374041185, 123.59926550360103, 839.5249325078565, 31.87525255944983, 56.44781644693465, 75.19638998729019, 628.0412509633411, 408.92096797868754, 283.60269336942645, 395.5106694136898, 633.0726116650987, 379.49013909800664, 300.38651140036745, 337.8965469575612, 389.5367851752748, 312.00519369015484, 320.37228994045455, 36.912922685150875, 640.4603491527315, 223.0760648510231, 489.9945488062328, 1242.5190782739555, 872.9630719116719, 520.478691077126, 563.6911399385963, 458.5589944745658, 215.85513017149572, 1262.1644976966672, 286.8350160033119, 10.473650469185273, 879.2861866717378, 2.1686575532436683, 364.77604888069027, 549.469052095616, 352.48744009123783, 543.338358501286, 129.8298341158617, 316.8838168803654, 373.99425068644626, 395.8530128703283, 313.1363709876233, 396.0908700187635, 246.04886474245015, 546.739607551683, 207.91162019660723, 21.017574296674493, 25.254670686795393, 396.48424356477176, 0.0, 376.7225952462299, 419.97736496686605, 0.7885996563662241, 753.979182650259, 179.27445624040885, 93.65189644354277, 20.159445862295744, 261.6051228903709, 149.2624833700191, 258.63662377646773, 0.0, 476.60774416724, 518.2065280054846, 53.95872602520414, 414.0934880952488, 151.86031207930782, 17.071763060712943, 255.3516105670417, 1534.7127697204699, 98.18882982359591, 102.37801653205376, 54.56277340189934, 187.11245931108374, 86.47926070217011, 349.248425328785, 410.2127240115162, 676.135690965071, 0.0, 322.5758024140152, 494.30501553683547, 927.1381217553619, 209.3561481684895, 10.446020661032312, 12.595894467340393]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1090704974725385, "mean_inference_ms": 3.101129225814045, "mean_action_processing_ms": 1.4229570222813674, "mean_env_wait_ms": 0.6296466553997867, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006144523620605469, "StateBufferConnector_ms": 0.004212498664855957, "ViewRequirementAgentConnector_ms": 0.13422131538391113}, "num_episodes": 23, "episode_return_max": 483.8650709359632, "episode_return_min": -529.8294972918713, "episode_return_mean": 73.73922139781851, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1600000, "num_agent_steps_trained": 1600000, "num_env_steps_sampled": 400000, "num_env_steps_trained": 400000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 80.92539684190402, "num_env_steps_trained_throughput_per_sec": 80.92539684190402, "timesteps_total": 400000, "num_env_steps_sampled_lifetime": 400000, "num_agent_steps_sampled_lifetime": 1600000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1600000, "timers": {"training_iteration_time_ms": 49577.336, "restore_workers_time_ms": 0.014, "training_step_time_ms": 49577.275, "sample_time_ms": 1509.501, "learn_time_ms": 48047.821, "learn_throughput": 83.25, "synch_weights_time_ms": 17.398}, "counters": {"num_env_steps_sampled": 400000, "num_env_steps_trained": 400000, "num_agent_steps_sampled": 1600000, "num_agent_steps_trained": 1600000}, "done": true, "training_iteration": 100, "trial_id": "cf3bb_00000", "date": "2024-08-20_10-06-20", "timestamp": 1724128580, "time_this_iter_s": 49.49408793449402, "time_total_s": 12841.477106332779, "pid": 25777, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39fcb9310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 12841.477106332779, "iterations_since_restore": 100, "perf": {"cpu_util_percent": 47.35142857142858, "ram_util_percent": 80.83714285714285}}
