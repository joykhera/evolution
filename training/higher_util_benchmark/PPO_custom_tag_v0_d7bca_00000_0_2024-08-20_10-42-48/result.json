{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8080463764844117, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.494615478111953, "policy_loss": -0.009516804781249631, "vf_loss": 8.502865461066918, "vf_explained_var": 0.0060172636042196284, "kl": 0.006334071016467605, "entropy": 1.6039438330937945, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 507.93650793650795, "num_grad_updates_lifetime": 945.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.39566595297720697, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 5.945937060300635, "policy_loss": -0.007626588732156922, "vf_loss": 5.952617053884678, "vf_explained_var": 0.025603188850261548, "kl": 0.004732933496777954, "entropy": 1.6055388759052942, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 507.93650793650795, "num_grad_updates_lifetime": 945.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "env_runners": {"episode_reward_max": 234.4999999999993, "episode_reward_min": -8.506504959686353, "episode_reward_mean": 81.22028252627476, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 14400, "policy_reward_min": {"prey_policy": -486.310117401182, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 114.5379926299484, "predator_policy": 448.13139625009984}, "policy_reward_mean": {"prey_policy": -82.60028804182133, "predator_policy": 123.21042930495868}, "custom_metrics": {}, "hist_stats": {"episode_reward": [46.800000000000146, 39.15111584588207, 141.71892579171362, 99.3347826422285, 43.900000000000254, 51.90000000000031, 98.89999999999932, 19.299999999999965, 18.499999999999993, 76.81752602771796, 103.39999999999903, 68.64324477584398, 171.82203011511098, 71.00000000000014, 5.61975778336606, 44.885914690893586, 182.09999999999954, 134.85200366521627, 121.27118234642077, 19.5, 121.55951475636681, 35.24327669001537, 122.39999999999934, 114.89999999999992, 135.2999999999991, 212.68945042626834, 53.16849883601799, 75.49999999999952, 100.69999999999999, 61.50000000000018, 134.69999999999973, 23.10000000000006, 59.24701391527518, -8.506504959686353, 42.40000000000019, 4.591880680382775, 72.49999999999983, 61.3000000000003, 114.39999999999938, 94.69999999999973, 44.80000000000027, 122.4908726425508, 77.64032565336659, 121.29999999999994, 30.300000000000153, 29.500000000000156, 141.19999999999885, 76.15546785568381, 177.99999999999963, 81.19919055774449, 73.5000000000002, 44.03851612073692, 51.81889073880748, 70.70973487361172, 84.70000000000005, 151.99204422841322, 28.028332586032967, 45.300000000000104, 60.10826171570052, 84.86796144589266, 170.97551723361985, 118.99999999999936, 52.800000000000104, 9.526427577320662, 169.29999999999936, 63.46320156604788, 95.35246113063457, 20.600000000000016, 59.39499152023028, 234.4999999999993, 26.800000000000075, 37.68853041636017], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-165.1919430250629, -19.315691995234104, -79.73640344911722, -238.08634051561418, -333.14012220917874, 79.66492361180478, -236.01696501997512, 40.89251625545993, -165.28607891781218, 20.000000000000014, -3.785423155611238, -81.89776620506842, 53.48838328266444, -10.613736926556179, -358.1522928827609, -103.37838029763279, -103.21861339071664, -244.7336792750043, -193.24914110942046, -83.03119912715279, 11.56033451672519, 42.88190255289325, -64.38377361934943, -190.06417823263828, 94.23766045817074, -2.142962505537078, -55.10477537259001, -54.820547604952296, -181.24257394378841, -147.6610785298379, -71.45189708460819, 13.29655859686152, -44.05869047370758, 93.99897804943812, -36.83596459467126, -37.100567081120246, -196.96629905270564, -44.75543368959106, -442.23139625009986, -214.09818109798326, -331.36943509951254, 37.97224394142337, -486.310117401182, -132.75250113827815, -29.817497378443164, 50.16477289779454, -193.53437907554445, 41.009683183535074, 83.47186987124459, -9.60329442324602, -41.7683912216024, -244.44783899426642, -209.13889351092917, -69.67993526271286, -21.613315612321628, 37.00547095554205, -113.06718334466615, -157.27869392767406, -200.46429163043837, -150.1830426222415, -17.75690999327516, -24.46699010714616, -387.4280756957955, -26.544949889221957, -239.7744078279329, -208.8519053503887, -199.18342896264193, -420.83508663220886, -117.27300662912214, -345.7738991464781, -100.42641083773826, -246.71257581708286, -28.714609917952174, 46.21500260434961, -53.428567365406685, 9.84578793586609, 60.79433745260976, -5.801773606581737, 45.113377135244875, 3.238184394922414, 1.4051217462903225, 20.733873682537762, -2.740623435417701, -98.65664503530529, -20.678970634274794, -84.61314107823179, -13.49338703738863, -41.36740974110883, -23.102921355016306, -170.52609429933435, -106.96785125354172, -146.76160268269027, 107.91740240713307, -6.448161735342673, 22.22013609122545, -287.5586909179705, 83.86376026513396, 55.36433787057756, -81.29990074384656, -168.6874446329539, -74.68621208352475, -137.1546109439889, -18.61628611963338, -19.968230909957093, -67.82935816870085, -468.6492706332157, -277.3559078568806, 28.425192401570854, -42.23589759424655, -14.799508230053371, 24.359676042830724, -29.892471398292614, -69.57517720602456, -19.620390100432314, -173.36112256092576, -75.61500675401925, -10.986186412600802, -82.34533997955867, -54.24210126541466, 33.382034542256335, 46.37625992647234, -29.593125192674425, 14.511668888464992, 44.29999999999999, -119.61495941757512, -61.08209739466433, -82.1024084003161, -182.7054026954809, 114.5379926299484, -68.76804193948949, -19.08248597997921, 15.650732980547744, 6.981990388524984, -33.43786161830938, -246.6515656619506, -106.88148148367075, 13.888831744032208, -198.92653980276373, 77.6828450680821, 93.63128866059049, -189.30449071133384, -2.812343395036157, -22.576409293059157, -295.39797021171444], "policy_predator_policy_reward": [191.19194302506278, 40.11569199523433, 204.70673508229658, 152.267124728316, 340.1901186801907, 55.00400570889704, 283.43959657365457, 11.019634833089668, 189.18607891781176, 0.0, 22.08542315561128, 115.49776620506833, 26.811616717335657, 29.213736926556304, 364.65229288276106, 116.17838029763244, 115.41861339071608, 251.03367927500398, 90.42799399411558, 262.6698722701753, 39.03966548327477, 9.918097447106952, 223.3035629211586, 99.78763370667278, 29.610826840844148, 50.11650532163365, 83.30477537258986, 97.62054760495218, 16.60665328560715, 317.91675697138464, 101.20036862524648, 1.8408845533925928, 102.05869047370739, 30.101021950561716, 82.89930341417784, 125.88923192683025, 112.22894666558105, 250.76396842313702, 448.13139625009984, 227.6981810979832, 201.67780787371416, 213.27889804074223, 364.6313968462977, 289.6744983831784, 46.11749737844326, 55.93522710220552, 219.6343790755444, 47.79031681646502, 42.10470874241883, 19.326715809582183, 240.3370561974085, 258.5686244447295, 116.55698245232469, 215.4303451573351, 50.7961645570982, 9.31168009968166, 165.57731646346681, 205.46856080887306, 339.8005933698504, 72.34674088282884, 51.69882446425633, 125.22507563616524, 394.02807569579505, 43.04494988922195, 204.21564512640379, 303.6576819671928, 426.8828395978888, 184.62917103727534, 141.37300662912142, 364.0738991464795, 322.0666448050671, 29.66422253013643, 41.50594476023576, 13.49366255336726, 37.27105925651818, 67.61172017302239, 16.59210154724147, 42.815334606730644, 18.574377417685525, 27.774061052147516, 17.494878253709658, 5.16612631746229, 216.29331726814672, 7.59482384512765, 84.79427104043279, 98.1381663254401, 109.0933870373883, 67.06740974110879, 32.38010288695351, 191.54891276739642, 123.2678512535408, 159.96160268268952, 0.0, 39.730759328209245, 317.11946971747614, 24.37455296495247, 5.636239734866026, 33.13566212942254, 158.41649327035253, 172.77004266419237, 103.3862120835241, 181.95461094398846, 81.78539086788318, 0.8376422824444446, 272.7675624565702, 315.52995708415267, 46.195337711790906, 273.4451126171303, 109.53589759424612, 32.199508230053596, 67.59196669715622, 89.93287288671955, 6.5466552681539145, 110.67724462433546, 184.66112256092518, 109.61500675401858, 52.63967758513992, 100.80011052272006, 45.83277942241106, 59.895248746639524, 93.51542299886302, 60.67695950095944, 60.18833111153498, 0.0, 158.2149594175751, 75.28209739466445, 38.268457215089704, 236.06578145802752, 31.862007370051636, 91.66804193948965, 13.328331693142543, 53.56662287233706, 117.77143931026818, 4.03689305015087, 254.55156566195018, 119.58148148367003, 191.75910856347267, 52.67359101548813, 26.501634638873934, 36.684231632452914, 197.3044907113335, 21.612343395036195, 55.44538478756755, 300.2175251335662]}, "sampler_perf": {"mean_raw_obs_processing_ms": 20.995302457630473, "mean_inference_ms": 18.94632873493906, "mean_action_processing_ms": 3.2209879074217422, "mean_env_wait_ms": 24.697310812328205, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05040831036037869, "StateBufferConnector_ms": 0.0412093268500434, "ViewRequirementAgentConnector_ms": 0.7618410719765557}, "num_episodes": 72, "episode_return_max": 234.4999999999993, "episode_return_min": -8.506504959686353, "episode_return_mean": 81.22028252627476, "episodes_this_iter": 72}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_env_steps_sampled_this_iter": 16000, "num_env_steps_trained_this_iter": 16000, "num_env_steps_sampled_throughput_per_sec": 43.19580878808973, "num_env_steps_trained_throughput_per_sec": 43.19580878808973, "timesteps_total": 16000, "num_env_steps_sampled_lifetime": 16000, "num_agent_steps_sampled_lifetime": 64000, "num_steps_trained_this_iter": 16000, "agent_timesteps_total": 64000, "timers": {"training_iteration_time_ms": 370406.331, "restore_workers_time_ms": 0.11, "training_step_time_ms": 370406.134, "sample_time_ms": 58842.885, "learn_time_ms": 311135.988, "learn_throughput": 51.424, "synch_weights_time_ms": 17.753}, "counters": {"num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "done": false, "training_iteration": 1, "trial_id": "d7bca_00000", "date": "2024-08-20_10-56-34", "timestamp": 1724131594, "time_this_iter_s": 371.0653221607208, "time_total_s": 371.0653221607208, "pid": 36059, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 16000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x32cf03f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 371.0653221607208, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 82.51788461538462, "ram_util_percent": 83.64634615384615}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6350755981627911, "cur_kl_coeff": 0.19999999999999996, "cur_lr": 0.0001, "total_loss": 7.264563598140838, "policy_loss": -0.01212744978921754, "vf_loss": 7.275209620263841, "vf_explained_var": 0.05109462326481229, "kl": 0.007407216851188134, "entropy": 1.5881579438845317, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 507.8095238095238, "num_grad_updates_lifetime": 3150.5, "diff_num_grad_updates_vs_sampler_policy": 1259.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7388294863085898, "cur_kl_coeff": 0.09999999999999998, "cur_lr": 0.0001, "total_loss": 4.937626465540084, "policy_loss": -0.012554347698344842, "vf_loss": 4.949324474069807, "vf_explained_var": 0.0889668834351358, "kl": 0.008563468025796096, "entropy": 1.5929934108068073, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 507.8095238095238, "num_grad_updates_lifetime": 3150.5, "diff_num_grad_updates_vs_sampler_policy": 1259.5}}, "num_env_steps_sampled": 37328, "num_env_steps_trained": 37328, "num_agent_steps_sampled": 149312, "num_agent_steps_trained": 149312}, "env_runners": {"episode_reward_max": 286.6692231913454, "episode_reward_min": -53.94695511723343, "episode_reward_mean": 102.72684140557207, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 28800, "policy_reward_min": {"prey_policy": -444.2422736603265, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 179.3112339768235, "predator_policy": 447.2531966002178}, "policy_reward_mean": {"prey_policy": -54.53217380005385, "predator_policy": 105.89559450283987}, "custom_metrics": {}, "hist_stats": {"episode_reward": [40.7000000000001, 131.4999999999997, 36.9556202909544, 82.20000000000007, 92.87848553723319, 110.83844498916547, 104.53279083023972, 193.21127284381666, 33.00000000000006, 112.13975611637063, 101.79999999999994, 23.50000000000007, 250.6999999999994, 217.20961087891268, 60.21295796785865, 40.60000000000031, 29.835337097319908, 44.36376979150066, 122.75293603008356, 148.26809077963316, 46.20000000000009, 117.09966937689478, 13.288490903878165, 34.50000000000022, 135.1380417360764, 115.62427071364678, 50.64474869441805, 88.89999999999887, 38.00000000000024, 219.67264204192026, 121.4920245998552, 56.22836920496107, 101.2789327213453, 240.99146167522085, 94.38704395667574, 55.500000000000064, 162.59999999999948, 41.4000000000001, 49.60621224425942, 110.68059137231546, 14.656075434763979, 182.91334649831512, 130.44539784762563, 69.49999999999994, 103.80390816350635, 73.79999999999968, 90.89999999999947, 187.89999999999966, 52.90458634843173, 44.80000000000025, 230.69999999999985, 224.1752745612376, 35.10000000000023, -2.2956613079459616, 52.30000000000035, 93.99999999999946, 41.27668545957155, 138.35998813581944, 47.000000000000355, 189.59999999999982, 46.100000000000314, 122.59999999999911, 172.99184762314727, 183.89999999999952, 165.26660970450598, 63.400000000000325, 224.23591029611316, 118.26513246444676, 57.049342065984625, 56.287512516221504, 91.49999999999856, 77.70000000000017, 286.6692231913454, 34.20000000000022, 135.4999999999999, 189.7622134181783, 204.95900501687956, 41.46117592104707, 160.52089757879483, 41.90000000000027, 159.99999999999952, 56.25035590474681, 189.40904152072758, 32.4000000000002, 135.49999999999923, 137.09999999999957, -53.94695511723343, 170.90494465410117, 56.10000000000025, 60.20000000000013, 34.75612756781972, 43.60000000000028, 40.265044310772325, 47.1298862953699, 48.40000000000023, 36.202116310375594, 74.49999999999962, 153.19999999999987, 40.1000000000002, 131.19999999999982, 52.570622032848895, 56.000000000000156, 129.1999999999993, 86.20000000000002, 28.831075919194078, 160.79999999999959, 81.33852172443821, 103.01543537877356, 169.88064982359512, 48.30000000000023, 52.529310579969625, 48.028025438635616, 198.59999999999948, 184.470358209413, 37.06861395355878, 80.95181844992561, 33.900000000000134, 135.39999999999944, 148.89999999999955, 133.69999999999916, 226.89999999999938, 68.3000000000002, 154.45814550558052, 41.47674734270453, 180.74087067540847, 60.139037304427255, 153.66325386820998, 109.81254335834268, 96.80000000000011, 108.61895163315396, 159.3546697445331, 53.10000000000013, 125.29999999999959, 34.93780403323022, 139.0999999999999, 206.80167211533725, 40.50000000000029, 68.40000000000009, 88.29999999999927, 242.69999999999993, 37.700000000000266, 104.09999999999903, 229.34134979067687, 152.6250807412044], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-323.3837885288039, -127.78342406951677, -197.10710677806523, 87.7568584859294, -197.63649495479788, 20.000000000000014, 36.75857029076701, -120.55422020152946, -88.37371140477512, -167.11736926794308, 59.42632173370755, -240.96999311394526, -165.56852978227204, 5.07612851493434, -127.05038982417167, 148.9397379951181, -207.17154432326956, -51.08043739620378, -18.0679611715647, -225.24493118794751, -75.52749247069741, 54.119439314691654, -188.14735849650424, -192.76903062988507, 116.14175816225512, 38.04550430554921, -32.857535008875274, 179.3112339768235, -108.71992897946922, -139.4173646531374, -11.834925898544139, 10.043436443186069, 5.9839568659379925, -103.56619167636345, -58.2367913217686, 18.486279891006404, -277.81141343250295, -36.602983835063704, 86.43639547807567, -106.81726713228129, -169.99143725582604, -224.92097887377216, -208.54390768036413, -6.895350930977271, -84.5232377677002, -69.6622902432559, -18.99229737295665, -68.27863754063254, -104.96384566237714, -106.81633373614382, -220.410943976199, -175.37887640637996, -79.20357731835819, -74.98516666356582, 26.987088707331417, -19.11984749343989, -6.029316255302753, -8.653773089178042, 79.90171714867836, 17.8340176753755, 52.110346455450085, -129.9653341168287, -20.09907936710298, -77.39552418569055, -444.2422736603265, 72.65594275260126, 118.83112135521075, -12.870133103272096, -139.16214552850542, 20.000000000000014, -130.82054230007446, -43.32121021415841, -392.3163956061035, 146.54676903527593, -72.98589267159318, -186.7796446576083, 20.000000000000014, -115.78077622445959, -283.31372625166114, 54.37466957077933, -51.938665188306075, -124.42328645335365, 44.10549624688253, 71.72268478205959, -62.91862296018773, -81.26805295073177, -143.62565482817848, 48.771321165405645, -62.23518846323621, -276.0265081319062, -99.09591050851901, -3.475365865845842, 1.988877364818897, -227.44969127095675, 37.1854606185788, 24.62765501142229, 5.713199814347513, -100.2951660400646, -11.387495321929343, 19.108647769438914, 65.75941118848839, 63.09483796536526, 123.2719440836836, -85.79259284426907, 13.573129738316304, -53.54665936669982, -254.04609845621002, -260.27960040372835, -140.65478211067654, -73.1171426718985, 39.583255312047925, -34.03651010327775, -114.83317908671795, -92.66853807147267, -96.4272326280199, 93.09870255859556, -64.80740741555226, 20.000000000000014, 20.626642410773584, -16.792242611230414, 18.848497587615384, -92.85980597895414, 69.17606926139403, -109.36249015041209, -285.2321358475945, 105.74800812423979, 132.7888944272447, -19.35385941243218, -25.356623210719427, 11.326871936077456, -78.03601550180139, -20.07740583328924, 28.904313331271958, 85.71002709904536, -84.17058524148602, -101.59193807470932, -247.8691803256373, -34.87488956710395, -49.40531904969436, -141.19228141836533, -107.134889946308, 73.87102816456981, 4.171128342528487, -6.373188196460497, 72.0443042732162, -52.54708787865346, -32.67477650531073, -33.11217620680012, 17.408091439294907, -110.92817899556306, 80.28766474857159, -53.604483480981195, 64.90005398718623, -328.3984316256627, -221.37365036394135, -15.540567450569034, -217.97172194166885, 76.83739839192134, -62.4215290072797, -67.19987230581766, 82.82590198976501, -215.4723347673664, -63.01766150909464, -253.83034574412602, -72.05610867549865, 89.36722870345912, -103.9034532802869, -142.29070810227037, 0.5594712651248201, 21.887655692545323, -382.5350217575324, 117.78599718266575, -341.68754507993606, -271.3757928143444, 42.05974767402415, -113.91576456218526, 10.584749159468316, -368.0370289653096, -96.60173288891873, 6.578081936680414, -116.41208622158636, -38.927412945968925, -335.88260364800084, 33.30132488528524, -27.102952922490367, -70.03840438982733, -11.808869660467748, -17.067235360537826, 10.174001800704053, -2.962232113254194, -5.251613856427011, -54.123434986458186, -77.75098136410048, -19.99080009629646, 33.88040540161318, 40.0118549587175, 18.203034292193653, -101.55435256341609, 84.66934503983893, -118.51718584134521, -111.25275039532056, -35.27706169307365, 12.962713255211035, -154.80174341253127, -108.368940102753, 45.92361009447094, 66.26530936409696, -54.85406764413665, -50.32982812857711, -6.234569676365133, 43.52535653925046, -20.284647818951065, -122.72911794687963, -30.02930181547257, 64.88866316909824, -29.828281979136015, 27.845266783971347, 9.541578665059246, 1.103496687474779, 7.009962407567832, -8.299879170194934, -72.54471461247661, -97.58563081684744, -33.94553553761412, 161.42330774007206, -112.95182525200485, -6.1055308568346724, 40.28710026868663, -159.2584299113319, 1.9693763855458568, -203.51123731867187, -41.75335832068283, -112.73519084767737, -9.86848498904447, -75.14768969882805, 64.9005559888798, -41.26096743109789, 11.98667537860044, 89.1022150662958, -53.133135240501986, -21.790897701337713, 102.87572050846154, -103.60518017643587, -2.753002690682439, -77.5059788586302, -136.78681328113666, -35.26167272819433, 0.7616669233566751, 99.3892737675306, -121.76317749732668, -221.41484542454427, -0.26256937414734516, -81.64046493632515, 47.835445195899766, 41.62225202827415, -159.27689309555132, 8.414915969460758, -94.96493654962522, -101.89030278114168, -225.75780180988139, 42.3879814213417, -221.12051631037914, -194.2370444672595, -47.443484467917465, -68.94976936260595, -71.53127552961595, -175.21866179031935, -2.377011043507998, 7.336224962261236, 57.5840314172886, 148.94400313475802, -286.27355747273646, -38.05288701360526, -15.675153673344045, -157.06325915064687, 20.451311784900852, -34.19514158105644, -163.71926844518902, 179.13622751357744, -193.68286217716528, -5.466795255903271, 18.11348646225638, 73.35067178507347, -116.27200227841195, 81.3532898949211, -15.069998875773695, -1.5790888906085807, -103.01419787536915], "policy_predator_policy_reward": [329.3837885288047, 162.4834240695169, 213.3001363896648, 27.550111902470455, 111.08587208254481, 103.50624316320655, 5.680162672854957, 160.31548723790715, 272.35226843873517, 76.01729777121564, 166.12947359533896, 126.25264277406423, 123.78151393117561, 141.2436781664017, 167.28501383402775, 4.0369108388425, 223.77154432326938, 67.480437396204, 253.6847017314807, 101.76794674440204, 92.22749247069736, 30.980560685308326, 200.14735849650367, 204.26903062988464, 21.258241837744574, 75.25449569445084, 30.859027719824557, 39.896884191140835, 285.440371432597, 22.909880167867385, 33.33492589854431, 9.056563556813899, 11.251380231381722, 116.16619167636313, 79.12680937882389, 4.987471843438981, 179.48317666370005, 257.684156633953, 90.53703378819077, 78.11192864564804, 180.29143725582549, 260.82097887377256, 230.0622439673094, 102.47668402092702, 164.356226551202, 3.117792363631667, 36.4922973729569, 85.27863754063183, 145.39870821384184, 201.51951292075537, 268.9064066387445, 242.50768445748088, 119.23072670099691, 85.60276597534502, 43.91291129266872, 37.11984749344015, 24.229316255302834, 28.453773089178192, 46.4605281269587, 75.4763790909078, 42.54850690131824, 156.7985053599163, 89.9554995903511, 63.76747316740311, 447.2531966002178, 25.61206702885402, 109.38870023345005, 25.641773189832186, 212.6621455285051, 0.8870439566760334, 170.62054230007433, 59.02121021415854, 398.916395606105, 9.453230964724124, 88.9858926715923, 212.17964465760798, 13.754870508633562, 131.63211796008505, 300.31372625166085, 39.305921801536286, 174.88946732049848, 16.128559755925053, 11.541586078799789, 55.543579390574195, 272.2386524350206, 2.39342132352417, 157.82565482817768, 6.528678834594496, 151.21090219103706, 290.8547025676119, 130.2959105085182, 46.075365865845846, 37.12182689087208, 279.23898701526593, 61.116273082105266, 64.97061128789385, 12.986800185652445, 134.4997523884953, 29.687495321929504, 7.391352230561122, 34.7405888115116, 67.10516203463476, 83.99796366905915, 102.69795965276383, 5.826870261683667, 69.24665936669969, 324.2059226722713, 187.82411487972215, 153.05478211067583, 113.01714267189817, 17.61674468795218, 70.83651010327776, 56.871368154986286, 191.90703446277513, 141.68851820524378, 0.0, 91.80740741555158, 0.0, 54.17335758922649, 131.5922426112305, 1.0515024123846184, 119.05980597895365, 36.62393073860571, 126.16249015041168, 294.04458931930264, 58.43138602720072, 27.098306487098423, 43.366658498089144, 101.5982771707111, 77.69808380843789, 92.33601550180148, 69.17740583328944, 11.711242094735995, 97.91032777106007, 159.598841430636, 144.42881435000547, 256.62014258831397, 83.17326937041157, 64.7437860571049, 182.14132692717635, 121.33488994630724, 3.428971835429686, 17.92887165747148, 61.97318819646065, 71.37501564844887, 195.79699114833366, 50.574776505310986, 49.41217620680031, 95.99190856070484, 133.02817899556257, 118.64992189155714, 44.429110259031575, 173.65858800042827, 294.7987946549283, 219.5255437438939, 58.84984999166302, 153.020176017792, 148.6350451107507, 84.92152900727922, 86.59987230581754, 35.917401426461, 256.72903135113984, 310.86582010807547, 62.23254304989086, 95.58973110505788, 76.50819038770996, 122.80345328028605, 155.79070810226966, 62.740528734875355, 50.312344307454744, 388.3350217575325, 13.51400281733393, 276.4934910271924, 282.6228917498557, 228.37632836739596, 14.384633174866076, 36.51525084053167, 377.03702896531087, 55.843560999739694, 94.38008995249868, 186.75715567238382, 3.338471062991101, 341.8826036480012, 4.298675114714987, 61.56155472910194, 75.84484689398705, 39.31993402285901, 36.68605729351662, 9.025998199295913, 32.16223211325439, 17.067987561023646, 78.50917759223691, 86.89305015310855, 85.34873130728765, 32.98846306649877, 46.31927657317061, 3.2969657078063443, 120.15435256341586, 51.96603493554656, 113.08180586595923, 51.82953263144456, 147.2709014897984, 28.814437033388117, 169.02459312393165, 122.3689401027523, 69.27638990552909, 2.934690635903009, 71.85406764413669, 69.17481916505344, 16.220654559082863, 82.67464346074956, 54.88464781895127, 149.0452344703959, 85.05170701639402, 61.64654055235777, 6.308513636455049, 122.72811266075166, 9.76569171381375, 28.196503312525255, 11.990037592432142, 39.59465245581429, 93.77925190682629, 173.417858483239, 6.14133330985798, 15.762281811455798, 134.36623570047647, 76.06028203580479, 74.22850676175635, 34.695476680536935, 159.6621907988072, 167.2233660646181, 158.99304802466287, 125.23519084767717, 31.268484989044566, 88.54768969882797, 57.09944401112018, 170.03924007813922, 8.135051974358213, 21.451638560862875, 76.27928161334323, 145.09089770133772, 0.7242794915378635, 119.58478321201947, 55.07339965509877, 101.30347201003724, 267.44746563530987, 25.72851731642294, 50.2482358311191, 10.105741511511418, 193.0090328936931, 242.16798791533478, 39.648464187783205, 159.3499139561802, 28.118359652455005, 62.6282279289202, 164.83895649669932, 73.18508403053936, 110.16493654962441, 168.40666761692708, 267.8603886072499, 213.90796331236706, 124.17924132120368, 231.43704446725934, 63.34348446791769, 164.82322943616253, 100.95781545605833, 192.6461275375021, 19.887349329554755, 38.363775037738804, 35.81596858271153, 113.3458349053624, 230.7853915479533, 54.85288701360539, 39.375153673344265, 203.76325915064663, 1.2486882150991712, 111.99514158105654, 174.21926844518845, 10.863772486422565, 246.3828621771652, 23.366795255903288, 1.686513537743613, 3.0493282149260565, 143.97200227841205, 11.169618052507685, 151.88844071902219, 78.45110531031017, 178.76726219687225]}, "sampler_perf": {"mean_raw_obs_processing_ms": 24.102300763615265, "mean_inference_ms": 20.87221117924184, "mean_action_processing_ms": 6.589458836125936, "mean_env_wait_ms": 36.24421118575771, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.08167798320452373, "StateBufferConnector_ms": 0.042427662346098155, "ViewRequirementAgentConnector_ms": 1.1912662121984694}, "num_episodes": 144, "episode_return_max": 286.6692231913454, "episode_return_min": -53.94695511723343, "episode_return_mean": 102.72684140557207, "episodes_this_iter": 144}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 149312, "num_agent_steps_trained": 149312, "num_env_steps_sampled": 37328, "num_env_steps_trained": 37328, "num_env_steps_sampled_this_iter": 21328, "num_env_steps_trained_this_iter": 21328, "num_env_steps_sampled_throughput_per_sec": 49.80454054296255, "num_env_steps_trained_throughput_per_sec": 49.80454054296255, "timesteps_total": 37328, "num_env_steps_sampled_lifetime": 37328, "num_agent_steps_sampled_lifetime": 149312, "num_steps_trained_this_iter": 21328, "agent_timesteps_total": 149312, "timers": {"training_iteration_time_ms": 399320.282, "restore_workers_time_ms": 1.07, "training_step_time_ms": 399318.974, "sample_time_ms": 87823.239, "learn_time_ms": 311236.026, "learn_throughput": 59.967, "synch_weights_time_ms": 43.334}, "counters": {"num_env_steps_sampled": 37328, "num_env_steps_trained": 37328, "num_agent_steps_sampled": 149312, "num_agent_steps_trained": 149312}, "done": false, "training_iteration": 2, "trial_id": "d7bca_00000", "date": "2024-08-20_11-03-47", "timestamp": 1724132027, "time_this_iter_s": 428.63789415359497, "time_total_s": 799.7032163143158, "pid": 36059, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 16000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x32cf28550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 799.7032163143158, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 82.16206896551724, "ram_util_percent": 83.42577996715929}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {}, "num_env_steps_sampled": 37328, "num_env_steps_trained": 37328, "num_agent_steps_sampled": 149312, "num_agent_steps_trained": 149312}, "env_runners": {"episode_reward_max": 286.6692231913454, "episode_reward_min": -53.94695511723343, "episode_reward_mean": 102.60472273081903, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -382.5350217575324, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 179.13622751357744, "predator_policy": 388.3350217575325}, "policy_reward_mean": {"prey_policy": -50.61742331228365, "predator_policy": 101.91978467769317}, "custom_metrics": {}, "hist_stats": {"episode_reward": [35.10000000000023, -2.2956613079459616, 52.30000000000035, 93.99999999999946, 41.27668545957155, 138.35998813581944, 47.000000000000355, 189.59999999999982, 46.100000000000314, 122.59999999999911, 172.99184762314727, 183.89999999999952, 165.26660970450598, 63.400000000000325, 224.23591029611316, 118.26513246444676, 57.049342065984625, 56.287512516221504, 91.49999999999856, 77.70000000000017, 286.6692231913454, 34.20000000000022, 135.4999999999999, 189.7622134181783, 204.95900501687956, 41.46117592104707, 160.52089757879483, 41.90000000000027, 159.99999999999952, 56.25035590474681, 189.40904152072758, 32.4000000000002, 135.49999999999923, 137.09999999999957, -53.94695511723343, 170.90494465410117, 56.10000000000025, 60.20000000000013, 34.75612756781972, 43.60000000000028, 40.265044310772325, 47.1298862953699, 48.40000000000023, 36.202116310375594, 74.49999999999962, 153.19999999999987, 40.1000000000002, 131.19999999999982, 52.570622032848895, 56.000000000000156, 129.1999999999993, 86.20000000000002, 28.831075919194078, 160.79999999999959, 81.33852172443821, 103.01543537877356, 169.88064982359512, 48.30000000000023, 52.529310579969625, 48.028025438635616, 198.59999999999948, 184.470358209413, 37.06861395355878, 80.95181844992561, 33.900000000000134, 135.39999999999944, 148.89999999999955, 133.69999999999916, 226.89999999999938, 68.3000000000002, 154.45814550558052, 41.47674734270453, 180.74087067540847, 60.139037304427255, 153.66325386820998, 109.81254335834268, 96.80000000000011, 108.61895163315396, 159.3546697445331, 53.10000000000013, 125.29999999999959, 34.93780403323022, 139.0999999999999, 206.80167211533725, 40.50000000000029, 68.40000000000009, 88.29999999999927, 242.69999999999993, 37.700000000000266, 104.09999999999903, 229.34134979067687, 152.6250807412044, 157.8592262743011, 37.26670789146122, 35.20000000000023, 108.04468364708873, 87.5999999999994, 92.41177405235972, 131.94864151087714, 94.40623855187317], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [13.573129738316304, -53.54665936669982, -254.04609845621002, -260.27960040372835, -140.65478211067654, -73.1171426718985, 39.583255312047925, -34.03651010327775, -114.83317908671795, -92.66853807147267, -96.4272326280199, 93.09870255859556, -64.80740741555226, 20.000000000000014, 20.626642410773584, -16.792242611230414, 18.848497587615384, -92.85980597895414, 69.17606926139403, -109.36249015041209, -285.2321358475945, 105.74800812423979, 132.7888944272447, -19.35385941243218, -25.356623210719427, 11.326871936077456, -78.03601550180139, -20.07740583328924, 28.904313331271958, 85.71002709904536, -84.17058524148602, -101.59193807470932, -247.8691803256373, -34.87488956710395, -49.40531904969436, -141.19228141836533, -107.134889946308, 73.87102816456981, 4.171128342528487, -6.373188196460497, 72.0443042732162, -52.54708787865346, -32.67477650531073, -33.11217620680012, 17.408091439294907, -110.92817899556306, 80.28766474857159, -53.604483480981195, 64.90005398718623, -328.3984316256627, -221.37365036394135, -15.540567450569034, -217.97172194166885, 76.83739839192134, -62.4215290072797, -67.19987230581766, 82.82590198976501, -215.4723347673664, -63.01766150909464, -253.83034574412602, -72.05610867549865, 89.36722870345912, -103.9034532802869, -142.29070810227037, 0.5594712651248201, 21.887655692545323, -382.5350217575324, 117.78599718266575, -341.68754507993606, -271.3757928143444, 42.05974767402415, -113.91576456218526, 10.584749159468316, -368.0370289653096, -96.60173288891873, 6.578081936680414, -116.41208622158636, -38.927412945968925, -335.88260364800084, 33.30132488528524, -27.102952922490367, -70.03840438982733, -11.808869660467748, -17.067235360537826, 10.174001800704053, -2.962232113254194, -5.251613856427011, -54.123434986458186, -77.75098136410048, -19.99080009629646, 33.88040540161318, 40.0118549587175, 18.203034292193653, -101.55435256341609, 84.66934503983893, -118.51718584134521, -111.25275039532056, -35.27706169307365, 12.962713255211035, -154.80174341253127, -108.368940102753, 45.92361009447094, 66.26530936409696, -54.85406764413665, -50.32982812857711, -6.234569676365133, 43.52535653925046, -20.284647818951065, -122.72911794687963, -30.02930181547257, 64.88866316909824, -29.828281979136015, 27.845266783971347, 9.541578665059246, 1.103496687474779, 7.009962407567832, -8.299879170194934, -72.54471461247661, -97.58563081684744, -33.94553553761412, 161.42330774007206, -112.95182525200485, -6.1055308568346724, 40.28710026868663, -159.2584299113319, 1.9693763855458568, -203.51123731867187, -41.75335832068283, -112.73519084767737, -9.86848498904447, -75.14768969882805, 64.9005559888798, -41.26096743109789, 11.98667537860044, 89.1022150662958, -53.133135240501986, -21.790897701337713, 102.87572050846154, -103.60518017643587, -2.753002690682439, -77.5059788586302, -136.78681328113666, -35.26167272819433, 0.7616669233566751, 99.3892737675306, -121.76317749732668, -221.41484542454427, -0.26256937414734516, -81.64046493632515, 47.835445195899766, 41.62225202827415, -159.27689309555132, 8.414915969460758, -94.96493654962522, -101.89030278114168, -225.75780180988139, 42.3879814213417, -221.12051631037914, -194.2370444672595, -47.443484467917465, -68.94976936260595, -71.53127552961595, -175.21866179031935, -2.377011043507998, 7.336224962261236, 57.5840314172886, 148.94400313475802, -286.27355747273646, -38.05288701360526, -15.675153673344045, -157.06325915064687, 20.451311784900852, -34.19514158105644, -163.71926844518902, 179.13622751357744, -193.68286217716528, -5.466795255903271, 18.11348646225638, 73.35067178507347, -116.27200227841195, 81.3532898949211, -15.069998875773695, -1.5790888906085807, -103.01419787536915, 39.20269946596015, -70.07117731476804, -109.82064133551206, -6.986631127929058, -36.128808808176835, 15.187313791671755, -14.673585565722401, -251.67950712492743, 6.628822658497688, -90.79739622560763, -223.17849208443, -63.253333383580255, -19.653256456869457, -32.815082218808726, 25.002451968907792, -219.83803663194715], "policy_predator_policy_reward": [5.826870261683667, 69.24665936669969, 324.2059226722713, 187.82411487972215, 153.05478211067583, 113.01714267189817, 17.61674468795218, 70.83651010327776, 56.871368154986286, 191.90703446277513, 141.68851820524378, 0.0, 91.80740741555158, 0.0, 54.17335758922649, 131.5922426112305, 1.0515024123846184, 119.05980597895365, 36.62393073860571, 126.16249015041168, 294.04458931930264, 58.43138602720072, 27.098306487098423, 43.366658498089144, 101.5982771707111, 77.69808380843789, 92.33601550180148, 69.17740583328944, 11.711242094735995, 97.91032777106007, 159.598841430636, 144.42881435000547, 256.62014258831397, 83.17326937041157, 64.7437860571049, 182.14132692717635, 121.33488994630724, 3.428971835429686, 17.92887165747148, 61.97318819646065, 71.37501564844887, 195.79699114833366, 50.574776505310986, 49.41217620680031, 95.99190856070484, 133.02817899556257, 118.64992189155714, 44.429110259031575, 173.65858800042827, 294.7987946549283, 219.5255437438939, 58.84984999166302, 153.020176017792, 148.6350451107507, 84.92152900727922, 86.59987230581754, 35.917401426461, 256.72903135113984, 310.86582010807547, 62.23254304989086, 95.58973110505788, 76.50819038770996, 122.80345328028605, 155.79070810226966, 62.740528734875355, 50.312344307454744, 388.3350217575325, 13.51400281733393, 276.4934910271924, 282.6228917498557, 228.37632836739596, 14.384633174866076, 36.51525084053167, 377.03702896531087, 55.843560999739694, 94.38008995249868, 186.75715567238382, 3.338471062991101, 341.8826036480012, 4.298675114714987, 61.56155472910194, 75.84484689398705, 39.31993402285901, 36.68605729351662, 9.025998199295913, 32.16223211325439, 17.067987561023646, 78.50917759223691, 86.89305015310855, 85.34873130728765, 32.98846306649877, 46.31927657317061, 3.2969657078063443, 120.15435256341586, 51.96603493554656, 113.08180586595923, 51.82953263144456, 147.2709014897984, 28.814437033388117, 169.02459312393165, 122.3689401027523, 69.27638990552909, 2.934690635903009, 71.85406764413669, 69.17481916505344, 16.220654559082863, 82.67464346074956, 54.88464781895127, 149.0452344703959, 85.05170701639402, 61.64654055235777, 6.308513636455049, 122.72811266075166, 9.76569171381375, 28.196503312525255, 11.990037592432142, 39.59465245581429, 93.77925190682629, 173.417858483239, 6.14133330985798, 15.762281811455798, 134.36623570047647, 76.06028203580479, 74.22850676175635, 34.695476680536935, 159.6621907988072, 167.2233660646181, 158.99304802466287, 125.23519084767717, 31.268484989044566, 88.54768969882797, 57.09944401112018, 170.03924007813922, 8.135051974358213, 21.451638560862875, 76.27928161334323, 145.09089770133772, 0.7242794915378635, 119.58478321201947, 55.07339965509877, 101.30347201003724, 267.44746563530987, 25.72851731642294, 50.2482358311191, 10.105741511511418, 193.0090328936931, 242.16798791533478, 39.648464187783205, 159.3499139561802, 28.118359652455005, 62.6282279289202, 164.83895649669932, 73.18508403053936, 110.16493654962441, 168.40666761692708, 267.8603886072499, 213.90796331236706, 124.17924132120368, 231.43704446725934, 63.34348446791769, 164.82322943616253, 100.95781545605833, 192.6461275375021, 19.887349329554755, 38.363775037738804, 35.81596858271153, 113.3458349053624, 230.7853915479533, 54.85288701360539, 39.375153673344265, 203.76325915064663, 1.2486882150991712, 111.99514158105654, 174.21926844518845, 10.863772486422565, 246.3828621771652, 23.366795255903288, 1.686513537743613, 3.0493282149260565, 143.97200227841205, 11.169618052507685, 151.88844071902219, 78.45110531031017, 178.76726219687225, 5.491533832319006, 183.23617029079, 53.44679168121165, 100.62718867369004, 51.62880880817706, 4.512686208328209, 171.62334218999183, 202.77443414774723, 128.4407517753692, 43.32782179174049, 246.32318803637418, 132.52041148399576, 85.60806980806116, 98.80891037849513, 185.52092658311363, 103.72089663179854]}, "sampler_perf": {"mean_raw_obs_processing_ms": 24.612889016885457, "mean_inference_ms": 21.186329230406663, "mean_action_processing_ms": 5.908154806035579, "mean_env_wait_ms": 37.33530745612723, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.09543001651763916, "StateBufferConnector_ms": 0.03673684597015381, "ViewRequirementAgentConnector_ms": 1.255206823348999}, "num_episodes": 8, "episode_return_max": 286.6692231913454, "episode_return_min": -53.94695511723343, "episode_return_mean": 102.60472273081903, "episodes_this_iter": 8}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 149312, "num_agent_steps_trained": 149312, "num_env_steps_sampled": 37328, "num_env_steps_trained": 37328, "num_env_steps_sampled_this_iter": 0, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 0.0, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 37328, "num_env_steps_sampled_lifetime": 37328, "num_agent_steps_sampled_lifetime": 149312, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 149312, "timers": {"training_iteration_time_ms": 286624.627, "restore_workers_time_ms": 0.75, "training_step_time_ms": 286605.44, "sample_time_ms": 78934.31, "learn_time_ms": 311236.026, "learn_throughput": 59.967, "synch_weights_time_ms": 43.334}, "counters": {"num_env_steps_sampled": 37328, "num_env_steps_trained": 37328, "num_agent_steps_sampled": 149312, "num_agent_steps_trained": 149312}, "done": false, "training_iteration": 3, "trial_id": "d7bca_00000", "date": "2024-08-20_11-05-51", "timestamp": 1724132151, "time_this_iter_s": 122.8704628944397, "time_total_s": 922.5736792087555, "pid": 36059, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 16000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x32cf28c10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 922.5736792087555, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 98.20239520958083, "ram_util_percent": 83.68802395209582}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {}, "num_env_steps_sampled": 37328, "num_env_steps_trained": 37328, "num_agent_steps_sampled": 149312, "num_agent_steps_trained": 149312}, "env_runners": {"episode_reward_max": 286.6692231913454, "episode_reward_min": -53.94695511723343, "episode_reward_mean": 102.60472273081903, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -382.5350217575324, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 179.13622751357744, "predator_policy": 388.3350217575325}, "policy_reward_mean": {"prey_policy": -50.61742331228365, "predator_policy": 101.91978467769317}, "custom_metrics": {}, "hist_stats": {"episode_reward": [35.10000000000023, -2.2956613079459616, 52.30000000000035, 93.99999999999946, 41.27668545957155, 138.35998813581944, 47.000000000000355, 189.59999999999982, 46.100000000000314, 122.59999999999911, 172.99184762314727, 183.89999999999952, 165.26660970450598, 63.400000000000325, 224.23591029611316, 118.26513246444676, 57.049342065984625, 56.287512516221504, 91.49999999999856, 77.70000000000017, 286.6692231913454, 34.20000000000022, 135.4999999999999, 189.7622134181783, 204.95900501687956, 41.46117592104707, 160.52089757879483, 41.90000000000027, 159.99999999999952, 56.25035590474681, 189.40904152072758, 32.4000000000002, 135.49999999999923, 137.09999999999957, -53.94695511723343, 170.90494465410117, 56.10000000000025, 60.20000000000013, 34.75612756781972, 43.60000000000028, 40.265044310772325, 47.1298862953699, 48.40000000000023, 36.202116310375594, 74.49999999999962, 153.19999999999987, 40.1000000000002, 131.19999999999982, 52.570622032848895, 56.000000000000156, 129.1999999999993, 86.20000000000002, 28.831075919194078, 160.79999999999959, 81.33852172443821, 103.01543537877356, 169.88064982359512, 48.30000000000023, 52.529310579969625, 48.028025438635616, 198.59999999999948, 184.470358209413, 37.06861395355878, 80.95181844992561, 33.900000000000134, 135.39999999999944, 148.89999999999955, 133.69999999999916, 226.89999999999938, 68.3000000000002, 154.45814550558052, 41.47674734270453, 180.74087067540847, 60.139037304427255, 153.66325386820998, 109.81254335834268, 96.80000000000011, 108.61895163315396, 159.3546697445331, 53.10000000000013, 125.29999999999959, 34.93780403323022, 139.0999999999999, 206.80167211533725, 40.50000000000029, 68.40000000000009, 88.29999999999927, 242.69999999999993, 37.700000000000266, 104.09999999999903, 229.34134979067687, 152.6250807412044, 157.8592262743011, 37.26670789146122, 35.20000000000023, 108.04468364708873, 87.5999999999994, 92.41177405235972, 131.94864151087714, 94.40623855187317], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [13.573129738316304, -53.54665936669982, -254.04609845621002, -260.27960040372835, -140.65478211067654, -73.1171426718985, 39.583255312047925, -34.03651010327775, -114.83317908671795, -92.66853807147267, -96.4272326280199, 93.09870255859556, -64.80740741555226, 20.000000000000014, 20.626642410773584, -16.792242611230414, 18.848497587615384, -92.85980597895414, 69.17606926139403, -109.36249015041209, -285.2321358475945, 105.74800812423979, 132.7888944272447, -19.35385941243218, -25.356623210719427, 11.326871936077456, -78.03601550180139, -20.07740583328924, 28.904313331271958, 85.71002709904536, -84.17058524148602, -101.59193807470932, -247.8691803256373, -34.87488956710395, -49.40531904969436, -141.19228141836533, -107.134889946308, 73.87102816456981, 4.171128342528487, -6.373188196460497, 72.0443042732162, -52.54708787865346, -32.67477650531073, -33.11217620680012, 17.408091439294907, -110.92817899556306, 80.28766474857159, -53.604483480981195, 64.90005398718623, -328.3984316256627, -221.37365036394135, -15.540567450569034, -217.97172194166885, 76.83739839192134, -62.4215290072797, -67.19987230581766, 82.82590198976501, -215.4723347673664, -63.01766150909464, -253.83034574412602, -72.05610867549865, 89.36722870345912, -103.9034532802869, -142.29070810227037, 0.5594712651248201, 21.887655692545323, -382.5350217575324, 117.78599718266575, -341.68754507993606, -271.3757928143444, 42.05974767402415, -113.91576456218526, 10.584749159468316, -368.0370289653096, -96.60173288891873, 6.578081936680414, -116.41208622158636, -38.927412945968925, -335.88260364800084, 33.30132488528524, -27.102952922490367, -70.03840438982733, -11.808869660467748, -17.067235360537826, 10.174001800704053, -2.962232113254194, -5.251613856427011, -54.123434986458186, -77.75098136410048, -19.99080009629646, 33.88040540161318, 40.0118549587175, 18.203034292193653, -101.55435256341609, 84.66934503983893, -118.51718584134521, -111.25275039532056, -35.27706169307365, 12.962713255211035, -154.80174341253127, -108.368940102753, 45.92361009447094, 66.26530936409696, -54.85406764413665, -50.32982812857711, -6.234569676365133, 43.52535653925046, -20.284647818951065, -122.72911794687963, -30.02930181547257, 64.88866316909824, -29.828281979136015, 27.845266783971347, 9.541578665059246, 1.103496687474779, 7.009962407567832, -8.299879170194934, -72.54471461247661, -97.58563081684744, -33.94553553761412, 161.42330774007206, -112.95182525200485, -6.1055308568346724, 40.28710026868663, -159.2584299113319, 1.9693763855458568, -203.51123731867187, -41.75335832068283, -112.73519084767737, -9.86848498904447, -75.14768969882805, 64.9005559888798, -41.26096743109789, 11.98667537860044, 89.1022150662958, -53.133135240501986, -21.790897701337713, 102.87572050846154, -103.60518017643587, -2.753002690682439, -77.5059788586302, -136.78681328113666, -35.26167272819433, 0.7616669233566751, 99.3892737675306, -121.76317749732668, -221.41484542454427, -0.26256937414734516, -81.64046493632515, 47.835445195899766, 41.62225202827415, -159.27689309555132, 8.414915969460758, -94.96493654962522, -101.89030278114168, -225.75780180988139, 42.3879814213417, -221.12051631037914, -194.2370444672595, -47.443484467917465, -68.94976936260595, -71.53127552961595, -175.21866179031935, -2.377011043507998, 7.336224962261236, 57.5840314172886, 148.94400313475802, -286.27355747273646, -38.05288701360526, -15.675153673344045, -157.06325915064687, 20.451311784900852, -34.19514158105644, -163.71926844518902, 179.13622751357744, -193.68286217716528, -5.466795255903271, 18.11348646225638, 73.35067178507347, -116.27200227841195, 81.3532898949211, -15.069998875773695, -1.5790888906085807, -103.01419787536915, 39.20269946596015, -70.07117731476804, -109.82064133551206, -6.986631127929058, -36.128808808176835, 15.187313791671755, -14.673585565722401, -251.67950712492743, 6.628822658497688, -90.79739622560763, -223.17849208443, -63.253333383580255, -19.653256456869457, -32.815082218808726, 25.002451968907792, -219.83803663194715], "policy_predator_policy_reward": [5.826870261683667, 69.24665936669969, 324.2059226722713, 187.82411487972215, 153.05478211067583, 113.01714267189817, 17.61674468795218, 70.83651010327776, 56.871368154986286, 191.90703446277513, 141.68851820524378, 0.0, 91.80740741555158, 0.0, 54.17335758922649, 131.5922426112305, 1.0515024123846184, 119.05980597895365, 36.62393073860571, 126.16249015041168, 294.04458931930264, 58.43138602720072, 27.098306487098423, 43.366658498089144, 101.5982771707111, 77.69808380843789, 92.33601550180148, 69.17740583328944, 11.711242094735995, 97.91032777106007, 159.598841430636, 144.42881435000547, 256.62014258831397, 83.17326937041157, 64.7437860571049, 182.14132692717635, 121.33488994630724, 3.428971835429686, 17.92887165747148, 61.97318819646065, 71.37501564844887, 195.79699114833366, 50.574776505310986, 49.41217620680031, 95.99190856070484, 133.02817899556257, 118.64992189155714, 44.429110259031575, 173.65858800042827, 294.7987946549283, 219.5255437438939, 58.84984999166302, 153.020176017792, 148.6350451107507, 84.92152900727922, 86.59987230581754, 35.917401426461, 256.72903135113984, 310.86582010807547, 62.23254304989086, 95.58973110505788, 76.50819038770996, 122.80345328028605, 155.79070810226966, 62.740528734875355, 50.312344307454744, 388.3350217575325, 13.51400281733393, 276.4934910271924, 282.6228917498557, 228.37632836739596, 14.384633174866076, 36.51525084053167, 377.03702896531087, 55.843560999739694, 94.38008995249868, 186.75715567238382, 3.338471062991101, 341.8826036480012, 4.298675114714987, 61.56155472910194, 75.84484689398705, 39.31993402285901, 36.68605729351662, 9.025998199295913, 32.16223211325439, 17.067987561023646, 78.50917759223691, 86.89305015310855, 85.34873130728765, 32.98846306649877, 46.31927657317061, 3.2969657078063443, 120.15435256341586, 51.96603493554656, 113.08180586595923, 51.82953263144456, 147.2709014897984, 28.814437033388117, 169.02459312393165, 122.3689401027523, 69.27638990552909, 2.934690635903009, 71.85406764413669, 69.17481916505344, 16.220654559082863, 82.67464346074956, 54.88464781895127, 149.0452344703959, 85.05170701639402, 61.64654055235777, 6.308513636455049, 122.72811266075166, 9.76569171381375, 28.196503312525255, 11.990037592432142, 39.59465245581429, 93.77925190682629, 173.417858483239, 6.14133330985798, 15.762281811455798, 134.36623570047647, 76.06028203580479, 74.22850676175635, 34.695476680536935, 159.6621907988072, 167.2233660646181, 158.99304802466287, 125.23519084767717, 31.268484989044566, 88.54768969882797, 57.09944401112018, 170.03924007813922, 8.135051974358213, 21.451638560862875, 76.27928161334323, 145.09089770133772, 0.7242794915378635, 119.58478321201947, 55.07339965509877, 101.30347201003724, 267.44746563530987, 25.72851731642294, 50.2482358311191, 10.105741511511418, 193.0090328936931, 242.16798791533478, 39.648464187783205, 159.3499139561802, 28.118359652455005, 62.6282279289202, 164.83895649669932, 73.18508403053936, 110.16493654962441, 168.40666761692708, 267.8603886072499, 213.90796331236706, 124.17924132120368, 231.43704446725934, 63.34348446791769, 164.82322943616253, 100.95781545605833, 192.6461275375021, 19.887349329554755, 38.363775037738804, 35.81596858271153, 113.3458349053624, 230.7853915479533, 54.85288701360539, 39.375153673344265, 203.76325915064663, 1.2486882150991712, 111.99514158105654, 174.21926844518845, 10.863772486422565, 246.3828621771652, 23.366795255903288, 1.686513537743613, 3.0493282149260565, 143.97200227841205, 11.169618052507685, 151.88844071902219, 78.45110531031017, 178.76726219687225, 5.491533832319006, 183.23617029079, 53.44679168121165, 100.62718867369004, 51.62880880817706, 4.512686208328209, 171.62334218999183, 202.77443414774723, 128.4407517753692, 43.32782179174049, 246.32318803637418, 132.52041148399576, 85.60806980806116, 98.80891037849513, 185.52092658311363, 103.72089663179854]}, "sampler_perf": {"mean_raw_obs_processing_ms": 24.612889016885457, "mean_inference_ms": 21.186329230406663, "mean_action_processing_ms": 5.908154806035579, "mean_env_wait_ms": 37.33530745612723, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.09543001651763916, "StateBufferConnector_ms": 0.03673684597015381, "ViewRequirementAgentConnector_ms": 1.255206823348999}, "num_episodes": 0, "episode_return_max": 286.6692231913454, "episode_return_min": -53.94695511723343, "episode_return_mean": 102.60472273081903, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 149312, "num_agent_steps_trained": 149312, "num_env_steps_sampled": 37328, "num_env_steps_trained": 37328, "num_env_steps_sampled_this_iter": 0, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 0.0, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 37328, "num_env_steps_sampled_lifetime": 37328, "num_agent_steps_sampled_lifetime": 149312, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 149312, "timers": {"training_iteration_time_ms": 230206.069, "restore_workers_time_ms": 15.479, "training_step_time_ms": 230160.688, "sample_time_ms": 74404.083, "learn_time_ms": 311236.026, "learn_throughput": 59.967, "synch_weights_time_ms": 43.334}, "counters": {"num_env_steps_sampled": 37328, "num_env_steps_trained": 37328, "num_agent_steps_sampled": 149312, "num_agent_steps_trained": 149312}, "done": false, "training_iteration": 4, "trial_id": "d7bca_00000", "date": "2024-08-20_11-07-57", "timestamp": 1724132277, "time_this_iter_s": 122.69963312149048, "time_total_s": 1045.273312330246, "pid": 36059, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 16000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b0d6c550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1045.273312330246, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 97.36257309941519, "ram_util_percent": 83.72222222222223}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {}, "num_env_steps_sampled": 37328, "num_env_steps_trained": 37328, "num_agent_steps_sampled": 149312, "num_agent_steps_trained": 149312}, "env_runners": {"episode_reward_max": 286.6692231913454, "episode_reward_min": -53.94695511723343, "episode_reward_mean": 102.60472273081903, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -382.5350217575324, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 179.13622751357744, "predator_policy": 388.3350217575325}, "policy_reward_mean": {"prey_policy": -50.61742331228365, "predator_policy": 101.91978467769317}, "custom_metrics": {}, "hist_stats": {"episode_reward": [35.10000000000023, -2.2956613079459616, 52.30000000000035, 93.99999999999946, 41.27668545957155, 138.35998813581944, 47.000000000000355, 189.59999999999982, 46.100000000000314, 122.59999999999911, 172.99184762314727, 183.89999999999952, 165.26660970450598, 63.400000000000325, 224.23591029611316, 118.26513246444676, 57.049342065984625, 56.287512516221504, 91.49999999999856, 77.70000000000017, 286.6692231913454, 34.20000000000022, 135.4999999999999, 189.7622134181783, 204.95900501687956, 41.46117592104707, 160.52089757879483, 41.90000000000027, 159.99999999999952, 56.25035590474681, 189.40904152072758, 32.4000000000002, 135.49999999999923, 137.09999999999957, -53.94695511723343, 170.90494465410117, 56.10000000000025, 60.20000000000013, 34.75612756781972, 43.60000000000028, 40.265044310772325, 47.1298862953699, 48.40000000000023, 36.202116310375594, 74.49999999999962, 153.19999999999987, 40.1000000000002, 131.19999999999982, 52.570622032848895, 56.000000000000156, 129.1999999999993, 86.20000000000002, 28.831075919194078, 160.79999999999959, 81.33852172443821, 103.01543537877356, 169.88064982359512, 48.30000000000023, 52.529310579969625, 48.028025438635616, 198.59999999999948, 184.470358209413, 37.06861395355878, 80.95181844992561, 33.900000000000134, 135.39999999999944, 148.89999999999955, 133.69999999999916, 226.89999999999938, 68.3000000000002, 154.45814550558052, 41.47674734270453, 180.74087067540847, 60.139037304427255, 153.66325386820998, 109.81254335834268, 96.80000000000011, 108.61895163315396, 159.3546697445331, 53.10000000000013, 125.29999999999959, 34.93780403323022, 139.0999999999999, 206.80167211533725, 40.50000000000029, 68.40000000000009, 88.29999999999927, 242.69999999999993, 37.700000000000266, 104.09999999999903, 229.34134979067687, 152.6250807412044, 157.8592262743011, 37.26670789146122, 35.20000000000023, 108.04468364708873, 87.5999999999994, 92.41177405235972, 131.94864151087714, 94.40623855187317], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [13.573129738316304, -53.54665936669982, -254.04609845621002, -260.27960040372835, -140.65478211067654, -73.1171426718985, 39.583255312047925, -34.03651010327775, -114.83317908671795, -92.66853807147267, -96.4272326280199, 93.09870255859556, -64.80740741555226, 20.000000000000014, 20.626642410773584, -16.792242611230414, 18.848497587615384, -92.85980597895414, 69.17606926139403, -109.36249015041209, -285.2321358475945, 105.74800812423979, 132.7888944272447, -19.35385941243218, -25.356623210719427, 11.326871936077456, -78.03601550180139, -20.07740583328924, 28.904313331271958, 85.71002709904536, -84.17058524148602, -101.59193807470932, -247.8691803256373, -34.87488956710395, -49.40531904969436, -141.19228141836533, -107.134889946308, 73.87102816456981, 4.171128342528487, -6.373188196460497, 72.0443042732162, -52.54708787865346, -32.67477650531073, -33.11217620680012, 17.408091439294907, -110.92817899556306, 80.28766474857159, -53.604483480981195, 64.90005398718623, -328.3984316256627, -221.37365036394135, -15.540567450569034, -217.97172194166885, 76.83739839192134, -62.4215290072797, -67.19987230581766, 82.82590198976501, -215.4723347673664, -63.01766150909464, -253.83034574412602, -72.05610867549865, 89.36722870345912, -103.9034532802869, -142.29070810227037, 0.5594712651248201, 21.887655692545323, -382.5350217575324, 117.78599718266575, -341.68754507993606, -271.3757928143444, 42.05974767402415, -113.91576456218526, 10.584749159468316, -368.0370289653096, -96.60173288891873, 6.578081936680414, -116.41208622158636, -38.927412945968925, -335.88260364800084, 33.30132488528524, -27.102952922490367, -70.03840438982733, -11.808869660467748, -17.067235360537826, 10.174001800704053, -2.962232113254194, -5.251613856427011, -54.123434986458186, -77.75098136410048, -19.99080009629646, 33.88040540161318, 40.0118549587175, 18.203034292193653, -101.55435256341609, 84.66934503983893, -118.51718584134521, -111.25275039532056, -35.27706169307365, 12.962713255211035, -154.80174341253127, -108.368940102753, 45.92361009447094, 66.26530936409696, -54.85406764413665, -50.32982812857711, -6.234569676365133, 43.52535653925046, -20.284647818951065, -122.72911794687963, -30.02930181547257, 64.88866316909824, -29.828281979136015, 27.845266783971347, 9.541578665059246, 1.103496687474779, 7.009962407567832, -8.299879170194934, -72.54471461247661, -97.58563081684744, -33.94553553761412, 161.42330774007206, -112.95182525200485, -6.1055308568346724, 40.28710026868663, -159.2584299113319, 1.9693763855458568, -203.51123731867187, -41.75335832068283, -112.73519084767737, -9.86848498904447, -75.14768969882805, 64.9005559888798, -41.26096743109789, 11.98667537860044, 89.1022150662958, -53.133135240501986, -21.790897701337713, 102.87572050846154, -103.60518017643587, -2.753002690682439, -77.5059788586302, -136.78681328113666, -35.26167272819433, 0.7616669233566751, 99.3892737675306, -121.76317749732668, -221.41484542454427, -0.26256937414734516, -81.64046493632515, 47.835445195899766, 41.62225202827415, -159.27689309555132, 8.414915969460758, -94.96493654962522, -101.89030278114168, -225.75780180988139, 42.3879814213417, -221.12051631037914, -194.2370444672595, -47.443484467917465, -68.94976936260595, -71.53127552961595, -175.21866179031935, -2.377011043507998, 7.336224962261236, 57.5840314172886, 148.94400313475802, -286.27355747273646, -38.05288701360526, -15.675153673344045, -157.06325915064687, 20.451311784900852, -34.19514158105644, -163.71926844518902, 179.13622751357744, -193.68286217716528, -5.466795255903271, 18.11348646225638, 73.35067178507347, -116.27200227841195, 81.3532898949211, -15.069998875773695, -1.5790888906085807, -103.01419787536915, 39.20269946596015, -70.07117731476804, -109.82064133551206, -6.986631127929058, -36.128808808176835, 15.187313791671755, -14.673585565722401, -251.67950712492743, 6.628822658497688, -90.79739622560763, -223.17849208443, -63.253333383580255, -19.653256456869457, -32.815082218808726, 25.002451968907792, -219.83803663194715], "policy_predator_policy_reward": [5.826870261683667, 69.24665936669969, 324.2059226722713, 187.82411487972215, 153.05478211067583, 113.01714267189817, 17.61674468795218, 70.83651010327776, 56.871368154986286, 191.90703446277513, 141.68851820524378, 0.0, 91.80740741555158, 0.0, 54.17335758922649, 131.5922426112305, 1.0515024123846184, 119.05980597895365, 36.62393073860571, 126.16249015041168, 294.04458931930264, 58.43138602720072, 27.098306487098423, 43.366658498089144, 101.5982771707111, 77.69808380843789, 92.33601550180148, 69.17740583328944, 11.711242094735995, 97.91032777106007, 159.598841430636, 144.42881435000547, 256.62014258831397, 83.17326937041157, 64.7437860571049, 182.14132692717635, 121.33488994630724, 3.428971835429686, 17.92887165747148, 61.97318819646065, 71.37501564844887, 195.79699114833366, 50.574776505310986, 49.41217620680031, 95.99190856070484, 133.02817899556257, 118.64992189155714, 44.429110259031575, 173.65858800042827, 294.7987946549283, 219.5255437438939, 58.84984999166302, 153.020176017792, 148.6350451107507, 84.92152900727922, 86.59987230581754, 35.917401426461, 256.72903135113984, 310.86582010807547, 62.23254304989086, 95.58973110505788, 76.50819038770996, 122.80345328028605, 155.79070810226966, 62.740528734875355, 50.312344307454744, 388.3350217575325, 13.51400281733393, 276.4934910271924, 282.6228917498557, 228.37632836739596, 14.384633174866076, 36.51525084053167, 377.03702896531087, 55.843560999739694, 94.38008995249868, 186.75715567238382, 3.338471062991101, 341.8826036480012, 4.298675114714987, 61.56155472910194, 75.84484689398705, 39.31993402285901, 36.68605729351662, 9.025998199295913, 32.16223211325439, 17.067987561023646, 78.50917759223691, 86.89305015310855, 85.34873130728765, 32.98846306649877, 46.31927657317061, 3.2969657078063443, 120.15435256341586, 51.96603493554656, 113.08180586595923, 51.82953263144456, 147.2709014897984, 28.814437033388117, 169.02459312393165, 122.3689401027523, 69.27638990552909, 2.934690635903009, 71.85406764413669, 69.17481916505344, 16.220654559082863, 82.67464346074956, 54.88464781895127, 149.0452344703959, 85.05170701639402, 61.64654055235777, 6.308513636455049, 122.72811266075166, 9.76569171381375, 28.196503312525255, 11.990037592432142, 39.59465245581429, 93.77925190682629, 173.417858483239, 6.14133330985798, 15.762281811455798, 134.36623570047647, 76.06028203580479, 74.22850676175635, 34.695476680536935, 159.6621907988072, 167.2233660646181, 158.99304802466287, 125.23519084767717, 31.268484989044566, 88.54768969882797, 57.09944401112018, 170.03924007813922, 8.135051974358213, 21.451638560862875, 76.27928161334323, 145.09089770133772, 0.7242794915378635, 119.58478321201947, 55.07339965509877, 101.30347201003724, 267.44746563530987, 25.72851731642294, 50.2482358311191, 10.105741511511418, 193.0090328936931, 242.16798791533478, 39.648464187783205, 159.3499139561802, 28.118359652455005, 62.6282279289202, 164.83895649669932, 73.18508403053936, 110.16493654962441, 168.40666761692708, 267.8603886072499, 213.90796331236706, 124.17924132120368, 231.43704446725934, 63.34348446791769, 164.82322943616253, 100.95781545605833, 192.6461275375021, 19.887349329554755, 38.363775037738804, 35.81596858271153, 113.3458349053624, 230.7853915479533, 54.85288701360539, 39.375153673344265, 203.76325915064663, 1.2486882150991712, 111.99514158105654, 174.21926844518845, 10.863772486422565, 246.3828621771652, 23.366795255903288, 1.686513537743613, 3.0493282149260565, 143.97200227841205, 11.169618052507685, 151.88844071902219, 78.45110531031017, 178.76726219687225, 5.491533832319006, 183.23617029079, 53.44679168121165, 100.62718867369004, 51.62880880817706, 4.512686208328209, 171.62334218999183, 202.77443414774723, 128.4407517753692, 43.32782179174049, 246.32318803637418, 132.52041148399576, 85.60806980806116, 98.80891037849513, 185.52092658311363, 103.72089663179854]}, "sampler_perf": {"mean_raw_obs_processing_ms": 24.612889016885457, "mean_inference_ms": 21.186329230406663, "mean_action_processing_ms": 5.908154806035579, "mean_env_wait_ms": 37.33530745612723, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.09543001651763916, "StateBufferConnector_ms": 0.03673684597015381, "ViewRequirementAgentConnector_ms": 1.255206823348999}, "num_episodes": 0, "episode_return_max": 286.6692231913454, "episode_return_min": -53.94695511723343, "episode_return_mean": 102.60472273081903, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 149312, "num_agent_steps_trained": 149312, "num_env_steps_sampled": 37328, "num_env_steps_trained": 37328, "num_env_steps_sampled_this_iter": 0, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 0.0, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 37328, "num_env_steps_sampled_lifetime": 37328, "num_agent_steps_sampled_lifetime": 149312, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 149312, "timers": {"training_iteration_time_ms": 196347.555, "restore_workers_time_ms": 14.388, "training_step_time_ms": 196306.512, "sample_time_ms": 71697.593, "learn_time_ms": 311236.026, "learn_throughput": 59.967, "synch_weights_time_ms": 43.334}, "counters": {"num_env_steps_sampled": 37328, "num_env_steps_trained": 37328, "num_agent_steps_sampled": 149312, "num_agent_steps_trained": 149312}, "done": false, "training_iteration": 5, "trial_id": "d7bca_00000", "date": "2024-08-20_11-10-01", "timestamp": 1724132401, "time_this_iter_s": 122.28927803039551, "time_total_s": 1167.5625903606415, "pid": 36059, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 16000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x32ce5ce50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1167.5625903606415, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 97.68764705882354, "ram_util_percent": 83.66588235294118}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {}, "num_env_steps_sampled": 37328, "num_env_steps_trained": 37328, "num_agent_steps_sampled": 149312, "num_agent_steps_trained": 149312}, "env_runners": {"episode_reward_max": 286.6692231913454, "episode_reward_min": -53.94695511723343, "episode_reward_mean": 102.60472273081903, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -382.5350217575324, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 179.13622751357744, "predator_policy": 388.3350217575325}, "policy_reward_mean": {"prey_policy": -50.61742331228365, "predator_policy": 101.91978467769317}, "custom_metrics": {}, "hist_stats": {"episode_reward": [35.10000000000023, -2.2956613079459616, 52.30000000000035, 93.99999999999946, 41.27668545957155, 138.35998813581944, 47.000000000000355, 189.59999999999982, 46.100000000000314, 122.59999999999911, 172.99184762314727, 183.89999999999952, 165.26660970450598, 63.400000000000325, 224.23591029611316, 118.26513246444676, 57.049342065984625, 56.287512516221504, 91.49999999999856, 77.70000000000017, 286.6692231913454, 34.20000000000022, 135.4999999999999, 189.7622134181783, 204.95900501687956, 41.46117592104707, 160.52089757879483, 41.90000000000027, 159.99999999999952, 56.25035590474681, 189.40904152072758, 32.4000000000002, 135.49999999999923, 137.09999999999957, -53.94695511723343, 170.90494465410117, 56.10000000000025, 60.20000000000013, 34.75612756781972, 43.60000000000028, 40.265044310772325, 47.1298862953699, 48.40000000000023, 36.202116310375594, 74.49999999999962, 153.19999999999987, 40.1000000000002, 131.19999999999982, 52.570622032848895, 56.000000000000156, 129.1999999999993, 86.20000000000002, 28.831075919194078, 160.79999999999959, 81.33852172443821, 103.01543537877356, 169.88064982359512, 48.30000000000023, 52.529310579969625, 48.028025438635616, 198.59999999999948, 184.470358209413, 37.06861395355878, 80.95181844992561, 33.900000000000134, 135.39999999999944, 148.89999999999955, 133.69999999999916, 226.89999999999938, 68.3000000000002, 154.45814550558052, 41.47674734270453, 180.74087067540847, 60.139037304427255, 153.66325386820998, 109.81254335834268, 96.80000000000011, 108.61895163315396, 159.3546697445331, 53.10000000000013, 125.29999999999959, 34.93780403323022, 139.0999999999999, 206.80167211533725, 40.50000000000029, 68.40000000000009, 88.29999999999927, 242.69999999999993, 37.700000000000266, 104.09999999999903, 229.34134979067687, 152.6250807412044, 157.8592262743011, 37.26670789146122, 35.20000000000023, 108.04468364708873, 87.5999999999994, 92.41177405235972, 131.94864151087714, 94.40623855187317], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [13.573129738316304, -53.54665936669982, -254.04609845621002, -260.27960040372835, -140.65478211067654, -73.1171426718985, 39.583255312047925, -34.03651010327775, -114.83317908671795, -92.66853807147267, -96.4272326280199, 93.09870255859556, -64.80740741555226, 20.000000000000014, 20.626642410773584, -16.792242611230414, 18.848497587615384, -92.85980597895414, 69.17606926139403, -109.36249015041209, -285.2321358475945, 105.74800812423979, 132.7888944272447, -19.35385941243218, -25.356623210719427, 11.326871936077456, -78.03601550180139, -20.07740583328924, 28.904313331271958, 85.71002709904536, -84.17058524148602, -101.59193807470932, -247.8691803256373, -34.87488956710395, -49.40531904969436, -141.19228141836533, -107.134889946308, 73.87102816456981, 4.171128342528487, -6.373188196460497, 72.0443042732162, -52.54708787865346, -32.67477650531073, -33.11217620680012, 17.408091439294907, -110.92817899556306, 80.28766474857159, -53.604483480981195, 64.90005398718623, -328.3984316256627, -221.37365036394135, -15.540567450569034, -217.97172194166885, 76.83739839192134, -62.4215290072797, -67.19987230581766, 82.82590198976501, -215.4723347673664, -63.01766150909464, -253.83034574412602, -72.05610867549865, 89.36722870345912, -103.9034532802869, -142.29070810227037, 0.5594712651248201, 21.887655692545323, -382.5350217575324, 117.78599718266575, -341.68754507993606, -271.3757928143444, 42.05974767402415, -113.91576456218526, 10.584749159468316, -368.0370289653096, -96.60173288891873, 6.578081936680414, -116.41208622158636, -38.927412945968925, -335.88260364800084, 33.30132488528524, -27.102952922490367, -70.03840438982733, -11.808869660467748, -17.067235360537826, 10.174001800704053, -2.962232113254194, -5.251613856427011, -54.123434986458186, -77.75098136410048, -19.99080009629646, 33.88040540161318, 40.0118549587175, 18.203034292193653, -101.55435256341609, 84.66934503983893, -118.51718584134521, -111.25275039532056, -35.27706169307365, 12.962713255211035, -154.80174341253127, -108.368940102753, 45.92361009447094, 66.26530936409696, -54.85406764413665, -50.32982812857711, -6.234569676365133, 43.52535653925046, -20.284647818951065, -122.72911794687963, -30.02930181547257, 64.88866316909824, -29.828281979136015, 27.845266783971347, 9.541578665059246, 1.103496687474779, 7.009962407567832, -8.299879170194934, -72.54471461247661, -97.58563081684744, -33.94553553761412, 161.42330774007206, -112.95182525200485, -6.1055308568346724, 40.28710026868663, -159.2584299113319, 1.9693763855458568, -203.51123731867187, -41.75335832068283, -112.73519084767737, -9.86848498904447, -75.14768969882805, 64.9005559888798, -41.26096743109789, 11.98667537860044, 89.1022150662958, -53.133135240501986, -21.790897701337713, 102.87572050846154, -103.60518017643587, -2.753002690682439, -77.5059788586302, -136.78681328113666, -35.26167272819433, 0.7616669233566751, 99.3892737675306, -121.76317749732668, -221.41484542454427, -0.26256937414734516, -81.64046493632515, 47.835445195899766, 41.62225202827415, -159.27689309555132, 8.414915969460758, -94.96493654962522, -101.89030278114168, -225.75780180988139, 42.3879814213417, -221.12051631037914, -194.2370444672595, -47.443484467917465, -68.94976936260595, -71.53127552961595, -175.21866179031935, -2.377011043507998, 7.336224962261236, 57.5840314172886, 148.94400313475802, -286.27355747273646, -38.05288701360526, -15.675153673344045, -157.06325915064687, 20.451311784900852, -34.19514158105644, -163.71926844518902, 179.13622751357744, -193.68286217716528, -5.466795255903271, 18.11348646225638, 73.35067178507347, -116.27200227841195, 81.3532898949211, -15.069998875773695, -1.5790888906085807, -103.01419787536915, 39.20269946596015, -70.07117731476804, -109.82064133551206, -6.986631127929058, -36.128808808176835, 15.187313791671755, -14.673585565722401, -251.67950712492743, 6.628822658497688, -90.79739622560763, -223.17849208443, -63.253333383580255, -19.653256456869457, -32.815082218808726, 25.002451968907792, -219.83803663194715], "policy_predator_policy_reward": [5.826870261683667, 69.24665936669969, 324.2059226722713, 187.82411487972215, 153.05478211067583, 113.01714267189817, 17.61674468795218, 70.83651010327776, 56.871368154986286, 191.90703446277513, 141.68851820524378, 0.0, 91.80740741555158, 0.0, 54.17335758922649, 131.5922426112305, 1.0515024123846184, 119.05980597895365, 36.62393073860571, 126.16249015041168, 294.04458931930264, 58.43138602720072, 27.098306487098423, 43.366658498089144, 101.5982771707111, 77.69808380843789, 92.33601550180148, 69.17740583328944, 11.711242094735995, 97.91032777106007, 159.598841430636, 144.42881435000547, 256.62014258831397, 83.17326937041157, 64.7437860571049, 182.14132692717635, 121.33488994630724, 3.428971835429686, 17.92887165747148, 61.97318819646065, 71.37501564844887, 195.79699114833366, 50.574776505310986, 49.41217620680031, 95.99190856070484, 133.02817899556257, 118.64992189155714, 44.429110259031575, 173.65858800042827, 294.7987946549283, 219.5255437438939, 58.84984999166302, 153.020176017792, 148.6350451107507, 84.92152900727922, 86.59987230581754, 35.917401426461, 256.72903135113984, 310.86582010807547, 62.23254304989086, 95.58973110505788, 76.50819038770996, 122.80345328028605, 155.79070810226966, 62.740528734875355, 50.312344307454744, 388.3350217575325, 13.51400281733393, 276.4934910271924, 282.6228917498557, 228.37632836739596, 14.384633174866076, 36.51525084053167, 377.03702896531087, 55.843560999739694, 94.38008995249868, 186.75715567238382, 3.338471062991101, 341.8826036480012, 4.298675114714987, 61.56155472910194, 75.84484689398705, 39.31993402285901, 36.68605729351662, 9.025998199295913, 32.16223211325439, 17.067987561023646, 78.50917759223691, 86.89305015310855, 85.34873130728765, 32.98846306649877, 46.31927657317061, 3.2969657078063443, 120.15435256341586, 51.96603493554656, 113.08180586595923, 51.82953263144456, 147.2709014897984, 28.814437033388117, 169.02459312393165, 122.3689401027523, 69.27638990552909, 2.934690635903009, 71.85406764413669, 69.17481916505344, 16.220654559082863, 82.67464346074956, 54.88464781895127, 149.0452344703959, 85.05170701639402, 61.64654055235777, 6.308513636455049, 122.72811266075166, 9.76569171381375, 28.196503312525255, 11.990037592432142, 39.59465245581429, 93.77925190682629, 173.417858483239, 6.14133330985798, 15.762281811455798, 134.36623570047647, 76.06028203580479, 74.22850676175635, 34.695476680536935, 159.6621907988072, 167.2233660646181, 158.99304802466287, 125.23519084767717, 31.268484989044566, 88.54768969882797, 57.09944401112018, 170.03924007813922, 8.135051974358213, 21.451638560862875, 76.27928161334323, 145.09089770133772, 0.7242794915378635, 119.58478321201947, 55.07339965509877, 101.30347201003724, 267.44746563530987, 25.72851731642294, 50.2482358311191, 10.105741511511418, 193.0090328936931, 242.16798791533478, 39.648464187783205, 159.3499139561802, 28.118359652455005, 62.6282279289202, 164.83895649669932, 73.18508403053936, 110.16493654962441, 168.40666761692708, 267.8603886072499, 213.90796331236706, 124.17924132120368, 231.43704446725934, 63.34348446791769, 164.82322943616253, 100.95781545605833, 192.6461275375021, 19.887349329554755, 38.363775037738804, 35.81596858271153, 113.3458349053624, 230.7853915479533, 54.85288701360539, 39.375153673344265, 203.76325915064663, 1.2486882150991712, 111.99514158105654, 174.21926844518845, 10.863772486422565, 246.3828621771652, 23.366795255903288, 1.686513537743613, 3.0493282149260565, 143.97200227841205, 11.169618052507685, 151.88844071902219, 78.45110531031017, 178.76726219687225, 5.491533832319006, 183.23617029079, 53.44679168121165, 100.62718867369004, 51.62880880817706, 4.512686208328209, 171.62334218999183, 202.77443414774723, 128.4407517753692, 43.32782179174049, 246.32318803637418, 132.52041148399576, 85.60806980806116, 98.80891037849513, 185.52092658311363, 103.72089663179854]}, "sampler_perf": {"mean_raw_obs_processing_ms": 24.612889016885457, "mean_inference_ms": 21.186329230406663, "mean_action_processing_ms": 5.908154806035579, "mean_env_wait_ms": 37.33530745612723, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.09543001651763916, "StateBufferConnector_ms": 0.03673684597015381, "ViewRequirementAgentConnector_ms": 1.255206823348999}, "num_episodes": 0, "episode_return_max": 286.6692231913454, "episode_return_min": -53.94695511723343, "episode_return_mean": 102.60472273081903, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 149312, "num_agent_steps_trained": 149312, "num_env_steps_sampled": 37328, "num_env_steps_trained": 37328, "num_env_steps_sampled_this_iter": 0, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 0.0, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 37328, "num_env_steps_sampled_lifetime": 37328, "num_agent_steps_sampled_lifetime": 149312, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 149312, "timers": {"training_iteration_time_ms": 173842.079, "restore_workers_time_ms": 19.282, "training_step_time_ms": 173793.188, "sample_time_ms": 69951.206, "learn_time_ms": 311236.026, "learn_throughput": 59.967, "synch_weights_time_ms": 43.334}, "counters": {"num_env_steps_sampled": 37328, "num_env_steps_trained": 37328, "num_agent_steps_sampled": 149312, "num_agent_steps_trained": 149312}, "done": false, "training_iteration": 6, "trial_id": "d7bca_00000", "date": "2024-08-20_11-12-07", "timestamp": 1724132527, "time_this_iter_s": 123.16046619415283, "time_total_s": 1290.7230565547943, "pid": 36059, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 16000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b0d6c9d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1290.7230565547943, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 96.54352941176471, "ram_util_percent": 83.65411764705883}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {}, "num_env_steps_sampled": 37328, "num_env_steps_trained": 37328, "num_agent_steps_sampled": 149312, "num_agent_steps_trained": 149312}, "env_runners": {"episode_reward_max": 286.6692231913454, "episode_reward_min": -53.94695511723343, "episode_reward_mean": 102.60472273081903, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -382.5350217575324, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 179.13622751357744, "predator_policy": 388.3350217575325}, "policy_reward_mean": {"prey_policy": -50.61742331228365, "predator_policy": 101.91978467769317}, "custom_metrics": {}, "hist_stats": {"episode_reward": [35.10000000000023, -2.2956613079459616, 52.30000000000035, 93.99999999999946, 41.27668545957155, 138.35998813581944, 47.000000000000355, 189.59999999999982, 46.100000000000314, 122.59999999999911, 172.99184762314727, 183.89999999999952, 165.26660970450598, 63.400000000000325, 224.23591029611316, 118.26513246444676, 57.049342065984625, 56.287512516221504, 91.49999999999856, 77.70000000000017, 286.6692231913454, 34.20000000000022, 135.4999999999999, 189.7622134181783, 204.95900501687956, 41.46117592104707, 160.52089757879483, 41.90000000000027, 159.99999999999952, 56.25035590474681, 189.40904152072758, 32.4000000000002, 135.49999999999923, 137.09999999999957, -53.94695511723343, 170.90494465410117, 56.10000000000025, 60.20000000000013, 34.75612756781972, 43.60000000000028, 40.265044310772325, 47.1298862953699, 48.40000000000023, 36.202116310375594, 74.49999999999962, 153.19999999999987, 40.1000000000002, 131.19999999999982, 52.570622032848895, 56.000000000000156, 129.1999999999993, 86.20000000000002, 28.831075919194078, 160.79999999999959, 81.33852172443821, 103.01543537877356, 169.88064982359512, 48.30000000000023, 52.529310579969625, 48.028025438635616, 198.59999999999948, 184.470358209413, 37.06861395355878, 80.95181844992561, 33.900000000000134, 135.39999999999944, 148.89999999999955, 133.69999999999916, 226.89999999999938, 68.3000000000002, 154.45814550558052, 41.47674734270453, 180.74087067540847, 60.139037304427255, 153.66325386820998, 109.81254335834268, 96.80000000000011, 108.61895163315396, 159.3546697445331, 53.10000000000013, 125.29999999999959, 34.93780403323022, 139.0999999999999, 206.80167211533725, 40.50000000000029, 68.40000000000009, 88.29999999999927, 242.69999999999993, 37.700000000000266, 104.09999999999903, 229.34134979067687, 152.6250807412044, 157.8592262743011, 37.26670789146122, 35.20000000000023, 108.04468364708873, 87.5999999999994, 92.41177405235972, 131.94864151087714, 94.40623855187317], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [13.573129738316304, -53.54665936669982, -254.04609845621002, -260.27960040372835, -140.65478211067654, -73.1171426718985, 39.583255312047925, -34.03651010327775, -114.83317908671795, -92.66853807147267, -96.4272326280199, 93.09870255859556, -64.80740741555226, 20.000000000000014, 20.626642410773584, -16.792242611230414, 18.848497587615384, -92.85980597895414, 69.17606926139403, -109.36249015041209, -285.2321358475945, 105.74800812423979, 132.7888944272447, -19.35385941243218, -25.356623210719427, 11.326871936077456, -78.03601550180139, -20.07740583328924, 28.904313331271958, 85.71002709904536, -84.17058524148602, -101.59193807470932, -247.8691803256373, -34.87488956710395, -49.40531904969436, -141.19228141836533, -107.134889946308, 73.87102816456981, 4.171128342528487, -6.373188196460497, 72.0443042732162, -52.54708787865346, -32.67477650531073, -33.11217620680012, 17.408091439294907, -110.92817899556306, 80.28766474857159, -53.604483480981195, 64.90005398718623, -328.3984316256627, -221.37365036394135, -15.540567450569034, -217.97172194166885, 76.83739839192134, -62.4215290072797, -67.19987230581766, 82.82590198976501, -215.4723347673664, -63.01766150909464, -253.83034574412602, -72.05610867549865, 89.36722870345912, -103.9034532802869, -142.29070810227037, 0.5594712651248201, 21.887655692545323, -382.5350217575324, 117.78599718266575, -341.68754507993606, -271.3757928143444, 42.05974767402415, -113.91576456218526, 10.584749159468316, -368.0370289653096, -96.60173288891873, 6.578081936680414, -116.41208622158636, -38.927412945968925, -335.88260364800084, 33.30132488528524, -27.102952922490367, -70.03840438982733, -11.808869660467748, -17.067235360537826, 10.174001800704053, -2.962232113254194, -5.251613856427011, -54.123434986458186, -77.75098136410048, -19.99080009629646, 33.88040540161318, 40.0118549587175, 18.203034292193653, -101.55435256341609, 84.66934503983893, -118.51718584134521, -111.25275039532056, -35.27706169307365, 12.962713255211035, -154.80174341253127, -108.368940102753, 45.92361009447094, 66.26530936409696, -54.85406764413665, -50.32982812857711, -6.234569676365133, 43.52535653925046, -20.284647818951065, -122.72911794687963, -30.02930181547257, 64.88866316909824, -29.828281979136015, 27.845266783971347, 9.541578665059246, 1.103496687474779, 7.009962407567832, -8.299879170194934, -72.54471461247661, -97.58563081684744, -33.94553553761412, 161.42330774007206, -112.95182525200485, -6.1055308568346724, 40.28710026868663, -159.2584299113319, 1.9693763855458568, -203.51123731867187, -41.75335832068283, -112.73519084767737, -9.86848498904447, -75.14768969882805, 64.9005559888798, -41.26096743109789, 11.98667537860044, 89.1022150662958, -53.133135240501986, -21.790897701337713, 102.87572050846154, -103.60518017643587, -2.753002690682439, -77.5059788586302, -136.78681328113666, -35.26167272819433, 0.7616669233566751, 99.3892737675306, -121.76317749732668, -221.41484542454427, -0.26256937414734516, -81.64046493632515, 47.835445195899766, 41.62225202827415, -159.27689309555132, 8.414915969460758, -94.96493654962522, -101.89030278114168, -225.75780180988139, 42.3879814213417, -221.12051631037914, -194.2370444672595, -47.443484467917465, -68.94976936260595, -71.53127552961595, -175.21866179031935, -2.377011043507998, 7.336224962261236, 57.5840314172886, 148.94400313475802, -286.27355747273646, -38.05288701360526, -15.675153673344045, -157.06325915064687, 20.451311784900852, -34.19514158105644, -163.71926844518902, 179.13622751357744, -193.68286217716528, -5.466795255903271, 18.11348646225638, 73.35067178507347, -116.27200227841195, 81.3532898949211, -15.069998875773695, -1.5790888906085807, -103.01419787536915, 39.20269946596015, -70.07117731476804, -109.82064133551206, -6.986631127929058, -36.128808808176835, 15.187313791671755, -14.673585565722401, -251.67950712492743, 6.628822658497688, -90.79739622560763, -223.17849208443, -63.253333383580255, -19.653256456869457, -32.815082218808726, 25.002451968907792, -219.83803663194715], "policy_predator_policy_reward": [5.826870261683667, 69.24665936669969, 324.2059226722713, 187.82411487972215, 153.05478211067583, 113.01714267189817, 17.61674468795218, 70.83651010327776, 56.871368154986286, 191.90703446277513, 141.68851820524378, 0.0, 91.80740741555158, 0.0, 54.17335758922649, 131.5922426112305, 1.0515024123846184, 119.05980597895365, 36.62393073860571, 126.16249015041168, 294.04458931930264, 58.43138602720072, 27.098306487098423, 43.366658498089144, 101.5982771707111, 77.69808380843789, 92.33601550180148, 69.17740583328944, 11.711242094735995, 97.91032777106007, 159.598841430636, 144.42881435000547, 256.62014258831397, 83.17326937041157, 64.7437860571049, 182.14132692717635, 121.33488994630724, 3.428971835429686, 17.92887165747148, 61.97318819646065, 71.37501564844887, 195.79699114833366, 50.574776505310986, 49.41217620680031, 95.99190856070484, 133.02817899556257, 118.64992189155714, 44.429110259031575, 173.65858800042827, 294.7987946549283, 219.5255437438939, 58.84984999166302, 153.020176017792, 148.6350451107507, 84.92152900727922, 86.59987230581754, 35.917401426461, 256.72903135113984, 310.86582010807547, 62.23254304989086, 95.58973110505788, 76.50819038770996, 122.80345328028605, 155.79070810226966, 62.740528734875355, 50.312344307454744, 388.3350217575325, 13.51400281733393, 276.4934910271924, 282.6228917498557, 228.37632836739596, 14.384633174866076, 36.51525084053167, 377.03702896531087, 55.843560999739694, 94.38008995249868, 186.75715567238382, 3.338471062991101, 341.8826036480012, 4.298675114714987, 61.56155472910194, 75.84484689398705, 39.31993402285901, 36.68605729351662, 9.025998199295913, 32.16223211325439, 17.067987561023646, 78.50917759223691, 86.89305015310855, 85.34873130728765, 32.98846306649877, 46.31927657317061, 3.2969657078063443, 120.15435256341586, 51.96603493554656, 113.08180586595923, 51.82953263144456, 147.2709014897984, 28.814437033388117, 169.02459312393165, 122.3689401027523, 69.27638990552909, 2.934690635903009, 71.85406764413669, 69.17481916505344, 16.220654559082863, 82.67464346074956, 54.88464781895127, 149.0452344703959, 85.05170701639402, 61.64654055235777, 6.308513636455049, 122.72811266075166, 9.76569171381375, 28.196503312525255, 11.990037592432142, 39.59465245581429, 93.77925190682629, 173.417858483239, 6.14133330985798, 15.762281811455798, 134.36623570047647, 76.06028203580479, 74.22850676175635, 34.695476680536935, 159.6621907988072, 167.2233660646181, 158.99304802466287, 125.23519084767717, 31.268484989044566, 88.54768969882797, 57.09944401112018, 170.03924007813922, 8.135051974358213, 21.451638560862875, 76.27928161334323, 145.09089770133772, 0.7242794915378635, 119.58478321201947, 55.07339965509877, 101.30347201003724, 267.44746563530987, 25.72851731642294, 50.2482358311191, 10.105741511511418, 193.0090328936931, 242.16798791533478, 39.648464187783205, 159.3499139561802, 28.118359652455005, 62.6282279289202, 164.83895649669932, 73.18508403053936, 110.16493654962441, 168.40666761692708, 267.8603886072499, 213.90796331236706, 124.17924132120368, 231.43704446725934, 63.34348446791769, 164.82322943616253, 100.95781545605833, 192.6461275375021, 19.887349329554755, 38.363775037738804, 35.81596858271153, 113.3458349053624, 230.7853915479533, 54.85288701360539, 39.375153673344265, 203.76325915064663, 1.2486882150991712, 111.99514158105654, 174.21926844518845, 10.863772486422565, 246.3828621771652, 23.366795255903288, 1.686513537743613, 3.0493282149260565, 143.97200227841205, 11.169618052507685, 151.88844071902219, 78.45110531031017, 178.76726219687225, 5.491533832319006, 183.23617029079, 53.44679168121165, 100.62718867369004, 51.62880880817706, 4.512686208328209, 171.62334218999183, 202.77443414774723, 128.4407517753692, 43.32782179174049, 246.32318803637418, 132.52041148399576, 85.60806980806116, 98.80891037849513, 185.52092658311363, 103.72089663179854]}, "sampler_perf": {"mean_raw_obs_processing_ms": 24.612889016885457, "mean_inference_ms": 21.186329230406663, "mean_action_processing_ms": 5.908154806035579, "mean_env_wait_ms": 37.33530745612723, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.09543001651763916, "StateBufferConnector_ms": 0.03673684597015381, "ViewRequirementAgentConnector_ms": 1.255206823348999}, "num_episodes": 0, "episode_return_max": 286.6692231913454, "episode_return_min": -53.94695511723343, "episode_return_mean": 102.60472273081903, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 149312, "num_agent_steps_trained": 149312, "num_env_steps_sampled": 37328, "num_env_steps_trained": 37328, "num_env_steps_sampled_this_iter": 0, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 0.0, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 37328, "num_env_steps_sampled_lifetime": 37328, "num_agent_steps_sampled_lifetime": 149312, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 149312, "timers": {"training_iteration_time_ms": 157813.032, "restore_workers_time_ms": 23.523, "training_step_time_ms": 157754.972, "sample_time_ms": 68746.187, "learn_time_ms": 311236.026, "learn_throughput": 59.967, "synch_weights_time_ms": 43.334}, "counters": {"num_env_steps_sampled": 37328, "num_env_steps_trained": 37328, "num_agent_steps_sampled": 149312, "num_agent_steps_trained": 149312}, "done": false, "training_iteration": 7, "trial_id": "d7bca_00000", "date": "2024-08-20_11-14-14", "timestamp": 1724132654, "time_this_iter_s": 123.08423686027527, "time_total_s": 1413.8072934150696, "pid": 36059, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 16000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b0d6c790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1413.8072934150696, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 96.1810650887574, "ram_util_percent": 83.6940828402367}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {}, "num_env_steps_sampled": 37328, "num_env_steps_trained": 37328, "num_agent_steps_sampled": 149312, "num_agent_steps_trained": 149312}, "env_runners": {"episode_reward_max": 286.6692231913454, "episode_reward_min": -53.94695511723343, "episode_reward_mean": 102.60472273081903, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -382.5350217575324, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 179.13622751357744, "predator_policy": 388.3350217575325}, "policy_reward_mean": {"prey_policy": -50.61742331228365, "predator_policy": 101.91978467769317}, "custom_metrics": {}, "hist_stats": {"episode_reward": [35.10000000000023, -2.2956613079459616, 52.30000000000035, 93.99999999999946, 41.27668545957155, 138.35998813581944, 47.000000000000355, 189.59999999999982, 46.100000000000314, 122.59999999999911, 172.99184762314727, 183.89999999999952, 165.26660970450598, 63.400000000000325, 224.23591029611316, 118.26513246444676, 57.049342065984625, 56.287512516221504, 91.49999999999856, 77.70000000000017, 286.6692231913454, 34.20000000000022, 135.4999999999999, 189.7622134181783, 204.95900501687956, 41.46117592104707, 160.52089757879483, 41.90000000000027, 159.99999999999952, 56.25035590474681, 189.40904152072758, 32.4000000000002, 135.49999999999923, 137.09999999999957, -53.94695511723343, 170.90494465410117, 56.10000000000025, 60.20000000000013, 34.75612756781972, 43.60000000000028, 40.265044310772325, 47.1298862953699, 48.40000000000023, 36.202116310375594, 74.49999999999962, 153.19999999999987, 40.1000000000002, 131.19999999999982, 52.570622032848895, 56.000000000000156, 129.1999999999993, 86.20000000000002, 28.831075919194078, 160.79999999999959, 81.33852172443821, 103.01543537877356, 169.88064982359512, 48.30000000000023, 52.529310579969625, 48.028025438635616, 198.59999999999948, 184.470358209413, 37.06861395355878, 80.95181844992561, 33.900000000000134, 135.39999999999944, 148.89999999999955, 133.69999999999916, 226.89999999999938, 68.3000000000002, 154.45814550558052, 41.47674734270453, 180.74087067540847, 60.139037304427255, 153.66325386820998, 109.81254335834268, 96.80000000000011, 108.61895163315396, 159.3546697445331, 53.10000000000013, 125.29999999999959, 34.93780403323022, 139.0999999999999, 206.80167211533725, 40.50000000000029, 68.40000000000009, 88.29999999999927, 242.69999999999993, 37.700000000000266, 104.09999999999903, 229.34134979067687, 152.6250807412044, 157.8592262743011, 37.26670789146122, 35.20000000000023, 108.04468364708873, 87.5999999999994, 92.41177405235972, 131.94864151087714, 94.40623855187317], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [13.573129738316304, -53.54665936669982, -254.04609845621002, -260.27960040372835, -140.65478211067654, -73.1171426718985, 39.583255312047925, -34.03651010327775, -114.83317908671795, -92.66853807147267, -96.4272326280199, 93.09870255859556, -64.80740741555226, 20.000000000000014, 20.626642410773584, -16.792242611230414, 18.848497587615384, -92.85980597895414, 69.17606926139403, -109.36249015041209, -285.2321358475945, 105.74800812423979, 132.7888944272447, -19.35385941243218, -25.356623210719427, 11.326871936077456, -78.03601550180139, -20.07740583328924, 28.904313331271958, 85.71002709904536, -84.17058524148602, -101.59193807470932, -247.8691803256373, -34.87488956710395, -49.40531904969436, -141.19228141836533, -107.134889946308, 73.87102816456981, 4.171128342528487, -6.373188196460497, 72.0443042732162, -52.54708787865346, -32.67477650531073, -33.11217620680012, 17.408091439294907, -110.92817899556306, 80.28766474857159, -53.604483480981195, 64.90005398718623, -328.3984316256627, -221.37365036394135, -15.540567450569034, -217.97172194166885, 76.83739839192134, -62.4215290072797, -67.19987230581766, 82.82590198976501, -215.4723347673664, -63.01766150909464, -253.83034574412602, -72.05610867549865, 89.36722870345912, -103.9034532802869, -142.29070810227037, 0.5594712651248201, 21.887655692545323, -382.5350217575324, 117.78599718266575, -341.68754507993606, -271.3757928143444, 42.05974767402415, -113.91576456218526, 10.584749159468316, -368.0370289653096, -96.60173288891873, 6.578081936680414, -116.41208622158636, -38.927412945968925, -335.88260364800084, 33.30132488528524, -27.102952922490367, -70.03840438982733, -11.808869660467748, -17.067235360537826, 10.174001800704053, -2.962232113254194, -5.251613856427011, -54.123434986458186, -77.75098136410048, -19.99080009629646, 33.88040540161318, 40.0118549587175, 18.203034292193653, -101.55435256341609, 84.66934503983893, -118.51718584134521, -111.25275039532056, -35.27706169307365, 12.962713255211035, -154.80174341253127, -108.368940102753, 45.92361009447094, 66.26530936409696, -54.85406764413665, -50.32982812857711, -6.234569676365133, 43.52535653925046, -20.284647818951065, -122.72911794687963, -30.02930181547257, 64.88866316909824, -29.828281979136015, 27.845266783971347, 9.541578665059246, 1.103496687474779, 7.009962407567832, -8.299879170194934, -72.54471461247661, -97.58563081684744, -33.94553553761412, 161.42330774007206, -112.95182525200485, -6.1055308568346724, 40.28710026868663, -159.2584299113319, 1.9693763855458568, -203.51123731867187, -41.75335832068283, -112.73519084767737, -9.86848498904447, -75.14768969882805, 64.9005559888798, -41.26096743109789, 11.98667537860044, 89.1022150662958, -53.133135240501986, -21.790897701337713, 102.87572050846154, -103.60518017643587, -2.753002690682439, -77.5059788586302, -136.78681328113666, -35.26167272819433, 0.7616669233566751, 99.3892737675306, -121.76317749732668, -221.41484542454427, -0.26256937414734516, -81.64046493632515, 47.835445195899766, 41.62225202827415, -159.27689309555132, 8.414915969460758, -94.96493654962522, -101.89030278114168, -225.75780180988139, 42.3879814213417, -221.12051631037914, -194.2370444672595, -47.443484467917465, -68.94976936260595, -71.53127552961595, -175.21866179031935, -2.377011043507998, 7.336224962261236, 57.5840314172886, 148.94400313475802, -286.27355747273646, -38.05288701360526, -15.675153673344045, -157.06325915064687, 20.451311784900852, -34.19514158105644, -163.71926844518902, 179.13622751357744, -193.68286217716528, -5.466795255903271, 18.11348646225638, 73.35067178507347, -116.27200227841195, 81.3532898949211, -15.069998875773695, -1.5790888906085807, -103.01419787536915, 39.20269946596015, -70.07117731476804, -109.82064133551206, -6.986631127929058, -36.128808808176835, 15.187313791671755, -14.673585565722401, -251.67950712492743, 6.628822658497688, -90.79739622560763, -223.17849208443, -63.253333383580255, -19.653256456869457, -32.815082218808726, 25.002451968907792, -219.83803663194715], "policy_predator_policy_reward": [5.826870261683667, 69.24665936669969, 324.2059226722713, 187.82411487972215, 153.05478211067583, 113.01714267189817, 17.61674468795218, 70.83651010327776, 56.871368154986286, 191.90703446277513, 141.68851820524378, 0.0, 91.80740741555158, 0.0, 54.17335758922649, 131.5922426112305, 1.0515024123846184, 119.05980597895365, 36.62393073860571, 126.16249015041168, 294.04458931930264, 58.43138602720072, 27.098306487098423, 43.366658498089144, 101.5982771707111, 77.69808380843789, 92.33601550180148, 69.17740583328944, 11.711242094735995, 97.91032777106007, 159.598841430636, 144.42881435000547, 256.62014258831397, 83.17326937041157, 64.7437860571049, 182.14132692717635, 121.33488994630724, 3.428971835429686, 17.92887165747148, 61.97318819646065, 71.37501564844887, 195.79699114833366, 50.574776505310986, 49.41217620680031, 95.99190856070484, 133.02817899556257, 118.64992189155714, 44.429110259031575, 173.65858800042827, 294.7987946549283, 219.5255437438939, 58.84984999166302, 153.020176017792, 148.6350451107507, 84.92152900727922, 86.59987230581754, 35.917401426461, 256.72903135113984, 310.86582010807547, 62.23254304989086, 95.58973110505788, 76.50819038770996, 122.80345328028605, 155.79070810226966, 62.740528734875355, 50.312344307454744, 388.3350217575325, 13.51400281733393, 276.4934910271924, 282.6228917498557, 228.37632836739596, 14.384633174866076, 36.51525084053167, 377.03702896531087, 55.843560999739694, 94.38008995249868, 186.75715567238382, 3.338471062991101, 341.8826036480012, 4.298675114714987, 61.56155472910194, 75.84484689398705, 39.31993402285901, 36.68605729351662, 9.025998199295913, 32.16223211325439, 17.067987561023646, 78.50917759223691, 86.89305015310855, 85.34873130728765, 32.98846306649877, 46.31927657317061, 3.2969657078063443, 120.15435256341586, 51.96603493554656, 113.08180586595923, 51.82953263144456, 147.2709014897984, 28.814437033388117, 169.02459312393165, 122.3689401027523, 69.27638990552909, 2.934690635903009, 71.85406764413669, 69.17481916505344, 16.220654559082863, 82.67464346074956, 54.88464781895127, 149.0452344703959, 85.05170701639402, 61.64654055235777, 6.308513636455049, 122.72811266075166, 9.76569171381375, 28.196503312525255, 11.990037592432142, 39.59465245581429, 93.77925190682629, 173.417858483239, 6.14133330985798, 15.762281811455798, 134.36623570047647, 76.06028203580479, 74.22850676175635, 34.695476680536935, 159.6621907988072, 167.2233660646181, 158.99304802466287, 125.23519084767717, 31.268484989044566, 88.54768969882797, 57.09944401112018, 170.03924007813922, 8.135051974358213, 21.451638560862875, 76.27928161334323, 145.09089770133772, 0.7242794915378635, 119.58478321201947, 55.07339965509877, 101.30347201003724, 267.44746563530987, 25.72851731642294, 50.2482358311191, 10.105741511511418, 193.0090328936931, 242.16798791533478, 39.648464187783205, 159.3499139561802, 28.118359652455005, 62.6282279289202, 164.83895649669932, 73.18508403053936, 110.16493654962441, 168.40666761692708, 267.8603886072499, 213.90796331236706, 124.17924132120368, 231.43704446725934, 63.34348446791769, 164.82322943616253, 100.95781545605833, 192.6461275375021, 19.887349329554755, 38.363775037738804, 35.81596858271153, 113.3458349053624, 230.7853915479533, 54.85288701360539, 39.375153673344265, 203.76325915064663, 1.2486882150991712, 111.99514158105654, 174.21926844518845, 10.863772486422565, 246.3828621771652, 23.366795255903288, 1.686513537743613, 3.0493282149260565, 143.97200227841205, 11.169618052507685, 151.88844071902219, 78.45110531031017, 178.76726219687225, 5.491533832319006, 183.23617029079, 53.44679168121165, 100.62718867369004, 51.62880880817706, 4.512686208328209, 171.62334218999183, 202.77443414774723, 128.4407517753692, 43.32782179174049, 246.32318803637418, 132.52041148399576, 85.60806980806116, 98.80891037849513, 185.52092658311363, 103.72089663179854]}, "sampler_perf": {"mean_raw_obs_processing_ms": 24.612889016885457, "mean_inference_ms": 21.186329230406663, "mean_action_processing_ms": 5.908154806035579, "mean_env_wait_ms": 37.33530745612723, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.09543001651763916, "StateBufferConnector_ms": 0.03673684597015381, "ViewRequirementAgentConnector_ms": 1.255206823348999}, "num_episodes": 0, "episode_return_max": 286.6692231913454, "episode_return_min": -53.94695511723343, "episode_return_mean": 102.60472273081903, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 149312, "num_agent_steps_trained": 149312, "num_env_steps_sampled": 37328, "num_env_steps_trained": 37328, "num_env_steps_sampled_this_iter": 0, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 0.0, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 37328, "num_env_steps_sampled_lifetime": 37328, "num_agent_steps_sampled_lifetime": 149312, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 149312, "timers": {"training_iteration_time_ms": 145755.645, "restore_workers_time_ms": 21.303, "training_step_time_ms": 145697.892, "sample_time_ms": 67813.685, "learn_time_ms": 311236.026, "learn_throughput": 59.967, "synch_weights_time_ms": 43.334}, "counters": {"num_env_steps_sampled": 37328, "num_env_steps_trained": 37328, "num_agent_steps_sampled": 149312, "num_agent_steps_trained": 149312}, "done": false, "training_iteration": 8, "trial_id": "d7bca_00000", "date": "2024-08-20_11-16-21", "timestamp": 1724132781, "time_this_iter_s": 123.12730097770691, "time_total_s": 1536.9345943927765, "pid": 36059, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 16000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3ae8cf160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1536.9345943927765, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 97.0, "ram_util_percent": 83.72280701754386}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {}, "num_env_steps_sampled": 37328, "num_env_steps_trained": 37328, "num_agent_steps_sampled": 149312, "num_agent_steps_trained": 149312}, "env_runners": {"episode_reward_max": 286.6692231913454, "episode_reward_min": -53.94695511723343, "episode_reward_mean": 102.60472273081903, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -382.5350217575324, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 179.13622751357744, "predator_policy": 388.3350217575325}, "policy_reward_mean": {"prey_policy": -50.61742331228365, "predator_policy": 101.91978467769317}, "custom_metrics": {}, "hist_stats": {"episode_reward": [35.10000000000023, -2.2956613079459616, 52.30000000000035, 93.99999999999946, 41.27668545957155, 138.35998813581944, 47.000000000000355, 189.59999999999982, 46.100000000000314, 122.59999999999911, 172.99184762314727, 183.89999999999952, 165.26660970450598, 63.400000000000325, 224.23591029611316, 118.26513246444676, 57.049342065984625, 56.287512516221504, 91.49999999999856, 77.70000000000017, 286.6692231913454, 34.20000000000022, 135.4999999999999, 189.7622134181783, 204.95900501687956, 41.46117592104707, 160.52089757879483, 41.90000000000027, 159.99999999999952, 56.25035590474681, 189.40904152072758, 32.4000000000002, 135.49999999999923, 137.09999999999957, -53.94695511723343, 170.90494465410117, 56.10000000000025, 60.20000000000013, 34.75612756781972, 43.60000000000028, 40.265044310772325, 47.1298862953699, 48.40000000000023, 36.202116310375594, 74.49999999999962, 153.19999999999987, 40.1000000000002, 131.19999999999982, 52.570622032848895, 56.000000000000156, 129.1999999999993, 86.20000000000002, 28.831075919194078, 160.79999999999959, 81.33852172443821, 103.01543537877356, 169.88064982359512, 48.30000000000023, 52.529310579969625, 48.028025438635616, 198.59999999999948, 184.470358209413, 37.06861395355878, 80.95181844992561, 33.900000000000134, 135.39999999999944, 148.89999999999955, 133.69999999999916, 226.89999999999938, 68.3000000000002, 154.45814550558052, 41.47674734270453, 180.74087067540847, 60.139037304427255, 153.66325386820998, 109.81254335834268, 96.80000000000011, 108.61895163315396, 159.3546697445331, 53.10000000000013, 125.29999999999959, 34.93780403323022, 139.0999999999999, 206.80167211533725, 40.50000000000029, 68.40000000000009, 88.29999999999927, 242.69999999999993, 37.700000000000266, 104.09999999999903, 229.34134979067687, 152.6250807412044, 157.8592262743011, 37.26670789146122, 35.20000000000023, 108.04468364708873, 87.5999999999994, 92.41177405235972, 131.94864151087714, 94.40623855187317], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [13.573129738316304, -53.54665936669982, -254.04609845621002, -260.27960040372835, -140.65478211067654, -73.1171426718985, 39.583255312047925, -34.03651010327775, -114.83317908671795, -92.66853807147267, -96.4272326280199, 93.09870255859556, -64.80740741555226, 20.000000000000014, 20.626642410773584, -16.792242611230414, 18.848497587615384, -92.85980597895414, 69.17606926139403, -109.36249015041209, -285.2321358475945, 105.74800812423979, 132.7888944272447, -19.35385941243218, -25.356623210719427, 11.326871936077456, -78.03601550180139, -20.07740583328924, 28.904313331271958, 85.71002709904536, -84.17058524148602, -101.59193807470932, -247.8691803256373, -34.87488956710395, -49.40531904969436, -141.19228141836533, -107.134889946308, 73.87102816456981, 4.171128342528487, -6.373188196460497, 72.0443042732162, -52.54708787865346, -32.67477650531073, -33.11217620680012, 17.408091439294907, -110.92817899556306, 80.28766474857159, -53.604483480981195, 64.90005398718623, -328.3984316256627, -221.37365036394135, -15.540567450569034, -217.97172194166885, 76.83739839192134, -62.4215290072797, -67.19987230581766, 82.82590198976501, -215.4723347673664, -63.01766150909464, -253.83034574412602, -72.05610867549865, 89.36722870345912, -103.9034532802869, -142.29070810227037, 0.5594712651248201, 21.887655692545323, -382.5350217575324, 117.78599718266575, -341.68754507993606, -271.3757928143444, 42.05974767402415, -113.91576456218526, 10.584749159468316, -368.0370289653096, -96.60173288891873, 6.578081936680414, -116.41208622158636, -38.927412945968925, -335.88260364800084, 33.30132488528524, -27.102952922490367, -70.03840438982733, -11.808869660467748, -17.067235360537826, 10.174001800704053, -2.962232113254194, -5.251613856427011, -54.123434986458186, -77.75098136410048, -19.99080009629646, 33.88040540161318, 40.0118549587175, 18.203034292193653, -101.55435256341609, 84.66934503983893, -118.51718584134521, -111.25275039532056, -35.27706169307365, 12.962713255211035, -154.80174341253127, -108.368940102753, 45.92361009447094, 66.26530936409696, -54.85406764413665, -50.32982812857711, -6.234569676365133, 43.52535653925046, -20.284647818951065, -122.72911794687963, -30.02930181547257, 64.88866316909824, -29.828281979136015, 27.845266783971347, 9.541578665059246, 1.103496687474779, 7.009962407567832, -8.299879170194934, -72.54471461247661, -97.58563081684744, -33.94553553761412, 161.42330774007206, -112.95182525200485, -6.1055308568346724, 40.28710026868663, -159.2584299113319, 1.9693763855458568, -203.51123731867187, -41.75335832068283, -112.73519084767737, -9.86848498904447, -75.14768969882805, 64.9005559888798, -41.26096743109789, 11.98667537860044, 89.1022150662958, -53.133135240501986, -21.790897701337713, 102.87572050846154, -103.60518017643587, -2.753002690682439, -77.5059788586302, -136.78681328113666, -35.26167272819433, 0.7616669233566751, 99.3892737675306, -121.76317749732668, -221.41484542454427, -0.26256937414734516, -81.64046493632515, 47.835445195899766, 41.62225202827415, -159.27689309555132, 8.414915969460758, -94.96493654962522, -101.89030278114168, -225.75780180988139, 42.3879814213417, -221.12051631037914, -194.2370444672595, -47.443484467917465, -68.94976936260595, -71.53127552961595, -175.21866179031935, -2.377011043507998, 7.336224962261236, 57.5840314172886, 148.94400313475802, -286.27355747273646, -38.05288701360526, -15.675153673344045, -157.06325915064687, 20.451311784900852, -34.19514158105644, -163.71926844518902, 179.13622751357744, -193.68286217716528, -5.466795255903271, 18.11348646225638, 73.35067178507347, -116.27200227841195, 81.3532898949211, -15.069998875773695, -1.5790888906085807, -103.01419787536915, 39.20269946596015, -70.07117731476804, -109.82064133551206, -6.986631127929058, -36.128808808176835, 15.187313791671755, -14.673585565722401, -251.67950712492743, 6.628822658497688, -90.79739622560763, -223.17849208443, -63.253333383580255, -19.653256456869457, -32.815082218808726, 25.002451968907792, -219.83803663194715], "policy_predator_policy_reward": [5.826870261683667, 69.24665936669969, 324.2059226722713, 187.82411487972215, 153.05478211067583, 113.01714267189817, 17.61674468795218, 70.83651010327776, 56.871368154986286, 191.90703446277513, 141.68851820524378, 0.0, 91.80740741555158, 0.0, 54.17335758922649, 131.5922426112305, 1.0515024123846184, 119.05980597895365, 36.62393073860571, 126.16249015041168, 294.04458931930264, 58.43138602720072, 27.098306487098423, 43.366658498089144, 101.5982771707111, 77.69808380843789, 92.33601550180148, 69.17740583328944, 11.711242094735995, 97.91032777106007, 159.598841430636, 144.42881435000547, 256.62014258831397, 83.17326937041157, 64.7437860571049, 182.14132692717635, 121.33488994630724, 3.428971835429686, 17.92887165747148, 61.97318819646065, 71.37501564844887, 195.79699114833366, 50.574776505310986, 49.41217620680031, 95.99190856070484, 133.02817899556257, 118.64992189155714, 44.429110259031575, 173.65858800042827, 294.7987946549283, 219.5255437438939, 58.84984999166302, 153.020176017792, 148.6350451107507, 84.92152900727922, 86.59987230581754, 35.917401426461, 256.72903135113984, 310.86582010807547, 62.23254304989086, 95.58973110505788, 76.50819038770996, 122.80345328028605, 155.79070810226966, 62.740528734875355, 50.312344307454744, 388.3350217575325, 13.51400281733393, 276.4934910271924, 282.6228917498557, 228.37632836739596, 14.384633174866076, 36.51525084053167, 377.03702896531087, 55.843560999739694, 94.38008995249868, 186.75715567238382, 3.338471062991101, 341.8826036480012, 4.298675114714987, 61.56155472910194, 75.84484689398705, 39.31993402285901, 36.68605729351662, 9.025998199295913, 32.16223211325439, 17.067987561023646, 78.50917759223691, 86.89305015310855, 85.34873130728765, 32.98846306649877, 46.31927657317061, 3.2969657078063443, 120.15435256341586, 51.96603493554656, 113.08180586595923, 51.82953263144456, 147.2709014897984, 28.814437033388117, 169.02459312393165, 122.3689401027523, 69.27638990552909, 2.934690635903009, 71.85406764413669, 69.17481916505344, 16.220654559082863, 82.67464346074956, 54.88464781895127, 149.0452344703959, 85.05170701639402, 61.64654055235777, 6.308513636455049, 122.72811266075166, 9.76569171381375, 28.196503312525255, 11.990037592432142, 39.59465245581429, 93.77925190682629, 173.417858483239, 6.14133330985798, 15.762281811455798, 134.36623570047647, 76.06028203580479, 74.22850676175635, 34.695476680536935, 159.6621907988072, 167.2233660646181, 158.99304802466287, 125.23519084767717, 31.268484989044566, 88.54768969882797, 57.09944401112018, 170.03924007813922, 8.135051974358213, 21.451638560862875, 76.27928161334323, 145.09089770133772, 0.7242794915378635, 119.58478321201947, 55.07339965509877, 101.30347201003724, 267.44746563530987, 25.72851731642294, 50.2482358311191, 10.105741511511418, 193.0090328936931, 242.16798791533478, 39.648464187783205, 159.3499139561802, 28.118359652455005, 62.6282279289202, 164.83895649669932, 73.18508403053936, 110.16493654962441, 168.40666761692708, 267.8603886072499, 213.90796331236706, 124.17924132120368, 231.43704446725934, 63.34348446791769, 164.82322943616253, 100.95781545605833, 192.6461275375021, 19.887349329554755, 38.363775037738804, 35.81596858271153, 113.3458349053624, 230.7853915479533, 54.85288701360539, 39.375153673344265, 203.76325915064663, 1.2486882150991712, 111.99514158105654, 174.21926844518845, 10.863772486422565, 246.3828621771652, 23.366795255903288, 1.686513537743613, 3.0493282149260565, 143.97200227841205, 11.169618052507685, 151.88844071902219, 78.45110531031017, 178.76726219687225, 5.491533832319006, 183.23617029079, 53.44679168121165, 100.62718867369004, 51.62880880817706, 4.512686208328209, 171.62334218999183, 202.77443414774723, 128.4407517753692, 43.32782179174049, 246.32318803637418, 132.52041148399576, 85.60806980806116, 98.80891037849513, 185.52092658311363, 103.72089663179854]}, "sampler_perf": {"mean_raw_obs_processing_ms": 24.612889016885457, "mean_inference_ms": 21.186329230406663, "mean_action_processing_ms": 5.908154806035579, "mean_env_wait_ms": 37.33530745612723, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.09543001651763916, "StateBufferConnector_ms": 0.03673684597015381, "ViewRequirementAgentConnector_ms": 1.255206823348999}, "num_episodes": 0, "episode_return_max": 286.6692231913454, "episode_return_min": -53.94695511723343, "episode_return_mean": 102.60472273081903, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 149312, "num_agent_steps_trained": 149312, "num_env_steps_sampled": 37328, "num_env_steps_trained": 37328, "num_env_steps_sampled_this_iter": 0, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 0.0, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 37328, "num_env_steps_sampled_lifetime": 37328, "num_agent_steps_sampled_lifetime": 149312, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 149312, "timers": {"training_iteration_time_ms": 136364.086, "restore_workers_time_ms": 22.83, "training_step_time_ms": 136304.203, "sample_time_ms": 67073.449, "learn_time_ms": 311236.026, "learn_throughput": 59.967, "synch_weights_time_ms": 43.334}, "counters": {"num_env_steps_sampled": 37328, "num_env_steps_trained": 37328, "num_agent_steps_sampled": 149312, "num_agent_steps_trained": 149312}, "done": false, "training_iteration": 9, "trial_id": "d7bca_00000", "date": "2024-08-20_11-18-27", "timestamp": 1724132907, "time_this_iter_s": 123.00254201889038, "time_total_s": 1659.9371364116669, "pid": 36059, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 16000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b0d6cc10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1659.9371364116669, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 97.0702380952381, "ram_util_percent": 83.7077380952381}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {}, "num_env_steps_sampled": 37328, "num_env_steps_trained": 37328, "num_agent_steps_sampled": 149312, "num_agent_steps_trained": 149312}, "env_runners": {"episode_reward_max": 286.6692231913454, "episode_reward_min": -53.94695511723343, "episode_reward_mean": 102.60472273081903, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -382.5350217575324, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 179.13622751357744, "predator_policy": 388.3350217575325}, "policy_reward_mean": {"prey_policy": -50.61742331228365, "predator_policy": 101.91978467769317}, "custom_metrics": {}, "hist_stats": {"episode_reward": [35.10000000000023, -2.2956613079459616, 52.30000000000035, 93.99999999999946, 41.27668545957155, 138.35998813581944, 47.000000000000355, 189.59999999999982, 46.100000000000314, 122.59999999999911, 172.99184762314727, 183.89999999999952, 165.26660970450598, 63.400000000000325, 224.23591029611316, 118.26513246444676, 57.049342065984625, 56.287512516221504, 91.49999999999856, 77.70000000000017, 286.6692231913454, 34.20000000000022, 135.4999999999999, 189.7622134181783, 204.95900501687956, 41.46117592104707, 160.52089757879483, 41.90000000000027, 159.99999999999952, 56.25035590474681, 189.40904152072758, 32.4000000000002, 135.49999999999923, 137.09999999999957, -53.94695511723343, 170.90494465410117, 56.10000000000025, 60.20000000000013, 34.75612756781972, 43.60000000000028, 40.265044310772325, 47.1298862953699, 48.40000000000023, 36.202116310375594, 74.49999999999962, 153.19999999999987, 40.1000000000002, 131.19999999999982, 52.570622032848895, 56.000000000000156, 129.1999999999993, 86.20000000000002, 28.831075919194078, 160.79999999999959, 81.33852172443821, 103.01543537877356, 169.88064982359512, 48.30000000000023, 52.529310579969625, 48.028025438635616, 198.59999999999948, 184.470358209413, 37.06861395355878, 80.95181844992561, 33.900000000000134, 135.39999999999944, 148.89999999999955, 133.69999999999916, 226.89999999999938, 68.3000000000002, 154.45814550558052, 41.47674734270453, 180.74087067540847, 60.139037304427255, 153.66325386820998, 109.81254335834268, 96.80000000000011, 108.61895163315396, 159.3546697445331, 53.10000000000013, 125.29999999999959, 34.93780403323022, 139.0999999999999, 206.80167211533725, 40.50000000000029, 68.40000000000009, 88.29999999999927, 242.69999999999993, 37.700000000000266, 104.09999999999903, 229.34134979067687, 152.6250807412044, 157.8592262743011, 37.26670789146122, 35.20000000000023, 108.04468364708873, 87.5999999999994, 92.41177405235972, 131.94864151087714, 94.40623855187317], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [13.573129738316304, -53.54665936669982, -254.04609845621002, -260.27960040372835, -140.65478211067654, -73.1171426718985, 39.583255312047925, -34.03651010327775, -114.83317908671795, -92.66853807147267, -96.4272326280199, 93.09870255859556, -64.80740741555226, 20.000000000000014, 20.626642410773584, -16.792242611230414, 18.848497587615384, -92.85980597895414, 69.17606926139403, -109.36249015041209, -285.2321358475945, 105.74800812423979, 132.7888944272447, -19.35385941243218, -25.356623210719427, 11.326871936077456, -78.03601550180139, -20.07740583328924, 28.904313331271958, 85.71002709904536, -84.17058524148602, -101.59193807470932, -247.8691803256373, -34.87488956710395, -49.40531904969436, -141.19228141836533, -107.134889946308, 73.87102816456981, 4.171128342528487, -6.373188196460497, 72.0443042732162, -52.54708787865346, -32.67477650531073, -33.11217620680012, 17.408091439294907, -110.92817899556306, 80.28766474857159, -53.604483480981195, 64.90005398718623, -328.3984316256627, -221.37365036394135, -15.540567450569034, -217.97172194166885, 76.83739839192134, -62.4215290072797, -67.19987230581766, 82.82590198976501, -215.4723347673664, -63.01766150909464, -253.83034574412602, -72.05610867549865, 89.36722870345912, -103.9034532802869, -142.29070810227037, 0.5594712651248201, 21.887655692545323, -382.5350217575324, 117.78599718266575, -341.68754507993606, -271.3757928143444, 42.05974767402415, -113.91576456218526, 10.584749159468316, -368.0370289653096, -96.60173288891873, 6.578081936680414, -116.41208622158636, -38.927412945968925, -335.88260364800084, 33.30132488528524, -27.102952922490367, -70.03840438982733, -11.808869660467748, -17.067235360537826, 10.174001800704053, -2.962232113254194, -5.251613856427011, -54.123434986458186, -77.75098136410048, -19.99080009629646, 33.88040540161318, 40.0118549587175, 18.203034292193653, -101.55435256341609, 84.66934503983893, -118.51718584134521, -111.25275039532056, -35.27706169307365, 12.962713255211035, -154.80174341253127, -108.368940102753, 45.92361009447094, 66.26530936409696, -54.85406764413665, -50.32982812857711, -6.234569676365133, 43.52535653925046, -20.284647818951065, -122.72911794687963, -30.02930181547257, 64.88866316909824, -29.828281979136015, 27.845266783971347, 9.541578665059246, 1.103496687474779, 7.009962407567832, -8.299879170194934, -72.54471461247661, -97.58563081684744, -33.94553553761412, 161.42330774007206, -112.95182525200485, -6.1055308568346724, 40.28710026868663, -159.2584299113319, 1.9693763855458568, -203.51123731867187, -41.75335832068283, -112.73519084767737, -9.86848498904447, -75.14768969882805, 64.9005559888798, -41.26096743109789, 11.98667537860044, 89.1022150662958, -53.133135240501986, -21.790897701337713, 102.87572050846154, -103.60518017643587, -2.753002690682439, -77.5059788586302, -136.78681328113666, -35.26167272819433, 0.7616669233566751, 99.3892737675306, -121.76317749732668, -221.41484542454427, -0.26256937414734516, -81.64046493632515, 47.835445195899766, 41.62225202827415, -159.27689309555132, 8.414915969460758, -94.96493654962522, -101.89030278114168, -225.75780180988139, 42.3879814213417, -221.12051631037914, -194.2370444672595, -47.443484467917465, -68.94976936260595, -71.53127552961595, -175.21866179031935, -2.377011043507998, 7.336224962261236, 57.5840314172886, 148.94400313475802, -286.27355747273646, -38.05288701360526, -15.675153673344045, -157.06325915064687, 20.451311784900852, -34.19514158105644, -163.71926844518902, 179.13622751357744, -193.68286217716528, -5.466795255903271, 18.11348646225638, 73.35067178507347, -116.27200227841195, 81.3532898949211, -15.069998875773695, -1.5790888906085807, -103.01419787536915, 39.20269946596015, -70.07117731476804, -109.82064133551206, -6.986631127929058, -36.128808808176835, 15.187313791671755, -14.673585565722401, -251.67950712492743, 6.628822658497688, -90.79739622560763, -223.17849208443, -63.253333383580255, -19.653256456869457, -32.815082218808726, 25.002451968907792, -219.83803663194715], "policy_predator_policy_reward": [5.826870261683667, 69.24665936669969, 324.2059226722713, 187.82411487972215, 153.05478211067583, 113.01714267189817, 17.61674468795218, 70.83651010327776, 56.871368154986286, 191.90703446277513, 141.68851820524378, 0.0, 91.80740741555158, 0.0, 54.17335758922649, 131.5922426112305, 1.0515024123846184, 119.05980597895365, 36.62393073860571, 126.16249015041168, 294.04458931930264, 58.43138602720072, 27.098306487098423, 43.366658498089144, 101.5982771707111, 77.69808380843789, 92.33601550180148, 69.17740583328944, 11.711242094735995, 97.91032777106007, 159.598841430636, 144.42881435000547, 256.62014258831397, 83.17326937041157, 64.7437860571049, 182.14132692717635, 121.33488994630724, 3.428971835429686, 17.92887165747148, 61.97318819646065, 71.37501564844887, 195.79699114833366, 50.574776505310986, 49.41217620680031, 95.99190856070484, 133.02817899556257, 118.64992189155714, 44.429110259031575, 173.65858800042827, 294.7987946549283, 219.5255437438939, 58.84984999166302, 153.020176017792, 148.6350451107507, 84.92152900727922, 86.59987230581754, 35.917401426461, 256.72903135113984, 310.86582010807547, 62.23254304989086, 95.58973110505788, 76.50819038770996, 122.80345328028605, 155.79070810226966, 62.740528734875355, 50.312344307454744, 388.3350217575325, 13.51400281733393, 276.4934910271924, 282.6228917498557, 228.37632836739596, 14.384633174866076, 36.51525084053167, 377.03702896531087, 55.843560999739694, 94.38008995249868, 186.75715567238382, 3.338471062991101, 341.8826036480012, 4.298675114714987, 61.56155472910194, 75.84484689398705, 39.31993402285901, 36.68605729351662, 9.025998199295913, 32.16223211325439, 17.067987561023646, 78.50917759223691, 86.89305015310855, 85.34873130728765, 32.98846306649877, 46.31927657317061, 3.2969657078063443, 120.15435256341586, 51.96603493554656, 113.08180586595923, 51.82953263144456, 147.2709014897984, 28.814437033388117, 169.02459312393165, 122.3689401027523, 69.27638990552909, 2.934690635903009, 71.85406764413669, 69.17481916505344, 16.220654559082863, 82.67464346074956, 54.88464781895127, 149.0452344703959, 85.05170701639402, 61.64654055235777, 6.308513636455049, 122.72811266075166, 9.76569171381375, 28.196503312525255, 11.990037592432142, 39.59465245581429, 93.77925190682629, 173.417858483239, 6.14133330985798, 15.762281811455798, 134.36623570047647, 76.06028203580479, 74.22850676175635, 34.695476680536935, 159.6621907988072, 167.2233660646181, 158.99304802466287, 125.23519084767717, 31.268484989044566, 88.54768969882797, 57.09944401112018, 170.03924007813922, 8.135051974358213, 21.451638560862875, 76.27928161334323, 145.09089770133772, 0.7242794915378635, 119.58478321201947, 55.07339965509877, 101.30347201003724, 267.44746563530987, 25.72851731642294, 50.2482358311191, 10.105741511511418, 193.0090328936931, 242.16798791533478, 39.648464187783205, 159.3499139561802, 28.118359652455005, 62.6282279289202, 164.83895649669932, 73.18508403053936, 110.16493654962441, 168.40666761692708, 267.8603886072499, 213.90796331236706, 124.17924132120368, 231.43704446725934, 63.34348446791769, 164.82322943616253, 100.95781545605833, 192.6461275375021, 19.887349329554755, 38.363775037738804, 35.81596858271153, 113.3458349053624, 230.7853915479533, 54.85288701360539, 39.375153673344265, 203.76325915064663, 1.2486882150991712, 111.99514158105654, 174.21926844518845, 10.863772486422565, 246.3828621771652, 23.366795255903288, 1.686513537743613, 3.0493282149260565, 143.97200227841205, 11.169618052507685, 151.88844071902219, 78.45110531031017, 178.76726219687225, 5.491533832319006, 183.23617029079, 53.44679168121165, 100.62718867369004, 51.62880880817706, 4.512686208328209, 171.62334218999183, 202.77443414774723, 128.4407517753692, 43.32782179174049, 246.32318803637418, 132.52041148399576, 85.60806980806116, 98.80891037849513, 185.52092658311363, 103.72089663179854]}, "sampler_perf": {"mean_raw_obs_processing_ms": 24.612889016885457, "mean_inference_ms": 21.186329230406663, "mean_action_processing_ms": 5.908154806035579, "mean_env_wait_ms": 37.33530745612723, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.09543001651763916, "StateBufferConnector_ms": 0.03673684597015381, "ViewRequirementAgentConnector_ms": 1.255206823348999}, "num_episodes": 0, "episode_return_max": 286.6692231913454, "episode_return_min": -53.94695511723343, "episode_return_mean": 102.60472273081903, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 149312, "num_agent_steps_trained": 149312, "num_env_steps_sampled": 37328, "num_env_steps_trained": 37328, "num_env_steps_sampled_this_iter": 0, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 0.0, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 37328, "num_env_steps_sampled_lifetime": 37328, "num_agent_steps_sampled_lifetime": 149312, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 149312, "timers": {"training_iteration_time_ms": 128858.727, "restore_workers_time_ms": 23.407, "training_step_time_ms": 128800.23, "sample_time_ms": 66492.447, "learn_time_ms": 311236.026, "learn_throughput": 59.967, "synch_weights_time_ms": 43.334}, "counters": {"num_env_steps_sampled": 37328, "num_env_steps_trained": 37328, "num_agent_steps_sampled": 149312, "num_agent_steps_trained": 149312}, "done": false, "training_iteration": 10, "trial_id": "d7bca_00000", "date": "2024-08-20_11-20-33", "timestamp": 1724133033, "time_this_iter_s": 122.97399401664734, "time_total_s": 1782.9111304283142, "pid": 36059, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 16000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3ae8cff70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1782.9111304283142, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 96.81369047619049, "ram_util_percent": 83.68869047619049}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {}, "num_env_steps_sampled": 37328, "num_env_steps_trained": 37328, "num_agent_steps_sampled": 149312, "num_agent_steps_trained": 149312}, "env_runners": {"episode_reward_max": 286.6692231913454, "episode_reward_min": -53.94695511723343, "episode_reward_mean": 102.60472273081903, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -382.5350217575324, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 179.13622751357744, "predator_policy": 388.3350217575325}, "policy_reward_mean": {"prey_policy": -50.61742331228365, "predator_policy": 101.91978467769317}, "custom_metrics": {}, "hist_stats": {"episode_reward": [35.10000000000023, -2.2956613079459616, 52.30000000000035, 93.99999999999946, 41.27668545957155, 138.35998813581944, 47.000000000000355, 189.59999999999982, 46.100000000000314, 122.59999999999911, 172.99184762314727, 183.89999999999952, 165.26660970450598, 63.400000000000325, 224.23591029611316, 118.26513246444676, 57.049342065984625, 56.287512516221504, 91.49999999999856, 77.70000000000017, 286.6692231913454, 34.20000000000022, 135.4999999999999, 189.7622134181783, 204.95900501687956, 41.46117592104707, 160.52089757879483, 41.90000000000027, 159.99999999999952, 56.25035590474681, 189.40904152072758, 32.4000000000002, 135.49999999999923, 137.09999999999957, -53.94695511723343, 170.90494465410117, 56.10000000000025, 60.20000000000013, 34.75612756781972, 43.60000000000028, 40.265044310772325, 47.1298862953699, 48.40000000000023, 36.202116310375594, 74.49999999999962, 153.19999999999987, 40.1000000000002, 131.19999999999982, 52.570622032848895, 56.000000000000156, 129.1999999999993, 86.20000000000002, 28.831075919194078, 160.79999999999959, 81.33852172443821, 103.01543537877356, 169.88064982359512, 48.30000000000023, 52.529310579969625, 48.028025438635616, 198.59999999999948, 184.470358209413, 37.06861395355878, 80.95181844992561, 33.900000000000134, 135.39999999999944, 148.89999999999955, 133.69999999999916, 226.89999999999938, 68.3000000000002, 154.45814550558052, 41.47674734270453, 180.74087067540847, 60.139037304427255, 153.66325386820998, 109.81254335834268, 96.80000000000011, 108.61895163315396, 159.3546697445331, 53.10000000000013, 125.29999999999959, 34.93780403323022, 139.0999999999999, 206.80167211533725, 40.50000000000029, 68.40000000000009, 88.29999999999927, 242.69999999999993, 37.700000000000266, 104.09999999999903, 229.34134979067687, 152.6250807412044, 157.8592262743011, 37.26670789146122, 35.20000000000023, 108.04468364708873, 87.5999999999994, 92.41177405235972, 131.94864151087714, 94.40623855187317], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [13.573129738316304, -53.54665936669982, -254.04609845621002, -260.27960040372835, -140.65478211067654, -73.1171426718985, 39.583255312047925, -34.03651010327775, -114.83317908671795, -92.66853807147267, -96.4272326280199, 93.09870255859556, -64.80740741555226, 20.000000000000014, 20.626642410773584, -16.792242611230414, 18.848497587615384, -92.85980597895414, 69.17606926139403, -109.36249015041209, -285.2321358475945, 105.74800812423979, 132.7888944272447, -19.35385941243218, -25.356623210719427, 11.326871936077456, -78.03601550180139, -20.07740583328924, 28.904313331271958, 85.71002709904536, -84.17058524148602, -101.59193807470932, -247.8691803256373, -34.87488956710395, -49.40531904969436, -141.19228141836533, -107.134889946308, 73.87102816456981, 4.171128342528487, -6.373188196460497, 72.0443042732162, -52.54708787865346, -32.67477650531073, -33.11217620680012, 17.408091439294907, -110.92817899556306, 80.28766474857159, -53.604483480981195, 64.90005398718623, -328.3984316256627, -221.37365036394135, -15.540567450569034, -217.97172194166885, 76.83739839192134, -62.4215290072797, -67.19987230581766, 82.82590198976501, -215.4723347673664, -63.01766150909464, -253.83034574412602, -72.05610867549865, 89.36722870345912, -103.9034532802869, -142.29070810227037, 0.5594712651248201, 21.887655692545323, -382.5350217575324, 117.78599718266575, -341.68754507993606, -271.3757928143444, 42.05974767402415, -113.91576456218526, 10.584749159468316, -368.0370289653096, -96.60173288891873, 6.578081936680414, -116.41208622158636, -38.927412945968925, -335.88260364800084, 33.30132488528524, -27.102952922490367, -70.03840438982733, -11.808869660467748, -17.067235360537826, 10.174001800704053, -2.962232113254194, -5.251613856427011, -54.123434986458186, -77.75098136410048, -19.99080009629646, 33.88040540161318, 40.0118549587175, 18.203034292193653, -101.55435256341609, 84.66934503983893, -118.51718584134521, -111.25275039532056, -35.27706169307365, 12.962713255211035, -154.80174341253127, -108.368940102753, 45.92361009447094, 66.26530936409696, -54.85406764413665, -50.32982812857711, -6.234569676365133, 43.52535653925046, -20.284647818951065, -122.72911794687963, -30.02930181547257, 64.88866316909824, -29.828281979136015, 27.845266783971347, 9.541578665059246, 1.103496687474779, 7.009962407567832, -8.299879170194934, -72.54471461247661, -97.58563081684744, -33.94553553761412, 161.42330774007206, -112.95182525200485, -6.1055308568346724, 40.28710026868663, -159.2584299113319, 1.9693763855458568, -203.51123731867187, -41.75335832068283, -112.73519084767737, -9.86848498904447, -75.14768969882805, 64.9005559888798, -41.26096743109789, 11.98667537860044, 89.1022150662958, -53.133135240501986, -21.790897701337713, 102.87572050846154, -103.60518017643587, -2.753002690682439, -77.5059788586302, -136.78681328113666, -35.26167272819433, 0.7616669233566751, 99.3892737675306, -121.76317749732668, -221.41484542454427, -0.26256937414734516, -81.64046493632515, 47.835445195899766, 41.62225202827415, -159.27689309555132, 8.414915969460758, -94.96493654962522, -101.89030278114168, -225.75780180988139, 42.3879814213417, -221.12051631037914, -194.2370444672595, -47.443484467917465, -68.94976936260595, -71.53127552961595, -175.21866179031935, -2.377011043507998, 7.336224962261236, 57.5840314172886, 148.94400313475802, -286.27355747273646, -38.05288701360526, -15.675153673344045, -157.06325915064687, 20.451311784900852, -34.19514158105644, -163.71926844518902, 179.13622751357744, -193.68286217716528, -5.466795255903271, 18.11348646225638, 73.35067178507347, -116.27200227841195, 81.3532898949211, -15.069998875773695, -1.5790888906085807, -103.01419787536915, 39.20269946596015, -70.07117731476804, -109.82064133551206, -6.986631127929058, -36.128808808176835, 15.187313791671755, -14.673585565722401, -251.67950712492743, 6.628822658497688, -90.79739622560763, -223.17849208443, -63.253333383580255, -19.653256456869457, -32.815082218808726, 25.002451968907792, -219.83803663194715], "policy_predator_policy_reward": [5.826870261683667, 69.24665936669969, 324.2059226722713, 187.82411487972215, 153.05478211067583, 113.01714267189817, 17.61674468795218, 70.83651010327776, 56.871368154986286, 191.90703446277513, 141.68851820524378, 0.0, 91.80740741555158, 0.0, 54.17335758922649, 131.5922426112305, 1.0515024123846184, 119.05980597895365, 36.62393073860571, 126.16249015041168, 294.04458931930264, 58.43138602720072, 27.098306487098423, 43.366658498089144, 101.5982771707111, 77.69808380843789, 92.33601550180148, 69.17740583328944, 11.711242094735995, 97.91032777106007, 159.598841430636, 144.42881435000547, 256.62014258831397, 83.17326937041157, 64.7437860571049, 182.14132692717635, 121.33488994630724, 3.428971835429686, 17.92887165747148, 61.97318819646065, 71.37501564844887, 195.79699114833366, 50.574776505310986, 49.41217620680031, 95.99190856070484, 133.02817899556257, 118.64992189155714, 44.429110259031575, 173.65858800042827, 294.7987946549283, 219.5255437438939, 58.84984999166302, 153.020176017792, 148.6350451107507, 84.92152900727922, 86.59987230581754, 35.917401426461, 256.72903135113984, 310.86582010807547, 62.23254304989086, 95.58973110505788, 76.50819038770996, 122.80345328028605, 155.79070810226966, 62.740528734875355, 50.312344307454744, 388.3350217575325, 13.51400281733393, 276.4934910271924, 282.6228917498557, 228.37632836739596, 14.384633174866076, 36.51525084053167, 377.03702896531087, 55.843560999739694, 94.38008995249868, 186.75715567238382, 3.338471062991101, 341.8826036480012, 4.298675114714987, 61.56155472910194, 75.84484689398705, 39.31993402285901, 36.68605729351662, 9.025998199295913, 32.16223211325439, 17.067987561023646, 78.50917759223691, 86.89305015310855, 85.34873130728765, 32.98846306649877, 46.31927657317061, 3.2969657078063443, 120.15435256341586, 51.96603493554656, 113.08180586595923, 51.82953263144456, 147.2709014897984, 28.814437033388117, 169.02459312393165, 122.3689401027523, 69.27638990552909, 2.934690635903009, 71.85406764413669, 69.17481916505344, 16.220654559082863, 82.67464346074956, 54.88464781895127, 149.0452344703959, 85.05170701639402, 61.64654055235777, 6.308513636455049, 122.72811266075166, 9.76569171381375, 28.196503312525255, 11.990037592432142, 39.59465245581429, 93.77925190682629, 173.417858483239, 6.14133330985798, 15.762281811455798, 134.36623570047647, 76.06028203580479, 74.22850676175635, 34.695476680536935, 159.6621907988072, 167.2233660646181, 158.99304802466287, 125.23519084767717, 31.268484989044566, 88.54768969882797, 57.09944401112018, 170.03924007813922, 8.135051974358213, 21.451638560862875, 76.27928161334323, 145.09089770133772, 0.7242794915378635, 119.58478321201947, 55.07339965509877, 101.30347201003724, 267.44746563530987, 25.72851731642294, 50.2482358311191, 10.105741511511418, 193.0090328936931, 242.16798791533478, 39.648464187783205, 159.3499139561802, 28.118359652455005, 62.6282279289202, 164.83895649669932, 73.18508403053936, 110.16493654962441, 168.40666761692708, 267.8603886072499, 213.90796331236706, 124.17924132120368, 231.43704446725934, 63.34348446791769, 164.82322943616253, 100.95781545605833, 192.6461275375021, 19.887349329554755, 38.363775037738804, 35.81596858271153, 113.3458349053624, 230.7853915479533, 54.85288701360539, 39.375153673344265, 203.76325915064663, 1.2486882150991712, 111.99514158105654, 174.21926844518845, 10.863772486422565, 246.3828621771652, 23.366795255903288, 1.686513537743613, 3.0493282149260565, 143.97200227841205, 11.169618052507685, 151.88844071902219, 78.45110531031017, 178.76726219687225, 5.491533832319006, 183.23617029079, 53.44679168121165, 100.62718867369004, 51.62880880817706, 4.512686208328209, 171.62334218999183, 202.77443414774723, 128.4407517753692, 43.32782179174049, 246.32318803637418, 132.52041148399576, 85.60806980806116, 98.80891037849513, 185.52092658311363, 103.72089663179854]}, "sampler_perf": {"mean_raw_obs_processing_ms": 24.612889016885457, "mean_inference_ms": 21.186329230406663, "mean_action_processing_ms": 5.908154806035579, "mean_env_wait_ms": 37.33530745612723, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.09543001651763916, "StateBufferConnector_ms": 0.03673684597015381, "ViewRequirementAgentConnector_ms": 1.255206823348999}, "num_episodes": 0, "episode_return_max": 286.6692231913454, "episode_return_min": -53.94695511723343, "episode_return_mean": 102.60472273081903, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 149312, "num_agent_steps_trained": 149312, "num_env_steps_sampled": 37328, "num_env_steps_trained": 37328, "num_env_steps_sampled_this_iter": 0, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 0.0, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 37328, "num_env_steps_sampled_lifetime": 37328, "num_agent_steps_sampled_lifetime": 149312, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 149312, "timers": {"training_iteration_time_ms": 98012.09, "restore_workers_time_ms": 26.061, "training_step_time_ms": 97942.154, "sample_time_ms": 66787.634, "learn_time_ms": 311236.026, "learn_throughput": 59.967, "synch_weights_time_ms": 43.334}, "counters": {"num_env_steps_sampled": 37328, "num_env_steps_trained": 37328, "num_agent_steps_sampled": 149312, "num_agent_steps_trained": 149312}, "done": false, "training_iteration": 11, "trial_id": "d7bca_00000", "date": "2024-08-20_11-22-39", "timestamp": 1724133159, "time_this_iter_s": 123.63052010536194, "time_total_s": 1906.5416505336761, "pid": 36059, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 16000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x32cf289d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1906.5416505336761, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 97.00828402366862, "ram_util_percent": 83.85680473372781}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {}, "num_env_steps_sampled": 37328, "num_env_steps_trained": 37328, "num_agent_steps_sampled": 149312, "num_agent_steps_trained": 149312}, "env_runners": {"episode_reward_max": 286.6692231913454, "episode_reward_min": -53.94695511723343, "episode_reward_mean": 102.60472273081903, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -382.5350217575324, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 179.13622751357744, "predator_policy": 388.3350217575325}, "policy_reward_mean": {"prey_policy": -50.61742331228365, "predator_policy": 101.91978467769317}, "custom_metrics": {}, "hist_stats": {"episode_reward": [35.10000000000023, -2.2956613079459616, 52.30000000000035, 93.99999999999946, 41.27668545957155, 138.35998813581944, 47.000000000000355, 189.59999999999982, 46.100000000000314, 122.59999999999911, 172.99184762314727, 183.89999999999952, 165.26660970450598, 63.400000000000325, 224.23591029611316, 118.26513246444676, 57.049342065984625, 56.287512516221504, 91.49999999999856, 77.70000000000017, 286.6692231913454, 34.20000000000022, 135.4999999999999, 189.7622134181783, 204.95900501687956, 41.46117592104707, 160.52089757879483, 41.90000000000027, 159.99999999999952, 56.25035590474681, 189.40904152072758, 32.4000000000002, 135.49999999999923, 137.09999999999957, -53.94695511723343, 170.90494465410117, 56.10000000000025, 60.20000000000013, 34.75612756781972, 43.60000000000028, 40.265044310772325, 47.1298862953699, 48.40000000000023, 36.202116310375594, 74.49999999999962, 153.19999999999987, 40.1000000000002, 131.19999999999982, 52.570622032848895, 56.000000000000156, 129.1999999999993, 86.20000000000002, 28.831075919194078, 160.79999999999959, 81.33852172443821, 103.01543537877356, 169.88064982359512, 48.30000000000023, 52.529310579969625, 48.028025438635616, 198.59999999999948, 184.470358209413, 37.06861395355878, 80.95181844992561, 33.900000000000134, 135.39999999999944, 148.89999999999955, 133.69999999999916, 226.89999999999938, 68.3000000000002, 154.45814550558052, 41.47674734270453, 180.74087067540847, 60.139037304427255, 153.66325386820998, 109.81254335834268, 96.80000000000011, 108.61895163315396, 159.3546697445331, 53.10000000000013, 125.29999999999959, 34.93780403323022, 139.0999999999999, 206.80167211533725, 40.50000000000029, 68.40000000000009, 88.29999999999927, 242.69999999999993, 37.700000000000266, 104.09999999999903, 229.34134979067687, 152.6250807412044, 157.8592262743011, 37.26670789146122, 35.20000000000023, 108.04468364708873, 87.5999999999994, 92.41177405235972, 131.94864151087714, 94.40623855187317], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [13.573129738316304, -53.54665936669982, -254.04609845621002, -260.27960040372835, -140.65478211067654, -73.1171426718985, 39.583255312047925, -34.03651010327775, -114.83317908671795, -92.66853807147267, -96.4272326280199, 93.09870255859556, -64.80740741555226, 20.000000000000014, 20.626642410773584, -16.792242611230414, 18.848497587615384, -92.85980597895414, 69.17606926139403, -109.36249015041209, -285.2321358475945, 105.74800812423979, 132.7888944272447, -19.35385941243218, -25.356623210719427, 11.326871936077456, -78.03601550180139, -20.07740583328924, 28.904313331271958, 85.71002709904536, -84.17058524148602, -101.59193807470932, -247.8691803256373, -34.87488956710395, -49.40531904969436, -141.19228141836533, -107.134889946308, 73.87102816456981, 4.171128342528487, -6.373188196460497, 72.0443042732162, -52.54708787865346, -32.67477650531073, -33.11217620680012, 17.408091439294907, -110.92817899556306, 80.28766474857159, -53.604483480981195, 64.90005398718623, -328.3984316256627, -221.37365036394135, -15.540567450569034, -217.97172194166885, 76.83739839192134, -62.4215290072797, -67.19987230581766, 82.82590198976501, -215.4723347673664, -63.01766150909464, -253.83034574412602, -72.05610867549865, 89.36722870345912, -103.9034532802869, -142.29070810227037, 0.5594712651248201, 21.887655692545323, -382.5350217575324, 117.78599718266575, -341.68754507993606, -271.3757928143444, 42.05974767402415, -113.91576456218526, 10.584749159468316, -368.0370289653096, -96.60173288891873, 6.578081936680414, -116.41208622158636, -38.927412945968925, -335.88260364800084, 33.30132488528524, -27.102952922490367, -70.03840438982733, -11.808869660467748, -17.067235360537826, 10.174001800704053, -2.962232113254194, -5.251613856427011, -54.123434986458186, -77.75098136410048, -19.99080009629646, 33.88040540161318, 40.0118549587175, 18.203034292193653, -101.55435256341609, 84.66934503983893, -118.51718584134521, -111.25275039532056, -35.27706169307365, 12.962713255211035, -154.80174341253127, -108.368940102753, 45.92361009447094, 66.26530936409696, -54.85406764413665, -50.32982812857711, -6.234569676365133, 43.52535653925046, -20.284647818951065, -122.72911794687963, -30.02930181547257, 64.88866316909824, -29.828281979136015, 27.845266783971347, 9.541578665059246, 1.103496687474779, 7.009962407567832, -8.299879170194934, -72.54471461247661, -97.58563081684744, -33.94553553761412, 161.42330774007206, -112.95182525200485, -6.1055308568346724, 40.28710026868663, -159.2584299113319, 1.9693763855458568, -203.51123731867187, -41.75335832068283, -112.73519084767737, -9.86848498904447, -75.14768969882805, 64.9005559888798, -41.26096743109789, 11.98667537860044, 89.1022150662958, -53.133135240501986, -21.790897701337713, 102.87572050846154, -103.60518017643587, -2.753002690682439, -77.5059788586302, -136.78681328113666, -35.26167272819433, 0.7616669233566751, 99.3892737675306, -121.76317749732668, -221.41484542454427, -0.26256937414734516, -81.64046493632515, 47.835445195899766, 41.62225202827415, -159.27689309555132, 8.414915969460758, -94.96493654962522, -101.89030278114168, -225.75780180988139, 42.3879814213417, -221.12051631037914, -194.2370444672595, -47.443484467917465, -68.94976936260595, -71.53127552961595, -175.21866179031935, -2.377011043507998, 7.336224962261236, 57.5840314172886, 148.94400313475802, -286.27355747273646, -38.05288701360526, -15.675153673344045, -157.06325915064687, 20.451311784900852, -34.19514158105644, -163.71926844518902, 179.13622751357744, -193.68286217716528, -5.466795255903271, 18.11348646225638, 73.35067178507347, -116.27200227841195, 81.3532898949211, -15.069998875773695, -1.5790888906085807, -103.01419787536915, 39.20269946596015, -70.07117731476804, -109.82064133551206, -6.986631127929058, -36.128808808176835, 15.187313791671755, -14.673585565722401, -251.67950712492743, 6.628822658497688, -90.79739622560763, -223.17849208443, -63.253333383580255, -19.653256456869457, -32.815082218808726, 25.002451968907792, -219.83803663194715], "policy_predator_policy_reward": [5.826870261683667, 69.24665936669969, 324.2059226722713, 187.82411487972215, 153.05478211067583, 113.01714267189817, 17.61674468795218, 70.83651010327776, 56.871368154986286, 191.90703446277513, 141.68851820524378, 0.0, 91.80740741555158, 0.0, 54.17335758922649, 131.5922426112305, 1.0515024123846184, 119.05980597895365, 36.62393073860571, 126.16249015041168, 294.04458931930264, 58.43138602720072, 27.098306487098423, 43.366658498089144, 101.5982771707111, 77.69808380843789, 92.33601550180148, 69.17740583328944, 11.711242094735995, 97.91032777106007, 159.598841430636, 144.42881435000547, 256.62014258831397, 83.17326937041157, 64.7437860571049, 182.14132692717635, 121.33488994630724, 3.428971835429686, 17.92887165747148, 61.97318819646065, 71.37501564844887, 195.79699114833366, 50.574776505310986, 49.41217620680031, 95.99190856070484, 133.02817899556257, 118.64992189155714, 44.429110259031575, 173.65858800042827, 294.7987946549283, 219.5255437438939, 58.84984999166302, 153.020176017792, 148.6350451107507, 84.92152900727922, 86.59987230581754, 35.917401426461, 256.72903135113984, 310.86582010807547, 62.23254304989086, 95.58973110505788, 76.50819038770996, 122.80345328028605, 155.79070810226966, 62.740528734875355, 50.312344307454744, 388.3350217575325, 13.51400281733393, 276.4934910271924, 282.6228917498557, 228.37632836739596, 14.384633174866076, 36.51525084053167, 377.03702896531087, 55.843560999739694, 94.38008995249868, 186.75715567238382, 3.338471062991101, 341.8826036480012, 4.298675114714987, 61.56155472910194, 75.84484689398705, 39.31993402285901, 36.68605729351662, 9.025998199295913, 32.16223211325439, 17.067987561023646, 78.50917759223691, 86.89305015310855, 85.34873130728765, 32.98846306649877, 46.31927657317061, 3.2969657078063443, 120.15435256341586, 51.96603493554656, 113.08180586595923, 51.82953263144456, 147.2709014897984, 28.814437033388117, 169.02459312393165, 122.3689401027523, 69.27638990552909, 2.934690635903009, 71.85406764413669, 69.17481916505344, 16.220654559082863, 82.67464346074956, 54.88464781895127, 149.0452344703959, 85.05170701639402, 61.64654055235777, 6.308513636455049, 122.72811266075166, 9.76569171381375, 28.196503312525255, 11.990037592432142, 39.59465245581429, 93.77925190682629, 173.417858483239, 6.14133330985798, 15.762281811455798, 134.36623570047647, 76.06028203580479, 74.22850676175635, 34.695476680536935, 159.6621907988072, 167.2233660646181, 158.99304802466287, 125.23519084767717, 31.268484989044566, 88.54768969882797, 57.09944401112018, 170.03924007813922, 8.135051974358213, 21.451638560862875, 76.27928161334323, 145.09089770133772, 0.7242794915378635, 119.58478321201947, 55.07339965509877, 101.30347201003724, 267.44746563530987, 25.72851731642294, 50.2482358311191, 10.105741511511418, 193.0090328936931, 242.16798791533478, 39.648464187783205, 159.3499139561802, 28.118359652455005, 62.6282279289202, 164.83895649669932, 73.18508403053936, 110.16493654962441, 168.40666761692708, 267.8603886072499, 213.90796331236706, 124.17924132120368, 231.43704446725934, 63.34348446791769, 164.82322943616253, 100.95781545605833, 192.6461275375021, 19.887349329554755, 38.363775037738804, 35.81596858271153, 113.3458349053624, 230.7853915479533, 54.85288701360539, 39.375153673344265, 203.76325915064663, 1.2486882150991712, 111.99514158105654, 174.21926844518845, 10.863772486422565, 246.3828621771652, 23.366795255903288, 1.686513537743613, 3.0493282149260565, 143.97200227841205, 11.169618052507685, 151.88844071902219, 78.45110531031017, 178.76726219687225, 5.491533832319006, 183.23617029079, 53.44679168121165, 100.62718867369004, 51.62880880817706, 4.512686208328209, 171.62334218999183, 202.77443414774723, 128.4407517753692, 43.32782179174049, 246.32318803637418, 132.52041148399576, 85.60806980806116, 98.80891037849513, 185.52092658311363, 103.72089663179854]}, "sampler_perf": {"mean_raw_obs_processing_ms": 24.612889016885457, "mean_inference_ms": 21.186329230406663, "mean_action_processing_ms": 5.908154806035579, "mean_env_wait_ms": 37.33530745612723, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.09543001651763916, "StateBufferConnector_ms": 0.03673684597015381, "ViewRequirementAgentConnector_ms": 1.255206823348999}, "num_episodes": 0, "episode_return_max": 286.6692231913454, "episode_return_min": -53.94695511723343, "episode_return_mean": 102.60472273081903, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 149312, "num_agent_steps_trained": 149312, "num_env_steps_sampled": 37328, "num_env_steps_trained": 37328, "num_env_steps_sampled_this_iter": 0, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 0.0, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 37328, "num_env_steps_sampled_lifetime": 37328, "num_agent_steps_sampled_lifetime": 149312, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 149312, "timers": {"training_iteration_time_ms": 61402.379, "restore_workers_time_ms": 27.911, "training_step_time_ms": 61327.18, "sample_time_ms": 61310.667, "learn_time_ms": 311236.026, "learn_throughput": 59.967, "synch_weights_time_ms": 43.334}, "counters": {"num_env_steps_sampled": 37328, "num_env_steps_trained": 37328, "num_agent_steps_sampled": 149312, "num_agent_steps_trained": 149312}, "done": false, "training_iteration": 12, "trial_id": "d7bca_00000", "date": "2024-08-20_11-24-48", "timestamp": 1724133288, "time_this_iter_s": 123.77954983711243, "time_total_s": 2030.3212003707886, "pid": 36059, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 16000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x32cf03f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2030.3212003707886, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 96.17687861271675, "ram_util_percent": 83.9121387283237}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {}, "num_env_steps_sampled": 37328, "num_env_steps_trained": 37328, "num_agent_steps_sampled": 149312, "num_agent_steps_trained": 149312}, "env_runners": {"episode_reward_max": 286.6692231913454, "episode_reward_min": -53.94695511723343, "episode_reward_mean": 102.60472273081903, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -382.5350217575324, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 179.13622751357744, "predator_policy": 388.3350217575325}, "policy_reward_mean": {"prey_policy": -50.61742331228365, "predator_policy": 101.91978467769317}, "custom_metrics": {}, "hist_stats": {"episode_reward": [35.10000000000023, -2.2956613079459616, 52.30000000000035, 93.99999999999946, 41.27668545957155, 138.35998813581944, 47.000000000000355, 189.59999999999982, 46.100000000000314, 122.59999999999911, 172.99184762314727, 183.89999999999952, 165.26660970450598, 63.400000000000325, 224.23591029611316, 118.26513246444676, 57.049342065984625, 56.287512516221504, 91.49999999999856, 77.70000000000017, 286.6692231913454, 34.20000000000022, 135.4999999999999, 189.7622134181783, 204.95900501687956, 41.46117592104707, 160.52089757879483, 41.90000000000027, 159.99999999999952, 56.25035590474681, 189.40904152072758, 32.4000000000002, 135.49999999999923, 137.09999999999957, -53.94695511723343, 170.90494465410117, 56.10000000000025, 60.20000000000013, 34.75612756781972, 43.60000000000028, 40.265044310772325, 47.1298862953699, 48.40000000000023, 36.202116310375594, 74.49999999999962, 153.19999999999987, 40.1000000000002, 131.19999999999982, 52.570622032848895, 56.000000000000156, 129.1999999999993, 86.20000000000002, 28.831075919194078, 160.79999999999959, 81.33852172443821, 103.01543537877356, 169.88064982359512, 48.30000000000023, 52.529310579969625, 48.028025438635616, 198.59999999999948, 184.470358209413, 37.06861395355878, 80.95181844992561, 33.900000000000134, 135.39999999999944, 148.89999999999955, 133.69999999999916, 226.89999999999938, 68.3000000000002, 154.45814550558052, 41.47674734270453, 180.74087067540847, 60.139037304427255, 153.66325386820998, 109.81254335834268, 96.80000000000011, 108.61895163315396, 159.3546697445331, 53.10000000000013, 125.29999999999959, 34.93780403323022, 139.0999999999999, 206.80167211533725, 40.50000000000029, 68.40000000000009, 88.29999999999927, 242.69999999999993, 37.700000000000266, 104.09999999999903, 229.34134979067687, 152.6250807412044, 157.8592262743011, 37.26670789146122, 35.20000000000023, 108.04468364708873, 87.5999999999994, 92.41177405235972, 131.94864151087714, 94.40623855187317], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [13.573129738316304, -53.54665936669982, -254.04609845621002, -260.27960040372835, -140.65478211067654, -73.1171426718985, 39.583255312047925, -34.03651010327775, -114.83317908671795, -92.66853807147267, -96.4272326280199, 93.09870255859556, -64.80740741555226, 20.000000000000014, 20.626642410773584, -16.792242611230414, 18.848497587615384, -92.85980597895414, 69.17606926139403, -109.36249015041209, -285.2321358475945, 105.74800812423979, 132.7888944272447, -19.35385941243218, -25.356623210719427, 11.326871936077456, -78.03601550180139, -20.07740583328924, 28.904313331271958, 85.71002709904536, -84.17058524148602, -101.59193807470932, -247.8691803256373, -34.87488956710395, -49.40531904969436, -141.19228141836533, -107.134889946308, 73.87102816456981, 4.171128342528487, -6.373188196460497, 72.0443042732162, -52.54708787865346, -32.67477650531073, -33.11217620680012, 17.408091439294907, -110.92817899556306, 80.28766474857159, -53.604483480981195, 64.90005398718623, -328.3984316256627, -221.37365036394135, -15.540567450569034, -217.97172194166885, 76.83739839192134, -62.4215290072797, -67.19987230581766, 82.82590198976501, -215.4723347673664, -63.01766150909464, -253.83034574412602, -72.05610867549865, 89.36722870345912, -103.9034532802869, -142.29070810227037, 0.5594712651248201, 21.887655692545323, -382.5350217575324, 117.78599718266575, -341.68754507993606, -271.3757928143444, 42.05974767402415, -113.91576456218526, 10.584749159468316, -368.0370289653096, -96.60173288891873, 6.578081936680414, -116.41208622158636, -38.927412945968925, -335.88260364800084, 33.30132488528524, -27.102952922490367, -70.03840438982733, -11.808869660467748, -17.067235360537826, 10.174001800704053, -2.962232113254194, -5.251613856427011, -54.123434986458186, -77.75098136410048, -19.99080009629646, 33.88040540161318, 40.0118549587175, 18.203034292193653, -101.55435256341609, 84.66934503983893, -118.51718584134521, -111.25275039532056, -35.27706169307365, 12.962713255211035, -154.80174341253127, -108.368940102753, 45.92361009447094, 66.26530936409696, -54.85406764413665, -50.32982812857711, -6.234569676365133, 43.52535653925046, -20.284647818951065, -122.72911794687963, -30.02930181547257, 64.88866316909824, -29.828281979136015, 27.845266783971347, 9.541578665059246, 1.103496687474779, 7.009962407567832, -8.299879170194934, -72.54471461247661, -97.58563081684744, -33.94553553761412, 161.42330774007206, -112.95182525200485, -6.1055308568346724, 40.28710026868663, -159.2584299113319, 1.9693763855458568, -203.51123731867187, -41.75335832068283, -112.73519084767737, -9.86848498904447, -75.14768969882805, 64.9005559888798, -41.26096743109789, 11.98667537860044, 89.1022150662958, -53.133135240501986, -21.790897701337713, 102.87572050846154, -103.60518017643587, -2.753002690682439, -77.5059788586302, -136.78681328113666, -35.26167272819433, 0.7616669233566751, 99.3892737675306, -121.76317749732668, -221.41484542454427, -0.26256937414734516, -81.64046493632515, 47.835445195899766, 41.62225202827415, -159.27689309555132, 8.414915969460758, -94.96493654962522, -101.89030278114168, -225.75780180988139, 42.3879814213417, -221.12051631037914, -194.2370444672595, -47.443484467917465, -68.94976936260595, -71.53127552961595, -175.21866179031935, -2.377011043507998, 7.336224962261236, 57.5840314172886, 148.94400313475802, -286.27355747273646, -38.05288701360526, -15.675153673344045, -157.06325915064687, 20.451311784900852, -34.19514158105644, -163.71926844518902, 179.13622751357744, -193.68286217716528, -5.466795255903271, 18.11348646225638, 73.35067178507347, -116.27200227841195, 81.3532898949211, -15.069998875773695, -1.5790888906085807, -103.01419787536915, 39.20269946596015, -70.07117731476804, -109.82064133551206, -6.986631127929058, -36.128808808176835, 15.187313791671755, -14.673585565722401, -251.67950712492743, 6.628822658497688, -90.79739622560763, -223.17849208443, -63.253333383580255, -19.653256456869457, -32.815082218808726, 25.002451968907792, -219.83803663194715], "policy_predator_policy_reward": [5.826870261683667, 69.24665936669969, 324.2059226722713, 187.82411487972215, 153.05478211067583, 113.01714267189817, 17.61674468795218, 70.83651010327776, 56.871368154986286, 191.90703446277513, 141.68851820524378, 0.0, 91.80740741555158, 0.0, 54.17335758922649, 131.5922426112305, 1.0515024123846184, 119.05980597895365, 36.62393073860571, 126.16249015041168, 294.04458931930264, 58.43138602720072, 27.098306487098423, 43.366658498089144, 101.5982771707111, 77.69808380843789, 92.33601550180148, 69.17740583328944, 11.711242094735995, 97.91032777106007, 159.598841430636, 144.42881435000547, 256.62014258831397, 83.17326937041157, 64.7437860571049, 182.14132692717635, 121.33488994630724, 3.428971835429686, 17.92887165747148, 61.97318819646065, 71.37501564844887, 195.79699114833366, 50.574776505310986, 49.41217620680031, 95.99190856070484, 133.02817899556257, 118.64992189155714, 44.429110259031575, 173.65858800042827, 294.7987946549283, 219.5255437438939, 58.84984999166302, 153.020176017792, 148.6350451107507, 84.92152900727922, 86.59987230581754, 35.917401426461, 256.72903135113984, 310.86582010807547, 62.23254304989086, 95.58973110505788, 76.50819038770996, 122.80345328028605, 155.79070810226966, 62.740528734875355, 50.312344307454744, 388.3350217575325, 13.51400281733393, 276.4934910271924, 282.6228917498557, 228.37632836739596, 14.384633174866076, 36.51525084053167, 377.03702896531087, 55.843560999739694, 94.38008995249868, 186.75715567238382, 3.338471062991101, 341.8826036480012, 4.298675114714987, 61.56155472910194, 75.84484689398705, 39.31993402285901, 36.68605729351662, 9.025998199295913, 32.16223211325439, 17.067987561023646, 78.50917759223691, 86.89305015310855, 85.34873130728765, 32.98846306649877, 46.31927657317061, 3.2969657078063443, 120.15435256341586, 51.96603493554656, 113.08180586595923, 51.82953263144456, 147.2709014897984, 28.814437033388117, 169.02459312393165, 122.3689401027523, 69.27638990552909, 2.934690635903009, 71.85406764413669, 69.17481916505344, 16.220654559082863, 82.67464346074956, 54.88464781895127, 149.0452344703959, 85.05170701639402, 61.64654055235777, 6.308513636455049, 122.72811266075166, 9.76569171381375, 28.196503312525255, 11.990037592432142, 39.59465245581429, 93.77925190682629, 173.417858483239, 6.14133330985798, 15.762281811455798, 134.36623570047647, 76.06028203580479, 74.22850676175635, 34.695476680536935, 159.6621907988072, 167.2233660646181, 158.99304802466287, 125.23519084767717, 31.268484989044566, 88.54768969882797, 57.09944401112018, 170.03924007813922, 8.135051974358213, 21.451638560862875, 76.27928161334323, 145.09089770133772, 0.7242794915378635, 119.58478321201947, 55.07339965509877, 101.30347201003724, 267.44746563530987, 25.72851731642294, 50.2482358311191, 10.105741511511418, 193.0090328936931, 242.16798791533478, 39.648464187783205, 159.3499139561802, 28.118359652455005, 62.6282279289202, 164.83895649669932, 73.18508403053936, 110.16493654962441, 168.40666761692708, 267.8603886072499, 213.90796331236706, 124.17924132120368, 231.43704446725934, 63.34348446791769, 164.82322943616253, 100.95781545605833, 192.6461275375021, 19.887349329554755, 38.363775037738804, 35.81596858271153, 113.3458349053624, 230.7853915479533, 54.85288701360539, 39.375153673344265, 203.76325915064663, 1.2486882150991712, 111.99514158105654, 174.21926844518845, 10.863772486422565, 246.3828621771652, 23.366795255903288, 1.686513537743613, 3.0493282149260565, 143.97200227841205, 11.169618052507685, 151.88844071902219, 78.45110531031017, 178.76726219687225, 5.491533832319006, 183.23617029079, 53.44679168121165, 100.62718867369004, 51.62880880817706, 4.512686208328209, 171.62334218999183, 202.77443414774723, 128.4407517753692, 43.32782179174049, 246.32318803637418, 132.52041148399576, 85.60806980806116, 98.80891037849513, 185.52092658311363, 103.72089663179854]}, "sampler_perf": {"mean_raw_obs_processing_ms": 24.612889016885457, "mean_inference_ms": 21.186329230406663, "mean_action_processing_ms": 5.908154806035579, "mean_env_wait_ms": 37.33530745612723, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.09543001651763916, "StateBufferConnector_ms": 0.03673684597015381, "ViewRequirementAgentConnector_ms": 1.255206823348999}, "num_episodes": 0, "episode_return_max": 286.6692231913454, "episode_return_min": -53.94695511723343, "episode_return_mean": 102.60472273081903, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 149312, "num_agent_steps_trained": 149312, "num_env_steps_sampled": 37328, "num_env_steps_trained": 37328, "num_env_steps_sampled_this_iter": 0, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 0.0, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 37328, "num_env_steps_sampled_lifetime": 37328, "num_agent_steps_sampled_lifetime": 149312, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 149312, "timers": {"training_iteration_time_ms": 61444.749, "restore_workers_time_ms": 31.417, "training_step_time_ms": 61356.348, "sample_time_ms": 61340.408, "learn_time_ms": 311236.026, "learn_throughput": 59.967, "synch_weights_time_ms": 43.334}, "counters": {"num_env_steps_sampled": 37328, "num_env_steps_trained": 37328, "num_agent_steps_sampled": 149312, "num_agent_steps_trained": 149312}, "done": false, "training_iteration": 13, "trial_id": "d7bca_00000", "date": "2024-08-20_11-26-56", "timestamp": 1724133416, "time_this_iter_s": 123.76169800758362, "time_total_s": 2154.082898378372, "pid": 36059, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 16000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3ae8cfd30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2154.082898378372, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 97.36046511627907, "ram_util_percent": 83.79709302325581}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {}, "num_env_steps_sampled": 37328, "num_env_steps_trained": 37328, "num_agent_steps_sampled": 149312, "num_agent_steps_trained": 149312}, "env_runners": {"episode_reward_max": 286.6692231913454, "episode_reward_min": -53.94695511723343, "episode_reward_mean": 102.60472273081903, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -382.5350217575324, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 179.13622751357744, "predator_policy": 388.3350217575325}, "policy_reward_mean": {"prey_policy": -50.61742331228365, "predator_policy": 101.91978467769317}, "custom_metrics": {}, "hist_stats": {"episode_reward": [35.10000000000023, -2.2956613079459616, 52.30000000000035, 93.99999999999946, 41.27668545957155, 138.35998813581944, 47.000000000000355, 189.59999999999982, 46.100000000000314, 122.59999999999911, 172.99184762314727, 183.89999999999952, 165.26660970450598, 63.400000000000325, 224.23591029611316, 118.26513246444676, 57.049342065984625, 56.287512516221504, 91.49999999999856, 77.70000000000017, 286.6692231913454, 34.20000000000022, 135.4999999999999, 189.7622134181783, 204.95900501687956, 41.46117592104707, 160.52089757879483, 41.90000000000027, 159.99999999999952, 56.25035590474681, 189.40904152072758, 32.4000000000002, 135.49999999999923, 137.09999999999957, -53.94695511723343, 170.90494465410117, 56.10000000000025, 60.20000000000013, 34.75612756781972, 43.60000000000028, 40.265044310772325, 47.1298862953699, 48.40000000000023, 36.202116310375594, 74.49999999999962, 153.19999999999987, 40.1000000000002, 131.19999999999982, 52.570622032848895, 56.000000000000156, 129.1999999999993, 86.20000000000002, 28.831075919194078, 160.79999999999959, 81.33852172443821, 103.01543537877356, 169.88064982359512, 48.30000000000023, 52.529310579969625, 48.028025438635616, 198.59999999999948, 184.470358209413, 37.06861395355878, 80.95181844992561, 33.900000000000134, 135.39999999999944, 148.89999999999955, 133.69999999999916, 226.89999999999938, 68.3000000000002, 154.45814550558052, 41.47674734270453, 180.74087067540847, 60.139037304427255, 153.66325386820998, 109.81254335834268, 96.80000000000011, 108.61895163315396, 159.3546697445331, 53.10000000000013, 125.29999999999959, 34.93780403323022, 139.0999999999999, 206.80167211533725, 40.50000000000029, 68.40000000000009, 88.29999999999927, 242.69999999999993, 37.700000000000266, 104.09999999999903, 229.34134979067687, 152.6250807412044, 157.8592262743011, 37.26670789146122, 35.20000000000023, 108.04468364708873, 87.5999999999994, 92.41177405235972, 131.94864151087714, 94.40623855187317], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [13.573129738316304, -53.54665936669982, -254.04609845621002, -260.27960040372835, -140.65478211067654, -73.1171426718985, 39.583255312047925, -34.03651010327775, -114.83317908671795, -92.66853807147267, -96.4272326280199, 93.09870255859556, -64.80740741555226, 20.000000000000014, 20.626642410773584, -16.792242611230414, 18.848497587615384, -92.85980597895414, 69.17606926139403, -109.36249015041209, -285.2321358475945, 105.74800812423979, 132.7888944272447, -19.35385941243218, -25.356623210719427, 11.326871936077456, -78.03601550180139, -20.07740583328924, 28.904313331271958, 85.71002709904536, -84.17058524148602, -101.59193807470932, -247.8691803256373, -34.87488956710395, -49.40531904969436, -141.19228141836533, -107.134889946308, 73.87102816456981, 4.171128342528487, -6.373188196460497, 72.0443042732162, -52.54708787865346, -32.67477650531073, -33.11217620680012, 17.408091439294907, -110.92817899556306, 80.28766474857159, -53.604483480981195, 64.90005398718623, -328.3984316256627, -221.37365036394135, -15.540567450569034, -217.97172194166885, 76.83739839192134, -62.4215290072797, -67.19987230581766, 82.82590198976501, -215.4723347673664, -63.01766150909464, -253.83034574412602, -72.05610867549865, 89.36722870345912, -103.9034532802869, -142.29070810227037, 0.5594712651248201, 21.887655692545323, -382.5350217575324, 117.78599718266575, -341.68754507993606, -271.3757928143444, 42.05974767402415, -113.91576456218526, 10.584749159468316, -368.0370289653096, -96.60173288891873, 6.578081936680414, -116.41208622158636, -38.927412945968925, -335.88260364800084, 33.30132488528524, -27.102952922490367, -70.03840438982733, -11.808869660467748, -17.067235360537826, 10.174001800704053, -2.962232113254194, -5.251613856427011, -54.123434986458186, -77.75098136410048, -19.99080009629646, 33.88040540161318, 40.0118549587175, 18.203034292193653, -101.55435256341609, 84.66934503983893, -118.51718584134521, -111.25275039532056, -35.27706169307365, 12.962713255211035, -154.80174341253127, -108.368940102753, 45.92361009447094, 66.26530936409696, -54.85406764413665, -50.32982812857711, -6.234569676365133, 43.52535653925046, -20.284647818951065, -122.72911794687963, -30.02930181547257, 64.88866316909824, -29.828281979136015, 27.845266783971347, 9.541578665059246, 1.103496687474779, 7.009962407567832, -8.299879170194934, -72.54471461247661, -97.58563081684744, -33.94553553761412, 161.42330774007206, -112.95182525200485, -6.1055308568346724, 40.28710026868663, -159.2584299113319, 1.9693763855458568, -203.51123731867187, -41.75335832068283, -112.73519084767737, -9.86848498904447, -75.14768969882805, 64.9005559888798, -41.26096743109789, 11.98667537860044, 89.1022150662958, -53.133135240501986, -21.790897701337713, 102.87572050846154, -103.60518017643587, -2.753002690682439, -77.5059788586302, -136.78681328113666, -35.26167272819433, 0.7616669233566751, 99.3892737675306, -121.76317749732668, -221.41484542454427, -0.26256937414734516, -81.64046493632515, 47.835445195899766, 41.62225202827415, -159.27689309555132, 8.414915969460758, -94.96493654962522, -101.89030278114168, -225.75780180988139, 42.3879814213417, -221.12051631037914, -194.2370444672595, -47.443484467917465, -68.94976936260595, -71.53127552961595, -175.21866179031935, -2.377011043507998, 7.336224962261236, 57.5840314172886, 148.94400313475802, -286.27355747273646, -38.05288701360526, -15.675153673344045, -157.06325915064687, 20.451311784900852, -34.19514158105644, -163.71926844518902, 179.13622751357744, -193.68286217716528, -5.466795255903271, 18.11348646225638, 73.35067178507347, -116.27200227841195, 81.3532898949211, -15.069998875773695, -1.5790888906085807, -103.01419787536915, 39.20269946596015, -70.07117731476804, -109.82064133551206, -6.986631127929058, -36.128808808176835, 15.187313791671755, -14.673585565722401, -251.67950712492743, 6.628822658497688, -90.79739622560763, -223.17849208443, -63.253333383580255, -19.653256456869457, -32.815082218808726, 25.002451968907792, -219.83803663194715], "policy_predator_policy_reward": [5.826870261683667, 69.24665936669969, 324.2059226722713, 187.82411487972215, 153.05478211067583, 113.01714267189817, 17.61674468795218, 70.83651010327776, 56.871368154986286, 191.90703446277513, 141.68851820524378, 0.0, 91.80740741555158, 0.0, 54.17335758922649, 131.5922426112305, 1.0515024123846184, 119.05980597895365, 36.62393073860571, 126.16249015041168, 294.04458931930264, 58.43138602720072, 27.098306487098423, 43.366658498089144, 101.5982771707111, 77.69808380843789, 92.33601550180148, 69.17740583328944, 11.711242094735995, 97.91032777106007, 159.598841430636, 144.42881435000547, 256.62014258831397, 83.17326937041157, 64.7437860571049, 182.14132692717635, 121.33488994630724, 3.428971835429686, 17.92887165747148, 61.97318819646065, 71.37501564844887, 195.79699114833366, 50.574776505310986, 49.41217620680031, 95.99190856070484, 133.02817899556257, 118.64992189155714, 44.429110259031575, 173.65858800042827, 294.7987946549283, 219.5255437438939, 58.84984999166302, 153.020176017792, 148.6350451107507, 84.92152900727922, 86.59987230581754, 35.917401426461, 256.72903135113984, 310.86582010807547, 62.23254304989086, 95.58973110505788, 76.50819038770996, 122.80345328028605, 155.79070810226966, 62.740528734875355, 50.312344307454744, 388.3350217575325, 13.51400281733393, 276.4934910271924, 282.6228917498557, 228.37632836739596, 14.384633174866076, 36.51525084053167, 377.03702896531087, 55.843560999739694, 94.38008995249868, 186.75715567238382, 3.338471062991101, 341.8826036480012, 4.298675114714987, 61.56155472910194, 75.84484689398705, 39.31993402285901, 36.68605729351662, 9.025998199295913, 32.16223211325439, 17.067987561023646, 78.50917759223691, 86.89305015310855, 85.34873130728765, 32.98846306649877, 46.31927657317061, 3.2969657078063443, 120.15435256341586, 51.96603493554656, 113.08180586595923, 51.82953263144456, 147.2709014897984, 28.814437033388117, 169.02459312393165, 122.3689401027523, 69.27638990552909, 2.934690635903009, 71.85406764413669, 69.17481916505344, 16.220654559082863, 82.67464346074956, 54.88464781895127, 149.0452344703959, 85.05170701639402, 61.64654055235777, 6.308513636455049, 122.72811266075166, 9.76569171381375, 28.196503312525255, 11.990037592432142, 39.59465245581429, 93.77925190682629, 173.417858483239, 6.14133330985798, 15.762281811455798, 134.36623570047647, 76.06028203580479, 74.22850676175635, 34.695476680536935, 159.6621907988072, 167.2233660646181, 158.99304802466287, 125.23519084767717, 31.268484989044566, 88.54768969882797, 57.09944401112018, 170.03924007813922, 8.135051974358213, 21.451638560862875, 76.27928161334323, 145.09089770133772, 0.7242794915378635, 119.58478321201947, 55.07339965509877, 101.30347201003724, 267.44746563530987, 25.72851731642294, 50.2482358311191, 10.105741511511418, 193.0090328936931, 242.16798791533478, 39.648464187783205, 159.3499139561802, 28.118359652455005, 62.6282279289202, 164.83895649669932, 73.18508403053936, 110.16493654962441, 168.40666761692708, 267.8603886072499, 213.90796331236706, 124.17924132120368, 231.43704446725934, 63.34348446791769, 164.82322943616253, 100.95781545605833, 192.6461275375021, 19.887349329554755, 38.363775037738804, 35.81596858271153, 113.3458349053624, 230.7853915479533, 54.85288701360539, 39.375153673344265, 203.76325915064663, 1.2486882150991712, 111.99514158105654, 174.21926844518845, 10.863772486422565, 246.3828621771652, 23.366795255903288, 1.686513537743613, 3.0493282149260565, 143.97200227841205, 11.169618052507685, 151.88844071902219, 78.45110531031017, 178.76726219687225, 5.491533832319006, 183.23617029079, 53.44679168121165, 100.62718867369004, 51.62880880817706, 4.512686208328209, 171.62334218999183, 202.77443414774723, 128.4407517753692, 43.32782179174049, 246.32318803637418, 132.52041148399576, 85.60806980806116, 98.80891037849513, 185.52092658311363, 103.72089663179854]}, "sampler_perf": {"mean_raw_obs_processing_ms": 24.612889016885457, "mean_inference_ms": 21.186329230406663, "mean_action_processing_ms": 5.908154806035579, "mean_env_wait_ms": 37.33530745612723, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.09543001651763916, "StateBufferConnector_ms": 0.03673684597015381, "ViewRequirementAgentConnector_ms": 1.255206823348999}, "num_episodes": 0, "episode_return_max": 286.6692231913454, "episode_return_min": -53.94695511723343, "episode_return_mean": 102.60472273081903, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 149312, "num_agent_steps_trained": 149312, "num_env_steps_sampled": 37328, "num_env_steps_trained": 37328, "num_env_steps_sampled_this_iter": 0, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 0.0, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 37328, "num_env_steps_sampled_lifetime": 37328, "num_agent_steps_sampled_lifetime": 149312, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 149312, "timers": {"training_iteration_time_ms": 61506.605, "restore_workers_time_ms": 29.266, "training_step_time_ms": 61418.841, "sample_time_ms": 61400.502, "learn_time_ms": 311236.026, "learn_throughput": 59.967, "synch_weights_time_ms": 43.334}, "counters": {"num_env_steps_sampled": 37328, "num_env_steps_trained": 37328, "num_agent_steps_sampled": 149312, "num_agent_steps_trained": 149312}, "done": false, "training_iteration": 14, "trial_id": "d7bca_00000", "date": "2024-08-20_11-29-03", "timestamp": 1724133543, "time_this_iter_s": 122.91321396827698, "time_total_s": 2276.996112346649, "pid": 36059, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 16000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x32cf03ca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2276.996112346649, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 94.9693641618497, "ram_util_percent": 83.7791907514451}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {}, "num_env_steps_sampled": 37328, "num_env_steps_trained": 37328, "num_agent_steps_sampled": 149312, "num_agent_steps_trained": 149312}, "env_runners": {"episode_reward_max": 286.6692231913454, "episode_reward_min": -53.94695511723343, "episode_reward_mean": 102.60472273081903, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -382.5350217575324, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 179.13622751357744, "predator_policy": 388.3350217575325}, "policy_reward_mean": {"prey_policy": -50.61742331228365, "predator_policy": 101.91978467769317}, "custom_metrics": {}, "hist_stats": {"episode_reward": [35.10000000000023, -2.2956613079459616, 52.30000000000035, 93.99999999999946, 41.27668545957155, 138.35998813581944, 47.000000000000355, 189.59999999999982, 46.100000000000314, 122.59999999999911, 172.99184762314727, 183.89999999999952, 165.26660970450598, 63.400000000000325, 224.23591029611316, 118.26513246444676, 57.049342065984625, 56.287512516221504, 91.49999999999856, 77.70000000000017, 286.6692231913454, 34.20000000000022, 135.4999999999999, 189.7622134181783, 204.95900501687956, 41.46117592104707, 160.52089757879483, 41.90000000000027, 159.99999999999952, 56.25035590474681, 189.40904152072758, 32.4000000000002, 135.49999999999923, 137.09999999999957, -53.94695511723343, 170.90494465410117, 56.10000000000025, 60.20000000000013, 34.75612756781972, 43.60000000000028, 40.265044310772325, 47.1298862953699, 48.40000000000023, 36.202116310375594, 74.49999999999962, 153.19999999999987, 40.1000000000002, 131.19999999999982, 52.570622032848895, 56.000000000000156, 129.1999999999993, 86.20000000000002, 28.831075919194078, 160.79999999999959, 81.33852172443821, 103.01543537877356, 169.88064982359512, 48.30000000000023, 52.529310579969625, 48.028025438635616, 198.59999999999948, 184.470358209413, 37.06861395355878, 80.95181844992561, 33.900000000000134, 135.39999999999944, 148.89999999999955, 133.69999999999916, 226.89999999999938, 68.3000000000002, 154.45814550558052, 41.47674734270453, 180.74087067540847, 60.139037304427255, 153.66325386820998, 109.81254335834268, 96.80000000000011, 108.61895163315396, 159.3546697445331, 53.10000000000013, 125.29999999999959, 34.93780403323022, 139.0999999999999, 206.80167211533725, 40.50000000000029, 68.40000000000009, 88.29999999999927, 242.69999999999993, 37.700000000000266, 104.09999999999903, 229.34134979067687, 152.6250807412044, 157.8592262743011, 37.26670789146122, 35.20000000000023, 108.04468364708873, 87.5999999999994, 92.41177405235972, 131.94864151087714, 94.40623855187317], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [13.573129738316304, -53.54665936669982, -254.04609845621002, -260.27960040372835, -140.65478211067654, -73.1171426718985, 39.583255312047925, -34.03651010327775, -114.83317908671795, -92.66853807147267, -96.4272326280199, 93.09870255859556, -64.80740741555226, 20.000000000000014, 20.626642410773584, -16.792242611230414, 18.848497587615384, -92.85980597895414, 69.17606926139403, -109.36249015041209, -285.2321358475945, 105.74800812423979, 132.7888944272447, -19.35385941243218, -25.356623210719427, 11.326871936077456, -78.03601550180139, -20.07740583328924, 28.904313331271958, 85.71002709904536, -84.17058524148602, -101.59193807470932, -247.8691803256373, -34.87488956710395, -49.40531904969436, -141.19228141836533, -107.134889946308, 73.87102816456981, 4.171128342528487, -6.373188196460497, 72.0443042732162, -52.54708787865346, -32.67477650531073, -33.11217620680012, 17.408091439294907, -110.92817899556306, 80.28766474857159, -53.604483480981195, 64.90005398718623, -328.3984316256627, -221.37365036394135, -15.540567450569034, -217.97172194166885, 76.83739839192134, -62.4215290072797, -67.19987230581766, 82.82590198976501, -215.4723347673664, -63.01766150909464, -253.83034574412602, -72.05610867549865, 89.36722870345912, -103.9034532802869, -142.29070810227037, 0.5594712651248201, 21.887655692545323, -382.5350217575324, 117.78599718266575, -341.68754507993606, -271.3757928143444, 42.05974767402415, -113.91576456218526, 10.584749159468316, -368.0370289653096, -96.60173288891873, 6.578081936680414, -116.41208622158636, -38.927412945968925, -335.88260364800084, 33.30132488528524, -27.102952922490367, -70.03840438982733, -11.808869660467748, -17.067235360537826, 10.174001800704053, -2.962232113254194, -5.251613856427011, -54.123434986458186, -77.75098136410048, -19.99080009629646, 33.88040540161318, 40.0118549587175, 18.203034292193653, -101.55435256341609, 84.66934503983893, -118.51718584134521, -111.25275039532056, -35.27706169307365, 12.962713255211035, -154.80174341253127, -108.368940102753, 45.92361009447094, 66.26530936409696, -54.85406764413665, -50.32982812857711, -6.234569676365133, 43.52535653925046, -20.284647818951065, -122.72911794687963, -30.02930181547257, 64.88866316909824, -29.828281979136015, 27.845266783971347, 9.541578665059246, 1.103496687474779, 7.009962407567832, -8.299879170194934, -72.54471461247661, -97.58563081684744, -33.94553553761412, 161.42330774007206, -112.95182525200485, -6.1055308568346724, 40.28710026868663, -159.2584299113319, 1.9693763855458568, -203.51123731867187, -41.75335832068283, -112.73519084767737, -9.86848498904447, -75.14768969882805, 64.9005559888798, -41.26096743109789, 11.98667537860044, 89.1022150662958, -53.133135240501986, -21.790897701337713, 102.87572050846154, -103.60518017643587, -2.753002690682439, -77.5059788586302, -136.78681328113666, -35.26167272819433, 0.7616669233566751, 99.3892737675306, -121.76317749732668, -221.41484542454427, -0.26256937414734516, -81.64046493632515, 47.835445195899766, 41.62225202827415, -159.27689309555132, 8.414915969460758, -94.96493654962522, -101.89030278114168, -225.75780180988139, 42.3879814213417, -221.12051631037914, -194.2370444672595, -47.443484467917465, -68.94976936260595, -71.53127552961595, -175.21866179031935, -2.377011043507998, 7.336224962261236, 57.5840314172886, 148.94400313475802, -286.27355747273646, -38.05288701360526, -15.675153673344045, -157.06325915064687, 20.451311784900852, -34.19514158105644, -163.71926844518902, 179.13622751357744, -193.68286217716528, -5.466795255903271, 18.11348646225638, 73.35067178507347, -116.27200227841195, 81.3532898949211, -15.069998875773695, -1.5790888906085807, -103.01419787536915, 39.20269946596015, -70.07117731476804, -109.82064133551206, -6.986631127929058, -36.128808808176835, 15.187313791671755, -14.673585565722401, -251.67950712492743, 6.628822658497688, -90.79739622560763, -223.17849208443, -63.253333383580255, -19.653256456869457, -32.815082218808726, 25.002451968907792, -219.83803663194715], "policy_predator_policy_reward": [5.826870261683667, 69.24665936669969, 324.2059226722713, 187.82411487972215, 153.05478211067583, 113.01714267189817, 17.61674468795218, 70.83651010327776, 56.871368154986286, 191.90703446277513, 141.68851820524378, 0.0, 91.80740741555158, 0.0, 54.17335758922649, 131.5922426112305, 1.0515024123846184, 119.05980597895365, 36.62393073860571, 126.16249015041168, 294.04458931930264, 58.43138602720072, 27.098306487098423, 43.366658498089144, 101.5982771707111, 77.69808380843789, 92.33601550180148, 69.17740583328944, 11.711242094735995, 97.91032777106007, 159.598841430636, 144.42881435000547, 256.62014258831397, 83.17326937041157, 64.7437860571049, 182.14132692717635, 121.33488994630724, 3.428971835429686, 17.92887165747148, 61.97318819646065, 71.37501564844887, 195.79699114833366, 50.574776505310986, 49.41217620680031, 95.99190856070484, 133.02817899556257, 118.64992189155714, 44.429110259031575, 173.65858800042827, 294.7987946549283, 219.5255437438939, 58.84984999166302, 153.020176017792, 148.6350451107507, 84.92152900727922, 86.59987230581754, 35.917401426461, 256.72903135113984, 310.86582010807547, 62.23254304989086, 95.58973110505788, 76.50819038770996, 122.80345328028605, 155.79070810226966, 62.740528734875355, 50.312344307454744, 388.3350217575325, 13.51400281733393, 276.4934910271924, 282.6228917498557, 228.37632836739596, 14.384633174866076, 36.51525084053167, 377.03702896531087, 55.843560999739694, 94.38008995249868, 186.75715567238382, 3.338471062991101, 341.8826036480012, 4.298675114714987, 61.56155472910194, 75.84484689398705, 39.31993402285901, 36.68605729351662, 9.025998199295913, 32.16223211325439, 17.067987561023646, 78.50917759223691, 86.89305015310855, 85.34873130728765, 32.98846306649877, 46.31927657317061, 3.2969657078063443, 120.15435256341586, 51.96603493554656, 113.08180586595923, 51.82953263144456, 147.2709014897984, 28.814437033388117, 169.02459312393165, 122.3689401027523, 69.27638990552909, 2.934690635903009, 71.85406764413669, 69.17481916505344, 16.220654559082863, 82.67464346074956, 54.88464781895127, 149.0452344703959, 85.05170701639402, 61.64654055235777, 6.308513636455049, 122.72811266075166, 9.76569171381375, 28.196503312525255, 11.990037592432142, 39.59465245581429, 93.77925190682629, 173.417858483239, 6.14133330985798, 15.762281811455798, 134.36623570047647, 76.06028203580479, 74.22850676175635, 34.695476680536935, 159.6621907988072, 167.2233660646181, 158.99304802466287, 125.23519084767717, 31.268484989044566, 88.54768969882797, 57.09944401112018, 170.03924007813922, 8.135051974358213, 21.451638560862875, 76.27928161334323, 145.09089770133772, 0.7242794915378635, 119.58478321201947, 55.07339965509877, 101.30347201003724, 267.44746563530987, 25.72851731642294, 50.2482358311191, 10.105741511511418, 193.0090328936931, 242.16798791533478, 39.648464187783205, 159.3499139561802, 28.118359652455005, 62.6282279289202, 164.83895649669932, 73.18508403053936, 110.16493654962441, 168.40666761692708, 267.8603886072499, 213.90796331236706, 124.17924132120368, 231.43704446725934, 63.34348446791769, 164.82322943616253, 100.95781545605833, 192.6461275375021, 19.887349329554755, 38.363775037738804, 35.81596858271153, 113.3458349053624, 230.7853915479533, 54.85288701360539, 39.375153673344265, 203.76325915064663, 1.2486882150991712, 111.99514158105654, 174.21926844518845, 10.863772486422565, 246.3828621771652, 23.366795255903288, 1.686513537743613, 3.0493282149260565, 143.97200227841205, 11.169618052507685, 151.88844071902219, 78.45110531031017, 178.76726219687225, 5.491533832319006, 183.23617029079, 53.44679168121165, 100.62718867369004, 51.62880880817706, 4.512686208328209, 171.62334218999183, 202.77443414774723, 128.4407517753692, 43.32782179174049, 246.32318803637418, 132.52041148399576, 85.60806980806116, 98.80891037849513, 185.52092658311363, 103.72089663179854]}, "sampler_perf": {"mean_raw_obs_processing_ms": 24.612889016885457, "mean_inference_ms": 21.186329230406663, "mean_action_processing_ms": 5.908154806035579, "mean_env_wait_ms": 37.33530745612723, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.09543001651763916, "StateBufferConnector_ms": 0.03673684597015381, "ViewRequirementAgentConnector_ms": 1.255206823348999}, "num_episodes": 0, "episode_return_max": 286.6692231913454, "episode_return_min": -53.94695511723343, "episode_return_mean": 102.60472273081903, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 149312, "num_agent_steps_trained": 149312, "num_env_steps_sampled": 37328, "num_env_steps_trained": 37328, "num_env_steps_sampled_this_iter": 0, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 0.0, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 37328, "num_env_steps_sampled_lifetime": 37328, "num_agent_steps_sampled_lifetime": 149312, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 149312, "timers": {"training_iteration_time_ms": 61544.376, "restore_workers_time_ms": 31.09, "training_step_time_ms": 61450.009, "sample_time_ms": 61431.553, "learn_time_ms": 311236.026, "learn_throughput": 59.967, "synch_weights_time_ms": 43.334}, "counters": {"num_env_steps_sampled": 37328, "num_env_steps_trained": 37328, "num_agent_steps_sampled": 149312, "num_agent_steps_trained": 149312}, "done": false, "training_iteration": 15, "trial_id": "d7bca_00000", "date": "2024-08-20_11-31-08", "timestamp": 1724133668, "time_this_iter_s": 122.84533977508545, "time_total_s": 2399.8414521217346, "pid": 36059, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 16000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x32cf645e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2399.8414521217346, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 97.72440476190476, "ram_util_percent": 83.74880952380951}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {}, "num_env_steps_sampled": 37328, "num_env_steps_trained": 37328, "num_agent_steps_sampled": 149312, "num_agent_steps_trained": 149312}, "env_runners": {"episode_reward_max": 286.6692231913454, "episode_reward_min": -53.94695511723343, "episode_reward_mean": 102.60472273081903, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -382.5350217575324, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 179.13622751357744, "predator_policy": 388.3350217575325}, "policy_reward_mean": {"prey_policy": -50.61742331228365, "predator_policy": 101.91978467769317}, "custom_metrics": {}, "hist_stats": {"episode_reward": [35.10000000000023, -2.2956613079459616, 52.30000000000035, 93.99999999999946, 41.27668545957155, 138.35998813581944, 47.000000000000355, 189.59999999999982, 46.100000000000314, 122.59999999999911, 172.99184762314727, 183.89999999999952, 165.26660970450598, 63.400000000000325, 224.23591029611316, 118.26513246444676, 57.049342065984625, 56.287512516221504, 91.49999999999856, 77.70000000000017, 286.6692231913454, 34.20000000000022, 135.4999999999999, 189.7622134181783, 204.95900501687956, 41.46117592104707, 160.52089757879483, 41.90000000000027, 159.99999999999952, 56.25035590474681, 189.40904152072758, 32.4000000000002, 135.49999999999923, 137.09999999999957, -53.94695511723343, 170.90494465410117, 56.10000000000025, 60.20000000000013, 34.75612756781972, 43.60000000000028, 40.265044310772325, 47.1298862953699, 48.40000000000023, 36.202116310375594, 74.49999999999962, 153.19999999999987, 40.1000000000002, 131.19999999999982, 52.570622032848895, 56.000000000000156, 129.1999999999993, 86.20000000000002, 28.831075919194078, 160.79999999999959, 81.33852172443821, 103.01543537877356, 169.88064982359512, 48.30000000000023, 52.529310579969625, 48.028025438635616, 198.59999999999948, 184.470358209413, 37.06861395355878, 80.95181844992561, 33.900000000000134, 135.39999999999944, 148.89999999999955, 133.69999999999916, 226.89999999999938, 68.3000000000002, 154.45814550558052, 41.47674734270453, 180.74087067540847, 60.139037304427255, 153.66325386820998, 109.81254335834268, 96.80000000000011, 108.61895163315396, 159.3546697445331, 53.10000000000013, 125.29999999999959, 34.93780403323022, 139.0999999999999, 206.80167211533725, 40.50000000000029, 68.40000000000009, 88.29999999999927, 242.69999999999993, 37.700000000000266, 104.09999999999903, 229.34134979067687, 152.6250807412044, 157.8592262743011, 37.26670789146122, 35.20000000000023, 108.04468364708873, 87.5999999999994, 92.41177405235972, 131.94864151087714, 94.40623855187317], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [13.573129738316304, -53.54665936669982, -254.04609845621002, -260.27960040372835, -140.65478211067654, -73.1171426718985, 39.583255312047925, -34.03651010327775, -114.83317908671795, -92.66853807147267, -96.4272326280199, 93.09870255859556, -64.80740741555226, 20.000000000000014, 20.626642410773584, -16.792242611230414, 18.848497587615384, -92.85980597895414, 69.17606926139403, -109.36249015041209, -285.2321358475945, 105.74800812423979, 132.7888944272447, -19.35385941243218, -25.356623210719427, 11.326871936077456, -78.03601550180139, -20.07740583328924, 28.904313331271958, 85.71002709904536, -84.17058524148602, -101.59193807470932, -247.8691803256373, -34.87488956710395, -49.40531904969436, -141.19228141836533, -107.134889946308, 73.87102816456981, 4.171128342528487, -6.373188196460497, 72.0443042732162, -52.54708787865346, -32.67477650531073, -33.11217620680012, 17.408091439294907, -110.92817899556306, 80.28766474857159, -53.604483480981195, 64.90005398718623, -328.3984316256627, -221.37365036394135, -15.540567450569034, -217.97172194166885, 76.83739839192134, -62.4215290072797, -67.19987230581766, 82.82590198976501, -215.4723347673664, -63.01766150909464, -253.83034574412602, -72.05610867549865, 89.36722870345912, -103.9034532802869, -142.29070810227037, 0.5594712651248201, 21.887655692545323, -382.5350217575324, 117.78599718266575, -341.68754507993606, -271.3757928143444, 42.05974767402415, -113.91576456218526, 10.584749159468316, -368.0370289653096, -96.60173288891873, 6.578081936680414, -116.41208622158636, -38.927412945968925, -335.88260364800084, 33.30132488528524, -27.102952922490367, -70.03840438982733, -11.808869660467748, -17.067235360537826, 10.174001800704053, -2.962232113254194, -5.251613856427011, -54.123434986458186, -77.75098136410048, -19.99080009629646, 33.88040540161318, 40.0118549587175, 18.203034292193653, -101.55435256341609, 84.66934503983893, -118.51718584134521, -111.25275039532056, -35.27706169307365, 12.962713255211035, -154.80174341253127, -108.368940102753, 45.92361009447094, 66.26530936409696, -54.85406764413665, -50.32982812857711, -6.234569676365133, 43.52535653925046, -20.284647818951065, -122.72911794687963, -30.02930181547257, 64.88866316909824, -29.828281979136015, 27.845266783971347, 9.541578665059246, 1.103496687474779, 7.009962407567832, -8.299879170194934, -72.54471461247661, -97.58563081684744, -33.94553553761412, 161.42330774007206, -112.95182525200485, -6.1055308568346724, 40.28710026868663, -159.2584299113319, 1.9693763855458568, -203.51123731867187, -41.75335832068283, -112.73519084767737, -9.86848498904447, -75.14768969882805, 64.9005559888798, -41.26096743109789, 11.98667537860044, 89.1022150662958, -53.133135240501986, -21.790897701337713, 102.87572050846154, -103.60518017643587, -2.753002690682439, -77.5059788586302, -136.78681328113666, -35.26167272819433, 0.7616669233566751, 99.3892737675306, -121.76317749732668, -221.41484542454427, -0.26256937414734516, -81.64046493632515, 47.835445195899766, 41.62225202827415, -159.27689309555132, 8.414915969460758, -94.96493654962522, -101.89030278114168, -225.75780180988139, 42.3879814213417, -221.12051631037914, -194.2370444672595, -47.443484467917465, -68.94976936260595, -71.53127552961595, -175.21866179031935, -2.377011043507998, 7.336224962261236, 57.5840314172886, 148.94400313475802, -286.27355747273646, -38.05288701360526, -15.675153673344045, -157.06325915064687, 20.451311784900852, -34.19514158105644, -163.71926844518902, 179.13622751357744, -193.68286217716528, -5.466795255903271, 18.11348646225638, 73.35067178507347, -116.27200227841195, 81.3532898949211, -15.069998875773695, -1.5790888906085807, -103.01419787536915, 39.20269946596015, -70.07117731476804, -109.82064133551206, -6.986631127929058, -36.128808808176835, 15.187313791671755, -14.673585565722401, -251.67950712492743, 6.628822658497688, -90.79739622560763, -223.17849208443, -63.253333383580255, -19.653256456869457, -32.815082218808726, 25.002451968907792, -219.83803663194715], "policy_predator_policy_reward": [5.826870261683667, 69.24665936669969, 324.2059226722713, 187.82411487972215, 153.05478211067583, 113.01714267189817, 17.61674468795218, 70.83651010327776, 56.871368154986286, 191.90703446277513, 141.68851820524378, 0.0, 91.80740741555158, 0.0, 54.17335758922649, 131.5922426112305, 1.0515024123846184, 119.05980597895365, 36.62393073860571, 126.16249015041168, 294.04458931930264, 58.43138602720072, 27.098306487098423, 43.366658498089144, 101.5982771707111, 77.69808380843789, 92.33601550180148, 69.17740583328944, 11.711242094735995, 97.91032777106007, 159.598841430636, 144.42881435000547, 256.62014258831397, 83.17326937041157, 64.7437860571049, 182.14132692717635, 121.33488994630724, 3.428971835429686, 17.92887165747148, 61.97318819646065, 71.37501564844887, 195.79699114833366, 50.574776505310986, 49.41217620680031, 95.99190856070484, 133.02817899556257, 118.64992189155714, 44.429110259031575, 173.65858800042827, 294.7987946549283, 219.5255437438939, 58.84984999166302, 153.020176017792, 148.6350451107507, 84.92152900727922, 86.59987230581754, 35.917401426461, 256.72903135113984, 310.86582010807547, 62.23254304989086, 95.58973110505788, 76.50819038770996, 122.80345328028605, 155.79070810226966, 62.740528734875355, 50.312344307454744, 388.3350217575325, 13.51400281733393, 276.4934910271924, 282.6228917498557, 228.37632836739596, 14.384633174866076, 36.51525084053167, 377.03702896531087, 55.843560999739694, 94.38008995249868, 186.75715567238382, 3.338471062991101, 341.8826036480012, 4.298675114714987, 61.56155472910194, 75.84484689398705, 39.31993402285901, 36.68605729351662, 9.025998199295913, 32.16223211325439, 17.067987561023646, 78.50917759223691, 86.89305015310855, 85.34873130728765, 32.98846306649877, 46.31927657317061, 3.2969657078063443, 120.15435256341586, 51.96603493554656, 113.08180586595923, 51.82953263144456, 147.2709014897984, 28.814437033388117, 169.02459312393165, 122.3689401027523, 69.27638990552909, 2.934690635903009, 71.85406764413669, 69.17481916505344, 16.220654559082863, 82.67464346074956, 54.88464781895127, 149.0452344703959, 85.05170701639402, 61.64654055235777, 6.308513636455049, 122.72811266075166, 9.76569171381375, 28.196503312525255, 11.990037592432142, 39.59465245581429, 93.77925190682629, 173.417858483239, 6.14133330985798, 15.762281811455798, 134.36623570047647, 76.06028203580479, 74.22850676175635, 34.695476680536935, 159.6621907988072, 167.2233660646181, 158.99304802466287, 125.23519084767717, 31.268484989044566, 88.54768969882797, 57.09944401112018, 170.03924007813922, 8.135051974358213, 21.451638560862875, 76.27928161334323, 145.09089770133772, 0.7242794915378635, 119.58478321201947, 55.07339965509877, 101.30347201003724, 267.44746563530987, 25.72851731642294, 50.2482358311191, 10.105741511511418, 193.0090328936931, 242.16798791533478, 39.648464187783205, 159.3499139561802, 28.118359652455005, 62.6282279289202, 164.83895649669932, 73.18508403053936, 110.16493654962441, 168.40666761692708, 267.8603886072499, 213.90796331236706, 124.17924132120368, 231.43704446725934, 63.34348446791769, 164.82322943616253, 100.95781545605833, 192.6461275375021, 19.887349329554755, 38.363775037738804, 35.81596858271153, 113.3458349053624, 230.7853915479533, 54.85288701360539, 39.375153673344265, 203.76325915064663, 1.2486882150991712, 111.99514158105654, 174.21926844518845, 10.863772486422565, 246.3828621771652, 23.366795255903288, 1.686513537743613, 3.0493282149260565, 143.97200227841205, 11.169618052507685, 151.88844071902219, 78.45110531031017, 178.76726219687225, 5.491533832319006, 183.23617029079, 53.44679168121165, 100.62718867369004, 51.62880880817706, 4.512686208328209, 171.62334218999183, 202.77443414774723, 128.4407517753692, 43.32782179174049, 246.32318803637418, 132.52041148399576, 85.60806980806116, 98.80891037849513, 185.52092658311363, 103.72089663179854]}, "sampler_perf": {"mean_raw_obs_processing_ms": 24.612889016885457, "mean_inference_ms": 21.186329230406663, "mean_action_processing_ms": 5.908154806035579, "mean_env_wait_ms": 37.33530745612723, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.09543001651763916, "StateBufferConnector_ms": 0.03673684597015381, "ViewRequirementAgentConnector_ms": 1.255206823348999}, "num_episodes": 0, "episode_return_max": 286.6692231913454, "episode_return_min": -53.94695511723343, "episode_return_mean": 102.60472273081903, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 149312, "num_agent_steps_trained": 149312, "num_env_steps_sampled": 37328, "num_env_steps_trained": 37328, "num_env_steps_sampled_this_iter": 0, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 0.0, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 37328, "num_env_steps_sampled_lifetime": 37328, "num_agent_steps_sampled_lifetime": 149312, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 149312, "timers": {"training_iteration_time_ms": 61538.747, "restore_workers_time_ms": 29.731, "training_step_time_ms": 61444.412, "sample_time_ms": 61423.53, "learn_time_ms": 311236.026, "learn_throughput": 59.967, "synch_weights_time_ms": 43.334}, "counters": {"num_env_steps_sampled": 37328, "num_env_steps_trained": 37328, "num_agent_steps_sampled": 149312, "num_agent_steps_trained": 149312}, "done": false, "training_iteration": 16, "trial_id": "d7bca_00000", "date": "2024-08-20_11-33-14", "timestamp": 1724133794, "time_this_iter_s": 122.97379279136658, "time_total_s": 2522.815244913101, "pid": 36059, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 16000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x32cf66af0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2522.815244913101, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 97.07823529411765, "ram_util_percent": 83.79235294117647}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {}, "num_env_steps_sampled": 37328, "num_env_steps_trained": 37328, "num_agent_steps_sampled": 149312, "num_agent_steps_trained": 149312}, "env_runners": {"episode_reward_max": 286.6692231913454, "episode_reward_min": -53.94695511723343, "episode_reward_mean": 102.60472273081903, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -382.5350217575324, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 179.13622751357744, "predator_policy": 388.3350217575325}, "policy_reward_mean": {"prey_policy": -50.61742331228365, "predator_policy": 101.91978467769317}, "custom_metrics": {}, "hist_stats": {"episode_reward": [35.10000000000023, -2.2956613079459616, 52.30000000000035, 93.99999999999946, 41.27668545957155, 138.35998813581944, 47.000000000000355, 189.59999999999982, 46.100000000000314, 122.59999999999911, 172.99184762314727, 183.89999999999952, 165.26660970450598, 63.400000000000325, 224.23591029611316, 118.26513246444676, 57.049342065984625, 56.287512516221504, 91.49999999999856, 77.70000000000017, 286.6692231913454, 34.20000000000022, 135.4999999999999, 189.7622134181783, 204.95900501687956, 41.46117592104707, 160.52089757879483, 41.90000000000027, 159.99999999999952, 56.25035590474681, 189.40904152072758, 32.4000000000002, 135.49999999999923, 137.09999999999957, -53.94695511723343, 170.90494465410117, 56.10000000000025, 60.20000000000013, 34.75612756781972, 43.60000000000028, 40.265044310772325, 47.1298862953699, 48.40000000000023, 36.202116310375594, 74.49999999999962, 153.19999999999987, 40.1000000000002, 131.19999999999982, 52.570622032848895, 56.000000000000156, 129.1999999999993, 86.20000000000002, 28.831075919194078, 160.79999999999959, 81.33852172443821, 103.01543537877356, 169.88064982359512, 48.30000000000023, 52.529310579969625, 48.028025438635616, 198.59999999999948, 184.470358209413, 37.06861395355878, 80.95181844992561, 33.900000000000134, 135.39999999999944, 148.89999999999955, 133.69999999999916, 226.89999999999938, 68.3000000000002, 154.45814550558052, 41.47674734270453, 180.74087067540847, 60.139037304427255, 153.66325386820998, 109.81254335834268, 96.80000000000011, 108.61895163315396, 159.3546697445331, 53.10000000000013, 125.29999999999959, 34.93780403323022, 139.0999999999999, 206.80167211533725, 40.50000000000029, 68.40000000000009, 88.29999999999927, 242.69999999999993, 37.700000000000266, 104.09999999999903, 229.34134979067687, 152.6250807412044, 157.8592262743011, 37.26670789146122, 35.20000000000023, 108.04468364708873, 87.5999999999994, 92.41177405235972, 131.94864151087714, 94.40623855187317], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [13.573129738316304, -53.54665936669982, -254.04609845621002, -260.27960040372835, -140.65478211067654, -73.1171426718985, 39.583255312047925, -34.03651010327775, -114.83317908671795, -92.66853807147267, -96.4272326280199, 93.09870255859556, -64.80740741555226, 20.000000000000014, 20.626642410773584, -16.792242611230414, 18.848497587615384, -92.85980597895414, 69.17606926139403, -109.36249015041209, -285.2321358475945, 105.74800812423979, 132.7888944272447, -19.35385941243218, -25.356623210719427, 11.326871936077456, -78.03601550180139, -20.07740583328924, 28.904313331271958, 85.71002709904536, -84.17058524148602, -101.59193807470932, -247.8691803256373, -34.87488956710395, -49.40531904969436, -141.19228141836533, -107.134889946308, 73.87102816456981, 4.171128342528487, -6.373188196460497, 72.0443042732162, -52.54708787865346, -32.67477650531073, -33.11217620680012, 17.408091439294907, -110.92817899556306, 80.28766474857159, -53.604483480981195, 64.90005398718623, -328.3984316256627, -221.37365036394135, -15.540567450569034, -217.97172194166885, 76.83739839192134, -62.4215290072797, -67.19987230581766, 82.82590198976501, -215.4723347673664, -63.01766150909464, -253.83034574412602, -72.05610867549865, 89.36722870345912, -103.9034532802869, -142.29070810227037, 0.5594712651248201, 21.887655692545323, -382.5350217575324, 117.78599718266575, -341.68754507993606, -271.3757928143444, 42.05974767402415, -113.91576456218526, 10.584749159468316, -368.0370289653096, -96.60173288891873, 6.578081936680414, -116.41208622158636, -38.927412945968925, -335.88260364800084, 33.30132488528524, -27.102952922490367, -70.03840438982733, -11.808869660467748, -17.067235360537826, 10.174001800704053, -2.962232113254194, -5.251613856427011, -54.123434986458186, -77.75098136410048, -19.99080009629646, 33.88040540161318, 40.0118549587175, 18.203034292193653, -101.55435256341609, 84.66934503983893, -118.51718584134521, -111.25275039532056, -35.27706169307365, 12.962713255211035, -154.80174341253127, -108.368940102753, 45.92361009447094, 66.26530936409696, -54.85406764413665, -50.32982812857711, -6.234569676365133, 43.52535653925046, -20.284647818951065, -122.72911794687963, -30.02930181547257, 64.88866316909824, -29.828281979136015, 27.845266783971347, 9.541578665059246, 1.103496687474779, 7.009962407567832, -8.299879170194934, -72.54471461247661, -97.58563081684744, -33.94553553761412, 161.42330774007206, -112.95182525200485, -6.1055308568346724, 40.28710026868663, -159.2584299113319, 1.9693763855458568, -203.51123731867187, -41.75335832068283, -112.73519084767737, -9.86848498904447, -75.14768969882805, 64.9005559888798, -41.26096743109789, 11.98667537860044, 89.1022150662958, -53.133135240501986, -21.790897701337713, 102.87572050846154, -103.60518017643587, -2.753002690682439, -77.5059788586302, -136.78681328113666, -35.26167272819433, 0.7616669233566751, 99.3892737675306, -121.76317749732668, -221.41484542454427, -0.26256937414734516, -81.64046493632515, 47.835445195899766, 41.62225202827415, -159.27689309555132, 8.414915969460758, -94.96493654962522, -101.89030278114168, -225.75780180988139, 42.3879814213417, -221.12051631037914, -194.2370444672595, -47.443484467917465, -68.94976936260595, -71.53127552961595, -175.21866179031935, -2.377011043507998, 7.336224962261236, 57.5840314172886, 148.94400313475802, -286.27355747273646, -38.05288701360526, -15.675153673344045, -157.06325915064687, 20.451311784900852, -34.19514158105644, -163.71926844518902, 179.13622751357744, -193.68286217716528, -5.466795255903271, 18.11348646225638, 73.35067178507347, -116.27200227841195, 81.3532898949211, -15.069998875773695, -1.5790888906085807, -103.01419787536915, 39.20269946596015, -70.07117731476804, -109.82064133551206, -6.986631127929058, -36.128808808176835, 15.187313791671755, -14.673585565722401, -251.67950712492743, 6.628822658497688, -90.79739622560763, -223.17849208443, -63.253333383580255, -19.653256456869457, -32.815082218808726, 25.002451968907792, -219.83803663194715], "policy_predator_policy_reward": [5.826870261683667, 69.24665936669969, 324.2059226722713, 187.82411487972215, 153.05478211067583, 113.01714267189817, 17.61674468795218, 70.83651010327776, 56.871368154986286, 191.90703446277513, 141.68851820524378, 0.0, 91.80740741555158, 0.0, 54.17335758922649, 131.5922426112305, 1.0515024123846184, 119.05980597895365, 36.62393073860571, 126.16249015041168, 294.04458931930264, 58.43138602720072, 27.098306487098423, 43.366658498089144, 101.5982771707111, 77.69808380843789, 92.33601550180148, 69.17740583328944, 11.711242094735995, 97.91032777106007, 159.598841430636, 144.42881435000547, 256.62014258831397, 83.17326937041157, 64.7437860571049, 182.14132692717635, 121.33488994630724, 3.428971835429686, 17.92887165747148, 61.97318819646065, 71.37501564844887, 195.79699114833366, 50.574776505310986, 49.41217620680031, 95.99190856070484, 133.02817899556257, 118.64992189155714, 44.429110259031575, 173.65858800042827, 294.7987946549283, 219.5255437438939, 58.84984999166302, 153.020176017792, 148.6350451107507, 84.92152900727922, 86.59987230581754, 35.917401426461, 256.72903135113984, 310.86582010807547, 62.23254304989086, 95.58973110505788, 76.50819038770996, 122.80345328028605, 155.79070810226966, 62.740528734875355, 50.312344307454744, 388.3350217575325, 13.51400281733393, 276.4934910271924, 282.6228917498557, 228.37632836739596, 14.384633174866076, 36.51525084053167, 377.03702896531087, 55.843560999739694, 94.38008995249868, 186.75715567238382, 3.338471062991101, 341.8826036480012, 4.298675114714987, 61.56155472910194, 75.84484689398705, 39.31993402285901, 36.68605729351662, 9.025998199295913, 32.16223211325439, 17.067987561023646, 78.50917759223691, 86.89305015310855, 85.34873130728765, 32.98846306649877, 46.31927657317061, 3.2969657078063443, 120.15435256341586, 51.96603493554656, 113.08180586595923, 51.82953263144456, 147.2709014897984, 28.814437033388117, 169.02459312393165, 122.3689401027523, 69.27638990552909, 2.934690635903009, 71.85406764413669, 69.17481916505344, 16.220654559082863, 82.67464346074956, 54.88464781895127, 149.0452344703959, 85.05170701639402, 61.64654055235777, 6.308513636455049, 122.72811266075166, 9.76569171381375, 28.196503312525255, 11.990037592432142, 39.59465245581429, 93.77925190682629, 173.417858483239, 6.14133330985798, 15.762281811455798, 134.36623570047647, 76.06028203580479, 74.22850676175635, 34.695476680536935, 159.6621907988072, 167.2233660646181, 158.99304802466287, 125.23519084767717, 31.268484989044566, 88.54768969882797, 57.09944401112018, 170.03924007813922, 8.135051974358213, 21.451638560862875, 76.27928161334323, 145.09089770133772, 0.7242794915378635, 119.58478321201947, 55.07339965509877, 101.30347201003724, 267.44746563530987, 25.72851731642294, 50.2482358311191, 10.105741511511418, 193.0090328936931, 242.16798791533478, 39.648464187783205, 159.3499139561802, 28.118359652455005, 62.6282279289202, 164.83895649669932, 73.18508403053936, 110.16493654962441, 168.40666761692708, 267.8603886072499, 213.90796331236706, 124.17924132120368, 231.43704446725934, 63.34348446791769, 164.82322943616253, 100.95781545605833, 192.6461275375021, 19.887349329554755, 38.363775037738804, 35.81596858271153, 113.3458349053624, 230.7853915479533, 54.85288701360539, 39.375153673344265, 203.76325915064663, 1.2486882150991712, 111.99514158105654, 174.21926844518845, 10.863772486422565, 246.3828621771652, 23.366795255903288, 1.686513537743613, 3.0493282149260565, 143.97200227841205, 11.169618052507685, 151.88844071902219, 78.45110531031017, 178.76726219687225, 5.491533832319006, 183.23617029079, 53.44679168121165, 100.62718867369004, 51.62880880817706, 4.512686208328209, 171.62334218999183, 202.77443414774723, 128.4407517753692, 43.32782179174049, 246.32318803637418, 132.52041148399576, 85.60806980806116, 98.80891037849513, 185.52092658311363, 103.72089663179854]}, "sampler_perf": {"mean_raw_obs_processing_ms": 24.612889016885457, "mean_inference_ms": 21.186329230406663, "mean_action_processing_ms": 5.908154806035579, "mean_env_wait_ms": 37.33530745612723, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.09543001651763916, "StateBufferConnector_ms": 0.03673684597015381, "ViewRequirementAgentConnector_ms": 1.255206823348999}, "num_episodes": 0, "episode_return_max": 286.6692231913454, "episode_return_min": -53.94695511723343, "episode_return_mean": 102.60472273081903, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 149312, "num_agent_steps_trained": 149312, "num_env_steps_sampled": 37328, "num_env_steps_trained": 37328, "num_env_steps_sampled_this_iter": 0, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 0.0, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 37328, "num_env_steps_sampled_lifetime": 37328, "num_agent_steps_sampled_lifetime": 149312, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 149312, "timers": {"training_iteration_time_ms": 61544.357, "restore_workers_time_ms": 26.985, "training_step_time_ms": 61452.071, "sample_time_ms": 61431.437, "learn_time_ms": 311236.026, "learn_throughput": 59.967, "synch_weights_time_ms": 43.334}, "counters": {"num_env_steps_sampled": 37328, "num_env_steps_trained": 37328, "num_agent_steps_sampled": 149312, "num_agent_steps_trained": 149312}, "done": false, "training_iteration": 17, "trial_id": "d7bca_00000", "date": "2024-08-20_11-35-24", "timestamp": 1724133924, "time_this_iter_s": 123.32740807533264, "time_total_s": 2646.142652988434, "pid": 36059, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 16000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b0d6c700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2646.142652988434, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 96.59257142857143, "ram_util_percent": 83.72571428571429}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {}, "num_env_steps_sampled": 37328, "num_env_steps_trained": 37328, "num_agent_steps_sampled": 149312, "num_agent_steps_trained": 149312}, "env_runners": {"episode_reward_max": 286.6692231913454, "episode_reward_min": -53.94695511723343, "episode_reward_mean": 102.60472273081903, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -382.5350217575324, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 179.13622751357744, "predator_policy": 388.3350217575325}, "policy_reward_mean": {"prey_policy": -50.61742331228365, "predator_policy": 101.91978467769317}, "custom_metrics": {}, "hist_stats": {"episode_reward": [35.10000000000023, -2.2956613079459616, 52.30000000000035, 93.99999999999946, 41.27668545957155, 138.35998813581944, 47.000000000000355, 189.59999999999982, 46.100000000000314, 122.59999999999911, 172.99184762314727, 183.89999999999952, 165.26660970450598, 63.400000000000325, 224.23591029611316, 118.26513246444676, 57.049342065984625, 56.287512516221504, 91.49999999999856, 77.70000000000017, 286.6692231913454, 34.20000000000022, 135.4999999999999, 189.7622134181783, 204.95900501687956, 41.46117592104707, 160.52089757879483, 41.90000000000027, 159.99999999999952, 56.25035590474681, 189.40904152072758, 32.4000000000002, 135.49999999999923, 137.09999999999957, -53.94695511723343, 170.90494465410117, 56.10000000000025, 60.20000000000013, 34.75612756781972, 43.60000000000028, 40.265044310772325, 47.1298862953699, 48.40000000000023, 36.202116310375594, 74.49999999999962, 153.19999999999987, 40.1000000000002, 131.19999999999982, 52.570622032848895, 56.000000000000156, 129.1999999999993, 86.20000000000002, 28.831075919194078, 160.79999999999959, 81.33852172443821, 103.01543537877356, 169.88064982359512, 48.30000000000023, 52.529310579969625, 48.028025438635616, 198.59999999999948, 184.470358209413, 37.06861395355878, 80.95181844992561, 33.900000000000134, 135.39999999999944, 148.89999999999955, 133.69999999999916, 226.89999999999938, 68.3000000000002, 154.45814550558052, 41.47674734270453, 180.74087067540847, 60.139037304427255, 153.66325386820998, 109.81254335834268, 96.80000000000011, 108.61895163315396, 159.3546697445331, 53.10000000000013, 125.29999999999959, 34.93780403323022, 139.0999999999999, 206.80167211533725, 40.50000000000029, 68.40000000000009, 88.29999999999927, 242.69999999999993, 37.700000000000266, 104.09999999999903, 229.34134979067687, 152.6250807412044, 157.8592262743011, 37.26670789146122, 35.20000000000023, 108.04468364708873, 87.5999999999994, 92.41177405235972, 131.94864151087714, 94.40623855187317], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [13.573129738316304, -53.54665936669982, -254.04609845621002, -260.27960040372835, -140.65478211067654, -73.1171426718985, 39.583255312047925, -34.03651010327775, -114.83317908671795, -92.66853807147267, -96.4272326280199, 93.09870255859556, -64.80740741555226, 20.000000000000014, 20.626642410773584, -16.792242611230414, 18.848497587615384, -92.85980597895414, 69.17606926139403, -109.36249015041209, -285.2321358475945, 105.74800812423979, 132.7888944272447, -19.35385941243218, -25.356623210719427, 11.326871936077456, -78.03601550180139, -20.07740583328924, 28.904313331271958, 85.71002709904536, -84.17058524148602, -101.59193807470932, -247.8691803256373, -34.87488956710395, -49.40531904969436, -141.19228141836533, -107.134889946308, 73.87102816456981, 4.171128342528487, -6.373188196460497, 72.0443042732162, -52.54708787865346, -32.67477650531073, -33.11217620680012, 17.408091439294907, -110.92817899556306, 80.28766474857159, -53.604483480981195, 64.90005398718623, -328.3984316256627, -221.37365036394135, -15.540567450569034, -217.97172194166885, 76.83739839192134, -62.4215290072797, -67.19987230581766, 82.82590198976501, -215.4723347673664, -63.01766150909464, -253.83034574412602, -72.05610867549865, 89.36722870345912, -103.9034532802869, -142.29070810227037, 0.5594712651248201, 21.887655692545323, -382.5350217575324, 117.78599718266575, -341.68754507993606, -271.3757928143444, 42.05974767402415, -113.91576456218526, 10.584749159468316, -368.0370289653096, -96.60173288891873, 6.578081936680414, -116.41208622158636, -38.927412945968925, -335.88260364800084, 33.30132488528524, -27.102952922490367, -70.03840438982733, -11.808869660467748, -17.067235360537826, 10.174001800704053, -2.962232113254194, -5.251613856427011, -54.123434986458186, -77.75098136410048, -19.99080009629646, 33.88040540161318, 40.0118549587175, 18.203034292193653, -101.55435256341609, 84.66934503983893, -118.51718584134521, -111.25275039532056, -35.27706169307365, 12.962713255211035, -154.80174341253127, -108.368940102753, 45.92361009447094, 66.26530936409696, -54.85406764413665, -50.32982812857711, -6.234569676365133, 43.52535653925046, -20.284647818951065, -122.72911794687963, -30.02930181547257, 64.88866316909824, -29.828281979136015, 27.845266783971347, 9.541578665059246, 1.103496687474779, 7.009962407567832, -8.299879170194934, -72.54471461247661, -97.58563081684744, -33.94553553761412, 161.42330774007206, -112.95182525200485, -6.1055308568346724, 40.28710026868663, -159.2584299113319, 1.9693763855458568, -203.51123731867187, -41.75335832068283, -112.73519084767737, -9.86848498904447, -75.14768969882805, 64.9005559888798, -41.26096743109789, 11.98667537860044, 89.1022150662958, -53.133135240501986, -21.790897701337713, 102.87572050846154, -103.60518017643587, -2.753002690682439, -77.5059788586302, -136.78681328113666, -35.26167272819433, 0.7616669233566751, 99.3892737675306, -121.76317749732668, -221.41484542454427, -0.26256937414734516, -81.64046493632515, 47.835445195899766, 41.62225202827415, -159.27689309555132, 8.414915969460758, -94.96493654962522, -101.89030278114168, -225.75780180988139, 42.3879814213417, -221.12051631037914, -194.2370444672595, -47.443484467917465, -68.94976936260595, -71.53127552961595, -175.21866179031935, -2.377011043507998, 7.336224962261236, 57.5840314172886, 148.94400313475802, -286.27355747273646, -38.05288701360526, -15.675153673344045, -157.06325915064687, 20.451311784900852, -34.19514158105644, -163.71926844518902, 179.13622751357744, -193.68286217716528, -5.466795255903271, 18.11348646225638, 73.35067178507347, -116.27200227841195, 81.3532898949211, -15.069998875773695, -1.5790888906085807, -103.01419787536915, 39.20269946596015, -70.07117731476804, -109.82064133551206, -6.986631127929058, -36.128808808176835, 15.187313791671755, -14.673585565722401, -251.67950712492743, 6.628822658497688, -90.79739622560763, -223.17849208443, -63.253333383580255, -19.653256456869457, -32.815082218808726, 25.002451968907792, -219.83803663194715], "policy_predator_policy_reward": [5.826870261683667, 69.24665936669969, 324.2059226722713, 187.82411487972215, 153.05478211067583, 113.01714267189817, 17.61674468795218, 70.83651010327776, 56.871368154986286, 191.90703446277513, 141.68851820524378, 0.0, 91.80740741555158, 0.0, 54.17335758922649, 131.5922426112305, 1.0515024123846184, 119.05980597895365, 36.62393073860571, 126.16249015041168, 294.04458931930264, 58.43138602720072, 27.098306487098423, 43.366658498089144, 101.5982771707111, 77.69808380843789, 92.33601550180148, 69.17740583328944, 11.711242094735995, 97.91032777106007, 159.598841430636, 144.42881435000547, 256.62014258831397, 83.17326937041157, 64.7437860571049, 182.14132692717635, 121.33488994630724, 3.428971835429686, 17.92887165747148, 61.97318819646065, 71.37501564844887, 195.79699114833366, 50.574776505310986, 49.41217620680031, 95.99190856070484, 133.02817899556257, 118.64992189155714, 44.429110259031575, 173.65858800042827, 294.7987946549283, 219.5255437438939, 58.84984999166302, 153.020176017792, 148.6350451107507, 84.92152900727922, 86.59987230581754, 35.917401426461, 256.72903135113984, 310.86582010807547, 62.23254304989086, 95.58973110505788, 76.50819038770996, 122.80345328028605, 155.79070810226966, 62.740528734875355, 50.312344307454744, 388.3350217575325, 13.51400281733393, 276.4934910271924, 282.6228917498557, 228.37632836739596, 14.384633174866076, 36.51525084053167, 377.03702896531087, 55.843560999739694, 94.38008995249868, 186.75715567238382, 3.338471062991101, 341.8826036480012, 4.298675114714987, 61.56155472910194, 75.84484689398705, 39.31993402285901, 36.68605729351662, 9.025998199295913, 32.16223211325439, 17.067987561023646, 78.50917759223691, 86.89305015310855, 85.34873130728765, 32.98846306649877, 46.31927657317061, 3.2969657078063443, 120.15435256341586, 51.96603493554656, 113.08180586595923, 51.82953263144456, 147.2709014897984, 28.814437033388117, 169.02459312393165, 122.3689401027523, 69.27638990552909, 2.934690635903009, 71.85406764413669, 69.17481916505344, 16.220654559082863, 82.67464346074956, 54.88464781895127, 149.0452344703959, 85.05170701639402, 61.64654055235777, 6.308513636455049, 122.72811266075166, 9.76569171381375, 28.196503312525255, 11.990037592432142, 39.59465245581429, 93.77925190682629, 173.417858483239, 6.14133330985798, 15.762281811455798, 134.36623570047647, 76.06028203580479, 74.22850676175635, 34.695476680536935, 159.6621907988072, 167.2233660646181, 158.99304802466287, 125.23519084767717, 31.268484989044566, 88.54768969882797, 57.09944401112018, 170.03924007813922, 8.135051974358213, 21.451638560862875, 76.27928161334323, 145.09089770133772, 0.7242794915378635, 119.58478321201947, 55.07339965509877, 101.30347201003724, 267.44746563530987, 25.72851731642294, 50.2482358311191, 10.105741511511418, 193.0090328936931, 242.16798791533478, 39.648464187783205, 159.3499139561802, 28.118359652455005, 62.6282279289202, 164.83895649669932, 73.18508403053936, 110.16493654962441, 168.40666761692708, 267.8603886072499, 213.90796331236706, 124.17924132120368, 231.43704446725934, 63.34348446791769, 164.82322943616253, 100.95781545605833, 192.6461275375021, 19.887349329554755, 38.363775037738804, 35.81596858271153, 113.3458349053624, 230.7853915479533, 54.85288701360539, 39.375153673344265, 203.76325915064663, 1.2486882150991712, 111.99514158105654, 174.21926844518845, 10.863772486422565, 246.3828621771652, 23.366795255903288, 1.686513537743613, 3.0493282149260565, 143.97200227841205, 11.169618052507685, 151.88844071902219, 78.45110531031017, 178.76726219687225, 5.491533832319006, 183.23617029079, 53.44679168121165, 100.62718867369004, 51.62880880817706, 4.512686208328209, 171.62334218999183, 202.77443414774723, 128.4407517753692, 43.32782179174049, 246.32318803637418, 132.52041148399576, 85.60806980806116, 98.80891037849513, 185.52092658311363, 103.72089663179854]}, "sampler_perf": {"mean_raw_obs_processing_ms": 24.612889016885457, "mean_inference_ms": 21.186329230406663, "mean_action_processing_ms": 5.908154806035579, "mean_env_wait_ms": 37.33530745612723, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.09543001651763916, "StateBufferConnector_ms": 0.03673684597015381, "ViewRequirementAgentConnector_ms": 1.255206823348999}, "num_episodes": 0, "episode_return_max": 286.6692231913454, "episode_return_min": -53.94695511723343, "episode_return_mean": 102.60472273081903, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 149312, "num_agent_steps_trained": 149312, "num_env_steps_sampled": 37328, "num_env_steps_trained": 37328, "num_env_steps_sampled_this_iter": 0, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 0.0, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 37328, "num_env_steps_sampled_lifetime": 37328, "num_agent_steps_sampled_lifetime": 149312, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 149312, "timers": {"training_iteration_time_ms": 61553.217, "restore_workers_time_ms": 29.067, "training_step_time_ms": 61457.768, "sample_time_ms": 61434.866, "learn_time_ms": 311236.026, "learn_throughput": 59.967, "synch_weights_time_ms": 43.334}, "counters": {"num_env_steps_sampled": 37328, "num_env_steps_trained": 37328, "num_agent_steps_sampled": 149312, "num_agent_steps_trained": 149312}, "done": false, "training_iteration": 18, "trial_id": "d7bca_00000", "date": "2024-08-20_11-37-30", "timestamp": 1724134050, "time_this_iter_s": 122.89815211296082, "time_total_s": 2769.0408051013947, "pid": 36059, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 16000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3ae8c74c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2769.0408051013947, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 96.48402366863905, "ram_util_percent": 83.62840236686392}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {}, "num_env_steps_sampled": 37328, "num_env_steps_trained": 37328, "num_agent_steps_sampled": 149312, "num_agent_steps_trained": 149312}, "env_runners": {"episode_reward_max": 286.6692231913454, "episode_reward_min": -53.94695511723343, "episode_reward_mean": 102.60472273081903, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -382.5350217575324, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 179.13622751357744, "predator_policy": 388.3350217575325}, "policy_reward_mean": {"prey_policy": -50.61742331228365, "predator_policy": 101.91978467769317}, "custom_metrics": {}, "hist_stats": {"episode_reward": [35.10000000000023, -2.2956613079459616, 52.30000000000035, 93.99999999999946, 41.27668545957155, 138.35998813581944, 47.000000000000355, 189.59999999999982, 46.100000000000314, 122.59999999999911, 172.99184762314727, 183.89999999999952, 165.26660970450598, 63.400000000000325, 224.23591029611316, 118.26513246444676, 57.049342065984625, 56.287512516221504, 91.49999999999856, 77.70000000000017, 286.6692231913454, 34.20000000000022, 135.4999999999999, 189.7622134181783, 204.95900501687956, 41.46117592104707, 160.52089757879483, 41.90000000000027, 159.99999999999952, 56.25035590474681, 189.40904152072758, 32.4000000000002, 135.49999999999923, 137.09999999999957, -53.94695511723343, 170.90494465410117, 56.10000000000025, 60.20000000000013, 34.75612756781972, 43.60000000000028, 40.265044310772325, 47.1298862953699, 48.40000000000023, 36.202116310375594, 74.49999999999962, 153.19999999999987, 40.1000000000002, 131.19999999999982, 52.570622032848895, 56.000000000000156, 129.1999999999993, 86.20000000000002, 28.831075919194078, 160.79999999999959, 81.33852172443821, 103.01543537877356, 169.88064982359512, 48.30000000000023, 52.529310579969625, 48.028025438635616, 198.59999999999948, 184.470358209413, 37.06861395355878, 80.95181844992561, 33.900000000000134, 135.39999999999944, 148.89999999999955, 133.69999999999916, 226.89999999999938, 68.3000000000002, 154.45814550558052, 41.47674734270453, 180.74087067540847, 60.139037304427255, 153.66325386820998, 109.81254335834268, 96.80000000000011, 108.61895163315396, 159.3546697445331, 53.10000000000013, 125.29999999999959, 34.93780403323022, 139.0999999999999, 206.80167211533725, 40.50000000000029, 68.40000000000009, 88.29999999999927, 242.69999999999993, 37.700000000000266, 104.09999999999903, 229.34134979067687, 152.6250807412044, 157.8592262743011, 37.26670789146122, 35.20000000000023, 108.04468364708873, 87.5999999999994, 92.41177405235972, 131.94864151087714, 94.40623855187317], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [13.573129738316304, -53.54665936669982, -254.04609845621002, -260.27960040372835, -140.65478211067654, -73.1171426718985, 39.583255312047925, -34.03651010327775, -114.83317908671795, -92.66853807147267, -96.4272326280199, 93.09870255859556, -64.80740741555226, 20.000000000000014, 20.626642410773584, -16.792242611230414, 18.848497587615384, -92.85980597895414, 69.17606926139403, -109.36249015041209, -285.2321358475945, 105.74800812423979, 132.7888944272447, -19.35385941243218, -25.356623210719427, 11.326871936077456, -78.03601550180139, -20.07740583328924, 28.904313331271958, 85.71002709904536, -84.17058524148602, -101.59193807470932, -247.8691803256373, -34.87488956710395, -49.40531904969436, -141.19228141836533, -107.134889946308, 73.87102816456981, 4.171128342528487, -6.373188196460497, 72.0443042732162, -52.54708787865346, -32.67477650531073, -33.11217620680012, 17.408091439294907, -110.92817899556306, 80.28766474857159, -53.604483480981195, 64.90005398718623, -328.3984316256627, -221.37365036394135, -15.540567450569034, -217.97172194166885, 76.83739839192134, -62.4215290072797, -67.19987230581766, 82.82590198976501, -215.4723347673664, -63.01766150909464, -253.83034574412602, -72.05610867549865, 89.36722870345912, -103.9034532802869, -142.29070810227037, 0.5594712651248201, 21.887655692545323, -382.5350217575324, 117.78599718266575, -341.68754507993606, -271.3757928143444, 42.05974767402415, -113.91576456218526, 10.584749159468316, -368.0370289653096, -96.60173288891873, 6.578081936680414, -116.41208622158636, -38.927412945968925, -335.88260364800084, 33.30132488528524, -27.102952922490367, -70.03840438982733, -11.808869660467748, -17.067235360537826, 10.174001800704053, -2.962232113254194, -5.251613856427011, -54.123434986458186, -77.75098136410048, -19.99080009629646, 33.88040540161318, 40.0118549587175, 18.203034292193653, -101.55435256341609, 84.66934503983893, -118.51718584134521, -111.25275039532056, -35.27706169307365, 12.962713255211035, -154.80174341253127, -108.368940102753, 45.92361009447094, 66.26530936409696, -54.85406764413665, -50.32982812857711, -6.234569676365133, 43.52535653925046, -20.284647818951065, -122.72911794687963, -30.02930181547257, 64.88866316909824, -29.828281979136015, 27.845266783971347, 9.541578665059246, 1.103496687474779, 7.009962407567832, -8.299879170194934, -72.54471461247661, -97.58563081684744, -33.94553553761412, 161.42330774007206, -112.95182525200485, -6.1055308568346724, 40.28710026868663, -159.2584299113319, 1.9693763855458568, -203.51123731867187, -41.75335832068283, -112.73519084767737, -9.86848498904447, -75.14768969882805, 64.9005559888798, -41.26096743109789, 11.98667537860044, 89.1022150662958, -53.133135240501986, -21.790897701337713, 102.87572050846154, -103.60518017643587, -2.753002690682439, -77.5059788586302, -136.78681328113666, -35.26167272819433, 0.7616669233566751, 99.3892737675306, -121.76317749732668, -221.41484542454427, -0.26256937414734516, -81.64046493632515, 47.835445195899766, 41.62225202827415, -159.27689309555132, 8.414915969460758, -94.96493654962522, -101.89030278114168, -225.75780180988139, 42.3879814213417, -221.12051631037914, -194.2370444672595, -47.443484467917465, -68.94976936260595, -71.53127552961595, -175.21866179031935, -2.377011043507998, 7.336224962261236, 57.5840314172886, 148.94400313475802, -286.27355747273646, -38.05288701360526, -15.675153673344045, -157.06325915064687, 20.451311784900852, -34.19514158105644, -163.71926844518902, 179.13622751357744, -193.68286217716528, -5.466795255903271, 18.11348646225638, 73.35067178507347, -116.27200227841195, 81.3532898949211, -15.069998875773695, -1.5790888906085807, -103.01419787536915, 39.20269946596015, -70.07117731476804, -109.82064133551206, -6.986631127929058, -36.128808808176835, 15.187313791671755, -14.673585565722401, -251.67950712492743, 6.628822658497688, -90.79739622560763, -223.17849208443, -63.253333383580255, -19.653256456869457, -32.815082218808726, 25.002451968907792, -219.83803663194715], "policy_predator_policy_reward": [5.826870261683667, 69.24665936669969, 324.2059226722713, 187.82411487972215, 153.05478211067583, 113.01714267189817, 17.61674468795218, 70.83651010327776, 56.871368154986286, 191.90703446277513, 141.68851820524378, 0.0, 91.80740741555158, 0.0, 54.17335758922649, 131.5922426112305, 1.0515024123846184, 119.05980597895365, 36.62393073860571, 126.16249015041168, 294.04458931930264, 58.43138602720072, 27.098306487098423, 43.366658498089144, 101.5982771707111, 77.69808380843789, 92.33601550180148, 69.17740583328944, 11.711242094735995, 97.91032777106007, 159.598841430636, 144.42881435000547, 256.62014258831397, 83.17326937041157, 64.7437860571049, 182.14132692717635, 121.33488994630724, 3.428971835429686, 17.92887165747148, 61.97318819646065, 71.37501564844887, 195.79699114833366, 50.574776505310986, 49.41217620680031, 95.99190856070484, 133.02817899556257, 118.64992189155714, 44.429110259031575, 173.65858800042827, 294.7987946549283, 219.5255437438939, 58.84984999166302, 153.020176017792, 148.6350451107507, 84.92152900727922, 86.59987230581754, 35.917401426461, 256.72903135113984, 310.86582010807547, 62.23254304989086, 95.58973110505788, 76.50819038770996, 122.80345328028605, 155.79070810226966, 62.740528734875355, 50.312344307454744, 388.3350217575325, 13.51400281733393, 276.4934910271924, 282.6228917498557, 228.37632836739596, 14.384633174866076, 36.51525084053167, 377.03702896531087, 55.843560999739694, 94.38008995249868, 186.75715567238382, 3.338471062991101, 341.8826036480012, 4.298675114714987, 61.56155472910194, 75.84484689398705, 39.31993402285901, 36.68605729351662, 9.025998199295913, 32.16223211325439, 17.067987561023646, 78.50917759223691, 86.89305015310855, 85.34873130728765, 32.98846306649877, 46.31927657317061, 3.2969657078063443, 120.15435256341586, 51.96603493554656, 113.08180586595923, 51.82953263144456, 147.2709014897984, 28.814437033388117, 169.02459312393165, 122.3689401027523, 69.27638990552909, 2.934690635903009, 71.85406764413669, 69.17481916505344, 16.220654559082863, 82.67464346074956, 54.88464781895127, 149.0452344703959, 85.05170701639402, 61.64654055235777, 6.308513636455049, 122.72811266075166, 9.76569171381375, 28.196503312525255, 11.990037592432142, 39.59465245581429, 93.77925190682629, 173.417858483239, 6.14133330985798, 15.762281811455798, 134.36623570047647, 76.06028203580479, 74.22850676175635, 34.695476680536935, 159.6621907988072, 167.2233660646181, 158.99304802466287, 125.23519084767717, 31.268484989044566, 88.54768969882797, 57.09944401112018, 170.03924007813922, 8.135051974358213, 21.451638560862875, 76.27928161334323, 145.09089770133772, 0.7242794915378635, 119.58478321201947, 55.07339965509877, 101.30347201003724, 267.44746563530987, 25.72851731642294, 50.2482358311191, 10.105741511511418, 193.0090328936931, 242.16798791533478, 39.648464187783205, 159.3499139561802, 28.118359652455005, 62.6282279289202, 164.83895649669932, 73.18508403053936, 110.16493654962441, 168.40666761692708, 267.8603886072499, 213.90796331236706, 124.17924132120368, 231.43704446725934, 63.34348446791769, 164.82322943616253, 100.95781545605833, 192.6461275375021, 19.887349329554755, 38.363775037738804, 35.81596858271153, 113.3458349053624, 230.7853915479533, 54.85288701360539, 39.375153673344265, 203.76325915064663, 1.2486882150991712, 111.99514158105654, 174.21926844518845, 10.863772486422565, 246.3828621771652, 23.366795255903288, 1.686513537743613, 3.0493282149260565, 143.97200227841205, 11.169618052507685, 151.88844071902219, 78.45110531031017, 178.76726219687225, 5.491533832319006, 183.23617029079, 53.44679168121165, 100.62718867369004, 51.62880880817706, 4.512686208328209, 171.62334218999183, 202.77443414774723, 128.4407517753692, 43.32782179174049, 246.32318803637418, 132.52041148399576, 85.60806980806116, 98.80891037849513, 185.52092658311363, 103.72089663179854]}, "sampler_perf": {"mean_raw_obs_processing_ms": 24.612889016885457, "mean_inference_ms": 21.186329230406663, "mean_action_processing_ms": 5.908154806035579, "mean_env_wait_ms": 37.33530745612723, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.09543001651763916, "StateBufferConnector_ms": 0.03673684597015381, "ViewRequirementAgentConnector_ms": 1.255206823348999}, "num_episodes": 0, "episode_return_max": 286.6692231913454, "episode_return_min": -53.94695511723343, "episode_return_mean": 102.60472273081903, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 149312, "num_agent_steps_trained": 149312, "num_env_steps_sampled": 37328, "num_env_steps_trained": 37328, "num_env_steps_sampled_this_iter": 0, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 0.0, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 37328, "num_env_steps_sampled_lifetime": 37328, "num_agent_steps_sampled_lifetime": 149312, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 149312, "timers": {"training_iteration_time_ms": 61567.179, "restore_workers_time_ms": 26.91, "training_step_time_ms": 61476.02, "sample_time_ms": 61452.899, "learn_time_ms": 311236.026, "learn_throughput": 59.967, "synch_weights_time_ms": 43.334}, "counters": {"num_env_steps_sampled": 37328, "num_env_steps_trained": 37328, "num_agent_steps_sampled": 149312, "num_agent_steps_trained": 149312}, "done": false, "training_iteration": 19, "trial_id": "d7bca_00000", "date": "2024-08-20_11-39-36", "timestamp": 1724134176, "time_this_iter_s": 122.79604887962341, "time_total_s": 2891.836853981018, "pid": 36059, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 16000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b0d6cca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2891.836853981018, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 96.21130952380952, "ram_util_percent": 83.60119047619048}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {}, "num_env_steps_sampled": 37328, "num_env_steps_trained": 37328, "num_agent_steps_sampled": 149312, "num_agent_steps_trained": 149312}, "env_runners": {"episode_reward_max": 286.6692231913454, "episode_reward_min": -53.94695511723343, "episode_reward_mean": 102.60472273081903, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -382.5350217575324, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 179.13622751357744, "predator_policy": 388.3350217575325}, "policy_reward_mean": {"prey_policy": -50.61742331228365, "predator_policy": 101.91978467769317}, "custom_metrics": {}, "hist_stats": {"episode_reward": [35.10000000000023, -2.2956613079459616, 52.30000000000035, 93.99999999999946, 41.27668545957155, 138.35998813581944, 47.000000000000355, 189.59999999999982, 46.100000000000314, 122.59999999999911, 172.99184762314727, 183.89999999999952, 165.26660970450598, 63.400000000000325, 224.23591029611316, 118.26513246444676, 57.049342065984625, 56.287512516221504, 91.49999999999856, 77.70000000000017, 286.6692231913454, 34.20000000000022, 135.4999999999999, 189.7622134181783, 204.95900501687956, 41.46117592104707, 160.52089757879483, 41.90000000000027, 159.99999999999952, 56.25035590474681, 189.40904152072758, 32.4000000000002, 135.49999999999923, 137.09999999999957, -53.94695511723343, 170.90494465410117, 56.10000000000025, 60.20000000000013, 34.75612756781972, 43.60000000000028, 40.265044310772325, 47.1298862953699, 48.40000000000023, 36.202116310375594, 74.49999999999962, 153.19999999999987, 40.1000000000002, 131.19999999999982, 52.570622032848895, 56.000000000000156, 129.1999999999993, 86.20000000000002, 28.831075919194078, 160.79999999999959, 81.33852172443821, 103.01543537877356, 169.88064982359512, 48.30000000000023, 52.529310579969625, 48.028025438635616, 198.59999999999948, 184.470358209413, 37.06861395355878, 80.95181844992561, 33.900000000000134, 135.39999999999944, 148.89999999999955, 133.69999999999916, 226.89999999999938, 68.3000000000002, 154.45814550558052, 41.47674734270453, 180.74087067540847, 60.139037304427255, 153.66325386820998, 109.81254335834268, 96.80000000000011, 108.61895163315396, 159.3546697445331, 53.10000000000013, 125.29999999999959, 34.93780403323022, 139.0999999999999, 206.80167211533725, 40.50000000000029, 68.40000000000009, 88.29999999999927, 242.69999999999993, 37.700000000000266, 104.09999999999903, 229.34134979067687, 152.6250807412044, 157.8592262743011, 37.26670789146122, 35.20000000000023, 108.04468364708873, 87.5999999999994, 92.41177405235972, 131.94864151087714, 94.40623855187317], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [13.573129738316304, -53.54665936669982, -254.04609845621002, -260.27960040372835, -140.65478211067654, -73.1171426718985, 39.583255312047925, -34.03651010327775, -114.83317908671795, -92.66853807147267, -96.4272326280199, 93.09870255859556, -64.80740741555226, 20.000000000000014, 20.626642410773584, -16.792242611230414, 18.848497587615384, -92.85980597895414, 69.17606926139403, -109.36249015041209, -285.2321358475945, 105.74800812423979, 132.7888944272447, -19.35385941243218, -25.356623210719427, 11.326871936077456, -78.03601550180139, -20.07740583328924, 28.904313331271958, 85.71002709904536, -84.17058524148602, -101.59193807470932, -247.8691803256373, -34.87488956710395, -49.40531904969436, -141.19228141836533, -107.134889946308, 73.87102816456981, 4.171128342528487, -6.373188196460497, 72.0443042732162, -52.54708787865346, -32.67477650531073, -33.11217620680012, 17.408091439294907, -110.92817899556306, 80.28766474857159, -53.604483480981195, 64.90005398718623, -328.3984316256627, -221.37365036394135, -15.540567450569034, -217.97172194166885, 76.83739839192134, -62.4215290072797, -67.19987230581766, 82.82590198976501, -215.4723347673664, -63.01766150909464, -253.83034574412602, -72.05610867549865, 89.36722870345912, -103.9034532802869, -142.29070810227037, 0.5594712651248201, 21.887655692545323, -382.5350217575324, 117.78599718266575, -341.68754507993606, -271.3757928143444, 42.05974767402415, -113.91576456218526, 10.584749159468316, -368.0370289653096, -96.60173288891873, 6.578081936680414, -116.41208622158636, -38.927412945968925, -335.88260364800084, 33.30132488528524, -27.102952922490367, -70.03840438982733, -11.808869660467748, -17.067235360537826, 10.174001800704053, -2.962232113254194, -5.251613856427011, -54.123434986458186, -77.75098136410048, -19.99080009629646, 33.88040540161318, 40.0118549587175, 18.203034292193653, -101.55435256341609, 84.66934503983893, -118.51718584134521, -111.25275039532056, -35.27706169307365, 12.962713255211035, -154.80174341253127, -108.368940102753, 45.92361009447094, 66.26530936409696, -54.85406764413665, -50.32982812857711, -6.234569676365133, 43.52535653925046, -20.284647818951065, -122.72911794687963, -30.02930181547257, 64.88866316909824, -29.828281979136015, 27.845266783971347, 9.541578665059246, 1.103496687474779, 7.009962407567832, -8.299879170194934, -72.54471461247661, -97.58563081684744, -33.94553553761412, 161.42330774007206, -112.95182525200485, -6.1055308568346724, 40.28710026868663, -159.2584299113319, 1.9693763855458568, -203.51123731867187, -41.75335832068283, -112.73519084767737, -9.86848498904447, -75.14768969882805, 64.9005559888798, -41.26096743109789, 11.98667537860044, 89.1022150662958, -53.133135240501986, -21.790897701337713, 102.87572050846154, -103.60518017643587, -2.753002690682439, -77.5059788586302, -136.78681328113666, -35.26167272819433, 0.7616669233566751, 99.3892737675306, -121.76317749732668, -221.41484542454427, -0.26256937414734516, -81.64046493632515, 47.835445195899766, 41.62225202827415, -159.27689309555132, 8.414915969460758, -94.96493654962522, -101.89030278114168, -225.75780180988139, 42.3879814213417, -221.12051631037914, -194.2370444672595, -47.443484467917465, -68.94976936260595, -71.53127552961595, -175.21866179031935, -2.377011043507998, 7.336224962261236, 57.5840314172886, 148.94400313475802, -286.27355747273646, -38.05288701360526, -15.675153673344045, -157.06325915064687, 20.451311784900852, -34.19514158105644, -163.71926844518902, 179.13622751357744, -193.68286217716528, -5.466795255903271, 18.11348646225638, 73.35067178507347, -116.27200227841195, 81.3532898949211, -15.069998875773695, -1.5790888906085807, -103.01419787536915, 39.20269946596015, -70.07117731476804, -109.82064133551206, -6.986631127929058, -36.128808808176835, 15.187313791671755, -14.673585565722401, -251.67950712492743, 6.628822658497688, -90.79739622560763, -223.17849208443, -63.253333383580255, -19.653256456869457, -32.815082218808726, 25.002451968907792, -219.83803663194715], "policy_predator_policy_reward": [5.826870261683667, 69.24665936669969, 324.2059226722713, 187.82411487972215, 153.05478211067583, 113.01714267189817, 17.61674468795218, 70.83651010327776, 56.871368154986286, 191.90703446277513, 141.68851820524378, 0.0, 91.80740741555158, 0.0, 54.17335758922649, 131.5922426112305, 1.0515024123846184, 119.05980597895365, 36.62393073860571, 126.16249015041168, 294.04458931930264, 58.43138602720072, 27.098306487098423, 43.366658498089144, 101.5982771707111, 77.69808380843789, 92.33601550180148, 69.17740583328944, 11.711242094735995, 97.91032777106007, 159.598841430636, 144.42881435000547, 256.62014258831397, 83.17326937041157, 64.7437860571049, 182.14132692717635, 121.33488994630724, 3.428971835429686, 17.92887165747148, 61.97318819646065, 71.37501564844887, 195.79699114833366, 50.574776505310986, 49.41217620680031, 95.99190856070484, 133.02817899556257, 118.64992189155714, 44.429110259031575, 173.65858800042827, 294.7987946549283, 219.5255437438939, 58.84984999166302, 153.020176017792, 148.6350451107507, 84.92152900727922, 86.59987230581754, 35.917401426461, 256.72903135113984, 310.86582010807547, 62.23254304989086, 95.58973110505788, 76.50819038770996, 122.80345328028605, 155.79070810226966, 62.740528734875355, 50.312344307454744, 388.3350217575325, 13.51400281733393, 276.4934910271924, 282.6228917498557, 228.37632836739596, 14.384633174866076, 36.51525084053167, 377.03702896531087, 55.843560999739694, 94.38008995249868, 186.75715567238382, 3.338471062991101, 341.8826036480012, 4.298675114714987, 61.56155472910194, 75.84484689398705, 39.31993402285901, 36.68605729351662, 9.025998199295913, 32.16223211325439, 17.067987561023646, 78.50917759223691, 86.89305015310855, 85.34873130728765, 32.98846306649877, 46.31927657317061, 3.2969657078063443, 120.15435256341586, 51.96603493554656, 113.08180586595923, 51.82953263144456, 147.2709014897984, 28.814437033388117, 169.02459312393165, 122.3689401027523, 69.27638990552909, 2.934690635903009, 71.85406764413669, 69.17481916505344, 16.220654559082863, 82.67464346074956, 54.88464781895127, 149.0452344703959, 85.05170701639402, 61.64654055235777, 6.308513636455049, 122.72811266075166, 9.76569171381375, 28.196503312525255, 11.990037592432142, 39.59465245581429, 93.77925190682629, 173.417858483239, 6.14133330985798, 15.762281811455798, 134.36623570047647, 76.06028203580479, 74.22850676175635, 34.695476680536935, 159.6621907988072, 167.2233660646181, 158.99304802466287, 125.23519084767717, 31.268484989044566, 88.54768969882797, 57.09944401112018, 170.03924007813922, 8.135051974358213, 21.451638560862875, 76.27928161334323, 145.09089770133772, 0.7242794915378635, 119.58478321201947, 55.07339965509877, 101.30347201003724, 267.44746563530987, 25.72851731642294, 50.2482358311191, 10.105741511511418, 193.0090328936931, 242.16798791533478, 39.648464187783205, 159.3499139561802, 28.118359652455005, 62.6282279289202, 164.83895649669932, 73.18508403053936, 110.16493654962441, 168.40666761692708, 267.8603886072499, 213.90796331236706, 124.17924132120368, 231.43704446725934, 63.34348446791769, 164.82322943616253, 100.95781545605833, 192.6461275375021, 19.887349329554755, 38.363775037738804, 35.81596858271153, 113.3458349053624, 230.7853915479533, 54.85288701360539, 39.375153673344265, 203.76325915064663, 1.2486882150991712, 111.99514158105654, 174.21926844518845, 10.863772486422565, 246.3828621771652, 23.366795255903288, 1.686513537743613, 3.0493282149260565, 143.97200227841205, 11.169618052507685, 151.88844071902219, 78.45110531031017, 178.76726219687225, 5.491533832319006, 183.23617029079, 53.44679168121165, 100.62718867369004, 51.62880880817706, 4.512686208328209, 171.62334218999183, 202.77443414774723, 128.4407517753692, 43.32782179174049, 246.32318803637418, 132.52041148399576, 85.60806980806116, 98.80891037849513, 185.52092658311363, 103.72089663179854]}, "sampler_perf": {"mean_raw_obs_processing_ms": 24.612889016885457, "mean_inference_ms": 21.186329230406663, "mean_action_processing_ms": 5.908154806035579, "mean_env_wait_ms": 37.33530745612723, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.09543001651763916, "StateBufferConnector_ms": 0.03673684597015381, "ViewRequirementAgentConnector_ms": 1.255206823348999}, "num_episodes": 0, "episode_return_max": 286.6692231913454, "episode_return_min": -53.94695511723343, "episode_return_mean": 102.60472273081903, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 149312, "num_agent_steps_trained": 149312, "num_env_steps_sampled": 37328, "num_env_steps_trained": 37328, "num_env_steps_sampled_this_iter": 0, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 0.0, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 37328, "num_env_steps_sampled_lifetime": 37328, "num_agent_steps_sampled_lifetime": 149312, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 149312, "timers": {"training_iteration_time_ms": 61572.235, "restore_workers_time_ms": 24.624, "training_step_time_ms": 61482.884, "sample_time_ms": 61458.99, "learn_time_ms": 311236.026, "learn_throughput": 59.967, "synch_weights_time_ms": 43.334}, "counters": {"num_env_steps_sampled": 37328, "num_env_steps_trained": 37328, "num_agent_steps_sampled": 149312, "num_agent_steps_trained": 149312}, "done": false, "training_iteration": 20, "trial_id": "d7bca_00000", "date": "2024-08-20_11-41-41", "timestamp": 1724134301, "time_this_iter_s": 123.25425291061401, "time_total_s": 3015.091106891632, "pid": 36059, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 16000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x32cf64a60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3015.091106891632, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 96.14674556213018, "ram_util_percent": 83.57514792899408}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {}, "num_env_steps_sampled": 37328, "num_env_steps_trained": 37328, "num_agent_steps_sampled": 149312, "num_agent_steps_trained": 149312}, "env_runners": {"episode_reward_max": 286.6692231913454, "episode_reward_min": -53.94695511723343, "episode_reward_mean": 102.60472273081903, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -382.5350217575324, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 179.13622751357744, "predator_policy": 388.3350217575325}, "policy_reward_mean": {"prey_policy": -50.61742331228365, "predator_policy": 101.91978467769317}, "custom_metrics": {}, "hist_stats": {"episode_reward": [35.10000000000023, -2.2956613079459616, 52.30000000000035, 93.99999999999946, 41.27668545957155, 138.35998813581944, 47.000000000000355, 189.59999999999982, 46.100000000000314, 122.59999999999911, 172.99184762314727, 183.89999999999952, 165.26660970450598, 63.400000000000325, 224.23591029611316, 118.26513246444676, 57.049342065984625, 56.287512516221504, 91.49999999999856, 77.70000000000017, 286.6692231913454, 34.20000000000022, 135.4999999999999, 189.7622134181783, 204.95900501687956, 41.46117592104707, 160.52089757879483, 41.90000000000027, 159.99999999999952, 56.25035590474681, 189.40904152072758, 32.4000000000002, 135.49999999999923, 137.09999999999957, -53.94695511723343, 170.90494465410117, 56.10000000000025, 60.20000000000013, 34.75612756781972, 43.60000000000028, 40.265044310772325, 47.1298862953699, 48.40000000000023, 36.202116310375594, 74.49999999999962, 153.19999999999987, 40.1000000000002, 131.19999999999982, 52.570622032848895, 56.000000000000156, 129.1999999999993, 86.20000000000002, 28.831075919194078, 160.79999999999959, 81.33852172443821, 103.01543537877356, 169.88064982359512, 48.30000000000023, 52.529310579969625, 48.028025438635616, 198.59999999999948, 184.470358209413, 37.06861395355878, 80.95181844992561, 33.900000000000134, 135.39999999999944, 148.89999999999955, 133.69999999999916, 226.89999999999938, 68.3000000000002, 154.45814550558052, 41.47674734270453, 180.74087067540847, 60.139037304427255, 153.66325386820998, 109.81254335834268, 96.80000000000011, 108.61895163315396, 159.3546697445331, 53.10000000000013, 125.29999999999959, 34.93780403323022, 139.0999999999999, 206.80167211533725, 40.50000000000029, 68.40000000000009, 88.29999999999927, 242.69999999999993, 37.700000000000266, 104.09999999999903, 229.34134979067687, 152.6250807412044, 157.8592262743011, 37.26670789146122, 35.20000000000023, 108.04468364708873, 87.5999999999994, 92.41177405235972, 131.94864151087714, 94.40623855187317], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [13.573129738316304, -53.54665936669982, -254.04609845621002, -260.27960040372835, -140.65478211067654, -73.1171426718985, 39.583255312047925, -34.03651010327775, -114.83317908671795, -92.66853807147267, -96.4272326280199, 93.09870255859556, -64.80740741555226, 20.000000000000014, 20.626642410773584, -16.792242611230414, 18.848497587615384, -92.85980597895414, 69.17606926139403, -109.36249015041209, -285.2321358475945, 105.74800812423979, 132.7888944272447, -19.35385941243218, -25.356623210719427, 11.326871936077456, -78.03601550180139, -20.07740583328924, 28.904313331271958, 85.71002709904536, -84.17058524148602, -101.59193807470932, -247.8691803256373, -34.87488956710395, -49.40531904969436, -141.19228141836533, -107.134889946308, 73.87102816456981, 4.171128342528487, -6.373188196460497, 72.0443042732162, -52.54708787865346, -32.67477650531073, -33.11217620680012, 17.408091439294907, -110.92817899556306, 80.28766474857159, -53.604483480981195, 64.90005398718623, -328.3984316256627, -221.37365036394135, -15.540567450569034, -217.97172194166885, 76.83739839192134, -62.4215290072797, -67.19987230581766, 82.82590198976501, -215.4723347673664, -63.01766150909464, -253.83034574412602, -72.05610867549865, 89.36722870345912, -103.9034532802869, -142.29070810227037, 0.5594712651248201, 21.887655692545323, -382.5350217575324, 117.78599718266575, -341.68754507993606, -271.3757928143444, 42.05974767402415, -113.91576456218526, 10.584749159468316, -368.0370289653096, -96.60173288891873, 6.578081936680414, -116.41208622158636, -38.927412945968925, -335.88260364800084, 33.30132488528524, -27.102952922490367, -70.03840438982733, -11.808869660467748, -17.067235360537826, 10.174001800704053, -2.962232113254194, -5.251613856427011, -54.123434986458186, -77.75098136410048, -19.99080009629646, 33.88040540161318, 40.0118549587175, 18.203034292193653, -101.55435256341609, 84.66934503983893, -118.51718584134521, -111.25275039532056, -35.27706169307365, 12.962713255211035, -154.80174341253127, -108.368940102753, 45.92361009447094, 66.26530936409696, -54.85406764413665, -50.32982812857711, -6.234569676365133, 43.52535653925046, -20.284647818951065, -122.72911794687963, -30.02930181547257, 64.88866316909824, -29.828281979136015, 27.845266783971347, 9.541578665059246, 1.103496687474779, 7.009962407567832, -8.299879170194934, -72.54471461247661, -97.58563081684744, -33.94553553761412, 161.42330774007206, -112.95182525200485, -6.1055308568346724, 40.28710026868663, -159.2584299113319, 1.9693763855458568, -203.51123731867187, -41.75335832068283, -112.73519084767737, -9.86848498904447, -75.14768969882805, 64.9005559888798, -41.26096743109789, 11.98667537860044, 89.1022150662958, -53.133135240501986, -21.790897701337713, 102.87572050846154, -103.60518017643587, -2.753002690682439, -77.5059788586302, -136.78681328113666, -35.26167272819433, 0.7616669233566751, 99.3892737675306, -121.76317749732668, -221.41484542454427, -0.26256937414734516, -81.64046493632515, 47.835445195899766, 41.62225202827415, -159.27689309555132, 8.414915969460758, -94.96493654962522, -101.89030278114168, -225.75780180988139, 42.3879814213417, -221.12051631037914, -194.2370444672595, -47.443484467917465, -68.94976936260595, -71.53127552961595, -175.21866179031935, -2.377011043507998, 7.336224962261236, 57.5840314172886, 148.94400313475802, -286.27355747273646, -38.05288701360526, -15.675153673344045, -157.06325915064687, 20.451311784900852, -34.19514158105644, -163.71926844518902, 179.13622751357744, -193.68286217716528, -5.466795255903271, 18.11348646225638, 73.35067178507347, -116.27200227841195, 81.3532898949211, -15.069998875773695, -1.5790888906085807, -103.01419787536915, 39.20269946596015, -70.07117731476804, -109.82064133551206, -6.986631127929058, -36.128808808176835, 15.187313791671755, -14.673585565722401, -251.67950712492743, 6.628822658497688, -90.79739622560763, -223.17849208443, -63.253333383580255, -19.653256456869457, -32.815082218808726, 25.002451968907792, -219.83803663194715], "policy_predator_policy_reward": [5.826870261683667, 69.24665936669969, 324.2059226722713, 187.82411487972215, 153.05478211067583, 113.01714267189817, 17.61674468795218, 70.83651010327776, 56.871368154986286, 191.90703446277513, 141.68851820524378, 0.0, 91.80740741555158, 0.0, 54.17335758922649, 131.5922426112305, 1.0515024123846184, 119.05980597895365, 36.62393073860571, 126.16249015041168, 294.04458931930264, 58.43138602720072, 27.098306487098423, 43.366658498089144, 101.5982771707111, 77.69808380843789, 92.33601550180148, 69.17740583328944, 11.711242094735995, 97.91032777106007, 159.598841430636, 144.42881435000547, 256.62014258831397, 83.17326937041157, 64.7437860571049, 182.14132692717635, 121.33488994630724, 3.428971835429686, 17.92887165747148, 61.97318819646065, 71.37501564844887, 195.79699114833366, 50.574776505310986, 49.41217620680031, 95.99190856070484, 133.02817899556257, 118.64992189155714, 44.429110259031575, 173.65858800042827, 294.7987946549283, 219.5255437438939, 58.84984999166302, 153.020176017792, 148.6350451107507, 84.92152900727922, 86.59987230581754, 35.917401426461, 256.72903135113984, 310.86582010807547, 62.23254304989086, 95.58973110505788, 76.50819038770996, 122.80345328028605, 155.79070810226966, 62.740528734875355, 50.312344307454744, 388.3350217575325, 13.51400281733393, 276.4934910271924, 282.6228917498557, 228.37632836739596, 14.384633174866076, 36.51525084053167, 377.03702896531087, 55.843560999739694, 94.38008995249868, 186.75715567238382, 3.338471062991101, 341.8826036480012, 4.298675114714987, 61.56155472910194, 75.84484689398705, 39.31993402285901, 36.68605729351662, 9.025998199295913, 32.16223211325439, 17.067987561023646, 78.50917759223691, 86.89305015310855, 85.34873130728765, 32.98846306649877, 46.31927657317061, 3.2969657078063443, 120.15435256341586, 51.96603493554656, 113.08180586595923, 51.82953263144456, 147.2709014897984, 28.814437033388117, 169.02459312393165, 122.3689401027523, 69.27638990552909, 2.934690635903009, 71.85406764413669, 69.17481916505344, 16.220654559082863, 82.67464346074956, 54.88464781895127, 149.0452344703959, 85.05170701639402, 61.64654055235777, 6.308513636455049, 122.72811266075166, 9.76569171381375, 28.196503312525255, 11.990037592432142, 39.59465245581429, 93.77925190682629, 173.417858483239, 6.14133330985798, 15.762281811455798, 134.36623570047647, 76.06028203580479, 74.22850676175635, 34.695476680536935, 159.6621907988072, 167.2233660646181, 158.99304802466287, 125.23519084767717, 31.268484989044566, 88.54768969882797, 57.09944401112018, 170.03924007813922, 8.135051974358213, 21.451638560862875, 76.27928161334323, 145.09089770133772, 0.7242794915378635, 119.58478321201947, 55.07339965509877, 101.30347201003724, 267.44746563530987, 25.72851731642294, 50.2482358311191, 10.105741511511418, 193.0090328936931, 242.16798791533478, 39.648464187783205, 159.3499139561802, 28.118359652455005, 62.6282279289202, 164.83895649669932, 73.18508403053936, 110.16493654962441, 168.40666761692708, 267.8603886072499, 213.90796331236706, 124.17924132120368, 231.43704446725934, 63.34348446791769, 164.82322943616253, 100.95781545605833, 192.6461275375021, 19.887349329554755, 38.363775037738804, 35.81596858271153, 113.3458349053624, 230.7853915479533, 54.85288701360539, 39.375153673344265, 203.76325915064663, 1.2486882150991712, 111.99514158105654, 174.21926844518845, 10.863772486422565, 246.3828621771652, 23.366795255903288, 1.686513537743613, 3.0493282149260565, 143.97200227841205, 11.169618052507685, 151.88844071902219, 78.45110531031017, 178.76726219687225, 5.491533832319006, 183.23617029079, 53.44679168121165, 100.62718867369004, 51.62880880817706, 4.512686208328209, 171.62334218999183, 202.77443414774723, 128.4407517753692, 43.32782179174049, 246.32318803637418, 132.52041148399576, 85.60806980806116, 98.80891037849513, 185.52092658311363, 103.72089663179854]}, "sampler_perf": {"mean_raw_obs_processing_ms": 24.612889016885457, "mean_inference_ms": 21.186329230406663, "mean_action_processing_ms": 5.908154806035579, "mean_env_wait_ms": 37.33530745612723, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.09543001651763916, "StateBufferConnector_ms": 0.03673684597015381, "ViewRequirementAgentConnector_ms": 1.255206823348999}, "num_episodes": 0, "episode_return_max": 286.6692231913454, "episode_return_min": -53.94695511723343, "episode_return_mean": 102.60472273081903, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 149312, "num_agent_steps_trained": 149312, "num_env_steps_sampled": 37328, "num_env_steps_trained": 37328, "num_env_steps_sampled_this_iter": 0, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 0.0, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 37328, "num_env_steps_sampled_lifetime": 37328, "num_agent_steps_sampled_lifetime": 149312, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 149312, "timers": {"training_iteration_time_ms": 61526.333, "restore_workers_time_ms": 23.416, "training_step_time_ms": 61442.306, "sample_time_ms": 61420.361, "learn_time_ms": 311236.026, "learn_throughput": 59.967, "synch_weights_time_ms": 43.334}, "counters": {"num_env_steps_sampled": 37328, "num_env_steps_trained": 37328, "num_agent_steps_sampled": 149312, "num_agent_steps_trained": 149312}, "done": false, "training_iteration": 21, "trial_id": "d7bca_00000", "date": "2024-08-20_11-43-47", "timestamp": 1724134427, "time_this_iter_s": 123.24071502685547, "time_total_s": 3138.3318219184875, "pid": 36059, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 16000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3ae8cf790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3138.3318219184875, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 96.46607142857142, "ram_util_percent": 83.62380952380953}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {}, "num_env_steps_sampled": 37328, "num_env_steps_trained": 37328, "num_agent_steps_sampled": 149312, "num_agent_steps_trained": 149312}, "env_runners": {"episode_reward_max": 286.6692231913454, "episode_reward_min": -53.94695511723343, "episode_reward_mean": 102.60472273081903, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -382.5350217575324, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 179.13622751357744, "predator_policy": 388.3350217575325}, "policy_reward_mean": {"prey_policy": -50.61742331228365, "predator_policy": 101.91978467769317}, "custom_metrics": {}, "hist_stats": {"episode_reward": [35.10000000000023, -2.2956613079459616, 52.30000000000035, 93.99999999999946, 41.27668545957155, 138.35998813581944, 47.000000000000355, 189.59999999999982, 46.100000000000314, 122.59999999999911, 172.99184762314727, 183.89999999999952, 165.26660970450598, 63.400000000000325, 224.23591029611316, 118.26513246444676, 57.049342065984625, 56.287512516221504, 91.49999999999856, 77.70000000000017, 286.6692231913454, 34.20000000000022, 135.4999999999999, 189.7622134181783, 204.95900501687956, 41.46117592104707, 160.52089757879483, 41.90000000000027, 159.99999999999952, 56.25035590474681, 189.40904152072758, 32.4000000000002, 135.49999999999923, 137.09999999999957, -53.94695511723343, 170.90494465410117, 56.10000000000025, 60.20000000000013, 34.75612756781972, 43.60000000000028, 40.265044310772325, 47.1298862953699, 48.40000000000023, 36.202116310375594, 74.49999999999962, 153.19999999999987, 40.1000000000002, 131.19999999999982, 52.570622032848895, 56.000000000000156, 129.1999999999993, 86.20000000000002, 28.831075919194078, 160.79999999999959, 81.33852172443821, 103.01543537877356, 169.88064982359512, 48.30000000000023, 52.529310579969625, 48.028025438635616, 198.59999999999948, 184.470358209413, 37.06861395355878, 80.95181844992561, 33.900000000000134, 135.39999999999944, 148.89999999999955, 133.69999999999916, 226.89999999999938, 68.3000000000002, 154.45814550558052, 41.47674734270453, 180.74087067540847, 60.139037304427255, 153.66325386820998, 109.81254335834268, 96.80000000000011, 108.61895163315396, 159.3546697445331, 53.10000000000013, 125.29999999999959, 34.93780403323022, 139.0999999999999, 206.80167211533725, 40.50000000000029, 68.40000000000009, 88.29999999999927, 242.69999999999993, 37.700000000000266, 104.09999999999903, 229.34134979067687, 152.6250807412044, 157.8592262743011, 37.26670789146122, 35.20000000000023, 108.04468364708873, 87.5999999999994, 92.41177405235972, 131.94864151087714, 94.40623855187317], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [13.573129738316304, -53.54665936669982, -254.04609845621002, -260.27960040372835, -140.65478211067654, -73.1171426718985, 39.583255312047925, -34.03651010327775, -114.83317908671795, -92.66853807147267, -96.4272326280199, 93.09870255859556, -64.80740741555226, 20.000000000000014, 20.626642410773584, -16.792242611230414, 18.848497587615384, -92.85980597895414, 69.17606926139403, -109.36249015041209, -285.2321358475945, 105.74800812423979, 132.7888944272447, -19.35385941243218, -25.356623210719427, 11.326871936077456, -78.03601550180139, -20.07740583328924, 28.904313331271958, 85.71002709904536, -84.17058524148602, -101.59193807470932, -247.8691803256373, -34.87488956710395, -49.40531904969436, -141.19228141836533, -107.134889946308, 73.87102816456981, 4.171128342528487, -6.373188196460497, 72.0443042732162, -52.54708787865346, -32.67477650531073, -33.11217620680012, 17.408091439294907, -110.92817899556306, 80.28766474857159, -53.604483480981195, 64.90005398718623, -328.3984316256627, -221.37365036394135, -15.540567450569034, -217.97172194166885, 76.83739839192134, -62.4215290072797, -67.19987230581766, 82.82590198976501, -215.4723347673664, -63.01766150909464, -253.83034574412602, -72.05610867549865, 89.36722870345912, -103.9034532802869, -142.29070810227037, 0.5594712651248201, 21.887655692545323, -382.5350217575324, 117.78599718266575, -341.68754507993606, -271.3757928143444, 42.05974767402415, -113.91576456218526, 10.584749159468316, -368.0370289653096, -96.60173288891873, 6.578081936680414, -116.41208622158636, -38.927412945968925, -335.88260364800084, 33.30132488528524, -27.102952922490367, -70.03840438982733, -11.808869660467748, -17.067235360537826, 10.174001800704053, -2.962232113254194, -5.251613856427011, -54.123434986458186, -77.75098136410048, -19.99080009629646, 33.88040540161318, 40.0118549587175, 18.203034292193653, -101.55435256341609, 84.66934503983893, -118.51718584134521, -111.25275039532056, -35.27706169307365, 12.962713255211035, -154.80174341253127, -108.368940102753, 45.92361009447094, 66.26530936409696, -54.85406764413665, -50.32982812857711, -6.234569676365133, 43.52535653925046, -20.284647818951065, -122.72911794687963, -30.02930181547257, 64.88866316909824, -29.828281979136015, 27.845266783971347, 9.541578665059246, 1.103496687474779, 7.009962407567832, -8.299879170194934, -72.54471461247661, -97.58563081684744, -33.94553553761412, 161.42330774007206, -112.95182525200485, -6.1055308568346724, 40.28710026868663, -159.2584299113319, 1.9693763855458568, -203.51123731867187, -41.75335832068283, -112.73519084767737, -9.86848498904447, -75.14768969882805, 64.9005559888798, -41.26096743109789, 11.98667537860044, 89.1022150662958, -53.133135240501986, -21.790897701337713, 102.87572050846154, -103.60518017643587, -2.753002690682439, -77.5059788586302, -136.78681328113666, -35.26167272819433, 0.7616669233566751, 99.3892737675306, -121.76317749732668, -221.41484542454427, -0.26256937414734516, -81.64046493632515, 47.835445195899766, 41.62225202827415, -159.27689309555132, 8.414915969460758, -94.96493654962522, -101.89030278114168, -225.75780180988139, 42.3879814213417, -221.12051631037914, -194.2370444672595, -47.443484467917465, -68.94976936260595, -71.53127552961595, -175.21866179031935, -2.377011043507998, 7.336224962261236, 57.5840314172886, 148.94400313475802, -286.27355747273646, -38.05288701360526, -15.675153673344045, -157.06325915064687, 20.451311784900852, -34.19514158105644, -163.71926844518902, 179.13622751357744, -193.68286217716528, -5.466795255903271, 18.11348646225638, 73.35067178507347, -116.27200227841195, 81.3532898949211, -15.069998875773695, -1.5790888906085807, -103.01419787536915, 39.20269946596015, -70.07117731476804, -109.82064133551206, -6.986631127929058, -36.128808808176835, 15.187313791671755, -14.673585565722401, -251.67950712492743, 6.628822658497688, -90.79739622560763, -223.17849208443, -63.253333383580255, -19.653256456869457, -32.815082218808726, 25.002451968907792, -219.83803663194715], "policy_predator_policy_reward": [5.826870261683667, 69.24665936669969, 324.2059226722713, 187.82411487972215, 153.05478211067583, 113.01714267189817, 17.61674468795218, 70.83651010327776, 56.871368154986286, 191.90703446277513, 141.68851820524378, 0.0, 91.80740741555158, 0.0, 54.17335758922649, 131.5922426112305, 1.0515024123846184, 119.05980597895365, 36.62393073860571, 126.16249015041168, 294.04458931930264, 58.43138602720072, 27.098306487098423, 43.366658498089144, 101.5982771707111, 77.69808380843789, 92.33601550180148, 69.17740583328944, 11.711242094735995, 97.91032777106007, 159.598841430636, 144.42881435000547, 256.62014258831397, 83.17326937041157, 64.7437860571049, 182.14132692717635, 121.33488994630724, 3.428971835429686, 17.92887165747148, 61.97318819646065, 71.37501564844887, 195.79699114833366, 50.574776505310986, 49.41217620680031, 95.99190856070484, 133.02817899556257, 118.64992189155714, 44.429110259031575, 173.65858800042827, 294.7987946549283, 219.5255437438939, 58.84984999166302, 153.020176017792, 148.6350451107507, 84.92152900727922, 86.59987230581754, 35.917401426461, 256.72903135113984, 310.86582010807547, 62.23254304989086, 95.58973110505788, 76.50819038770996, 122.80345328028605, 155.79070810226966, 62.740528734875355, 50.312344307454744, 388.3350217575325, 13.51400281733393, 276.4934910271924, 282.6228917498557, 228.37632836739596, 14.384633174866076, 36.51525084053167, 377.03702896531087, 55.843560999739694, 94.38008995249868, 186.75715567238382, 3.338471062991101, 341.8826036480012, 4.298675114714987, 61.56155472910194, 75.84484689398705, 39.31993402285901, 36.68605729351662, 9.025998199295913, 32.16223211325439, 17.067987561023646, 78.50917759223691, 86.89305015310855, 85.34873130728765, 32.98846306649877, 46.31927657317061, 3.2969657078063443, 120.15435256341586, 51.96603493554656, 113.08180586595923, 51.82953263144456, 147.2709014897984, 28.814437033388117, 169.02459312393165, 122.3689401027523, 69.27638990552909, 2.934690635903009, 71.85406764413669, 69.17481916505344, 16.220654559082863, 82.67464346074956, 54.88464781895127, 149.0452344703959, 85.05170701639402, 61.64654055235777, 6.308513636455049, 122.72811266075166, 9.76569171381375, 28.196503312525255, 11.990037592432142, 39.59465245581429, 93.77925190682629, 173.417858483239, 6.14133330985798, 15.762281811455798, 134.36623570047647, 76.06028203580479, 74.22850676175635, 34.695476680536935, 159.6621907988072, 167.2233660646181, 158.99304802466287, 125.23519084767717, 31.268484989044566, 88.54768969882797, 57.09944401112018, 170.03924007813922, 8.135051974358213, 21.451638560862875, 76.27928161334323, 145.09089770133772, 0.7242794915378635, 119.58478321201947, 55.07339965509877, 101.30347201003724, 267.44746563530987, 25.72851731642294, 50.2482358311191, 10.105741511511418, 193.0090328936931, 242.16798791533478, 39.648464187783205, 159.3499139561802, 28.118359652455005, 62.6282279289202, 164.83895649669932, 73.18508403053936, 110.16493654962441, 168.40666761692708, 267.8603886072499, 213.90796331236706, 124.17924132120368, 231.43704446725934, 63.34348446791769, 164.82322943616253, 100.95781545605833, 192.6461275375021, 19.887349329554755, 38.363775037738804, 35.81596858271153, 113.3458349053624, 230.7853915479533, 54.85288701360539, 39.375153673344265, 203.76325915064663, 1.2486882150991712, 111.99514158105654, 174.21926844518845, 10.863772486422565, 246.3828621771652, 23.366795255903288, 1.686513537743613, 3.0493282149260565, 143.97200227841205, 11.169618052507685, 151.88844071902219, 78.45110531031017, 178.76726219687225, 5.491533832319006, 183.23617029079, 53.44679168121165, 100.62718867369004, 51.62880880817706, 4.512686208328209, 171.62334218999183, 202.77443414774723, 128.4407517753692, 43.32782179174049, 246.32318803637418, 132.52041148399576, 85.60806980806116, 98.80891037849513, 185.52092658311363, 103.72089663179854]}, "sampler_perf": {"mean_raw_obs_processing_ms": 24.612889016885457, "mean_inference_ms": 21.186329230406663, "mean_action_processing_ms": 5.908154806035579, "mean_env_wait_ms": 37.33530745612723, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.09543001651763916, "StateBufferConnector_ms": 0.03673684597015381, "ViewRequirementAgentConnector_ms": 1.255206823348999}, "num_episodes": 0, "episode_return_max": 286.6692231913454, "episode_return_min": -53.94695511723343, "episode_return_mean": 102.60472273081903, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 149312, "num_agent_steps_trained": 149312, "num_env_steps_sampled": 37328, "num_env_steps_trained": 37328, "num_env_steps_sampled_this_iter": 0, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 0.0, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 37328, "num_env_steps_sampled_lifetime": 37328, "num_agent_steps_sampled_lifetime": 149312, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 149312, "timers": {"training_iteration_time_ms": 61482.294, "restore_workers_time_ms": 24.329, "training_step_time_ms": 61398.04, "sample_time_ms": 61376.762, "learn_time_ms": 311236.026, "learn_throughput": 59.967, "synch_weights_time_ms": 43.334}, "counters": {"num_env_steps_sampled": 37328, "num_env_steps_trained": 37328, "num_agent_steps_sampled": 149312, "num_agent_steps_trained": 149312}, "done": false, "training_iteration": 22, "trial_id": "d7bca_00000", "date": "2024-08-20_11-45-53", "timestamp": 1724134553, "time_this_iter_s": 123.32634592056274, "time_total_s": 3261.6581678390503, "pid": 36059, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 16000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x32ce5cc10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3261.6581678390503, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 96.33254437869823, "ram_util_percent": 83.57869822485209}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {}, "num_env_steps_sampled": 37328, "num_env_steps_trained": 37328, "num_agent_steps_sampled": 149312, "num_agent_steps_trained": 149312}, "env_runners": {"episode_reward_max": 286.6692231913454, "episode_reward_min": -53.94695511723343, "episode_reward_mean": 102.60472273081903, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -382.5350217575324, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 179.13622751357744, "predator_policy": 388.3350217575325}, "policy_reward_mean": {"prey_policy": -50.61742331228365, "predator_policy": 101.91978467769317}, "custom_metrics": {}, "hist_stats": {"episode_reward": [35.10000000000023, -2.2956613079459616, 52.30000000000035, 93.99999999999946, 41.27668545957155, 138.35998813581944, 47.000000000000355, 189.59999999999982, 46.100000000000314, 122.59999999999911, 172.99184762314727, 183.89999999999952, 165.26660970450598, 63.400000000000325, 224.23591029611316, 118.26513246444676, 57.049342065984625, 56.287512516221504, 91.49999999999856, 77.70000000000017, 286.6692231913454, 34.20000000000022, 135.4999999999999, 189.7622134181783, 204.95900501687956, 41.46117592104707, 160.52089757879483, 41.90000000000027, 159.99999999999952, 56.25035590474681, 189.40904152072758, 32.4000000000002, 135.49999999999923, 137.09999999999957, -53.94695511723343, 170.90494465410117, 56.10000000000025, 60.20000000000013, 34.75612756781972, 43.60000000000028, 40.265044310772325, 47.1298862953699, 48.40000000000023, 36.202116310375594, 74.49999999999962, 153.19999999999987, 40.1000000000002, 131.19999999999982, 52.570622032848895, 56.000000000000156, 129.1999999999993, 86.20000000000002, 28.831075919194078, 160.79999999999959, 81.33852172443821, 103.01543537877356, 169.88064982359512, 48.30000000000023, 52.529310579969625, 48.028025438635616, 198.59999999999948, 184.470358209413, 37.06861395355878, 80.95181844992561, 33.900000000000134, 135.39999999999944, 148.89999999999955, 133.69999999999916, 226.89999999999938, 68.3000000000002, 154.45814550558052, 41.47674734270453, 180.74087067540847, 60.139037304427255, 153.66325386820998, 109.81254335834268, 96.80000000000011, 108.61895163315396, 159.3546697445331, 53.10000000000013, 125.29999999999959, 34.93780403323022, 139.0999999999999, 206.80167211533725, 40.50000000000029, 68.40000000000009, 88.29999999999927, 242.69999999999993, 37.700000000000266, 104.09999999999903, 229.34134979067687, 152.6250807412044, 157.8592262743011, 37.26670789146122, 35.20000000000023, 108.04468364708873, 87.5999999999994, 92.41177405235972, 131.94864151087714, 94.40623855187317], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [13.573129738316304, -53.54665936669982, -254.04609845621002, -260.27960040372835, -140.65478211067654, -73.1171426718985, 39.583255312047925, -34.03651010327775, -114.83317908671795, -92.66853807147267, -96.4272326280199, 93.09870255859556, -64.80740741555226, 20.000000000000014, 20.626642410773584, -16.792242611230414, 18.848497587615384, -92.85980597895414, 69.17606926139403, -109.36249015041209, -285.2321358475945, 105.74800812423979, 132.7888944272447, -19.35385941243218, -25.356623210719427, 11.326871936077456, -78.03601550180139, -20.07740583328924, 28.904313331271958, 85.71002709904536, -84.17058524148602, -101.59193807470932, -247.8691803256373, -34.87488956710395, -49.40531904969436, -141.19228141836533, -107.134889946308, 73.87102816456981, 4.171128342528487, -6.373188196460497, 72.0443042732162, -52.54708787865346, -32.67477650531073, -33.11217620680012, 17.408091439294907, -110.92817899556306, 80.28766474857159, -53.604483480981195, 64.90005398718623, -328.3984316256627, -221.37365036394135, -15.540567450569034, -217.97172194166885, 76.83739839192134, -62.4215290072797, -67.19987230581766, 82.82590198976501, -215.4723347673664, -63.01766150909464, -253.83034574412602, -72.05610867549865, 89.36722870345912, -103.9034532802869, -142.29070810227037, 0.5594712651248201, 21.887655692545323, -382.5350217575324, 117.78599718266575, -341.68754507993606, -271.3757928143444, 42.05974767402415, -113.91576456218526, 10.584749159468316, -368.0370289653096, -96.60173288891873, 6.578081936680414, -116.41208622158636, -38.927412945968925, -335.88260364800084, 33.30132488528524, -27.102952922490367, -70.03840438982733, -11.808869660467748, -17.067235360537826, 10.174001800704053, -2.962232113254194, -5.251613856427011, -54.123434986458186, -77.75098136410048, -19.99080009629646, 33.88040540161318, 40.0118549587175, 18.203034292193653, -101.55435256341609, 84.66934503983893, -118.51718584134521, -111.25275039532056, -35.27706169307365, 12.962713255211035, -154.80174341253127, -108.368940102753, 45.92361009447094, 66.26530936409696, -54.85406764413665, -50.32982812857711, -6.234569676365133, 43.52535653925046, -20.284647818951065, -122.72911794687963, -30.02930181547257, 64.88866316909824, -29.828281979136015, 27.845266783971347, 9.541578665059246, 1.103496687474779, 7.009962407567832, -8.299879170194934, -72.54471461247661, -97.58563081684744, -33.94553553761412, 161.42330774007206, -112.95182525200485, -6.1055308568346724, 40.28710026868663, -159.2584299113319, 1.9693763855458568, -203.51123731867187, -41.75335832068283, -112.73519084767737, -9.86848498904447, -75.14768969882805, 64.9005559888798, -41.26096743109789, 11.98667537860044, 89.1022150662958, -53.133135240501986, -21.790897701337713, 102.87572050846154, -103.60518017643587, -2.753002690682439, -77.5059788586302, -136.78681328113666, -35.26167272819433, 0.7616669233566751, 99.3892737675306, -121.76317749732668, -221.41484542454427, -0.26256937414734516, -81.64046493632515, 47.835445195899766, 41.62225202827415, -159.27689309555132, 8.414915969460758, -94.96493654962522, -101.89030278114168, -225.75780180988139, 42.3879814213417, -221.12051631037914, -194.2370444672595, -47.443484467917465, -68.94976936260595, -71.53127552961595, -175.21866179031935, -2.377011043507998, 7.336224962261236, 57.5840314172886, 148.94400313475802, -286.27355747273646, -38.05288701360526, -15.675153673344045, -157.06325915064687, 20.451311784900852, -34.19514158105644, -163.71926844518902, 179.13622751357744, -193.68286217716528, -5.466795255903271, 18.11348646225638, 73.35067178507347, -116.27200227841195, 81.3532898949211, -15.069998875773695, -1.5790888906085807, -103.01419787536915, 39.20269946596015, -70.07117731476804, -109.82064133551206, -6.986631127929058, -36.128808808176835, 15.187313791671755, -14.673585565722401, -251.67950712492743, 6.628822658497688, -90.79739622560763, -223.17849208443, -63.253333383580255, -19.653256456869457, -32.815082218808726, 25.002451968907792, -219.83803663194715], "policy_predator_policy_reward": [5.826870261683667, 69.24665936669969, 324.2059226722713, 187.82411487972215, 153.05478211067583, 113.01714267189817, 17.61674468795218, 70.83651010327776, 56.871368154986286, 191.90703446277513, 141.68851820524378, 0.0, 91.80740741555158, 0.0, 54.17335758922649, 131.5922426112305, 1.0515024123846184, 119.05980597895365, 36.62393073860571, 126.16249015041168, 294.04458931930264, 58.43138602720072, 27.098306487098423, 43.366658498089144, 101.5982771707111, 77.69808380843789, 92.33601550180148, 69.17740583328944, 11.711242094735995, 97.91032777106007, 159.598841430636, 144.42881435000547, 256.62014258831397, 83.17326937041157, 64.7437860571049, 182.14132692717635, 121.33488994630724, 3.428971835429686, 17.92887165747148, 61.97318819646065, 71.37501564844887, 195.79699114833366, 50.574776505310986, 49.41217620680031, 95.99190856070484, 133.02817899556257, 118.64992189155714, 44.429110259031575, 173.65858800042827, 294.7987946549283, 219.5255437438939, 58.84984999166302, 153.020176017792, 148.6350451107507, 84.92152900727922, 86.59987230581754, 35.917401426461, 256.72903135113984, 310.86582010807547, 62.23254304989086, 95.58973110505788, 76.50819038770996, 122.80345328028605, 155.79070810226966, 62.740528734875355, 50.312344307454744, 388.3350217575325, 13.51400281733393, 276.4934910271924, 282.6228917498557, 228.37632836739596, 14.384633174866076, 36.51525084053167, 377.03702896531087, 55.843560999739694, 94.38008995249868, 186.75715567238382, 3.338471062991101, 341.8826036480012, 4.298675114714987, 61.56155472910194, 75.84484689398705, 39.31993402285901, 36.68605729351662, 9.025998199295913, 32.16223211325439, 17.067987561023646, 78.50917759223691, 86.89305015310855, 85.34873130728765, 32.98846306649877, 46.31927657317061, 3.2969657078063443, 120.15435256341586, 51.96603493554656, 113.08180586595923, 51.82953263144456, 147.2709014897984, 28.814437033388117, 169.02459312393165, 122.3689401027523, 69.27638990552909, 2.934690635903009, 71.85406764413669, 69.17481916505344, 16.220654559082863, 82.67464346074956, 54.88464781895127, 149.0452344703959, 85.05170701639402, 61.64654055235777, 6.308513636455049, 122.72811266075166, 9.76569171381375, 28.196503312525255, 11.990037592432142, 39.59465245581429, 93.77925190682629, 173.417858483239, 6.14133330985798, 15.762281811455798, 134.36623570047647, 76.06028203580479, 74.22850676175635, 34.695476680536935, 159.6621907988072, 167.2233660646181, 158.99304802466287, 125.23519084767717, 31.268484989044566, 88.54768969882797, 57.09944401112018, 170.03924007813922, 8.135051974358213, 21.451638560862875, 76.27928161334323, 145.09089770133772, 0.7242794915378635, 119.58478321201947, 55.07339965509877, 101.30347201003724, 267.44746563530987, 25.72851731642294, 50.2482358311191, 10.105741511511418, 193.0090328936931, 242.16798791533478, 39.648464187783205, 159.3499139561802, 28.118359652455005, 62.6282279289202, 164.83895649669932, 73.18508403053936, 110.16493654962441, 168.40666761692708, 267.8603886072499, 213.90796331236706, 124.17924132120368, 231.43704446725934, 63.34348446791769, 164.82322943616253, 100.95781545605833, 192.6461275375021, 19.887349329554755, 38.363775037738804, 35.81596858271153, 113.3458349053624, 230.7853915479533, 54.85288701360539, 39.375153673344265, 203.76325915064663, 1.2486882150991712, 111.99514158105654, 174.21926844518845, 10.863772486422565, 246.3828621771652, 23.366795255903288, 1.686513537743613, 3.0493282149260565, 143.97200227841205, 11.169618052507685, 151.88844071902219, 78.45110531031017, 178.76726219687225, 5.491533832319006, 183.23617029079, 53.44679168121165, 100.62718867369004, 51.62880880817706, 4.512686208328209, 171.62334218999183, 202.77443414774723, 128.4407517753692, 43.32782179174049, 246.32318803637418, 132.52041148399576, 85.60806980806116, 98.80891037849513, 185.52092658311363, 103.72089663179854]}, "sampler_perf": {"mean_raw_obs_processing_ms": 24.612889016885457, "mean_inference_ms": 21.186329230406663, "mean_action_processing_ms": 5.908154806035579, "mean_env_wait_ms": 37.33530745612723, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.09543001651763916, "StateBufferConnector_ms": 0.03673684597015381, "ViewRequirementAgentConnector_ms": 1.255206823348999}, "num_episodes": 0, "episode_return_max": 286.6692231913454, "episode_return_min": -53.94695511723343, "episode_return_mean": 102.60472273081903, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 149312, "num_agent_steps_trained": 149312, "num_env_steps_sampled": 37328, "num_env_steps_trained": 37328, "num_env_steps_sampled_this_iter": 0, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 0.0, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 37328, "num_env_steps_sampled_lifetime": 37328, "num_agent_steps_sampled_lifetime": 149312, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 149312, "timers": {"training_iteration_time_ms": 61449.683, "restore_workers_time_ms": 24.2, "training_step_time_ms": 61377.131, "sample_time_ms": 61355.841, "learn_time_ms": 311236.026, "learn_throughput": 59.967, "synch_weights_time_ms": 43.334}, "counters": {"num_env_steps_sampled": 37328, "num_env_steps_trained": 37328, "num_agent_steps_sampled": 149312, "num_agent_steps_trained": 149312}, "done": false, "training_iteration": 23, "trial_id": "d7bca_00000", "date": "2024-08-20_11-47-58", "timestamp": 1724134678, "time_this_iter_s": 122.74750781059265, "time_total_s": 3384.405675649643, "pid": 36059, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 16000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b0d8c0d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3384.405675649643, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 97.42690058479532, "ram_util_percent": 83.59122807017545}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {}, "num_env_steps_sampled": 37328, "num_env_steps_trained": 37328, "num_agent_steps_sampled": 149312, "num_agent_steps_trained": 149312}, "env_runners": {"episode_reward_max": 286.6692231913454, "episode_reward_min": -53.94695511723343, "episode_reward_mean": 102.60472273081903, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -382.5350217575324, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 179.13622751357744, "predator_policy": 388.3350217575325}, "policy_reward_mean": {"prey_policy": -50.61742331228365, "predator_policy": 101.91978467769317}, "custom_metrics": {}, "hist_stats": {"episode_reward": [35.10000000000023, -2.2956613079459616, 52.30000000000035, 93.99999999999946, 41.27668545957155, 138.35998813581944, 47.000000000000355, 189.59999999999982, 46.100000000000314, 122.59999999999911, 172.99184762314727, 183.89999999999952, 165.26660970450598, 63.400000000000325, 224.23591029611316, 118.26513246444676, 57.049342065984625, 56.287512516221504, 91.49999999999856, 77.70000000000017, 286.6692231913454, 34.20000000000022, 135.4999999999999, 189.7622134181783, 204.95900501687956, 41.46117592104707, 160.52089757879483, 41.90000000000027, 159.99999999999952, 56.25035590474681, 189.40904152072758, 32.4000000000002, 135.49999999999923, 137.09999999999957, -53.94695511723343, 170.90494465410117, 56.10000000000025, 60.20000000000013, 34.75612756781972, 43.60000000000028, 40.265044310772325, 47.1298862953699, 48.40000000000023, 36.202116310375594, 74.49999999999962, 153.19999999999987, 40.1000000000002, 131.19999999999982, 52.570622032848895, 56.000000000000156, 129.1999999999993, 86.20000000000002, 28.831075919194078, 160.79999999999959, 81.33852172443821, 103.01543537877356, 169.88064982359512, 48.30000000000023, 52.529310579969625, 48.028025438635616, 198.59999999999948, 184.470358209413, 37.06861395355878, 80.95181844992561, 33.900000000000134, 135.39999999999944, 148.89999999999955, 133.69999999999916, 226.89999999999938, 68.3000000000002, 154.45814550558052, 41.47674734270453, 180.74087067540847, 60.139037304427255, 153.66325386820998, 109.81254335834268, 96.80000000000011, 108.61895163315396, 159.3546697445331, 53.10000000000013, 125.29999999999959, 34.93780403323022, 139.0999999999999, 206.80167211533725, 40.50000000000029, 68.40000000000009, 88.29999999999927, 242.69999999999993, 37.700000000000266, 104.09999999999903, 229.34134979067687, 152.6250807412044, 157.8592262743011, 37.26670789146122, 35.20000000000023, 108.04468364708873, 87.5999999999994, 92.41177405235972, 131.94864151087714, 94.40623855187317], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [13.573129738316304, -53.54665936669982, -254.04609845621002, -260.27960040372835, -140.65478211067654, -73.1171426718985, 39.583255312047925, -34.03651010327775, -114.83317908671795, -92.66853807147267, -96.4272326280199, 93.09870255859556, -64.80740741555226, 20.000000000000014, 20.626642410773584, -16.792242611230414, 18.848497587615384, -92.85980597895414, 69.17606926139403, -109.36249015041209, -285.2321358475945, 105.74800812423979, 132.7888944272447, -19.35385941243218, -25.356623210719427, 11.326871936077456, -78.03601550180139, -20.07740583328924, 28.904313331271958, 85.71002709904536, -84.17058524148602, -101.59193807470932, -247.8691803256373, -34.87488956710395, -49.40531904969436, -141.19228141836533, -107.134889946308, 73.87102816456981, 4.171128342528487, -6.373188196460497, 72.0443042732162, -52.54708787865346, -32.67477650531073, -33.11217620680012, 17.408091439294907, -110.92817899556306, 80.28766474857159, -53.604483480981195, 64.90005398718623, -328.3984316256627, -221.37365036394135, -15.540567450569034, -217.97172194166885, 76.83739839192134, -62.4215290072797, -67.19987230581766, 82.82590198976501, -215.4723347673664, -63.01766150909464, -253.83034574412602, -72.05610867549865, 89.36722870345912, -103.9034532802869, -142.29070810227037, 0.5594712651248201, 21.887655692545323, -382.5350217575324, 117.78599718266575, -341.68754507993606, -271.3757928143444, 42.05974767402415, -113.91576456218526, 10.584749159468316, -368.0370289653096, -96.60173288891873, 6.578081936680414, -116.41208622158636, -38.927412945968925, -335.88260364800084, 33.30132488528524, -27.102952922490367, -70.03840438982733, -11.808869660467748, -17.067235360537826, 10.174001800704053, -2.962232113254194, -5.251613856427011, -54.123434986458186, -77.75098136410048, -19.99080009629646, 33.88040540161318, 40.0118549587175, 18.203034292193653, -101.55435256341609, 84.66934503983893, -118.51718584134521, -111.25275039532056, -35.27706169307365, 12.962713255211035, -154.80174341253127, -108.368940102753, 45.92361009447094, 66.26530936409696, -54.85406764413665, -50.32982812857711, -6.234569676365133, 43.52535653925046, -20.284647818951065, -122.72911794687963, -30.02930181547257, 64.88866316909824, -29.828281979136015, 27.845266783971347, 9.541578665059246, 1.103496687474779, 7.009962407567832, -8.299879170194934, -72.54471461247661, -97.58563081684744, -33.94553553761412, 161.42330774007206, -112.95182525200485, -6.1055308568346724, 40.28710026868663, -159.2584299113319, 1.9693763855458568, -203.51123731867187, -41.75335832068283, -112.73519084767737, -9.86848498904447, -75.14768969882805, 64.9005559888798, -41.26096743109789, 11.98667537860044, 89.1022150662958, -53.133135240501986, -21.790897701337713, 102.87572050846154, -103.60518017643587, -2.753002690682439, -77.5059788586302, -136.78681328113666, -35.26167272819433, 0.7616669233566751, 99.3892737675306, -121.76317749732668, -221.41484542454427, -0.26256937414734516, -81.64046493632515, 47.835445195899766, 41.62225202827415, -159.27689309555132, 8.414915969460758, -94.96493654962522, -101.89030278114168, -225.75780180988139, 42.3879814213417, -221.12051631037914, -194.2370444672595, -47.443484467917465, -68.94976936260595, -71.53127552961595, -175.21866179031935, -2.377011043507998, 7.336224962261236, 57.5840314172886, 148.94400313475802, -286.27355747273646, -38.05288701360526, -15.675153673344045, -157.06325915064687, 20.451311784900852, -34.19514158105644, -163.71926844518902, 179.13622751357744, -193.68286217716528, -5.466795255903271, 18.11348646225638, 73.35067178507347, -116.27200227841195, 81.3532898949211, -15.069998875773695, -1.5790888906085807, -103.01419787536915, 39.20269946596015, -70.07117731476804, -109.82064133551206, -6.986631127929058, -36.128808808176835, 15.187313791671755, -14.673585565722401, -251.67950712492743, 6.628822658497688, -90.79739622560763, -223.17849208443, -63.253333383580255, -19.653256456869457, -32.815082218808726, 25.002451968907792, -219.83803663194715], "policy_predator_policy_reward": [5.826870261683667, 69.24665936669969, 324.2059226722713, 187.82411487972215, 153.05478211067583, 113.01714267189817, 17.61674468795218, 70.83651010327776, 56.871368154986286, 191.90703446277513, 141.68851820524378, 0.0, 91.80740741555158, 0.0, 54.17335758922649, 131.5922426112305, 1.0515024123846184, 119.05980597895365, 36.62393073860571, 126.16249015041168, 294.04458931930264, 58.43138602720072, 27.098306487098423, 43.366658498089144, 101.5982771707111, 77.69808380843789, 92.33601550180148, 69.17740583328944, 11.711242094735995, 97.91032777106007, 159.598841430636, 144.42881435000547, 256.62014258831397, 83.17326937041157, 64.7437860571049, 182.14132692717635, 121.33488994630724, 3.428971835429686, 17.92887165747148, 61.97318819646065, 71.37501564844887, 195.79699114833366, 50.574776505310986, 49.41217620680031, 95.99190856070484, 133.02817899556257, 118.64992189155714, 44.429110259031575, 173.65858800042827, 294.7987946549283, 219.5255437438939, 58.84984999166302, 153.020176017792, 148.6350451107507, 84.92152900727922, 86.59987230581754, 35.917401426461, 256.72903135113984, 310.86582010807547, 62.23254304989086, 95.58973110505788, 76.50819038770996, 122.80345328028605, 155.79070810226966, 62.740528734875355, 50.312344307454744, 388.3350217575325, 13.51400281733393, 276.4934910271924, 282.6228917498557, 228.37632836739596, 14.384633174866076, 36.51525084053167, 377.03702896531087, 55.843560999739694, 94.38008995249868, 186.75715567238382, 3.338471062991101, 341.8826036480012, 4.298675114714987, 61.56155472910194, 75.84484689398705, 39.31993402285901, 36.68605729351662, 9.025998199295913, 32.16223211325439, 17.067987561023646, 78.50917759223691, 86.89305015310855, 85.34873130728765, 32.98846306649877, 46.31927657317061, 3.2969657078063443, 120.15435256341586, 51.96603493554656, 113.08180586595923, 51.82953263144456, 147.2709014897984, 28.814437033388117, 169.02459312393165, 122.3689401027523, 69.27638990552909, 2.934690635903009, 71.85406764413669, 69.17481916505344, 16.220654559082863, 82.67464346074956, 54.88464781895127, 149.0452344703959, 85.05170701639402, 61.64654055235777, 6.308513636455049, 122.72811266075166, 9.76569171381375, 28.196503312525255, 11.990037592432142, 39.59465245581429, 93.77925190682629, 173.417858483239, 6.14133330985798, 15.762281811455798, 134.36623570047647, 76.06028203580479, 74.22850676175635, 34.695476680536935, 159.6621907988072, 167.2233660646181, 158.99304802466287, 125.23519084767717, 31.268484989044566, 88.54768969882797, 57.09944401112018, 170.03924007813922, 8.135051974358213, 21.451638560862875, 76.27928161334323, 145.09089770133772, 0.7242794915378635, 119.58478321201947, 55.07339965509877, 101.30347201003724, 267.44746563530987, 25.72851731642294, 50.2482358311191, 10.105741511511418, 193.0090328936931, 242.16798791533478, 39.648464187783205, 159.3499139561802, 28.118359652455005, 62.6282279289202, 164.83895649669932, 73.18508403053936, 110.16493654962441, 168.40666761692708, 267.8603886072499, 213.90796331236706, 124.17924132120368, 231.43704446725934, 63.34348446791769, 164.82322943616253, 100.95781545605833, 192.6461275375021, 19.887349329554755, 38.363775037738804, 35.81596858271153, 113.3458349053624, 230.7853915479533, 54.85288701360539, 39.375153673344265, 203.76325915064663, 1.2486882150991712, 111.99514158105654, 174.21926844518845, 10.863772486422565, 246.3828621771652, 23.366795255903288, 1.686513537743613, 3.0493282149260565, 143.97200227841205, 11.169618052507685, 151.88844071902219, 78.45110531031017, 178.76726219687225, 5.491533832319006, 183.23617029079, 53.44679168121165, 100.62718867369004, 51.62880880817706, 4.512686208328209, 171.62334218999183, 202.77443414774723, 128.4407517753692, 43.32782179174049, 246.32318803637418, 132.52041148399576, 85.60806980806116, 98.80891037849513, 185.52092658311363, 103.72089663179854]}, "sampler_perf": {"mean_raw_obs_processing_ms": 24.612889016885457, "mean_inference_ms": 21.186329230406663, "mean_action_processing_ms": 5.908154806035579, "mean_env_wait_ms": 37.33530745612723, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.09543001651763916, "StateBufferConnector_ms": 0.03673684597015381, "ViewRequirementAgentConnector_ms": 1.255206823348999}, "num_episodes": 0, "episode_return_max": 286.6692231913454, "episode_return_min": -53.94695511723343, "episode_return_mean": 102.60472273081903, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 149312, "num_agent_steps_trained": 149312, "num_env_steps_sampled": 37328, "num_env_steps_trained": 37328, "num_env_steps_sampled_this_iter": 0, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 0.0, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 37328, "num_env_steps_sampled_lifetime": 37328, "num_agent_steps_sampled_lifetime": 149312, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 149312, "timers": {"training_iteration_time_ms": 61426.231, "restore_workers_time_ms": 20.854, "training_step_time_ms": 61362.244, "sample_time_ms": 61343.966, "learn_time_ms": 311236.026, "learn_throughput": 59.967, "synch_weights_time_ms": 43.334}, "counters": {"num_env_steps_sampled": 37328, "num_env_steps_trained": 37328, "num_agent_steps_sampled": 149312, "num_agent_steps_trained": 149312}, "done": false, "training_iteration": 24, "trial_id": "d7bca_00000", "date": "2024-08-20_11-50-04", "timestamp": 1724134804, "time_this_iter_s": 123.12659788131714, "time_total_s": 3507.53227353096, "pid": 36059, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 16000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x32cf668b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3507.53227353096, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 96.96900584795323, "ram_util_percent": 83.62046783625732}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {}, "num_env_steps_sampled": 37328, "num_env_steps_trained": 37328, "num_agent_steps_sampled": 149312, "num_agent_steps_trained": 149312}, "env_runners": {"episode_reward_max": 286.6692231913454, "episode_reward_min": -53.94695511723343, "episode_reward_mean": 102.60472273081903, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -382.5350217575324, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 179.13622751357744, "predator_policy": 388.3350217575325}, "policy_reward_mean": {"prey_policy": -50.61742331228365, "predator_policy": 101.91978467769317}, "custom_metrics": {}, "hist_stats": {"episode_reward": [35.10000000000023, -2.2956613079459616, 52.30000000000035, 93.99999999999946, 41.27668545957155, 138.35998813581944, 47.000000000000355, 189.59999999999982, 46.100000000000314, 122.59999999999911, 172.99184762314727, 183.89999999999952, 165.26660970450598, 63.400000000000325, 224.23591029611316, 118.26513246444676, 57.049342065984625, 56.287512516221504, 91.49999999999856, 77.70000000000017, 286.6692231913454, 34.20000000000022, 135.4999999999999, 189.7622134181783, 204.95900501687956, 41.46117592104707, 160.52089757879483, 41.90000000000027, 159.99999999999952, 56.25035590474681, 189.40904152072758, 32.4000000000002, 135.49999999999923, 137.09999999999957, -53.94695511723343, 170.90494465410117, 56.10000000000025, 60.20000000000013, 34.75612756781972, 43.60000000000028, 40.265044310772325, 47.1298862953699, 48.40000000000023, 36.202116310375594, 74.49999999999962, 153.19999999999987, 40.1000000000002, 131.19999999999982, 52.570622032848895, 56.000000000000156, 129.1999999999993, 86.20000000000002, 28.831075919194078, 160.79999999999959, 81.33852172443821, 103.01543537877356, 169.88064982359512, 48.30000000000023, 52.529310579969625, 48.028025438635616, 198.59999999999948, 184.470358209413, 37.06861395355878, 80.95181844992561, 33.900000000000134, 135.39999999999944, 148.89999999999955, 133.69999999999916, 226.89999999999938, 68.3000000000002, 154.45814550558052, 41.47674734270453, 180.74087067540847, 60.139037304427255, 153.66325386820998, 109.81254335834268, 96.80000000000011, 108.61895163315396, 159.3546697445331, 53.10000000000013, 125.29999999999959, 34.93780403323022, 139.0999999999999, 206.80167211533725, 40.50000000000029, 68.40000000000009, 88.29999999999927, 242.69999999999993, 37.700000000000266, 104.09999999999903, 229.34134979067687, 152.6250807412044, 157.8592262743011, 37.26670789146122, 35.20000000000023, 108.04468364708873, 87.5999999999994, 92.41177405235972, 131.94864151087714, 94.40623855187317], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [13.573129738316304, -53.54665936669982, -254.04609845621002, -260.27960040372835, -140.65478211067654, -73.1171426718985, 39.583255312047925, -34.03651010327775, -114.83317908671795, -92.66853807147267, -96.4272326280199, 93.09870255859556, -64.80740741555226, 20.000000000000014, 20.626642410773584, -16.792242611230414, 18.848497587615384, -92.85980597895414, 69.17606926139403, -109.36249015041209, -285.2321358475945, 105.74800812423979, 132.7888944272447, -19.35385941243218, -25.356623210719427, 11.326871936077456, -78.03601550180139, -20.07740583328924, 28.904313331271958, 85.71002709904536, -84.17058524148602, -101.59193807470932, -247.8691803256373, -34.87488956710395, -49.40531904969436, -141.19228141836533, -107.134889946308, 73.87102816456981, 4.171128342528487, -6.373188196460497, 72.0443042732162, -52.54708787865346, -32.67477650531073, -33.11217620680012, 17.408091439294907, -110.92817899556306, 80.28766474857159, -53.604483480981195, 64.90005398718623, -328.3984316256627, -221.37365036394135, -15.540567450569034, -217.97172194166885, 76.83739839192134, -62.4215290072797, -67.19987230581766, 82.82590198976501, -215.4723347673664, -63.01766150909464, -253.83034574412602, -72.05610867549865, 89.36722870345912, -103.9034532802869, -142.29070810227037, 0.5594712651248201, 21.887655692545323, -382.5350217575324, 117.78599718266575, -341.68754507993606, -271.3757928143444, 42.05974767402415, -113.91576456218526, 10.584749159468316, -368.0370289653096, -96.60173288891873, 6.578081936680414, -116.41208622158636, -38.927412945968925, -335.88260364800084, 33.30132488528524, -27.102952922490367, -70.03840438982733, -11.808869660467748, -17.067235360537826, 10.174001800704053, -2.962232113254194, -5.251613856427011, -54.123434986458186, -77.75098136410048, -19.99080009629646, 33.88040540161318, 40.0118549587175, 18.203034292193653, -101.55435256341609, 84.66934503983893, -118.51718584134521, -111.25275039532056, -35.27706169307365, 12.962713255211035, -154.80174341253127, -108.368940102753, 45.92361009447094, 66.26530936409696, -54.85406764413665, -50.32982812857711, -6.234569676365133, 43.52535653925046, -20.284647818951065, -122.72911794687963, -30.02930181547257, 64.88866316909824, -29.828281979136015, 27.845266783971347, 9.541578665059246, 1.103496687474779, 7.009962407567832, -8.299879170194934, -72.54471461247661, -97.58563081684744, -33.94553553761412, 161.42330774007206, -112.95182525200485, -6.1055308568346724, 40.28710026868663, -159.2584299113319, 1.9693763855458568, -203.51123731867187, -41.75335832068283, -112.73519084767737, -9.86848498904447, -75.14768969882805, 64.9005559888798, -41.26096743109789, 11.98667537860044, 89.1022150662958, -53.133135240501986, -21.790897701337713, 102.87572050846154, -103.60518017643587, -2.753002690682439, -77.5059788586302, -136.78681328113666, -35.26167272819433, 0.7616669233566751, 99.3892737675306, -121.76317749732668, -221.41484542454427, -0.26256937414734516, -81.64046493632515, 47.835445195899766, 41.62225202827415, -159.27689309555132, 8.414915969460758, -94.96493654962522, -101.89030278114168, -225.75780180988139, 42.3879814213417, -221.12051631037914, -194.2370444672595, -47.443484467917465, -68.94976936260595, -71.53127552961595, -175.21866179031935, -2.377011043507998, 7.336224962261236, 57.5840314172886, 148.94400313475802, -286.27355747273646, -38.05288701360526, -15.675153673344045, -157.06325915064687, 20.451311784900852, -34.19514158105644, -163.71926844518902, 179.13622751357744, -193.68286217716528, -5.466795255903271, 18.11348646225638, 73.35067178507347, -116.27200227841195, 81.3532898949211, -15.069998875773695, -1.5790888906085807, -103.01419787536915, 39.20269946596015, -70.07117731476804, -109.82064133551206, -6.986631127929058, -36.128808808176835, 15.187313791671755, -14.673585565722401, -251.67950712492743, 6.628822658497688, -90.79739622560763, -223.17849208443, -63.253333383580255, -19.653256456869457, -32.815082218808726, 25.002451968907792, -219.83803663194715], "policy_predator_policy_reward": [5.826870261683667, 69.24665936669969, 324.2059226722713, 187.82411487972215, 153.05478211067583, 113.01714267189817, 17.61674468795218, 70.83651010327776, 56.871368154986286, 191.90703446277513, 141.68851820524378, 0.0, 91.80740741555158, 0.0, 54.17335758922649, 131.5922426112305, 1.0515024123846184, 119.05980597895365, 36.62393073860571, 126.16249015041168, 294.04458931930264, 58.43138602720072, 27.098306487098423, 43.366658498089144, 101.5982771707111, 77.69808380843789, 92.33601550180148, 69.17740583328944, 11.711242094735995, 97.91032777106007, 159.598841430636, 144.42881435000547, 256.62014258831397, 83.17326937041157, 64.7437860571049, 182.14132692717635, 121.33488994630724, 3.428971835429686, 17.92887165747148, 61.97318819646065, 71.37501564844887, 195.79699114833366, 50.574776505310986, 49.41217620680031, 95.99190856070484, 133.02817899556257, 118.64992189155714, 44.429110259031575, 173.65858800042827, 294.7987946549283, 219.5255437438939, 58.84984999166302, 153.020176017792, 148.6350451107507, 84.92152900727922, 86.59987230581754, 35.917401426461, 256.72903135113984, 310.86582010807547, 62.23254304989086, 95.58973110505788, 76.50819038770996, 122.80345328028605, 155.79070810226966, 62.740528734875355, 50.312344307454744, 388.3350217575325, 13.51400281733393, 276.4934910271924, 282.6228917498557, 228.37632836739596, 14.384633174866076, 36.51525084053167, 377.03702896531087, 55.843560999739694, 94.38008995249868, 186.75715567238382, 3.338471062991101, 341.8826036480012, 4.298675114714987, 61.56155472910194, 75.84484689398705, 39.31993402285901, 36.68605729351662, 9.025998199295913, 32.16223211325439, 17.067987561023646, 78.50917759223691, 86.89305015310855, 85.34873130728765, 32.98846306649877, 46.31927657317061, 3.2969657078063443, 120.15435256341586, 51.96603493554656, 113.08180586595923, 51.82953263144456, 147.2709014897984, 28.814437033388117, 169.02459312393165, 122.3689401027523, 69.27638990552909, 2.934690635903009, 71.85406764413669, 69.17481916505344, 16.220654559082863, 82.67464346074956, 54.88464781895127, 149.0452344703959, 85.05170701639402, 61.64654055235777, 6.308513636455049, 122.72811266075166, 9.76569171381375, 28.196503312525255, 11.990037592432142, 39.59465245581429, 93.77925190682629, 173.417858483239, 6.14133330985798, 15.762281811455798, 134.36623570047647, 76.06028203580479, 74.22850676175635, 34.695476680536935, 159.6621907988072, 167.2233660646181, 158.99304802466287, 125.23519084767717, 31.268484989044566, 88.54768969882797, 57.09944401112018, 170.03924007813922, 8.135051974358213, 21.451638560862875, 76.27928161334323, 145.09089770133772, 0.7242794915378635, 119.58478321201947, 55.07339965509877, 101.30347201003724, 267.44746563530987, 25.72851731642294, 50.2482358311191, 10.105741511511418, 193.0090328936931, 242.16798791533478, 39.648464187783205, 159.3499139561802, 28.118359652455005, 62.6282279289202, 164.83895649669932, 73.18508403053936, 110.16493654962441, 168.40666761692708, 267.8603886072499, 213.90796331236706, 124.17924132120368, 231.43704446725934, 63.34348446791769, 164.82322943616253, 100.95781545605833, 192.6461275375021, 19.887349329554755, 38.363775037738804, 35.81596858271153, 113.3458349053624, 230.7853915479533, 54.85288701360539, 39.375153673344265, 203.76325915064663, 1.2486882150991712, 111.99514158105654, 174.21926844518845, 10.863772486422565, 246.3828621771652, 23.366795255903288, 1.686513537743613, 3.0493282149260565, 143.97200227841205, 11.169618052507685, 151.88844071902219, 78.45110531031017, 178.76726219687225, 5.491533832319006, 183.23617029079, 53.44679168121165, 100.62718867369004, 51.62880880817706, 4.512686208328209, 171.62334218999183, 202.77443414774723, 128.4407517753692, 43.32782179174049, 246.32318803637418, 132.52041148399576, 85.60806980806116, 98.80891037849513, 185.52092658311363, 103.72089663179854]}, "sampler_perf": {"mean_raw_obs_processing_ms": 24.612889016885457, "mean_inference_ms": 21.186329230406663, "mean_action_processing_ms": 5.908154806035579, "mean_env_wait_ms": 37.33530745612723, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.09543001651763916, "StateBufferConnector_ms": 0.03673684597015381, "ViewRequirementAgentConnector_ms": 1.255206823348999}, "num_episodes": 0, "episode_return_max": 286.6692231913454, "episode_return_min": -53.94695511723343, "episode_return_mean": 102.60472273081903, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 149312, "num_agent_steps_trained": 149312, "num_env_steps_sampled": 37328, "num_env_steps_trained": 37328, "num_env_steps_sampled_this_iter": 0, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 0.0, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 37328, "num_env_steps_sampled_lifetime": 37328, "num_agent_steps_sampled_lifetime": 149312, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 149312, "timers": {"training_iteration_time_ms": 61466.203, "restore_workers_time_ms": 21.513, "training_step_time_ms": 61401.199, "sample_time_ms": 61383.139, "learn_time_ms": 311236.026, "learn_throughput": 59.967, "synch_weights_time_ms": 43.334}, "counters": {"num_env_steps_sampled": 37328, "num_env_steps_trained": 37328, "num_agent_steps_sampled": 149312, "num_agent_steps_trained": 149312}, "done": false, "training_iteration": 25, "trial_id": "d7bca_00000", "date": "2024-08-20_11-52-11", "timestamp": 1724134931, "time_this_iter_s": 124.29997706413269, "time_total_s": 3631.832250595093, "pid": 36059, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 16000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x32cf66280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3631.832250595093, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 96.62558139534883, "ram_util_percent": 83.93372093023257}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {}, "num_env_steps_sampled": 37328, "num_env_steps_trained": 37328, "num_agent_steps_sampled": 149312, "num_agent_steps_trained": 149312}, "env_runners": {"episode_reward_max": 286.6692231913454, "episode_reward_min": -53.94695511723343, "episode_reward_mean": 102.60472273081903, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -382.5350217575324, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 179.13622751357744, "predator_policy": 388.3350217575325}, "policy_reward_mean": {"prey_policy": -50.61742331228365, "predator_policy": 101.91978467769317}, "custom_metrics": {}, "hist_stats": {"episode_reward": [35.10000000000023, -2.2956613079459616, 52.30000000000035, 93.99999999999946, 41.27668545957155, 138.35998813581944, 47.000000000000355, 189.59999999999982, 46.100000000000314, 122.59999999999911, 172.99184762314727, 183.89999999999952, 165.26660970450598, 63.400000000000325, 224.23591029611316, 118.26513246444676, 57.049342065984625, 56.287512516221504, 91.49999999999856, 77.70000000000017, 286.6692231913454, 34.20000000000022, 135.4999999999999, 189.7622134181783, 204.95900501687956, 41.46117592104707, 160.52089757879483, 41.90000000000027, 159.99999999999952, 56.25035590474681, 189.40904152072758, 32.4000000000002, 135.49999999999923, 137.09999999999957, -53.94695511723343, 170.90494465410117, 56.10000000000025, 60.20000000000013, 34.75612756781972, 43.60000000000028, 40.265044310772325, 47.1298862953699, 48.40000000000023, 36.202116310375594, 74.49999999999962, 153.19999999999987, 40.1000000000002, 131.19999999999982, 52.570622032848895, 56.000000000000156, 129.1999999999993, 86.20000000000002, 28.831075919194078, 160.79999999999959, 81.33852172443821, 103.01543537877356, 169.88064982359512, 48.30000000000023, 52.529310579969625, 48.028025438635616, 198.59999999999948, 184.470358209413, 37.06861395355878, 80.95181844992561, 33.900000000000134, 135.39999999999944, 148.89999999999955, 133.69999999999916, 226.89999999999938, 68.3000000000002, 154.45814550558052, 41.47674734270453, 180.74087067540847, 60.139037304427255, 153.66325386820998, 109.81254335834268, 96.80000000000011, 108.61895163315396, 159.3546697445331, 53.10000000000013, 125.29999999999959, 34.93780403323022, 139.0999999999999, 206.80167211533725, 40.50000000000029, 68.40000000000009, 88.29999999999927, 242.69999999999993, 37.700000000000266, 104.09999999999903, 229.34134979067687, 152.6250807412044, 157.8592262743011, 37.26670789146122, 35.20000000000023, 108.04468364708873, 87.5999999999994, 92.41177405235972, 131.94864151087714, 94.40623855187317], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [13.573129738316304, -53.54665936669982, -254.04609845621002, -260.27960040372835, -140.65478211067654, -73.1171426718985, 39.583255312047925, -34.03651010327775, -114.83317908671795, -92.66853807147267, -96.4272326280199, 93.09870255859556, -64.80740741555226, 20.000000000000014, 20.626642410773584, -16.792242611230414, 18.848497587615384, -92.85980597895414, 69.17606926139403, -109.36249015041209, -285.2321358475945, 105.74800812423979, 132.7888944272447, -19.35385941243218, -25.356623210719427, 11.326871936077456, -78.03601550180139, -20.07740583328924, 28.904313331271958, 85.71002709904536, -84.17058524148602, -101.59193807470932, -247.8691803256373, -34.87488956710395, -49.40531904969436, -141.19228141836533, -107.134889946308, 73.87102816456981, 4.171128342528487, -6.373188196460497, 72.0443042732162, -52.54708787865346, -32.67477650531073, -33.11217620680012, 17.408091439294907, -110.92817899556306, 80.28766474857159, -53.604483480981195, 64.90005398718623, -328.3984316256627, -221.37365036394135, -15.540567450569034, -217.97172194166885, 76.83739839192134, -62.4215290072797, -67.19987230581766, 82.82590198976501, -215.4723347673664, -63.01766150909464, -253.83034574412602, -72.05610867549865, 89.36722870345912, -103.9034532802869, -142.29070810227037, 0.5594712651248201, 21.887655692545323, -382.5350217575324, 117.78599718266575, -341.68754507993606, -271.3757928143444, 42.05974767402415, -113.91576456218526, 10.584749159468316, -368.0370289653096, -96.60173288891873, 6.578081936680414, -116.41208622158636, -38.927412945968925, -335.88260364800084, 33.30132488528524, -27.102952922490367, -70.03840438982733, -11.808869660467748, -17.067235360537826, 10.174001800704053, -2.962232113254194, -5.251613856427011, -54.123434986458186, -77.75098136410048, -19.99080009629646, 33.88040540161318, 40.0118549587175, 18.203034292193653, -101.55435256341609, 84.66934503983893, -118.51718584134521, -111.25275039532056, -35.27706169307365, 12.962713255211035, -154.80174341253127, -108.368940102753, 45.92361009447094, 66.26530936409696, -54.85406764413665, -50.32982812857711, -6.234569676365133, 43.52535653925046, -20.284647818951065, -122.72911794687963, -30.02930181547257, 64.88866316909824, -29.828281979136015, 27.845266783971347, 9.541578665059246, 1.103496687474779, 7.009962407567832, -8.299879170194934, -72.54471461247661, -97.58563081684744, -33.94553553761412, 161.42330774007206, -112.95182525200485, -6.1055308568346724, 40.28710026868663, -159.2584299113319, 1.9693763855458568, -203.51123731867187, -41.75335832068283, -112.73519084767737, -9.86848498904447, -75.14768969882805, 64.9005559888798, -41.26096743109789, 11.98667537860044, 89.1022150662958, -53.133135240501986, -21.790897701337713, 102.87572050846154, -103.60518017643587, -2.753002690682439, -77.5059788586302, -136.78681328113666, -35.26167272819433, 0.7616669233566751, 99.3892737675306, -121.76317749732668, -221.41484542454427, -0.26256937414734516, -81.64046493632515, 47.835445195899766, 41.62225202827415, -159.27689309555132, 8.414915969460758, -94.96493654962522, -101.89030278114168, -225.75780180988139, 42.3879814213417, -221.12051631037914, -194.2370444672595, -47.443484467917465, -68.94976936260595, -71.53127552961595, -175.21866179031935, -2.377011043507998, 7.336224962261236, 57.5840314172886, 148.94400313475802, -286.27355747273646, -38.05288701360526, -15.675153673344045, -157.06325915064687, 20.451311784900852, -34.19514158105644, -163.71926844518902, 179.13622751357744, -193.68286217716528, -5.466795255903271, 18.11348646225638, 73.35067178507347, -116.27200227841195, 81.3532898949211, -15.069998875773695, -1.5790888906085807, -103.01419787536915, 39.20269946596015, -70.07117731476804, -109.82064133551206, -6.986631127929058, -36.128808808176835, 15.187313791671755, -14.673585565722401, -251.67950712492743, 6.628822658497688, -90.79739622560763, -223.17849208443, -63.253333383580255, -19.653256456869457, -32.815082218808726, 25.002451968907792, -219.83803663194715], "policy_predator_policy_reward": [5.826870261683667, 69.24665936669969, 324.2059226722713, 187.82411487972215, 153.05478211067583, 113.01714267189817, 17.61674468795218, 70.83651010327776, 56.871368154986286, 191.90703446277513, 141.68851820524378, 0.0, 91.80740741555158, 0.0, 54.17335758922649, 131.5922426112305, 1.0515024123846184, 119.05980597895365, 36.62393073860571, 126.16249015041168, 294.04458931930264, 58.43138602720072, 27.098306487098423, 43.366658498089144, 101.5982771707111, 77.69808380843789, 92.33601550180148, 69.17740583328944, 11.711242094735995, 97.91032777106007, 159.598841430636, 144.42881435000547, 256.62014258831397, 83.17326937041157, 64.7437860571049, 182.14132692717635, 121.33488994630724, 3.428971835429686, 17.92887165747148, 61.97318819646065, 71.37501564844887, 195.79699114833366, 50.574776505310986, 49.41217620680031, 95.99190856070484, 133.02817899556257, 118.64992189155714, 44.429110259031575, 173.65858800042827, 294.7987946549283, 219.5255437438939, 58.84984999166302, 153.020176017792, 148.6350451107507, 84.92152900727922, 86.59987230581754, 35.917401426461, 256.72903135113984, 310.86582010807547, 62.23254304989086, 95.58973110505788, 76.50819038770996, 122.80345328028605, 155.79070810226966, 62.740528734875355, 50.312344307454744, 388.3350217575325, 13.51400281733393, 276.4934910271924, 282.6228917498557, 228.37632836739596, 14.384633174866076, 36.51525084053167, 377.03702896531087, 55.843560999739694, 94.38008995249868, 186.75715567238382, 3.338471062991101, 341.8826036480012, 4.298675114714987, 61.56155472910194, 75.84484689398705, 39.31993402285901, 36.68605729351662, 9.025998199295913, 32.16223211325439, 17.067987561023646, 78.50917759223691, 86.89305015310855, 85.34873130728765, 32.98846306649877, 46.31927657317061, 3.2969657078063443, 120.15435256341586, 51.96603493554656, 113.08180586595923, 51.82953263144456, 147.2709014897984, 28.814437033388117, 169.02459312393165, 122.3689401027523, 69.27638990552909, 2.934690635903009, 71.85406764413669, 69.17481916505344, 16.220654559082863, 82.67464346074956, 54.88464781895127, 149.0452344703959, 85.05170701639402, 61.64654055235777, 6.308513636455049, 122.72811266075166, 9.76569171381375, 28.196503312525255, 11.990037592432142, 39.59465245581429, 93.77925190682629, 173.417858483239, 6.14133330985798, 15.762281811455798, 134.36623570047647, 76.06028203580479, 74.22850676175635, 34.695476680536935, 159.6621907988072, 167.2233660646181, 158.99304802466287, 125.23519084767717, 31.268484989044566, 88.54768969882797, 57.09944401112018, 170.03924007813922, 8.135051974358213, 21.451638560862875, 76.27928161334323, 145.09089770133772, 0.7242794915378635, 119.58478321201947, 55.07339965509877, 101.30347201003724, 267.44746563530987, 25.72851731642294, 50.2482358311191, 10.105741511511418, 193.0090328936931, 242.16798791533478, 39.648464187783205, 159.3499139561802, 28.118359652455005, 62.6282279289202, 164.83895649669932, 73.18508403053936, 110.16493654962441, 168.40666761692708, 267.8603886072499, 213.90796331236706, 124.17924132120368, 231.43704446725934, 63.34348446791769, 164.82322943616253, 100.95781545605833, 192.6461275375021, 19.887349329554755, 38.363775037738804, 35.81596858271153, 113.3458349053624, 230.7853915479533, 54.85288701360539, 39.375153673344265, 203.76325915064663, 1.2486882150991712, 111.99514158105654, 174.21926844518845, 10.863772486422565, 246.3828621771652, 23.366795255903288, 1.686513537743613, 3.0493282149260565, 143.97200227841205, 11.169618052507685, 151.88844071902219, 78.45110531031017, 178.76726219687225, 5.491533832319006, 183.23617029079, 53.44679168121165, 100.62718867369004, 51.62880880817706, 4.512686208328209, 171.62334218999183, 202.77443414774723, 128.4407517753692, 43.32782179174049, 246.32318803637418, 132.52041148399576, 85.60806980806116, 98.80891037849513, 185.52092658311363, 103.72089663179854]}, "sampler_perf": {"mean_raw_obs_processing_ms": 24.612889016885457, "mean_inference_ms": 21.186329230406663, "mean_action_processing_ms": 5.908154806035579, "mean_env_wait_ms": 37.33530745612723, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.09543001651763916, "StateBufferConnector_ms": 0.03673684597015381, "ViewRequirementAgentConnector_ms": 1.255206823348999}, "num_episodes": 0, "episode_return_max": 286.6692231913454, "episode_return_min": -53.94695511723343, "episode_return_mean": 102.60472273081903, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 149312, "num_agent_steps_trained": 149312, "num_env_steps_sampled": 37328, "num_env_steps_trained": 37328, "num_env_steps_sampled_this_iter": 0, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 0.0, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 37328, "num_env_steps_sampled_lifetime": 37328, "num_agent_steps_sampled_lifetime": 149312, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 149312, "timers": {"training_iteration_time_ms": 61508.779, "restore_workers_time_ms": 21.606, "training_step_time_ms": 61444.042, "sample_time_ms": 61427.321, "learn_time_ms": 311236.026, "learn_throughput": 59.967, "synch_weights_time_ms": 43.334}, "counters": {"num_env_steps_sampled": 37328, "num_env_steps_trained": 37328, "num_agent_steps_sampled": 149312, "num_agent_steps_trained": 149312}, "done": false, "training_iteration": 26, "trial_id": "d7bca_00000", "date": "2024-08-20_11-54-24", "timestamp": 1724135064, "time_this_iter_s": 127.03666090965271, "time_total_s": 3758.8689115047455, "pid": 36059, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 16000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b0d8cd30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3758.8689115047455, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 93.65469613259668, "ram_util_percent": 83.97458563535912}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {}, "num_env_steps_sampled": 37328, "num_env_steps_trained": 37328, "num_agent_steps_sampled": 149312, "num_agent_steps_trained": 149312}, "env_runners": {"episode_reward_max": 286.6692231913454, "episode_reward_min": -53.94695511723343, "episode_reward_mean": 102.60472273081903, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -382.5350217575324, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 179.13622751357744, "predator_policy": 388.3350217575325}, "policy_reward_mean": {"prey_policy": -50.61742331228365, "predator_policy": 101.91978467769317}, "custom_metrics": {}, "hist_stats": {"episode_reward": [35.10000000000023, -2.2956613079459616, 52.30000000000035, 93.99999999999946, 41.27668545957155, 138.35998813581944, 47.000000000000355, 189.59999999999982, 46.100000000000314, 122.59999999999911, 172.99184762314727, 183.89999999999952, 165.26660970450598, 63.400000000000325, 224.23591029611316, 118.26513246444676, 57.049342065984625, 56.287512516221504, 91.49999999999856, 77.70000000000017, 286.6692231913454, 34.20000000000022, 135.4999999999999, 189.7622134181783, 204.95900501687956, 41.46117592104707, 160.52089757879483, 41.90000000000027, 159.99999999999952, 56.25035590474681, 189.40904152072758, 32.4000000000002, 135.49999999999923, 137.09999999999957, -53.94695511723343, 170.90494465410117, 56.10000000000025, 60.20000000000013, 34.75612756781972, 43.60000000000028, 40.265044310772325, 47.1298862953699, 48.40000000000023, 36.202116310375594, 74.49999999999962, 153.19999999999987, 40.1000000000002, 131.19999999999982, 52.570622032848895, 56.000000000000156, 129.1999999999993, 86.20000000000002, 28.831075919194078, 160.79999999999959, 81.33852172443821, 103.01543537877356, 169.88064982359512, 48.30000000000023, 52.529310579969625, 48.028025438635616, 198.59999999999948, 184.470358209413, 37.06861395355878, 80.95181844992561, 33.900000000000134, 135.39999999999944, 148.89999999999955, 133.69999999999916, 226.89999999999938, 68.3000000000002, 154.45814550558052, 41.47674734270453, 180.74087067540847, 60.139037304427255, 153.66325386820998, 109.81254335834268, 96.80000000000011, 108.61895163315396, 159.3546697445331, 53.10000000000013, 125.29999999999959, 34.93780403323022, 139.0999999999999, 206.80167211533725, 40.50000000000029, 68.40000000000009, 88.29999999999927, 242.69999999999993, 37.700000000000266, 104.09999999999903, 229.34134979067687, 152.6250807412044, 157.8592262743011, 37.26670789146122, 35.20000000000023, 108.04468364708873, 87.5999999999994, 92.41177405235972, 131.94864151087714, 94.40623855187317], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [13.573129738316304, -53.54665936669982, -254.04609845621002, -260.27960040372835, -140.65478211067654, -73.1171426718985, 39.583255312047925, -34.03651010327775, -114.83317908671795, -92.66853807147267, -96.4272326280199, 93.09870255859556, -64.80740741555226, 20.000000000000014, 20.626642410773584, -16.792242611230414, 18.848497587615384, -92.85980597895414, 69.17606926139403, -109.36249015041209, -285.2321358475945, 105.74800812423979, 132.7888944272447, -19.35385941243218, -25.356623210719427, 11.326871936077456, -78.03601550180139, -20.07740583328924, 28.904313331271958, 85.71002709904536, -84.17058524148602, -101.59193807470932, -247.8691803256373, -34.87488956710395, -49.40531904969436, -141.19228141836533, -107.134889946308, 73.87102816456981, 4.171128342528487, -6.373188196460497, 72.0443042732162, -52.54708787865346, -32.67477650531073, -33.11217620680012, 17.408091439294907, -110.92817899556306, 80.28766474857159, -53.604483480981195, 64.90005398718623, -328.3984316256627, -221.37365036394135, -15.540567450569034, -217.97172194166885, 76.83739839192134, -62.4215290072797, -67.19987230581766, 82.82590198976501, -215.4723347673664, -63.01766150909464, -253.83034574412602, -72.05610867549865, 89.36722870345912, -103.9034532802869, -142.29070810227037, 0.5594712651248201, 21.887655692545323, -382.5350217575324, 117.78599718266575, -341.68754507993606, -271.3757928143444, 42.05974767402415, -113.91576456218526, 10.584749159468316, -368.0370289653096, -96.60173288891873, 6.578081936680414, -116.41208622158636, -38.927412945968925, -335.88260364800084, 33.30132488528524, -27.102952922490367, -70.03840438982733, -11.808869660467748, -17.067235360537826, 10.174001800704053, -2.962232113254194, -5.251613856427011, -54.123434986458186, -77.75098136410048, -19.99080009629646, 33.88040540161318, 40.0118549587175, 18.203034292193653, -101.55435256341609, 84.66934503983893, -118.51718584134521, -111.25275039532056, -35.27706169307365, 12.962713255211035, -154.80174341253127, -108.368940102753, 45.92361009447094, 66.26530936409696, -54.85406764413665, -50.32982812857711, -6.234569676365133, 43.52535653925046, -20.284647818951065, -122.72911794687963, -30.02930181547257, 64.88866316909824, -29.828281979136015, 27.845266783971347, 9.541578665059246, 1.103496687474779, 7.009962407567832, -8.299879170194934, -72.54471461247661, -97.58563081684744, -33.94553553761412, 161.42330774007206, -112.95182525200485, -6.1055308568346724, 40.28710026868663, -159.2584299113319, 1.9693763855458568, -203.51123731867187, -41.75335832068283, -112.73519084767737, -9.86848498904447, -75.14768969882805, 64.9005559888798, -41.26096743109789, 11.98667537860044, 89.1022150662958, -53.133135240501986, -21.790897701337713, 102.87572050846154, -103.60518017643587, -2.753002690682439, -77.5059788586302, -136.78681328113666, -35.26167272819433, 0.7616669233566751, 99.3892737675306, -121.76317749732668, -221.41484542454427, -0.26256937414734516, -81.64046493632515, 47.835445195899766, 41.62225202827415, -159.27689309555132, 8.414915969460758, -94.96493654962522, -101.89030278114168, -225.75780180988139, 42.3879814213417, -221.12051631037914, -194.2370444672595, -47.443484467917465, -68.94976936260595, -71.53127552961595, -175.21866179031935, -2.377011043507998, 7.336224962261236, 57.5840314172886, 148.94400313475802, -286.27355747273646, -38.05288701360526, -15.675153673344045, -157.06325915064687, 20.451311784900852, -34.19514158105644, -163.71926844518902, 179.13622751357744, -193.68286217716528, -5.466795255903271, 18.11348646225638, 73.35067178507347, -116.27200227841195, 81.3532898949211, -15.069998875773695, -1.5790888906085807, -103.01419787536915, 39.20269946596015, -70.07117731476804, -109.82064133551206, -6.986631127929058, -36.128808808176835, 15.187313791671755, -14.673585565722401, -251.67950712492743, 6.628822658497688, -90.79739622560763, -223.17849208443, -63.253333383580255, -19.653256456869457, -32.815082218808726, 25.002451968907792, -219.83803663194715], "policy_predator_policy_reward": [5.826870261683667, 69.24665936669969, 324.2059226722713, 187.82411487972215, 153.05478211067583, 113.01714267189817, 17.61674468795218, 70.83651010327776, 56.871368154986286, 191.90703446277513, 141.68851820524378, 0.0, 91.80740741555158, 0.0, 54.17335758922649, 131.5922426112305, 1.0515024123846184, 119.05980597895365, 36.62393073860571, 126.16249015041168, 294.04458931930264, 58.43138602720072, 27.098306487098423, 43.366658498089144, 101.5982771707111, 77.69808380843789, 92.33601550180148, 69.17740583328944, 11.711242094735995, 97.91032777106007, 159.598841430636, 144.42881435000547, 256.62014258831397, 83.17326937041157, 64.7437860571049, 182.14132692717635, 121.33488994630724, 3.428971835429686, 17.92887165747148, 61.97318819646065, 71.37501564844887, 195.79699114833366, 50.574776505310986, 49.41217620680031, 95.99190856070484, 133.02817899556257, 118.64992189155714, 44.429110259031575, 173.65858800042827, 294.7987946549283, 219.5255437438939, 58.84984999166302, 153.020176017792, 148.6350451107507, 84.92152900727922, 86.59987230581754, 35.917401426461, 256.72903135113984, 310.86582010807547, 62.23254304989086, 95.58973110505788, 76.50819038770996, 122.80345328028605, 155.79070810226966, 62.740528734875355, 50.312344307454744, 388.3350217575325, 13.51400281733393, 276.4934910271924, 282.6228917498557, 228.37632836739596, 14.384633174866076, 36.51525084053167, 377.03702896531087, 55.843560999739694, 94.38008995249868, 186.75715567238382, 3.338471062991101, 341.8826036480012, 4.298675114714987, 61.56155472910194, 75.84484689398705, 39.31993402285901, 36.68605729351662, 9.025998199295913, 32.16223211325439, 17.067987561023646, 78.50917759223691, 86.89305015310855, 85.34873130728765, 32.98846306649877, 46.31927657317061, 3.2969657078063443, 120.15435256341586, 51.96603493554656, 113.08180586595923, 51.82953263144456, 147.2709014897984, 28.814437033388117, 169.02459312393165, 122.3689401027523, 69.27638990552909, 2.934690635903009, 71.85406764413669, 69.17481916505344, 16.220654559082863, 82.67464346074956, 54.88464781895127, 149.0452344703959, 85.05170701639402, 61.64654055235777, 6.308513636455049, 122.72811266075166, 9.76569171381375, 28.196503312525255, 11.990037592432142, 39.59465245581429, 93.77925190682629, 173.417858483239, 6.14133330985798, 15.762281811455798, 134.36623570047647, 76.06028203580479, 74.22850676175635, 34.695476680536935, 159.6621907988072, 167.2233660646181, 158.99304802466287, 125.23519084767717, 31.268484989044566, 88.54768969882797, 57.09944401112018, 170.03924007813922, 8.135051974358213, 21.451638560862875, 76.27928161334323, 145.09089770133772, 0.7242794915378635, 119.58478321201947, 55.07339965509877, 101.30347201003724, 267.44746563530987, 25.72851731642294, 50.2482358311191, 10.105741511511418, 193.0090328936931, 242.16798791533478, 39.648464187783205, 159.3499139561802, 28.118359652455005, 62.6282279289202, 164.83895649669932, 73.18508403053936, 110.16493654962441, 168.40666761692708, 267.8603886072499, 213.90796331236706, 124.17924132120368, 231.43704446725934, 63.34348446791769, 164.82322943616253, 100.95781545605833, 192.6461275375021, 19.887349329554755, 38.363775037738804, 35.81596858271153, 113.3458349053624, 230.7853915479533, 54.85288701360539, 39.375153673344265, 203.76325915064663, 1.2486882150991712, 111.99514158105654, 174.21926844518845, 10.863772486422565, 246.3828621771652, 23.366795255903288, 1.686513537743613, 3.0493282149260565, 143.97200227841205, 11.169618052507685, 151.88844071902219, 78.45110531031017, 178.76726219687225, 5.491533832319006, 183.23617029079, 53.44679168121165, 100.62718867369004, 51.62880880817706, 4.512686208328209, 171.62334218999183, 202.77443414774723, 128.4407517753692, 43.32782179174049, 246.32318803637418, 132.52041148399576, 85.60806980806116, 98.80891037849513, 185.52092658311363, 103.72089663179854]}, "sampler_perf": {"mean_raw_obs_processing_ms": 24.612889016885457, "mean_inference_ms": 21.186329230406663, "mean_action_processing_ms": 5.908154806035579, "mean_env_wait_ms": 37.33530745612723, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.09543001651763916, "StateBufferConnector_ms": 0.03673684597015381, "ViewRequirementAgentConnector_ms": 1.255206823348999}, "num_episodes": 0, "episode_return_max": 286.6692231913454, "episode_return_min": -53.94695511723343, "episode_return_mean": 102.60472273081903, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 149312, "num_agent_steps_trained": 149312, "num_env_steps_sampled": 37328, "num_env_steps_trained": 37328, "num_env_steps_sampled_this_iter": 0, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 0.0, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 37328, "num_env_steps_sampled_lifetime": 37328, "num_agent_steps_sampled_lifetime": 149312, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 149312, "timers": {"training_iteration_time_ms": 62033.394, "restore_workers_time_ms": 54.252, "training_step_time_ms": 61910.288, "sample_time_ms": 61878.834, "learn_time_ms": 311236.026, "learn_throughput": 59.967, "synch_weights_time_ms": 43.334}, "counters": {"num_env_steps_sampled": 37328, "num_env_steps_trained": 37328, "num_agent_steps_sampled": 149312, "num_agent_steps_trained": 149312}, "done": false, "training_iteration": 27, "trial_id": "d7bca_00000", "date": "2024-08-20_11-57-07", "timestamp": 1724135227, "time_this_iter_s": 136.33623504638672, "time_total_s": 3895.205146551132, "pid": 36059, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 16000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b0d8c280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3895.205146551132, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 43.79159292035399, "ram_util_percent": 86.6845132743363}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {}, "num_env_steps_sampled": 37328, "num_env_steps_trained": 37328, "num_agent_steps_sampled": 149312, "num_agent_steps_trained": 149312}, "env_runners": {"episode_reward_max": 286.6692231913454, "episode_reward_min": -53.94695511723343, "episode_reward_mean": 102.60472273081903, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -382.5350217575324, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 179.13622751357744, "predator_policy": 388.3350217575325}, "policy_reward_mean": {"prey_policy": -50.61742331228365, "predator_policy": 101.91978467769317}, "custom_metrics": {}, "hist_stats": {"episode_reward": [35.10000000000023, -2.2956613079459616, 52.30000000000035, 93.99999999999946, 41.27668545957155, 138.35998813581944, 47.000000000000355, 189.59999999999982, 46.100000000000314, 122.59999999999911, 172.99184762314727, 183.89999999999952, 165.26660970450598, 63.400000000000325, 224.23591029611316, 118.26513246444676, 57.049342065984625, 56.287512516221504, 91.49999999999856, 77.70000000000017, 286.6692231913454, 34.20000000000022, 135.4999999999999, 189.7622134181783, 204.95900501687956, 41.46117592104707, 160.52089757879483, 41.90000000000027, 159.99999999999952, 56.25035590474681, 189.40904152072758, 32.4000000000002, 135.49999999999923, 137.09999999999957, -53.94695511723343, 170.90494465410117, 56.10000000000025, 60.20000000000013, 34.75612756781972, 43.60000000000028, 40.265044310772325, 47.1298862953699, 48.40000000000023, 36.202116310375594, 74.49999999999962, 153.19999999999987, 40.1000000000002, 131.19999999999982, 52.570622032848895, 56.000000000000156, 129.1999999999993, 86.20000000000002, 28.831075919194078, 160.79999999999959, 81.33852172443821, 103.01543537877356, 169.88064982359512, 48.30000000000023, 52.529310579969625, 48.028025438635616, 198.59999999999948, 184.470358209413, 37.06861395355878, 80.95181844992561, 33.900000000000134, 135.39999999999944, 148.89999999999955, 133.69999999999916, 226.89999999999938, 68.3000000000002, 154.45814550558052, 41.47674734270453, 180.74087067540847, 60.139037304427255, 153.66325386820998, 109.81254335834268, 96.80000000000011, 108.61895163315396, 159.3546697445331, 53.10000000000013, 125.29999999999959, 34.93780403323022, 139.0999999999999, 206.80167211533725, 40.50000000000029, 68.40000000000009, 88.29999999999927, 242.69999999999993, 37.700000000000266, 104.09999999999903, 229.34134979067687, 152.6250807412044, 157.8592262743011, 37.26670789146122, 35.20000000000023, 108.04468364708873, 87.5999999999994, 92.41177405235972, 131.94864151087714, 94.40623855187317], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [13.573129738316304, -53.54665936669982, -254.04609845621002, -260.27960040372835, -140.65478211067654, -73.1171426718985, 39.583255312047925, -34.03651010327775, -114.83317908671795, -92.66853807147267, -96.4272326280199, 93.09870255859556, -64.80740741555226, 20.000000000000014, 20.626642410773584, -16.792242611230414, 18.848497587615384, -92.85980597895414, 69.17606926139403, -109.36249015041209, -285.2321358475945, 105.74800812423979, 132.7888944272447, -19.35385941243218, -25.356623210719427, 11.326871936077456, -78.03601550180139, -20.07740583328924, 28.904313331271958, 85.71002709904536, -84.17058524148602, -101.59193807470932, -247.8691803256373, -34.87488956710395, -49.40531904969436, -141.19228141836533, -107.134889946308, 73.87102816456981, 4.171128342528487, -6.373188196460497, 72.0443042732162, -52.54708787865346, -32.67477650531073, -33.11217620680012, 17.408091439294907, -110.92817899556306, 80.28766474857159, -53.604483480981195, 64.90005398718623, -328.3984316256627, -221.37365036394135, -15.540567450569034, -217.97172194166885, 76.83739839192134, -62.4215290072797, -67.19987230581766, 82.82590198976501, -215.4723347673664, -63.01766150909464, -253.83034574412602, -72.05610867549865, 89.36722870345912, -103.9034532802869, -142.29070810227037, 0.5594712651248201, 21.887655692545323, -382.5350217575324, 117.78599718266575, -341.68754507993606, -271.3757928143444, 42.05974767402415, -113.91576456218526, 10.584749159468316, -368.0370289653096, -96.60173288891873, 6.578081936680414, -116.41208622158636, -38.927412945968925, -335.88260364800084, 33.30132488528524, -27.102952922490367, -70.03840438982733, -11.808869660467748, -17.067235360537826, 10.174001800704053, -2.962232113254194, -5.251613856427011, -54.123434986458186, -77.75098136410048, -19.99080009629646, 33.88040540161318, 40.0118549587175, 18.203034292193653, -101.55435256341609, 84.66934503983893, -118.51718584134521, -111.25275039532056, -35.27706169307365, 12.962713255211035, -154.80174341253127, -108.368940102753, 45.92361009447094, 66.26530936409696, -54.85406764413665, -50.32982812857711, -6.234569676365133, 43.52535653925046, -20.284647818951065, -122.72911794687963, -30.02930181547257, 64.88866316909824, -29.828281979136015, 27.845266783971347, 9.541578665059246, 1.103496687474779, 7.009962407567832, -8.299879170194934, -72.54471461247661, -97.58563081684744, -33.94553553761412, 161.42330774007206, -112.95182525200485, -6.1055308568346724, 40.28710026868663, -159.2584299113319, 1.9693763855458568, -203.51123731867187, -41.75335832068283, -112.73519084767737, -9.86848498904447, -75.14768969882805, 64.9005559888798, -41.26096743109789, 11.98667537860044, 89.1022150662958, -53.133135240501986, -21.790897701337713, 102.87572050846154, -103.60518017643587, -2.753002690682439, -77.5059788586302, -136.78681328113666, -35.26167272819433, 0.7616669233566751, 99.3892737675306, -121.76317749732668, -221.41484542454427, -0.26256937414734516, -81.64046493632515, 47.835445195899766, 41.62225202827415, -159.27689309555132, 8.414915969460758, -94.96493654962522, -101.89030278114168, -225.75780180988139, 42.3879814213417, -221.12051631037914, -194.2370444672595, -47.443484467917465, -68.94976936260595, -71.53127552961595, -175.21866179031935, -2.377011043507998, 7.336224962261236, 57.5840314172886, 148.94400313475802, -286.27355747273646, -38.05288701360526, -15.675153673344045, -157.06325915064687, 20.451311784900852, -34.19514158105644, -163.71926844518902, 179.13622751357744, -193.68286217716528, -5.466795255903271, 18.11348646225638, 73.35067178507347, -116.27200227841195, 81.3532898949211, -15.069998875773695, -1.5790888906085807, -103.01419787536915, 39.20269946596015, -70.07117731476804, -109.82064133551206, -6.986631127929058, -36.128808808176835, 15.187313791671755, -14.673585565722401, -251.67950712492743, 6.628822658497688, -90.79739622560763, -223.17849208443, -63.253333383580255, -19.653256456869457, -32.815082218808726, 25.002451968907792, -219.83803663194715], "policy_predator_policy_reward": [5.826870261683667, 69.24665936669969, 324.2059226722713, 187.82411487972215, 153.05478211067583, 113.01714267189817, 17.61674468795218, 70.83651010327776, 56.871368154986286, 191.90703446277513, 141.68851820524378, 0.0, 91.80740741555158, 0.0, 54.17335758922649, 131.5922426112305, 1.0515024123846184, 119.05980597895365, 36.62393073860571, 126.16249015041168, 294.04458931930264, 58.43138602720072, 27.098306487098423, 43.366658498089144, 101.5982771707111, 77.69808380843789, 92.33601550180148, 69.17740583328944, 11.711242094735995, 97.91032777106007, 159.598841430636, 144.42881435000547, 256.62014258831397, 83.17326937041157, 64.7437860571049, 182.14132692717635, 121.33488994630724, 3.428971835429686, 17.92887165747148, 61.97318819646065, 71.37501564844887, 195.79699114833366, 50.574776505310986, 49.41217620680031, 95.99190856070484, 133.02817899556257, 118.64992189155714, 44.429110259031575, 173.65858800042827, 294.7987946549283, 219.5255437438939, 58.84984999166302, 153.020176017792, 148.6350451107507, 84.92152900727922, 86.59987230581754, 35.917401426461, 256.72903135113984, 310.86582010807547, 62.23254304989086, 95.58973110505788, 76.50819038770996, 122.80345328028605, 155.79070810226966, 62.740528734875355, 50.312344307454744, 388.3350217575325, 13.51400281733393, 276.4934910271924, 282.6228917498557, 228.37632836739596, 14.384633174866076, 36.51525084053167, 377.03702896531087, 55.843560999739694, 94.38008995249868, 186.75715567238382, 3.338471062991101, 341.8826036480012, 4.298675114714987, 61.56155472910194, 75.84484689398705, 39.31993402285901, 36.68605729351662, 9.025998199295913, 32.16223211325439, 17.067987561023646, 78.50917759223691, 86.89305015310855, 85.34873130728765, 32.98846306649877, 46.31927657317061, 3.2969657078063443, 120.15435256341586, 51.96603493554656, 113.08180586595923, 51.82953263144456, 147.2709014897984, 28.814437033388117, 169.02459312393165, 122.3689401027523, 69.27638990552909, 2.934690635903009, 71.85406764413669, 69.17481916505344, 16.220654559082863, 82.67464346074956, 54.88464781895127, 149.0452344703959, 85.05170701639402, 61.64654055235777, 6.308513636455049, 122.72811266075166, 9.76569171381375, 28.196503312525255, 11.990037592432142, 39.59465245581429, 93.77925190682629, 173.417858483239, 6.14133330985798, 15.762281811455798, 134.36623570047647, 76.06028203580479, 74.22850676175635, 34.695476680536935, 159.6621907988072, 167.2233660646181, 158.99304802466287, 125.23519084767717, 31.268484989044566, 88.54768969882797, 57.09944401112018, 170.03924007813922, 8.135051974358213, 21.451638560862875, 76.27928161334323, 145.09089770133772, 0.7242794915378635, 119.58478321201947, 55.07339965509877, 101.30347201003724, 267.44746563530987, 25.72851731642294, 50.2482358311191, 10.105741511511418, 193.0090328936931, 242.16798791533478, 39.648464187783205, 159.3499139561802, 28.118359652455005, 62.6282279289202, 164.83895649669932, 73.18508403053936, 110.16493654962441, 168.40666761692708, 267.8603886072499, 213.90796331236706, 124.17924132120368, 231.43704446725934, 63.34348446791769, 164.82322943616253, 100.95781545605833, 192.6461275375021, 19.887349329554755, 38.363775037738804, 35.81596858271153, 113.3458349053624, 230.7853915479533, 54.85288701360539, 39.375153673344265, 203.76325915064663, 1.2486882150991712, 111.99514158105654, 174.21926844518845, 10.863772486422565, 246.3828621771652, 23.366795255903288, 1.686513537743613, 3.0493282149260565, 143.97200227841205, 11.169618052507685, 151.88844071902219, 78.45110531031017, 178.76726219687225, 5.491533832319006, 183.23617029079, 53.44679168121165, 100.62718867369004, 51.62880880817706, 4.512686208328209, 171.62334218999183, 202.77443414774723, 128.4407517753692, 43.32782179174049, 246.32318803637418, 132.52041148399576, 85.60806980806116, 98.80891037849513, 185.52092658311363, 103.72089663179854]}, "sampler_perf": {"mean_raw_obs_processing_ms": 24.612889016885457, "mean_inference_ms": 21.186329230406663, "mean_action_processing_ms": 5.908154806035579, "mean_env_wait_ms": 37.33530745612723, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.09543001651763916, "StateBufferConnector_ms": 0.03673684597015381, "ViewRequirementAgentConnector_ms": 1.255206823348999}, "num_episodes": 0, "episode_return_max": 286.6692231913454, "episode_return_min": -53.94695511723343, "episode_return_mean": 102.60472273081903, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 149312, "num_agent_steps_trained": 149312, "num_env_steps_sampled": 37328, "num_env_steps_trained": 37328, "num_env_steps_sampled_this_iter": 0, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 0.0, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 37328, "num_env_steps_sampled_lifetime": 37328, "num_agent_steps_sampled_lifetime": 149312, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 149312, "timers": {"training_iteration_time_ms": 62398.161, "restore_workers_time_ms": 81.086, "training_step_time_ms": 62214.78, "sample_time_ms": 62174.713, "learn_time_ms": 311236.026, "learn_throughput": 59.967, "synch_weights_time_ms": 43.334}, "counters": {"num_env_steps_sampled": 37328, "num_env_steps_trained": 37328, "num_agent_steps_sampled": 149312, "num_agent_steps_trained": 149312}, "done": false, "training_iteration": 28, "trial_id": "d7bca_00000", "date": "2024-08-20_11-59-38", "timestamp": 1724135378, "time_this_iter_s": 134.979798078537, "time_total_s": 4030.184944629669, "pid": 36059, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 16000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b0d8c1f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4030.184944629669, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 59.239805825242705, "ram_util_percent": 87.04174757281552}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {}, "num_env_steps_sampled": 37328, "num_env_steps_trained": 37328, "num_agent_steps_sampled": 149312, "num_agent_steps_trained": 149312}, "env_runners": {"episode_reward_max": 286.6692231913454, "episode_reward_min": -53.94695511723343, "episode_reward_mean": 102.60472273081903, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -382.5350217575324, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 179.13622751357744, "predator_policy": 388.3350217575325}, "policy_reward_mean": {"prey_policy": -50.61742331228365, "predator_policy": 101.91978467769317}, "custom_metrics": {}, "hist_stats": {"episode_reward": [35.10000000000023, -2.2956613079459616, 52.30000000000035, 93.99999999999946, 41.27668545957155, 138.35998813581944, 47.000000000000355, 189.59999999999982, 46.100000000000314, 122.59999999999911, 172.99184762314727, 183.89999999999952, 165.26660970450598, 63.400000000000325, 224.23591029611316, 118.26513246444676, 57.049342065984625, 56.287512516221504, 91.49999999999856, 77.70000000000017, 286.6692231913454, 34.20000000000022, 135.4999999999999, 189.7622134181783, 204.95900501687956, 41.46117592104707, 160.52089757879483, 41.90000000000027, 159.99999999999952, 56.25035590474681, 189.40904152072758, 32.4000000000002, 135.49999999999923, 137.09999999999957, -53.94695511723343, 170.90494465410117, 56.10000000000025, 60.20000000000013, 34.75612756781972, 43.60000000000028, 40.265044310772325, 47.1298862953699, 48.40000000000023, 36.202116310375594, 74.49999999999962, 153.19999999999987, 40.1000000000002, 131.19999999999982, 52.570622032848895, 56.000000000000156, 129.1999999999993, 86.20000000000002, 28.831075919194078, 160.79999999999959, 81.33852172443821, 103.01543537877356, 169.88064982359512, 48.30000000000023, 52.529310579969625, 48.028025438635616, 198.59999999999948, 184.470358209413, 37.06861395355878, 80.95181844992561, 33.900000000000134, 135.39999999999944, 148.89999999999955, 133.69999999999916, 226.89999999999938, 68.3000000000002, 154.45814550558052, 41.47674734270453, 180.74087067540847, 60.139037304427255, 153.66325386820998, 109.81254335834268, 96.80000000000011, 108.61895163315396, 159.3546697445331, 53.10000000000013, 125.29999999999959, 34.93780403323022, 139.0999999999999, 206.80167211533725, 40.50000000000029, 68.40000000000009, 88.29999999999927, 242.69999999999993, 37.700000000000266, 104.09999999999903, 229.34134979067687, 152.6250807412044, 157.8592262743011, 37.26670789146122, 35.20000000000023, 108.04468364708873, 87.5999999999994, 92.41177405235972, 131.94864151087714, 94.40623855187317], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [13.573129738316304, -53.54665936669982, -254.04609845621002, -260.27960040372835, -140.65478211067654, -73.1171426718985, 39.583255312047925, -34.03651010327775, -114.83317908671795, -92.66853807147267, -96.4272326280199, 93.09870255859556, -64.80740741555226, 20.000000000000014, 20.626642410773584, -16.792242611230414, 18.848497587615384, -92.85980597895414, 69.17606926139403, -109.36249015041209, -285.2321358475945, 105.74800812423979, 132.7888944272447, -19.35385941243218, -25.356623210719427, 11.326871936077456, -78.03601550180139, -20.07740583328924, 28.904313331271958, 85.71002709904536, -84.17058524148602, -101.59193807470932, -247.8691803256373, -34.87488956710395, -49.40531904969436, -141.19228141836533, -107.134889946308, 73.87102816456981, 4.171128342528487, -6.373188196460497, 72.0443042732162, -52.54708787865346, -32.67477650531073, -33.11217620680012, 17.408091439294907, -110.92817899556306, 80.28766474857159, -53.604483480981195, 64.90005398718623, -328.3984316256627, -221.37365036394135, -15.540567450569034, -217.97172194166885, 76.83739839192134, -62.4215290072797, -67.19987230581766, 82.82590198976501, -215.4723347673664, -63.01766150909464, -253.83034574412602, -72.05610867549865, 89.36722870345912, -103.9034532802869, -142.29070810227037, 0.5594712651248201, 21.887655692545323, -382.5350217575324, 117.78599718266575, -341.68754507993606, -271.3757928143444, 42.05974767402415, -113.91576456218526, 10.584749159468316, -368.0370289653096, -96.60173288891873, 6.578081936680414, -116.41208622158636, -38.927412945968925, -335.88260364800084, 33.30132488528524, -27.102952922490367, -70.03840438982733, -11.808869660467748, -17.067235360537826, 10.174001800704053, -2.962232113254194, -5.251613856427011, -54.123434986458186, -77.75098136410048, -19.99080009629646, 33.88040540161318, 40.0118549587175, 18.203034292193653, -101.55435256341609, 84.66934503983893, -118.51718584134521, -111.25275039532056, -35.27706169307365, 12.962713255211035, -154.80174341253127, -108.368940102753, 45.92361009447094, 66.26530936409696, -54.85406764413665, -50.32982812857711, -6.234569676365133, 43.52535653925046, -20.284647818951065, -122.72911794687963, -30.02930181547257, 64.88866316909824, -29.828281979136015, 27.845266783971347, 9.541578665059246, 1.103496687474779, 7.009962407567832, -8.299879170194934, -72.54471461247661, -97.58563081684744, -33.94553553761412, 161.42330774007206, -112.95182525200485, -6.1055308568346724, 40.28710026868663, -159.2584299113319, 1.9693763855458568, -203.51123731867187, -41.75335832068283, -112.73519084767737, -9.86848498904447, -75.14768969882805, 64.9005559888798, -41.26096743109789, 11.98667537860044, 89.1022150662958, -53.133135240501986, -21.790897701337713, 102.87572050846154, -103.60518017643587, -2.753002690682439, -77.5059788586302, -136.78681328113666, -35.26167272819433, 0.7616669233566751, 99.3892737675306, -121.76317749732668, -221.41484542454427, -0.26256937414734516, -81.64046493632515, 47.835445195899766, 41.62225202827415, -159.27689309555132, 8.414915969460758, -94.96493654962522, -101.89030278114168, -225.75780180988139, 42.3879814213417, -221.12051631037914, -194.2370444672595, -47.443484467917465, -68.94976936260595, -71.53127552961595, -175.21866179031935, -2.377011043507998, 7.336224962261236, 57.5840314172886, 148.94400313475802, -286.27355747273646, -38.05288701360526, -15.675153673344045, -157.06325915064687, 20.451311784900852, -34.19514158105644, -163.71926844518902, 179.13622751357744, -193.68286217716528, -5.466795255903271, 18.11348646225638, 73.35067178507347, -116.27200227841195, 81.3532898949211, -15.069998875773695, -1.5790888906085807, -103.01419787536915, 39.20269946596015, -70.07117731476804, -109.82064133551206, -6.986631127929058, -36.128808808176835, 15.187313791671755, -14.673585565722401, -251.67950712492743, 6.628822658497688, -90.79739622560763, -223.17849208443, -63.253333383580255, -19.653256456869457, -32.815082218808726, 25.002451968907792, -219.83803663194715], "policy_predator_policy_reward": [5.826870261683667, 69.24665936669969, 324.2059226722713, 187.82411487972215, 153.05478211067583, 113.01714267189817, 17.61674468795218, 70.83651010327776, 56.871368154986286, 191.90703446277513, 141.68851820524378, 0.0, 91.80740741555158, 0.0, 54.17335758922649, 131.5922426112305, 1.0515024123846184, 119.05980597895365, 36.62393073860571, 126.16249015041168, 294.04458931930264, 58.43138602720072, 27.098306487098423, 43.366658498089144, 101.5982771707111, 77.69808380843789, 92.33601550180148, 69.17740583328944, 11.711242094735995, 97.91032777106007, 159.598841430636, 144.42881435000547, 256.62014258831397, 83.17326937041157, 64.7437860571049, 182.14132692717635, 121.33488994630724, 3.428971835429686, 17.92887165747148, 61.97318819646065, 71.37501564844887, 195.79699114833366, 50.574776505310986, 49.41217620680031, 95.99190856070484, 133.02817899556257, 118.64992189155714, 44.429110259031575, 173.65858800042827, 294.7987946549283, 219.5255437438939, 58.84984999166302, 153.020176017792, 148.6350451107507, 84.92152900727922, 86.59987230581754, 35.917401426461, 256.72903135113984, 310.86582010807547, 62.23254304989086, 95.58973110505788, 76.50819038770996, 122.80345328028605, 155.79070810226966, 62.740528734875355, 50.312344307454744, 388.3350217575325, 13.51400281733393, 276.4934910271924, 282.6228917498557, 228.37632836739596, 14.384633174866076, 36.51525084053167, 377.03702896531087, 55.843560999739694, 94.38008995249868, 186.75715567238382, 3.338471062991101, 341.8826036480012, 4.298675114714987, 61.56155472910194, 75.84484689398705, 39.31993402285901, 36.68605729351662, 9.025998199295913, 32.16223211325439, 17.067987561023646, 78.50917759223691, 86.89305015310855, 85.34873130728765, 32.98846306649877, 46.31927657317061, 3.2969657078063443, 120.15435256341586, 51.96603493554656, 113.08180586595923, 51.82953263144456, 147.2709014897984, 28.814437033388117, 169.02459312393165, 122.3689401027523, 69.27638990552909, 2.934690635903009, 71.85406764413669, 69.17481916505344, 16.220654559082863, 82.67464346074956, 54.88464781895127, 149.0452344703959, 85.05170701639402, 61.64654055235777, 6.308513636455049, 122.72811266075166, 9.76569171381375, 28.196503312525255, 11.990037592432142, 39.59465245581429, 93.77925190682629, 173.417858483239, 6.14133330985798, 15.762281811455798, 134.36623570047647, 76.06028203580479, 74.22850676175635, 34.695476680536935, 159.6621907988072, 167.2233660646181, 158.99304802466287, 125.23519084767717, 31.268484989044566, 88.54768969882797, 57.09944401112018, 170.03924007813922, 8.135051974358213, 21.451638560862875, 76.27928161334323, 145.09089770133772, 0.7242794915378635, 119.58478321201947, 55.07339965509877, 101.30347201003724, 267.44746563530987, 25.72851731642294, 50.2482358311191, 10.105741511511418, 193.0090328936931, 242.16798791533478, 39.648464187783205, 159.3499139561802, 28.118359652455005, 62.6282279289202, 164.83895649669932, 73.18508403053936, 110.16493654962441, 168.40666761692708, 267.8603886072499, 213.90796331236706, 124.17924132120368, 231.43704446725934, 63.34348446791769, 164.82322943616253, 100.95781545605833, 192.6461275375021, 19.887349329554755, 38.363775037738804, 35.81596858271153, 113.3458349053624, 230.7853915479533, 54.85288701360539, 39.375153673344265, 203.76325915064663, 1.2486882150991712, 111.99514158105654, 174.21926844518845, 10.863772486422565, 246.3828621771652, 23.366795255903288, 1.686513537743613, 3.0493282149260565, 143.97200227841205, 11.169618052507685, 151.88844071902219, 78.45110531031017, 178.76726219687225, 5.491533832319006, 183.23617029079, 53.44679168121165, 100.62718867369004, 51.62880880817706, 4.512686208328209, 171.62334218999183, 202.77443414774723, 128.4407517753692, 43.32782179174049, 246.32318803637418, 132.52041148399576, 85.60806980806116, 98.80891037849513, 185.52092658311363, 103.72089663179854]}, "sampler_perf": {"mean_raw_obs_processing_ms": 24.612889016885457, "mean_inference_ms": 21.186329230406663, "mean_action_processing_ms": 5.908154806035579, "mean_env_wait_ms": 37.33530745612723, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.09543001651763916, "StateBufferConnector_ms": 0.03673684597015381, "ViewRequirementAgentConnector_ms": 1.255206823348999}, "num_episodes": 0, "episode_return_max": 286.6692231913454, "episode_return_min": -53.94695511723343, "episode_return_mean": 102.60472273081903, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 149312, "num_agent_steps_trained": 149312, "num_env_steps_sampled": 37328, "num_env_steps_trained": 37328, "num_env_steps_sampled_this_iter": 0, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 0.0, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 37328, "num_env_steps_sampled_lifetime": 37328, "num_agent_steps_sampled_lifetime": 149312, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 149312, "timers": {"training_iteration_time_ms": 62843.962, "restore_workers_time_ms": 98.288, "training_step_time_ms": 62628.189, "sample_time_ms": 62582.586, "learn_time_ms": 311236.026, "learn_throughput": 59.967, "synch_weights_time_ms": 43.334}, "counters": {"num_env_steps_sampled": 37328, "num_env_steps_trained": 37328, "num_agent_steps_sampled": 149312, "num_agent_steps_trained": 149312}, "done": false, "training_iteration": 29, "trial_id": "d7bca_00000", "date": "2024-08-20_12-02-00", "timestamp": 1724135520, "time_this_iter_s": 128.21040081977844, "time_total_s": 4158.395345449448, "pid": 36059, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 16000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x32cf28550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4158.395345449448, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 78.58967391304348, "ram_util_percent": 87.32065217391305}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {}, "num_env_steps_sampled": 37328, "num_env_steps_trained": 37328, "num_agent_steps_sampled": 149312, "num_agent_steps_trained": 149312}, "env_runners": {"episode_reward_max": 286.6692231913454, "episode_reward_min": -53.94695511723343, "episode_reward_mean": 102.60472273081903, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -382.5350217575324, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 179.13622751357744, "predator_policy": 388.3350217575325}, "policy_reward_mean": {"prey_policy": -50.61742331228365, "predator_policy": 101.91978467769317}, "custom_metrics": {}, "hist_stats": {"episode_reward": [35.10000000000023, -2.2956613079459616, 52.30000000000035, 93.99999999999946, 41.27668545957155, 138.35998813581944, 47.000000000000355, 189.59999999999982, 46.100000000000314, 122.59999999999911, 172.99184762314727, 183.89999999999952, 165.26660970450598, 63.400000000000325, 224.23591029611316, 118.26513246444676, 57.049342065984625, 56.287512516221504, 91.49999999999856, 77.70000000000017, 286.6692231913454, 34.20000000000022, 135.4999999999999, 189.7622134181783, 204.95900501687956, 41.46117592104707, 160.52089757879483, 41.90000000000027, 159.99999999999952, 56.25035590474681, 189.40904152072758, 32.4000000000002, 135.49999999999923, 137.09999999999957, -53.94695511723343, 170.90494465410117, 56.10000000000025, 60.20000000000013, 34.75612756781972, 43.60000000000028, 40.265044310772325, 47.1298862953699, 48.40000000000023, 36.202116310375594, 74.49999999999962, 153.19999999999987, 40.1000000000002, 131.19999999999982, 52.570622032848895, 56.000000000000156, 129.1999999999993, 86.20000000000002, 28.831075919194078, 160.79999999999959, 81.33852172443821, 103.01543537877356, 169.88064982359512, 48.30000000000023, 52.529310579969625, 48.028025438635616, 198.59999999999948, 184.470358209413, 37.06861395355878, 80.95181844992561, 33.900000000000134, 135.39999999999944, 148.89999999999955, 133.69999999999916, 226.89999999999938, 68.3000000000002, 154.45814550558052, 41.47674734270453, 180.74087067540847, 60.139037304427255, 153.66325386820998, 109.81254335834268, 96.80000000000011, 108.61895163315396, 159.3546697445331, 53.10000000000013, 125.29999999999959, 34.93780403323022, 139.0999999999999, 206.80167211533725, 40.50000000000029, 68.40000000000009, 88.29999999999927, 242.69999999999993, 37.700000000000266, 104.09999999999903, 229.34134979067687, 152.6250807412044, 157.8592262743011, 37.26670789146122, 35.20000000000023, 108.04468364708873, 87.5999999999994, 92.41177405235972, 131.94864151087714, 94.40623855187317], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [13.573129738316304, -53.54665936669982, -254.04609845621002, -260.27960040372835, -140.65478211067654, -73.1171426718985, 39.583255312047925, -34.03651010327775, -114.83317908671795, -92.66853807147267, -96.4272326280199, 93.09870255859556, -64.80740741555226, 20.000000000000014, 20.626642410773584, -16.792242611230414, 18.848497587615384, -92.85980597895414, 69.17606926139403, -109.36249015041209, -285.2321358475945, 105.74800812423979, 132.7888944272447, -19.35385941243218, -25.356623210719427, 11.326871936077456, -78.03601550180139, -20.07740583328924, 28.904313331271958, 85.71002709904536, -84.17058524148602, -101.59193807470932, -247.8691803256373, -34.87488956710395, -49.40531904969436, -141.19228141836533, -107.134889946308, 73.87102816456981, 4.171128342528487, -6.373188196460497, 72.0443042732162, -52.54708787865346, -32.67477650531073, -33.11217620680012, 17.408091439294907, -110.92817899556306, 80.28766474857159, -53.604483480981195, 64.90005398718623, -328.3984316256627, -221.37365036394135, -15.540567450569034, -217.97172194166885, 76.83739839192134, -62.4215290072797, -67.19987230581766, 82.82590198976501, -215.4723347673664, -63.01766150909464, -253.83034574412602, -72.05610867549865, 89.36722870345912, -103.9034532802869, -142.29070810227037, 0.5594712651248201, 21.887655692545323, -382.5350217575324, 117.78599718266575, -341.68754507993606, -271.3757928143444, 42.05974767402415, -113.91576456218526, 10.584749159468316, -368.0370289653096, -96.60173288891873, 6.578081936680414, -116.41208622158636, -38.927412945968925, -335.88260364800084, 33.30132488528524, -27.102952922490367, -70.03840438982733, -11.808869660467748, -17.067235360537826, 10.174001800704053, -2.962232113254194, -5.251613856427011, -54.123434986458186, -77.75098136410048, -19.99080009629646, 33.88040540161318, 40.0118549587175, 18.203034292193653, -101.55435256341609, 84.66934503983893, -118.51718584134521, -111.25275039532056, -35.27706169307365, 12.962713255211035, -154.80174341253127, -108.368940102753, 45.92361009447094, 66.26530936409696, -54.85406764413665, -50.32982812857711, -6.234569676365133, 43.52535653925046, -20.284647818951065, -122.72911794687963, -30.02930181547257, 64.88866316909824, -29.828281979136015, 27.845266783971347, 9.541578665059246, 1.103496687474779, 7.009962407567832, -8.299879170194934, -72.54471461247661, -97.58563081684744, -33.94553553761412, 161.42330774007206, -112.95182525200485, -6.1055308568346724, 40.28710026868663, -159.2584299113319, 1.9693763855458568, -203.51123731867187, -41.75335832068283, -112.73519084767737, -9.86848498904447, -75.14768969882805, 64.9005559888798, -41.26096743109789, 11.98667537860044, 89.1022150662958, -53.133135240501986, -21.790897701337713, 102.87572050846154, -103.60518017643587, -2.753002690682439, -77.5059788586302, -136.78681328113666, -35.26167272819433, 0.7616669233566751, 99.3892737675306, -121.76317749732668, -221.41484542454427, -0.26256937414734516, -81.64046493632515, 47.835445195899766, 41.62225202827415, -159.27689309555132, 8.414915969460758, -94.96493654962522, -101.89030278114168, -225.75780180988139, 42.3879814213417, -221.12051631037914, -194.2370444672595, -47.443484467917465, -68.94976936260595, -71.53127552961595, -175.21866179031935, -2.377011043507998, 7.336224962261236, 57.5840314172886, 148.94400313475802, -286.27355747273646, -38.05288701360526, -15.675153673344045, -157.06325915064687, 20.451311784900852, -34.19514158105644, -163.71926844518902, 179.13622751357744, -193.68286217716528, -5.466795255903271, 18.11348646225638, 73.35067178507347, -116.27200227841195, 81.3532898949211, -15.069998875773695, -1.5790888906085807, -103.01419787536915, 39.20269946596015, -70.07117731476804, -109.82064133551206, -6.986631127929058, -36.128808808176835, 15.187313791671755, -14.673585565722401, -251.67950712492743, 6.628822658497688, -90.79739622560763, -223.17849208443, -63.253333383580255, -19.653256456869457, -32.815082218808726, 25.002451968907792, -219.83803663194715], "policy_predator_policy_reward": [5.826870261683667, 69.24665936669969, 324.2059226722713, 187.82411487972215, 153.05478211067583, 113.01714267189817, 17.61674468795218, 70.83651010327776, 56.871368154986286, 191.90703446277513, 141.68851820524378, 0.0, 91.80740741555158, 0.0, 54.17335758922649, 131.5922426112305, 1.0515024123846184, 119.05980597895365, 36.62393073860571, 126.16249015041168, 294.04458931930264, 58.43138602720072, 27.098306487098423, 43.366658498089144, 101.5982771707111, 77.69808380843789, 92.33601550180148, 69.17740583328944, 11.711242094735995, 97.91032777106007, 159.598841430636, 144.42881435000547, 256.62014258831397, 83.17326937041157, 64.7437860571049, 182.14132692717635, 121.33488994630724, 3.428971835429686, 17.92887165747148, 61.97318819646065, 71.37501564844887, 195.79699114833366, 50.574776505310986, 49.41217620680031, 95.99190856070484, 133.02817899556257, 118.64992189155714, 44.429110259031575, 173.65858800042827, 294.7987946549283, 219.5255437438939, 58.84984999166302, 153.020176017792, 148.6350451107507, 84.92152900727922, 86.59987230581754, 35.917401426461, 256.72903135113984, 310.86582010807547, 62.23254304989086, 95.58973110505788, 76.50819038770996, 122.80345328028605, 155.79070810226966, 62.740528734875355, 50.312344307454744, 388.3350217575325, 13.51400281733393, 276.4934910271924, 282.6228917498557, 228.37632836739596, 14.384633174866076, 36.51525084053167, 377.03702896531087, 55.843560999739694, 94.38008995249868, 186.75715567238382, 3.338471062991101, 341.8826036480012, 4.298675114714987, 61.56155472910194, 75.84484689398705, 39.31993402285901, 36.68605729351662, 9.025998199295913, 32.16223211325439, 17.067987561023646, 78.50917759223691, 86.89305015310855, 85.34873130728765, 32.98846306649877, 46.31927657317061, 3.2969657078063443, 120.15435256341586, 51.96603493554656, 113.08180586595923, 51.82953263144456, 147.2709014897984, 28.814437033388117, 169.02459312393165, 122.3689401027523, 69.27638990552909, 2.934690635903009, 71.85406764413669, 69.17481916505344, 16.220654559082863, 82.67464346074956, 54.88464781895127, 149.0452344703959, 85.05170701639402, 61.64654055235777, 6.308513636455049, 122.72811266075166, 9.76569171381375, 28.196503312525255, 11.990037592432142, 39.59465245581429, 93.77925190682629, 173.417858483239, 6.14133330985798, 15.762281811455798, 134.36623570047647, 76.06028203580479, 74.22850676175635, 34.695476680536935, 159.6621907988072, 167.2233660646181, 158.99304802466287, 125.23519084767717, 31.268484989044566, 88.54768969882797, 57.09944401112018, 170.03924007813922, 8.135051974358213, 21.451638560862875, 76.27928161334323, 145.09089770133772, 0.7242794915378635, 119.58478321201947, 55.07339965509877, 101.30347201003724, 267.44746563530987, 25.72851731642294, 50.2482358311191, 10.105741511511418, 193.0090328936931, 242.16798791533478, 39.648464187783205, 159.3499139561802, 28.118359652455005, 62.6282279289202, 164.83895649669932, 73.18508403053936, 110.16493654962441, 168.40666761692708, 267.8603886072499, 213.90796331236706, 124.17924132120368, 231.43704446725934, 63.34348446791769, 164.82322943616253, 100.95781545605833, 192.6461275375021, 19.887349329554755, 38.363775037738804, 35.81596858271153, 113.3458349053624, 230.7853915479533, 54.85288701360539, 39.375153673344265, 203.76325915064663, 1.2486882150991712, 111.99514158105654, 174.21926844518845, 10.863772486422565, 246.3828621771652, 23.366795255903288, 1.686513537743613, 3.0493282149260565, 143.97200227841205, 11.169618052507685, 151.88844071902219, 78.45110531031017, 178.76726219687225, 5.491533832319006, 183.23617029079, 53.44679168121165, 100.62718867369004, 51.62880880817706, 4.512686208328209, 171.62334218999183, 202.77443414774723, 128.4407517753692, 43.32782179174049, 246.32318803637418, 132.52041148399576, 85.60806980806116, 98.80891037849513, 185.52092658311363, 103.72089663179854]}, "sampler_perf": {"mean_raw_obs_processing_ms": 24.612889016885457, "mean_inference_ms": 21.186329230406663, "mean_action_processing_ms": 5.908154806035579, "mean_env_wait_ms": 37.33530745612723, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.09543001651763916, "StateBufferConnector_ms": 0.03673684597015381, "ViewRequirementAgentConnector_ms": 1.255206823348999}, "num_episodes": 0, "episode_return_max": 286.6692231913454, "episode_return_min": -53.94695511723343, "episode_return_mean": 102.60472273081903, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 149312, "num_agent_steps_trained": 149312, "num_env_steps_sampled": 37328, "num_env_steps_trained": 37328, "num_env_steps_sampled_this_iter": 0, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 0.0, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 37328, "num_env_steps_sampled_lifetime": 37328, "num_agent_steps_sampled_lifetime": 149312, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 149312, "timers": {"training_iteration_time_ms": 62909.899, "restore_workers_time_ms": 102.876, "training_step_time_ms": 62681.805, "sample_time_ms": 62635.699, "learn_time_ms": 311236.026, "learn_throughput": 59.967, "synch_weights_time_ms": 43.334}, "counters": {"num_env_steps_sampled": 37328, "num_env_steps_trained": 37328, "num_agent_steps_sampled": 149312, "num_agent_steps_trained": 149312}, "done": false, "training_iteration": 30, "trial_id": "d7bca_00000", "date": "2024-08-20_12-04-14", "timestamp": 1724135654, "time_this_iter_s": 124.0817379951477, "time_total_s": 4282.477083444595, "pid": 36059, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 16000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x32cf5ba60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4282.477083444595, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 95.93388888888889, "ram_util_percent": 83.77555555555556}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {}, "num_env_steps_sampled": 37328, "num_env_steps_trained": 37328, "num_agent_steps_sampled": 149312, "num_agent_steps_trained": 149312}, "env_runners": {"episode_reward_max": 286.6692231913454, "episode_reward_min": -53.94695511723343, "episode_reward_mean": 102.60472273081903, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -382.5350217575324, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 179.13622751357744, "predator_policy": 388.3350217575325}, "policy_reward_mean": {"prey_policy": -50.61742331228365, "predator_policy": 101.91978467769317}, "custom_metrics": {}, "hist_stats": {"episode_reward": [35.10000000000023, -2.2956613079459616, 52.30000000000035, 93.99999999999946, 41.27668545957155, 138.35998813581944, 47.000000000000355, 189.59999999999982, 46.100000000000314, 122.59999999999911, 172.99184762314727, 183.89999999999952, 165.26660970450598, 63.400000000000325, 224.23591029611316, 118.26513246444676, 57.049342065984625, 56.287512516221504, 91.49999999999856, 77.70000000000017, 286.6692231913454, 34.20000000000022, 135.4999999999999, 189.7622134181783, 204.95900501687956, 41.46117592104707, 160.52089757879483, 41.90000000000027, 159.99999999999952, 56.25035590474681, 189.40904152072758, 32.4000000000002, 135.49999999999923, 137.09999999999957, -53.94695511723343, 170.90494465410117, 56.10000000000025, 60.20000000000013, 34.75612756781972, 43.60000000000028, 40.265044310772325, 47.1298862953699, 48.40000000000023, 36.202116310375594, 74.49999999999962, 153.19999999999987, 40.1000000000002, 131.19999999999982, 52.570622032848895, 56.000000000000156, 129.1999999999993, 86.20000000000002, 28.831075919194078, 160.79999999999959, 81.33852172443821, 103.01543537877356, 169.88064982359512, 48.30000000000023, 52.529310579969625, 48.028025438635616, 198.59999999999948, 184.470358209413, 37.06861395355878, 80.95181844992561, 33.900000000000134, 135.39999999999944, 148.89999999999955, 133.69999999999916, 226.89999999999938, 68.3000000000002, 154.45814550558052, 41.47674734270453, 180.74087067540847, 60.139037304427255, 153.66325386820998, 109.81254335834268, 96.80000000000011, 108.61895163315396, 159.3546697445331, 53.10000000000013, 125.29999999999959, 34.93780403323022, 139.0999999999999, 206.80167211533725, 40.50000000000029, 68.40000000000009, 88.29999999999927, 242.69999999999993, 37.700000000000266, 104.09999999999903, 229.34134979067687, 152.6250807412044, 157.8592262743011, 37.26670789146122, 35.20000000000023, 108.04468364708873, 87.5999999999994, 92.41177405235972, 131.94864151087714, 94.40623855187317], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [13.573129738316304, -53.54665936669982, -254.04609845621002, -260.27960040372835, -140.65478211067654, -73.1171426718985, 39.583255312047925, -34.03651010327775, -114.83317908671795, -92.66853807147267, -96.4272326280199, 93.09870255859556, -64.80740741555226, 20.000000000000014, 20.626642410773584, -16.792242611230414, 18.848497587615384, -92.85980597895414, 69.17606926139403, -109.36249015041209, -285.2321358475945, 105.74800812423979, 132.7888944272447, -19.35385941243218, -25.356623210719427, 11.326871936077456, -78.03601550180139, -20.07740583328924, 28.904313331271958, 85.71002709904536, -84.17058524148602, -101.59193807470932, -247.8691803256373, -34.87488956710395, -49.40531904969436, -141.19228141836533, -107.134889946308, 73.87102816456981, 4.171128342528487, -6.373188196460497, 72.0443042732162, -52.54708787865346, -32.67477650531073, -33.11217620680012, 17.408091439294907, -110.92817899556306, 80.28766474857159, -53.604483480981195, 64.90005398718623, -328.3984316256627, -221.37365036394135, -15.540567450569034, -217.97172194166885, 76.83739839192134, -62.4215290072797, -67.19987230581766, 82.82590198976501, -215.4723347673664, -63.01766150909464, -253.83034574412602, -72.05610867549865, 89.36722870345912, -103.9034532802869, -142.29070810227037, 0.5594712651248201, 21.887655692545323, -382.5350217575324, 117.78599718266575, -341.68754507993606, -271.3757928143444, 42.05974767402415, -113.91576456218526, 10.584749159468316, -368.0370289653096, -96.60173288891873, 6.578081936680414, -116.41208622158636, -38.927412945968925, -335.88260364800084, 33.30132488528524, -27.102952922490367, -70.03840438982733, -11.808869660467748, -17.067235360537826, 10.174001800704053, -2.962232113254194, -5.251613856427011, -54.123434986458186, -77.75098136410048, -19.99080009629646, 33.88040540161318, 40.0118549587175, 18.203034292193653, -101.55435256341609, 84.66934503983893, -118.51718584134521, -111.25275039532056, -35.27706169307365, 12.962713255211035, -154.80174341253127, -108.368940102753, 45.92361009447094, 66.26530936409696, -54.85406764413665, -50.32982812857711, -6.234569676365133, 43.52535653925046, -20.284647818951065, -122.72911794687963, -30.02930181547257, 64.88866316909824, -29.828281979136015, 27.845266783971347, 9.541578665059246, 1.103496687474779, 7.009962407567832, -8.299879170194934, -72.54471461247661, -97.58563081684744, -33.94553553761412, 161.42330774007206, -112.95182525200485, -6.1055308568346724, 40.28710026868663, -159.2584299113319, 1.9693763855458568, -203.51123731867187, -41.75335832068283, -112.73519084767737, -9.86848498904447, -75.14768969882805, 64.9005559888798, -41.26096743109789, 11.98667537860044, 89.1022150662958, -53.133135240501986, -21.790897701337713, 102.87572050846154, -103.60518017643587, -2.753002690682439, -77.5059788586302, -136.78681328113666, -35.26167272819433, 0.7616669233566751, 99.3892737675306, -121.76317749732668, -221.41484542454427, -0.26256937414734516, -81.64046493632515, 47.835445195899766, 41.62225202827415, -159.27689309555132, 8.414915969460758, -94.96493654962522, -101.89030278114168, -225.75780180988139, 42.3879814213417, -221.12051631037914, -194.2370444672595, -47.443484467917465, -68.94976936260595, -71.53127552961595, -175.21866179031935, -2.377011043507998, 7.336224962261236, 57.5840314172886, 148.94400313475802, -286.27355747273646, -38.05288701360526, -15.675153673344045, -157.06325915064687, 20.451311784900852, -34.19514158105644, -163.71926844518902, 179.13622751357744, -193.68286217716528, -5.466795255903271, 18.11348646225638, 73.35067178507347, -116.27200227841195, 81.3532898949211, -15.069998875773695, -1.5790888906085807, -103.01419787536915, 39.20269946596015, -70.07117731476804, -109.82064133551206, -6.986631127929058, -36.128808808176835, 15.187313791671755, -14.673585565722401, -251.67950712492743, 6.628822658497688, -90.79739622560763, -223.17849208443, -63.253333383580255, -19.653256456869457, -32.815082218808726, 25.002451968907792, -219.83803663194715], "policy_predator_policy_reward": [5.826870261683667, 69.24665936669969, 324.2059226722713, 187.82411487972215, 153.05478211067583, 113.01714267189817, 17.61674468795218, 70.83651010327776, 56.871368154986286, 191.90703446277513, 141.68851820524378, 0.0, 91.80740741555158, 0.0, 54.17335758922649, 131.5922426112305, 1.0515024123846184, 119.05980597895365, 36.62393073860571, 126.16249015041168, 294.04458931930264, 58.43138602720072, 27.098306487098423, 43.366658498089144, 101.5982771707111, 77.69808380843789, 92.33601550180148, 69.17740583328944, 11.711242094735995, 97.91032777106007, 159.598841430636, 144.42881435000547, 256.62014258831397, 83.17326937041157, 64.7437860571049, 182.14132692717635, 121.33488994630724, 3.428971835429686, 17.92887165747148, 61.97318819646065, 71.37501564844887, 195.79699114833366, 50.574776505310986, 49.41217620680031, 95.99190856070484, 133.02817899556257, 118.64992189155714, 44.429110259031575, 173.65858800042827, 294.7987946549283, 219.5255437438939, 58.84984999166302, 153.020176017792, 148.6350451107507, 84.92152900727922, 86.59987230581754, 35.917401426461, 256.72903135113984, 310.86582010807547, 62.23254304989086, 95.58973110505788, 76.50819038770996, 122.80345328028605, 155.79070810226966, 62.740528734875355, 50.312344307454744, 388.3350217575325, 13.51400281733393, 276.4934910271924, 282.6228917498557, 228.37632836739596, 14.384633174866076, 36.51525084053167, 377.03702896531087, 55.843560999739694, 94.38008995249868, 186.75715567238382, 3.338471062991101, 341.8826036480012, 4.298675114714987, 61.56155472910194, 75.84484689398705, 39.31993402285901, 36.68605729351662, 9.025998199295913, 32.16223211325439, 17.067987561023646, 78.50917759223691, 86.89305015310855, 85.34873130728765, 32.98846306649877, 46.31927657317061, 3.2969657078063443, 120.15435256341586, 51.96603493554656, 113.08180586595923, 51.82953263144456, 147.2709014897984, 28.814437033388117, 169.02459312393165, 122.3689401027523, 69.27638990552909, 2.934690635903009, 71.85406764413669, 69.17481916505344, 16.220654559082863, 82.67464346074956, 54.88464781895127, 149.0452344703959, 85.05170701639402, 61.64654055235777, 6.308513636455049, 122.72811266075166, 9.76569171381375, 28.196503312525255, 11.990037592432142, 39.59465245581429, 93.77925190682629, 173.417858483239, 6.14133330985798, 15.762281811455798, 134.36623570047647, 76.06028203580479, 74.22850676175635, 34.695476680536935, 159.6621907988072, 167.2233660646181, 158.99304802466287, 125.23519084767717, 31.268484989044566, 88.54768969882797, 57.09944401112018, 170.03924007813922, 8.135051974358213, 21.451638560862875, 76.27928161334323, 145.09089770133772, 0.7242794915378635, 119.58478321201947, 55.07339965509877, 101.30347201003724, 267.44746563530987, 25.72851731642294, 50.2482358311191, 10.105741511511418, 193.0090328936931, 242.16798791533478, 39.648464187783205, 159.3499139561802, 28.118359652455005, 62.6282279289202, 164.83895649669932, 73.18508403053936, 110.16493654962441, 168.40666761692708, 267.8603886072499, 213.90796331236706, 124.17924132120368, 231.43704446725934, 63.34348446791769, 164.82322943616253, 100.95781545605833, 192.6461275375021, 19.887349329554755, 38.363775037738804, 35.81596858271153, 113.3458349053624, 230.7853915479533, 54.85288701360539, 39.375153673344265, 203.76325915064663, 1.2486882150991712, 111.99514158105654, 174.21926844518845, 10.863772486422565, 246.3828621771652, 23.366795255903288, 1.686513537743613, 3.0493282149260565, 143.97200227841205, 11.169618052507685, 151.88844071902219, 78.45110531031017, 178.76726219687225, 5.491533832319006, 183.23617029079, 53.44679168121165, 100.62718867369004, 51.62880880817706, 4.512686208328209, 171.62334218999183, 202.77443414774723, 128.4407517753692, 43.32782179174049, 246.32318803637418, 132.52041148399576, 85.60806980806116, 98.80891037849513, 185.52092658311363, 103.72089663179854]}, "sampler_perf": {"mean_raw_obs_processing_ms": 24.612889016885457, "mean_inference_ms": 21.186329230406663, "mean_action_processing_ms": 5.908154806035579, "mean_env_wait_ms": 37.33530745612723, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.09543001651763916, "StateBufferConnector_ms": 0.03673684597015381, "ViewRequirementAgentConnector_ms": 1.255206823348999}, "num_episodes": 0, "episode_return_max": 286.6692231913454, "episode_return_min": -53.94695511723343, "episode_return_mean": 102.60472273081903, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 149312, "num_agent_steps_trained": 149312, "num_env_steps_sampled": 37328, "num_env_steps_trained": 37328, "num_env_steps_sampled_this_iter": 0, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 0.0, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 37328, "num_env_steps_sampled_lifetime": 37328, "num_agent_steps_sampled_lifetime": 149312, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 149312, "timers": {"training_iteration_time_ms": 62947.088, "restore_workers_time_ms": 106.918, "training_step_time_ms": 62715.08, "sample_time_ms": 62667.937, "learn_time_ms": 311236.026, "learn_throughput": 59.967, "synch_weights_time_ms": 43.334}, "counters": {"num_env_steps_sampled": 37328, "num_env_steps_trained": 37328, "num_agent_steps_sampled": 149312, "num_agent_steps_trained": 149312}, "done": false, "training_iteration": 31, "trial_id": "d7bca_00000", "date": "2024-08-20_12-06-23", "timestamp": 1724135783, "time_this_iter_s": 123.56184506416321, "time_total_s": 4406.0389285087585, "pid": 36059, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 16000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b0d8caf0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4406.0389285087585, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 98.42658959537575, "ram_util_percent": 83.64682080924857}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {}, "num_env_steps_sampled": 37328, "num_env_steps_trained": 37328, "num_agent_steps_sampled": 149312, "num_agent_steps_trained": 149312}, "env_runners": {"episode_reward_max": 286.6692231913454, "episode_reward_min": -53.94695511723343, "episode_reward_mean": 102.60472273081903, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -382.5350217575324, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 179.13622751357744, "predator_policy": 388.3350217575325}, "policy_reward_mean": {"prey_policy": -50.61742331228365, "predator_policy": 101.91978467769317}, "custom_metrics": {}, "hist_stats": {"episode_reward": [35.10000000000023, -2.2956613079459616, 52.30000000000035, 93.99999999999946, 41.27668545957155, 138.35998813581944, 47.000000000000355, 189.59999999999982, 46.100000000000314, 122.59999999999911, 172.99184762314727, 183.89999999999952, 165.26660970450598, 63.400000000000325, 224.23591029611316, 118.26513246444676, 57.049342065984625, 56.287512516221504, 91.49999999999856, 77.70000000000017, 286.6692231913454, 34.20000000000022, 135.4999999999999, 189.7622134181783, 204.95900501687956, 41.46117592104707, 160.52089757879483, 41.90000000000027, 159.99999999999952, 56.25035590474681, 189.40904152072758, 32.4000000000002, 135.49999999999923, 137.09999999999957, -53.94695511723343, 170.90494465410117, 56.10000000000025, 60.20000000000013, 34.75612756781972, 43.60000000000028, 40.265044310772325, 47.1298862953699, 48.40000000000023, 36.202116310375594, 74.49999999999962, 153.19999999999987, 40.1000000000002, 131.19999999999982, 52.570622032848895, 56.000000000000156, 129.1999999999993, 86.20000000000002, 28.831075919194078, 160.79999999999959, 81.33852172443821, 103.01543537877356, 169.88064982359512, 48.30000000000023, 52.529310579969625, 48.028025438635616, 198.59999999999948, 184.470358209413, 37.06861395355878, 80.95181844992561, 33.900000000000134, 135.39999999999944, 148.89999999999955, 133.69999999999916, 226.89999999999938, 68.3000000000002, 154.45814550558052, 41.47674734270453, 180.74087067540847, 60.139037304427255, 153.66325386820998, 109.81254335834268, 96.80000000000011, 108.61895163315396, 159.3546697445331, 53.10000000000013, 125.29999999999959, 34.93780403323022, 139.0999999999999, 206.80167211533725, 40.50000000000029, 68.40000000000009, 88.29999999999927, 242.69999999999993, 37.700000000000266, 104.09999999999903, 229.34134979067687, 152.6250807412044, 157.8592262743011, 37.26670789146122, 35.20000000000023, 108.04468364708873, 87.5999999999994, 92.41177405235972, 131.94864151087714, 94.40623855187317], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [13.573129738316304, -53.54665936669982, -254.04609845621002, -260.27960040372835, -140.65478211067654, -73.1171426718985, 39.583255312047925, -34.03651010327775, -114.83317908671795, -92.66853807147267, -96.4272326280199, 93.09870255859556, -64.80740741555226, 20.000000000000014, 20.626642410773584, -16.792242611230414, 18.848497587615384, -92.85980597895414, 69.17606926139403, -109.36249015041209, -285.2321358475945, 105.74800812423979, 132.7888944272447, -19.35385941243218, -25.356623210719427, 11.326871936077456, -78.03601550180139, -20.07740583328924, 28.904313331271958, 85.71002709904536, -84.17058524148602, -101.59193807470932, -247.8691803256373, -34.87488956710395, -49.40531904969436, -141.19228141836533, -107.134889946308, 73.87102816456981, 4.171128342528487, -6.373188196460497, 72.0443042732162, -52.54708787865346, -32.67477650531073, -33.11217620680012, 17.408091439294907, -110.92817899556306, 80.28766474857159, -53.604483480981195, 64.90005398718623, -328.3984316256627, -221.37365036394135, -15.540567450569034, -217.97172194166885, 76.83739839192134, -62.4215290072797, -67.19987230581766, 82.82590198976501, -215.4723347673664, -63.01766150909464, -253.83034574412602, -72.05610867549865, 89.36722870345912, -103.9034532802869, -142.29070810227037, 0.5594712651248201, 21.887655692545323, -382.5350217575324, 117.78599718266575, -341.68754507993606, -271.3757928143444, 42.05974767402415, -113.91576456218526, 10.584749159468316, -368.0370289653096, -96.60173288891873, 6.578081936680414, -116.41208622158636, -38.927412945968925, -335.88260364800084, 33.30132488528524, -27.102952922490367, -70.03840438982733, -11.808869660467748, -17.067235360537826, 10.174001800704053, -2.962232113254194, -5.251613856427011, -54.123434986458186, -77.75098136410048, -19.99080009629646, 33.88040540161318, 40.0118549587175, 18.203034292193653, -101.55435256341609, 84.66934503983893, -118.51718584134521, -111.25275039532056, -35.27706169307365, 12.962713255211035, -154.80174341253127, -108.368940102753, 45.92361009447094, 66.26530936409696, -54.85406764413665, -50.32982812857711, -6.234569676365133, 43.52535653925046, -20.284647818951065, -122.72911794687963, -30.02930181547257, 64.88866316909824, -29.828281979136015, 27.845266783971347, 9.541578665059246, 1.103496687474779, 7.009962407567832, -8.299879170194934, -72.54471461247661, -97.58563081684744, -33.94553553761412, 161.42330774007206, -112.95182525200485, -6.1055308568346724, 40.28710026868663, -159.2584299113319, 1.9693763855458568, -203.51123731867187, -41.75335832068283, -112.73519084767737, -9.86848498904447, -75.14768969882805, 64.9005559888798, -41.26096743109789, 11.98667537860044, 89.1022150662958, -53.133135240501986, -21.790897701337713, 102.87572050846154, -103.60518017643587, -2.753002690682439, -77.5059788586302, -136.78681328113666, -35.26167272819433, 0.7616669233566751, 99.3892737675306, -121.76317749732668, -221.41484542454427, -0.26256937414734516, -81.64046493632515, 47.835445195899766, 41.62225202827415, -159.27689309555132, 8.414915969460758, -94.96493654962522, -101.89030278114168, -225.75780180988139, 42.3879814213417, -221.12051631037914, -194.2370444672595, -47.443484467917465, -68.94976936260595, -71.53127552961595, -175.21866179031935, -2.377011043507998, 7.336224962261236, 57.5840314172886, 148.94400313475802, -286.27355747273646, -38.05288701360526, -15.675153673344045, -157.06325915064687, 20.451311784900852, -34.19514158105644, -163.71926844518902, 179.13622751357744, -193.68286217716528, -5.466795255903271, 18.11348646225638, 73.35067178507347, -116.27200227841195, 81.3532898949211, -15.069998875773695, -1.5790888906085807, -103.01419787536915, 39.20269946596015, -70.07117731476804, -109.82064133551206, -6.986631127929058, -36.128808808176835, 15.187313791671755, -14.673585565722401, -251.67950712492743, 6.628822658497688, -90.79739622560763, -223.17849208443, -63.253333383580255, -19.653256456869457, -32.815082218808726, 25.002451968907792, -219.83803663194715], "policy_predator_policy_reward": [5.826870261683667, 69.24665936669969, 324.2059226722713, 187.82411487972215, 153.05478211067583, 113.01714267189817, 17.61674468795218, 70.83651010327776, 56.871368154986286, 191.90703446277513, 141.68851820524378, 0.0, 91.80740741555158, 0.0, 54.17335758922649, 131.5922426112305, 1.0515024123846184, 119.05980597895365, 36.62393073860571, 126.16249015041168, 294.04458931930264, 58.43138602720072, 27.098306487098423, 43.366658498089144, 101.5982771707111, 77.69808380843789, 92.33601550180148, 69.17740583328944, 11.711242094735995, 97.91032777106007, 159.598841430636, 144.42881435000547, 256.62014258831397, 83.17326937041157, 64.7437860571049, 182.14132692717635, 121.33488994630724, 3.428971835429686, 17.92887165747148, 61.97318819646065, 71.37501564844887, 195.79699114833366, 50.574776505310986, 49.41217620680031, 95.99190856070484, 133.02817899556257, 118.64992189155714, 44.429110259031575, 173.65858800042827, 294.7987946549283, 219.5255437438939, 58.84984999166302, 153.020176017792, 148.6350451107507, 84.92152900727922, 86.59987230581754, 35.917401426461, 256.72903135113984, 310.86582010807547, 62.23254304989086, 95.58973110505788, 76.50819038770996, 122.80345328028605, 155.79070810226966, 62.740528734875355, 50.312344307454744, 388.3350217575325, 13.51400281733393, 276.4934910271924, 282.6228917498557, 228.37632836739596, 14.384633174866076, 36.51525084053167, 377.03702896531087, 55.843560999739694, 94.38008995249868, 186.75715567238382, 3.338471062991101, 341.8826036480012, 4.298675114714987, 61.56155472910194, 75.84484689398705, 39.31993402285901, 36.68605729351662, 9.025998199295913, 32.16223211325439, 17.067987561023646, 78.50917759223691, 86.89305015310855, 85.34873130728765, 32.98846306649877, 46.31927657317061, 3.2969657078063443, 120.15435256341586, 51.96603493554656, 113.08180586595923, 51.82953263144456, 147.2709014897984, 28.814437033388117, 169.02459312393165, 122.3689401027523, 69.27638990552909, 2.934690635903009, 71.85406764413669, 69.17481916505344, 16.220654559082863, 82.67464346074956, 54.88464781895127, 149.0452344703959, 85.05170701639402, 61.64654055235777, 6.308513636455049, 122.72811266075166, 9.76569171381375, 28.196503312525255, 11.990037592432142, 39.59465245581429, 93.77925190682629, 173.417858483239, 6.14133330985798, 15.762281811455798, 134.36623570047647, 76.06028203580479, 74.22850676175635, 34.695476680536935, 159.6621907988072, 167.2233660646181, 158.99304802466287, 125.23519084767717, 31.268484989044566, 88.54768969882797, 57.09944401112018, 170.03924007813922, 8.135051974358213, 21.451638560862875, 76.27928161334323, 145.09089770133772, 0.7242794915378635, 119.58478321201947, 55.07339965509877, 101.30347201003724, 267.44746563530987, 25.72851731642294, 50.2482358311191, 10.105741511511418, 193.0090328936931, 242.16798791533478, 39.648464187783205, 159.3499139561802, 28.118359652455005, 62.6282279289202, 164.83895649669932, 73.18508403053936, 110.16493654962441, 168.40666761692708, 267.8603886072499, 213.90796331236706, 124.17924132120368, 231.43704446725934, 63.34348446791769, 164.82322943616253, 100.95781545605833, 192.6461275375021, 19.887349329554755, 38.363775037738804, 35.81596858271153, 113.3458349053624, 230.7853915479533, 54.85288701360539, 39.375153673344265, 203.76325915064663, 1.2486882150991712, 111.99514158105654, 174.21926844518845, 10.863772486422565, 246.3828621771652, 23.366795255903288, 1.686513537743613, 3.0493282149260565, 143.97200227841205, 11.169618052507685, 151.88844071902219, 78.45110531031017, 178.76726219687225, 5.491533832319006, 183.23617029079, 53.44679168121165, 100.62718867369004, 51.62880880817706, 4.512686208328209, 171.62334218999183, 202.77443414774723, 128.4407517753692, 43.32782179174049, 246.32318803637418, 132.52041148399576, 85.60806980806116, 98.80891037849513, 185.52092658311363, 103.72089663179854]}, "sampler_perf": {"mean_raw_obs_processing_ms": 24.612889016885457, "mean_inference_ms": 21.186329230406663, "mean_action_processing_ms": 5.908154806035579, "mean_env_wait_ms": 37.33530745612723, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.09543001651763916, "StateBufferConnector_ms": 0.03673684597015381, "ViewRequirementAgentConnector_ms": 1.255206823348999}, "num_episodes": 0, "episode_return_max": 286.6692231913454, "episode_return_min": -53.94695511723343, "episode_return_mean": 102.60472273081903, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 149312, "num_agent_steps_trained": 149312, "num_env_steps_sampled": 37328, "num_env_steps_trained": 37328, "num_env_steps_sampled_this_iter": 0, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 0.0, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 37328, "num_env_steps_sampled_lifetime": 37328, "num_agent_steps_sampled_lifetime": 149312, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 149312, "timers": {"training_iteration_time_ms": 63008.828, "restore_workers_time_ms": 107.598, "training_step_time_ms": 62765.593, "sample_time_ms": 62720.597, "learn_time_ms": 311236.026, "learn_throughput": 59.967, "synch_weights_time_ms": 43.334}, "counters": {"num_env_steps_sampled": 37328, "num_env_steps_trained": 37328, "num_agent_steps_sampled": 149312, "num_agent_steps_trained": 149312}, "done": false, "training_iteration": 32, "trial_id": "d7bca_00000", "date": "2024-08-20_12-08-32", "timestamp": 1724135912, "time_this_iter_s": 124.5038149356842, "time_total_s": 4530.542743444443, "pid": 36059, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 16000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x32cf5bd30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4530.542743444443, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 97.92573099415202, "ram_util_percent": 83.57192982456142}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {}, "num_env_steps_sampled": 37328, "num_env_steps_trained": 37328, "num_agent_steps_sampled": 149312, "num_agent_steps_trained": 149312}, "env_runners": {"episode_reward_max": 286.6692231913454, "episode_reward_min": -53.94695511723343, "episode_reward_mean": 102.60472273081903, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -382.5350217575324, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 179.13622751357744, "predator_policy": 388.3350217575325}, "policy_reward_mean": {"prey_policy": -50.61742331228365, "predator_policy": 101.91978467769317}, "custom_metrics": {}, "hist_stats": {"episode_reward": [35.10000000000023, -2.2956613079459616, 52.30000000000035, 93.99999999999946, 41.27668545957155, 138.35998813581944, 47.000000000000355, 189.59999999999982, 46.100000000000314, 122.59999999999911, 172.99184762314727, 183.89999999999952, 165.26660970450598, 63.400000000000325, 224.23591029611316, 118.26513246444676, 57.049342065984625, 56.287512516221504, 91.49999999999856, 77.70000000000017, 286.6692231913454, 34.20000000000022, 135.4999999999999, 189.7622134181783, 204.95900501687956, 41.46117592104707, 160.52089757879483, 41.90000000000027, 159.99999999999952, 56.25035590474681, 189.40904152072758, 32.4000000000002, 135.49999999999923, 137.09999999999957, -53.94695511723343, 170.90494465410117, 56.10000000000025, 60.20000000000013, 34.75612756781972, 43.60000000000028, 40.265044310772325, 47.1298862953699, 48.40000000000023, 36.202116310375594, 74.49999999999962, 153.19999999999987, 40.1000000000002, 131.19999999999982, 52.570622032848895, 56.000000000000156, 129.1999999999993, 86.20000000000002, 28.831075919194078, 160.79999999999959, 81.33852172443821, 103.01543537877356, 169.88064982359512, 48.30000000000023, 52.529310579969625, 48.028025438635616, 198.59999999999948, 184.470358209413, 37.06861395355878, 80.95181844992561, 33.900000000000134, 135.39999999999944, 148.89999999999955, 133.69999999999916, 226.89999999999938, 68.3000000000002, 154.45814550558052, 41.47674734270453, 180.74087067540847, 60.139037304427255, 153.66325386820998, 109.81254335834268, 96.80000000000011, 108.61895163315396, 159.3546697445331, 53.10000000000013, 125.29999999999959, 34.93780403323022, 139.0999999999999, 206.80167211533725, 40.50000000000029, 68.40000000000009, 88.29999999999927, 242.69999999999993, 37.700000000000266, 104.09999999999903, 229.34134979067687, 152.6250807412044, 157.8592262743011, 37.26670789146122, 35.20000000000023, 108.04468364708873, 87.5999999999994, 92.41177405235972, 131.94864151087714, 94.40623855187317], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [13.573129738316304, -53.54665936669982, -254.04609845621002, -260.27960040372835, -140.65478211067654, -73.1171426718985, 39.583255312047925, -34.03651010327775, -114.83317908671795, -92.66853807147267, -96.4272326280199, 93.09870255859556, -64.80740741555226, 20.000000000000014, 20.626642410773584, -16.792242611230414, 18.848497587615384, -92.85980597895414, 69.17606926139403, -109.36249015041209, -285.2321358475945, 105.74800812423979, 132.7888944272447, -19.35385941243218, -25.356623210719427, 11.326871936077456, -78.03601550180139, -20.07740583328924, 28.904313331271958, 85.71002709904536, -84.17058524148602, -101.59193807470932, -247.8691803256373, -34.87488956710395, -49.40531904969436, -141.19228141836533, -107.134889946308, 73.87102816456981, 4.171128342528487, -6.373188196460497, 72.0443042732162, -52.54708787865346, -32.67477650531073, -33.11217620680012, 17.408091439294907, -110.92817899556306, 80.28766474857159, -53.604483480981195, 64.90005398718623, -328.3984316256627, -221.37365036394135, -15.540567450569034, -217.97172194166885, 76.83739839192134, -62.4215290072797, -67.19987230581766, 82.82590198976501, -215.4723347673664, -63.01766150909464, -253.83034574412602, -72.05610867549865, 89.36722870345912, -103.9034532802869, -142.29070810227037, 0.5594712651248201, 21.887655692545323, -382.5350217575324, 117.78599718266575, -341.68754507993606, -271.3757928143444, 42.05974767402415, -113.91576456218526, 10.584749159468316, -368.0370289653096, -96.60173288891873, 6.578081936680414, -116.41208622158636, -38.927412945968925, -335.88260364800084, 33.30132488528524, -27.102952922490367, -70.03840438982733, -11.808869660467748, -17.067235360537826, 10.174001800704053, -2.962232113254194, -5.251613856427011, -54.123434986458186, -77.75098136410048, -19.99080009629646, 33.88040540161318, 40.0118549587175, 18.203034292193653, -101.55435256341609, 84.66934503983893, -118.51718584134521, -111.25275039532056, -35.27706169307365, 12.962713255211035, -154.80174341253127, -108.368940102753, 45.92361009447094, 66.26530936409696, -54.85406764413665, -50.32982812857711, -6.234569676365133, 43.52535653925046, -20.284647818951065, -122.72911794687963, -30.02930181547257, 64.88866316909824, -29.828281979136015, 27.845266783971347, 9.541578665059246, 1.103496687474779, 7.009962407567832, -8.299879170194934, -72.54471461247661, -97.58563081684744, -33.94553553761412, 161.42330774007206, -112.95182525200485, -6.1055308568346724, 40.28710026868663, -159.2584299113319, 1.9693763855458568, -203.51123731867187, -41.75335832068283, -112.73519084767737, -9.86848498904447, -75.14768969882805, 64.9005559888798, -41.26096743109789, 11.98667537860044, 89.1022150662958, -53.133135240501986, -21.790897701337713, 102.87572050846154, -103.60518017643587, -2.753002690682439, -77.5059788586302, -136.78681328113666, -35.26167272819433, 0.7616669233566751, 99.3892737675306, -121.76317749732668, -221.41484542454427, -0.26256937414734516, -81.64046493632515, 47.835445195899766, 41.62225202827415, -159.27689309555132, 8.414915969460758, -94.96493654962522, -101.89030278114168, -225.75780180988139, 42.3879814213417, -221.12051631037914, -194.2370444672595, -47.443484467917465, -68.94976936260595, -71.53127552961595, -175.21866179031935, -2.377011043507998, 7.336224962261236, 57.5840314172886, 148.94400313475802, -286.27355747273646, -38.05288701360526, -15.675153673344045, -157.06325915064687, 20.451311784900852, -34.19514158105644, -163.71926844518902, 179.13622751357744, -193.68286217716528, -5.466795255903271, 18.11348646225638, 73.35067178507347, -116.27200227841195, 81.3532898949211, -15.069998875773695, -1.5790888906085807, -103.01419787536915, 39.20269946596015, -70.07117731476804, -109.82064133551206, -6.986631127929058, -36.128808808176835, 15.187313791671755, -14.673585565722401, -251.67950712492743, 6.628822658497688, -90.79739622560763, -223.17849208443, -63.253333383580255, -19.653256456869457, -32.815082218808726, 25.002451968907792, -219.83803663194715], "policy_predator_policy_reward": [5.826870261683667, 69.24665936669969, 324.2059226722713, 187.82411487972215, 153.05478211067583, 113.01714267189817, 17.61674468795218, 70.83651010327776, 56.871368154986286, 191.90703446277513, 141.68851820524378, 0.0, 91.80740741555158, 0.0, 54.17335758922649, 131.5922426112305, 1.0515024123846184, 119.05980597895365, 36.62393073860571, 126.16249015041168, 294.04458931930264, 58.43138602720072, 27.098306487098423, 43.366658498089144, 101.5982771707111, 77.69808380843789, 92.33601550180148, 69.17740583328944, 11.711242094735995, 97.91032777106007, 159.598841430636, 144.42881435000547, 256.62014258831397, 83.17326937041157, 64.7437860571049, 182.14132692717635, 121.33488994630724, 3.428971835429686, 17.92887165747148, 61.97318819646065, 71.37501564844887, 195.79699114833366, 50.574776505310986, 49.41217620680031, 95.99190856070484, 133.02817899556257, 118.64992189155714, 44.429110259031575, 173.65858800042827, 294.7987946549283, 219.5255437438939, 58.84984999166302, 153.020176017792, 148.6350451107507, 84.92152900727922, 86.59987230581754, 35.917401426461, 256.72903135113984, 310.86582010807547, 62.23254304989086, 95.58973110505788, 76.50819038770996, 122.80345328028605, 155.79070810226966, 62.740528734875355, 50.312344307454744, 388.3350217575325, 13.51400281733393, 276.4934910271924, 282.6228917498557, 228.37632836739596, 14.384633174866076, 36.51525084053167, 377.03702896531087, 55.843560999739694, 94.38008995249868, 186.75715567238382, 3.338471062991101, 341.8826036480012, 4.298675114714987, 61.56155472910194, 75.84484689398705, 39.31993402285901, 36.68605729351662, 9.025998199295913, 32.16223211325439, 17.067987561023646, 78.50917759223691, 86.89305015310855, 85.34873130728765, 32.98846306649877, 46.31927657317061, 3.2969657078063443, 120.15435256341586, 51.96603493554656, 113.08180586595923, 51.82953263144456, 147.2709014897984, 28.814437033388117, 169.02459312393165, 122.3689401027523, 69.27638990552909, 2.934690635903009, 71.85406764413669, 69.17481916505344, 16.220654559082863, 82.67464346074956, 54.88464781895127, 149.0452344703959, 85.05170701639402, 61.64654055235777, 6.308513636455049, 122.72811266075166, 9.76569171381375, 28.196503312525255, 11.990037592432142, 39.59465245581429, 93.77925190682629, 173.417858483239, 6.14133330985798, 15.762281811455798, 134.36623570047647, 76.06028203580479, 74.22850676175635, 34.695476680536935, 159.6621907988072, 167.2233660646181, 158.99304802466287, 125.23519084767717, 31.268484989044566, 88.54768969882797, 57.09944401112018, 170.03924007813922, 8.135051974358213, 21.451638560862875, 76.27928161334323, 145.09089770133772, 0.7242794915378635, 119.58478321201947, 55.07339965509877, 101.30347201003724, 267.44746563530987, 25.72851731642294, 50.2482358311191, 10.105741511511418, 193.0090328936931, 242.16798791533478, 39.648464187783205, 159.3499139561802, 28.118359652455005, 62.6282279289202, 164.83895649669932, 73.18508403053936, 110.16493654962441, 168.40666761692708, 267.8603886072499, 213.90796331236706, 124.17924132120368, 231.43704446725934, 63.34348446791769, 164.82322943616253, 100.95781545605833, 192.6461275375021, 19.887349329554755, 38.363775037738804, 35.81596858271153, 113.3458349053624, 230.7853915479533, 54.85288701360539, 39.375153673344265, 203.76325915064663, 1.2486882150991712, 111.99514158105654, 174.21926844518845, 10.863772486422565, 246.3828621771652, 23.366795255903288, 1.686513537743613, 3.0493282149260565, 143.97200227841205, 11.169618052507685, 151.88844071902219, 78.45110531031017, 178.76726219687225, 5.491533832319006, 183.23617029079, 53.44679168121165, 100.62718867369004, 51.62880880817706, 4.512686208328209, 171.62334218999183, 202.77443414774723, 128.4407517753692, 43.32782179174049, 246.32318803637418, 132.52041148399576, 85.60806980806116, 98.80891037849513, 185.52092658311363, 103.72089663179854]}, "sampler_perf": {"mean_raw_obs_processing_ms": 24.612889016885457, "mean_inference_ms": 21.186329230406663, "mean_action_processing_ms": 5.908154806035579, "mean_env_wait_ms": 37.33530745612723, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.09543001651763916, "StateBufferConnector_ms": 0.03673684597015381, "ViewRequirementAgentConnector_ms": 1.255206823348999}, "num_episodes": 0, "episode_return_max": 286.6692231913454, "episode_return_min": -53.94695511723343, "episode_return_mean": 102.60472273081903, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 149312, "num_agent_steps_trained": 149312, "num_env_steps_sampled": 37328, "num_env_steps_trained": 37328, "num_env_steps_sampled_this_iter": 0, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 0.0, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 37328, "num_env_steps_sampled_lifetime": 37328, "num_agent_steps_sampled_lifetime": 149312, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 149312, "timers": {"training_iteration_time_ms": 63081.858, "restore_workers_time_ms": 106.183, "training_step_time_ms": 62834.321, "sample_time_ms": 62787.586, "learn_time_ms": 311236.026, "learn_throughput": 59.967, "synch_weights_time_ms": 43.334}, "counters": {"num_env_steps_sampled": 37328, "num_env_steps_trained": 37328, "num_agent_steps_sampled": 149312, "num_agent_steps_trained": 149312}, "done": false, "training_iteration": 33, "trial_id": "d7bca_00000", "date": "2024-08-20_12-10-41", "timestamp": 1724136041, "time_this_iter_s": 124.13500499725342, "time_total_s": 4654.677748441696, "pid": 36059, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 16000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b0d6ca60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4654.677748441696, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 97.8479532163743, "ram_util_percent": 83.62163742690059}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {}, "num_env_steps_sampled": 37328, "num_env_steps_trained": 37328, "num_agent_steps_sampled": 149312, "num_agent_steps_trained": 149312}, "env_runners": {"episode_reward_max": 286.6692231913454, "episode_reward_min": -53.94695511723343, "episode_reward_mean": 102.60472273081903, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -382.5350217575324, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 179.13622751357744, "predator_policy": 388.3350217575325}, "policy_reward_mean": {"prey_policy": -50.61742331228365, "predator_policy": 101.91978467769317}, "custom_metrics": {}, "hist_stats": {"episode_reward": [35.10000000000023, -2.2956613079459616, 52.30000000000035, 93.99999999999946, 41.27668545957155, 138.35998813581944, 47.000000000000355, 189.59999999999982, 46.100000000000314, 122.59999999999911, 172.99184762314727, 183.89999999999952, 165.26660970450598, 63.400000000000325, 224.23591029611316, 118.26513246444676, 57.049342065984625, 56.287512516221504, 91.49999999999856, 77.70000000000017, 286.6692231913454, 34.20000000000022, 135.4999999999999, 189.7622134181783, 204.95900501687956, 41.46117592104707, 160.52089757879483, 41.90000000000027, 159.99999999999952, 56.25035590474681, 189.40904152072758, 32.4000000000002, 135.49999999999923, 137.09999999999957, -53.94695511723343, 170.90494465410117, 56.10000000000025, 60.20000000000013, 34.75612756781972, 43.60000000000028, 40.265044310772325, 47.1298862953699, 48.40000000000023, 36.202116310375594, 74.49999999999962, 153.19999999999987, 40.1000000000002, 131.19999999999982, 52.570622032848895, 56.000000000000156, 129.1999999999993, 86.20000000000002, 28.831075919194078, 160.79999999999959, 81.33852172443821, 103.01543537877356, 169.88064982359512, 48.30000000000023, 52.529310579969625, 48.028025438635616, 198.59999999999948, 184.470358209413, 37.06861395355878, 80.95181844992561, 33.900000000000134, 135.39999999999944, 148.89999999999955, 133.69999999999916, 226.89999999999938, 68.3000000000002, 154.45814550558052, 41.47674734270453, 180.74087067540847, 60.139037304427255, 153.66325386820998, 109.81254335834268, 96.80000000000011, 108.61895163315396, 159.3546697445331, 53.10000000000013, 125.29999999999959, 34.93780403323022, 139.0999999999999, 206.80167211533725, 40.50000000000029, 68.40000000000009, 88.29999999999927, 242.69999999999993, 37.700000000000266, 104.09999999999903, 229.34134979067687, 152.6250807412044, 157.8592262743011, 37.26670789146122, 35.20000000000023, 108.04468364708873, 87.5999999999994, 92.41177405235972, 131.94864151087714, 94.40623855187317], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [13.573129738316304, -53.54665936669982, -254.04609845621002, -260.27960040372835, -140.65478211067654, -73.1171426718985, 39.583255312047925, -34.03651010327775, -114.83317908671795, -92.66853807147267, -96.4272326280199, 93.09870255859556, -64.80740741555226, 20.000000000000014, 20.626642410773584, -16.792242611230414, 18.848497587615384, -92.85980597895414, 69.17606926139403, -109.36249015041209, -285.2321358475945, 105.74800812423979, 132.7888944272447, -19.35385941243218, -25.356623210719427, 11.326871936077456, -78.03601550180139, -20.07740583328924, 28.904313331271958, 85.71002709904536, -84.17058524148602, -101.59193807470932, -247.8691803256373, -34.87488956710395, -49.40531904969436, -141.19228141836533, -107.134889946308, 73.87102816456981, 4.171128342528487, -6.373188196460497, 72.0443042732162, -52.54708787865346, -32.67477650531073, -33.11217620680012, 17.408091439294907, -110.92817899556306, 80.28766474857159, -53.604483480981195, 64.90005398718623, -328.3984316256627, -221.37365036394135, -15.540567450569034, -217.97172194166885, 76.83739839192134, -62.4215290072797, -67.19987230581766, 82.82590198976501, -215.4723347673664, -63.01766150909464, -253.83034574412602, -72.05610867549865, 89.36722870345912, -103.9034532802869, -142.29070810227037, 0.5594712651248201, 21.887655692545323, -382.5350217575324, 117.78599718266575, -341.68754507993606, -271.3757928143444, 42.05974767402415, -113.91576456218526, 10.584749159468316, -368.0370289653096, -96.60173288891873, 6.578081936680414, -116.41208622158636, -38.927412945968925, -335.88260364800084, 33.30132488528524, -27.102952922490367, -70.03840438982733, -11.808869660467748, -17.067235360537826, 10.174001800704053, -2.962232113254194, -5.251613856427011, -54.123434986458186, -77.75098136410048, -19.99080009629646, 33.88040540161318, 40.0118549587175, 18.203034292193653, -101.55435256341609, 84.66934503983893, -118.51718584134521, -111.25275039532056, -35.27706169307365, 12.962713255211035, -154.80174341253127, -108.368940102753, 45.92361009447094, 66.26530936409696, -54.85406764413665, -50.32982812857711, -6.234569676365133, 43.52535653925046, -20.284647818951065, -122.72911794687963, -30.02930181547257, 64.88866316909824, -29.828281979136015, 27.845266783971347, 9.541578665059246, 1.103496687474779, 7.009962407567832, -8.299879170194934, -72.54471461247661, -97.58563081684744, -33.94553553761412, 161.42330774007206, -112.95182525200485, -6.1055308568346724, 40.28710026868663, -159.2584299113319, 1.9693763855458568, -203.51123731867187, -41.75335832068283, -112.73519084767737, -9.86848498904447, -75.14768969882805, 64.9005559888798, -41.26096743109789, 11.98667537860044, 89.1022150662958, -53.133135240501986, -21.790897701337713, 102.87572050846154, -103.60518017643587, -2.753002690682439, -77.5059788586302, -136.78681328113666, -35.26167272819433, 0.7616669233566751, 99.3892737675306, -121.76317749732668, -221.41484542454427, -0.26256937414734516, -81.64046493632515, 47.835445195899766, 41.62225202827415, -159.27689309555132, 8.414915969460758, -94.96493654962522, -101.89030278114168, -225.75780180988139, 42.3879814213417, -221.12051631037914, -194.2370444672595, -47.443484467917465, -68.94976936260595, -71.53127552961595, -175.21866179031935, -2.377011043507998, 7.336224962261236, 57.5840314172886, 148.94400313475802, -286.27355747273646, -38.05288701360526, -15.675153673344045, -157.06325915064687, 20.451311784900852, -34.19514158105644, -163.71926844518902, 179.13622751357744, -193.68286217716528, -5.466795255903271, 18.11348646225638, 73.35067178507347, -116.27200227841195, 81.3532898949211, -15.069998875773695, -1.5790888906085807, -103.01419787536915, 39.20269946596015, -70.07117731476804, -109.82064133551206, -6.986631127929058, -36.128808808176835, 15.187313791671755, -14.673585565722401, -251.67950712492743, 6.628822658497688, -90.79739622560763, -223.17849208443, -63.253333383580255, -19.653256456869457, -32.815082218808726, 25.002451968907792, -219.83803663194715], "policy_predator_policy_reward": [5.826870261683667, 69.24665936669969, 324.2059226722713, 187.82411487972215, 153.05478211067583, 113.01714267189817, 17.61674468795218, 70.83651010327776, 56.871368154986286, 191.90703446277513, 141.68851820524378, 0.0, 91.80740741555158, 0.0, 54.17335758922649, 131.5922426112305, 1.0515024123846184, 119.05980597895365, 36.62393073860571, 126.16249015041168, 294.04458931930264, 58.43138602720072, 27.098306487098423, 43.366658498089144, 101.5982771707111, 77.69808380843789, 92.33601550180148, 69.17740583328944, 11.711242094735995, 97.91032777106007, 159.598841430636, 144.42881435000547, 256.62014258831397, 83.17326937041157, 64.7437860571049, 182.14132692717635, 121.33488994630724, 3.428971835429686, 17.92887165747148, 61.97318819646065, 71.37501564844887, 195.79699114833366, 50.574776505310986, 49.41217620680031, 95.99190856070484, 133.02817899556257, 118.64992189155714, 44.429110259031575, 173.65858800042827, 294.7987946549283, 219.5255437438939, 58.84984999166302, 153.020176017792, 148.6350451107507, 84.92152900727922, 86.59987230581754, 35.917401426461, 256.72903135113984, 310.86582010807547, 62.23254304989086, 95.58973110505788, 76.50819038770996, 122.80345328028605, 155.79070810226966, 62.740528734875355, 50.312344307454744, 388.3350217575325, 13.51400281733393, 276.4934910271924, 282.6228917498557, 228.37632836739596, 14.384633174866076, 36.51525084053167, 377.03702896531087, 55.843560999739694, 94.38008995249868, 186.75715567238382, 3.338471062991101, 341.8826036480012, 4.298675114714987, 61.56155472910194, 75.84484689398705, 39.31993402285901, 36.68605729351662, 9.025998199295913, 32.16223211325439, 17.067987561023646, 78.50917759223691, 86.89305015310855, 85.34873130728765, 32.98846306649877, 46.31927657317061, 3.2969657078063443, 120.15435256341586, 51.96603493554656, 113.08180586595923, 51.82953263144456, 147.2709014897984, 28.814437033388117, 169.02459312393165, 122.3689401027523, 69.27638990552909, 2.934690635903009, 71.85406764413669, 69.17481916505344, 16.220654559082863, 82.67464346074956, 54.88464781895127, 149.0452344703959, 85.05170701639402, 61.64654055235777, 6.308513636455049, 122.72811266075166, 9.76569171381375, 28.196503312525255, 11.990037592432142, 39.59465245581429, 93.77925190682629, 173.417858483239, 6.14133330985798, 15.762281811455798, 134.36623570047647, 76.06028203580479, 74.22850676175635, 34.695476680536935, 159.6621907988072, 167.2233660646181, 158.99304802466287, 125.23519084767717, 31.268484989044566, 88.54768969882797, 57.09944401112018, 170.03924007813922, 8.135051974358213, 21.451638560862875, 76.27928161334323, 145.09089770133772, 0.7242794915378635, 119.58478321201947, 55.07339965509877, 101.30347201003724, 267.44746563530987, 25.72851731642294, 50.2482358311191, 10.105741511511418, 193.0090328936931, 242.16798791533478, 39.648464187783205, 159.3499139561802, 28.118359652455005, 62.6282279289202, 164.83895649669932, 73.18508403053936, 110.16493654962441, 168.40666761692708, 267.8603886072499, 213.90796331236706, 124.17924132120368, 231.43704446725934, 63.34348446791769, 164.82322943616253, 100.95781545605833, 192.6461275375021, 19.887349329554755, 38.363775037738804, 35.81596858271153, 113.3458349053624, 230.7853915479533, 54.85288701360539, 39.375153673344265, 203.76325915064663, 1.2486882150991712, 111.99514158105654, 174.21926844518845, 10.863772486422565, 246.3828621771652, 23.366795255903288, 1.686513537743613, 3.0493282149260565, 143.97200227841205, 11.169618052507685, 151.88844071902219, 78.45110531031017, 178.76726219687225, 5.491533832319006, 183.23617029079, 53.44679168121165, 100.62718867369004, 51.62880880817706, 4.512686208328209, 171.62334218999183, 202.77443414774723, 128.4407517753692, 43.32782179174049, 246.32318803637418, 132.52041148399576, 85.60806980806116, 98.80891037849513, 185.52092658311363, 103.72089663179854]}, "sampler_perf": {"mean_raw_obs_processing_ms": 24.612889016885457, "mean_inference_ms": 21.186329230406663, "mean_action_processing_ms": 5.908154806035579, "mean_env_wait_ms": 37.33530745612723, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.09543001651763916, "StateBufferConnector_ms": 0.03673684597015381, "ViewRequirementAgentConnector_ms": 1.255206823348999}, "num_episodes": 0, "episode_return_max": 286.6692231913454, "episode_return_min": -53.94695511723343, "episode_return_mean": 102.60472273081903, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 149312, "num_agent_steps_trained": 149312, "num_env_steps_sampled": 37328, "num_env_steps_trained": 37328, "num_env_steps_sampled_this_iter": 0, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 0.0, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 37328, "num_env_steps_sampled_lifetime": 37328, "num_agent_steps_sampled_lifetime": 149312, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 149312, "timers": {"training_iteration_time_ms": 63153.681, "restore_workers_time_ms": 107.606, "training_step_time_ms": 62903.147, "sample_time_ms": 62856.504, "learn_time_ms": 311236.026, "learn_throughput": 59.967, "synch_weights_time_ms": 43.334}, "counters": {"num_env_steps_sampled": 37328, "num_env_steps_trained": 37328, "num_agent_steps_sampled": 149312, "num_agent_steps_trained": 149312}, "done": false, "training_iteration": 34, "trial_id": "d7bca_00000", "date": "2024-08-20_12-21-34", "timestamp": 1724136694, "time_this_iter_s": 649.533793926239, "time_total_s": 5304.211542367935, "pid": 36059, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 16000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x32ce728b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5304.211542367935, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 97.56491228070175, "ram_util_percent": 83.60409356725145}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {}, "num_env_steps_sampled": 37328, "num_env_steps_trained": 37328, "num_agent_steps_sampled": 149312, "num_agent_steps_trained": 149312}, "env_runners": {"episode_reward_max": 286.6692231913454, "episode_reward_min": -53.94695511723343, "episode_reward_mean": 102.60472273081903, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -382.5350217575324, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 179.13622751357744, "predator_policy": 388.3350217575325}, "policy_reward_mean": {"prey_policy": -50.61742331228365, "predator_policy": 101.91978467769317}, "custom_metrics": {}, "hist_stats": {"episode_reward": [35.10000000000023, -2.2956613079459616, 52.30000000000035, 93.99999999999946, 41.27668545957155, 138.35998813581944, 47.000000000000355, 189.59999999999982, 46.100000000000314, 122.59999999999911, 172.99184762314727, 183.89999999999952, 165.26660970450598, 63.400000000000325, 224.23591029611316, 118.26513246444676, 57.049342065984625, 56.287512516221504, 91.49999999999856, 77.70000000000017, 286.6692231913454, 34.20000000000022, 135.4999999999999, 189.7622134181783, 204.95900501687956, 41.46117592104707, 160.52089757879483, 41.90000000000027, 159.99999999999952, 56.25035590474681, 189.40904152072758, 32.4000000000002, 135.49999999999923, 137.09999999999957, -53.94695511723343, 170.90494465410117, 56.10000000000025, 60.20000000000013, 34.75612756781972, 43.60000000000028, 40.265044310772325, 47.1298862953699, 48.40000000000023, 36.202116310375594, 74.49999999999962, 153.19999999999987, 40.1000000000002, 131.19999999999982, 52.570622032848895, 56.000000000000156, 129.1999999999993, 86.20000000000002, 28.831075919194078, 160.79999999999959, 81.33852172443821, 103.01543537877356, 169.88064982359512, 48.30000000000023, 52.529310579969625, 48.028025438635616, 198.59999999999948, 184.470358209413, 37.06861395355878, 80.95181844992561, 33.900000000000134, 135.39999999999944, 148.89999999999955, 133.69999999999916, 226.89999999999938, 68.3000000000002, 154.45814550558052, 41.47674734270453, 180.74087067540847, 60.139037304427255, 153.66325386820998, 109.81254335834268, 96.80000000000011, 108.61895163315396, 159.3546697445331, 53.10000000000013, 125.29999999999959, 34.93780403323022, 139.0999999999999, 206.80167211533725, 40.50000000000029, 68.40000000000009, 88.29999999999927, 242.69999999999993, 37.700000000000266, 104.09999999999903, 229.34134979067687, 152.6250807412044, 157.8592262743011, 37.26670789146122, 35.20000000000023, 108.04468364708873, 87.5999999999994, 92.41177405235972, 131.94864151087714, 94.40623855187317], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [13.573129738316304, -53.54665936669982, -254.04609845621002, -260.27960040372835, -140.65478211067654, -73.1171426718985, 39.583255312047925, -34.03651010327775, -114.83317908671795, -92.66853807147267, -96.4272326280199, 93.09870255859556, -64.80740741555226, 20.000000000000014, 20.626642410773584, -16.792242611230414, 18.848497587615384, -92.85980597895414, 69.17606926139403, -109.36249015041209, -285.2321358475945, 105.74800812423979, 132.7888944272447, -19.35385941243218, -25.356623210719427, 11.326871936077456, -78.03601550180139, -20.07740583328924, 28.904313331271958, 85.71002709904536, -84.17058524148602, -101.59193807470932, -247.8691803256373, -34.87488956710395, -49.40531904969436, -141.19228141836533, -107.134889946308, 73.87102816456981, 4.171128342528487, -6.373188196460497, 72.0443042732162, -52.54708787865346, -32.67477650531073, -33.11217620680012, 17.408091439294907, -110.92817899556306, 80.28766474857159, -53.604483480981195, 64.90005398718623, -328.3984316256627, -221.37365036394135, -15.540567450569034, -217.97172194166885, 76.83739839192134, -62.4215290072797, -67.19987230581766, 82.82590198976501, -215.4723347673664, -63.01766150909464, -253.83034574412602, -72.05610867549865, 89.36722870345912, -103.9034532802869, -142.29070810227037, 0.5594712651248201, 21.887655692545323, -382.5350217575324, 117.78599718266575, -341.68754507993606, -271.3757928143444, 42.05974767402415, -113.91576456218526, 10.584749159468316, -368.0370289653096, -96.60173288891873, 6.578081936680414, -116.41208622158636, -38.927412945968925, -335.88260364800084, 33.30132488528524, -27.102952922490367, -70.03840438982733, -11.808869660467748, -17.067235360537826, 10.174001800704053, -2.962232113254194, -5.251613856427011, -54.123434986458186, -77.75098136410048, -19.99080009629646, 33.88040540161318, 40.0118549587175, 18.203034292193653, -101.55435256341609, 84.66934503983893, -118.51718584134521, -111.25275039532056, -35.27706169307365, 12.962713255211035, -154.80174341253127, -108.368940102753, 45.92361009447094, 66.26530936409696, -54.85406764413665, -50.32982812857711, -6.234569676365133, 43.52535653925046, -20.284647818951065, -122.72911794687963, -30.02930181547257, 64.88866316909824, -29.828281979136015, 27.845266783971347, 9.541578665059246, 1.103496687474779, 7.009962407567832, -8.299879170194934, -72.54471461247661, -97.58563081684744, -33.94553553761412, 161.42330774007206, -112.95182525200485, -6.1055308568346724, 40.28710026868663, -159.2584299113319, 1.9693763855458568, -203.51123731867187, -41.75335832068283, -112.73519084767737, -9.86848498904447, -75.14768969882805, 64.9005559888798, -41.26096743109789, 11.98667537860044, 89.1022150662958, -53.133135240501986, -21.790897701337713, 102.87572050846154, -103.60518017643587, -2.753002690682439, -77.5059788586302, -136.78681328113666, -35.26167272819433, 0.7616669233566751, 99.3892737675306, -121.76317749732668, -221.41484542454427, -0.26256937414734516, -81.64046493632515, 47.835445195899766, 41.62225202827415, -159.27689309555132, 8.414915969460758, -94.96493654962522, -101.89030278114168, -225.75780180988139, 42.3879814213417, -221.12051631037914, -194.2370444672595, -47.443484467917465, -68.94976936260595, -71.53127552961595, -175.21866179031935, -2.377011043507998, 7.336224962261236, 57.5840314172886, 148.94400313475802, -286.27355747273646, -38.05288701360526, -15.675153673344045, -157.06325915064687, 20.451311784900852, -34.19514158105644, -163.71926844518902, 179.13622751357744, -193.68286217716528, -5.466795255903271, 18.11348646225638, 73.35067178507347, -116.27200227841195, 81.3532898949211, -15.069998875773695, -1.5790888906085807, -103.01419787536915, 39.20269946596015, -70.07117731476804, -109.82064133551206, -6.986631127929058, -36.128808808176835, 15.187313791671755, -14.673585565722401, -251.67950712492743, 6.628822658497688, -90.79739622560763, -223.17849208443, -63.253333383580255, -19.653256456869457, -32.815082218808726, 25.002451968907792, -219.83803663194715], "policy_predator_policy_reward": [5.826870261683667, 69.24665936669969, 324.2059226722713, 187.82411487972215, 153.05478211067583, 113.01714267189817, 17.61674468795218, 70.83651010327776, 56.871368154986286, 191.90703446277513, 141.68851820524378, 0.0, 91.80740741555158, 0.0, 54.17335758922649, 131.5922426112305, 1.0515024123846184, 119.05980597895365, 36.62393073860571, 126.16249015041168, 294.04458931930264, 58.43138602720072, 27.098306487098423, 43.366658498089144, 101.5982771707111, 77.69808380843789, 92.33601550180148, 69.17740583328944, 11.711242094735995, 97.91032777106007, 159.598841430636, 144.42881435000547, 256.62014258831397, 83.17326937041157, 64.7437860571049, 182.14132692717635, 121.33488994630724, 3.428971835429686, 17.92887165747148, 61.97318819646065, 71.37501564844887, 195.79699114833366, 50.574776505310986, 49.41217620680031, 95.99190856070484, 133.02817899556257, 118.64992189155714, 44.429110259031575, 173.65858800042827, 294.7987946549283, 219.5255437438939, 58.84984999166302, 153.020176017792, 148.6350451107507, 84.92152900727922, 86.59987230581754, 35.917401426461, 256.72903135113984, 310.86582010807547, 62.23254304989086, 95.58973110505788, 76.50819038770996, 122.80345328028605, 155.79070810226966, 62.740528734875355, 50.312344307454744, 388.3350217575325, 13.51400281733393, 276.4934910271924, 282.6228917498557, 228.37632836739596, 14.384633174866076, 36.51525084053167, 377.03702896531087, 55.843560999739694, 94.38008995249868, 186.75715567238382, 3.338471062991101, 341.8826036480012, 4.298675114714987, 61.56155472910194, 75.84484689398705, 39.31993402285901, 36.68605729351662, 9.025998199295913, 32.16223211325439, 17.067987561023646, 78.50917759223691, 86.89305015310855, 85.34873130728765, 32.98846306649877, 46.31927657317061, 3.2969657078063443, 120.15435256341586, 51.96603493554656, 113.08180586595923, 51.82953263144456, 147.2709014897984, 28.814437033388117, 169.02459312393165, 122.3689401027523, 69.27638990552909, 2.934690635903009, 71.85406764413669, 69.17481916505344, 16.220654559082863, 82.67464346074956, 54.88464781895127, 149.0452344703959, 85.05170701639402, 61.64654055235777, 6.308513636455049, 122.72811266075166, 9.76569171381375, 28.196503312525255, 11.990037592432142, 39.59465245581429, 93.77925190682629, 173.417858483239, 6.14133330985798, 15.762281811455798, 134.36623570047647, 76.06028203580479, 74.22850676175635, 34.695476680536935, 159.6621907988072, 167.2233660646181, 158.99304802466287, 125.23519084767717, 31.268484989044566, 88.54768969882797, 57.09944401112018, 170.03924007813922, 8.135051974358213, 21.451638560862875, 76.27928161334323, 145.09089770133772, 0.7242794915378635, 119.58478321201947, 55.07339965509877, 101.30347201003724, 267.44746563530987, 25.72851731642294, 50.2482358311191, 10.105741511511418, 193.0090328936931, 242.16798791533478, 39.648464187783205, 159.3499139561802, 28.118359652455005, 62.6282279289202, 164.83895649669932, 73.18508403053936, 110.16493654962441, 168.40666761692708, 267.8603886072499, 213.90796331236706, 124.17924132120368, 231.43704446725934, 63.34348446791769, 164.82322943616253, 100.95781545605833, 192.6461275375021, 19.887349329554755, 38.363775037738804, 35.81596858271153, 113.3458349053624, 230.7853915479533, 54.85288701360539, 39.375153673344265, 203.76325915064663, 1.2486882150991712, 111.99514158105654, 174.21926844518845, 10.863772486422565, 246.3828621771652, 23.366795255903288, 1.686513537743613, 3.0493282149260565, 143.97200227841205, 11.169618052507685, 151.88844071902219, 78.45110531031017, 178.76726219687225, 5.491533832319006, 183.23617029079, 53.44679168121165, 100.62718867369004, 51.62880880817706, 4.512686208328209, 171.62334218999183, 202.77443414774723, 128.4407517753692, 43.32782179174049, 246.32318803637418, 132.52041148399576, 85.60806980806116, 98.80891037849513, 185.52092658311363, 103.72089663179854]}, "sampler_perf": {"mean_raw_obs_processing_ms": 24.612889016885457, "mean_inference_ms": 21.186329230406663, "mean_action_processing_ms": 5.908154806035579, "mean_env_wait_ms": 37.33530745612723, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.09543001651763916, "StateBufferConnector_ms": 0.03673684597015381, "ViewRequirementAgentConnector_ms": 1.255206823348999}, "num_episodes": 0, "episode_return_max": 286.6692231913454, "episode_return_min": -53.94695511723343, "episode_return_mean": 102.60472273081903, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 149312, "num_agent_steps_trained": 149312, "num_env_steps_sampled": 37328, "num_env_steps_trained": 37328, "num_env_steps_sampled_this_iter": 0, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 0.0, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 37328, "num_env_steps_sampled_lifetime": 37328, "num_agent_steps_sampled_lifetime": 149312, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 149312, "timers": {"training_iteration_time_ms": 63319.84, "restore_workers_time_ms": 110.786, "training_step_time_ms": 63059.799, "sample_time_ms": 63004.106, "learn_time_ms": 311236.026, "learn_throughput": 59.967, "synch_weights_time_ms": 43.334}, "counters": {"num_env_steps_sampled": 37328, "num_env_steps_trained": 37328, "num_agent_steps_sampled": 149312, "num_agent_steps_trained": 149312}, "done": false, "training_iteration": 35, "trial_id": "d7bca_00000", "date": "2024-08-20_12-23-52", "timestamp": 1724136832, "time_this_iter_s": 125.85012602806091, "time_total_s": 5430.061668395996, "pid": 36059, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 16000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b0d8c700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5430.061668395996, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 95.75608465608467, "ram_util_percent": 83.92380952380951}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {}, "num_env_steps_sampled": 37328, "num_env_steps_trained": 37328, "num_agent_steps_sampled": 149312, "num_agent_steps_trained": 149312}, "env_runners": {"episode_reward_max": 286.6692231913454, "episode_reward_min": -53.94695511723343, "episode_reward_mean": 102.60472273081903, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -382.5350217575324, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 179.13622751357744, "predator_policy": 388.3350217575325}, "policy_reward_mean": {"prey_policy": -50.61742331228365, "predator_policy": 101.91978467769317}, "custom_metrics": {}, "hist_stats": {"episode_reward": [35.10000000000023, -2.2956613079459616, 52.30000000000035, 93.99999999999946, 41.27668545957155, 138.35998813581944, 47.000000000000355, 189.59999999999982, 46.100000000000314, 122.59999999999911, 172.99184762314727, 183.89999999999952, 165.26660970450598, 63.400000000000325, 224.23591029611316, 118.26513246444676, 57.049342065984625, 56.287512516221504, 91.49999999999856, 77.70000000000017, 286.6692231913454, 34.20000000000022, 135.4999999999999, 189.7622134181783, 204.95900501687956, 41.46117592104707, 160.52089757879483, 41.90000000000027, 159.99999999999952, 56.25035590474681, 189.40904152072758, 32.4000000000002, 135.49999999999923, 137.09999999999957, -53.94695511723343, 170.90494465410117, 56.10000000000025, 60.20000000000013, 34.75612756781972, 43.60000000000028, 40.265044310772325, 47.1298862953699, 48.40000000000023, 36.202116310375594, 74.49999999999962, 153.19999999999987, 40.1000000000002, 131.19999999999982, 52.570622032848895, 56.000000000000156, 129.1999999999993, 86.20000000000002, 28.831075919194078, 160.79999999999959, 81.33852172443821, 103.01543537877356, 169.88064982359512, 48.30000000000023, 52.529310579969625, 48.028025438635616, 198.59999999999948, 184.470358209413, 37.06861395355878, 80.95181844992561, 33.900000000000134, 135.39999999999944, 148.89999999999955, 133.69999999999916, 226.89999999999938, 68.3000000000002, 154.45814550558052, 41.47674734270453, 180.74087067540847, 60.139037304427255, 153.66325386820998, 109.81254335834268, 96.80000000000011, 108.61895163315396, 159.3546697445331, 53.10000000000013, 125.29999999999959, 34.93780403323022, 139.0999999999999, 206.80167211533725, 40.50000000000029, 68.40000000000009, 88.29999999999927, 242.69999999999993, 37.700000000000266, 104.09999999999903, 229.34134979067687, 152.6250807412044, 157.8592262743011, 37.26670789146122, 35.20000000000023, 108.04468364708873, 87.5999999999994, 92.41177405235972, 131.94864151087714, 94.40623855187317], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [13.573129738316304, -53.54665936669982, -254.04609845621002, -260.27960040372835, -140.65478211067654, -73.1171426718985, 39.583255312047925, -34.03651010327775, -114.83317908671795, -92.66853807147267, -96.4272326280199, 93.09870255859556, -64.80740741555226, 20.000000000000014, 20.626642410773584, -16.792242611230414, 18.848497587615384, -92.85980597895414, 69.17606926139403, -109.36249015041209, -285.2321358475945, 105.74800812423979, 132.7888944272447, -19.35385941243218, -25.356623210719427, 11.326871936077456, -78.03601550180139, -20.07740583328924, 28.904313331271958, 85.71002709904536, -84.17058524148602, -101.59193807470932, -247.8691803256373, -34.87488956710395, -49.40531904969436, -141.19228141836533, -107.134889946308, 73.87102816456981, 4.171128342528487, -6.373188196460497, 72.0443042732162, -52.54708787865346, -32.67477650531073, -33.11217620680012, 17.408091439294907, -110.92817899556306, 80.28766474857159, -53.604483480981195, 64.90005398718623, -328.3984316256627, -221.37365036394135, -15.540567450569034, -217.97172194166885, 76.83739839192134, -62.4215290072797, -67.19987230581766, 82.82590198976501, -215.4723347673664, -63.01766150909464, -253.83034574412602, -72.05610867549865, 89.36722870345912, -103.9034532802869, -142.29070810227037, 0.5594712651248201, 21.887655692545323, -382.5350217575324, 117.78599718266575, -341.68754507993606, -271.3757928143444, 42.05974767402415, -113.91576456218526, 10.584749159468316, -368.0370289653096, -96.60173288891873, 6.578081936680414, -116.41208622158636, -38.927412945968925, -335.88260364800084, 33.30132488528524, -27.102952922490367, -70.03840438982733, -11.808869660467748, -17.067235360537826, 10.174001800704053, -2.962232113254194, -5.251613856427011, -54.123434986458186, -77.75098136410048, -19.99080009629646, 33.88040540161318, 40.0118549587175, 18.203034292193653, -101.55435256341609, 84.66934503983893, -118.51718584134521, -111.25275039532056, -35.27706169307365, 12.962713255211035, -154.80174341253127, -108.368940102753, 45.92361009447094, 66.26530936409696, -54.85406764413665, -50.32982812857711, -6.234569676365133, 43.52535653925046, -20.284647818951065, -122.72911794687963, -30.02930181547257, 64.88866316909824, -29.828281979136015, 27.845266783971347, 9.541578665059246, 1.103496687474779, 7.009962407567832, -8.299879170194934, -72.54471461247661, -97.58563081684744, -33.94553553761412, 161.42330774007206, -112.95182525200485, -6.1055308568346724, 40.28710026868663, -159.2584299113319, 1.9693763855458568, -203.51123731867187, -41.75335832068283, -112.73519084767737, -9.86848498904447, -75.14768969882805, 64.9005559888798, -41.26096743109789, 11.98667537860044, 89.1022150662958, -53.133135240501986, -21.790897701337713, 102.87572050846154, -103.60518017643587, -2.753002690682439, -77.5059788586302, -136.78681328113666, -35.26167272819433, 0.7616669233566751, 99.3892737675306, -121.76317749732668, -221.41484542454427, -0.26256937414734516, -81.64046493632515, 47.835445195899766, 41.62225202827415, -159.27689309555132, 8.414915969460758, -94.96493654962522, -101.89030278114168, -225.75780180988139, 42.3879814213417, -221.12051631037914, -194.2370444672595, -47.443484467917465, -68.94976936260595, -71.53127552961595, -175.21866179031935, -2.377011043507998, 7.336224962261236, 57.5840314172886, 148.94400313475802, -286.27355747273646, -38.05288701360526, -15.675153673344045, -157.06325915064687, 20.451311784900852, -34.19514158105644, -163.71926844518902, 179.13622751357744, -193.68286217716528, -5.466795255903271, 18.11348646225638, 73.35067178507347, -116.27200227841195, 81.3532898949211, -15.069998875773695, -1.5790888906085807, -103.01419787536915, 39.20269946596015, -70.07117731476804, -109.82064133551206, -6.986631127929058, -36.128808808176835, 15.187313791671755, -14.673585565722401, -251.67950712492743, 6.628822658497688, -90.79739622560763, -223.17849208443, -63.253333383580255, -19.653256456869457, -32.815082218808726, 25.002451968907792, -219.83803663194715], "policy_predator_policy_reward": [5.826870261683667, 69.24665936669969, 324.2059226722713, 187.82411487972215, 153.05478211067583, 113.01714267189817, 17.61674468795218, 70.83651010327776, 56.871368154986286, 191.90703446277513, 141.68851820524378, 0.0, 91.80740741555158, 0.0, 54.17335758922649, 131.5922426112305, 1.0515024123846184, 119.05980597895365, 36.62393073860571, 126.16249015041168, 294.04458931930264, 58.43138602720072, 27.098306487098423, 43.366658498089144, 101.5982771707111, 77.69808380843789, 92.33601550180148, 69.17740583328944, 11.711242094735995, 97.91032777106007, 159.598841430636, 144.42881435000547, 256.62014258831397, 83.17326937041157, 64.7437860571049, 182.14132692717635, 121.33488994630724, 3.428971835429686, 17.92887165747148, 61.97318819646065, 71.37501564844887, 195.79699114833366, 50.574776505310986, 49.41217620680031, 95.99190856070484, 133.02817899556257, 118.64992189155714, 44.429110259031575, 173.65858800042827, 294.7987946549283, 219.5255437438939, 58.84984999166302, 153.020176017792, 148.6350451107507, 84.92152900727922, 86.59987230581754, 35.917401426461, 256.72903135113984, 310.86582010807547, 62.23254304989086, 95.58973110505788, 76.50819038770996, 122.80345328028605, 155.79070810226966, 62.740528734875355, 50.312344307454744, 388.3350217575325, 13.51400281733393, 276.4934910271924, 282.6228917498557, 228.37632836739596, 14.384633174866076, 36.51525084053167, 377.03702896531087, 55.843560999739694, 94.38008995249868, 186.75715567238382, 3.338471062991101, 341.8826036480012, 4.298675114714987, 61.56155472910194, 75.84484689398705, 39.31993402285901, 36.68605729351662, 9.025998199295913, 32.16223211325439, 17.067987561023646, 78.50917759223691, 86.89305015310855, 85.34873130728765, 32.98846306649877, 46.31927657317061, 3.2969657078063443, 120.15435256341586, 51.96603493554656, 113.08180586595923, 51.82953263144456, 147.2709014897984, 28.814437033388117, 169.02459312393165, 122.3689401027523, 69.27638990552909, 2.934690635903009, 71.85406764413669, 69.17481916505344, 16.220654559082863, 82.67464346074956, 54.88464781895127, 149.0452344703959, 85.05170701639402, 61.64654055235777, 6.308513636455049, 122.72811266075166, 9.76569171381375, 28.196503312525255, 11.990037592432142, 39.59465245581429, 93.77925190682629, 173.417858483239, 6.14133330985798, 15.762281811455798, 134.36623570047647, 76.06028203580479, 74.22850676175635, 34.695476680536935, 159.6621907988072, 167.2233660646181, 158.99304802466287, 125.23519084767717, 31.268484989044566, 88.54768969882797, 57.09944401112018, 170.03924007813922, 8.135051974358213, 21.451638560862875, 76.27928161334323, 145.09089770133772, 0.7242794915378635, 119.58478321201947, 55.07339965509877, 101.30347201003724, 267.44746563530987, 25.72851731642294, 50.2482358311191, 10.105741511511418, 193.0090328936931, 242.16798791533478, 39.648464187783205, 159.3499139561802, 28.118359652455005, 62.6282279289202, 164.83895649669932, 73.18508403053936, 110.16493654962441, 168.40666761692708, 267.8603886072499, 213.90796331236706, 124.17924132120368, 231.43704446725934, 63.34348446791769, 164.82322943616253, 100.95781545605833, 192.6461275375021, 19.887349329554755, 38.363775037738804, 35.81596858271153, 113.3458349053624, 230.7853915479533, 54.85288701360539, 39.375153673344265, 203.76325915064663, 1.2486882150991712, 111.99514158105654, 174.21926844518845, 10.863772486422565, 246.3828621771652, 23.366795255903288, 1.686513537743613, 3.0493282149260565, 143.97200227841205, 11.169618052507685, 151.88844071902219, 78.45110531031017, 178.76726219687225, 5.491533832319006, 183.23617029079, 53.44679168121165, 100.62718867369004, 51.62880880817706, 4.512686208328209, 171.62334218999183, 202.77443414774723, 128.4407517753692, 43.32782179174049, 246.32318803637418, 132.52041148399576, 85.60806980806116, 98.80891037849513, 185.52092658311363, 103.72089663179854]}, "sampler_perf": {"mean_raw_obs_processing_ms": 24.612889016885457, "mean_inference_ms": 21.186329230406663, "mean_action_processing_ms": 5.908154806035579, "mean_env_wait_ms": 37.33530745612723, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.09543001651763916, "StateBufferConnector_ms": 0.03673684597015381, "ViewRequirementAgentConnector_ms": 1.255206823348999}, "num_episodes": 0, "episode_return_max": 286.6692231913454, "episode_return_min": -53.94695511723343, "episode_return_mean": 102.60472273081903, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 149312, "num_agent_steps_trained": 149312, "num_env_steps_sampled": 37328, "num_env_steps_trained": 37328, "num_env_steps_sampled_this_iter": 0, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 0.0, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 37328, "num_env_steps_sampled_lifetime": 37328, "num_agent_steps_sampled_lifetime": 149312, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 149312, "timers": {"training_iteration_time_ms": 63301.517, "restore_workers_time_ms": 110.789, "training_step_time_ms": 63041.431, "sample_time_ms": 62986.5, "learn_time_ms": 311236.026, "learn_throughput": 59.967, "synch_weights_time_ms": 43.334}, "counters": {"num_env_steps_sampled": 37328, "num_env_steps_trained": 37328, "num_agent_steps_sampled": 149312, "num_agent_steps_trained": 149312}, "done": false, "training_iteration": 36, "trial_id": "d7bca_00000", "date": "2024-08-20_12-25-59", "timestamp": 1724136959, "time_this_iter_s": 123.03747510910034, "time_total_s": 5553.099143505096, "pid": 36059, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 16000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x32cf5b160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5553.099143505096, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 96.64393063583816, "ram_util_percent": 83.65838150289018}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {}, "num_env_steps_sampled": 37328, "num_env_steps_trained": 37328, "num_agent_steps_sampled": 149312, "num_agent_steps_trained": 149312}, "env_runners": {"episode_reward_max": 286.6692231913454, "episode_reward_min": -53.94695511723343, "episode_reward_mean": 102.60472273081903, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -382.5350217575324, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 179.13622751357744, "predator_policy": 388.3350217575325}, "policy_reward_mean": {"prey_policy": -50.61742331228365, "predator_policy": 101.91978467769317}, "custom_metrics": {}, "hist_stats": {"episode_reward": [35.10000000000023, -2.2956613079459616, 52.30000000000035, 93.99999999999946, 41.27668545957155, 138.35998813581944, 47.000000000000355, 189.59999999999982, 46.100000000000314, 122.59999999999911, 172.99184762314727, 183.89999999999952, 165.26660970450598, 63.400000000000325, 224.23591029611316, 118.26513246444676, 57.049342065984625, 56.287512516221504, 91.49999999999856, 77.70000000000017, 286.6692231913454, 34.20000000000022, 135.4999999999999, 189.7622134181783, 204.95900501687956, 41.46117592104707, 160.52089757879483, 41.90000000000027, 159.99999999999952, 56.25035590474681, 189.40904152072758, 32.4000000000002, 135.49999999999923, 137.09999999999957, -53.94695511723343, 170.90494465410117, 56.10000000000025, 60.20000000000013, 34.75612756781972, 43.60000000000028, 40.265044310772325, 47.1298862953699, 48.40000000000023, 36.202116310375594, 74.49999999999962, 153.19999999999987, 40.1000000000002, 131.19999999999982, 52.570622032848895, 56.000000000000156, 129.1999999999993, 86.20000000000002, 28.831075919194078, 160.79999999999959, 81.33852172443821, 103.01543537877356, 169.88064982359512, 48.30000000000023, 52.529310579969625, 48.028025438635616, 198.59999999999948, 184.470358209413, 37.06861395355878, 80.95181844992561, 33.900000000000134, 135.39999999999944, 148.89999999999955, 133.69999999999916, 226.89999999999938, 68.3000000000002, 154.45814550558052, 41.47674734270453, 180.74087067540847, 60.139037304427255, 153.66325386820998, 109.81254335834268, 96.80000000000011, 108.61895163315396, 159.3546697445331, 53.10000000000013, 125.29999999999959, 34.93780403323022, 139.0999999999999, 206.80167211533725, 40.50000000000029, 68.40000000000009, 88.29999999999927, 242.69999999999993, 37.700000000000266, 104.09999999999903, 229.34134979067687, 152.6250807412044, 157.8592262743011, 37.26670789146122, 35.20000000000023, 108.04468364708873, 87.5999999999994, 92.41177405235972, 131.94864151087714, 94.40623855187317], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [13.573129738316304, -53.54665936669982, -254.04609845621002, -260.27960040372835, -140.65478211067654, -73.1171426718985, 39.583255312047925, -34.03651010327775, -114.83317908671795, -92.66853807147267, -96.4272326280199, 93.09870255859556, -64.80740741555226, 20.000000000000014, 20.626642410773584, -16.792242611230414, 18.848497587615384, -92.85980597895414, 69.17606926139403, -109.36249015041209, -285.2321358475945, 105.74800812423979, 132.7888944272447, -19.35385941243218, -25.356623210719427, 11.326871936077456, -78.03601550180139, -20.07740583328924, 28.904313331271958, 85.71002709904536, -84.17058524148602, -101.59193807470932, -247.8691803256373, -34.87488956710395, -49.40531904969436, -141.19228141836533, -107.134889946308, 73.87102816456981, 4.171128342528487, -6.373188196460497, 72.0443042732162, -52.54708787865346, -32.67477650531073, -33.11217620680012, 17.408091439294907, -110.92817899556306, 80.28766474857159, -53.604483480981195, 64.90005398718623, -328.3984316256627, -221.37365036394135, -15.540567450569034, -217.97172194166885, 76.83739839192134, -62.4215290072797, -67.19987230581766, 82.82590198976501, -215.4723347673664, -63.01766150909464, -253.83034574412602, -72.05610867549865, 89.36722870345912, -103.9034532802869, -142.29070810227037, 0.5594712651248201, 21.887655692545323, -382.5350217575324, 117.78599718266575, -341.68754507993606, -271.3757928143444, 42.05974767402415, -113.91576456218526, 10.584749159468316, -368.0370289653096, -96.60173288891873, 6.578081936680414, -116.41208622158636, -38.927412945968925, -335.88260364800084, 33.30132488528524, -27.102952922490367, -70.03840438982733, -11.808869660467748, -17.067235360537826, 10.174001800704053, -2.962232113254194, -5.251613856427011, -54.123434986458186, -77.75098136410048, -19.99080009629646, 33.88040540161318, 40.0118549587175, 18.203034292193653, -101.55435256341609, 84.66934503983893, -118.51718584134521, -111.25275039532056, -35.27706169307365, 12.962713255211035, -154.80174341253127, -108.368940102753, 45.92361009447094, 66.26530936409696, -54.85406764413665, -50.32982812857711, -6.234569676365133, 43.52535653925046, -20.284647818951065, -122.72911794687963, -30.02930181547257, 64.88866316909824, -29.828281979136015, 27.845266783971347, 9.541578665059246, 1.103496687474779, 7.009962407567832, -8.299879170194934, -72.54471461247661, -97.58563081684744, -33.94553553761412, 161.42330774007206, -112.95182525200485, -6.1055308568346724, 40.28710026868663, -159.2584299113319, 1.9693763855458568, -203.51123731867187, -41.75335832068283, -112.73519084767737, -9.86848498904447, -75.14768969882805, 64.9005559888798, -41.26096743109789, 11.98667537860044, 89.1022150662958, -53.133135240501986, -21.790897701337713, 102.87572050846154, -103.60518017643587, -2.753002690682439, -77.5059788586302, -136.78681328113666, -35.26167272819433, 0.7616669233566751, 99.3892737675306, -121.76317749732668, -221.41484542454427, -0.26256937414734516, -81.64046493632515, 47.835445195899766, 41.62225202827415, -159.27689309555132, 8.414915969460758, -94.96493654962522, -101.89030278114168, -225.75780180988139, 42.3879814213417, -221.12051631037914, -194.2370444672595, -47.443484467917465, -68.94976936260595, -71.53127552961595, -175.21866179031935, -2.377011043507998, 7.336224962261236, 57.5840314172886, 148.94400313475802, -286.27355747273646, -38.05288701360526, -15.675153673344045, -157.06325915064687, 20.451311784900852, -34.19514158105644, -163.71926844518902, 179.13622751357744, -193.68286217716528, -5.466795255903271, 18.11348646225638, 73.35067178507347, -116.27200227841195, 81.3532898949211, -15.069998875773695, -1.5790888906085807, -103.01419787536915, 39.20269946596015, -70.07117731476804, -109.82064133551206, -6.986631127929058, -36.128808808176835, 15.187313791671755, -14.673585565722401, -251.67950712492743, 6.628822658497688, -90.79739622560763, -223.17849208443, -63.253333383580255, -19.653256456869457, -32.815082218808726, 25.002451968907792, -219.83803663194715], "policy_predator_policy_reward": [5.826870261683667, 69.24665936669969, 324.2059226722713, 187.82411487972215, 153.05478211067583, 113.01714267189817, 17.61674468795218, 70.83651010327776, 56.871368154986286, 191.90703446277513, 141.68851820524378, 0.0, 91.80740741555158, 0.0, 54.17335758922649, 131.5922426112305, 1.0515024123846184, 119.05980597895365, 36.62393073860571, 126.16249015041168, 294.04458931930264, 58.43138602720072, 27.098306487098423, 43.366658498089144, 101.5982771707111, 77.69808380843789, 92.33601550180148, 69.17740583328944, 11.711242094735995, 97.91032777106007, 159.598841430636, 144.42881435000547, 256.62014258831397, 83.17326937041157, 64.7437860571049, 182.14132692717635, 121.33488994630724, 3.428971835429686, 17.92887165747148, 61.97318819646065, 71.37501564844887, 195.79699114833366, 50.574776505310986, 49.41217620680031, 95.99190856070484, 133.02817899556257, 118.64992189155714, 44.429110259031575, 173.65858800042827, 294.7987946549283, 219.5255437438939, 58.84984999166302, 153.020176017792, 148.6350451107507, 84.92152900727922, 86.59987230581754, 35.917401426461, 256.72903135113984, 310.86582010807547, 62.23254304989086, 95.58973110505788, 76.50819038770996, 122.80345328028605, 155.79070810226966, 62.740528734875355, 50.312344307454744, 388.3350217575325, 13.51400281733393, 276.4934910271924, 282.6228917498557, 228.37632836739596, 14.384633174866076, 36.51525084053167, 377.03702896531087, 55.843560999739694, 94.38008995249868, 186.75715567238382, 3.338471062991101, 341.8826036480012, 4.298675114714987, 61.56155472910194, 75.84484689398705, 39.31993402285901, 36.68605729351662, 9.025998199295913, 32.16223211325439, 17.067987561023646, 78.50917759223691, 86.89305015310855, 85.34873130728765, 32.98846306649877, 46.31927657317061, 3.2969657078063443, 120.15435256341586, 51.96603493554656, 113.08180586595923, 51.82953263144456, 147.2709014897984, 28.814437033388117, 169.02459312393165, 122.3689401027523, 69.27638990552909, 2.934690635903009, 71.85406764413669, 69.17481916505344, 16.220654559082863, 82.67464346074956, 54.88464781895127, 149.0452344703959, 85.05170701639402, 61.64654055235777, 6.308513636455049, 122.72811266075166, 9.76569171381375, 28.196503312525255, 11.990037592432142, 39.59465245581429, 93.77925190682629, 173.417858483239, 6.14133330985798, 15.762281811455798, 134.36623570047647, 76.06028203580479, 74.22850676175635, 34.695476680536935, 159.6621907988072, 167.2233660646181, 158.99304802466287, 125.23519084767717, 31.268484989044566, 88.54768969882797, 57.09944401112018, 170.03924007813922, 8.135051974358213, 21.451638560862875, 76.27928161334323, 145.09089770133772, 0.7242794915378635, 119.58478321201947, 55.07339965509877, 101.30347201003724, 267.44746563530987, 25.72851731642294, 50.2482358311191, 10.105741511511418, 193.0090328936931, 242.16798791533478, 39.648464187783205, 159.3499139561802, 28.118359652455005, 62.6282279289202, 164.83895649669932, 73.18508403053936, 110.16493654962441, 168.40666761692708, 267.8603886072499, 213.90796331236706, 124.17924132120368, 231.43704446725934, 63.34348446791769, 164.82322943616253, 100.95781545605833, 192.6461275375021, 19.887349329554755, 38.363775037738804, 35.81596858271153, 113.3458349053624, 230.7853915479533, 54.85288701360539, 39.375153673344265, 203.76325915064663, 1.2486882150991712, 111.99514158105654, 174.21926844518845, 10.863772486422565, 246.3828621771652, 23.366795255903288, 1.686513537743613, 3.0493282149260565, 143.97200227841205, 11.169618052507685, 151.88844071902219, 78.45110531031017, 178.76726219687225, 5.491533832319006, 183.23617029079, 53.44679168121165, 100.62718867369004, 51.62880880817706, 4.512686208328209, 171.62334218999183, 202.77443414774723, 128.4407517753692, 43.32782179174049, 246.32318803637418, 132.52041148399576, 85.60806980806116, 98.80891037849513, 185.52092658311363, 103.72089663179854]}, "sampler_perf": {"mean_raw_obs_processing_ms": 24.612889016885457, "mean_inference_ms": 21.186329230406663, "mean_action_processing_ms": 5.908154806035579, "mean_env_wait_ms": 37.33530745612723, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.09543001651763916, "StateBufferConnector_ms": 0.03673684597015381, "ViewRequirementAgentConnector_ms": 1.255206823348999}, "num_episodes": 0, "episode_return_max": 286.6692231913454, "episode_return_min": -53.94695511723343, "episode_return_mean": 102.60472273081903, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 149312, "num_agent_steps_trained": 149312, "num_env_steps_sampled": 37328, "num_env_steps_trained": 37328, "num_env_steps_sampled_this_iter": 0, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 0.0, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 37328, "num_env_steps_sampled_lifetime": 37328, "num_agent_steps_sampled_lifetime": 149312, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 149312, "timers": {"training_iteration_time_ms": 62744.712, "restore_workers_time_ms": 78.51, "training_step_time_ms": 62545.794, "sample_time_ms": 62503.481, "learn_time_ms": 311236.026, "learn_throughput": 59.967, "synch_weights_time_ms": 43.334}, "counters": {"num_env_steps_sampled": 37328, "num_env_steps_trained": 37328, "num_agent_steps_sampled": 149312, "num_agent_steps_trained": 149312}, "done": false, "training_iteration": 37, "trial_id": "d7bca_00000", "date": "2024-08-20_12-28-05", "timestamp": 1724137085, "time_this_iter_s": 123.10438299179077, "time_total_s": 5676.203526496887, "pid": 36059, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 16000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x32cf6d4c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5676.203526496887, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 96.46411764705883, "ram_util_percent": 83.61529411764707}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {}, "num_env_steps_sampled": 37328, "num_env_steps_trained": 37328, "num_agent_steps_sampled": 149312, "num_agent_steps_trained": 149312}, "env_runners": {"episode_reward_max": 286.6692231913454, "episode_reward_min": -53.94695511723343, "episode_reward_mean": 102.60472273081903, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -382.5350217575324, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 179.13622751357744, "predator_policy": 388.3350217575325}, "policy_reward_mean": {"prey_policy": -50.61742331228365, "predator_policy": 101.91978467769317}, "custom_metrics": {}, "hist_stats": {"episode_reward": [35.10000000000023, -2.2956613079459616, 52.30000000000035, 93.99999999999946, 41.27668545957155, 138.35998813581944, 47.000000000000355, 189.59999999999982, 46.100000000000314, 122.59999999999911, 172.99184762314727, 183.89999999999952, 165.26660970450598, 63.400000000000325, 224.23591029611316, 118.26513246444676, 57.049342065984625, 56.287512516221504, 91.49999999999856, 77.70000000000017, 286.6692231913454, 34.20000000000022, 135.4999999999999, 189.7622134181783, 204.95900501687956, 41.46117592104707, 160.52089757879483, 41.90000000000027, 159.99999999999952, 56.25035590474681, 189.40904152072758, 32.4000000000002, 135.49999999999923, 137.09999999999957, -53.94695511723343, 170.90494465410117, 56.10000000000025, 60.20000000000013, 34.75612756781972, 43.60000000000028, 40.265044310772325, 47.1298862953699, 48.40000000000023, 36.202116310375594, 74.49999999999962, 153.19999999999987, 40.1000000000002, 131.19999999999982, 52.570622032848895, 56.000000000000156, 129.1999999999993, 86.20000000000002, 28.831075919194078, 160.79999999999959, 81.33852172443821, 103.01543537877356, 169.88064982359512, 48.30000000000023, 52.529310579969625, 48.028025438635616, 198.59999999999948, 184.470358209413, 37.06861395355878, 80.95181844992561, 33.900000000000134, 135.39999999999944, 148.89999999999955, 133.69999999999916, 226.89999999999938, 68.3000000000002, 154.45814550558052, 41.47674734270453, 180.74087067540847, 60.139037304427255, 153.66325386820998, 109.81254335834268, 96.80000000000011, 108.61895163315396, 159.3546697445331, 53.10000000000013, 125.29999999999959, 34.93780403323022, 139.0999999999999, 206.80167211533725, 40.50000000000029, 68.40000000000009, 88.29999999999927, 242.69999999999993, 37.700000000000266, 104.09999999999903, 229.34134979067687, 152.6250807412044, 157.8592262743011, 37.26670789146122, 35.20000000000023, 108.04468364708873, 87.5999999999994, 92.41177405235972, 131.94864151087714, 94.40623855187317], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [13.573129738316304, -53.54665936669982, -254.04609845621002, -260.27960040372835, -140.65478211067654, -73.1171426718985, 39.583255312047925, -34.03651010327775, -114.83317908671795, -92.66853807147267, -96.4272326280199, 93.09870255859556, -64.80740741555226, 20.000000000000014, 20.626642410773584, -16.792242611230414, 18.848497587615384, -92.85980597895414, 69.17606926139403, -109.36249015041209, -285.2321358475945, 105.74800812423979, 132.7888944272447, -19.35385941243218, -25.356623210719427, 11.326871936077456, -78.03601550180139, -20.07740583328924, 28.904313331271958, 85.71002709904536, -84.17058524148602, -101.59193807470932, -247.8691803256373, -34.87488956710395, -49.40531904969436, -141.19228141836533, -107.134889946308, 73.87102816456981, 4.171128342528487, -6.373188196460497, 72.0443042732162, -52.54708787865346, -32.67477650531073, -33.11217620680012, 17.408091439294907, -110.92817899556306, 80.28766474857159, -53.604483480981195, 64.90005398718623, -328.3984316256627, -221.37365036394135, -15.540567450569034, -217.97172194166885, 76.83739839192134, -62.4215290072797, -67.19987230581766, 82.82590198976501, -215.4723347673664, -63.01766150909464, -253.83034574412602, -72.05610867549865, 89.36722870345912, -103.9034532802869, -142.29070810227037, 0.5594712651248201, 21.887655692545323, -382.5350217575324, 117.78599718266575, -341.68754507993606, -271.3757928143444, 42.05974767402415, -113.91576456218526, 10.584749159468316, -368.0370289653096, -96.60173288891873, 6.578081936680414, -116.41208622158636, -38.927412945968925, -335.88260364800084, 33.30132488528524, -27.102952922490367, -70.03840438982733, -11.808869660467748, -17.067235360537826, 10.174001800704053, -2.962232113254194, -5.251613856427011, -54.123434986458186, -77.75098136410048, -19.99080009629646, 33.88040540161318, 40.0118549587175, 18.203034292193653, -101.55435256341609, 84.66934503983893, -118.51718584134521, -111.25275039532056, -35.27706169307365, 12.962713255211035, -154.80174341253127, -108.368940102753, 45.92361009447094, 66.26530936409696, -54.85406764413665, -50.32982812857711, -6.234569676365133, 43.52535653925046, -20.284647818951065, -122.72911794687963, -30.02930181547257, 64.88866316909824, -29.828281979136015, 27.845266783971347, 9.541578665059246, 1.103496687474779, 7.009962407567832, -8.299879170194934, -72.54471461247661, -97.58563081684744, -33.94553553761412, 161.42330774007206, -112.95182525200485, -6.1055308568346724, 40.28710026868663, -159.2584299113319, 1.9693763855458568, -203.51123731867187, -41.75335832068283, -112.73519084767737, -9.86848498904447, -75.14768969882805, 64.9005559888798, -41.26096743109789, 11.98667537860044, 89.1022150662958, -53.133135240501986, -21.790897701337713, 102.87572050846154, -103.60518017643587, -2.753002690682439, -77.5059788586302, -136.78681328113666, -35.26167272819433, 0.7616669233566751, 99.3892737675306, -121.76317749732668, -221.41484542454427, -0.26256937414734516, -81.64046493632515, 47.835445195899766, 41.62225202827415, -159.27689309555132, 8.414915969460758, -94.96493654962522, -101.89030278114168, -225.75780180988139, 42.3879814213417, -221.12051631037914, -194.2370444672595, -47.443484467917465, -68.94976936260595, -71.53127552961595, -175.21866179031935, -2.377011043507998, 7.336224962261236, 57.5840314172886, 148.94400313475802, -286.27355747273646, -38.05288701360526, -15.675153673344045, -157.06325915064687, 20.451311784900852, -34.19514158105644, -163.71926844518902, 179.13622751357744, -193.68286217716528, -5.466795255903271, 18.11348646225638, 73.35067178507347, -116.27200227841195, 81.3532898949211, -15.069998875773695, -1.5790888906085807, -103.01419787536915, 39.20269946596015, -70.07117731476804, -109.82064133551206, -6.986631127929058, -36.128808808176835, 15.187313791671755, -14.673585565722401, -251.67950712492743, 6.628822658497688, -90.79739622560763, -223.17849208443, -63.253333383580255, -19.653256456869457, -32.815082218808726, 25.002451968907792, -219.83803663194715], "policy_predator_policy_reward": [5.826870261683667, 69.24665936669969, 324.2059226722713, 187.82411487972215, 153.05478211067583, 113.01714267189817, 17.61674468795218, 70.83651010327776, 56.871368154986286, 191.90703446277513, 141.68851820524378, 0.0, 91.80740741555158, 0.0, 54.17335758922649, 131.5922426112305, 1.0515024123846184, 119.05980597895365, 36.62393073860571, 126.16249015041168, 294.04458931930264, 58.43138602720072, 27.098306487098423, 43.366658498089144, 101.5982771707111, 77.69808380843789, 92.33601550180148, 69.17740583328944, 11.711242094735995, 97.91032777106007, 159.598841430636, 144.42881435000547, 256.62014258831397, 83.17326937041157, 64.7437860571049, 182.14132692717635, 121.33488994630724, 3.428971835429686, 17.92887165747148, 61.97318819646065, 71.37501564844887, 195.79699114833366, 50.574776505310986, 49.41217620680031, 95.99190856070484, 133.02817899556257, 118.64992189155714, 44.429110259031575, 173.65858800042827, 294.7987946549283, 219.5255437438939, 58.84984999166302, 153.020176017792, 148.6350451107507, 84.92152900727922, 86.59987230581754, 35.917401426461, 256.72903135113984, 310.86582010807547, 62.23254304989086, 95.58973110505788, 76.50819038770996, 122.80345328028605, 155.79070810226966, 62.740528734875355, 50.312344307454744, 388.3350217575325, 13.51400281733393, 276.4934910271924, 282.6228917498557, 228.37632836739596, 14.384633174866076, 36.51525084053167, 377.03702896531087, 55.843560999739694, 94.38008995249868, 186.75715567238382, 3.338471062991101, 341.8826036480012, 4.298675114714987, 61.56155472910194, 75.84484689398705, 39.31993402285901, 36.68605729351662, 9.025998199295913, 32.16223211325439, 17.067987561023646, 78.50917759223691, 86.89305015310855, 85.34873130728765, 32.98846306649877, 46.31927657317061, 3.2969657078063443, 120.15435256341586, 51.96603493554656, 113.08180586595923, 51.82953263144456, 147.2709014897984, 28.814437033388117, 169.02459312393165, 122.3689401027523, 69.27638990552909, 2.934690635903009, 71.85406764413669, 69.17481916505344, 16.220654559082863, 82.67464346074956, 54.88464781895127, 149.0452344703959, 85.05170701639402, 61.64654055235777, 6.308513636455049, 122.72811266075166, 9.76569171381375, 28.196503312525255, 11.990037592432142, 39.59465245581429, 93.77925190682629, 173.417858483239, 6.14133330985798, 15.762281811455798, 134.36623570047647, 76.06028203580479, 74.22850676175635, 34.695476680536935, 159.6621907988072, 167.2233660646181, 158.99304802466287, 125.23519084767717, 31.268484989044566, 88.54768969882797, 57.09944401112018, 170.03924007813922, 8.135051974358213, 21.451638560862875, 76.27928161334323, 145.09089770133772, 0.7242794915378635, 119.58478321201947, 55.07339965509877, 101.30347201003724, 267.44746563530987, 25.72851731642294, 50.2482358311191, 10.105741511511418, 193.0090328936931, 242.16798791533478, 39.648464187783205, 159.3499139561802, 28.118359652455005, 62.6282279289202, 164.83895649669932, 73.18508403053936, 110.16493654962441, 168.40666761692708, 267.8603886072499, 213.90796331236706, 124.17924132120368, 231.43704446725934, 63.34348446791769, 164.82322943616253, 100.95781545605833, 192.6461275375021, 19.887349329554755, 38.363775037738804, 35.81596858271153, 113.3458349053624, 230.7853915479533, 54.85288701360539, 39.375153673344265, 203.76325915064663, 1.2486882150991712, 111.99514158105654, 174.21926844518845, 10.863772486422565, 246.3828621771652, 23.366795255903288, 1.686513537743613, 3.0493282149260565, 143.97200227841205, 11.169618052507685, 151.88844071902219, 78.45110531031017, 178.76726219687225, 5.491533832319006, 183.23617029079, 53.44679168121165, 100.62718867369004, 51.62880880817706, 4.512686208328209, 171.62334218999183, 202.77443414774723, 128.4407517753692, 43.32782179174049, 246.32318803637418, 132.52041148399576, 85.60806980806116, 98.80891037849513, 185.52092658311363, 103.72089663179854]}, "sampler_perf": {"mean_raw_obs_processing_ms": 24.612889016885457, "mean_inference_ms": 21.186329230406663, "mean_action_processing_ms": 5.908154806035579, "mean_env_wait_ms": 37.33530745612723, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.09543001651763916, "StateBufferConnector_ms": 0.03673684597015381, "ViewRequirementAgentConnector_ms": 1.255206823348999}, "num_episodes": 0, "episode_return_max": 286.6692231913454, "episode_return_min": -53.94695511723343, "episode_return_mean": 102.60472273081903, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 149312, "num_agent_steps_trained": 149312, "num_env_steps_sampled": 37328, "num_env_steps_trained": 37328, "num_env_steps_sampled_this_iter": 0, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 0.0, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 37328, "num_env_steps_sampled_lifetime": 37328, "num_agent_steps_sampled_lifetime": 149312, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 149312, "timers": {"training_iteration_time_ms": 62361.363, "restore_workers_time_ms": 50.903, "training_step_time_ms": 62228.204, "sample_time_ms": 62196.269, "learn_time_ms": 311236.026, "learn_throughput": 59.967, "synch_weights_time_ms": 43.334}, "counters": {"num_env_steps_sampled": 37328, "num_env_steps_trained": 37328, "num_agent_steps_sampled": 149312, "num_agent_steps_trained": 149312}, "done": false, "training_iteration": 38, "trial_id": "d7bca_00000", "date": "2024-08-20_12-30-10", "timestamp": 1724137210, "time_this_iter_s": 122.76053094863892, "time_total_s": 5798.964057445526, "pid": 36059, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 16000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x32cf5ba60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5798.964057445526, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 95.68588235294118, "ram_util_percent": 83.58588235294118}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {}, "num_env_steps_sampled": 37328, "num_env_steps_trained": 37328, "num_agent_steps_sampled": 149312, "num_agent_steps_trained": 149312}, "env_runners": {"episode_reward_max": 286.6692231913454, "episode_reward_min": -53.94695511723343, "episode_reward_mean": 102.60472273081903, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -382.5350217575324, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 179.13622751357744, "predator_policy": 388.3350217575325}, "policy_reward_mean": {"prey_policy": -50.61742331228365, "predator_policy": 101.91978467769317}, "custom_metrics": {}, "hist_stats": {"episode_reward": [35.10000000000023, -2.2956613079459616, 52.30000000000035, 93.99999999999946, 41.27668545957155, 138.35998813581944, 47.000000000000355, 189.59999999999982, 46.100000000000314, 122.59999999999911, 172.99184762314727, 183.89999999999952, 165.26660970450598, 63.400000000000325, 224.23591029611316, 118.26513246444676, 57.049342065984625, 56.287512516221504, 91.49999999999856, 77.70000000000017, 286.6692231913454, 34.20000000000022, 135.4999999999999, 189.7622134181783, 204.95900501687956, 41.46117592104707, 160.52089757879483, 41.90000000000027, 159.99999999999952, 56.25035590474681, 189.40904152072758, 32.4000000000002, 135.49999999999923, 137.09999999999957, -53.94695511723343, 170.90494465410117, 56.10000000000025, 60.20000000000013, 34.75612756781972, 43.60000000000028, 40.265044310772325, 47.1298862953699, 48.40000000000023, 36.202116310375594, 74.49999999999962, 153.19999999999987, 40.1000000000002, 131.19999999999982, 52.570622032848895, 56.000000000000156, 129.1999999999993, 86.20000000000002, 28.831075919194078, 160.79999999999959, 81.33852172443821, 103.01543537877356, 169.88064982359512, 48.30000000000023, 52.529310579969625, 48.028025438635616, 198.59999999999948, 184.470358209413, 37.06861395355878, 80.95181844992561, 33.900000000000134, 135.39999999999944, 148.89999999999955, 133.69999999999916, 226.89999999999938, 68.3000000000002, 154.45814550558052, 41.47674734270453, 180.74087067540847, 60.139037304427255, 153.66325386820998, 109.81254335834268, 96.80000000000011, 108.61895163315396, 159.3546697445331, 53.10000000000013, 125.29999999999959, 34.93780403323022, 139.0999999999999, 206.80167211533725, 40.50000000000029, 68.40000000000009, 88.29999999999927, 242.69999999999993, 37.700000000000266, 104.09999999999903, 229.34134979067687, 152.6250807412044, 157.8592262743011, 37.26670789146122, 35.20000000000023, 108.04468364708873, 87.5999999999994, 92.41177405235972, 131.94864151087714, 94.40623855187317], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [13.573129738316304, -53.54665936669982, -254.04609845621002, -260.27960040372835, -140.65478211067654, -73.1171426718985, 39.583255312047925, -34.03651010327775, -114.83317908671795, -92.66853807147267, -96.4272326280199, 93.09870255859556, -64.80740741555226, 20.000000000000014, 20.626642410773584, -16.792242611230414, 18.848497587615384, -92.85980597895414, 69.17606926139403, -109.36249015041209, -285.2321358475945, 105.74800812423979, 132.7888944272447, -19.35385941243218, -25.356623210719427, 11.326871936077456, -78.03601550180139, -20.07740583328924, 28.904313331271958, 85.71002709904536, -84.17058524148602, -101.59193807470932, -247.8691803256373, -34.87488956710395, -49.40531904969436, -141.19228141836533, -107.134889946308, 73.87102816456981, 4.171128342528487, -6.373188196460497, 72.0443042732162, -52.54708787865346, -32.67477650531073, -33.11217620680012, 17.408091439294907, -110.92817899556306, 80.28766474857159, -53.604483480981195, 64.90005398718623, -328.3984316256627, -221.37365036394135, -15.540567450569034, -217.97172194166885, 76.83739839192134, -62.4215290072797, -67.19987230581766, 82.82590198976501, -215.4723347673664, -63.01766150909464, -253.83034574412602, -72.05610867549865, 89.36722870345912, -103.9034532802869, -142.29070810227037, 0.5594712651248201, 21.887655692545323, -382.5350217575324, 117.78599718266575, -341.68754507993606, -271.3757928143444, 42.05974767402415, -113.91576456218526, 10.584749159468316, -368.0370289653096, -96.60173288891873, 6.578081936680414, -116.41208622158636, -38.927412945968925, -335.88260364800084, 33.30132488528524, -27.102952922490367, -70.03840438982733, -11.808869660467748, -17.067235360537826, 10.174001800704053, -2.962232113254194, -5.251613856427011, -54.123434986458186, -77.75098136410048, -19.99080009629646, 33.88040540161318, 40.0118549587175, 18.203034292193653, -101.55435256341609, 84.66934503983893, -118.51718584134521, -111.25275039532056, -35.27706169307365, 12.962713255211035, -154.80174341253127, -108.368940102753, 45.92361009447094, 66.26530936409696, -54.85406764413665, -50.32982812857711, -6.234569676365133, 43.52535653925046, -20.284647818951065, -122.72911794687963, -30.02930181547257, 64.88866316909824, -29.828281979136015, 27.845266783971347, 9.541578665059246, 1.103496687474779, 7.009962407567832, -8.299879170194934, -72.54471461247661, -97.58563081684744, -33.94553553761412, 161.42330774007206, -112.95182525200485, -6.1055308568346724, 40.28710026868663, -159.2584299113319, 1.9693763855458568, -203.51123731867187, -41.75335832068283, -112.73519084767737, -9.86848498904447, -75.14768969882805, 64.9005559888798, -41.26096743109789, 11.98667537860044, 89.1022150662958, -53.133135240501986, -21.790897701337713, 102.87572050846154, -103.60518017643587, -2.753002690682439, -77.5059788586302, -136.78681328113666, -35.26167272819433, 0.7616669233566751, 99.3892737675306, -121.76317749732668, -221.41484542454427, -0.26256937414734516, -81.64046493632515, 47.835445195899766, 41.62225202827415, -159.27689309555132, 8.414915969460758, -94.96493654962522, -101.89030278114168, -225.75780180988139, 42.3879814213417, -221.12051631037914, -194.2370444672595, -47.443484467917465, -68.94976936260595, -71.53127552961595, -175.21866179031935, -2.377011043507998, 7.336224962261236, 57.5840314172886, 148.94400313475802, -286.27355747273646, -38.05288701360526, -15.675153673344045, -157.06325915064687, 20.451311784900852, -34.19514158105644, -163.71926844518902, 179.13622751357744, -193.68286217716528, -5.466795255903271, 18.11348646225638, 73.35067178507347, -116.27200227841195, 81.3532898949211, -15.069998875773695, -1.5790888906085807, -103.01419787536915, 39.20269946596015, -70.07117731476804, -109.82064133551206, -6.986631127929058, -36.128808808176835, 15.187313791671755, -14.673585565722401, -251.67950712492743, 6.628822658497688, -90.79739622560763, -223.17849208443, -63.253333383580255, -19.653256456869457, -32.815082218808726, 25.002451968907792, -219.83803663194715], "policy_predator_policy_reward": [5.826870261683667, 69.24665936669969, 324.2059226722713, 187.82411487972215, 153.05478211067583, 113.01714267189817, 17.61674468795218, 70.83651010327776, 56.871368154986286, 191.90703446277513, 141.68851820524378, 0.0, 91.80740741555158, 0.0, 54.17335758922649, 131.5922426112305, 1.0515024123846184, 119.05980597895365, 36.62393073860571, 126.16249015041168, 294.04458931930264, 58.43138602720072, 27.098306487098423, 43.366658498089144, 101.5982771707111, 77.69808380843789, 92.33601550180148, 69.17740583328944, 11.711242094735995, 97.91032777106007, 159.598841430636, 144.42881435000547, 256.62014258831397, 83.17326937041157, 64.7437860571049, 182.14132692717635, 121.33488994630724, 3.428971835429686, 17.92887165747148, 61.97318819646065, 71.37501564844887, 195.79699114833366, 50.574776505310986, 49.41217620680031, 95.99190856070484, 133.02817899556257, 118.64992189155714, 44.429110259031575, 173.65858800042827, 294.7987946549283, 219.5255437438939, 58.84984999166302, 153.020176017792, 148.6350451107507, 84.92152900727922, 86.59987230581754, 35.917401426461, 256.72903135113984, 310.86582010807547, 62.23254304989086, 95.58973110505788, 76.50819038770996, 122.80345328028605, 155.79070810226966, 62.740528734875355, 50.312344307454744, 388.3350217575325, 13.51400281733393, 276.4934910271924, 282.6228917498557, 228.37632836739596, 14.384633174866076, 36.51525084053167, 377.03702896531087, 55.843560999739694, 94.38008995249868, 186.75715567238382, 3.338471062991101, 341.8826036480012, 4.298675114714987, 61.56155472910194, 75.84484689398705, 39.31993402285901, 36.68605729351662, 9.025998199295913, 32.16223211325439, 17.067987561023646, 78.50917759223691, 86.89305015310855, 85.34873130728765, 32.98846306649877, 46.31927657317061, 3.2969657078063443, 120.15435256341586, 51.96603493554656, 113.08180586595923, 51.82953263144456, 147.2709014897984, 28.814437033388117, 169.02459312393165, 122.3689401027523, 69.27638990552909, 2.934690635903009, 71.85406764413669, 69.17481916505344, 16.220654559082863, 82.67464346074956, 54.88464781895127, 149.0452344703959, 85.05170701639402, 61.64654055235777, 6.308513636455049, 122.72811266075166, 9.76569171381375, 28.196503312525255, 11.990037592432142, 39.59465245581429, 93.77925190682629, 173.417858483239, 6.14133330985798, 15.762281811455798, 134.36623570047647, 76.06028203580479, 74.22850676175635, 34.695476680536935, 159.6621907988072, 167.2233660646181, 158.99304802466287, 125.23519084767717, 31.268484989044566, 88.54768969882797, 57.09944401112018, 170.03924007813922, 8.135051974358213, 21.451638560862875, 76.27928161334323, 145.09089770133772, 0.7242794915378635, 119.58478321201947, 55.07339965509877, 101.30347201003724, 267.44746563530987, 25.72851731642294, 50.2482358311191, 10.105741511511418, 193.0090328936931, 242.16798791533478, 39.648464187783205, 159.3499139561802, 28.118359652455005, 62.6282279289202, 164.83895649669932, 73.18508403053936, 110.16493654962441, 168.40666761692708, 267.8603886072499, 213.90796331236706, 124.17924132120368, 231.43704446725934, 63.34348446791769, 164.82322943616253, 100.95781545605833, 192.6461275375021, 19.887349329554755, 38.363775037738804, 35.81596858271153, 113.3458349053624, 230.7853915479533, 54.85288701360539, 39.375153673344265, 203.76325915064663, 1.2486882150991712, 111.99514158105654, 174.21926844518845, 10.863772486422565, 246.3828621771652, 23.366795255903288, 1.686513537743613, 3.0493282149260565, 143.97200227841205, 11.169618052507685, 151.88844071902219, 78.45110531031017, 178.76726219687225, 5.491533832319006, 183.23617029079, 53.44679168121165, 100.62718867369004, 51.62880880817706, 4.512686208328209, 171.62334218999183, 202.77443414774723, 128.4407517753692, 43.32782179174049, 246.32318803637418, 132.52041148399576, 85.60806980806116, 98.80891037849513, 185.52092658311363, 103.72089663179854]}, "sampler_perf": {"mean_raw_obs_processing_ms": 24.612889016885457, "mean_inference_ms": 21.186329230406663, "mean_action_processing_ms": 5.908154806035579, "mean_env_wait_ms": 37.33530745612723, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.09543001651763916, "StateBufferConnector_ms": 0.03673684597015381, "ViewRequirementAgentConnector_ms": 1.255206823348999}, "num_episodes": 0, "episode_return_max": 286.6692231913454, "episode_return_min": -53.94695511723343, "episode_return_mean": 102.60472273081903, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 149312, "num_agent_steps_trained": 149312, "num_env_steps_sampled": 37328, "num_env_steps_trained": 37328, "num_env_steps_sampled_this_iter": 0, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 0.0, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 37328, "num_env_steps_sampled_lifetime": 37328, "num_agent_steps_sampled_lifetime": 149312, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 149312, "timers": {"training_iteration_time_ms": 61927.455, "restore_workers_time_ms": 32.941, "training_step_time_ms": 61828.444, "sample_time_ms": 61801.271, "learn_time_ms": 311236.026, "learn_throughput": 59.967, "synch_weights_time_ms": 43.334}, "counters": {"num_env_steps_sampled": 37328, "num_env_steps_trained": 37328, "num_agent_steps_sampled": 149312, "num_agent_steps_trained": 149312}, "done": false, "training_iteration": 39, "trial_id": "d7bca_00000", "date": "2024-08-20_12-32-16", "timestamp": 1724137336, "time_this_iter_s": 122.88959503173828, "time_total_s": 5921.853652477264, "pid": 36059, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 16000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x32cf6d1f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5921.853652477264, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 95.82352941176471, "ram_util_percent": 83.6329411764706}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {}, "num_env_steps_sampled": 37328, "num_env_steps_trained": 37328, "num_agent_steps_sampled": 149312, "num_agent_steps_trained": 149312}, "env_runners": {"episode_reward_max": 286.6692231913454, "episode_reward_min": -53.94695511723343, "episode_reward_mean": 102.60472273081903, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -382.5350217575324, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 179.13622751357744, "predator_policy": 388.3350217575325}, "policy_reward_mean": {"prey_policy": -50.61742331228365, "predator_policy": 101.91978467769317}, "custom_metrics": {}, "hist_stats": {"episode_reward": [35.10000000000023, -2.2956613079459616, 52.30000000000035, 93.99999999999946, 41.27668545957155, 138.35998813581944, 47.000000000000355, 189.59999999999982, 46.100000000000314, 122.59999999999911, 172.99184762314727, 183.89999999999952, 165.26660970450598, 63.400000000000325, 224.23591029611316, 118.26513246444676, 57.049342065984625, 56.287512516221504, 91.49999999999856, 77.70000000000017, 286.6692231913454, 34.20000000000022, 135.4999999999999, 189.7622134181783, 204.95900501687956, 41.46117592104707, 160.52089757879483, 41.90000000000027, 159.99999999999952, 56.25035590474681, 189.40904152072758, 32.4000000000002, 135.49999999999923, 137.09999999999957, -53.94695511723343, 170.90494465410117, 56.10000000000025, 60.20000000000013, 34.75612756781972, 43.60000000000028, 40.265044310772325, 47.1298862953699, 48.40000000000023, 36.202116310375594, 74.49999999999962, 153.19999999999987, 40.1000000000002, 131.19999999999982, 52.570622032848895, 56.000000000000156, 129.1999999999993, 86.20000000000002, 28.831075919194078, 160.79999999999959, 81.33852172443821, 103.01543537877356, 169.88064982359512, 48.30000000000023, 52.529310579969625, 48.028025438635616, 198.59999999999948, 184.470358209413, 37.06861395355878, 80.95181844992561, 33.900000000000134, 135.39999999999944, 148.89999999999955, 133.69999999999916, 226.89999999999938, 68.3000000000002, 154.45814550558052, 41.47674734270453, 180.74087067540847, 60.139037304427255, 153.66325386820998, 109.81254335834268, 96.80000000000011, 108.61895163315396, 159.3546697445331, 53.10000000000013, 125.29999999999959, 34.93780403323022, 139.0999999999999, 206.80167211533725, 40.50000000000029, 68.40000000000009, 88.29999999999927, 242.69999999999993, 37.700000000000266, 104.09999999999903, 229.34134979067687, 152.6250807412044, 157.8592262743011, 37.26670789146122, 35.20000000000023, 108.04468364708873, 87.5999999999994, 92.41177405235972, 131.94864151087714, 94.40623855187317], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [13.573129738316304, -53.54665936669982, -254.04609845621002, -260.27960040372835, -140.65478211067654, -73.1171426718985, 39.583255312047925, -34.03651010327775, -114.83317908671795, -92.66853807147267, -96.4272326280199, 93.09870255859556, -64.80740741555226, 20.000000000000014, 20.626642410773584, -16.792242611230414, 18.848497587615384, -92.85980597895414, 69.17606926139403, -109.36249015041209, -285.2321358475945, 105.74800812423979, 132.7888944272447, -19.35385941243218, -25.356623210719427, 11.326871936077456, -78.03601550180139, -20.07740583328924, 28.904313331271958, 85.71002709904536, -84.17058524148602, -101.59193807470932, -247.8691803256373, -34.87488956710395, -49.40531904969436, -141.19228141836533, -107.134889946308, 73.87102816456981, 4.171128342528487, -6.373188196460497, 72.0443042732162, -52.54708787865346, -32.67477650531073, -33.11217620680012, 17.408091439294907, -110.92817899556306, 80.28766474857159, -53.604483480981195, 64.90005398718623, -328.3984316256627, -221.37365036394135, -15.540567450569034, -217.97172194166885, 76.83739839192134, -62.4215290072797, -67.19987230581766, 82.82590198976501, -215.4723347673664, -63.01766150909464, -253.83034574412602, -72.05610867549865, 89.36722870345912, -103.9034532802869, -142.29070810227037, 0.5594712651248201, 21.887655692545323, -382.5350217575324, 117.78599718266575, -341.68754507993606, -271.3757928143444, 42.05974767402415, -113.91576456218526, 10.584749159468316, -368.0370289653096, -96.60173288891873, 6.578081936680414, -116.41208622158636, -38.927412945968925, -335.88260364800084, 33.30132488528524, -27.102952922490367, -70.03840438982733, -11.808869660467748, -17.067235360537826, 10.174001800704053, -2.962232113254194, -5.251613856427011, -54.123434986458186, -77.75098136410048, -19.99080009629646, 33.88040540161318, 40.0118549587175, 18.203034292193653, -101.55435256341609, 84.66934503983893, -118.51718584134521, -111.25275039532056, -35.27706169307365, 12.962713255211035, -154.80174341253127, -108.368940102753, 45.92361009447094, 66.26530936409696, -54.85406764413665, -50.32982812857711, -6.234569676365133, 43.52535653925046, -20.284647818951065, -122.72911794687963, -30.02930181547257, 64.88866316909824, -29.828281979136015, 27.845266783971347, 9.541578665059246, 1.103496687474779, 7.009962407567832, -8.299879170194934, -72.54471461247661, -97.58563081684744, -33.94553553761412, 161.42330774007206, -112.95182525200485, -6.1055308568346724, 40.28710026868663, -159.2584299113319, 1.9693763855458568, -203.51123731867187, -41.75335832068283, -112.73519084767737, -9.86848498904447, -75.14768969882805, 64.9005559888798, -41.26096743109789, 11.98667537860044, 89.1022150662958, -53.133135240501986, -21.790897701337713, 102.87572050846154, -103.60518017643587, -2.753002690682439, -77.5059788586302, -136.78681328113666, -35.26167272819433, 0.7616669233566751, 99.3892737675306, -121.76317749732668, -221.41484542454427, -0.26256937414734516, -81.64046493632515, 47.835445195899766, 41.62225202827415, -159.27689309555132, 8.414915969460758, -94.96493654962522, -101.89030278114168, -225.75780180988139, 42.3879814213417, -221.12051631037914, -194.2370444672595, -47.443484467917465, -68.94976936260595, -71.53127552961595, -175.21866179031935, -2.377011043507998, 7.336224962261236, 57.5840314172886, 148.94400313475802, -286.27355747273646, -38.05288701360526, -15.675153673344045, -157.06325915064687, 20.451311784900852, -34.19514158105644, -163.71926844518902, 179.13622751357744, -193.68286217716528, -5.466795255903271, 18.11348646225638, 73.35067178507347, -116.27200227841195, 81.3532898949211, -15.069998875773695, -1.5790888906085807, -103.01419787536915, 39.20269946596015, -70.07117731476804, -109.82064133551206, -6.986631127929058, -36.128808808176835, 15.187313791671755, -14.673585565722401, -251.67950712492743, 6.628822658497688, -90.79739622560763, -223.17849208443, -63.253333383580255, -19.653256456869457, -32.815082218808726, 25.002451968907792, -219.83803663194715], "policy_predator_policy_reward": [5.826870261683667, 69.24665936669969, 324.2059226722713, 187.82411487972215, 153.05478211067583, 113.01714267189817, 17.61674468795218, 70.83651010327776, 56.871368154986286, 191.90703446277513, 141.68851820524378, 0.0, 91.80740741555158, 0.0, 54.17335758922649, 131.5922426112305, 1.0515024123846184, 119.05980597895365, 36.62393073860571, 126.16249015041168, 294.04458931930264, 58.43138602720072, 27.098306487098423, 43.366658498089144, 101.5982771707111, 77.69808380843789, 92.33601550180148, 69.17740583328944, 11.711242094735995, 97.91032777106007, 159.598841430636, 144.42881435000547, 256.62014258831397, 83.17326937041157, 64.7437860571049, 182.14132692717635, 121.33488994630724, 3.428971835429686, 17.92887165747148, 61.97318819646065, 71.37501564844887, 195.79699114833366, 50.574776505310986, 49.41217620680031, 95.99190856070484, 133.02817899556257, 118.64992189155714, 44.429110259031575, 173.65858800042827, 294.7987946549283, 219.5255437438939, 58.84984999166302, 153.020176017792, 148.6350451107507, 84.92152900727922, 86.59987230581754, 35.917401426461, 256.72903135113984, 310.86582010807547, 62.23254304989086, 95.58973110505788, 76.50819038770996, 122.80345328028605, 155.79070810226966, 62.740528734875355, 50.312344307454744, 388.3350217575325, 13.51400281733393, 276.4934910271924, 282.6228917498557, 228.37632836739596, 14.384633174866076, 36.51525084053167, 377.03702896531087, 55.843560999739694, 94.38008995249868, 186.75715567238382, 3.338471062991101, 341.8826036480012, 4.298675114714987, 61.56155472910194, 75.84484689398705, 39.31993402285901, 36.68605729351662, 9.025998199295913, 32.16223211325439, 17.067987561023646, 78.50917759223691, 86.89305015310855, 85.34873130728765, 32.98846306649877, 46.31927657317061, 3.2969657078063443, 120.15435256341586, 51.96603493554656, 113.08180586595923, 51.82953263144456, 147.2709014897984, 28.814437033388117, 169.02459312393165, 122.3689401027523, 69.27638990552909, 2.934690635903009, 71.85406764413669, 69.17481916505344, 16.220654559082863, 82.67464346074956, 54.88464781895127, 149.0452344703959, 85.05170701639402, 61.64654055235777, 6.308513636455049, 122.72811266075166, 9.76569171381375, 28.196503312525255, 11.990037592432142, 39.59465245581429, 93.77925190682629, 173.417858483239, 6.14133330985798, 15.762281811455798, 134.36623570047647, 76.06028203580479, 74.22850676175635, 34.695476680536935, 159.6621907988072, 167.2233660646181, 158.99304802466287, 125.23519084767717, 31.268484989044566, 88.54768969882797, 57.09944401112018, 170.03924007813922, 8.135051974358213, 21.451638560862875, 76.27928161334323, 145.09089770133772, 0.7242794915378635, 119.58478321201947, 55.07339965509877, 101.30347201003724, 267.44746563530987, 25.72851731642294, 50.2482358311191, 10.105741511511418, 193.0090328936931, 242.16798791533478, 39.648464187783205, 159.3499139561802, 28.118359652455005, 62.6282279289202, 164.83895649669932, 73.18508403053936, 110.16493654962441, 168.40666761692708, 267.8603886072499, 213.90796331236706, 124.17924132120368, 231.43704446725934, 63.34348446791769, 164.82322943616253, 100.95781545605833, 192.6461275375021, 19.887349329554755, 38.363775037738804, 35.81596858271153, 113.3458349053624, 230.7853915479533, 54.85288701360539, 39.375153673344265, 203.76325915064663, 1.2486882150991712, 111.99514158105654, 174.21926844518845, 10.863772486422565, 246.3828621771652, 23.366795255903288, 1.686513537743613, 3.0493282149260565, 143.97200227841205, 11.169618052507685, 151.88844071902219, 78.45110531031017, 178.76726219687225, 5.491533832319006, 183.23617029079, 53.44679168121165, 100.62718867369004, 51.62880880817706, 4.512686208328209, 171.62334218999183, 202.77443414774723, 128.4407517753692, 43.32782179174049, 246.32318803637418, 132.52041148399576, 85.60806980806116, 98.80891037849513, 185.52092658311363, 103.72089663179854]}, "sampler_perf": {"mean_raw_obs_processing_ms": 24.612889016885457, "mean_inference_ms": 21.186329230406663, "mean_action_processing_ms": 5.908154806035579, "mean_env_wait_ms": 37.33530745612723, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.09543001651763916, "StateBufferConnector_ms": 0.03673684597015381, "ViewRequirementAgentConnector_ms": 1.255206823348999}, "num_episodes": 0, "episode_return_max": 286.6692231913454, "episode_return_min": -53.94695511723343, "episode_return_mean": 102.60472273081903, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 149312, "num_agent_steps_trained": 149312, "num_env_steps_sampled": 37328, "num_env_steps_trained": 37328, "num_env_steps_sampled_this_iter": 0, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 0.0, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 37328, "num_env_steps_sampled_lifetime": 37328, "num_agent_steps_sampled_lifetime": 149312, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 149312, "timers": {"training_iteration_time_ms": 61863.917, "restore_workers_time_ms": 29.898, "training_step_time_ms": 61776.25, "sample_time_ms": 61749.019, "learn_time_ms": 311236.026, "learn_throughput": 59.967, "synch_weights_time_ms": 43.334}, "counters": {"num_env_steps_sampled": 37328, "num_env_steps_trained": 37328, "num_agent_steps_sampled": 149312, "num_agent_steps_trained": 149312}, "done": false, "training_iteration": 40, "trial_id": "d7bca_00000", "date": "2024-08-20_12-34-23", "timestamp": 1724137463, "time_this_iter_s": 123.17166304588318, "time_total_s": 6045.025315523148, "pid": 36059, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 16000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3ae8cf9d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 6045.025315523148, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 96.1470930232558, "ram_util_percent": 83.62034883720933}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {}, "num_env_steps_sampled": 37328, "num_env_steps_trained": 37328, "num_agent_steps_sampled": 149312, "num_agent_steps_trained": 149312}, "env_runners": {"episode_reward_max": 286.6692231913454, "episode_reward_min": -53.94695511723343, "episode_reward_mean": 102.60472273081903, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -382.5350217575324, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 179.13622751357744, "predator_policy": 388.3350217575325}, "policy_reward_mean": {"prey_policy": -50.61742331228365, "predator_policy": 101.91978467769317}, "custom_metrics": {}, "hist_stats": {"episode_reward": [35.10000000000023, -2.2956613079459616, 52.30000000000035, 93.99999999999946, 41.27668545957155, 138.35998813581944, 47.000000000000355, 189.59999999999982, 46.100000000000314, 122.59999999999911, 172.99184762314727, 183.89999999999952, 165.26660970450598, 63.400000000000325, 224.23591029611316, 118.26513246444676, 57.049342065984625, 56.287512516221504, 91.49999999999856, 77.70000000000017, 286.6692231913454, 34.20000000000022, 135.4999999999999, 189.7622134181783, 204.95900501687956, 41.46117592104707, 160.52089757879483, 41.90000000000027, 159.99999999999952, 56.25035590474681, 189.40904152072758, 32.4000000000002, 135.49999999999923, 137.09999999999957, -53.94695511723343, 170.90494465410117, 56.10000000000025, 60.20000000000013, 34.75612756781972, 43.60000000000028, 40.265044310772325, 47.1298862953699, 48.40000000000023, 36.202116310375594, 74.49999999999962, 153.19999999999987, 40.1000000000002, 131.19999999999982, 52.570622032848895, 56.000000000000156, 129.1999999999993, 86.20000000000002, 28.831075919194078, 160.79999999999959, 81.33852172443821, 103.01543537877356, 169.88064982359512, 48.30000000000023, 52.529310579969625, 48.028025438635616, 198.59999999999948, 184.470358209413, 37.06861395355878, 80.95181844992561, 33.900000000000134, 135.39999999999944, 148.89999999999955, 133.69999999999916, 226.89999999999938, 68.3000000000002, 154.45814550558052, 41.47674734270453, 180.74087067540847, 60.139037304427255, 153.66325386820998, 109.81254335834268, 96.80000000000011, 108.61895163315396, 159.3546697445331, 53.10000000000013, 125.29999999999959, 34.93780403323022, 139.0999999999999, 206.80167211533725, 40.50000000000029, 68.40000000000009, 88.29999999999927, 242.69999999999993, 37.700000000000266, 104.09999999999903, 229.34134979067687, 152.6250807412044, 157.8592262743011, 37.26670789146122, 35.20000000000023, 108.04468364708873, 87.5999999999994, 92.41177405235972, 131.94864151087714, 94.40623855187317], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [13.573129738316304, -53.54665936669982, -254.04609845621002, -260.27960040372835, -140.65478211067654, -73.1171426718985, 39.583255312047925, -34.03651010327775, -114.83317908671795, -92.66853807147267, -96.4272326280199, 93.09870255859556, -64.80740741555226, 20.000000000000014, 20.626642410773584, -16.792242611230414, 18.848497587615384, -92.85980597895414, 69.17606926139403, -109.36249015041209, -285.2321358475945, 105.74800812423979, 132.7888944272447, -19.35385941243218, -25.356623210719427, 11.326871936077456, -78.03601550180139, -20.07740583328924, 28.904313331271958, 85.71002709904536, -84.17058524148602, -101.59193807470932, -247.8691803256373, -34.87488956710395, -49.40531904969436, -141.19228141836533, -107.134889946308, 73.87102816456981, 4.171128342528487, -6.373188196460497, 72.0443042732162, -52.54708787865346, -32.67477650531073, -33.11217620680012, 17.408091439294907, -110.92817899556306, 80.28766474857159, -53.604483480981195, 64.90005398718623, -328.3984316256627, -221.37365036394135, -15.540567450569034, -217.97172194166885, 76.83739839192134, -62.4215290072797, -67.19987230581766, 82.82590198976501, -215.4723347673664, -63.01766150909464, -253.83034574412602, -72.05610867549865, 89.36722870345912, -103.9034532802869, -142.29070810227037, 0.5594712651248201, 21.887655692545323, -382.5350217575324, 117.78599718266575, -341.68754507993606, -271.3757928143444, 42.05974767402415, -113.91576456218526, 10.584749159468316, -368.0370289653096, -96.60173288891873, 6.578081936680414, -116.41208622158636, -38.927412945968925, -335.88260364800084, 33.30132488528524, -27.102952922490367, -70.03840438982733, -11.808869660467748, -17.067235360537826, 10.174001800704053, -2.962232113254194, -5.251613856427011, -54.123434986458186, -77.75098136410048, -19.99080009629646, 33.88040540161318, 40.0118549587175, 18.203034292193653, -101.55435256341609, 84.66934503983893, -118.51718584134521, -111.25275039532056, -35.27706169307365, 12.962713255211035, -154.80174341253127, -108.368940102753, 45.92361009447094, 66.26530936409696, -54.85406764413665, -50.32982812857711, -6.234569676365133, 43.52535653925046, -20.284647818951065, -122.72911794687963, -30.02930181547257, 64.88866316909824, -29.828281979136015, 27.845266783971347, 9.541578665059246, 1.103496687474779, 7.009962407567832, -8.299879170194934, -72.54471461247661, -97.58563081684744, -33.94553553761412, 161.42330774007206, -112.95182525200485, -6.1055308568346724, 40.28710026868663, -159.2584299113319, 1.9693763855458568, -203.51123731867187, -41.75335832068283, -112.73519084767737, -9.86848498904447, -75.14768969882805, 64.9005559888798, -41.26096743109789, 11.98667537860044, 89.1022150662958, -53.133135240501986, -21.790897701337713, 102.87572050846154, -103.60518017643587, -2.753002690682439, -77.5059788586302, -136.78681328113666, -35.26167272819433, 0.7616669233566751, 99.3892737675306, -121.76317749732668, -221.41484542454427, -0.26256937414734516, -81.64046493632515, 47.835445195899766, 41.62225202827415, -159.27689309555132, 8.414915969460758, -94.96493654962522, -101.89030278114168, -225.75780180988139, 42.3879814213417, -221.12051631037914, -194.2370444672595, -47.443484467917465, -68.94976936260595, -71.53127552961595, -175.21866179031935, -2.377011043507998, 7.336224962261236, 57.5840314172886, 148.94400313475802, -286.27355747273646, -38.05288701360526, -15.675153673344045, -157.06325915064687, 20.451311784900852, -34.19514158105644, -163.71926844518902, 179.13622751357744, -193.68286217716528, -5.466795255903271, 18.11348646225638, 73.35067178507347, -116.27200227841195, 81.3532898949211, -15.069998875773695, -1.5790888906085807, -103.01419787536915, 39.20269946596015, -70.07117731476804, -109.82064133551206, -6.986631127929058, -36.128808808176835, 15.187313791671755, -14.673585565722401, -251.67950712492743, 6.628822658497688, -90.79739622560763, -223.17849208443, -63.253333383580255, -19.653256456869457, -32.815082218808726, 25.002451968907792, -219.83803663194715], "policy_predator_policy_reward": [5.826870261683667, 69.24665936669969, 324.2059226722713, 187.82411487972215, 153.05478211067583, 113.01714267189817, 17.61674468795218, 70.83651010327776, 56.871368154986286, 191.90703446277513, 141.68851820524378, 0.0, 91.80740741555158, 0.0, 54.17335758922649, 131.5922426112305, 1.0515024123846184, 119.05980597895365, 36.62393073860571, 126.16249015041168, 294.04458931930264, 58.43138602720072, 27.098306487098423, 43.366658498089144, 101.5982771707111, 77.69808380843789, 92.33601550180148, 69.17740583328944, 11.711242094735995, 97.91032777106007, 159.598841430636, 144.42881435000547, 256.62014258831397, 83.17326937041157, 64.7437860571049, 182.14132692717635, 121.33488994630724, 3.428971835429686, 17.92887165747148, 61.97318819646065, 71.37501564844887, 195.79699114833366, 50.574776505310986, 49.41217620680031, 95.99190856070484, 133.02817899556257, 118.64992189155714, 44.429110259031575, 173.65858800042827, 294.7987946549283, 219.5255437438939, 58.84984999166302, 153.020176017792, 148.6350451107507, 84.92152900727922, 86.59987230581754, 35.917401426461, 256.72903135113984, 310.86582010807547, 62.23254304989086, 95.58973110505788, 76.50819038770996, 122.80345328028605, 155.79070810226966, 62.740528734875355, 50.312344307454744, 388.3350217575325, 13.51400281733393, 276.4934910271924, 282.6228917498557, 228.37632836739596, 14.384633174866076, 36.51525084053167, 377.03702896531087, 55.843560999739694, 94.38008995249868, 186.75715567238382, 3.338471062991101, 341.8826036480012, 4.298675114714987, 61.56155472910194, 75.84484689398705, 39.31993402285901, 36.68605729351662, 9.025998199295913, 32.16223211325439, 17.067987561023646, 78.50917759223691, 86.89305015310855, 85.34873130728765, 32.98846306649877, 46.31927657317061, 3.2969657078063443, 120.15435256341586, 51.96603493554656, 113.08180586595923, 51.82953263144456, 147.2709014897984, 28.814437033388117, 169.02459312393165, 122.3689401027523, 69.27638990552909, 2.934690635903009, 71.85406764413669, 69.17481916505344, 16.220654559082863, 82.67464346074956, 54.88464781895127, 149.0452344703959, 85.05170701639402, 61.64654055235777, 6.308513636455049, 122.72811266075166, 9.76569171381375, 28.196503312525255, 11.990037592432142, 39.59465245581429, 93.77925190682629, 173.417858483239, 6.14133330985798, 15.762281811455798, 134.36623570047647, 76.06028203580479, 74.22850676175635, 34.695476680536935, 159.6621907988072, 167.2233660646181, 158.99304802466287, 125.23519084767717, 31.268484989044566, 88.54768969882797, 57.09944401112018, 170.03924007813922, 8.135051974358213, 21.451638560862875, 76.27928161334323, 145.09089770133772, 0.7242794915378635, 119.58478321201947, 55.07339965509877, 101.30347201003724, 267.44746563530987, 25.72851731642294, 50.2482358311191, 10.105741511511418, 193.0090328936931, 242.16798791533478, 39.648464187783205, 159.3499139561802, 28.118359652455005, 62.6282279289202, 164.83895649669932, 73.18508403053936, 110.16493654962441, 168.40666761692708, 267.8603886072499, 213.90796331236706, 124.17924132120368, 231.43704446725934, 63.34348446791769, 164.82322943616253, 100.95781545605833, 192.6461275375021, 19.887349329554755, 38.363775037738804, 35.81596858271153, 113.3458349053624, 230.7853915479533, 54.85288701360539, 39.375153673344265, 203.76325915064663, 1.2486882150991712, 111.99514158105654, 174.21926844518845, 10.863772486422565, 246.3828621771652, 23.366795255903288, 1.686513537743613, 3.0493282149260565, 143.97200227841205, 11.169618052507685, 151.88844071902219, 78.45110531031017, 178.76726219687225, 5.491533832319006, 183.23617029079, 53.44679168121165, 100.62718867369004, 51.62880880817706, 4.512686208328209, 171.62334218999183, 202.77443414774723, 128.4407517753692, 43.32782179174049, 246.32318803637418, 132.52041148399576, 85.60806980806116, 98.80891037849513, 185.52092658311363, 103.72089663179854]}, "sampler_perf": {"mean_raw_obs_processing_ms": 24.612889016885457, "mean_inference_ms": 21.186329230406663, "mean_action_processing_ms": 5.908154806035579, "mean_env_wait_ms": 37.33530745612723, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.09543001651763916, "StateBufferConnector_ms": 0.03673684597015381, "ViewRequirementAgentConnector_ms": 1.255206823348999}, "num_episodes": 0, "episode_return_max": 286.6692231913454, "episode_return_min": -53.94695511723343, "episode_return_mean": 102.60472273081903, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 149312, "num_agent_steps_trained": 149312, "num_env_steps_sampled": 37328, "num_env_steps_trained": 37328, "num_env_steps_sampled_this_iter": 0, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 0.0, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 37328, "num_env_steps_sampled_lifetime": 37328, "num_agent_steps_sampled_lifetime": 149312, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 149312, "timers": {"training_iteration_time_ms": 61807.928, "restore_workers_time_ms": 26.859, "training_step_time_ms": 61725.453, "sample_time_ms": 61698.941, "learn_time_ms": 311236.026, "learn_throughput": 59.967, "synch_weights_time_ms": 43.334}, "counters": {"num_env_steps_sampled": 37328, "num_env_steps_trained": 37328, "num_agent_steps_sampled": 149312, "num_agent_steps_trained": 149312}, "done": false, "training_iteration": 41, "trial_id": "d7bca_00000", "date": "2024-08-20_12-36-28", "timestamp": 1724137588, "time_this_iter_s": 122.92766499519348, "time_total_s": 6167.952980518341, "pid": 36059, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 16000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x32cf6d550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 6167.952980518341, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 95.17836257309942, "ram_util_percent": 83.63508771929826}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {}, "num_env_steps_sampled": 37328, "num_env_steps_trained": 37328, "num_agent_steps_sampled": 149312, "num_agent_steps_trained": 149312}, "env_runners": {"episode_reward_max": 286.6692231913454, "episode_reward_min": -53.94695511723343, "episode_reward_mean": 102.60472273081903, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -382.5350217575324, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 179.13622751357744, "predator_policy": 388.3350217575325}, "policy_reward_mean": {"prey_policy": -50.61742331228365, "predator_policy": 101.91978467769317}, "custom_metrics": {}, "hist_stats": {"episode_reward": [35.10000000000023, -2.2956613079459616, 52.30000000000035, 93.99999999999946, 41.27668545957155, 138.35998813581944, 47.000000000000355, 189.59999999999982, 46.100000000000314, 122.59999999999911, 172.99184762314727, 183.89999999999952, 165.26660970450598, 63.400000000000325, 224.23591029611316, 118.26513246444676, 57.049342065984625, 56.287512516221504, 91.49999999999856, 77.70000000000017, 286.6692231913454, 34.20000000000022, 135.4999999999999, 189.7622134181783, 204.95900501687956, 41.46117592104707, 160.52089757879483, 41.90000000000027, 159.99999999999952, 56.25035590474681, 189.40904152072758, 32.4000000000002, 135.49999999999923, 137.09999999999957, -53.94695511723343, 170.90494465410117, 56.10000000000025, 60.20000000000013, 34.75612756781972, 43.60000000000028, 40.265044310772325, 47.1298862953699, 48.40000000000023, 36.202116310375594, 74.49999999999962, 153.19999999999987, 40.1000000000002, 131.19999999999982, 52.570622032848895, 56.000000000000156, 129.1999999999993, 86.20000000000002, 28.831075919194078, 160.79999999999959, 81.33852172443821, 103.01543537877356, 169.88064982359512, 48.30000000000023, 52.529310579969625, 48.028025438635616, 198.59999999999948, 184.470358209413, 37.06861395355878, 80.95181844992561, 33.900000000000134, 135.39999999999944, 148.89999999999955, 133.69999999999916, 226.89999999999938, 68.3000000000002, 154.45814550558052, 41.47674734270453, 180.74087067540847, 60.139037304427255, 153.66325386820998, 109.81254335834268, 96.80000000000011, 108.61895163315396, 159.3546697445331, 53.10000000000013, 125.29999999999959, 34.93780403323022, 139.0999999999999, 206.80167211533725, 40.50000000000029, 68.40000000000009, 88.29999999999927, 242.69999999999993, 37.700000000000266, 104.09999999999903, 229.34134979067687, 152.6250807412044, 157.8592262743011, 37.26670789146122, 35.20000000000023, 108.04468364708873, 87.5999999999994, 92.41177405235972, 131.94864151087714, 94.40623855187317], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [13.573129738316304, -53.54665936669982, -254.04609845621002, -260.27960040372835, -140.65478211067654, -73.1171426718985, 39.583255312047925, -34.03651010327775, -114.83317908671795, -92.66853807147267, -96.4272326280199, 93.09870255859556, -64.80740741555226, 20.000000000000014, 20.626642410773584, -16.792242611230414, 18.848497587615384, -92.85980597895414, 69.17606926139403, -109.36249015041209, -285.2321358475945, 105.74800812423979, 132.7888944272447, -19.35385941243218, -25.356623210719427, 11.326871936077456, -78.03601550180139, -20.07740583328924, 28.904313331271958, 85.71002709904536, -84.17058524148602, -101.59193807470932, -247.8691803256373, -34.87488956710395, -49.40531904969436, -141.19228141836533, -107.134889946308, 73.87102816456981, 4.171128342528487, -6.373188196460497, 72.0443042732162, -52.54708787865346, -32.67477650531073, -33.11217620680012, 17.408091439294907, -110.92817899556306, 80.28766474857159, -53.604483480981195, 64.90005398718623, -328.3984316256627, -221.37365036394135, -15.540567450569034, -217.97172194166885, 76.83739839192134, -62.4215290072797, -67.19987230581766, 82.82590198976501, -215.4723347673664, -63.01766150909464, -253.83034574412602, -72.05610867549865, 89.36722870345912, -103.9034532802869, -142.29070810227037, 0.5594712651248201, 21.887655692545323, -382.5350217575324, 117.78599718266575, -341.68754507993606, -271.3757928143444, 42.05974767402415, -113.91576456218526, 10.584749159468316, -368.0370289653096, -96.60173288891873, 6.578081936680414, -116.41208622158636, -38.927412945968925, -335.88260364800084, 33.30132488528524, -27.102952922490367, -70.03840438982733, -11.808869660467748, -17.067235360537826, 10.174001800704053, -2.962232113254194, -5.251613856427011, -54.123434986458186, -77.75098136410048, -19.99080009629646, 33.88040540161318, 40.0118549587175, 18.203034292193653, -101.55435256341609, 84.66934503983893, -118.51718584134521, -111.25275039532056, -35.27706169307365, 12.962713255211035, -154.80174341253127, -108.368940102753, 45.92361009447094, 66.26530936409696, -54.85406764413665, -50.32982812857711, -6.234569676365133, 43.52535653925046, -20.284647818951065, -122.72911794687963, -30.02930181547257, 64.88866316909824, -29.828281979136015, 27.845266783971347, 9.541578665059246, 1.103496687474779, 7.009962407567832, -8.299879170194934, -72.54471461247661, -97.58563081684744, -33.94553553761412, 161.42330774007206, -112.95182525200485, -6.1055308568346724, 40.28710026868663, -159.2584299113319, 1.9693763855458568, -203.51123731867187, -41.75335832068283, -112.73519084767737, -9.86848498904447, -75.14768969882805, 64.9005559888798, -41.26096743109789, 11.98667537860044, 89.1022150662958, -53.133135240501986, -21.790897701337713, 102.87572050846154, -103.60518017643587, -2.753002690682439, -77.5059788586302, -136.78681328113666, -35.26167272819433, 0.7616669233566751, 99.3892737675306, -121.76317749732668, -221.41484542454427, -0.26256937414734516, -81.64046493632515, 47.835445195899766, 41.62225202827415, -159.27689309555132, 8.414915969460758, -94.96493654962522, -101.89030278114168, -225.75780180988139, 42.3879814213417, -221.12051631037914, -194.2370444672595, -47.443484467917465, -68.94976936260595, -71.53127552961595, -175.21866179031935, -2.377011043507998, 7.336224962261236, 57.5840314172886, 148.94400313475802, -286.27355747273646, -38.05288701360526, -15.675153673344045, -157.06325915064687, 20.451311784900852, -34.19514158105644, -163.71926844518902, 179.13622751357744, -193.68286217716528, -5.466795255903271, 18.11348646225638, 73.35067178507347, -116.27200227841195, 81.3532898949211, -15.069998875773695, -1.5790888906085807, -103.01419787536915, 39.20269946596015, -70.07117731476804, -109.82064133551206, -6.986631127929058, -36.128808808176835, 15.187313791671755, -14.673585565722401, -251.67950712492743, 6.628822658497688, -90.79739622560763, -223.17849208443, -63.253333383580255, -19.653256456869457, -32.815082218808726, 25.002451968907792, -219.83803663194715], "policy_predator_policy_reward": [5.826870261683667, 69.24665936669969, 324.2059226722713, 187.82411487972215, 153.05478211067583, 113.01714267189817, 17.61674468795218, 70.83651010327776, 56.871368154986286, 191.90703446277513, 141.68851820524378, 0.0, 91.80740741555158, 0.0, 54.17335758922649, 131.5922426112305, 1.0515024123846184, 119.05980597895365, 36.62393073860571, 126.16249015041168, 294.04458931930264, 58.43138602720072, 27.098306487098423, 43.366658498089144, 101.5982771707111, 77.69808380843789, 92.33601550180148, 69.17740583328944, 11.711242094735995, 97.91032777106007, 159.598841430636, 144.42881435000547, 256.62014258831397, 83.17326937041157, 64.7437860571049, 182.14132692717635, 121.33488994630724, 3.428971835429686, 17.92887165747148, 61.97318819646065, 71.37501564844887, 195.79699114833366, 50.574776505310986, 49.41217620680031, 95.99190856070484, 133.02817899556257, 118.64992189155714, 44.429110259031575, 173.65858800042827, 294.7987946549283, 219.5255437438939, 58.84984999166302, 153.020176017792, 148.6350451107507, 84.92152900727922, 86.59987230581754, 35.917401426461, 256.72903135113984, 310.86582010807547, 62.23254304989086, 95.58973110505788, 76.50819038770996, 122.80345328028605, 155.79070810226966, 62.740528734875355, 50.312344307454744, 388.3350217575325, 13.51400281733393, 276.4934910271924, 282.6228917498557, 228.37632836739596, 14.384633174866076, 36.51525084053167, 377.03702896531087, 55.843560999739694, 94.38008995249868, 186.75715567238382, 3.338471062991101, 341.8826036480012, 4.298675114714987, 61.56155472910194, 75.84484689398705, 39.31993402285901, 36.68605729351662, 9.025998199295913, 32.16223211325439, 17.067987561023646, 78.50917759223691, 86.89305015310855, 85.34873130728765, 32.98846306649877, 46.31927657317061, 3.2969657078063443, 120.15435256341586, 51.96603493554656, 113.08180586595923, 51.82953263144456, 147.2709014897984, 28.814437033388117, 169.02459312393165, 122.3689401027523, 69.27638990552909, 2.934690635903009, 71.85406764413669, 69.17481916505344, 16.220654559082863, 82.67464346074956, 54.88464781895127, 149.0452344703959, 85.05170701639402, 61.64654055235777, 6.308513636455049, 122.72811266075166, 9.76569171381375, 28.196503312525255, 11.990037592432142, 39.59465245581429, 93.77925190682629, 173.417858483239, 6.14133330985798, 15.762281811455798, 134.36623570047647, 76.06028203580479, 74.22850676175635, 34.695476680536935, 159.6621907988072, 167.2233660646181, 158.99304802466287, 125.23519084767717, 31.268484989044566, 88.54768969882797, 57.09944401112018, 170.03924007813922, 8.135051974358213, 21.451638560862875, 76.27928161334323, 145.09089770133772, 0.7242794915378635, 119.58478321201947, 55.07339965509877, 101.30347201003724, 267.44746563530987, 25.72851731642294, 50.2482358311191, 10.105741511511418, 193.0090328936931, 242.16798791533478, 39.648464187783205, 159.3499139561802, 28.118359652455005, 62.6282279289202, 164.83895649669932, 73.18508403053936, 110.16493654962441, 168.40666761692708, 267.8603886072499, 213.90796331236706, 124.17924132120368, 231.43704446725934, 63.34348446791769, 164.82322943616253, 100.95781545605833, 192.6461275375021, 19.887349329554755, 38.363775037738804, 35.81596858271153, 113.3458349053624, 230.7853915479533, 54.85288701360539, 39.375153673344265, 203.76325915064663, 1.2486882150991712, 111.99514158105654, 174.21926844518845, 10.863772486422565, 246.3828621771652, 23.366795255903288, 1.686513537743613, 3.0493282149260565, 143.97200227841205, 11.169618052507685, 151.88844071902219, 78.45110531031017, 178.76726219687225, 5.491533832319006, 183.23617029079, 53.44679168121165, 100.62718867369004, 51.62880880817706, 4.512686208328209, 171.62334218999183, 202.77443414774723, 128.4407517753692, 43.32782179174049, 246.32318803637418, 132.52041148399576, 85.60806980806116, 98.80891037849513, 185.52092658311363, 103.72089663179854]}, "sampler_perf": {"mean_raw_obs_processing_ms": 24.612889016885457, "mean_inference_ms": 21.186329230406663, "mean_action_processing_ms": 5.908154806035579, "mean_env_wait_ms": 37.33530745612723, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.09543001651763916, "StateBufferConnector_ms": 0.03673684597015381, "ViewRequirementAgentConnector_ms": 1.255206823348999}, "num_episodes": 0, "episode_return_max": 286.6692231913454, "episode_return_min": -53.94695511723343, "episode_return_mean": 102.60472273081903, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 149312, "num_agent_steps_trained": 149312, "num_env_steps_sampled": 37328, "num_env_steps_trained": 37328, "num_env_steps_sampled_this_iter": 0, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 0.0, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 37328, "num_env_steps_sampled_lifetime": 37328, "num_agent_steps_sampled_lifetime": 149312, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 149312, "timers": {"training_iteration_time_ms": 61732.373, "restore_workers_time_ms": 24.393, "training_step_time_ms": 61661.04, "sample_time_ms": 61632.914, "learn_time_ms": 311236.026, "learn_throughput": 59.967, "synch_weights_time_ms": 43.334}, "counters": {"num_env_steps_sampled": 37328, "num_env_steps_trained": 37328, "num_agent_steps_sampled": 149312, "num_agent_steps_trained": 149312}, "done": false, "training_iteration": 42, "trial_id": "d7bca_00000", "date": "2024-08-20_12-38-35", "timestamp": 1724137715, "time_this_iter_s": 123.68068790435791, "time_total_s": 6291.633668422699, "pid": 36059, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 16000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x32cf6d4c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 6291.633668422699, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 95.34682080924856, "ram_util_percent": 83.6034682080925}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {}, "num_env_steps_sampled": 37328, "num_env_steps_trained": 37328, "num_agent_steps_sampled": 149312, "num_agent_steps_trained": 149312}, "env_runners": {"episode_reward_max": 286.6692231913454, "episode_reward_min": -53.94695511723343, "episode_reward_mean": 102.60472273081903, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -382.5350217575324, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 179.13622751357744, "predator_policy": 388.3350217575325}, "policy_reward_mean": {"prey_policy": -50.61742331228365, "predator_policy": 101.91978467769317}, "custom_metrics": {}, "hist_stats": {"episode_reward": [35.10000000000023, -2.2956613079459616, 52.30000000000035, 93.99999999999946, 41.27668545957155, 138.35998813581944, 47.000000000000355, 189.59999999999982, 46.100000000000314, 122.59999999999911, 172.99184762314727, 183.89999999999952, 165.26660970450598, 63.400000000000325, 224.23591029611316, 118.26513246444676, 57.049342065984625, 56.287512516221504, 91.49999999999856, 77.70000000000017, 286.6692231913454, 34.20000000000022, 135.4999999999999, 189.7622134181783, 204.95900501687956, 41.46117592104707, 160.52089757879483, 41.90000000000027, 159.99999999999952, 56.25035590474681, 189.40904152072758, 32.4000000000002, 135.49999999999923, 137.09999999999957, -53.94695511723343, 170.90494465410117, 56.10000000000025, 60.20000000000013, 34.75612756781972, 43.60000000000028, 40.265044310772325, 47.1298862953699, 48.40000000000023, 36.202116310375594, 74.49999999999962, 153.19999999999987, 40.1000000000002, 131.19999999999982, 52.570622032848895, 56.000000000000156, 129.1999999999993, 86.20000000000002, 28.831075919194078, 160.79999999999959, 81.33852172443821, 103.01543537877356, 169.88064982359512, 48.30000000000023, 52.529310579969625, 48.028025438635616, 198.59999999999948, 184.470358209413, 37.06861395355878, 80.95181844992561, 33.900000000000134, 135.39999999999944, 148.89999999999955, 133.69999999999916, 226.89999999999938, 68.3000000000002, 154.45814550558052, 41.47674734270453, 180.74087067540847, 60.139037304427255, 153.66325386820998, 109.81254335834268, 96.80000000000011, 108.61895163315396, 159.3546697445331, 53.10000000000013, 125.29999999999959, 34.93780403323022, 139.0999999999999, 206.80167211533725, 40.50000000000029, 68.40000000000009, 88.29999999999927, 242.69999999999993, 37.700000000000266, 104.09999999999903, 229.34134979067687, 152.6250807412044, 157.8592262743011, 37.26670789146122, 35.20000000000023, 108.04468364708873, 87.5999999999994, 92.41177405235972, 131.94864151087714, 94.40623855187317], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [13.573129738316304, -53.54665936669982, -254.04609845621002, -260.27960040372835, -140.65478211067654, -73.1171426718985, 39.583255312047925, -34.03651010327775, -114.83317908671795, -92.66853807147267, -96.4272326280199, 93.09870255859556, -64.80740741555226, 20.000000000000014, 20.626642410773584, -16.792242611230414, 18.848497587615384, -92.85980597895414, 69.17606926139403, -109.36249015041209, -285.2321358475945, 105.74800812423979, 132.7888944272447, -19.35385941243218, -25.356623210719427, 11.326871936077456, -78.03601550180139, -20.07740583328924, 28.904313331271958, 85.71002709904536, -84.17058524148602, -101.59193807470932, -247.8691803256373, -34.87488956710395, -49.40531904969436, -141.19228141836533, -107.134889946308, 73.87102816456981, 4.171128342528487, -6.373188196460497, 72.0443042732162, -52.54708787865346, -32.67477650531073, -33.11217620680012, 17.408091439294907, -110.92817899556306, 80.28766474857159, -53.604483480981195, 64.90005398718623, -328.3984316256627, -221.37365036394135, -15.540567450569034, -217.97172194166885, 76.83739839192134, -62.4215290072797, -67.19987230581766, 82.82590198976501, -215.4723347673664, -63.01766150909464, -253.83034574412602, -72.05610867549865, 89.36722870345912, -103.9034532802869, -142.29070810227037, 0.5594712651248201, 21.887655692545323, -382.5350217575324, 117.78599718266575, -341.68754507993606, -271.3757928143444, 42.05974767402415, -113.91576456218526, 10.584749159468316, -368.0370289653096, -96.60173288891873, 6.578081936680414, -116.41208622158636, -38.927412945968925, -335.88260364800084, 33.30132488528524, -27.102952922490367, -70.03840438982733, -11.808869660467748, -17.067235360537826, 10.174001800704053, -2.962232113254194, -5.251613856427011, -54.123434986458186, -77.75098136410048, -19.99080009629646, 33.88040540161318, 40.0118549587175, 18.203034292193653, -101.55435256341609, 84.66934503983893, -118.51718584134521, -111.25275039532056, -35.27706169307365, 12.962713255211035, -154.80174341253127, -108.368940102753, 45.92361009447094, 66.26530936409696, -54.85406764413665, -50.32982812857711, -6.234569676365133, 43.52535653925046, -20.284647818951065, -122.72911794687963, -30.02930181547257, 64.88866316909824, -29.828281979136015, 27.845266783971347, 9.541578665059246, 1.103496687474779, 7.009962407567832, -8.299879170194934, -72.54471461247661, -97.58563081684744, -33.94553553761412, 161.42330774007206, -112.95182525200485, -6.1055308568346724, 40.28710026868663, -159.2584299113319, 1.9693763855458568, -203.51123731867187, -41.75335832068283, -112.73519084767737, -9.86848498904447, -75.14768969882805, 64.9005559888798, -41.26096743109789, 11.98667537860044, 89.1022150662958, -53.133135240501986, -21.790897701337713, 102.87572050846154, -103.60518017643587, -2.753002690682439, -77.5059788586302, -136.78681328113666, -35.26167272819433, 0.7616669233566751, 99.3892737675306, -121.76317749732668, -221.41484542454427, -0.26256937414734516, -81.64046493632515, 47.835445195899766, 41.62225202827415, -159.27689309555132, 8.414915969460758, -94.96493654962522, -101.89030278114168, -225.75780180988139, 42.3879814213417, -221.12051631037914, -194.2370444672595, -47.443484467917465, -68.94976936260595, -71.53127552961595, -175.21866179031935, -2.377011043507998, 7.336224962261236, 57.5840314172886, 148.94400313475802, -286.27355747273646, -38.05288701360526, -15.675153673344045, -157.06325915064687, 20.451311784900852, -34.19514158105644, -163.71926844518902, 179.13622751357744, -193.68286217716528, -5.466795255903271, 18.11348646225638, 73.35067178507347, -116.27200227841195, 81.3532898949211, -15.069998875773695, -1.5790888906085807, -103.01419787536915, 39.20269946596015, -70.07117731476804, -109.82064133551206, -6.986631127929058, -36.128808808176835, 15.187313791671755, -14.673585565722401, -251.67950712492743, 6.628822658497688, -90.79739622560763, -223.17849208443, -63.253333383580255, -19.653256456869457, -32.815082218808726, 25.002451968907792, -219.83803663194715], "policy_predator_policy_reward": [5.826870261683667, 69.24665936669969, 324.2059226722713, 187.82411487972215, 153.05478211067583, 113.01714267189817, 17.61674468795218, 70.83651010327776, 56.871368154986286, 191.90703446277513, 141.68851820524378, 0.0, 91.80740741555158, 0.0, 54.17335758922649, 131.5922426112305, 1.0515024123846184, 119.05980597895365, 36.62393073860571, 126.16249015041168, 294.04458931930264, 58.43138602720072, 27.098306487098423, 43.366658498089144, 101.5982771707111, 77.69808380843789, 92.33601550180148, 69.17740583328944, 11.711242094735995, 97.91032777106007, 159.598841430636, 144.42881435000547, 256.62014258831397, 83.17326937041157, 64.7437860571049, 182.14132692717635, 121.33488994630724, 3.428971835429686, 17.92887165747148, 61.97318819646065, 71.37501564844887, 195.79699114833366, 50.574776505310986, 49.41217620680031, 95.99190856070484, 133.02817899556257, 118.64992189155714, 44.429110259031575, 173.65858800042827, 294.7987946549283, 219.5255437438939, 58.84984999166302, 153.020176017792, 148.6350451107507, 84.92152900727922, 86.59987230581754, 35.917401426461, 256.72903135113984, 310.86582010807547, 62.23254304989086, 95.58973110505788, 76.50819038770996, 122.80345328028605, 155.79070810226966, 62.740528734875355, 50.312344307454744, 388.3350217575325, 13.51400281733393, 276.4934910271924, 282.6228917498557, 228.37632836739596, 14.384633174866076, 36.51525084053167, 377.03702896531087, 55.843560999739694, 94.38008995249868, 186.75715567238382, 3.338471062991101, 341.8826036480012, 4.298675114714987, 61.56155472910194, 75.84484689398705, 39.31993402285901, 36.68605729351662, 9.025998199295913, 32.16223211325439, 17.067987561023646, 78.50917759223691, 86.89305015310855, 85.34873130728765, 32.98846306649877, 46.31927657317061, 3.2969657078063443, 120.15435256341586, 51.96603493554656, 113.08180586595923, 51.82953263144456, 147.2709014897984, 28.814437033388117, 169.02459312393165, 122.3689401027523, 69.27638990552909, 2.934690635903009, 71.85406764413669, 69.17481916505344, 16.220654559082863, 82.67464346074956, 54.88464781895127, 149.0452344703959, 85.05170701639402, 61.64654055235777, 6.308513636455049, 122.72811266075166, 9.76569171381375, 28.196503312525255, 11.990037592432142, 39.59465245581429, 93.77925190682629, 173.417858483239, 6.14133330985798, 15.762281811455798, 134.36623570047647, 76.06028203580479, 74.22850676175635, 34.695476680536935, 159.6621907988072, 167.2233660646181, 158.99304802466287, 125.23519084767717, 31.268484989044566, 88.54768969882797, 57.09944401112018, 170.03924007813922, 8.135051974358213, 21.451638560862875, 76.27928161334323, 145.09089770133772, 0.7242794915378635, 119.58478321201947, 55.07339965509877, 101.30347201003724, 267.44746563530987, 25.72851731642294, 50.2482358311191, 10.105741511511418, 193.0090328936931, 242.16798791533478, 39.648464187783205, 159.3499139561802, 28.118359652455005, 62.6282279289202, 164.83895649669932, 73.18508403053936, 110.16493654962441, 168.40666761692708, 267.8603886072499, 213.90796331236706, 124.17924132120368, 231.43704446725934, 63.34348446791769, 164.82322943616253, 100.95781545605833, 192.6461275375021, 19.887349329554755, 38.363775037738804, 35.81596858271153, 113.3458349053624, 230.7853915479533, 54.85288701360539, 39.375153673344265, 203.76325915064663, 1.2486882150991712, 111.99514158105654, 174.21926844518845, 10.863772486422565, 246.3828621771652, 23.366795255903288, 1.686513537743613, 3.0493282149260565, 143.97200227841205, 11.169618052507685, 151.88844071902219, 78.45110531031017, 178.76726219687225, 5.491533832319006, 183.23617029079, 53.44679168121165, 100.62718867369004, 51.62880880817706, 4.512686208328209, 171.62334218999183, 202.77443414774723, 128.4407517753692, 43.32782179174049, 246.32318803637418, 132.52041148399576, 85.60806980806116, 98.80891037849513, 185.52092658311363, 103.72089663179854]}, "sampler_perf": {"mean_raw_obs_processing_ms": 24.612889016885457, "mean_inference_ms": 21.186329230406663, "mean_action_processing_ms": 5.908154806035579, "mean_env_wait_ms": 37.33530745612723, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.09543001651763916, "StateBufferConnector_ms": 0.03673684597015381, "ViewRequirementAgentConnector_ms": 1.255206823348999}, "num_episodes": 0, "episode_return_max": 286.6692231913454, "episode_return_min": -53.94695511723343, "episode_return_mean": 102.60472273081903, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 149312, "num_agent_steps_trained": 149312, "num_env_steps_sampled": 37328, "num_env_steps_trained": 37328, "num_env_steps_sampled_this_iter": 0, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 0.0, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 37328, "num_env_steps_sampled_lifetime": 37328, "num_agent_steps_sampled_lifetime": 149312, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 149312, "timers": {"training_iteration_time_ms": 61666.382, "restore_workers_time_ms": 27.782, "training_step_time_ms": 61598.691, "sample_time_ms": 61573.358, "learn_time_ms": 311236.026, "learn_throughput": 59.967, "synch_weights_time_ms": 43.334}, "counters": {"num_env_steps_sampled": 37328, "num_env_steps_trained": 37328, "num_agent_steps_sampled": 149312, "num_agent_steps_trained": 149312}, "done": false, "training_iteration": 43, "trial_id": "d7bca_00000", "date": "2024-08-20_12-40-41", "timestamp": 1724137841, "time_this_iter_s": 122.93126010894775, "time_total_s": 6414.564928531647, "pid": 36059, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 16000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x32cf5c700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 6414.564928531647, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 96.19356725146199, "ram_util_percent": 83.55029239766083}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {}, "num_env_steps_sampled": 37328, "num_env_steps_trained": 37328, "num_agent_steps_sampled": 149312, "num_agent_steps_trained": 149312}, "env_runners": {"episode_reward_max": 286.6692231913454, "episode_reward_min": -53.94695511723343, "episode_reward_mean": 102.60472273081903, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -382.5350217575324, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 179.13622751357744, "predator_policy": 388.3350217575325}, "policy_reward_mean": {"prey_policy": -50.61742331228365, "predator_policy": 101.91978467769317}, "custom_metrics": {}, "hist_stats": {"episode_reward": [35.10000000000023, -2.2956613079459616, 52.30000000000035, 93.99999999999946, 41.27668545957155, 138.35998813581944, 47.000000000000355, 189.59999999999982, 46.100000000000314, 122.59999999999911, 172.99184762314727, 183.89999999999952, 165.26660970450598, 63.400000000000325, 224.23591029611316, 118.26513246444676, 57.049342065984625, 56.287512516221504, 91.49999999999856, 77.70000000000017, 286.6692231913454, 34.20000000000022, 135.4999999999999, 189.7622134181783, 204.95900501687956, 41.46117592104707, 160.52089757879483, 41.90000000000027, 159.99999999999952, 56.25035590474681, 189.40904152072758, 32.4000000000002, 135.49999999999923, 137.09999999999957, -53.94695511723343, 170.90494465410117, 56.10000000000025, 60.20000000000013, 34.75612756781972, 43.60000000000028, 40.265044310772325, 47.1298862953699, 48.40000000000023, 36.202116310375594, 74.49999999999962, 153.19999999999987, 40.1000000000002, 131.19999999999982, 52.570622032848895, 56.000000000000156, 129.1999999999993, 86.20000000000002, 28.831075919194078, 160.79999999999959, 81.33852172443821, 103.01543537877356, 169.88064982359512, 48.30000000000023, 52.529310579969625, 48.028025438635616, 198.59999999999948, 184.470358209413, 37.06861395355878, 80.95181844992561, 33.900000000000134, 135.39999999999944, 148.89999999999955, 133.69999999999916, 226.89999999999938, 68.3000000000002, 154.45814550558052, 41.47674734270453, 180.74087067540847, 60.139037304427255, 153.66325386820998, 109.81254335834268, 96.80000000000011, 108.61895163315396, 159.3546697445331, 53.10000000000013, 125.29999999999959, 34.93780403323022, 139.0999999999999, 206.80167211533725, 40.50000000000029, 68.40000000000009, 88.29999999999927, 242.69999999999993, 37.700000000000266, 104.09999999999903, 229.34134979067687, 152.6250807412044, 157.8592262743011, 37.26670789146122, 35.20000000000023, 108.04468364708873, 87.5999999999994, 92.41177405235972, 131.94864151087714, 94.40623855187317], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [13.573129738316304, -53.54665936669982, -254.04609845621002, -260.27960040372835, -140.65478211067654, -73.1171426718985, 39.583255312047925, -34.03651010327775, -114.83317908671795, -92.66853807147267, -96.4272326280199, 93.09870255859556, -64.80740741555226, 20.000000000000014, 20.626642410773584, -16.792242611230414, 18.848497587615384, -92.85980597895414, 69.17606926139403, -109.36249015041209, -285.2321358475945, 105.74800812423979, 132.7888944272447, -19.35385941243218, -25.356623210719427, 11.326871936077456, -78.03601550180139, -20.07740583328924, 28.904313331271958, 85.71002709904536, -84.17058524148602, -101.59193807470932, -247.8691803256373, -34.87488956710395, -49.40531904969436, -141.19228141836533, -107.134889946308, 73.87102816456981, 4.171128342528487, -6.373188196460497, 72.0443042732162, -52.54708787865346, -32.67477650531073, -33.11217620680012, 17.408091439294907, -110.92817899556306, 80.28766474857159, -53.604483480981195, 64.90005398718623, -328.3984316256627, -221.37365036394135, -15.540567450569034, -217.97172194166885, 76.83739839192134, -62.4215290072797, -67.19987230581766, 82.82590198976501, -215.4723347673664, -63.01766150909464, -253.83034574412602, -72.05610867549865, 89.36722870345912, -103.9034532802869, -142.29070810227037, 0.5594712651248201, 21.887655692545323, -382.5350217575324, 117.78599718266575, -341.68754507993606, -271.3757928143444, 42.05974767402415, -113.91576456218526, 10.584749159468316, -368.0370289653096, -96.60173288891873, 6.578081936680414, -116.41208622158636, -38.927412945968925, -335.88260364800084, 33.30132488528524, -27.102952922490367, -70.03840438982733, -11.808869660467748, -17.067235360537826, 10.174001800704053, -2.962232113254194, -5.251613856427011, -54.123434986458186, -77.75098136410048, -19.99080009629646, 33.88040540161318, 40.0118549587175, 18.203034292193653, -101.55435256341609, 84.66934503983893, -118.51718584134521, -111.25275039532056, -35.27706169307365, 12.962713255211035, -154.80174341253127, -108.368940102753, 45.92361009447094, 66.26530936409696, -54.85406764413665, -50.32982812857711, -6.234569676365133, 43.52535653925046, -20.284647818951065, -122.72911794687963, -30.02930181547257, 64.88866316909824, -29.828281979136015, 27.845266783971347, 9.541578665059246, 1.103496687474779, 7.009962407567832, -8.299879170194934, -72.54471461247661, -97.58563081684744, -33.94553553761412, 161.42330774007206, -112.95182525200485, -6.1055308568346724, 40.28710026868663, -159.2584299113319, 1.9693763855458568, -203.51123731867187, -41.75335832068283, -112.73519084767737, -9.86848498904447, -75.14768969882805, 64.9005559888798, -41.26096743109789, 11.98667537860044, 89.1022150662958, -53.133135240501986, -21.790897701337713, 102.87572050846154, -103.60518017643587, -2.753002690682439, -77.5059788586302, -136.78681328113666, -35.26167272819433, 0.7616669233566751, 99.3892737675306, -121.76317749732668, -221.41484542454427, -0.26256937414734516, -81.64046493632515, 47.835445195899766, 41.62225202827415, -159.27689309555132, 8.414915969460758, -94.96493654962522, -101.89030278114168, -225.75780180988139, 42.3879814213417, -221.12051631037914, -194.2370444672595, -47.443484467917465, -68.94976936260595, -71.53127552961595, -175.21866179031935, -2.377011043507998, 7.336224962261236, 57.5840314172886, 148.94400313475802, -286.27355747273646, -38.05288701360526, -15.675153673344045, -157.06325915064687, 20.451311784900852, -34.19514158105644, -163.71926844518902, 179.13622751357744, -193.68286217716528, -5.466795255903271, 18.11348646225638, 73.35067178507347, -116.27200227841195, 81.3532898949211, -15.069998875773695, -1.5790888906085807, -103.01419787536915, 39.20269946596015, -70.07117731476804, -109.82064133551206, -6.986631127929058, -36.128808808176835, 15.187313791671755, -14.673585565722401, -251.67950712492743, 6.628822658497688, -90.79739622560763, -223.17849208443, -63.253333383580255, -19.653256456869457, -32.815082218808726, 25.002451968907792, -219.83803663194715], "policy_predator_policy_reward": [5.826870261683667, 69.24665936669969, 324.2059226722713, 187.82411487972215, 153.05478211067583, 113.01714267189817, 17.61674468795218, 70.83651010327776, 56.871368154986286, 191.90703446277513, 141.68851820524378, 0.0, 91.80740741555158, 0.0, 54.17335758922649, 131.5922426112305, 1.0515024123846184, 119.05980597895365, 36.62393073860571, 126.16249015041168, 294.04458931930264, 58.43138602720072, 27.098306487098423, 43.366658498089144, 101.5982771707111, 77.69808380843789, 92.33601550180148, 69.17740583328944, 11.711242094735995, 97.91032777106007, 159.598841430636, 144.42881435000547, 256.62014258831397, 83.17326937041157, 64.7437860571049, 182.14132692717635, 121.33488994630724, 3.428971835429686, 17.92887165747148, 61.97318819646065, 71.37501564844887, 195.79699114833366, 50.574776505310986, 49.41217620680031, 95.99190856070484, 133.02817899556257, 118.64992189155714, 44.429110259031575, 173.65858800042827, 294.7987946549283, 219.5255437438939, 58.84984999166302, 153.020176017792, 148.6350451107507, 84.92152900727922, 86.59987230581754, 35.917401426461, 256.72903135113984, 310.86582010807547, 62.23254304989086, 95.58973110505788, 76.50819038770996, 122.80345328028605, 155.79070810226966, 62.740528734875355, 50.312344307454744, 388.3350217575325, 13.51400281733393, 276.4934910271924, 282.6228917498557, 228.37632836739596, 14.384633174866076, 36.51525084053167, 377.03702896531087, 55.843560999739694, 94.38008995249868, 186.75715567238382, 3.338471062991101, 341.8826036480012, 4.298675114714987, 61.56155472910194, 75.84484689398705, 39.31993402285901, 36.68605729351662, 9.025998199295913, 32.16223211325439, 17.067987561023646, 78.50917759223691, 86.89305015310855, 85.34873130728765, 32.98846306649877, 46.31927657317061, 3.2969657078063443, 120.15435256341586, 51.96603493554656, 113.08180586595923, 51.82953263144456, 147.2709014897984, 28.814437033388117, 169.02459312393165, 122.3689401027523, 69.27638990552909, 2.934690635903009, 71.85406764413669, 69.17481916505344, 16.220654559082863, 82.67464346074956, 54.88464781895127, 149.0452344703959, 85.05170701639402, 61.64654055235777, 6.308513636455049, 122.72811266075166, 9.76569171381375, 28.196503312525255, 11.990037592432142, 39.59465245581429, 93.77925190682629, 173.417858483239, 6.14133330985798, 15.762281811455798, 134.36623570047647, 76.06028203580479, 74.22850676175635, 34.695476680536935, 159.6621907988072, 167.2233660646181, 158.99304802466287, 125.23519084767717, 31.268484989044566, 88.54768969882797, 57.09944401112018, 170.03924007813922, 8.135051974358213, 21.451638560862875, 76.27928161334323, 145.09089770133772, 0.7242794915378635, 119.58478321201947, 55.07339965509877, 101.30347201003724, 267.44746563530987, 25.72851731642294, 50.2482358311191, 10.105741511511418, 193.0090328936931, 242.16798791533478, 39.648464187783205, 159.3499139561802, 28.118359652455005, 62.6282279289202, 164.83895649669932, 73.18508403053936, 110.16493654962441, 168.40666761692708, 267.8603886072499, 213.90796331236706, 124.17924132120368, 231.43704446725934, 63.34348446791769, 164.82322943616253, 100.95781545605833, 192.6461275375021, 19.887349329554755, 38.363775037738804, 35.81596858271153, 113.3458349053624, 230.7853915479533, 54.85288701360539, 39.375153673344265, 203.76325915064663, 1.2486882150991712, 111.99514158105654, 174.21926844518845, 10.863772486422565, 246.3828621771652, 23.366795255903288, 1.686513537743613, 3.0493282149260565, 143.97200227841205, 11.169618052507685, 151.88844071902219, 78.45110531031017, 178.76726219687225, 5.491533832319006, 183.23617029079, 53.44679168121165, 100.62718867369004, 51.62880880817706, 4.512686208328209, 171.62334218999183, 202.77443414774723, 128.4407517753692, 43.32782179174049, 246.32318803637418, 132.52041148399576, 85.60806980806116, 98.80891037849513, 185.52092658311363, 103.72089663179854]}, "sampler_perf": {"mean_raw_obs_processing_ms": 24.612889016885457, "mean_inference_ms": 21.186329230406663, "mean_action_processing_ms": 5.908154806035579, "mean_env_wait_ms": 37.33530745612723, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.09543001651763916, "StateBufferConnector_ms": 0.03673684597015381, "ViewRequirementAgentConnector_ms": 1.255206823348999}, "num_episodes": 0, "episode_return_max": 286.6692231913454, "episode_return_min": -53.94695511723343, "episode_return_mean": 102.60472273081903, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 149312, "num_agent_steps_trained": 149312, "num_env_steps_sampled": 37328, "num_env_steps_trained": 37328, "num_env_steps_sampled_this_iter": 0, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 0.0, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 37328, "num_env_steps_sampled_lifetime": 37328, "num_agent_steps_sampled_lifetime": 149312, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 149312, "timers": {"training_iteration_time_ms": 61595.561, "restore_workers_time_ms": 29.045, "training_step_time_ms": 61526.272, "sample_time_ms": 61499.377, "learn_time_ms": 311236.026, "learn_throughput": 59.967, "synch_weights_time_ms": 43.334}, "counters": {"num_env_steps_sampled": 37328, "num_env_steps_trained": 37328, "num_agent_steps_sampled": 149312, "num_agent_steps_trained": 149312}, "done": false, "training_iteration": 44, "trial_id": "d7bca_00000", "date": "2024-08-20_12-42-48", "timestamp": 1724137968, "time_this_iter_s": 123.46367907524109, "time_total_s": 6538.028607606888, "pid": 36059, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 16000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x32cf6d310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 6538.028607606888, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 96.3190751445087, "ram_util_percent": 83.5676300578035}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {}, "num_env_steps_sampled": 37328, "num_env_steps_trained": 37328, "num_agent_steps_sampled": 149312, "num_agent_steps_trained": 149312}, "env_runners": {"episode_reward_max": 286.6692231913454, "episode_reward_min": -53.94695511723343, "episode_reward_mean": 102.60472273081903, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -382.5350217575324, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 179.13622751357744, "predator_policy": 388.3350217575325}, "policy_reward_mean": {"prey_policy": -50.61742331228365, "predator_policy": 101.91978467769317}, "custom_metrics": {}, "hist_stats": {"episode_reward": [35.10000000000023, -2.2956613079459616, 52.30000000000035, 93.99999999999946, 41.27668545957155, 138.35998813581944, 47.000000000000355, 189.59999999999982, 46.100000000000314, 122.59999999999911, 172.99184762314727, 183.89999999999952, 165.26660970450598, 63.400000000000325, 224.23591029611316, 118.26513246444676, 57.049342065984625, 56.287512516221504, 91.49999999999856, 77.70000000000017, 286.6692231913454, 34.20000000000022, 135.4999999999999, 189.7622134181783, 204.95900501687956, 41.46117592104707, 160.52089757879483, 41.90000000000027, 159.99999999999952, 56.25035590474681, 189.40904152072758, 32.4000000000002, 135.49999999999923, 137.09999999999957, -53.94695511723343, 170.90494465410117, 56.10000000000025, 60.20000000000013, 34.75612756781972, 43.60000000000028, 40.265044310772325, 47.1298862953699, 48.40000000000023, 36.202116310375594, 74.49999999999962, 153.19999999999987, 40.1000000000002, 131.19999999999982, 52.570622032848895, 56.000000000000156, 129.1999999999993, 86.20000000000002, 28.831075919194078, 160.79999999999959, 81.33852172443821, 103.01543537877356, 169.88064982359512, 48.30000000000023, 52.529310579969625, 48.028025438635616, 198.59999999999948, 184.470358209413, 37.06861395355878, 80.95181844992561, 33.900000000000134, 135.39999999999944, 148.89999999999955, 133.69999999999916, 226.89999999999938, 68.3000000000002, 154.45814550558052, 41.47674734270453, 180.74087067540847, 60.139037304427255, 153.66325386820998, 109.81254335834268, 96.80000000000011, 108.61895163315396, 159.3546697445331, 53.10000000000013, 125.29999999999959, 34.93780403323022, 139.0999999999999, 206.80167211533725, 40.50000000000029, 68.40000000000009, 88.29999999999927, 242.69999999999993, 37.700000000000266, 104.09999999999903, 229.34134979067687, 152.6250807412044, 157.8592262743011, 37.26670789146122, 35.20000000000023, 108.04468364708873, 87.5999999999994, 92.41177405235972, 131.94864151087714, 94.40623855187317], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [13.573129738316304, -53.54665936669982, -254.04609845621002, -260.27960040372835, -140.65478211067654, -73.1171426718985, 39.583255312047925, -34.03651010327775, -114.83317908671795, -92.66853807147267, -96.4272326280199, 93.09870255859556, -64.80740741555226, 20.000000000000014, 20.626642410773584, -16.792242611230414, 18.848497587615384, -92.85980597895414, 69.17606926139403, -109.36249015041209, -285.2321358475945, 105.74800812423979, 132.7888944272447, -19.35385941243218, -25.356623210719427, 11.326871936077456, -78.03601550180139, -20.07740583328924, 28.904313331271958, 85.71002709904536, -84.17058524148602, -101.59193807470932, -247.8691803256373, -34.87488956710395, -49.40531904969436, -141.19228141836533, -107.134889946308, 73.87102816456981, 4.171128342528487, -6.373188196460497, 72.0443042732162, -52.54708787865346, -32.67477650531073, -33.11217620680012, 17.408091439294907, -110.92817899556306, 80.28766474857159, -53.604483480981195, 64.90005398718623, -328.3984316256627, -221.37365036394135, -15.540567450569034, -217.97172194166885, 76.83739839192134, -62.4215290072797, -67.19987230581766, 82.82590198976501, -215.4723347673664, -63.01766150909464, -253.83034574412602, -72.05610867549865, 89.36722870345912, -103.9034532802869, -142.29070810227037, 0.5594712651248201, 21.887655692545323, -382.5350217575324, 117.78599718266575, -341.68754507993606, -271.3757928143444, 42.05974767402415, -113.91576456218526, 10.584749159468316, -368.0370289653096, -96.60173288891873, 6.578081936680414, -116.41208622158636, -38.927412945968925, -335.88260364800084, 33.30132488528524, -27.102952922490367, -70.03840438982733, -11.808869660467748, -17.067235360537826, 10.174001800704053, -2.962232113254194, -5.251613856427011, -54.123434986458186, -77.75098136410048, -19.99080009629646, 33.88040540161318, 40.0118549587175, 18.203034292193653, -101.55435256341609, 84.66934503983893, -118.51718584134521, -111.25275039532056, -35.27706169307365, 12.962713255211035, -154.80174341253127, -108.368940102753, 45.92361009447094, 66.26530936409696, -54.85406764413665, -50.32982812857711, -6.234569676365133, 43.52535653925046, -20.284647818951065, -122.72911794687963, -30.02930181547257, 64.88866316909824, -29.828281979136015, 27.845266783971347, 9.541578665059246, 1.103496687474779, 7.009962407567832, -8.299879170194934, -72.54471461247661, -97.58563081684744, -33.94553553761412, 161.42330774007206, -112.95182525200485, -6.1055308568346724, 40.28710026868663, -159.2584299113319, 1.9693763855458568, -203.51123731867187, -41.75335832068283, -112.73519084767737, -9.86848498904447, -75.14768969882805, 64.9005559888798, -41.26096743109789, 11.98667537860044, 89.1022150662958, -53.133135240501986, -21.790897701337713, 102.87572050846154, -103.60518017643587, -2.753002690682439, -77.5059788586302, -136.78681328113666, -35.26167272819433, 0.7616669233566751, 99.3892737675306, -121.76317749732668, -221.41484542454427, -0.26256937414734516, -81.64046493632515, 47.835445195899766, 41.62225202827415, -159.27689309555132, 8.414915969460758, -94.96493654962522, -101.89030278114168, -225.75780180988139, 42.3879814213417, -221.12051631037914, -194.2370444672595, -47.443484467917465, -68.94976936260595, -71.53127552961595, -175.21866179031935, -2.377011043507998, 7.336224962261236, 57.5840314172886, 148.94400313475802, -286.27355747273646, -38.05288701360526, -15.675153673344045, -157.06325915064687, 20.451311784900852, -34.19514158105644, -163.71926844518902, 179.13622751357744, -193.68286217716528, -5.466795255903271, 18.11348646225638, 73.35067178507347, -116.27200227841195, 81.3532898949211, -15.069998875773695, -1.5790888906085807, -103.01419787536915, 39.20269946596015, -70.07117731476804, -109.82064133551206, -6.986631127929058, -36.128808808176835, 15.187313791671755, -14.673585565722401, -251.67950712492743, 6.628822658497688, -90.79739622560763, -223.17849208443, -63.253333383580255, -19.653256456869457, -32.815082218808726, 25.002451968907792, -219.83803663194715], "policy_predator_policy_reward": [5.826870261683667, 69.24665936669969, 324.2059226722713, 187.82411487972215, 153.05478211067583, 113.01714267189817, 17.61674468795218, 70.83651010327776, 56.871368154986286, 191.90703446277513, 141.68851820524378, 0.0, 91.80740741555158, 0.0, 54.17335758922649, 131.5922426112305, 1.0515024123846184, 119.05980597895365, 36.62393073860571, 126.16249015041168, 294.04458931930264, 58.43138602720072, 27.098306487098423, 43.366658498089144, 101.5982771707111, 77.69808380843789, 92.33601550180148, 69.17740583328944, 11.711242094735995, 97.91032777106007, 159.598841430636, 144.42881435000547, 256.62014258831397, 83.17326937041157, 64.7437860571049, 182.14132692717635, 121.33488994630724, 3.428971835429686, 17.92887165747148, 61.97318819646065, 71.37501564844887, 195.79699114833366, 50.574776505310986, 49.41217620680031, 95.99190856070484, 133.02817899556257, 118.64992189155714, 44.429110259031575, 173.65858800042827, 294.7987946549283, 219.5255437438939, 58.84984999166302, 153.020176017792, 148.6350451107507, 84.92152900727922, 86.59987230581754, 35.917401426461, 256.72903135113984, 310.86582010807547, 62.23254304989086, 95.58973110505788, 76.50819038770996, 122.80345328028605, 155.79070810226966, 62.740528734875355, 50.312344307454744, 388.3350217575325, 13.51400281733393, 276.4934910271924, 282.6228917498557, 228.37632836739596, 14.384633174866076, 36.51525084053167, 377.03702896531087, 55.843560999739694, 94.38008995249868, 186.75715567238382, 3.338471062991101, 341.8826036480012, 4.298675114714987, 61.56155472910194, 75.84484689398705, 39.31993402285901, 36.68605729351662, 9.025998199295913, 32.16223211325439, 17.067987561023646, 78.50917759223691, 86.89305015310855, 85.34873130728765, 32.98846306649877, 46.31927657317061, 3.2969657078063443, 120.15435256341586, 51.96603493554656, 113.08180586595923, 51.82953263144456, 147.2709014897984, 28.814437033388117, 169.02459312393165, 122.3689401027523, 69.27638990552909, 2.934690635903009, 71.85406764413669, 69.17481916505344, 16.220654559082863, 82.67464346074956, 54.88464781895127, 149.0452344703959, 85.05170701639402, 61.64654055235777, 6.308513636455049, 122.72811266075166, 9.76569171381375, 28.196503312525255, 11.990037592432142, 39.59465245581429, 93.77925190682629, 173.417858483239, 6.14133330985798, 15.762281811455798, 134.36623570047647, 76.06028203580479, 74.22850676175635, 34.695476680536935, 159.6621907988072, 167.2233660646181, 158.99304802466287, 125.23519084767717, 31.268484989044566, 88.54768969882797, 57.09944401112018, 170.03924007813922, 8.135051974358213, 21.451638560862875, 76.27928161334323, 145.09089770133772, 0.7242794915378635, 119.58478321201947, 55.07339965509877, 101.30347201003724, 267.44746563530987, 25.72851731642294, 50.2482358311191, 10.105741511511418, 193.0090328936931, 242.16798791533478, 39.648464187783205, 159.3499139561802, 28.118359652455005, 62.6282279289202, 164.83895649669932, 73.18508403053936, 110.16493654962441, 168.40666761692708, 267.8603886072499, 213.90796331236706, 124.17924132120368, 231.43704446725934, 63.34348446791769, 164.82322943616253, 100.95781545605833, 192.6461275375021, 19.887349329554755, 38.363775037738804, 35.81596858271153, 113.3458349053624, 230.7853915479533, 54.85288701360539, 39.375153673344265, 203.76325915064663, 1.2486882150991712, 111.99514158105654, 174.21926844518845, 10.863772486422565, 246.3828621771652, 23.366795255903288, 1.686513537743613, 3.0493282149260565, 143.97200227841205, 11.169618052507685, 151.88844071902219, 78.45110531031017, 178.76726219687225, 5.491533832319006, 183.23617029079, 53.44679168121165, 100.62718867369004, 51.62880880817706, 4.512686208328209, 171.62334218999183, 202.77443414774723, 128.4407517753692, 43.32782179174049, 246.32318803637418, 132.52041148399576, 85.60806980806116, 98.80891037849513, 185.52092658311363, 103.72089663179854]}, "sampler_perf": {"mean_raw_obs_processing_ms": 24.612889016885457, "mean_inference_ms": 21.186329230406663, "mean_action_processing_ms": 5.908154806035579, "mean_env_wait_ms": 37.33530745612723, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.09543001651763916, "StateBufferConnector_ms": 0.03673684597015381, "ViewRequirementAgentConnector_ms": 1.255206823348999}, "num_episodes": 0, "episode_return_max": 286.6692231913454, "episode_return_min": -53.94695511723343, "episode_return_mean": 102.60472273081903, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 149312, "num_agent_steps_trained": 149312, "num_env_steps_sampled": 37328, "num_env_steps_trained": 37328, "num_env_steps_sampled_this_iter": 0, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 0.0, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 37328, "num_env_steps_sampled_lifetime": 37328, "num_agent_steps_sampled_lifetime": 149312, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 149312, "timers": {"training_iteration_time_ms": 61422.914, "restore_workers_time_ms": 28.909, "training_step_time_ms": 61363.299, "sample_time_ms": 61346.04, "learn_time_ms": 311236.026, "learn_throughput": 59.967, "synch_weights_time_ms": 43.334}, "counters": {"num_env_steps_sampled": 37328, "num_env_steps_trained": 37328, "num_agent_steps_sampled": 149312, "num_agent_steps_trained": 149312}, "done": false, "training_iteration": 45, "trial_id": "d7bca_00000", "date": "2024-08-20_12-44-56", "timestamp": 1724138096, "time_this_iter_s": 123.25759315490723, "time_total_s": 6661.286200761795, "pid": 36059, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 16000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x32cf6d160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 6661.286200761795, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 95.90697674418605, "ram_util_percent": 83.57848837209302}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {}, "num_env_steps_sampled": 37328, "num_env_steps_trained": 37328, "num_agent_steps_sampled": 149312, "num_agent_steps_trained": 149312}, "env_runners": {"episode_reward_max": 286.6692231913454, "episode_reward_min": -53.94695511723343, "episode_reward_mean": 102.60472273081903, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -382.5350217575324, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 179.13622751357744, "predator_policy": 388.3350217575325}, "policy_reward_mean": {"prey_policy": -50.61742331228365, "predator_policy": 101.91978467769317}, "custom_metrics": {}, "hist_stats": {"episode_reward": [35.10000000000023, -2.2956613079459616, 52.30000000000035, 93.99999999999946, 41.27668545957155, 138.35998813581944, 47.000000000000355, 189.59999999999982, 46.100000000000314, 122.59999999999911, 172.99184762314727, 183.89999999999952, 165.26660970450598, 63.400000000000325, 224.23591029611316, 118.26513246444676, 57.049342065984625, 56.287512516221504, 91.49999999999856, 77.70000000000017, 286.6692231913454, 34.20000000000022, 135.4999999999999, 189.7622134181783, 204.95900501687956, 41.46117592104707, 160.52089757879483, 41.90000000000027, 159.99999999999952, 56.25035590474681, 189.40904152072758, 32.4000000000002, 135.49999999999923, 137.09999999999957, -53.94695511723343, 170.90494465410117, 56.10000000000025, 60.20000000000013, 34.75612756781972, 43.60000000000028, 40.265044310772325, 47.1298862953699, 48.40000000000023, 36.202116310375594, 74.49999999999962, 153.19999999999987, 40.1000000000002, 131.19999999999982, 52.570622032848895, 56.000000000000156, 129.1999999999993, 86.20000000000002, 28.831075919194078, 160.79999999999959, 81.33852172443821, 103.01543537877356, 169.88064982359512, 48.30000000000023, 52.529310579969625, 48.028025438635616, 198.59999999999948, 184.470358209413, 37.06861395355878, 80.95181844992561, 33.900000000000134, 135.39999999999944, 148.89999999999955, 133.69999999999916, 226.89999999999938, 68.3000000000002, 154.45814550558052, 41.47674734270453, 180.74087067540847, 60.139037304427255, 153.66325386820998, 109.81254335834268, 96.80000000000011, 108.61895163315396, 159.3546697445331, 53.10000000000013, 125.29999999999959, 34.93780403323022, 139.0999999999999, 206.80167211533725, 40.50000000000029, 68.40000000000009, 88.29999999999927, 242.69999999999993, 37.700000000000266, 104.09999999999903, 229.34134979067687, 152.6250807412044, 157.8592262743011, 37.26670789146122, 35.20000000000023, 108.04468364708873, 87.5999999999994, 92.41177405235972, 131.94864151087714, 94.40623855187317], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [13.573129738316304, -53.54665936669982, -254.04609845621002, -260.27960040372835, -140.65478211067654, -73.1171426718985, 39.583255312047925, -34.03651010327775, -114.83317908671795, -92.66853807147267, -96.4272326280199, 93.09870255859556, -64.80740741555226, 20.000000000000014, 20.626642410773584, -16.792242611230414, 18.848497587615384, -92.85980597895414, 69.17606926139403, -109.36249015041209, -285.2321358475945, 105.74800812423979, 132.7888944272447, -19.35385941243218, -25.356623210719427, 11.326871936077456, -78.03601550180139, -20.07740583328924, 28.904313331271958, 85.71002709904536, -84.17058524148602, -101.59193807470932, -247.8691803256373, -34.87488956710395, -49.40531904969436, -141.19228141836533, -107.134889946308, 73.87102816456981, 4.171128342528487, -6.373188196460497, 72.0443042732162, -52.54708787865346, -32.67477650531073, -33.11217620680012, 17.408091439294907, -110.92817899556306, 80.28766474857159, -53.604483480981195, 64.90005398718623, -328.3984316256627, -221.37365036394135, -15.540567450569034, -217.97172194166885, 76.83739839192134, -62.4215290072797, -67.19987230581766, 82.82590198976501, -215.4723347673664, -63.01766150909464, -253.83034574412602, -72.05610867549865, 89.36722870345912, -103.9034532802869, -142.29070810227037, 0.5594712651248201, 21.887655692545323, -382.5350217575324, 117.78599718266575, -341.68754507993606, -271.3757928143444, 42.05974767402415, -113.91576456218526, 10.584749159468316, -368.0370289653096, -96.60173288891873, 6.578081936680414, -116.41208622158636, -38.927412945968925, -335.88260364800084, 33.30132488528524, -27.102952922490367, -70.03840438982733, -11.808869660467748, -17.067235360537826, 10.174001800704053, -2.962232113254194, -5.251613856427011, -54.123434986458186, -77.75098136410048, -19.99080009629646, 33.88040540161318, 40.0118549587175, 18.203034292193653, -101.55435256341609, 84.66934503983893, -118.51718584134521, -111.25275039532056, -35.27706169307365, 12.962713255211035, -154.80174341253127, -108.368940102753, 45.92361009447094, 66.26530936409696, -54.85406764413665, -50.32982812857711, -6.234569676365133, 43.52535653925046, -20.284647818951065, -122.72911794687963, -30.02930181547257, 64.88866316909824, -29.828281979136015, 27.845266783971347, 9.541578665059246, 1.103496687474779, 7.009962407567832, -8.299879170194934, -72.54471461247661, -97.58563081684744, -33.94553553761412, 161.42330774007206, -112.95182525200485, -6.1055308568346724, 40.28710026868663, -159.2584299113319, 1.9693763855458568, -203.51123731867187, -41.75335832068283, -112.73519084767737, -9.86848498904447, -75.14768969882805, 64.9005559888798, -41.26096743109789, 11.98667537860044, 89.1022150662958, -53.133135240501986, -21.790897701337713, 102.87572050846154, -103.60518017643587, -2.753002690682439, -77.5059788586302, -136.78681328113666, -35.26167272819433, 0.7616669233566751, 99.3892737675306, -121.76317749732668, -221.41484542454427, -0.26256937414734516, -81.64046493632515, 47.835445195899766, 41.62225202827415, -159.27689309555132, 8.414915969460758, -94.96493654962522, -101.89030278114168, -225.75780180988139, 42.3879814213417, -221.12051631037914, -194.2370444672595, -47.443484467917465, -68.94976936260595, -71.53127552961595, -175.21866179031935, -2.377011043507998, 7.336224962261236, 57.5840314172886, 148.94400313475802, -286.27355747273646, -38.05288701360526, -15.675153673344045, -157.06325915064687, 20.451311784900852, -34.19514158105644, -163.71926844518902, 179.13622751357744, -193.68286217716528, -5.466795255903271, 18.11348646225638, 73.35067178507347, -116.27200227841195, 81.3532898949211, -15.069998875773695, -1.5790888906085807, -103.01419787536915, 39.20269946596015, -70.07117731476804, -109.82064133551206, -6.986631127929058, -36.128808808176835, 15.187313791671755, -14.673585565722401, -251.67950712492743, 6.628822658497688, -90.79739622560763, -223.17849208443, -63.253333383580255, -19.653256456869457, -32.815082218808726, 25.002451968907792, -219.83803663194715], "policy_predator_policy_reward": [5.826870261683667, 69.24665936669969, 324.2059226722713, 187.82411487972215, 153.05478211067583, 113.01714267189817, 17.61674468795218, 70.83651010327776, 56.871368154986286, 191.90703446277513, 141.68851820524378, 0.0, 91.80740741555158, 0.0, 54.17335758922649, 131.5922426112305, 1.0515024123846184, 119.05980597895365, 36.62393073860571, 126.16249015041168, 294.04458931930264, 58.43138602720072, 27.098306487098423, 43.366658498089144, 101.5982771707111, 77.69808380843789, 92.33601550180148, 69.17740583328944, 11.711242094735995, 97.91032777106007, 159.598841430636, 144.42881435000547, 256.62014258831397, 83.17326937041157, 64.7437860571049, 182.14132692717635, 121.33488994630724, 3.428971835429686, 17.92887165747148, 61.97318819646065, 71.37501564844887, 195.79699114833366, 50.574776505310986, 49.41217620680031, 95.99190856070484, 133.02817899556257, 118.64992189155714, 44.429110259031575, 173.65858800042827, 294.7987946549283, 219.5255437438939, 58.84984999166302, 153.020176017792, 148.6350451107507, 84.92152900727922, 86.59987230581754, 35.917401426461, 256.72903135113984, 310.86582010807547, 62.23254304989086, 95.58973110505788, 76.50819038770996, 122.80345328028605, 155.79070810226966, 62.740528734875355, 50.312344307454744, 388.3350217575325, 13.51400281733393, 276.4934910271924, 282.6228917498557, 228.37632836739596, 14.384633174866076, 36.51525084053167, 377.03702896531087, 55.843560999739694, 94.38008995249868, 186.75715567238382, 3.338471062991101, 341.8826036480012, 4.298675114714987, 61.56155472910194, 75.84484689398705, 39.31993402285901, 36.68605729351662, 9.025998199295913, 32.16223211325439, 17.067987561023646, 78.50917759223691, 86.89305015310855, 85.34873130728765, 32.98846306649877, 46.31927657317061, 3.2969657078063443, 120.15435256341586, 51.96603493554656, 113.08180586595923, 51.82953263144456, 147.2709014897984, 28.814437033388117, 169.02459312393165, 122.3689401027523, 69.27638990552909, 2.934690635903009, 71.85406764413669, 69.17481916505344, 16.220654559082863, 82.67464346074956, 54.88464781895127, 149.0452344703959, 85.05170701639402, 61.64654055235777, 6.308513636455049, 122.72811266075166, 9.76569171381375, 28.196503312525255, 11.990037592432142, 39.59465245581429, 93.77925190682629, 173.417858483239, 6.14133330985798, 15.762281811455798, 134.36623570047647, 76.06028203580479, 74.22850676175635, 34.695476680536935, 159.6621907988072, 167.2233660646181, 158.99304802466287, 125.23519084767717, 31.268484989044566, 88.54768969882797, 57.09944401112018, 170.03924007813922, 8.135051974358213, 21.451638560862875, 76.27928161334323, 145.09089770133772, 0.7242794915378635, 119.58478321201947, 55.07339965509877, 101.30347201003724, 267.44746563530987, 25.72851731642294, 50.2482358311191, 10.105741511511418, 193.0090328936931, 242.16798791533478, 39.648464187783205, 159.3499139561802, 28.118359652455005, 62.6282279289202, 164.83895649669932, 73.18508403053936, 110.16493654962441, 168.40666761692708, 267.8603886072499, 213.90796331236706, 124.17924132120368, 231.43704446725934, 63.34348446791769, 164.82322943616253, 100.95781545605833, 192.6461275375021, 19.887349329554755, 38.363775037738804, 35.81596858271153, 113.3458349053624, 230.7853915479533, 54.85288701360539, 39.375153673344265, 203.76325915064663, 1.2486882150991712, 111.99514158105654, 174.21926844518845, 10.863772486422565, 246.3828621771652, 23.366795255903288, 1.686513537743613, 3.0493282149260565, 143.97200227841205, 11.169618052507685, 151.88844071902219, 78.45110531031017, 178.76726219687225, 5.491533832319006, 183.23617029079, 53.44679168121165, 100.62718867369004, 51.62880880817706, 4.512686208328209, 171.62334218999183, 202.77443414774723, 128.4407517753692, 43.32782179174049, 246.32318803637418, 132.52041148399576, 85.60806980806116, 98.80891037849513, 185.52092658311363, 103.72089663179854]}, "sampler_perf": {"mean_raw_obs_processing_ms": 24.612889016885457, "mean_inference_ms": 21.186329230406663, "mean_action_processing_ms": 5.908154806035579, "mean_env_wait_ms": 37.33530745612723, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.09543001651763916, "StateBufferConnector_ms": 0.03673684597015381, "ViewRequirementAgentConnector_ms": 1.255206823348999}, "num_episodes": 0, "episode_return_max": 286.6692231913454, "episode_return_min": -53.94695511723343, "episode_return_mean": 102.60472273081903, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 149312, "num_agent_steps_trained": 149312, "num_env_steps_sampled": 37328, "num_env_steps_trained": 37328, "num_env_steps_sampled_this_iter": 0, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 0.0, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 37328, "num_env_steps_sampled_lifetime": 37328, "num_agent_steps_sampled_lifetime": 149312, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 149312, "timers": {"training_iteration_time_ms": 61415.941, "restore_workers_time_ms": 29.378, "training_step_time_ms": 61357.676, "sample_time_ms": 61341.154, "learn_time_ms": 311236.026, "learn_throughput": 59.967, "synch_weights_time_ms": 43.334}, "counters": {"num_env_steps_sampled": 37328, "num_env_steps_trained": 37328, "num_agent_steps_sampled": 149312, "num_agent_steps_trained": 149312}, "done": false, "training_iteration": 46, "trial_id": "d7bca_00000", "date": "2024-08-20_12-47-01", "timestamp": 1724138221, "time_this_iter_s": 122.93853712081909, "time_total_s": 6784.224737882614, "pid": 36059, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 16000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x32cf5c280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 6784.224737882614, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 95.6364705882353, "ram_util_percent": 83.56882352941177}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {}, "num_env_steps_sampled": 37328, "num_env_steps_trained": 37328, "num_agent_steps_sampled": 149312, "num_agent_steps_trained": 149312}, "env_runners": {"episode_reward_max": 286.6692231913454, "episode_reward_min": -53.94695511723343, "episode_reward_mean": 102.60472273081903, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -382.5350217575324, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 179.13622751357744, "predator_policy": 388.3350217575325}, "policy_reward_mean": {"prey_policy": -50.61742331228365, "predator_policy": 101.91978467769317}, "custom_metrics": {}, "hist_stats": {"episode_reward": [35.10000000000023, -2.2956613079459616, 52.30000000000035, 93.99999999999946, 41.27668545957155, 138.35998813581944, 47.000000000000355, 189.59999999999982, 46.100000000000314, 122.59999999999911, 172.99184762314727, 183.89999999999952, 165.26660970450598, 63.400000000000325, 224.23591029611316, 118.26513246444676, 57.049342065984625, 56.287512516221504, 91.49999999999856, 77.70000000000017, 286.6692231913454, 34.20000000000022, 135.4999999999999, 189.7622134181783, 204.95900501687956, 41.46117592104707, 160.52089757879483, 41.90000000000027, 159.99999999999952, 56.25035590474681, 189.40904152072758, 32.4000000000002, 135.49999999999923, 137.09999999999957, -53.94695511723343, 170.90494465410117, 56.10000000000025, 60.20000000000013, 34.75612756781972, 43.60000000000028, 40.265044310772325, 47.1298862953699, 48.40000000000023, 36.202116310375594, 74.49999999999962, 153.19999999999987, 40.1000000000002, 131.19999999999982, 52.570622032848895, 56.000000000000156, 129.1999999999993, 86.20000000000002, 28.831075919194078, 160.79999999999959, 81.33852172443821, 103.01543537877356, 169.88064982359512, 48.30000000000023, 52.529310579969625, 48.028025438635616, 198.59999999999948, 184.470358209413, 37.06861395355878, 80.95181844992561, 33.900000000000134, 135.39999999999944, 148.89999999999955, 133.69999999999916, 226.89999999999938, 68.3000000000002, 154.45814550558052, 41.47674734270453, 180.74087067540847, 60.139037304427255, 153.66325386820998, 109.81254335834268, 96.80000000000011, 108.61895163315396, 159.3546697445331, 53.10000000000013, 125.29999999999959, 34.93780403323022, 139.0999999999999, 206.80167211533725, 40.50000000000029, 68.40000000000009, 88.29999999999927, 242.69999999999993, 37.700000000000266, 104.09999999999903, 229.34134979067687, 152.6250807412044, 157.8592262743011, 37.26670789146122, 35.20000000000023, 108.04468364708873, 87.5999999999994, 92.41177405235972, 131.94864151087714, 94.40623855187317], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [13.573129738316304, -53.54665936669982, -254.04609845621002, -260.27960040372835, -140.65478211067654, -73.1171426718985, 39.583255312047925, -34.03651010327775, -114.83317908671795, -92.66853807147267, -96.4272326280199, 93.09870255859556, -64.80740741555226, 20.000000000000014, 20.626642410773584, -16.792242611230414, 18.848497587615384, -92.85980597895414, 69.17606926139403, -109.36249015041209, -285.2321358475945, 105.74800812423979, 132.7888944272447, -19.35385941243218, -25.356623210719427, 11.326871936077456, -78.03601550180139, -20.07740583328924, 28.904313331271958, 85.71002709904536, -84.17058524148602, -101.59193807470932, -247.8691803256373, -34.87488956710395, -49.40531904969436, -141.19228141836533, -107.134889946308, 73.87102816456981, 4.171128342528487, -6.373188196460497, 72.0443042732162, -52.54708787865346, -32.67477650531073, -33.11217620680012, 17.408091439294907, -110.92817899556306, 80.28766474857159, -53.604483480981195, 64.90005398718623, -328.3984316256627, -221.37365036394135, -15.540567450569034, -217.97172194166885, 76.83739839192134, -62.4215290072797, -67.19987230581766, 82.82590198976501, -215.4723347673664, -63.01766150909464, -253.83034574412602, -72.05610867549865, 89.36722870345912, -103.9034532802869, -142.29070810227037, 0.5594712651248201, 21.887655692545323, -382.5350217575324, 117.78599718266575, -341.68754507993606, -271.3757928143444, 42.05974767402415, -113.91576456218526, 10.584749159468316, -368.0370289653096, -96.60173288891873, 6.578081936680414, -116.41208622158636, -38.927412945968925, -335.88260364800084, 33.30132488528524, -27.102952922490367, -70.03840438982733, -11.808869660467748, -17.067235360537826, 10.174001800704053, -2.962232113254194, -5.251613856427011, -54.123434986458186, -77.75098136410048, -19.99080009629646, 33.88040540161318, 40.0118549587175, 18.203034292193653, -101.55435256341609, 84.66934503983893, -118.51718584134521, -111.25275039532056, -35.27706169307365, 12.962713255211035, -154.80174341253127, -108.368940102753, 45.92361009447094, 66.26530936409696, -54.85406764413665, -50.32982812857711, -6.234569676365133, 43.52535653925046, -20.284647818951065, -122.72911794687963, -30.02930181547257, 64.88866316909824, -29.828281979136015, 27.845266783971347, 9.541578665059246, 1.103496687474779, 7.009962407567832, -8.299879170194934, -72.54471461247661, -97.58563081684744, -33.94553553761412, 161.42330774007206, -112.95182525200485, -6.1055308568346724, 40.28710026868663, -159.2584299113319, 1.9693763855458568, -203.51123731867187, -41.75335832068283, -112.73519084767737, -9.86848498904447, -75.14768969882805, 64.9005559888798, -41.26096743109789, 11.98667537860044, 89.1022150662958, -53.133135240501986, -21.790897701337713, 102.87572050846154, -103.60518017643587, -2.753002690682439, -77.5059788586302, -136.78681328113666, -35.26167272819433, 0.7616669233566751, 99.3892737675306, -121.76317749732668, -221.41484542454427, -0.26256937414734516, -81.64046493632515, 47.835445195899766, 41.62225202827415, -159.27689309555132, 8.414915969460758, -94.96493654962522, -101.89030278114168, -225.75780180988139, 42.3879814213417, -221.12051631037914, -194.2370444672595, -47.443484467917465, -68.94976936260595, -71.53127552961595, -175.21866179031935, -2.377011043507998, 7.336224962261236, 57.5840314172886, 148.94400313475802, -286.27355747273646, -38.05288701360526, -15.675153673344045, -157.06325915064687, 20.451311784900852, -34.19514158105644, -163.71926844518902, 179.13622751357744, -193.68286217716528, -5.466795255903271, 18.11348646225638, 73.35067178507347, -116.27200227841195, 81.3532898949211, -15.069998875773695, -1.5790888906085807, -103.01419787536915, 39.20269946596015, -70.07117731476804, -109.82064133551206, -6.986631127929058, -36.128808808176835, 15.187313791671755, -14.673585565722401, -251.67950712492743, 6.628822658497688, -90.79739622560763, -223.17849208443, -63.253333383580255, -19.653256456869457, -32.815082218808726, 25.002451968907792, -219.83803663194715], "policy_predator_policy_reward": [5.826870261683667, 69.24665936669969, 324.2059226722713, 187.82411487972215, 153.05478211067583, 113.01714267189817, 17.61674468795218, 70.83651010327776, 56.871368154986286, 191.90703446277513, 141.68851820524378, 0.0, 91.80740741555158, 0.0, 54.17335758922649, 131.5922426112305, 1.0515024123846184, 119.05980597895365, 36.62393073860571, 126.16249015041168, 294.04458931930264, 58.43138602720072, 27.098306487098423, 43.366658498089144, 101.5982771707111, 77.69808380843789, 92.33601550180148, 69.17740583328944, 11.711242094735995, 97.91032777106007, 159.598841430636, 144.42881435000547, 256.62014258831397, 83.17326937041157, 64.7437860571049, 182.14132692717635, 121.33488994630724, 3.428971835429686, 17.92887165747148, 61.97318819646065, 71.37501564844887, 195.79699114833366, 50.574776505310986, 49.41217620680031, 95.99190856070484, 133.02817899556257, 118.64992189155714, 44.429110259031575, 173.65858800042827, 294.7987946549283, 219.5255437438939, 58.84984999166302, 153.020176017792, 148.6350451107507, 84.92152900727922, 86.59987230581754, 35.917401426461, 256.72903135113984, 310.86582010807547, 62.23254304989086, 95.58973110505788, 76.50819038770996, 122.80345328028605, 155.79070810226966, 62.740528734875355, 50.312344307454744, 388.3350217575325, 13.51400281733393, 276.4934910271924, 282.6228917498557, 228.37632836739596, 14.384633174866076, 36.51525084053167, 377.03702896531087, 55.843560999739694, 94.38008995249868, 186.75715567238382, 3.338471062991101, 341.8826036480012, 4.298675114714987, 61.56155472910194, 75.84484689398705, 39.31993402285901, 36.68605729351662, 9.025998199295913, 32.16223211325439, 17.067987561023646, 78.50917759223691, 86.89305015310855, 85.34873130728765, 32.98846306649877, 46.31927657317061, 3.2969657078063443, 120.15435256341586, 51.96603493554656, 113.08180586595923, 51.82953263144456, 147.2709014897984, 28.814437033388117, 169.02459312393165, 122.3689401027523, 69.27638990552909, 2.934690635903009, 71.85406764413669, 69.17481916505344, 16.220654559082863, 82.67464346074956, 54.88464781895127, 149.0452344703959, 85.05170701639402, 61.64654055235777, 6.308513636455049, 122.72811266075166, 9.76569171381375, 28.196503312525255, 11.990037592432142, 39.59465245581429, 93.77925190682629, 173.417858483239, 6.14133330985798, 15.762281811455798, 134.36623570047647, 76.06028203580479, 74.22850676175635, 34.695476680536935, 159.6621907988072, 167.2233660646181, 158.99304802466287, 125.23519084767717, 31.268484989044566, 88.54768969882797, 57.09944401112018, 170.03924007813922, 8.135051974358213, 21.451638560862875, 76.27928161334323, 145.09089770133772, 0.7242794915378635, 119.58478321201947, 55.07339965509877, 101.30347201003724, 267.44746563530987, 25.72851731642294, 50.2482358311191, 10.105741511511418, 193.0090328936931, 242.16798791533478, 39.648464187783205, 159.3499139561802, 28.118359652455005, 62.6282279289202, 164.83895649669932, 73.18508403053936, 110.16493654962441, 168.40666761692708, 267.8603886072499, 213.90796331236706, 124.17924132120368, 231.43704446725934, 63.34348446791769, 164.82322943616253, 100.95781545605833, 192.6461275375021, 19.887349329554755, 38.363775037738804, 35.81596858271153, 113.3458349053624, 230.7853915479533, 54.85288701360539, 39.375153673344265, 203.76325915064663, 1.2486882150991712, 111.99514158105654, 174.21926844518845, 10.863772486422565, 246.3828621771652, 23.366795255903288, 1.686513537743613, 3.0493282149260565, 143.97200227841205, 11.169618052507685, 151.88844071902219, 78.45110531031017, 178.76726219687225, 5.491533832319006, 183.23617029079, 53.44679168121165, 100.62718867369004, 51.62880880817706, 4.512686208328209, 171.62334218999183, 202.77443414774723, 128.4407517753692, 43.32782179174049, 246.32318803637418, 132.52041148399576, 85.60806980806116, 98.80891037849513, 185.52092658311363, 103.72089663179854]}, "sampler_perf": {"mean_raw_obs_processing_ms": 24.612889016885457, "mean_inference_ms": 21.186329230406663, "mean_action_processing_ms": 5.908154806035579, "mean_env_wait_ms": 37.33530745612723, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.09543001651763916, "StateBufferConnector_ms": 0.03673684597015381, "ViewRequirementAgentConnector_ms": 1.255206823348999}, "num_episodes": 0, "episode_return_max": 286.6692231913454, "episode_return_min": -53.94695511723343, "episode_return_mean": 102.60472273081903, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 149312, "num_agent_steps_trained": 149312, "num_env_steps_sampled": 37328, "num_env_steps_trained": 37328, "num_env_steps_sampled_this_iter": 0, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 0.0, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 37328, "num_env_steps_sampled_lifetime": 37328, "num_agent_steps_sampled_lifetime": 149312, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 149312, "timers": {"training_iteration_time_ms": 61417.791, "restore_workers_time_ms": 26.899, "training_step_time_ms": 61364.32, "sample_time_ms": 61349.733, "learn_time_ms": 311236.026, "learn_throughput": 59.967, "synch_weights_time_ms": 43.334}, "counters": {"num_env_steps_sampled": 37328, "num_env_steps_trained": 37328, "num_agent_steps_sampled": 149312, "num_agent_steps_trained": 149312}, "done": false, "training_iteration": 47, "trial_id": "d7bca_00000", "date": "2024-08-20_12-49-06", "timestamp": 1724138346, "time_this_iter_s": 122.82518601417542, "time_total_s": 6907.04992389679, "pid": 36059, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 16000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x32cf6daf0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 6907.04992389679, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 96.2, "ram_util_percent": 83.55882352941177}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {}, "num_env_steps_sampled": 37328, "num_env_steps_trained": 37328, "num_agent_steps_sampled": 149312, "num_agent_steps_trained": 149312}, "env_runners": {"episode_reward_max": 286.6692231913454, "episode_reward_min": -53.94695511723343, "episode_reward_mean": 102.60472273081903, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -382.5350217575324, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 179.13622751357744, "predator_policy": 388.3350217575325}, "policy_reward_mean": {"prey_policy": -50.61742331228365, "predator_policy": 101.91978467769317}, "custom_metrics": {}, "hist_stats": {"episode_reward": [35.10000000000023, -2.2956613079459616, 52.30000000000035, 93.99999999999946, 41.27668545957155, 138.35998813581944, 47.000000000000355, 189.59999999999982, 46.100000000000314, 122.59999999999911, 172.99184762314727, 183.89999999999952, 165.26660970450598, 63.400000000000325, 224.23591029611316, 118.26513246444676, 57.049342065984625, 56.287512516221504, 91.49999999999856, 77.70000000000017, 286.6692231913454, 34.20000000000022, 135.4999999999999, 189.7622134181783, 204.95900501687956, 41.46117592104707, 160.52089757879483, 41.90000000000027, 159.99999999999952, 56.25035590474681, 189.40904152072758, 32.4000000000002, 135.49999999999923, 137.09999999999957, -53.94695511723343, 170.90494465410117, 56.10000000000025, 60.20000000000013, 34.75612756781972, 43.60000000000028, 40.265044310772325, 47.1298862953699, 48.40000000000023, 36.202116310375594, 74.49999999999962, 153.19999999999987, 40.1000000000002, 131.19999999999982, 52.570622032848895, 56.000000000000156, 129.1999999999993, 86.20000000000002, 28.831075919194078, 160.79999999999959, 81.33852172443821, 103.01543537877356, 169.88064982359512, 48.30000000000023, 52.529310579969625, 48.028025438635616, 198.59999999999948, 184.470358209413, 37.06861395355878, 80.95181844992561, 33.900000000000134, 135.39999999999944, 148.89999999999955, 133.69999999999916, 226.89999999999938, 68.3000000000002, 154.45814550558052, 41.47674734270453, 180.74087067540847, 60.139037304427255, 153.66325386820998, 109.81254335834268, 96.80000000000011, 108.61895163315396, 159.3546697445331, 53.10000000000013, 125.29999999999959, 34.93780403323022, 139.0999999999999, 206.80167211533725, 40.50000000000029, 68.40000000000009, 88.29999999999927, 242.69999999999993, 37.700000000000266, 104.09999999999903, 229.34134979067687, 152.6250807412044, 157.8592262743011, 37.26670789146122, 35.20000000000023, 108.04468364708873, 87.5999999999994, 92.41177405235972, 131.94864151087714, 94.40623855187317], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [13.573129738316304, -53.54665936669982, -254.04609845621002, -260.27960040372835, -140.65478211067654, -73.1171426718985, 39.583255312047925, -34.03651010327775, -114.83317908671795, -92.66853807147267, -96.4272326280199, 93.09870255859556, -64.80740741555226, 20.000000000000014, 20.626642410773584, -16.792242611230414, 18.848497587615384, -92.85980597895414, 69.17606926139403, -109.36249015041209, -285.2321358475945, 105.74800812423979, 132.7888944272447, -19.35385941243218, -25.356623210719427, 11.326871936077456, -78.03601550180139, -20.07740583328924, 28.904313331271958, 85.71002709904536, -84.17058524148602, -101.59193807470932, -247.8691803256373, -34.87488956710395, -49.40531904969436, -141.19228141836533, -107.134889946308, 73.87102816456981, 4.171128342528487, -6.373188196460497, 72.0443042732162, -52.54708787865346, -32.67477650531073, -33.11217620680012, 17.408091439294907, -110.92817899556306, 80.28766474857159, -53.604483480981195, 64.90005398718623, -328.3984316256627, -221.37365036394135, -15.540567450569034, -217.97172194166885, 76.83739839192134, -62.4215290072797, -67.19987230581766, 82.82590198976501, -215.4723347673664, -63.01766150909464, -253.83034574412602, -72.05610867549865, 89.36722870345912, -103.9034532802869, -142.29070810227037, 0.5594712651248201, 21.887655692545323, -382.5350217575324, 117.78599718266575, -341.68754507993606, -271.3757928143444, 42.05974767402415, -113.91576456218526, 10.584749159468316, -368.0370289653096, -96.60173288891873, 6.578081936680414, -116.41208622158636, -38.927412945968925, -335.88260364800084, 33.30132488528524, -27.102952922490367, -70.03840438982733, -11.808869660467748, -17.067235360537826, 10.174001800704053, -2.962232113254194, -5.251613856427011, -54.123434986458186, -77.75098136410048, -19.99080009629646, 33.88040540161318, 40.0118549587175, 18.203034292193653, -101.55435256341609, 84.66934503983893, -118.51718584134521, -111.25275039532056, -35.27706169307365, 12.962713255211035, -154.80174341253127, -108.368940102753, 45.92361009447094, 66.26530936409696, -54.85406764413665, -50.32982812857711, -6.234569676365133, 43.52535653925046, -20.284647818951065, -122.72911794687963, -30.02930181547257, 64.88866316909824, -29.828281979136015, 27.845266783971347, 9.541578665059246, 1.103496687474779, 7.009962407567832, -8.299879170194934, -72.54471461247661, -97.58563081684744, -33.94553553761412, 161.42330774007206, -112.95182525200485, -6.1055308568346724, 40.28710026868663, -159.2584299113319, 1.9693763855458568, -203.51123731867187, -41.75335832068283, -112.73519084767737, -9.86848498904447, -75.14768969882805, 64.9005559888798, -41.26096743109789, 11.98667537860044, 89.1022150662958, -53.133135240501986, -21.790897701337713, 102.87572050846154, -103.60518017643587, -2.753002690682439, -77.5059788586302, -136.78681328113666, -35.26167272819433, 0.7616669233566751, 99.3892737675306, -121.76317749732668, -221.41484542454427, -0.26256937414734516, -81.64046493632515, 47.835445195899766, 41.62225202827415, -159.27689309555132, 8.414915969460758, -94.96493654962522, -101.89030278114168, -225.75780180988139, 42.3879814213417, -221.12051631037914, -194.2370444672595, -47.443484467917465, -68.94976936260595, -71.53127552961595, -175.21866179031935, -2.377011043507998, 7.336224962261236, 57.5840314172886, 148.94400313475802, -286.27355747273646, -38.05288701360526, -15.675153673344045, -157.06325915064687, 20.451311784900852, -34.19514158105644, -163.71926844518902, 179.13622751357744, -193.68286217716528, -5.466795255903271, 18.11348646225638, 73.35067178507347, -116.27200227841195, 81.3532898949211, -15.069998875773695, -1.5790888906085807, -103.01419787536915, 39.20269946596015, -70.07117731476804, -109.82064133551206, -6.986631127929058, -36.128808808176835, 15.187313791671755, -14.673585565722401, -251.67950712492743, 6.628822658497688, -90.79739622560763, -223.17849208443, -63.253333383580255, -19.653256456869457, -32.815082218808726, 25.002451968907792, -219.83803663194715], "policy_predator_policy_reward": [5.826870261683667, 69.24665936669969, 324.2059226722713, 187.82411487972215, 153.05478211067583, 113.01714267189817, 17.61674468795218, 70.83651010327776, 56.871368154986286, 191.90703446277513, 141.68851820524378, 0.0, 91.80740741555158, 0.0, 54.17335758922649, 131.5922426112305, 1.0515024123846184, 119.05980597895365, 36.62393073860571, 126.16249015041168, 294.04458931930264, 58.43138602720072, 27.098306487098423, 43.366658498089144, 101.5982771707111, 77.69808380843789, 92.33601550180148, 69.17740583328944, 11.711242094735995, 97.91032777106007, 159.598841430636, 144.42881435000547, 256.62014258831397, 83.17326937041157, 64.7437860571049, 182.14132692717635, 121.33488994630724, 3.428971835429686, 17.92887165747148, 61.97318819646065, 71.37501564844887, 195.79699114833366, 50.574776505310986, 49.41217620680031, 95.99190856070484, 133.02817899556257, 118.64992189155714, 44.429110259031575, 173.65858800042827, 294.7987946549283, 219.5255437438939, 58.84984999166302, 153.020176017792, 148.6350451107507, 84.92152900727922, 86.59987230581754, 35.917401426461, 256.72903135113984, 310.86582010807547, 62.23254304989086, 95.58973110505788, 76.50819038770996, 122.80345328028605, 155.79070810226966, 62.740528734875355, 50.312344307454744, 388.3350217575325, 13.51400281733393, 276.4934910271924, 282.6228917498557, 228.37632836739596, 14.384633174866076, 36.51525084053167, 377.03702896531087, 55.843560999739694, 94.38008995249868, 186.75715567238382, 3.338471062991101, 341.8826036480012, 4.298675114714987, 61.56155472910194, 75.84484689398705, 39.31993402285901, 36.68605729351662, 9.025998199295913, 32.16223211325439, 17.067987561023646, 78.50917759223691, 86.89305015310855, 85.34873130728765, 32.98846306649877, 46.31927657317061, 3.2969657078063443, 120.15435256341586, 51.96603493554656, 113.08180586595923, 51.82953263144456, 147.2709014897984, 28.814437033388117, 169.02459312393165, 122.3689401027523, 69.27638990552909, 2.934690635903009, 71.85406764413669, 69.17481916505344, 16.220654559082863, 82.67464346074956, 54.88464781895127, 149.0452344703959, 85.05170701639402, 61.64654055235777, 6.308513636455049, 122.72811266075166, 9.76569171381375, 28.196503312525255, 11.990037592432142, 39.59465245581429, 93.77925190682629, 173.417858483239, 6.14133330985798, 15.762281811455798, 134.36623570047647, 76.06028203580479, 74.22850676175635, 34.695476680536935, 159.6621907988072, 167.2233660646181, 158.99304802466287, 125.23519084767717, 31.268484989044566, 88.54768969882797, 57.09944401112018, 170.03924007813922, 8.135051974358213, 21.451638560862875, 76.27928161334323, 145.09089770133772, 0.7242794915378635, 119.58478321201947, 55.07339965509877, 101.30347201003724, 267.44746563530987, 25.72851731642294, 50.2482358311191, 10.105741511511418, 193.0090328936931, 242.16798791533478, 39.648464187783205, 159.3499139561802, 28.118359652455005, 62.6282279289202, 164.83895649669932, 73.18508403053936, 110.16493654962441, 168.40666761692708, 267.8603886072499, 213.90796331236706, 124.17924132120368, 231.43704446725934, 63.34348446791769, 164.82322943616253, 100.95781545605833, 192.6461275375021, 19.887349329554755, 38.363775037738804, 35.81596858271153, 113.3458349053624, 230.7853915479533, 54.85288701360539, 39.375153673344265, 203.76325915064663, 1.2486882150991712, 111.99514158105654, 174.21926844518845, 10.863772486422565, 246.3828621771652, 23.366795255903288, 1.686513537743613, 3.0493282149260565, 143.97200227841205, 11.169618052507685, 151.88844071902219, 78.45110531031017, 178.76726219687225, 5.491533832319006, 183.23617029079, 53.44679168121165, 100.62718867369004, 51.62880880817706, 4.512686208328209, 171.62334218999183, 202.77443414774723, 128.4407517753692, 43.32782179174049, 246.32318803637418, 132.52041148399576, 85.60806980806116, 98.80891037849513, 185.52092658311363, 103.72089663179854]}, "sampler_perf": {"mean_raw_obs_processing_ms": 24.612889016885457, "mean_inference_ms": 21.186329230406663, "mean_action_processing_ms": 5.908154806035579, "mean_env_wait_ms": 37.33530745612723, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.09543001651763916, "StateBufferConnector_ms": 0.03673684597015381, "ViewRequirementAgentConnector_ms": 1.255206823348999}, "num_episodes": 0, "episode_return_max": 286.6692231913454, "episode_return_min": -53.94695511723343, "episode_return_mean": 102.60472273081903, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 149312, "num_agent_steps_trained": 149312, "num_env_steps_sampled": 37328, "num_env_steps_trained": 37328, "num_env_steps_sampled_this_iter": 0, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 0.0, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 37328, "num_env_steps_sampled_lifetime": 37328, "num_agent_steps_sampled_lifetime": 149312, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 149312, "timers": {"training_iteration_time_ms": 61438.807, "restore_workers_time_ms": 28.212, "training_step_time_ms": 61381.983, "sample_time_ms": 61366.96, "learn_time_ms": 311236.026, "learn_throughput": 59.967, "synch_weights_time_ms": 43.334}, "counters": {"num_env_steps_sampled": 37328, "num_env_steps_trained": 37328, "num_agent_steps_sampled": 149312, "num_agent_steps_trained": 149312}, "done": false, "training_iteration": 48, "trial_id": "d7bca_00000", "date": "2024-08-20_12-51-12", "timestamp": 1724138472, "time_this_iter_s": 122.75246405601501, "time_total_s": 7029.802387952805, "pid": 36059, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 16000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x32cf6d550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 7029.802387952805, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 96.37485380116958, "ram_util_percent": 83.59707602339182}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {}, "num_env_steps_sampled": 37328, "num_env_steps_trained": 37328, "num_agent_steps_sampled": 149312, "num_agent_steps_trained": 149312}, "env_runners": {"episode_reward_max": 286.6692231913454, "episode_reward_min": -53.94695511723343, "episode_reward_mean": 102.60472273081903, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -382.5350217575324, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 179.13622751357744, "predator_policy": 388.3350217575325}, "policy_reward_mean": {"prey_policy": -50.61742331228365, "predator_policy": 101.91978467769317}, "custom_metrics": {}, "hist_stats": {"episode_reward": [35.10000000000023, -2.2956613079459616, 52.30000000000035, 93.99999999999946, 41.27668545957155, 138.35998813581944, 47.000000000000355, 189.59999999999982, 46.100000000000314, 122.59999999999911, 172.99184762314727, 183.89999999999952, 165.26660970450598, 63.400000000000325, 224.23591029611316, 118.26513246444676, 57.049342065984625, 56.287512516221504, 91.49999999999856, 77.70000000000017, 286.6692231913454, 34.20000000000022, 135.4999999999999, 189.7622134181783, 204.95900501687956, 41.46117592104707, 160.52089757879483, 41.90000000000027, 159.99999999999952, 56.25035590474681, 189.40904152072758, 32.4000000000002, 135.49999999999923, 137.09999999999957, -53.94695511723343, 170.90494465410117, 56.10000000000025, 60.20000000000013, 34.75612756781972, 43.60000000000028, 40.265044310772325, 47.1298862953699, 48.40000000000023, 36.202116310375594, 74.49999999999962, 153.19999999999987, 40.1000000000002, 131.19999999999982, 52.570622032848895, 56.000000000000156, 129.1999999999993, 86.20000000000002, 28.831075919194078, 160.79999999999959, 81.33852172443821, 103.01543537877356, 169.88064982359512, 48.30000000000023, 52.529310579969625, 48.028025438635616, 198.59999999999948, 184.470358209413, 37.06861395355878, 80.95181844992561, 33.900000000000134, 135.39999999999944, 148.89999999999955, 133.69999999999916, 226.89999999999938, 68.3000000000002, 154.45814550558052, 41.47674734270453, 180.74087067540847, 60.139037304427255, 153.66325386820998, 109.81254335834268, 96.80000000000011, 108.61895163315396, 159.3546697445331, 53.10000000000013, 125.29999999999959, 34.93780403323022, 139.0999999999999, 206.80167211533725, 40.50000000000029, 68.40000000000009, 88.29999999999927, 242.69999999999993, 37.700000000000266, 104.09999999999903, 229.34134979067687, 152.6250807412044, 157.8592262743011, 37.26670789146122, 35.20000000000023, 108.04468364708873, 87.5999999999994, 92.41177405235972, 131.94864151087714, 94.40623855187317], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [13.573129738316304, -53.54665936669982, -254.04609845621002, -260.27960040372835, -140.65478211067654, -73.1171426718985, 39.583255312047925, -34.03651010327775, -114.83317908671795, -92.66853807147267, -96.4272326280199, 93.09870255859556, -64.80740741555226, 20.000000000000014, 20.626642410773584, -16.792242611230414, 18.848497587615384, -92.85980597895414, 69.17606926139403, -109.36249015041209, -285.2321358475945, 105.74800812423979, 132.7888944272447, -19.35385941243218, -25.356623210719427, 11.326871936077456, -78.03601550180139, -20.07740583328924, 28.904313331271958, 85.71002709904536, -84.17058524148602, -101.59193807470932, -247.8691803256373, -34.87488956710395, -49.40531904969436, -141.19228141836533, -107.134889946308, 73.87102816456981, 4.171128342528487, -6.373188196460497, 72.0443042732162, -52.54708787865346, -32.67477650531073, -33.11217620680012, 17.408091439294907, -110.92817899556306, 80.28766474857159, -53.604483480981195, 64.90005398718623, -328.3984316256627, -221.37365036394135, -15.540567450569034, -217.97172194166885, 76.83739839192134, -62.4215290072797, -67.19987230581766, 82.82590198976501, -215.4723347673664, -63.01766150909464, -253.83034574412602, -72.05610867549865, 89.36722870345912, -103.9034532802869, -142.29070810227037, 0.5594712651248201, 21.887655692545323, -382.5350217575324, 117.78599718266575, -341.68754507993606, -271.3757928143444, 42.05974767402415, -113.91576456218526, 10.584749159468316, -368.0370289653096, -96.60173288891873, 6.578081936680414, -116.41208622158636, -38.927412945968925, -335.88260364800084, 33.30132488528524, -27.102952922490367, -70.03840438982733, -11.808869660467748, -17.067235360537826, 10.174001800704053, -2.962232113254194, -5.251613856427011, -54.123434986458186, -77.75098136410048, -19.99080009629646, 33.88040540161318, 40.0118549587175, 18.203034292193653, -101.55435256341609, 84.66934503983893, -118.51718584134521, -111.25275039532056, -35.27706169307365, 12.962713255211035, -154.80174341253127, -108.368940102753, 45.92361009447094, 66.26530936409696, -54.85406764413665, -50.32982812857711, -6.234569676365133, 43.52535653925046, -20.284647818951065, -122.72911794687963, -30.02930181547257, 64.88866316909824, -29.828281979136015, 27.845266783971347, 9.541578665059246, 1.103496687474779, 7.009962407567832, -8.299879170194934, -72.54471461247661, -97.58563081684744, -33.94553553761412, 161.42330774007206, -112.95182525200485, -6.1055308568346724, 40.28710026868663, -159.2584299113319, 1.9693763855458568, -203.51123731867187, -41.75335832068283, -112.73519084767737, -9.86848498904447, -75.14768969882805, 64.9005559888798, -41.26096743109789, 11.98667537860044, 89.1022150662958, -53.133135240501986, -21.790897701337713, 102.87572050846154, -103.60518017643587, -2.753002690682439, -77.5059788586302, -136.78681328113666, -35.26167272819433, 0.7616669233566751, 99.3892737675306, -121.76317749732668, -221.41484542454427, -0.26256937414734516, -81.64046493632515, 47.835445195899766, 41.62225202827415, -159.27689309555132, 8.414915969460758, -94.96493654962522, -101.89030278114168, -225.75780180988139, 42.3879814213417, -221.12051631037914, -194.2370444672595, -47.443484467917465, -68.94976936260595, -71.53127552961595, -175.21866179031935, -2.377011043507998, 7.336224962261236, 57.5840314172886, 148.94400313475802, -286.27355747273646, -38.05288701360526, -15.675153673344045, -157.06325915064687, 20.451311784900852, -34.19514158105644, -163.71926844518902, 179.13622751357744, -193.68286217716528, -5.466795255903271, 18.11348646225638, 73.35067178507347, -116.27200227841195, 81.3532898949211, -15.069998875773695, -1.5790888906085807, -103.01419787536915, 39.20269946596015, -70.07117731476804, -109.82064133551206, -6.986631127929058, -36.128808808176835, 15.187313791671755, -14.673585565722401, -251.67950712492743, 6.628822658497688, -90.79739622560763, -223.17849208443, -63.253333383580255, -19.653256456869457, -32.815082218808726, 25.002451968907792, -219.83803663194715], "policy_predator_policy_reward": [5.826870261683667, 69.24665936669969, 324.2059226722713, 187.82411487972215, 153.05478211067583, 113.01714267189817, 17.61674468795218, 70.83651010327776, 56.871368154986286, 191.90703446277513, 141.68851820524378, 0.0, 91.80740741555158, 0.0, 54.17335758922649, 131.5922426112305, 1.0515024123846184, 119.05980597895365, 36.62393073860571, 126.16249015041168, 294.04458931930264, 58.43138602720072, 27.098306487098423, 43.366658498089144, 101.5982771707111, 77.69808380843789, 92.33601550180148, 69.17740583328944, 11.711242094735995, 97.91032777106007, 159.598841430636, 144.42881435000547, 256.62014258831397, 83.17326937041157, 64.7437860571049, 182.14132692717635, 121.33488994630724, 3.428971835429686, 17.92887165747148, 61.97318819646065, 71.37501564844887, 195.79699114833366, 50.574776505310986, 49.41217620680031, 95.99190856070484, 133.02817899556257, 118.64992189155714, 44.429110259031575, 173.65858800042827, 294.7987946549283, 219.5255437438939, 58.84984999166302, 153.020176017792, 148.6350451107507, 84.92152900727922, 86.59987230581754, 35.917401426461, 256.72903135113984, 310.86582010807547, 62.23254304989086, 95.58973110505788, 76.50819038770996, 122.80345328028605, 155.79070810226966, 62.740528734875355, 50.312344307454744, 388.3350217575325, 13.51400281733393, 276.4934910271924, 282.6228917498557, 228.37632836739596, 14.384633174866076, 36.51525084053167, 377.03702896531087, 55.843560999739694, 94.38008995249868, 186.75715567238382, 3.338471062991101, 341.8826036480012, 4.298675114714987, 61.56155472910194, 75.84484689398705, 39.31993402285901, 36.68605729351662, 9.025998199295913, 32.16223211325439, 17.067987561023646, 78.50917759223691, 86.89305015310855, 85.34873130728765, 32.98846306649877, 46.31927657317061, 3.2969657078063443, 120.15435256341586, 51.96603493554656, 113.08180586595923, 51.82953263144456, 147.2709014897984, 28.814437033388117, 169.02459312393165, 122.3689401027523, 69.27638990552909, 2.934690635903009, 71.85406764413669, 69.17481916505344, 16.220654559082863, 82.67464346074956, 54.88464781895127, 149.0452344703959, 85.05170701639402, 61.64654055235777, 6.308513636455049, 122.72811266075166, 9.76569171381375, 28.196503312525255, 11.990037592432142, 39.59465245581429, 93.77925190682629, 173.417858483239, 6.14133330985798, 15.762281811455798, 134.36623570047647, 76.06028203580479, 74.22850676175635, 34.695476680536935, 159.6621907988072, 167.2233660646181, 158.99304802466287, 125.23519084767717, 31.268484989044566, 88.54768969882797, 57.09944401112018, 170.03924007813922, 8.135051974358213, 21.451638560862875, 76.27928161334323, 145.09089770133772, 0.7242794915378635, 119.58478321201947, 55.07339965509877, 101.30347201003724, 267.44746563530987, 25.72851731642294, 50.2482358311191, 10.105741511511418, 193.0090328936931, 242.16798791533478, 39.648464187783205, 159.3499139561802, 28.118359652455005, 62.6282279289202, 164.83895649669932, 73.18508403053936, 110.16493654962441, 168.40666761692708, 267.8603886072499, 213.90796331236706, 124.17924132120368, 231.43704446725934, 63.34348446791769, 164.82322943616253, 100.95781545605833, 192.6461275375021, 19.887349329554755, 38.363775037738804, 35.81596858271153, 113.3458349053624, 230.7853915479533, 54.85288701360539, 39.375153673344265, 203.76325915064663, 1.2486882150991712, 111.99514158105654, 174.21926844518845, 10.863772486422565, 246.3828621771652, 23.366795255903288, 1.686513537743613, 3.0493282149260565, 143.97200227841205, 11.169618052507685, 151.88844071902219, 78.45110531031017, 178.76726219687225, 5.491533832319006, 183.23617029079, 53.44679168121165, 100.62718867369004, 51.62880880817706, 4.512686208328209, 171.62334218999183, 202.77443414774723, 128.4407517753692, 43.32782179174049, 246.32318803637418, 132.52041148399576, 85.60806980806116, 98.80891037849513, 185.52092658311363, 103.72089663179854]}, "sampler_perf": {"mean_raw_obs_processing_ms": 24.612889016885457, "mean_inference_ms": 21.186329230406663, "mean_action_processing_ms": 5.908154806035579, "mean_env_wait_ms": 37.33530745612723, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.09543001651763916, "StateBufferConnector_ms": 0.03673684597015381, "ViewRequirementAgentConnector_ms": 1.255206823348999}, "num_episodes": 0, "episode_return_max": 286.6692231913454, "episode_return_min": -53.94695511723343, "episode_return_mean": 102.60472273081903, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 149312, "num_agent_steps_trained": 149312, "num_env_steps_sampled": 37328, "num_env_steps_trained": 37328, "num_env_steps_sampled_this_iter": 0, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 0.0, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 37328, "num_env_steps_sampled_lifetime": 37328, "num_agent_steps_sampled_lifetime": 149312, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 149312, "timers": {"training_iteration_time_ms": 61401.374, "restore_workers_time_ms": 28.631, "training_step_time_ms": 61341.816, "sample_time_ms": 61326.82, "learn_time_ms": 311236.026, "learn_throughput": 59.967, "synch_weights_time_ms": 43.334}, "counters": {"num_env_steps_sampled": 37328, "num_env_steps_trained": 37328, "num_agent_steps_sampled": 149312, "num_agent_steps_trained": 149312}, "done": false, "training_iteration": 49, "trial_id": "d7bca_00000", "date": "2024-08-20_12-53-16", "timestamp": 1724138596, "time_this_iter_s": 122.89117288589478, "time_total_s": 7152.693560838699, "pid": 36059, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 16000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3ae8b1280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 7152.693560838699, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 96.7610465116279, "ram_util_percent": 83.59534883720931}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {}, "num_env_steps_sampled": 37328, "num_env_steps_trained": 37328, "num_agent_steps_sampled": 149312, "num_agent_steps_trained": 149312}, "env_runners": {"episode_reward_max": 286.6692231913454, "episode_reward_min": -53.94695511723343, "episode_reward_mean": 102.60472273081903, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -382.5350217575324, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 179.13622751357744, "predator_policy": 388.3350217575325}, "policy_reward_mean": {"prey_policy": -50.61742331228365, "predator_policy": 101.91978467769317}, "custom_metrics": {}, "hist_stats": {"episode_reward": [35.10000000000023, -2.2956613079459616, 52.30000000000035, 93.99999999999946, 41.27668545957155, 138.35998813581944, 47.000000000000355, 189.59999999999982, 46.100000000000314, 122.59999999999911, 172.99184762314727, 183.89999999999952, 165.26660970450598, 63.400000000000325, 224.23591029611316, 118.26513246444676, 57.049342065984625, 56.287512516221504, 91.49999999999856, 77.70000000000017, 286.6692231913454, 34.20000000000022, 135.4999999999999, 189.7622134181783, 204.95900501687956, 41.46117592104707, 160.52089757879483, 41.90000000000027, 159.99999999999952, 56.25035590474681, 189.40904152072758, 32.4000000000002, 135.49999999999923, 137.09999999999957, -53.94695511723343, 170.90494465410117, 56.10000000000025, 60.20000000000013, 34.75612756781972, 43.60000000000028, 40.265044310772325, 47.1298862953699, 48.40000000000023, 36.202116310375594, 74.49999999999962, 153.19999999999987, 40.1000000000002, 131.19999999999982, 52.570622032848895, 56.000000000000156, 129.1999999999993, 86.20000000000002, 28.831075919194078, 160.79999999999959, 81.33852172443821, 103.01543537877356, 169.88064982359512, 48.30000000000023, 52.529310579969625, 48.028025438635616, 198.59999999999948, 184.470358209413, 37.06861395355878, 80.95181844992561, 33.900000000000134, 135.39999999999944, 148.89999999999955, 133.69999999999916, 226.89999999999938, 68.3000000000002, 154.45814550558052, 41.47674734270453, 180.74087067540847, 60.139037304427255, 153.66325386820998, 109.81254335834268, 96.80000000000011, 108.61895163315396, 159.3546697445331, 53.10000000000013, 125.29999999999959, 34.93780403323022, 139.0999999999999, 206.80167211533725, 40.50000000000029, 68.40000000000009, 88.29999999999927, 242.69999999999993, 37.700000000000266, 104.09999999999903, 229.34134979067687, 152.6250807412044, 157.8592262743011, 37.26670789146122, 35.20000000000023, 108.04468364708873, 87.5999999999994, 92.41177405235972, 131.94864151087714, 94.40623855187317], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [13.573129738316304, -53.54665936669982, -254.04609845621002, -260.27960040372835, -140.65478211067654, -73.1171426718985, 39.583255312047925, -34.03651010327775, -114.83317908671795, -92.66853807147267, -96.4272326280199, 93.09870255859556, -64.80740741555226, 20.000000000000014, 20.626642410773584, -16.792242611230414, 18.848497587615384, -92.85980597895414, 69.17606926139403, -109.36249015041209, -285.2321358475945, 105.74800812423979, 132.7888944272447, -19.35385941243218, -25.356623210719427, 11.326871936077456, -78.03601550180139, -20.07740583328924, 28.904313331271958, 85.71002709904536, -84.17058524148602, -101.59193807470932, -247.8691803256373, -34.87488956710395, -49.40531904969436, -141.19228141836533, -107.134889946308, 73.87102816456981, 4.171128342528487, -6.373188196460497, 72.0443042732162, -52.54708787865346, -32.67477650531073, -33.11217620680012, 17.408091439294907, -110.92817899556306, 80.28766474857159, -53.604483480981195, 64.90005398718623, -328.3984316256627, -221.37365036394135, -15.540567450569034, -217.97172194166885, 76.83739839192134, -62.4215290072797, -67.19987230581766, 82.82590198976501, -215.4723347673664, -63.01766150909464, -253.83034574412602, -72.05610867549865, 89.36722870345912, -103.9034532802869, -142.29070810227037, 0.5594712651248201, 21.887655692545323, -382.5350217575324, 117.78599718266575, -341.68754507993606, -271.3757928143444, 42.05974767402415, -113.91576456218526, 10.584749159468316, -368.0370289653096, -96.60173288891873, 6.578081936680414, -116.41208622158636, -38.927412945968925, -335.88260364800084, 33.30132488528524, -27.102952922490367, -70.03840438982733, -11.808869660467748, -17.067235360537826, 10.174001800704053, -2.962232113254194, -5.251613856427011, -54.123434986458186, -77.75098136410048, -19.99080009629646, 33.88040540161318, 40.0118549587175, 18.203034292193653, -101.55435256341609, 84.66934503983893, -118.51718584134521, -111.25275039532056, -35.27706169307365, 12.962713255211035, -154.80174341253127, -108.368940102753, 45.92361009447094, 66.26530936409696, -54.85406764413665, -50.32982812857711, -6.234569676365133, 43.52535653925046, -20.284647818951065, -122.72911794687963, -30.02930181547257, 64.88866316909824, -29.828281979136015, 27.845266783971347, 9.541578665059246, 1.103496687474779, 7.009962407567832, -8.299879170194934, -72.54471461247661, -97.58563081684744, -33.94553553761412, 161.42330774007206, -112.95182525200485, -6.1055308568346724, 40.28710026868663, -159.2584299113319, 1.9693763855458568, -203.51123731867187, -41.75335832068283, -112.73519084767737, -9.86848498904447, -75.14768969882805, 64.9005559888798, -41.26096743109789, 11.98667537860044, 89.1022150662958, -53.133135240501986, -21.790897701337713, 102.87572050846154, -103.60518017643587, -2.753002690682439, -77.5059788586302, -136.78681328113666, -35.26167272819433, 0.7616669233566751, 99.3892737675306, -121.76317749732668, -221.41484542454427, -0.26256937414734516, -81.64046493632515, 47.835445195899766, 41.62225202827415, -159.27689309555132, 8.414915969460758, -94.96493654962522, -101.89030278114168, -225.75780180988139, 42.3879814213417, -221.12051631037914, -194.2370444672595, -47.443484467917465, -68.94976936260595, -71.53127552961595, -175.21866179031935, -2.377011043507998, 7.336224962261236, 57.5840314172886, 148.94400313475802, -286.27355747273646, -38.05288701360526, -15.675153673344045, -157.06325915064687, 20.451311784900852, -34.19514158105644, -163.71926844518902, 179.13622751357744, -193.68286217716528, -5.466795255903271, 18.11348646225638, 73.35067178507347, -116.27200227841195, 81.3532898949211, -15.069998875773695, -1.5790888906085807, -103.01419787536915, 39.20269946596015, -70.07117731476804, -109.82064133551206, -6.986631127929058, -36.128808808176835, 15.187313791671755, -14.673585565722401, -251.67950712492743, 6.628822658497688, -90.79739622560763, -223.17849208443, -63.253333383580255, -19.653256456869457, -32.815082218808726, 25.002451968907792, -219.83803663194715], "policy_predator_policy_reward": [5.826870261683667, 69.24665936669969, 324.2059226722713, 187.82411487972215, 153.05478211067583, 113.01714267189817, 17.61674468795218, 70.83651010327776, 56.871368154986286, 191.90703446277513, 141.68851820524378, 0.0, 91.80740741555158, 0.0, 54.17335758922649, 131.5922426112305, 1.0515024123846184, 119.05980597895365, 36.62393073860571, 126.16249015041168, 294.04458931930264, 58.43138602720072, 27.098306487098423, 43.366658498089144, 101.5982771707111, 77.69808380843789, 92.33601550180148, 69.17740583328944, 11.711242094735995, 97.91032777106007, 159.598841430636, 144.42881435000547, 256.62014258831397, 83.17326937041157, 64.7437860571049, 182.14132692717635, 121.33488994630724, 3.428971835429686, 17.92887165747148, 61.97318819646065, 71.37501564844887, 195.79699114833366, 50.574776505310986, 49.41217620680031, 95.99190856070484, 133.02817899556257, 118.64992189155714, 44.429110259031575, 173.65858800042827, 294.7987946549283, 219.5255437438939, 58.84984999166302, 153.020176017792, 148.6350451107507, 84.92152900727922, 86.59987230581754, 35.917401426461, 256.72903135113984, 310.86582010807547, 62.23254304989086, 95.58973110505788, 76.50819038770996, 122.80345328028605, 155.79070810226966, 62.740528734875355, 50.312344307454744, 388.3350217575325, 13.51400281733393, 276.4934910271924, 282.6228917498557, 228.37632836739596, 14.384633174866076, 36.51525084053167, 377.03702896531087, 55.843560999739694, 94.38008995249868, 186.75715567238382, 3.338471062991101, 341.8826036480012, 4.298675114714987, 61.56155472910194, 75.84484689398705, 39.31993402285901, 36.68605729351662, 9.025998199295913, 32.16223211325439, 17.067987561023646, 78.50917759223691, 86.89305015310855, 85.34873130728765, 32.98846306649877, 46.31927657317061, 3.2969657078063443, 120.15435256341586, 51.96603493554656, 113.08180586595923, 51.82953263144456, 147.2709014897984, 28.814437033388117, 169.02459312393165, 122.3689401027523, 69.27638990552909, 2.934690635903009, 71.85406764413669, 69.17481916505344, 16.220654559082863, 82.67464346074956, 54.88464781895127, 149.0452344703959, 85.05170701639402, 61.64654055235777, 6.308513636455049, 122.72811266075166, 9.76569171381375, 28.196503312525255, 11.990037592432142, 39.59465245581429, 93.77925190682629, 173.417858483239, 6.14133330985798, 15.762281811455798, 134.36623570047647, 76.06028203580479, 74.22850676175635, 34.695476680536935, 159.6621907988072, 167.2233660646181, 158.99304802466287, 125.23519084767717, 31.268484989044566, 88.54768969882797, 57.09944401112018, 170.03924007813922, 8.135051974358213, 21.451638560862875, 76.27928161334323, 145.09089770133772, 0.7242794915378635, 119.58478321201947, 55.07339965509877, 101.30347201003724, 267.44746563530987, 25.72851731642294, 50.2482358311191, 10.105741511511418, 193.0090328936931, 242.16798791533478, 39.648464187783205, 159.3499139561802, 28.118359652455005, 62.6282279289202, 164.83895649669932, 73.18508403053936, 110.16493654962441, 168.40666761692708, 267.8603886072499, 213.90796331236706, 124.17924132120368, 231.43704446725934, 63.34348446791769, 164.82322943616253, 100.95781545605833, 192.6461275375021, 19.887349329554755, 38.363775037738804, 35.81596858271153, 113.3458349053624, 230.7853915479533, 54.85288701360539, 39.375153673344265, 203.76325915064663, 1.2486882150991712, 111.99514158105654, 174.21926844518845, 10.863772486422565, 246.3828621771652, 23.366795255903288, 1.686513537743613, 3.0493282149260565, 143.97200227841205, 11.169618052507685, 151.88844071902219, 78.45110531031017, 178.76726219687225, 5.491533832319006, 183.23617029079, 53.44679168121165, 100.62718867369004, 51.62880880817706, 4.512686208328209, 171.62334218999183, 202.77443414774723, 128.4407517753692, 43.32782179174049, 246.32318803637418, 132.52041148399576, 85.60806980806116, 98.80891037849513, 185.52092658311363, 103.72089663179854]}, "sampler_perf": {"mean_raw_obs_processing_ms": 24.612889016885457, "mean_inference_ms": 21.186329230406663, "mean_action_processing_ms": 5.908154806035579, "mean_env_wait_ms": 37.33530745612723, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.09543001651763916, "StateBufferConnector_ms": 0.03673684597015381, "ViewRequirementAgentConnector_ms": 1.255206823348999}, "num_episodes": 0, "episode_return_max": 286.6692231913454, "episode_return_min": -53.94695511723343, "episode_return_mean": 102.60472273081903, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 149312, "num_agent_steps_trained": 149312, "num_env_steps_sampled": 37328, "num_env_steps_trained": 37328, "num_env_steps_sampled_this_iter": 0, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 0.0, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 37328, "num_env_steps_sampled_lifetime": 37328, "num_agent_steps_sampled_lifetime": 149312, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 149312, "timers": {"training_iteration_time_ms": 61596.342, "restore_workers_time_ms": 32.402, "training_step_time_ms": 61523.861, "sample_time_ms": 61504.791, "learn_time_ms": 311236.026, "learn_throughput": 59.967, "synch_weights_time_ms": 43.334}, "counters": {"num_env_steps_sampled": 37328, "num_env_steps_trained": 37328, "num_agent_steps_sampled": 149312, "num_agent_steps_trained": 149312}, "done": false, "training_iteration": 50, "trial_id": "d7bca_00000", "date": "2024-08-20_12-55-25", "timestamp": 1724138725, "time_this_iter_s": 125.58847212791443, "time_total_s": 7278.282032966614, "pid": 36059, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 16000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x32cf6d820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 7278.282032966614, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 94.24375, "ram_util_percent": 83.75568181818183}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {}, "num_env_steps_sampled": 37328, "num_env_steps_trained": 37328, "num_agent_steps_sampled": 149312, "num_agent_steps_trained": 149312}, "env_runners": {"episode_reward_max": 286.6692231913454, "episode_reward_min": -53.94695511723343, "episode_reward_mean": 102.60472273081903, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -382.5350217575324, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 179.13622751357744, "predator_policy": 388.3350217575325}, "policy_reward_mean": {"prey_policy": -50.61742331228365, "predator_policy": 101.91978467769317}, "custom_metrics": {}, "hist_stats": {"episode_reward": [35.10000000000023, -2.2956613079459616, 52.30000000000035, 93.99999999999946, 41.27668545957155, 138.35998813581944, 47.000000000000355, 189.59999999999982, 46.100000000000314, 122.59999999999911, 172.99184762314727, 183.89999999999952, 165.26660970450598, 63.400000000000325, 224.23591029611316, 118.26513246444676, 57.049342065984625, 56.287512516221504, 91.49999999999856, 77.70000000000017, 286.6692231913454, 34.20000000000022, 135.4999999999999, 189.7622134181783, 204.95900501687956, 41.46117592104707, 160.52089757879483, 41.90000000000027, 159.99999999999952, 56.25035590474681, 189.40904152072758, 32.4000000000002, 135.49999999999923, 137.09999999999957, -53.94695511723343, 170.90494465410117, 56.10000000000025, 60.20000000000013, 34.75612756781972, 43.60000000000028, 40.265044310772325, 47.1298862953699, 48.40000000000023, 36.202116310375594, 74.49999999999962, 153.19999999999987, 40.1000000000002, 131.19999999999982, 52.570622032848895, 56.000000000000156, 129.1999999999993, 86.20000000000002, 28.831075919194078, 160.79999999999959, 81.33852172443821, 103.01543537877356, 169.88064982359512, 48.30000000000023, 52.529310579969625, 48.028025438635616, 198.59999999999948, 184.470358209413, 37.06861395355878, 80.95181844992561, 33.900000000000134, 135.39999999999944, 148.89999999999955, 133.69999999999916, 226.89999999999938, 68.3000000000002, 154.45814550558052, 41.47674734270453, 180.74087067540847, 60.139037304427255, 153.66325386820998, 109.81254335834268, 96.80000000000011, 108.61895163315396, 159.3546697445331, 53.10000000000013, 125.29999999999959, 34.93780403323022, 139.0999999999999, 206.80167211533725, 40.50000000000029, 68.40000000000009, 88.29999999999927, 242.69999999999993, 37.700000000000266, 104.09999999999903, 229.34134979067687, 152.6250807412044, 157.8592262743011, 37.26670789146122, 35.20000000000023, 108.04468364708873, 87.5999999999994, 92.41177405235972, 131.94864151087714, 94.40623855187317], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [13.573129738316304, -53.54665936669982, -254.04609845621002, -260.27960040372835, -140.65478211067654, -73.1171426718985, 39.583255312047925, -34.03651010327775, -114.83317908671795, -92.66853807147267, -96.4272326280199, 93.09870255859556, -64.80740741555226, 20.000000000000014, 20.626642410773584, -16.792242611230414, 18.848497587615384, -92.85980597895414, 69.17606926139403, -109.36249015041209, -285.2321358475945, 105.74800812423979, 132.7888944272447, -19.35385941243218, -25.356623210719427, 11.326871936077456, -78.03601550180139, -20.07740583328924, 28.904313331271958, 85.71002709904536, -84.17058524148602, -101.59193807470932, -247.8691803256373, -34.87488956710395, -49.40531904969436, -141.19228141836533, -107.134889946308, 73.87102816456981, 4.171128342528487, -6.373188196460497, 72.0443042732162, -52.54708787865346, -32.67477650531073, -33.11217620680012, 17.408091439294907, -110.92817899556306, 80.28766474857159, -53.604483480981195, 64.90005398718623, -328.3984316256627, -221.37365036394135, -15.540567450569034, -217.97172194166885, 76.83739839192134, -62.4215290072797, -67.19987230581766, 82.82590198976501, -215.4723347673664, -63.01766150909464, -253.83034574412602, -72.05610867549865, 89.36722870345912, -103.9034532802869, -142.29070810227037, 0.5594712651248201, 21.887655692545323, -382.5350217575324, 117.78599718266575, -341.68754507993606, -271.3757928143444, 42.05974767402415, -113.91576456218526, 10.584749159468316, -368.0370289653096, -96.60173288891873, 6.578081936680414, -116.41208622158636, -38.927412945968925, -335.88260364800084, 33.30132488528524, -27.102952922490367, -70.03840438982733, -11.808869660467748, -17.067235360537826, 10.174001800704053, -2.962232113254194, -5.251613856427011, -54.123434986458186, -77.75098136410048, -19.99080009629646, 33.88040540161318, 40.0118549587175, 18.203034292193653, -101.55435256341609, 84.66934503983893, -118.51718584134521, -111.25275039532056, -35.27706169307365, 12.962713255211035, -154.80174341253127, -108.368940102753, 45.92361009447094, 66.26530936409696, -54.85406764413665, -50.32982812857711, -6.234569676365133, 43.52535653925046, -20.284647818951065, -122.72911794687963, -30.02930181547257, 64.88866316909824, -29.828281979136015, 27.845266783971347, 9.541578665059246, 1.103496687474779, 7.009962407567832, -8.299879170194934, -72.54471461247661, -97.58563081684744, -33.94553553761412, 161.42330774007206, -112.95182525200485, -6.1055308568346724, 40.28710026868663, -159.2584299113319, 1.9693763855458568, -203.51123731867187, -41.75335832068283, -112.73519084767737, -9.86848498904447, -75.14768969882805, 64.9005559888798, -41.26096743109789, 11.98667537860044, 89.1022150662958, -53.133135240501986, -21.790897701337713, 102.87572050846154, -103.60518017643587, -2.753002690682439, -77.5059788586302, -136.78681328113666, -35.26167272819433, 0.7616669233566751, 99.3892737675306, -121.76317749732668, -221.41484542454427, -0.26256937414734516, -81.64046493632515, 47.835445195899766, 41.62225202827415, -159.27689309555132, 8.414915969460758, -94.96493654962522, -101.89030278114168, -225.75780180988139, 42.3879814213417, -221.12051631037914, -194.2370444672595, -47.443484467917465, -68.94976936260595, -71.53127552961595, -175.21866179031935, -2.377011043507998, 7.336224962261236, 57.5840314172886, 148.94400313475802, -286.27355747273646, -38.05288701360526, -15.675153673344045, -157.06325915064687, 20.451311784900852, -34.19514158105644, -163.71926844518902, 179.13622751357744, -193.68286217716528, -5.466795255903271, 18.11348646225638, 73.35067178507347, -116.27200227841195, 81.3532898949211, -15.069998875773695, -1.5790888906085807, -103.01419787536915, 39.20269946596015, -70.07117731476804, -109.82064133551206, -6.986631127929058, -36.128808808176835, 15.187313791671755, -14.673585565722401, -251.67950712492743, 6.628822658497688, -90.79739622560763, -223.17849208443, -63.253333383580255, -19.653256456869457, -32.815082218808726, 25.002451968907792, -219.83803663194715], "policy_predator_policy_reward": [5.826870261683667, 69.24665936669969, 324.2059226722713, 187.82411487972215, 153.05478211067583, 113.01714267189817, 17.61674468795218, 70.83651010327776, 56.871368154986286, 191.90703446277513, 141.68851820524378, 0.0, 91.80740741555158, 0.0, 54.17335758922649, 131.5922426112305, 1.0515024123846184, 119.05980597895365, 36.62393073860571, 126.16249015041168, 294.04458931930264, 58.43138602720072, 27.098306487098423, 43.366658498089144, 101.5982771707111, 77.69808380843789, 92.33601550180148, 69.17740583328944, 11.711242094735995, 97.91032777106007, 159.598841430636, 144.42881435000547, 256.62014258831397, 83.17326937041157, 64.7437860571049, 182.14132692717635, 121.33488994630724, 3.428971835429686, 17.92887165747148, 61.97318819646065, 71.37501564844887, 195.79699114833366, 50.574776505310986, 49.41217620680031, 95.99190856070484, 133.02817899556257, 118.64992189155714, 44.429110259031575, 173.65858800042827, 294.7987946549283, 219.5255437438939, 58.84984999166302, 153.020176017792, 148.6350451107507, 84.92152900727922, 86.59987230581754, 35.917401426461, 256.72903135113984, 310.86582010807547, 62.23254304989086, 95.58973110505788, 76.50819038770996, 122.80345328028605, 155.79070810226966, 62.740528734875355, 50.312344307454744, 388.3350217575325, 13.51400281733393, 276.4934910271924, 282.6228917498557, 228.37632836739596, 14.384633174866076, 36.51525084053167, 377.03702896531087, 55.843560999739694, 94.38008995249868, 186.75715567238382, 3.338471062991101, 341.8826036480012, 4.298675114714987, 61.56155472910194, 75.84484689398705, 39.31993402285901, 36.68605729351662, 9.025998199295913, 32.16223211325439, 17.067987561023646, 78.50917759223691, 86.89305015310855, 85.34873130728765, 32.98846306649877, 46.31927657317061, 3.2969657078063443, 120.15435256341586, 51.96603493554656, 113.08180586595923, 51.82953263144456, 147.2709014897984, 28.814437033388117, 169.02459312393165, 122.3689401027523, 69.27638990552909, 2.934690635903009, 71.85406764413669, 69.17481916505344, 16.220654559082863, 82.67464346074956, 54.88464781895127, 149.0452344703959, 85.05170701639402, 61.64654055235777, 6.308513636455049, 122.72811266075166, 9.76569171381375, 28.196503312525255, 11.990037592432142, 39.59465245581429, 93.77925190682629, 173.417858483239, 6.14133330985798, 15.762281811455798, 134.36623570047647, 76.06028203580479, 74.22850676175635, 34.695476680536935, 159.6621907988072, 167.2233660646181, 158.99304802466287, 125.23519084767717, 31.268484989044566, 88.54768969882797, 57.09944401112018, 170.03924007813922, 8.135051974358213, 21.451638560862875, 76.27928161334323, 145.09089770133772, 0.7242794915378635, 119.58478321201947, 55.07339965509877, 101.30347201003724, 267.44746563530987, 25.72851731642294, 50.2482358311191, 10.105741511511418, 193.0090328936931, 242.16798791533478, 39.648464187783205, 159.3499139561802, 28.118359652455005, 62.6282279289202, 164.83895649669932, 73.18508403053936, 110.16493654962441, 168.40666761692708, 267.8603886072499, 213.90796331236706, 124.17924132120368, 231.43704446725934, 63.34348446791769, 164.82322943616253, 100.95781545605833, 192.6461275375021, 19.887349329554755, 38.363775037738804, 35.81596858271153, 113.3458349053624, 230.7853915479533, 54.85288701360539, 39.375153673344265, 203.76325915064663, 1.2486882150991712, 111.99514158105654, 174.21926844518845, 10.863772486422565, 246.3828621771652, 23.366795255903288, 1.686513537743613, 3.0493282149260565, 143.97200227841205, 11.169618052507685, 151.88844071902219, 78.45110531031017, 178.76726219687225, 5.491533832319006, 183.23617029079, 53.44679168121165, 100.62718867369004, 51.62880880817706, 4.512686208328209, 171.62334218999183, 202.77443414774723, 128.4407517753692, 43.32782179174049, 246.32318803637418, 132.52041148399576, 85.60806980806116, 98.80891037849513, 185.52092658311363, 103.72089663179854]}, "sampler_perf": {"mean_raw_obs_processing_ms": 24.612889016885457, "mean_inference_ms": 21.186329230406663, "mean_action_processing_ms": 5.908154806035579, "mean_env_wait_ms": 37.33530745612723, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.09543001651763916, "StateBufferConnector_ms": 0.03673684597015381, "ViewRequirementAgentConnector_ms": 1.255206823348999}, "num_episodes": 0, "episode_return_max": 286.6692231913454, "episode_return_min": -53.94695511723343, "episode_return_mean": 102.60472273081903, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 149312, "num_agent_steps_trained": 149312, "num_env_steps_sampled": 37328, "num_env_steps_trained": 37328, "num_env_steps_sampled_this_iter": 0, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 0.0, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 37328, "num_env_steps_sampled_lifetime": 37328, "num_agent_steps_sampled_lifetime": 149312, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 149312, "timers": {"training_iteration_time_ms": 61673.1, "restore_workers_time_ms": 32.877, "training_step_time_ms": 61597.31, "sample_time_ms": 61578.618, "learn_time_ms": 311236.026, "learn_throughput": 59.967, "synch_weights_time_ms": 43.334}, "counters": {"num_env_steps_sampled": 37328, "num_env_steps_trained": 37328, "num_agent_steps_sampled": 149312, "num_agent_steps_trained": 149312}, "done": false, "training_iteration": 51, "trial_id": "d7bca_00000", "date": "2024-08-20_12-57-32", "timestamp": 1724138852, "time_this_iter_s": 123.93812990188599, "time_total_s": 7402.2201628685, "pid": 36059, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 16000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x32cf66dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 7402.2201628685, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 96.96589595375721, "ram_util_percent": 83.61213872832371}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {}, "num_env_steps_sampled": 37328, "num_env_steps_trained": 37328, "num_agent_steps_sampled": 149312, "num_agent_steps_trained": 149312}, "env_runners": {"episode_reward_max": 286.6692231913454, "episode_reward_min": -53.94695511723343, "episode_reward_mean": 102.60472273081903, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -382.5350217575324, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 179.13622751357744, "predator_policy": 388.3350217575325}, "policy_reward_mean": {"prey_policy": -50.61742331228365, "predator_policy": 101.91978467769317}, "custom_metrics": {}, "hist_stats": {"episode_reward": [35.10000000000023, -2.2956613079459616, 52.30000000000035, 93.99999999999946, 41.27668545957155, 138.35998813581944, 47.000000000000355, 189.59999999999982, 46.100000000000314, 122.59999999999911, 172.99184762314727, 183.89999999999952, 165.26660970450598, 63.400000000000325, 224.23591029611316, 118.26513246444676, 57.049342065984625, 56.287512516221504, 91.49999999999856, 77.70000000000017, 286.6692231913454, 34.20000000000022, 135.4999999999999, 189.7622134181783, 204.95900501687956, 41.46117592104707, 160.52089757879483, 41.90000000000027, 159.99999999999952, 56.25035590474681, 189.40904152072758, 32.4000000000002, 135.49999999999923, 137.09999999999957, -53.94695511723343, 170.90494465410117, 56.10000000000025, 60.20000000000013, 34.75612756781972, 43.60000000000028, 40.265044310772325, 47.1298862953699, 48.40000000000023, 36.202116310375594, 74.49999999999962, 153.19999999999987, 40.1000000000002, 131.19999999999982, 52.570622032848895, 56.000000000000156, 129.1999999999993, 86.20000000000002, 28.831075919194078, 160.79999999999959, 81.33852172443821, 103.01543537877356, 169.88064982359512, 48.30000000000023, 52.529310579969625, 48.028025438635616, 198.59999999999948, 184.470358209413, 37.06861395355878, 80.95181844992561, 33.900000000000134, 135.39999999999944, 148.89999999999955, 133.69999999999916, 226.89999999999938, 68.3000000000002, 154.45814550558052, 41.47674734270453, 180.74087067540847, 60.139037304427255, 153.66325386820998, 109.81254335834268, 96.80000000000011, 108.61895163315396, 159.3546697445331, 53.10000000000013, 125.29999999999959, 34.93780403323022, 139.0999999999999, 206.80167211533725, 40.50000000000029, 68.40000000000009, 88.29999999999927, 242.69999999999993, 37.700000000000266, 104.09999999999903, 229.34134979067687, 152.6250807412044, 157.8592262743011, 37.26670789146122, 35.20000000000023, 108.04468364708873, 87.5999999999994, 92.41177405235972, 131.94864151087714, 94.40623855187317], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [13.573129738316304, -53.54665936669982, -254.04609845621002, -260.27960040372835, -140.65478211067654, -73.1171426718985, 39.583255312047925, -34.03651010327775, -114.83317908671795, -92.66853807147267, -96.4272326280199, 93.09870255859556, -64.80740741555226, 20.000000000000014, 20.626642410773584, -16.792242611230414, 18.848497587615384, -92.85980597895414, 69.17606926139403, -109.36249015041209, -285.2321358475945, 105.74800812423979, 132.7888944272447, -19.35385941243218, -25.356623210719427, 11.326871936077456, -78.03601550180139, -20.07740583328924, 28.904313331271958, 85.71002709904536, -84.17058524148602, -101.59193807470932, -247.8691803256373, -34.87488956710395, -49.40531904969436, -141.19228141836533, -107.134889946308, 73.87102816456981, 4.171128342528487, -6.373188196460497, 72.0443042732162, -52.54708787865346, -32.67477650531073, -33.11217620680012, 17.408091439294907, -110.92817899556306, 80.28766474857159, -53.604483480981195, 64.90005398718623, -328.3984316256627, -221.37365036394135, -15.540567450569034, -217.97172194166885, 76.83739839192134, -62.4215290072797, -67.19987230581766, 82.82590198976501, -215.4723347673664, -63.01766150909464, -253.83034574412602, -72.05610867549865, 89.36722870345912, -103.9034532802869, -142.29070810227037, 0.5594712651248201, 21.887655692545323, -382.5350217575324, 117.78599718266575, -341.68754507993606, -271.3757928143444, 42.05974767402415, -113.91576456218526, 10.584749159468316, -368.0370289653096, -96.60173288891873, 6.578081936680414, -116.41208622158636, -38.927412945968925, -335.88260364800084, 33.30132488528524, -27.102952922490367, -70.03840438982733, -11.808869660467748, -17.067235360537826, 10.174001800704053, -2.962232113254194, -5.251613856427011, -54.123434986458186, -77.75098136410048, -19.99080009629646, 33.88040540161318, 40.0118549587175, 18.203034292193653, -101.55435256341609, 84.66934503983893, -118.51718584134521, -111.25275039532056, -35.27706169307365, 12.962713255211035, -154.80174341253127, -108.368940102753, 45.92361009447094, 66.26530936409696, -54.85406764413665, -50.32982812857711, -6.234569676365133, 43.52535653925046, -20.284647818951065, -122.72911794687963, -30.02930181547257, 64.88866316909824, -29.828281979136015, 27.845266783971347, 9.541578665059246, 1.103496687474779, 7.009962407567832, -8.299879170194934, -72.54471461247661, -97.58563081684744, -33.94553553761412, 161.42330774007206, -112.95182525200485, -6.1055308568346724, 40.28710026868663, -159.2584299113319, 1.9693763855458568, -203.51123731867187, -41.75335832068283, -112.73519084767737, -9.86848498904447, -75.14768969882805, 64.9005559888798, -41.26096743109789, 11.98667537860044, 89.1022150662958, -53.133135240501986, -21.790897701337713, 102.87572050846154, -103.60518017643587, -2.753002690682439, -77.5059788586302, -136.78681328113666, -35.26167272819433, 0.7616669233566751, 99.3892737675306, -121.76317749732668, -221.41484542454427, -0.26256937414734516, -81.64046493632515, 47.835445195899766, 41.62225202827415, -159.27689309555132, 8.414915969460758, -94.96493654962522, -101.89030278114168, -225.75780180988139, 42.3879814213417, -221.12051631037914, -194.2370444672595, -47.443484467917465, -68.94976936260595, -71.53127552961595, -175.21866179031935, -2.377011043507998, 7.336224962261236, 57.5840314172886, 148.94400313475802, -286.27355747273646, -38.05288701360526, -15.675153673344045, -157.06325915064687, 20.451311784900852, -34.19514158105644, -163.71926844518902, 179.13622751357744, -193.68286217716528, -5.466795255903271, 18.11348646225638, 73.35067178507347, -116.27200227841195, 81.3532898949211, -15.069998875773695, -1.5790888906085807, -103.01419787536915, 39.20269946596015, -70.07117731476804, -109.82064133551206, -6.986631127929058, -36.128808808176835, 15.187313791671755, -14.673585565722401, -251.67950712492743, 6.628822658497688, -90.79739622560763, -223.17849208443, -63.253333383580255, -19.653256456869457, -32.815082218808726, 25.002451968907792, -219.83803663194715], "policy_predator_policy_reward": [5.826870261683667, 69.24665936669969, 324.2059226722713, 187.82411487972215, 153.05478211067583, 113.01714267189817, 17.61674468795218, 70.83651010327776, 56.871368154986286, 191.90703446277513, 141.68851820524378, 0.0, 91.80740741555158, 0.0, 54.17335758922649, 131.5922426112305, 1.0515024123846184, 119.05980597895365, 36.62393073860571, 126.16249015041168, 294.04458931930264, 58.43138602720072, 27.098306487098423, 43.366658498089144, 101.5982771707111, 77.69808380843789, 92.33601550180148, 69.17740583328944, 11.711242094735995, 97.91032777106007, 159.598841430636, 144.42881435000547, 256.62014258831397, 83.17326937041157, 64.7437860571049, 182.14132692717635, 121.33488994630724, 3.428971835429686, 17.92887165747148, 61.97318819646065, 71.37501564844887, 195.79699114833366, 50.574776505310986, 49.41217620680031, 95.99190856070484, 133.02817899556257, 118.64992189155714, 44.429110259031575, 173.65858800042827, 294.7987946549283, 219.5255437438939, 58.84984999166302, 153.020176017792, 148.6350451107507, 84.92152900727922, 86.59987230581754, 35.917401426461, 256.72903135113984, 310.86582010807547, 62.23254304989086, 95.58973110505788, 76.50819038770996, 122.80345328028605, 155.79070810226966, 62.740528734875355, 50.312344307454744, 388.3350217575325, 13.51400281733393, 276.4934910271924, 282.6228917498557, 228.37632836739596, 14.384633174866076, 36.51525084053167, 377.03702896531087, 55.843560999739694, 94.38008995249868, 186.75715567238382, 3.338471062991101, 341.8826036480012, 4.298675114714987, 61.56155472910194, 75.84484689398705, 39.31993402285901, 36.68605729351662, 9.025998199295913, 32.16223211325439, 17.067987561023646, 78.50917759223691, 86.89305015310855, 85.34873130728765, 32.98846306649877, 46.31927657317061, 3.2969657078063443, 120.15435256341586, 51.96603493554656, 113.08180586595923, 51.82953263144456, 147.2709014897984, 28.814437033388117, 169.02459312393165, 122.3689401027523, 69.27638990552909, 2.934690635903009, 71.85406764413669, 69.17481916505344, 16.220654559082863, 82.67464346074956, 54.88464781895127, 149.0452344703959, 85.05170701639402, 61.64654055235777, 6.308513636455049, 122.72811266075166, 9.76569171381375, 28.196503312525255, 11.990037592432142, 39.59465245581429, 93.77925190682629, 173.417858483239, 6.14133330985798, 15.762281811455798, 134.36623570047647, 76.06028203580479, 74.22850676175635, 34.695476680536935, 159.6621907988072, 167.2233660646181, 158.99304802466287, 125.23519084767717, 31.268484989044566, 88.54768969882797, 57.09944401112018, 170.03924007813922, 8.135051974358213, 21.451638560862875, 76.27928161334323, 145.09089770133772, 0.7242794915378635, 119.58478321201947, 55.07339965509877, 101.30347201003724, 267.44746563530987, 25.72851731642294, 50.2482358311191, 10.105741511511418, 193.0090328936931, 242.16798791533478, 39.648464187783205, 159.3499139561802, 28.118359652455005, 62.6282279289202, 164.83895649669932, 73.18508403053936, 110.16493654962441, 168.40666761692708, 267.8603886072499, 213.90796331236706, 124.17924132120368, 231.43704446725934, 63.34348446791769, 164.82322943616253, 100.95781545605833, 192.6461275375021, 19.887349329554755, 38.363775037738804, 35.81596858271153, 113.3458349053624, 230.7853915479533, 54.85288701360539, 39.375153673344265, 203.76325915064663, 1.2486882150991712, 111.99514158105654, 174.21926844518845, 10.863772486422565, 246.3828621771652, 23.366795255903288, 1.686513537743613, 3.0493282149260565, 143.97200227841205, 11.169618052507685, 151.88844071902219, 78.45110531031017, 178.76726219687225, 5.491533832319006, 183.23617029079, 53.44679168121165, 100.62718867369004, 51.62880880817706, 4.512686208328209, 171.62334218999183, 202.77443414774723, 128.4407517753692, 43.32782179174049, 246.32318803637418, 132.52041148399576, 85.60806980806116, 98.80891037849513, 185.52092658311363, 103.72089663179854]}, "sampler_perf": {"mean_raw_obs_processing_ms": 24.612889016885457, "mean_inference_ms": 21.186329230406663, "mean_action_processing_ms": 5.908154806035579, "mean_env_wait_ms": 37.33530745612723, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.09543001651763916, "StateBufferConnector_ms": 0.03673684597015381, "ViewRequirementAgentConnector_ms": 1.255206823348999}, "num_episodes": 0, "episode_return_max": 286.6692231913454, "episode_return_min": -53.94695511723343, "episode_return_mean": 102.60472273081903, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 149312, "num_agent_steps_trained": 149312, "num_env_steps_sampled": 37328, "num_env_steps_trained": 37328, "num_env_steps_sampled_this_iter": 0, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 0.0, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 37328, "num_env_steps_sampled_lifetime": 37328, "num_agent_steps_sampled_lifetime": 149312, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 149312, "timers": {"training_iteration_time_ms": 61674.903, "restore_workers_time_ms": 35.306, "training_step_time_ms": 61591.025, "sample_time_ms": 61572.334, "learn_time_ms": 311236.026, "learn_throughput": 59.967, "synch_weights_time_ms": 43.334}, "counters": {"num_env_steps_sampled": 37328, "num_env_steps_trained": 37328, "num_agent_steps_sampled": 149312, "num_agent_steps_trained": 149312}, "done": false, "training_iteration": 52, "trial_id": "d7bca_00000", "date": "2024-08-20_12-59-39", "timestamp": 1724138979, "time_this_iter_s": 123.03507590293884, "time_total_s": 7525.255238771439, "pid": 36059, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 16000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x32cf61e50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 7525.255238771439, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 96.44682080924854, "ram_util_percent": 83.6520231213873}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {}, "num_env_steps_sampled": 37328, "num_env_steps_trained": 37328, "num_agent_steps_sampled": 149312, "num_agent_steps_trained": 149312}, "env_runners": {"episode_reward_max": 286.6692231913454, "episode_reward_min": -53.94695511723343, "episode_reward_mean": 102.60472273081903, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -382.5350217575324, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 179.13622751357744, "predator_policy": 388.3350217575325}, "policy_reward_mean": {"prey_policy": -50.61742331228365, "predator_policy": 101.91978467769317}, "custom_metrics": {}, "hist_stats": {"episode_reward": [35.10000000000023, -2.2956613079459616, 52.30000000000035, 93.99999999999946, 41.27668545957155, 138.35998813581944, 47.000000000000355, 189.59999999999982, 46.100000000000314, 122.59999999999911, 172.99184762314727, 183.89999999999952, 165.26660970450598, 63.400000000000325, 224.23591029611316, 118.26513246444676, 57.049342065984625, 56.287512516221504, 91.49999999999856, 77.70000000000017, 286.6692231913454, 34.20000000000022, 135.4999999999999, 189.7622134181783, 204.95900501687956, 41.46117592104707, 160.52089757879483, 41.90000000000027, 159.99999999999952, 56.25035590474681, 189.40904152072758, 32.4000000000002, 135.49999999999923, 137.09999999999957, -53.94695511723343, 170.90494465410117, 56.10000000000025, 60.20000000000013, 34.75612756781972, 43.60000000000028, 40.265044310772325, 47.1298862953699, 48.40000000000023, 36.202116310375594, 74.49999999999962, 153.19999999999987, 40.1000000000002, 131.19999999999982, 52.570622032848895, 56.000000000000156, 129.1999999999993, 86.20000000000002, 28.831075919194078, 160.79999999999959, 81.33852172443821, 103.01543537877356, 169.88064982359512, 48.30000000000023, 52.529310579969625, 48.028025438635616, 198.59999999999948, 184.470358209413, 37.06861395355878, 80.95181844992561, 33.900000000000134, 135.39999999999944, 148.89999999999955, 133.69999999999916, 226.89999999999938, 68.3000000000002, 154.45814550558052, 41.47674734270453, 180.74087067540847, 60.139037304427255, 153.66325386820998, 109.81254335834268, 96.80000000000011, 108.61895163315396, 159.3546697445331, 53.10000000000013, 125.29999999999959, 34.93780403323022, 139.0999999999999, 206.80167211533725, 40.50000000000029, 68.40000000000009, 88.29999999999927, 242.69999999999993, 37.700000000000266, 104.09999999999903, 229.34134979067687, 152.6250807412044, 157.8592262743011, 37.26670789146122, 35.20000000000023, 108.04468364708873, 87.5999999999994, 92.41177405235972, 131.94864151087714, 94.40623855187317], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [13.573129738316304, -53.54665936669982, -254.04609845621002, -260.27960040372835, -140.65478211067654, -73.1171426718985, 39.583255312047925, -34.03651010327775, -114.83317908671795, -92.66853807147267, -96.4272326280199, 93.09870255859556, -64.80740741555226, 20.000000000000014, 20.626642410773584, -16.792242611230414, 18.848497587615384, -92.85980597895414, 69.17606926139403, -109.36249015041209, -285.2321358475945, 105.74800812423979, 132.7888944272447, -19.35385941243218, -25.356623210719427, 11.326871936077456, -78.03601550180139, -20.07740583328924, 28.904313331271958, 85.71002709904536, -84.17058524148602, -101.59193807470932, -247.8691803256373, -34.87488956710395, -49.40531904969436, -141.19228141836533, -107.134889946308, 73.87102816456981, 4.171128342528487, -6.373188196460497, 72.0443042732162, -52.54708787865346, -32.67477650531073, -33.11217620680012, 17.408091439294907, -110.92817899556306, 80.28766474857159, -53.604483480981195, 64.90005398718623, -328.3984316256627, -221.37365036394135, -15.540567450569034, -217.97172194166885, 76.83739839192134, -62.4215290072797, -67.19987230581766, 82.82590198976501, -215.4723347673664, -63.01766150909464, -253.83034574412602, -72.05610867549865, 89.36722870345912, -103.9034532802869, -142.29070810227037, 0.5594712651248201, 21.887655692545323, -382.5350217575324, 117.78599718266575, -341.68754507993606, -271.3757928143444, 42.05974767402415, -113.91576456218526, 10.584749159468316, -368.0370289653096, -96.60173288891873, 6.578081936680414, -116.41208622158636, -38.927412945968925, -335.88260364800084, 33.30132488528524, -27.102952922490367, -70.03840438982733, -11.808869660467748, -17.067235360537826, 10.174001800704053, -2.962232113254194, -5.251613856427011, -54.123434986458186, -77.75098136410048, -19.99080009629646, 33.88040540161318, 40.0118549587175, 18.203034292193653, -101.55435256341609, 84.66934503983893, -118.51718584134521, -111.25275039532056, -35.27706169307365, 12.962713255211035, -154.80174341253127, -108.368940102753, 45.92361009447094, 66.26530936409696, -54.85406764413665, -50.32982812857711, -6.234569676365133, 43.52535653925046, -20.284647818951065, -122.72911794687963, -30.02930181547257, 64.88866316909824, -29.828281979136015, 27.845266783971347, 9.541578665059246, 1.103496687474779, 7.009962407567832, -8.299879170194934, -72.54471461247661, -97.58563081684744, -33.94553553761412, 161.42330774007206, -112.95182525200485, -6.1055308568346724, 40.28710026868663, -159.2584299113319, 1.9693763855458568, -203.51123731867187, -41.75335832068283, -112.73519084767737, -9.86848498904447, -75.14768969882805, 64.9005559888798, -41.26096743109789, 11.98667537860044, 89.1022150662958, -53.133135240501986, -21.790897701337713, 102.87572050846154, -103.60518017643587, -2.753002690682439, -77.5059788586302, -136.78681328113666, -35.26167272819433, 0.7616669233566751, 99.3892737675306, -121.76317749732668, -221.41484542454427, -0.26256937414734516, -81.64046493632515, 47.835445195899766, 41.62225202827415, -159.27689309555132, 8.414915969460758, -94.96493654962522, -101.89030278114168, -225.75780180988139, 42.3879814213417, -221.12051631037914, -194.2370444672595, -47.443484467917465, -68.94976936260595, -71.53127552961595, -175.21866179031935, -2.377011043507998, 7.336224962261236, 57.5840314172886, 148.94400313475802, -286.27355747273646, -38.05288701360526, -15.675153673344045, -157.06325915064687, 20.451311784900852, -34.19514158105644, -163.71926844518902, 179.13622751357744, -193.68286217716528, -5.466795255903271, 18.11348646225638, 73.35067178507347, -116.27200227841195, 81.3532898949211, -15.069998875773695, -1.5790888906085807, -103.01419787536915, 39.20269946596015, -70.07117731476804, -109.82064133551206, -6.986631127929058, -36.128808808176835, 15.187313791671755, -14.673585565722401, -251.67950712492743, 6.628822658497688, -90.79739622560763, -223.17849208443, -63.253333383580255, -19.653256456869457, -32.815082218808726, 25.002451968907792, -219.83803663194715], "policy_predator_policy_reward": [5.826870261683667, 69.24665936669969, 324.2059226722713, 187.82411487972215, 153.05478211067583, 113.01714267189817, 17.61674468795218, 70.83651010327776, 56.871368154986286, 191.90703446277513, 141.68851820524378, 0.0, 91.80740741555158, 0.0, 54.17335758922649, 131.5922426112305, 1.0515024123846184, 119.05980597895365, 36.62393073860571, 126.16249015041168, 294.04458931930264, 58.43138602720072, 27.098306487098423, 43.366658498089144, 101.5982771707111, 77.69808380843789, 92.33601550180148, 69.17740583328944, 11.711242094735995, 97.91032777106007, 159.598841430636, 144.42881435000547, 256.62014258831397, 83.17326937041157, 64.7437860571049, 182.14132692717635, 121.33488994630724, 3.428971835429686, 17.92887165747148, 61.97318819646065, 71.37501564844887, 195.79699114833366, 50.574776505310986, 49.41217620680031, 95.99190856070484, 133.02817899556257, 118.64992189155714, 44.429110259031575, 173.65858800042827, 294.7987946549283, 219.5255437438939, 58.84984999166302, 153.020176017792, 148.6350451107507, 84.92152900727922, 86.59987230581754, 35.917401426461, 256.72903135113984, 310.86582010807547, 62.23254304989086, 95.58973110505788, 76.50819038770996, 122.80345328028605, 155.79070810226966, 62.740528734875355, 50.312344307454744, 388.3350217575325, 13.51400281733393, 276.4934910271924, 282.6228917498557, 228.37632836739596, 14.384633174866076, 36.51525084053167, 377.03702896531087, 55.843560999739694, 94.38008995249868, 186.75715567238382, 3.338471062991101, 341.8826036480012, 4.298675114714987, 61.56155472910194, 75.84484689398705, 39.31993402285901, 36.68605729351662, 9.025998199295913, 32.16223211325439, 17.067987561023646, 78.50917759223691, 86.89305015310855, 85.34873130728765, 32.98846306649877, 46.31927657317061, 3.2969657078063443, 120.15435256341586, 51.96603493554656, 113.08180586595923, 51.82953263144456, 147.2709014897984, 28.814437033388117, 169.02459312393165, 122.3689401027523, 69.27638990552909, 2.934690635903009, 71.85406764413669, 69.17481916505344, 16.220654559082863, 82.67464346074956, 54.88464781895127, 149.0452344703959, 85.05170701639402, 61.64654055235777, 6.308513636455049, 122.72811266075166, 9.76569171381375, 28.196503312525255, 11.990037592432142, 39.59465245581429, 93.77925190682629, 173.417858483239, 6.14133330985798, 15.762281811455798, 134.36623570047647, 76.06028203580479, 74.22850676175635, 34.695476680536935, 159.6621907988072, 167.2233660646181, 158.99304802466287, 125.23519084767717, 31.268484989044566, 88.54768969882797, 57.09944401112018, 170.03924007813922, 8.135051974358213, 21.451638560862875, 76.27928161334323, 145.09089770133772, 0.7242794915378635, 119.58478321201947, 55.07339965509877, 101.30347201003724, 267.44746563530987, 25.72851731642294, 50.2482358311191, 10.105741511511418, 193.0090328936931, 242.16798791533478, 39.648464187783205, 159.3499139561802, 28.118359652455005, 62.6282279289202, 164.83895649669932, 73.18508403053936, 110.16493654962441, 168.40666761692708, 267.8603886072499, 213.90796331236706, 124.17924132120368, 231.43704446725934, 63.34348446791769, 164.82322943616253, 100.95781545605833, 192.6461275375021, 19.887349329554755, 38.363775037738804, 35.81596858271153, 113.3458349053624, 230.7853915479533, 54.85288701360539, 39.375153673344265, 203.76325915064663, 1.2486882150991712, 111.99514158105654, 174.21926844518845, 10.863772486422565, 246.3828621771652, 23.366795255903288, 1.686513537743613, 3.0493282149260565, 143.97200227841205, 11.169618052507685, 151.88844071902219, 78.45110531031017, 178.76726219687225, 5.491533832319006, 183.23617029079, 53.44679168121165, 100.62718867369004, 51.62880880817706, 4.512686208328209, 171.62334218999183, 202.77443414774723, 128.4407517753692, 43.32782179174049, 246.32318803637418, 132.52041148399576, 85.60806980806116, 98.80891037849513, 185.52092658311363, 103.72089663179854]}, "sampler_perf": {"mean_raw_obs_processing_ms": 24.612889016885457, "mean_inference_ms": 21.186329230406663, "mean_action_processing_ms": 5.908154806035579, "mean_env_wait_ms": 37.33530745612723, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.09543001651763916, "StateBufferConnector_ms": 0.03673684597015381, "ViewRequirementAgentConnector_ms": 1.255206823348999}, "num_episodes": 0, "episode_return_max": 286.6692231913454, "episode_return_min": -53.94695511723343, "episode_return_mean": 102.60472273081903, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 149312, "num_agent_steps_trained": 149312, "num_env_steps_sampled": 37328, "num_env_steps_trained": 37328, "num_env_steps_sampled_this_iter": 0, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 0.0, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 37328, "num_env_steps_sampled_lifetime": 37328, "num_agent_steps_sampled_lifetime": 149312, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 149312, "timers": {"training_iteration_time_ms": 61664.229, "restore_workers_time_ms": 32.59, "training_step_time_ms": 61584.489, "sample_time_ms": 61566.172, "learn_time_ms": 311236.026, "learn_throughput": 59.967, "synch_weights_time_ms": 43.334}, "counters": {"num_env_steps_sampled": 37328, "num_env_steps_trained": 37328, "num_agent_steps_sampled": 149312, "num_agent_steps_trained": 149312}, "done": false, "training_iteration": 53, "trial_id": "d7bca_00000", "date": "2024-08-20_13-01-44", "timestamp": 1724139104, "time_this_iter_s": 122.69166994094849, "time_total_s": 7647.946908712387, "pid": 36059, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 16000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x32cf6d040>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 7647.946908712387, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 97.43815028901734, "ram_util_percent": 83.63757225433528}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {}, "num_env_steps_sampled": 37328, "num_env_steps_trained": 37328, "num_agent_steps_sampled": 149312, "num_agent_steps_trained": 149312}, "env_runners": {"episode_reward_max": 286.6692231913454, "episode_reward_min": -53.94695511723343, "episode_reward_mean": 102.60472273081903, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -382.5350217575324, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 179.13622751357744, "predator_policy": 388.3350217575325}, "policy_reward_mean": {"prey_policy": -50.61742331228365, "predator_policy": 101.91978467769317}, "custom_metrics": {}, "hist_stats": {"episode_reward": [35.10000000000023, -2.2956613079459616, 52.30000000000035, 93.99999999999946, 41.27668545957155, 138.35998813581944, 47.000000000000355, 189.59999999999982, 46.100000000000314, 122.59999999999911, 172.99184762314727, 183.89999999999952, 165.26660970450598, 63.400000000000325, 224.23591029611316, 118.26513246444676, 57.049342065984625, 56.287512516221504, 91.49999999999856, 77.70000000000017, 286.6692231913454, 34.20000000000022, 135.4999999999999, 189.7622134181783, 204.95900501687956, 41.46117592104707, 160.52089757879483, 41.90000000000027, 159.99999999999952, 56.25035590474681, 189.40904152072758, 32.4000000000002, 135.49999999999923, 137.09999999999957, -53.94695511723343, 170.90494465410117, 56.10000000000025, 60.20000000000013, 34.75612756781972, 43.60000000000028, 40.265044310772325, 47.1298862953699, 48.40000000000023, 36.202116310375594, 74.49999999999962, 153.19999999999987, 40.1000000000002, 131.19999999999982, 52.570622032848895, 56.000000000000156, 129.1999999999993, 86.20000000000002, 28.831075919194078, 160.79999999999959, 81.33852172443821, 103.01543537877356, 169.88064982359512, 48.30000000000023, 52.529310579969625, 48.028025438635616, 198.59999999999948, 184.470358209413, 37.06861395355878, 80.95181844992561, 33.900000000000134, 135.39999999999944, 148.89999999999955, 133.69999999999916, 226.89999999999938, 68.3000000000002, 154.45814550558052, 41.47674734270453, 180.74087067540847, 60.139037304427255, 153.66325386820998, 109.81254335834268, 96.80000000000011, 108.61895163315396, 159.3546697445331, 53.10000000000013, 125.29999999999959, 34.93780403323022, 139.0999999999999, 206.80167211533725, 40.50000000000029, 68.40000000000009, 88.29999999999927, 242.69999999999993, 37.700000000000266, 104.09999999999903, 229.34134979067687, 152.6250807412044, 157.8592262743011, 37.26670789146122, 35.20000000000023, 108.04468364708873, 87.5999999999994, 92.41177405235972, 131.94864151087714, 94.40623855187317], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [13.573129738316304, -53.54665936669982, -254.04609845621002, -260.27960040372835, -140.65478211067654, -73.1171426718985, 39.583255312047925, -34.03651010327775, -114.83317908671795, -92.66853807147267, -96.4272326280199, 93.09870255859556, -64.80740741555226, 20.000000000000014, 20.626642410773584, -16.792242611230414, 18.848497587615384, -92.85980597895414, 69.17606926139403, -109.36249015041209, -285.2321358475945, 105.74800812423979, 132.7888944272447, -19.35385941243218, -25.356623210719427, 11.326871936077456, -78.03601550180139, -20.07740583328924, 28.904313331271958, 85.71002709904536, -84.17058524148602, -101.59193807470932, -247.8691803256373, -34.87488956710395, -49.40531904969436, -141.19228141836533, -107.134889946308, 73.87102816456981, 4.171128342528487, -6.373188196460497, 72.0443042732162, -52.54708787865346, -32.67477650531073, -33.11217620680012, 17.408091439294907, -110.92817899556306, 80.28766474857159, -53.604483480981195, 64.90005398718623, -328.3984316256627, -221.37365036394135, -15.540567450569034, -217.97172194166885, 76.83739839192134, -62.4215290072797, -67.19987230581766, 82.82590198976501, -215.4723347673664, -63.01766150909464, -253.83034574412602, -72.05610867549865, 89.36722870345912, -103.9034532802869, -142.29070810227037, 0.5594712651248201, 21.887655692545323, -382.5350217575324, 117.78599718266575, -341.68754507993606, -271.3757928143444, 42.05974767402415, -113.91576456218526, 10.584749159468316, -368.0370289653096, -96.60173288891873, 6.578081936680414, -116.41208622158636, -38.927412945968925, -335.88260364800084, 33.30132488528524, -27.102952922490367, -70.03840438982733, -11.808869660467748, -17.067235360537826, 10.174001800704053, -2.962232113254194, -5.251613856427011, -54.123434986458186, -77.75098136410048, -19.99080009629646, 33.88040540161318, 40.0118549587175, 18.203034292193653, -101.55435256341609, 84.66934503983893, -118.51718584134521, -111.25275039532056, -35.27706169307365, 12.962713255211035, -154.80174341253127, -108.368940102753, 45.92361009447094, 66.26530936409696, -54.85406764413665, -50.32982812857711, -6.234569676365133, 43.52535653925046, -20.284647818951065, -122.72911794687963, -30.02930181547257, 64.88866316909824, -29.828281979136015, 27.845266783971347, 9.541578665059246, 1.103496687474779, 7.009962407567832, -8.299879170194934, -72.54471461247661, -97.58563081684744, -33.94553553761412, 161.42330774007206, -112.95182525200485, -6.1055308568346724, 40.28710026868663, -159.2584299113319, 1.9693763855458568, -203.51123731867187, -41.75335832068283, -112.73519084767737, -9.86848498904447, -75.14768969882805, 64.9005559888798, -41.26096743109789, 11.98667537860044, 89.1022150662958, -53.133135240501986, -21.790897701337713, 102.87572050846154, -103.60518017643587, -2.753002690682439, -77.5059788586302, -136.78681328113666, -35.26167272819433, 0.7616669233566751, 99.3892737675306, -121.76317749732668, -221.41484542454427, -0.26256937414734516, -81.64046493632515, 47.835445195899766, 41.62225202827415, -159.27689309555132, 8.414915969460758, -94.96493654962522, -101.89030278114168, -225.75780180988139, 42.3879814213417, -221.12051631037914, -194.2370444672595, -47.443484467917465, -68.94976936260595, -71.53127552961595, -175.21866179031935, -2.377011043507998, 7.336224962261236, 57.5840314172886, 148.94400313475802, -286.27355747273646, -38.05288701360526, -15.675153673344045, -157.06325915064687, 20.451311784900852, -34.19514158105644, -163.71926844518902, 179.13622751357744, -193.68286217716528, -5.466795255903271, 18.11348646225638, 73.35067178507347, -116.27200227841195, 81.3532898949211, -15.069998875773695, -1.5790888906085807, -103.01419787536915, 39.20269946596015, -70.07117731476804, -109.82064133551206, -6.986631127929058, -36.128808808176835, 15.187313791671755, -14.673585565722401, -251.67950712492743, 6.628822658497688, -90.79739622560763, -223.17849208443, -63.253333383580255, -19.653256456869457, -32.815082218808726, 25.002451968907792, -219.83803663194715], "policy_predator_policy_reward": [5.826870261683667, 69.24665936669969, 324.2059226722713, 187.82411487972215, 153.05478211067583, 113.01714267189817, 17.61674468795218, 70.83651010327776, 56.871368154986286, 191.90703446277513, 141.68851820524378, 0.0, 91.80740741555158, 0.0, 54.17335758922649, 131.5922426112305, 1.0515024123846184, 119.05980597895365, 36.62393073860571, 126.16249015041168, 294.04458931930264, 58.43138602720072, 27.098306487098423, 43.366658498089144, 101.5982771707111, 77.69808380843789, 92.33601550180148, 69.17740583328944, 11.711242094735995, 97.91032777106007, 159.598841430636, 144.42881435000547, 256.62014258831397, 83.17326937041157, 64.7437860571049, 182.14132692717635, 121.33488994630724, 3.428971835429686, 17.92887165747148, 61.97318819646065, 71.37501564844887, 195.79699114833366, 50.574776505310986, 49.41217620680031, 95.99190856070484, 133.02817899556257, 118.64992189155714, 44.429110259031575, 173.65858800042827, 294.7987946549283, 219.5255437438939, 58.84984999166302, 153.020176017792, 148.6350451107507, 84.92152900727922, 86.59987230581754, 35.917401426461, 256.72903135113984, 310.86582010807547, 62.23254304989086, 95.58973110505788, 76.50819038770996, 122.80345328028605, 155.79070810226966, 62.740528734875355, 50.312344307454744, 388.3350217575325, 13.51400281733393, 276.4934910271924, 282.6228917498557, 228.37632836739596, 14.384633174866076, 36.51525084053167, 377.03702896531087, 55.843560999739694, 94.38008995249868, 186.75715567238382, 3.338471062991101, 341.8826036480012, 4.298675114714987, 61.56155472910194, 75.84484689398705, 39.31993402285901, 36.68605729351662, 9.025998199295913, 32.16223211325439, 17.067987561023646, 78.50917759223691, 86.89305015310855, 85.34873130728765, 32.98846306649877, 46.31927657317061, 3.2969657078063443, 120.15435256341586, 51.96603493554656, 113.08180586595923, 51.82953263144456, 147.2709014897984, 28.814437033388117, 169.02459312393165, 122.3689401027523, 69.27638990552909, 2.934690635903009, 71.85406764413669, 69.17481916505344, 16.220654559082863, 82.67464346074956, 54.88464781895127, 149.0452344703959, 85.05170701639402, 61.64654055235777, 6.308513636455049, 122.72811266075166, 9.76569171381375, 28.196503312525255, 11.990037592432142, 39.59465245581429, 93.77925190682629, 173.417858483239, 6.14133330985798, 15.762281811455798, 134.36623570047647, 76.06028203580479, 74.22850676175635, 34.695476680536935, 159.6621907988072, 167.2233660646181, 158.99304802466287, 125.23519084767717, 31.268484989044566, 88.54768969882797, 57.09944401112018, 170.03924007813922, 8.135051974358213, 21.451638560862875, 76.27928161334323, 145.09089770133772, 0.7242794915378635, 119.58478321201947, 55.07339965509877, 101.30347201003724, 267.44746563530987, 25.72851731642294, 50.2482358311191, 10.105741511511418, 193.0090328936931, 242.16798791533478, 39.648464187783205, 159.3499139561802, 28.118359652455005, 62.6282279289202, 164.83895649669932, 73.18508403053936, 110.16493654962441, 168.40666761692708, 267.8603886072499, 213.90796331236706, 124.17924132120368, 231.43704446725934, 63.34348446791769, 164.82322943616253, 100.95781545605833, 192.6461275375021, 19.887349329554755, 38.363775037738804, 35.81596858271153, 113.3458349053624, 230.7853915479533, 54.85288701360539, 39.375153673344265, 203.76325915064663, 1.2486882150991712, 111.99514158105654, 174.21926844518845, 10.863772486422565, 246.3828621771652, 23.366795255903288, 1.686513537743613, 3.0493282149260565, 143.97200227841205, 11.169618052507685, 151.88844071902219, 78.45110531031017, 178.76726219687225, 5.491533832319006, 183.23617029079, 53.44679168121165, 100.62718867369004, 51.62880880817706, 4.512686208328209, 171.62334218999183, 202.77443414774723, 128.4407517753692, 43.32782179174049, 246.32318803637418, 132.52041148399576, 85.60806980806116, 98.80891037849513, 185.52092658311363, 103.72089663179854]}, "sampler_perf": {"mean_raw_obs_processing_ms": 24.612889016885457, "mean_inference_ms": 21.186329230406663, "mean_action_processing_ms": 5.908154806035579, "mean_env_wait_ms": 37.33530745612723, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.09543001651763916, "StateBufferConnector_ms": 0.03673684597015381, "ViewRequirementAgentConnector_ms": 1.255206823348999}, "num_episodes": 0, "episode_return_max": 286.6692231913454, "episode_return_min": -53.94695511723343, "episode_return_mean": 102.60472273081903, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 149312, "num_agent_steps_trained": 149312, "num_env_steps_sampled": 37328, "num_env_steps_trained": 37328, "num_env_steps_sampled_this_iter": 0, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 0.0, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 37328, "num_env_steps_sampled_lifetime": 37328, "num_agent_steps_sampled_lifetime": 149312, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 149312, "timers": {"training_iteration_time_ms": 61695.065, "restore_workers_time_ms": 30.04, "training_step_time_ms": 61616.597, "sample_time_ms": 61598.265, "learn_time_ms": 311236.026, "learn_throughput": 59.967, "synch_weights_time_ms": 43.334}, "counters": {"num_env_steps_sampled": 37328, "num_env_steps_trained": 37328, "num_agent_steps_sampled": 149312, "num_agent_steps_trained": 149312}, "done": false, "training_iteration": 54, "trial_id": "d7bca_00000", "date": "2024-08-20_13-03-50", "timestamp": 1724139230, "time_this_iter_s": 123.3739070892334, "time_total_s": 7771.3208158016205, "pid": 36059, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 16000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x32cf2fb80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 7771.3208158016205, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 96.1563953488372, "ram_util_percent": 83.74883720930234}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {}, "num_env_steps_sampled": 37328, "num_env_steps_trained": 37328, "num_agent_steps_sampled": 149312, "num_agent_steps_trained": 149312}, "env_runners": {"episode_reward_max": 286.6692231913454, "episode_reward_min": -53.94695511723343, "episode_reward_mean": 102.60472273081903, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -382.5350217575324, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 179.13622751357744, "predator_policy": 388.3350217575325}, "policy_reward_mean": {"prey_policy": -50.61742331228365, "predator_policy": 101.91978467769317}, "custom_metrics": {}, "hist_stats": {"episode_reward": [35.10000000000023, -2.2956613079459616, 52.30000000000035, 93.99999999999946, 41.27668545957155, 138.35998813581944, 47.000000000000355, 189.59999999999982, 46.100000000000314, 122.59999999999911, 172.99184762314727, 183.89999999999952, 165.26660970450598, 63.400000000000325, 224.23591029611316, 118.26513246444676, 57.049342065984625, 56.287512516221504, 91.49999999999856, 77.70000000000017, 286.6692231913454, 34.20000000000022, 135.4999999999999, 189.7622134181783, 204.95900501687956, 41.46117592104707, 160.52089757879483, 41.90000000000027, 159.99999999999952, 56.25035590474681, 189.40904152072758, 32.4000000000002, 135.49999999999923, 137.09999999999957, -53.94695511723343, 170.90494465410117, 56.10000000000025, 60.20000000000013, 34.75612756781972, 43.60000000000028, 40.265044310772325, 47.1298862953699, 48.40000000000023, 36.202116310375594, 74.49999999999962, 153.19999999999987, 40.1000000000002, 131.19999999999982, 52.570622032848895, 56.000000000000156, 129.1999999999993, 86.20000000000002, 28.831075919194078, 160.79999999999959, 81.33852172443821, 103.01543537877356, 169.88064982359512, 48.30000000000023, 52.529310579969625, 48.028025438635616, 198.59999999999948, 184.470358209413, 37.06861395355878, 80.95181844992561, 33.900000000000134, 135.39999999999944, 148.89999999999955, 133.69999999999916, 226.89999999999938, 68.3000000000002, 154.45814550558052, 41.47674734270453, 180.74087067540847, 60.139037304427255, 153.66325386820998, 109.81254335834268, 96.80000000000011, 108.61895163315396, 159.3546697445331, 53.10000000000013, 125.29999999999959, 34.93780403323022, 139.0999999999999, 206.80167211533725, 40.50000000000029, 68.40000000000009, 88.29999999999927, 242.69999999999993, 37.700000000000266, 104.09999999999903, 229.34134979067687, 152.6250807412044, 157.8592262743011, 37.26670789146122, 35.20000000000023, 108.04468364708873, 87.5999999999994, 92.41177405235972, 131.94864151087714, 94.40623855187317], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [13.573129738316304, -53.54665936669982, -254.04609845621002, -260.27960040372835, -140.65478211067654, -73.1171426718985, 39.583255312047925, -34.03651010327775, -114.83317908671795, -92.66853807147267, -96.4272326280199, 93.09870255859556, -64.80740741555226, 20.000000000000014, 20.626642410773584, -16.792242611230414, 18.848497587615384, -92.85980597895414, 69.17606926139403, -109.36249015041209, -285.2321358475945, 105.74800812423979, 132.7888944272447, -19.35385941243218, -25.356623210719427, 11.326871936077456, -78.03601550180139, -20.07740583328924, 28.904313331271958, 85.71002709904536, -84.17058524148602, -101.59193807470932, -247.8691803256373, -34.87488956710395, -49.40531904969436, -141.19228141836533, -107.134889946308, 73.87102816456981, 4.171128342528487, -6.373188196460497, 72.0443042732162, -52.54708787865346, -32.67477650531073, -33.11217620680012, 17.408091439294907, -110.92817899556306, 80.28766474857159, -53.604483480981195, 64.90005398718623, -328.3984316256627, -221.37365036394135, -15.540567450569034, -217.97172194166885, 76.83739839192134, -62.4215290072797, -67.19987230581766, 82.82590198976501, -215.4723347673664, -63.01766150909464, -253.83034574412602, -72.05610867549865, 89.36722870345912, -103.9034532802869, -142.29070810227037, 0.5594712651248201, 21.887655692545323, -382.5350217575324, 117.78599718266575, -341.68754507993606, -271.3757928143444, 42.05974767402415, -113.91576456218526, 10.584749159468316, -368.0370289653096, -96.60173288891873, 6.578081936680414, -116.41208622158636, -38.927412945968925, -335.88260364800084, 33.30132488528524, -27.102952922490367, -70.03840438982733, -11.808869660467748, -17.067235360537826, 10.174001800704053, -2.962232113254194, -5.251613856427011, -54.123434986458186, -77.75098136410048, -19.99080009629646, 33.88040540161318, 40.0118549587175, 18.203034292193653, -101.55435256341609, 84.66934503983893, -118.51718584134521, -111.25275039532056, -35.27706169307365, 12.962713255211035, -154.80174341253127, -108.368940102753, 45.92361009447094, 66.26530936409696, -54.85406764413665, -50.32982812857711, -6.234569676365133, 43.52535653925046, -20.284647818951065, -122.72911794687963, -30.02930181547257, 64.88866316909824, -29.828281979136015, 27.845266783971347, 9.541578665059246, 1.103496687474779, 7.009962407567832, -8.299879170194934, -72.54471461247661, -97.58563081684744, -33.94553553761412, 161.42330774007206, -112.95182525200485, -6.1055308568346724, 40.28710026868663, -159.2584299113319, 1.9693763855458568, -203.51123731867187, -41.75335832068283, -112.73519084767737, -9.86848498904447, -75.14768969882805, 64.9005559888798, -41.26096743109789, 11.98667537860044, 89.1022150662958, -53.133135240501986, -21.790897701337713, 102.87572050846154, -103.60518017643587, -2.753002690682439, -77.5059788586302, -136.78681328113666, -35.26167272819433, 0.7616669233566751, 99.3892737675306, -121.76317749732668, -221.41484542454427, -0.26256937414734516, -81.64046493632515, 47.835445195899766, 41.62225202827415, -159.27689309555132, 8.414915969460758, -94.96493654962522, -101.89030278114168, -225.75780180988139, 42.3879814213417, -221.12051631037914, -194.2370444672595, -47.443484467917465, -68.94976936260595, -71.53127552961595, -175.21866179031935, -2.377011043507998, 7.336224962261236, 57.5840314172886, 148.94400313475802, -286.27355747273646, -38.05288701360526, -15.675153673344045, -157.06325915064687, 20.451311784900852, -34.19514158105644, -163.71926844518902, 179.13622751357744, -193.68286217716528, -5.466795255903271, 18.11348646225638, 73.35067178507347, -116.27200227841195, 81.3532898949211, -15.069998875773695, -1.5790888906085807, -103.01419787536915, 39.20269946596015, -70.07117731476804, -109.82064133551206, -6.986631127929058, -36.128808808176835, 15.187313791671755, -14.673585565722401, -251.67950712492743, 6.628822658497688, -90.79739622560763, -223.17849208443, -63.253333383580255, -19.653256456869457, -32.815082218808726, 25.002451968907792, -219.83803663194715], "policy_predator_policy_reward": [5.826870261683667, 69.24665936669969, 324.2059226722713, 187.82411487972215, 153.05478211067583, 113.01714267189817, 17.61674468795218, 70.83651010327776, 56.871368154986286, 191.90703446277513, 141.68851820524378, 0.0, 91.80740741555158, 0.0, 54.17335758922649, 131.5922426112305, 1.0515024123846184, 119.05980597895365, 36.62393073860571, 126.16249015041168, 294.04458931930264, 58.43138602720072, 27.098306487098423, 43.366658498089144, 101.5982771707111, 77.69808380843789, 92.33601550180148, 69.17740583328944, 11.711242094735995, 97.91032777106007, 159.598841430636, 144.42881435000547, 256.62014258831397, 83.17326937041157, 64.7437860571049, 182.14132692717635, 121.33488994630724, 3.428971835429686, 17.92887165747148, 61.97318819646065, 71.37501564844887, 195.79699114833366, 50.574776505310986, 49.41217620680031, 95.99190856070484, 133.02817899556257, 118.64992189155714, 44.429110259031575, 173.65858800042827, 294.7987946549283, 219.5255437438939, 58.84984999166302, 153.020176017792, 148.6350451107507, 84.92152900727922, 86.59987230581754, 35.917401426461, 256.72903135113984, 310.86582010807547, 62.23254304989086, 95.58973110505788, 76.50819038770996, 122.80345328028605, 155.79070810226966, 62.740528734875355, 50.312344307454744, 388.3350217575325, 13.51400281733393, 276.4934910271924, 282.6228917498557, 228.37632836739596, 14.384633174866076, 36.51525084053167, 377.03702896531087, 55.843560999739694, 94.38008995249868, 186.75715567238382, 3.338471062991101, 341.8826036480012, 4.298675114714987, 61.56155472910194, 75.84484689398705, 39.31993402285901, 36.68605729351662, 9.025998199295913, 32.16223211325439, 17.067987561023646, 78.50917759223691, 86.89305015310855, 85.34873130728765, 32.98846306649877, 46.31927657317061, 3.2969657078063443, 120.15435256341586, 51.96603493554656, 113.08180586595923, 51.82953263144456, 147.2709014897984, 28.814437033388117, 169.02459312393165, 122.3689401027523, 69.27638990552909, 2.934690635903009, 71.85406764413669, 69.17481916505344, 16.220654559082863, 82.67464346074956, 54.88464781895127, 149.0452344703959, 85.05170701639402, 61.64654055235777, 6.308513636455049, 122.72811266075166, 9.76569171381375, 28.196503312525255, 11.990037592432142, 39.59465245581429, 93.77925190682629, 173.417858483239, 6.14133330985798, 15.762281811455798, 134.36623570047647, 76.06028203580479, 74.22850676175635, 34.695476680536935, 159.6621907988072, 167.2233660646181, 158.99304802466287, 125.23519084767717, 31.268484989044566, 88.54768969882797, 57.09944401112018, 170.03924007813922, 8.135051974358213, 21.451638560862875, 76.27928161334323, 145.09089770133772, 0.7242794915378635, 119.58478321201947, 55.07339965509877, 101.30347201003724, 267.44746563530987, 25.72851731642294, 50.2482358311191, 10.105741511511418, 193.0090328936931, 242.16798791533478, 39.648464187783205, 159.3499139561802, 28.118359652455005, 62.6282279289202, 164.83895649669932, 73.18508403053936, 110.16493654962441, 168.40666761692708, 267.8603886072499, 213.90796331236706, 124.17924132120368, 231.43704446725934, 63.34348446791769, 164.82322943616253, 100.95781545605833, 192.6461275375021, 19.887349329554755, 38.363775037738804, 35.81596858271153, 113.3458349053624, 230.7853915479533, 54.85288701360539, 39.375153673344265, 203.76325915064663, 1.2486882150991712, 111.99514158105654, 174.21926844518845, 10.863772486422565, 246.3828621771652, 23.366795255903288, 1.686513537743613, 3.0493282149260565, 143.97200227841205, 11.169618052507685, 151.88844071902219, 78.45110531031017, 178.76726219687225, 5.491533832319006, 183.23617029079, 53.44679168121165, 100.62718867369004, 51.62880880817706, 4.512686208328209, 171.62334218999183, 202.77443414774723, 128.4407517753692, 43.32782179174049, 246.32318803637418, 132.52041148399576, 85.60806980806116, 98.80891037849513, 185.52092658311363, 103.72089663179854]}, "sampler_perf": {"mean_raw_obs_processing_ms": 24.612889016885457, "mean_inference_ms": 21.186329230406663, "mean_action_processing_ms": 5.908154806035579, "mean_env_wait_ms": 37.33530745612723, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.09543001651763916, "StateBufferConnector_ms": 0.03673684597015381, "ViewRequirementAgentConnector_ms": 1.255206823348999}, "num_episodes": 0, "episode_return_max": 286.6692231913454, "episode_return_min": -53.94695511723343, "episode_return_mean": 102.60472273081903, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 149312, "num_agent_steps_trained": 149312, "num_env_steps_sampled": 37328, "num_env_steps_trained": 37328, "num_env_steps_sampled_this_iter": 0, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 0.0, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 37328, "num_env_steps_sampled_lifetime": 37328, "num_agent_steps_sampled_lifetime": 149312, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 149312, "timers": {"training_iteration_time_ms": 61671.836, "restore_workers_time_ms": 24.854, "training_step_time_ms": 61597.758, "sample_time_ms": 61579.084, "learn_time_ms": 311236.026, "learn_throughput": 59.967, "synch_weights_time_ms": 43.334}, "counters": {"num_env_steps_sampled": 37328, "num_env_steps_trained": 37328, "num_agent_steps_sampled": 149312, "num_agent_steps_trained": 149312}, "done": false, "training_iteration": 55, "trial_id": "d7bca_00000", "date": "2024-08-20_13-05-58", "timestamp": 1724139358, "time_this_iter_s": 123.65605592727661, "time_total_s": 7894.976871728897, "pid": 36059, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 16000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x32cf6d3a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 7894.976871728897, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 90.15168539325843, "ram_util_percent": 83.761797752809}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {}, "num_env_steps_sampled": 37328, "num_env_steps_trained": 37328, "num_agent_steps_sampled": 149312, "num_agent_steps_trained": 149312}, "env_runners": {"episode_reward_max": 286.6692231913454, "episode_reward_min": -53.94695511723343, "episode_reward_mean": 102.60472273081903, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -382.5350217575324, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 179.13622751357744, "predator_policy": 388.3350217575325}, "policy_reward_mean": {"prey_policy": -50.61742331228365, "predator_policy": 101.91978467769317}, "custom_metrics": {}, "hist_stats": {"episode_reward": [35.10000000000023, -2.2956613079459616, 52.30000000000035, 93.99999999999946, 41.27668545957155, 138.35998813581944, 47.000000000000355, 189.59999999999982, 46.100000000000314, 122.59999999999911, 172.99184762314727, 183.89999999999952, 165.26660970450598, 63.400000000000325, 224.23591029611316, 118.26513246444676, 57.049342065984625, 56.287512516221504, 91.49999999999856, 77.70000000000017, 286.6692231913454, 34.20000000000022, 135.4999999999999, 189.7622134181783, 204.95900501687956, 41.46117592104707, 160.52089757879483, 41.90000000000027, 159.99999999999952, 56.25035590474681, 189.40904152072758, 32.4000000000002, 135.49999999999923, 137.09999999999957, -53.94695511723343, 170.90494465410117, 56.10000000000025, 60.20000000000013, 34.75612756781972, 43.60000000000028, 40.265044310772325, 47.1298862953699, 48.40000000000023, 36.202116310375594, 74.49999999999962, 153.19999999999987, 40.1000000000002, 131.19999999999982, 52.570622032848895, 56.000000000000156, 129.1999999999993, 86.20000000000002, 28.831075919194078, 160.79999999999959, 81.33852172443821, 103.01543537877356, 169.88064982359512, 48.30000000000023, 52.529310579969625, 48.028025438635616, 198.59999999999948, 184.470358209413, 37.06861395355878, 80.95181844992561, 33.900000000000134, 135.39999999999944, 148.89999999999955, 133.69999999999916, 226.89999999999938, 68.3000000000002, 154.45814550558052, 41.47674734270453, 180.74087067540847, 60.139037304427255, 153.66325386820998, 109.81254335834268, 96.80000000000011, 108.61895163315396, 159.3546697445331, 53.10000000000013, 125.29999999999959, 34.93780403323022, 139.0999999999999, 206.80167211533725, 40.50000000000029, 68.40000000000009, 88.29999999999927, 242.69999999999993, 37.700000000000266, 104.09999999999903, 229.34134979067687, 152.6250807412044, 157.8592262743011, 37.26670789146122, 35.20000000000023, 108.04468364708873, 87.5999999999994, 92.41177405235972, 131.94864151087714, 94.40623855187317], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [13.573129738316304, -53.54665936669982, -254.04609845621002, -260.27960040372835, -140.65478211067654, -73.1171426718985, 39.583255312047925, -34.03651010327775, -114.83317908671795, -92.66853807147267, -96.4272326280199, 93.09870255859556, -64.80740741555226, 20.000000000000014, 20.626642410773584, -16.792242611230414, 18.848497587615384, -92.85980597895414, 69.17606926139403, -109.36249015041209, -285.2321358475945, 105.74800812423979, 132.7888944272447, -19.35385941243218, -25.356623210719427, 11.326871936077456, -78.03601550180139, -20.07740583328924, 28.904313331271958, 85.71002709904536, -84.17058524148602, -101.59193807470932, -247.8691803256373, -34.87488956710395, -49.40531904969436, -141.19228141836533, -107.134889946308, 73.87102816456981, 4.171128342528487, -6.373188196460497, 72.0443042732162, -52.54708787865346, -32.67477650531073, -33.11217620680012, 17.408091439294907, -110.92817899556306, 80.28766474857159, -53.604483480981195, 64.90005398718623, -328.3984316256627, -221.37365036394135, -15.540567450569034, -217.97172194166885, 76.83739839192134, -62.4215290072797, -67.19987230581766, 82.82590198976501, -215.4723347673664, -63.01766150909464, -253.83034574412602, -72.05610867549865, 89.36722870345912, -103.9034532802869, -142.29070810227037, 0.5594712651248201, 21.887655692545323, -382.5350217575324, 117.78599718266575, -341.68754507993606, -271.3757928143444, 42.05974767402415, -113.91576456218526, 10.584749159468316, -368.0370289653096, -96.60173288891873, 6.578081936680414, -116.41208622158636, -38.927412945968925, -335.88260364800084, 33.30132488528524, -27.102952922490367, -70.03840438982733, -11.808869660467748, -17.067235360537826, 10.174001800704053, -2.962232113254194, -5.251613856427011, -54.123434986458186, -77.75098136410048, -19.99080009629646, 33.88040540161318, 40.0118549587175, 18.203034292193653, -101.55435256341609, 84.66934503983893, -118.51718584134521, -111.25275039532056, -35.27706169307365, 12.962713255211035, -154.80174341253127, -108.368940102753, 45.92361009447094, 66.26530936409696, -54.85406764413665, -50.32982812857711, -6.234569676365133, 43.52535653925046, -20.284647818951065, -122.72911794687963, -30.02930181547257, 64.88866316909824, -29.828281979136015, 27.845266783971347, 9.541578665059246, 1.103496687474779, 7.009962407567832, -8.299879170194934, -72.54471461247661, -97.58563081684744, -33.94553553761412, 161.42330774007206, -112.95182525200485, -6.1055308568346724, 40.28710026868663, -159.2584299113319, 1.9693763855458568, -203.51123731867187, -41.75335832068283, -112.73519084767737, -9.86848498904447, -75.14768969882805, 64.9005559888798, -41.26096743109789, 11.98667537860044, 89.1022150662958, -53.133135240501986, -21.790897701337713, 102.87572050846154, -103.60518017643587, -2.753002690682439, -77.5059788586302, -136.78681328113666, -35.26167272819433, 0.7616669233566751, 99.3892737675306, -121.76317749732668, -221.41484542454427, -0.26256937414734516, -81.64046493632515, 47.835445195899766, 41.62225202827415, -159.27689309555132, 8.414915969460758, -94.96493654962522, -101.89030278114168, -225.75780180988139, 42.3879814213417, -221.12051631037914, -194.2370444672595, -47.443484467917465, -68.94976936260595, -71.53127552961595, -175.21866179031935, -2.377011043507998, 7.336224962261236, 57.5840314172886, 148.94400313475802, -286.27355747273646, -38.05288701360526, -15.675153673344045, -157.06325915064687, 20.451311784900852, -34.19514158105644, -163.71926844518902, 179.13622751357744, -193.68286217716528, -5.466795255903271, 18.11348646225638, 73.35067178507347, -116.27200227841195, 81.3532898949211, -15.069998875773695, -1.5790888906085807, -103.01419787536915, 39.20269946596015, -70.07117731476804, -109.82064133551206, -6.986631127929058, -36.128808808176835, 15.187313791671755, -14.673585565722401, -251.67950712492743, 6.628822658497688, -90.79739622560763, -223.17849208443, -63.253333383580255, -19.653256456869457, -32.815082218808726, 25.002451968907792, -219.83803663194715], "policy_predator_policy_reward": [5.826870261683667, 69.24665936669969, 324.2059226722713, 187.82411487972215, 153.05478211067583, 113.01714267189817, 17.61674468795218, 70.83651010327776, 56.871368154986286, 191.90703446277513, 141.68851820524378, 0.0, 91.80740741555158, 0.0, 54.17335758922649, 131.5922426112305, 1.0515024123846184, 119.05980597895365, 36.62393073860571, 126.16249015041168, 294.04458931930264, 58.43138602720072, 27.098306487098423, 43.366658498089144, 101.5982771707111, 77.69808380843789, 92.33601550180148, 69.17740583328944, 11.711242094735995, 97.91032777106007, 159.598841430636, 144.42881435000547, 256.62014258831397, 83.17326937041157, 64.7437860571049, 182.14132692717635, 121.33488994630724, 3.428971835429686, 17.92887165747148, 61.97318819646065, 71.37501564844887, 195.79699114833366, 50.574776505310986, 49.41217620680031, 95.99190856070484, 133.02817899556257, 118.64992189155714, 44.429110259031575, 173.65858800042827, 294.7987946549283, 219.5255437438939, 58.84984999166302, 153.020176017792, 148.6350451107507, 84.92152900727922, 86.59987230581754, 35.917401426461, 256.72903135113984, 310.86582010807547, 62.23254304989086, 95.58973110505788, 76.50819038770996, 122.80345328028605, 155.79070810226966, 62.740528734875355, 50.312344307454744, 388.3350217575325, 13.51400281733393, 276.4934910271924, 282.6228917498557, 228.37632836739596, 14.384633174866076, 36.51525084053167, 377.03702896531087, 55.843560999739694, 94.38008995249868, 186.75715567238382, 3.338471062991101, 341.8826036480012, 4.298675114714987, 61.56155472910194, 75.84484689398705, 39.31993402285901, 36.68605729351662, 9.025998199295913, 32.16223211325439, 17.067987561023646, 78.50917759223691, 86.89305015310855, 85.34873130728765, 32.98846306649877, 46.31927657317061, 3.2969657078063443, 120.15435256341586, 51.96603493554656, 113.08180586595923, 51.82953263144456, 147.2709014897984, 28.814437033388117, 169.02459312393165, 122.3689401027523, 69.27638990552909, 2.934690635903009, 71.85406764413669, 69.17481916505344, 16.220654559082863, 82.67464346074956, 54.88464781895127, 149.0452344703959, 85.05170701639402, 61.64654055235777, 6.308513636455049, 122.72811266075166, 9.76569171381375, 28.196503312525255, 11.990037592432142, 39.59465245581429, 93.77925190682629, 173.417858483239, 6.14133330985798, 15.762281811455798, 134.36623570047647, 76.06028203580479, 74.22850676175635, 34.695476680536935, 159.6621907988072, 167.2233660646181, 158.99304802466287, 125.23519084767717, 31.268484989044566, 88.54768969882797, 57.09944401112018, 170.03924007813922, 8.135051974358213, 21.451638560862875, 76.27928161334323, 145.09089770133772, 0.7242794915378635, 119.58478321201947, 55.07339965509877, 101.30347201003724, 267.44746563530987, 25.72851731642294, 50.2482358311191, 10.105741511511418, 193.0090328936931, 242.16798791533478, 39.648464187783205, 159.3499139561802, 28.118359652455005, 62.6282279289202, 164.83895649669932, 73.18508403053936, 110.16493654962441, 168.40666761692708, 267.8603886072499, 213.90796331236706, 124.17924132120368, 231.43704446725934, 63.34348446791769, 164.82322943616253, 100.95781545605833, 192.6461275375021, 19.887349329554755, 38.363775037738804, 35.81596858271153, 113.3458349053624, 230.7853915479533, 54.85288701360539, 39.375153673344265, 203.76325915064663, 1.2486882150991712, 111.99514158105654, 174.21926844518845, 10.863772486422565, 246.3828621771652, 23.366795255903288, 1.686513537743613, 3.0493282149260565, 143.97200227841205, 11.169618052507685, 151.88844071902219, 78.45110531031017, 178.76726219687225, 5.491533832319006, 183.23617029079, 53.44679168121165, 100.62718867369004, 51.62880880817706, 4.512686208328209, 171.62334218999183, 202.77443414774723, 128.4407517753692, 43.32782179174049, 246.32318803637418, 132.52041148399576, 85.60806980806116, 98.80891037849513, 185.52092658311363, 103.72089663179854]}, "sampler_perf": {"mean_raw_obs_processing_ms": 24.612889016885457, "mean_inference_ms": 21.186329230406663, "mean_action_processing_ms": 5.908154806035579, "mean_env_wait_ms": 37.33530745612723, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.09543001651763916, "StateBufferConnector_ms": 0.03673684597015381, "ViewRequirementAgentConnector_ms": 1.255206823348999}, "num_episodes": 0, "episode_return_max": 286.6692231913454, "episode_return_min": -53.94695511723343, "episode_return_mean": 102.60472273081903, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 149312, "num_agent_steps_trained": 149312, "num_env_steps_sampled": 37328, "num_env_steps_trained": 37328, "num_env_steps_sampled_this_iter": 0, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 0.0, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 37328, "num_env_steps_sampled_lifetime": 37328, "num_agent_steps_sampled_lifetime": 149312, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 149312, "timers": {"training_iteration_time_ms": 61666.982, "restore_workers_time_ms": 23.291, "training_step_time_ms": 61592.397, "sample_time_ms": 61572.009, "learn_time_ms": 311236.026, "learn_throughput": 59.967, "synch_weights_time_ms": 43.334}, "counters": {"num_env_steps_sampled": 37328, "num_env_steps_trained": 37328, "num_agent_steps_sampled": 149312, "num_agent_steps_trained": 149312}, "done": false, "training_iteration": 56, "trial_id": "d7bca_00000", "date": "2024-08-20_13-08-07", "timestamp": 1724139487, "time_this_iter_s": 123.07740807533264, "time_total_s": 8018.05427980423, "pid": 36059, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 16000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x32cf2f0d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 8018.05427980423, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 92.33559322033899, "ram_util_percent": 83.75141242937853}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {}, "num_env_steps_sampled": 37328, "num_env_steps_trained": 37328, "num_agent_steps_sampled": 149312, "num_agent_steps_trained": 149312}, "env_runners": {"episode_reward_max": 286.6692231913454, "episode_reward_min": -53.94695511723343, "episode_reward_mean": 102.60472273081903, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -382.5350217575324, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 179.13622751357744, "predator_policy": 388.3350217575325}, "policy_reward_mean": {"prey_policy": -50.61742331228365, "predator_policy": 101.91978467769317}, "custom_metrics": {}, "hist_stats": {"episode_reward": [35.10000000000023, -2.2956613079459616, 52.30000000000035, 93.99999999999946, 41.27668545957155, 138.35998813581944, 47.000000000000355, 189.59999999999982, 46.100000000000314, 122.59999999999911, 172.99184762314727, 183.89999999999952, 165.26660970450598, 63.400000000000325, 224.23591029611316, 118.26513246444676, 57.049342065984625, 56.287512516221504, 91.49999999999856, 77.70000000000017, 286.6692231913454, 34.20000000000022, 135.4999999999999, 189.7622134181783, 204.95900501687956, 41.46117592104707, 160.52089757879483, 41.90000000000027, 159.99999999999952, 56.25035590474681, 189.40904152072758, 32.4000000000002, 135.49999999999923, 137.09999999999957, -53.94695511723343, 170.90494465410117, 56.10000000000025, 60.20000000000013, 34.75612756781972, 43.60000000000028, 40.265044310772325, 47.1298862953699, 48.40000000000023, 36.202116310375594, 74.49999999999962, 153.19999999999987, 40.1000000000002, 131.19999999999982, 52.570622032848895, 56.000000000000156, 129.1999999999993, 86.20000000000002, 28.831075919194078, 160.79999999999959, 81.33852172443821, 103.01543537877356, 169.88064982359512, 48.30000000000023, 52.529310579969625, 48.028025438635616, 198.59999999999948, 184.470358209413, 37.06861395355878, 80.95181844992561, 33.900000000000134, 135.39999999999944, 148.89999999999955, 133.69999999999916, 226.89999999999938, 68.3000000000002, 154.45814550558052, 41.47674734270453, 180.74087067540847, 60.139037304427255, 153.66325386820998, 109.81254335834268, 96.80000000000011, 108.61895163315396, 159.3546697445331, 53.10000000000013, 125.29999999999959, 34.93780403323022, 139.0999999999999, 206.80167211533725, 40.50000000000029, 68.40000000000009, 88.29999999999927, 242.69999999999993, 37.700000000000266, 104.09999999999903, 229.34134979067687, 152.6250807412044, 157.8592262743011, 37.26670789146122, 35.20000000000023, 108.04468364708873, 87.5999999999994, 92.41177405235972, 131.94864151087714, 94.40623855187317], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [13.573129738316304, -53.54665936669982, -254.04609845621002, -260.27960040372835, -140.65478211067654, -73.1171426718985, 39.583255312047925, -34.03651010327775, -114.83317908671795, -92.66853807147267, -96.4272326280199, 93.09870255859556, -64.80740741555226, 20.000000000000014, 20.626642410773584, -16.792242611230414, 18.848497587615384, -92.85980597895414, 69.17606926139403, -109.36249015041209, -285.2321358475945, 105.74800812423979, 132.7888944272447, -19.35385941243218, -25.356623210719427, 11.326871936077456, -78.03601550180139, -20.07740583328924, 28.904313331271958, 85.71002709904536, -84.17058524148602, -101.59193807470932, -247.8691803256373, -34.87488956710395, -49.40531904969436, -141.19228141836533, -107.134889946308, 73.87102816456981, 4.171128342528487, -6.373188196460497, 72.0443042732162, -52.54708787865346, -32.67477650531073, -33.11217620680012, 17.408091439294907, -110.92817899556306, 80.28766474857159, -53.604483480981195, 64.90005398718623, -328.3984316256627, -221.37365036394135, -15.540567450569034, -217.97172194166885, 76.83739839192134, -62.4215290072797, -67.19987230581766, 82.82590198976501, -215.4723347673664, -63.01766150909464, -253.83034574412602, -72.05610867549865, 89.36722870345912, -103.9034532802869, -142.29070810227037, 0.5594712651248201, 21.887655692545323, -382.5350217575324, 117.78599718266575, -341.68754507993606, -271.3757928143444, 42.05974767402415, -113.91576456218526, 10.584749159468316, -368.0370289653096, -96.60173288891873, 6.578081936680414, -116.41208622158636, -38.927412945968925, -335.88260364800084, 33.30132488528524, -27.102952922490367, -70.03840438982733, -11.808869660467748, -17.067235360537826, 10.174001800704053, -2.962232113254194, -5.251613856427011, -54.123434986458186, -77.75098136410048, -19.99080009629646, 33.88040540161318, 40.0118549587175, 18.203034292193653, -101.55435256341609, 84.66934503983893, -118.51718584134521, -111.25275039532056, -35.27706169307365, 12.962713255211035, -154.80174341253127, -108.368940102753, 45.92361009447094, 66.26530936409696, -54.85406764413665, -50.32982812857711, -6.234569676365133, 43.52535653925046, -20.284647818951065, -122.72911794687963, -30.02930181547257, 64.88866316909824, -29.828281979136015, 27.845266783971347, 9.541578665059246, 1.103496687474779, 7.009962407567832, -8.299879170194934, -72.54471461247661, -97.58563081684744, -33.94553553761412, 161.42330774007206, -112.95182525200485, -6.1055308568346724, 40.28710026868663, -159.2584299113319, 1.9693763855458568, -203.51123731867187, -41.75335832068283, -112.73519084767737, -9.86848498904447, -75.14768969882805, 64.9005559888798, -41.26096743109789, 11.98667537860044, 89.1022150662958, -53.133135240501986, -21.790897701337713, 102.87572050846154, -103.60518017643587, -2.753002690682439, -77.5059788586302, -136.78681328113666, -35.26167272819433, 0.7616669233566751, 99.3892737675306, -121.76317749732668, -221.41484542454427, -0.26256937414734516, -81.64046493632515, 47.835445195899766, 41.62225202827415, -159.27689309555132, 8.414915969460758, -94.96493654962522, -101.89030278114168, -225.75780180988139, 42.3879814213417, -221.12051631037914, -194.2370444672595, -47.443484467917465, -68.94976936260595, -71.53127552961595, -175.21866179031935, -2.377011043507998, 7.336224962261236, 57.5840314172886, 148.94400313475802, -286.27355747273646, -38.05288701360526, -15.675153673344045, -157.06325915064687, 20.451311784900852, -34.19514158105644, -163.71926844518902, 179.13622751357744, -193.68286217716528, -5.466795255903271, 18.11348646225638, 73.35067178507347, -116.27200227841195, 81.3532898949211, -15.069998875773695, -1.5790888906085807, -103.01419787536915, 39.20269946596015, -70.07117731476804, -109.82064133551206, -6.986631127929058, -36.128808808176835, 15.187313791671755, -14.673585565722401, -251.67950712492743, 6.628822658497688, -90.79739622560763, -223.17849208443, -63.253333383580255, -19.653256456869457, -32.815082218808726, 25.002451968907792, -219.83803663194715], "policy_predator_policy_reward": [5.826870261683667, 69.24665936669969, 324.2059226722713, 187.82411487972215, 153.05478211067583, 113.01714267189817, 17.61674468795218, 70.83651010327776, 56.871368154986286, 191.90703446277513, 141.68851820524378, 0.0, 91.80740741555158, 0.0, 54.17335758922649, 131.5922426112305, 1.0515024123846184, 119.05980597895365, 36.62393073860571, 126.16249015041168, 294.04458931930264, 58.43138602720072, 27.098306487098423, 43.366658498089144, 101.5982771707111, 77.69808380843789, 92.33601550180148, 69.17740583328944, 11.711242094735995, 97.91032777106007, 159.598841430636, 144.42881435000547, 256.62014258831397, 83.17326937041157, 64.7437860571049, 182.14132692717635, 121.33488994630724, 3.428971835429686, 17.92887165747148, 61.97318819646065, 71.37501564844887, 195.79699114833366, 50.574776505310986, 49.41217620680031, 95.99190856070484, 133.02817899556257, 118.64992189155714, 44.429110259031575, 173.65858800042827, 294.7987946549283, 219.5255437438939, 58.84984999166302, 153.020176017792, 148.6350451107507, 84.92152900727922, 86.59987230581754, 35.917401426461, 256.72903135113984, 310.86582010807547, 62.23254304989086, 95.58973110505788, 76.50819038770996, 122.80345328028605, 155.79070810226966, 62.740528734875355, 50.312344307454744, 388.3350217575325, 13.51400281733393, 276.4934910271924, 282.6228917498557, 228.37632836739596, 14.384633174866076, 36.51525084053167, 377.03702896531087, 55.843560999739694, 94.38008995249868, 186.75715567238382, 3.338471062991101, 341.8826036480012, 4.298675114714987, 61.56155472910194, 75.84484689398705, 39.31993402285901, 36.68605729351662, 9.025998199295913, 32.16223211325439, 17.067987561023646, 78.50917759223691, 86.89305015310855, 85.34873130728765, 32.98846306649877, 46.31927657317061, 3.2969657078063443, 120.15435256341586, 51.96603493554656, 113.08180586595923, 51.82953263144456, 147.2709014897984, 28.814437033388117, 169.02459312393165, 122.3689401027523, 69.27638990552909, 2.934690635903009, 71.85406764413669, 69.17481916505344, 16.220654559082863, 82.67464346074956, 54.88464781895127, 149.0452344703959, 85.05170701639402, 61.64654055235777, 6.308513636455049, 122.72811266075166, 9.76569171381375, 28.196503312525255, 11.990037592432142, 39.59465245581429, 93.77925190682629, 173.417858483239, 6.14133330985798, 15.762281811455798, 134.36623570047647, 76.06028203580479, 74.22850676175635, 34.695476680536935, 159.6621907988072, 167.2233660646181, 158.99304802466287, 125.23519084767717, 31.268484989044566, 88.54768969882797, 57.09944401112018, 170.03924007813922, 8.135051974358213, 21.451638560862875, 76.27928161334323, 145.09089770133772, 0.7242794915378635, 119.58478321201947, 55.07339965509877, 101.30347201003724, 267.44746563530987, 25.72851731642294, 50.2482358311191, 10.105741511511418, 193.0090328936931, 242.16798791533478, 39.648464187783205, 159.3499139561802, 28.118359652455005, 62.6282279289202, 164.83895649669932, 73.18508403053936, 110.16493654962441, 168.40666761692708, 267.8603886072499, 213.90796331236706, 124.17924132120368, 231.43704446725934, 63.34348446791769, 164.82322943616253, 100.95781545605833, 192.6461275375021, 19.887349329554755, 38.363775037738804, 35.81596858271153, 113.3458349053624, 230.7853915479533, 54.85288701360539, 39.375153673344265, 203.76325915064663, 1.2486882150991712, 111.99514158105654, 174.21926844518845, 10.863772486422565, 246.3828621771652, 23.366795255903288, 1.686513537743613, 3.0493282149260565, 143.97200227841205, 11.169618052507685, 151.88844071902219, 78.45110531031017, 178.76726219687225, 5.491533832319006, 183.23617029079, 53.44679168121165, 100.62718867369004, 51.62880880817706, 4.512686208328209, 171.62334218999183, 202.77443414774723, 128.4407517753692, 43.32782179174049, 246.32318803637418, 132.52041148399576, 85.60806980806116, 98.80891037849513, 185.52092658311363, 103.72089663179854]}, "sampler_perf": {"mean_raw_obs_processing_ms": 24.612889016885457, "mean_inference_ms": 21.186329230406663, "mean_action_processing_ms": 5.908154806035579, "mean_env_wait_ms": 37.33530745612723, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.09543001651763916, "StateBufferConnector_ms": 0.03673684597015381, "ViewRequirementAgentConnector_ms": 1.255206823348999}, "num_episodes": 0, "episode_return_max": 286.6692231913454, "episode_return_min": -53.94695511723343, "episode_return_mean": 102.60472273081903, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 149312, "num_agent_steps_trained": 149312, "num_env_steps_sampled": 37328, "num_env_steps_trained": 37328, "num_env_steps_sampled_this_iter": 0, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 0.0, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 37328, "num_env_steps_sampled_lifetime": 37328, "num_agent_steps_sampled_lifetime": 149312, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 149312, "timers": {"training_iteration_time_ms": 61713.962, "restore_workers_time_ms": 25.108, "training_step_time_ms": 61632.835, "sample_time_ms": 61609.015, "learn_time_ms": 311236.026, "learn_throughput": 59.967, "synch_weights_time_ms": 43.334}, "counters": {"num_env_steps_sampled": 37328, "num_env_steps_trained": 37328, "num_agent_steps_sampled": 149312, "num_agent_steps_trained": 149312}, "done": false, "training_iteration": 57, "trial_id": "d7bca_00000", "date": "2024-08-20_13-10-14", "timestamp": 1724139614, "time_this_iter_s": 124.47743582725525, "time_total_s": 8142.531715631485, "pid": 36059, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 16000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x32cf5cc10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 8142.531715631485, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 93.71199999999999, "ram_util_percent": 83.72628571428572}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {}, "num_env_steps_sampled": 37328, "num_env_steps_trained": 37328, "num_agent_steps_sampled": 149312, "num_agent_steps_trained": 149312}, "env_runners": {"episode_reward_max": 286.6692231913454, "episode_reward_min": -53.94695511723343, "episode_reward_mean": 102.60472273081903, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -382.5350217575324, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 179.13622751357744, "predator_policy": 388.3350217575325}, "policy_reward_mean": {"prey_policy": -50.61742331228365, "predator_policy": 101.91978467769317}, "custom_metrics": {}, "hist_stats": {"episode_reward": [35.10000000000023, -2.2956613079459616, 52.30000000000035, 93.99999999999946, 41.27668545957155, 138.35998813581944, 47.000000000000355, 189.59999999999982, 46.100000000000314, 122.59999999999911, 172.99184762314727, 183.89999999999952, 165.26660970450598, 63.400000000000325, 224.23591029611316, 118.26513246444676, 57.049342065984625, 56.287512516221504, 91.49999999999856, 77.70000000000017, 286.6692231913454, 34.20000000000022, 135.4999999999999, 189.7622134181783, 204.95900501687956, 41.46117592104707, 160.52089757879483, 41.90000000000027, 159.99999999999952, 56.25035590474681, 189.40904152072758, 32.4000000000002, 135.49999999999923, 137.09999999999957, -53.94695511723343, 170.90494465410117, 56.10000000000025, 60.20000000000013, 34.75612756781972, 43.60000000000028, 40.265044310772325, 47.1298862953699, 48.40000000000023, 36.202116310375594, 74.49999999999962, 153.19999999999987, 40.1000000000002, 131.19999999999982, 52.570622032848895, 56.000000000000156, 129.1999999999993, 86.20000000000002, 28.831075919194078, 160.79999999999959, 81.33852172443821, 103.01543537877356, 169.88064982359512, 48.30000000000023, 52.529310579969625, 48.028025438635616, 198.59999999999948, 184.470358209413, 37.06861395355878, 80.95181844992561, 33.900000000000134, 135.39999999999944, 148.89999999999955, 133.69999999999916, 226.89999999999938, 68.3000000000002, 154.45814550558052, 41.47674734270453, 180.74087067540847, 60.139037304427255, 153.66325386820998, 109.81254335834268, 96.80000000000011, 108.61895163315396, 159.3546697445331, 53.10000000000013, 125.29999999999959, 34.93780403323022, 139.0999999999999, 206.80167211533725, 40.50000000000029, 68.40000000000009, 88.29999999999927, 242.69999999999993, 37.700000000000266, 104.09999999999903, 229.34134979067687, 152.6250807412044, 157.8592262743011, 37.26670789146122, 35.20000000000023, 108.04468364708873, 87.5999999999994, 92.41177405235972, 131.94864151087714, 94.40623855187317], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [13.573129738316304, -53.54665936669982, -254.04609845621002, -260.27960040372835, -140.65478211067654, -73.1171426718985, 39.583255312047925, -34.03651010327775, -114.83317908671795, -92.66853807147267, -96.4272326280199, 93.09870255859556, -64.80740741555226, 20.000000000000014, 20.626642410773584, -16.792242611230414, 18.848497587615384, -92.85980597895414, 69.17606926139403, -109.36249015041209, -285.2321358475945, 105.74800812423979, 132.7888944272447, -19.35385941243218, -25.356623210719427, 11.326871936077456, -78.03601550180139, -20.07740583328924, 28.904313331271958, 85.71002709904536, -84.17058524148602, -101.59193807470932, -247.8691803256373, -34.87488956710395, -49.40531904969436, -141.19228141836533, -107.134889946308, 73.87102816456981, 4.171128342528487, -6.373188196460497, 72.0443042732162, -52.54708787865346, -32.67477650531073, -33.11217620680012, 17.408091439294907, -110.92817899556306, 80.28766474857159, -53.604483480981195, 64.90005398718623, -328.3984316256627, -221.37365036394135, -15.540567450569034, -217.97172194166885, 76.83739839192134, -62.4215290072797, -67.19987230581766, 82.82590198976501, -215.4723347673664, -63.01766150909464, -253.83034574412602, -72.05610867549865, 89.36722870345912, -103.9034532802869, -142.29070810227037, 0.5594712651248201, 21.887655692545323, -382.5350217575324, 117.78599718266575, -341.68754507993606, -271.3757928143444, 42.05974767402415, -113.91576456218526, 10.584749159468316, -368.0370289653096, -96.60173288891873, 6.578081936680414, -116.41208622158636, -38.927412945968925, -335.88260364800084, 33.30132488528524, -27.102952922490367, -70.03840438982733, -11.808869660467748, -17.067235360537826, 10.174001800704053, -2.962232113254194, -5.251613856427011, -54.123434986458186, -77.75098136410048, -19.99080009629646, 33.88040540161318, 40.0118549587175, 18.203034292193653, -101.55435256341609, 84.66934503983893, -118.51718584134521, -111.25275039532056, -35.27706169307365, 12.962713255211035, -154.80174341253127, -108.368940102753, 45.92361009447094, 66.26530936409696, -54.85406764413665, -50.32982812857711, -6.234569676365133, 43.52535653925046, -20.284647818951065, -122.72911794687963, -30.02930181547257, 64.88866316909824, -29.828281979136015, 27.845266783971347, 9.541578665059246, 1.103496687474779, 7.009962407567832, -8.299879170194934, -72.54471461247661, -97.58563081684744, -33.94553553761412, 161.42330774007206, -112.95182525200485, -6.1055308568346724, 40.28710026868663, -159.2584299113319, 1.9693763855458568, -203.51123731867187, -41.75335832068283, -112.73519084767737, -9.86848498904447, -75.14768969882805, 64.9005559888798, -41.26096743109789, 11.98667537860044, 89.1022150662958, -53.133135240501986, -21.790897701337713, 102.87572050846154, -103.60518017643587, -2.753002690682439, -77.5059788586302, -136.78681328113666, -35.26167272819433, 0.7616669233566751, 99.3892737675306, -121.76317749732668, -221.41484542454427, -0.26256937414734516, -81.64046493632515, 47.835445195899766, 41.62225202827415, -159.27689309555132, 8.414915969460758, -94.96493654962522, -101.89030278114168, -225.75780180988139, 42.3879814213417, -221.12051631037914, -194.2370444672595, -47.443484467917465, -68.94976936260595, -71.53127552961595, -175.21866179031935, -2.377011043507998, 7.336224962261236, 57.5840314172886, 148.94400313475802, -286.27355747273646, -38.05288701360526, -15.675153673344045, -157.06325915064687, 20.451311784900852, -34.19514158105644, -163.71926844518902, 179.13622751357744, -193.68286217716528, -5.466795255903271, 18.11348646225638, 73.35067178507347, -116.27200227841195, 81.3532898949211, -15.069998875773695, -1.5790888906085807, -103.01419787536915, 39.20269946596015, -70.07117731476804, -109.82064133551206, -6.986631127929058, -36.128808808176835, 15.187313791671755, -14.673585565722401, -251.67950712492743, 6.628822658497688, -90.79739622560763, -223.17849208443, -63.253333383580255, -19.653256456869457, -32.815082218808726, 25.002451968907792, -219.83803663194715], "policy_predator_policy_reward": [5.826870261683667, 69.24665936669969, 324.2059226722713, 187.82411487972215, 153.05478211067583, 113.01714267189817, 17.61674468795218, 70.83651010327776, 56.871368154986286, 191.90703446277513, 141.68851820524378, 0.0, 91.80740741555158, 0.0, 54.17335758922649, 131.5922426112305, 1.0515024123846184, 119.05980597895365, 36.62393073860571, 126.16249015041168, 294.04458931930264, 58.43138602720072, 27.098306487098423, 43.366658498089144, 101.5982771707111, 77.69808380843789, 92.33601550180148, 69.17740583328944, 11.711242094735995, 97.91032777106007, 159.598841430636, 144.42881435000547, 256.62014258831397, 83.17326937041157, 64.7437860571049, 182.14132692717635, 121.33488994630724, 3.428971835429686, 17.92887165747148, 61.97318819646065, 71.37501564844887, 195.79699114833366, 50.574776505310986, 49.41217620680031, 95.99190856070484, 133.02817899556257, 118.64992189155714, 44.429110259031575, 173.65858800042827, 294.7987946549283, 219.5255437438939, 58.84984999166302, 153.020176017792, 148.6350451107507, 84.92152900727922, 86.59987230581754, 35.917401426461, 256.72903135113984, 310.86582010807547, 62.23254304989086, 95.58973110505788, 76.50819038770996, 122.80345328028605, 155.79070810226966, 62.740528734875355, 50.312344307454744, 388.3350217575325, 13.51400281733393, 276.4934910271924, 282.6228917498557, 228.37632836739596, 14.384633174866076, 36.51525084053167, 377.03702896531087, 55.843560999739694, 94.38008995249868, 186.75715567238382, 3.338471062991101, 341.8826036480012, 4.298675114714987, 61.56155472910194, 75.84484689398705, 39.31993402285901, 36.68605729351662, 9.025998199295913, 32.16223211325439, 17.067987561023646, 78.50917759223691, 86.89305015310855, 85.34873130728765, 32.98846306649877, 46.31927657317061, 3.2969657078063443, 120.15435256341586, 51.96603493554656, 113.08180586595923, 51.82953263144456, 147.2709014897984, 28.814437033388117, 169.02459312393165, 122.3689401027523, 69.27638990552909, 2.934690635903009, 71.85406764413669, 69.17481916505344, 16.220654559082863, 82.67464346074956, 54.88464781895127, 149.0452344703959, 85.05170701639402, 61.64654055235777, 6.308513636455049, 122.72811266075166, 9.76569171381375, 28.196503312525255, 11.990037592432142, 39.59465245581429, 93.77925190682629, 173.417858483239, 6.14133330985798, 15.762281811455798, 134.36623570047647, 76.06028203580479, 74.22850676175635, 34.695476680536935, 159.6621907988072, 167.2233660646181, 158.99304802466287, 125.23519084767717, 31.268484989044566, 88.54768969882797, 57.09944401112018, 170.03924007813922, 8.135051974358213, 21.451638560862875, 76.27928161334323, 145.09089770133772, 0.7242794915378635, 119.58478321201947, 55.07339965509877, 101.30347201003724, 267.44746563530987, 25.72851731642294, 50.2482358311191, 10.105741511511418, 193.0090328936931, 242.16798791533478, 39.648464187783205, 159.3499139561802, 28.118359652455005, 62.6282279289202, 164.83895649669932, 73.18508403053936, 110.16493654962441, 168.40666761692708, 267.8603886072499, 213.90796331236706, 124.17924132120368, 231.43704446725934, 63.34348446791769, 164.82322943616253, 100.95781545605833, 192.6461275375021, 19.887349329554755, 38.363775037738804, 35.81596858271153, 113.3458349053624, 230.7853915479533, 54.85288701360539, 39.375153673344265, 203.76325915064663, 1.2486882150991712, 111.99514158105654, 174.21926844518845, 10.863772486422565, 246.3828621771652, 23.366795255903288, 1.686513537743613, 3.0493282149260565, 143.97200227841205, 11.169618052507685, 151.88844071902219, 78.45110531031017, 178.76726219687225, 5.491533832319006, 183.23617029079, 53.44679168121165, 100.62718867369004, 51.62880880817706, 4.512686208328209, 171.62334218999183, 202.77443414774723, 128.4407517753692, 43.32782179174049, 246.32318803637418, 132.52041148399576, 85.60806980806116, 98.80891037849513, 185.52092658311363, 103.72089663179854]}, "sampler_perf": {"mean_raw_obs_processing_ms": 24.612889016885457, "mean_inference_ms": 21.186329230406663, "mean_action_processing_ms": 5.908154806035579, "mean_env_wait_ms": 37.33530745612723, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.09543001651763916, "StateBufferConnector_ms": 0.03673684597015381, "ViewRequirementAgentConnector_ms": 1.255206823348999}, "num_episodes": 0, "episode_return_max": 286.6692231913454, "episode_return_min": -53.94695511723343, "episode_return_mean": 102.60472273081903, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 149312, "num_agent_steps_trained": 149312, "num_env_steps_sampled": 37328, "num_env_steps_trained": 37328, "num_env_steps_sampled_this_iter": 0, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 0.0, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 37328, "num_env_steps_sampled_lifetime": 37328, "num_agent_steps_sampled_lifetime": 149312, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 149312, "timers": {"training_iteration_time_ms": 61726.928, "restore_workers_time_ms": 23.976, "training_step_time_ms": 61646.444, "sample_time_ms": 61623.01, "learn_time_ms": 311236.026, "learn_throughput": 59.967, "synch_weights_time_ms": 43.334}, "counters": {"num_env_steps_sampled": 37328, "num_env_steps_trained": 37328, "num_agent_steps_sampled": 149312, "num_agent_steps_trained": 149312}, "done": false, "training_iteration": 58, "trial_id": "d7bca_00000", "date": "2024-08-20_13-12-21", "timestamp": 1724139741, "time_this_iter_s": 123.30099892616272, "time_total_s": 8265.832714557648, "pid": 36059, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 16000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x32cf5c430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 8265.832714557648, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 93.25344827586208, "ram_util_percent": 83.60114942528737}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {}, "num_env_steps_sampled": 37328, "num_env_steps_trained": 37328, "num_agent_steps_sampled": 149312, "num_agent_steps_trained": 149312}, "env_runners": {"episode_reward_max": 286.6692231913454, "episode_reward_min": -53.94695511723343, "episode_reward_mean": 102.60472273081903, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -382.5350217575324, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 179.13622751357744, "predator_policy": 388.3350217575325}, "policy_reward_mean": {"prey_policy": -50.61742331228365, "predator_policy": 101.91978467769317}, "custom_metrics": {}, "hist_stats": {"episode_reward": [35.10000000000023, -2.2956613079459616, 52.30000000000035, 93.99999999999946, 41.27668545957155, 138.35998813581944, 47.000000000000355, 189.59999999999982, 46.100000000000314, 122.59999999999911, 172.99184762314727, 183.89999999999952, 165.26660970450598, 63.400000000000325, 224.23591029611316, 118.26513246444676, 57.049342065984625, 56.287512516221504, 91.49999999999856, 77.70000000000017, 286.6692231913454, 34.20000000000022, 135.4999999999999, 189.7622134181783, 204.95900501687956, 41.46117592104707, 160.52089757879483, 41.90000000000027, 159.99999999999952, 56.25035590474681, 189.40904152072758, 32.4000000000002, 135.49999999999923, 137.09999999999957, -53.94695511723343, 170.90494465410117, 56.10000000000025, 60.20000000000013, 34.75612756781972, 43.60000000000028, 40.265044310772325, 47.1298862953699, 48.40000000000023, 36.202116310375594, 74.49999999999962, 153.19999999999987, 40.1000000000002, 131.19999999999982, 52.570622032848895, 56.000000000000156, 129.1999999999993, 86.20000000000002, 28.831075919194078, 160.79999999999959, 81.33852172443821, 103.01543537877356, 169.88064982359512, 48.30000000000023, 52.529310579969625, 48.028025438635616, 198.59999999999948, 184.470358209413, 37.06861395355878, 80.95181844992561, 33.900000000000134, 135.39999999999944, 148.89999999999955, 133.69999999999916, 226.89999999999938, 68.3000000000002, 154.45814550558052, 41.47674734270453, 180.74087067540847, 60.139037304427255, 153.66325386820998, 109.81254335834268, 96.80000000000011, 108.61895163315396, 159.3546697445331, 53.10000000000013, 125.29999999999959, 34.93780403323022, 139.0999999999999, 206.80167211533725, 40.50000000000029, 68.40000000000009, 88.29999999999927, 242.69999999999993, 37.700000000000266, 104.09999999999903, 229.34134979067687, 152.6250807412044, 157.8592262743011, 37.26670789146122, 35.20000000000023, 108.04468364708873, 87.5999999999994, 92.41177405235972, 131.94864151087714, 94.40623855187317], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [13.573129738316304, -53.54665936669982, -254.04609845621002, -260.27960040372835, -140.65478211067654, -73.1171426718985, 39.583255312047925, -34.03651010327775, -114.83317908671795, -92.66853807147267, -96.4272326280199, 93.09870255859556, -64.80740741555226, 20.000000000000014, 20.626642410773584, -16.792242611230414, 18.848497587615384, -92.85980597895414, 69.17606926139403, -109.36249015041209, -285.2321358475945, 105.74800812423979, 132.7888944272447, -19.35385941243218, -25.356623210719427, 11.326871936077456, -78.03601550180139, -20.07740583328924, 28.904313331271958, 85.71002709904536, -84.17058524148602, -101.59193807470932, -247.8691803256373, -34.87488956710395, -49.40531904969436, -141.19228141836533, -107.134889946308, 73.87102816456981, 4.171128342528487, -6.373188196460497, 72.0443042732162, -52.54708787865346, -32.67477650531073, -33.11217620680012, 17.408091439294907, -110.92817899556306, 80.28766474857159, -53.604483480981195, 64.90005398718623, -328.3984316256627, -221.37365036394135, -15.540567450569034, -217.97172194166885, 76.83739839192134, -62.4215290072797, -67.19987230581766, 82.82590198976501, -215.4723347673664, -63.01766150909464, -253.83034574412602, -72.05610867549865, 89.36722870345912, -103.9034532802869, -142.29070810227037, 0.5594712651248201, 21.887655692545323, -382.5350217575324, 117.78599718266575, -341.68754507993606, -271.3757928143444, 42.05974767402415, -113.91576456218526, 10.584749159468316, -368.0370289653096, -96.60173288891873, 6.578081936680414, -116.41208622158636, -38.927412945968925, -335.88260364800084, 33.30132488528524, -27.102952922490367, -70.03840438982733, -11.808869660467748, -17.067235360537826, 10.174001800704053, -2.962232113254194, -5.251613856427011, -54.123434986458186, -77.75098136410048, -19.99080009629646, 33.88040540161318, 40.0118549587175, 18.203034292193653, -101.55435256341609, 84.66934503983893, -118.51718584134521, -111.25275039532056, -35.27706169307365, 12.962713255211035, -154.80174341253127, -108.368940102753, 45.92361009447094, 66.26530936409696, -54.85406764413665, -50.32982812857711, -6.234569676365133, 43.52535653925046, -20.284647818951065, -122.72911794687963, -30.02930181547257, 64.88866316909824, -29.828281979136015, 27.845266783971347, 9.541578665059246, 1.103496687474779, 7.009962407567832, -8.299879170194934, -72.54471461247661, -97.58563081684744, -33.94553553761412, 161.42330774007206, -112.95182525200485, -6.1055308568346724, 40.28710026868663, -159.2584299113319, 1.9693763855458568, -203.51123731867187, -41.75335832068283, -112.73519084767737, -9.86848498904447, -75.14768969882805, 64.9005559888798, -41.26096743109789, 11.98667537860044, 89.1022150662958, -53.133135240501986, -21.790897701337713, 102.87572050846154, -103.60518017643587, -2.753002690682439, -77.5059788586302, -136.78681328113666, -35.26167272819433, 0.7616669233566751, 99.3892737675306, -121.76317749732668, -221.41484542454427, -0.26256937414734516, -81.64046493632515, 47.835445195899766, 41.62225202827415, -159.27689309555132, 8.414915969460758, -94.96493654962522, -101.89030278114168, -225.75780180988139, 42.3879814213417, -221.12051631037914, -194.2370444672595, -47.443484467917465, -68.94976936260595, -71.53127552961595, -175.21866179031935, -2.377011043507998, 7.336224962261236, 57.5840314172886, 148.94400313475802, -286.27355747273646, -38.05288701360526, -15.675153673344045, -157.06325915064687, 20.451311784900852, -34.19514158105644, -163.71926844518902, 179.13622751357744, -193.68286217716528, -5.466795255903271, 18.11348646225638, 73.35067178507347, -116.27200227841195, 81.3532898949211, -15.069998875773695, -1.5790888906085807, -103.01419787536915, 39.20269946596015, -70.07117731476804, -109.82064133551206, -6.986631127929058, -36.128808808176835, 15.187313791671755, -14.673585565722401, -251.67950712492743, 6.628822658497688, -90.79739622560763, -223.17849208443, -63.253333383580255, -19.653256456869457, -32.815082218808726, 25.002451968907792, -219.83803663194715], "policy_predator_policy_reward": [5.826870261683667, 69.24665936669969, 324.2059226722713, 187.82411487972215, 153.05478211067583, 113.01714267189817, 17.61674468795218, 70.83651010327776, 56.871368154986286, 191.90703446277513, 141.68851820524378, 0.0, 91.80740741555158, 0.0, 54.17335758922649, 131.5922426112305, 1.0515024123846184, 119.05980597895365, 36.62393073860571, 126.16249015041168, 294.04458931930264, 58.43138602720072, 27.098306487098423, 43.366658498089144, 101.5982771707111, 77.69808380843789, 92.33601550180148, 69.17740583328944, 11.711242094735995, 97.91032777106007, 159.598841430636, 144.42881435000547, 256.62014258831397, 83.17326937041157, 64.7437860571049, 182.14132692717635, 121.33488994630724, 3.428971835429686, 17.92887165747148, 61.97318819646065, 71.37501564844887, 195.79699114833366, 50.574776505310986, 49.41217620680031, 95.99190856070484, 133.02817899556257, 118.64992189155714, 44.429110259031575, 173.65858800042827, 294.7987946549283, 219.5255437438939, 58.84984999166302, 153.020176017792, 148.6350451107507, 84.92152900727922, 86.59987230581754, 35.917401426461, 256.72903135113984, 310.86582010807547, 62.23254304989086, 95.58973110505788, 76.50819038770996, 122.80345328028605, 155.79070810226966, 62.740528734875355, 50.312344307454744, 388.3350217575325, 13.51400281733393, 276.4934910271924, 282.6228917498557, 228.37632836739596, 14.384633174866076, 36.51525084053167, 377.03702896531087, 55.843560999739694, 94.38008995249868, 186.75715567238382, 3.338471062991101, 341.8826036480012, 4.298675114714987, 61.56155472910194, 75.84484689398705, 39.31993402285901, 36.68605729351662, 9.025998199295913, 32.16223211325439, 17.067987561023646, 78.50917759223691, 86.89305015310855, 85.34873130728765, 32.98846306649877, 46.31927657317061, 3.2969657078063443, 120.15435256341586, 51.96603493554656, 113.08180586595923, 51.82953263144456, 147.2709014897984, 28.814437033388117, 169.02459312393165, 122.3689401027523, 69.27638990552909, 2.934690635903009, 71.85406764413669, 69.17481916505344, 16.220654559082863, 82.67464346074956, 54.88464781895127, 149.0452344703959, 85.05170701639402, 61.64654055235777, 6.308513636455049, 122.72811266075166, 9.76569171381375, 28.196503312525255, 11.990037592432142, 39.59465245581429, 93.77925190682629, 173.417858483239, 6.14133330985798, 15.762281811455798, 134.36623570047647, 76.06028203580479, 74.22850676175635, 34.695476680536935, 159.6621907988072, 167.2233660646181, 158.99304802466287, 125.23519084767717, 31.268484989044566, 88.54768969882797, 57.09944401112018, 170.03924007813922, 8.135051974358213, 21.451638560862875, 76.27928161334323, 145.09089770133772, 0.7242794915378635, 119.58478321201947, 55.07339965509877, 101.30347201003724, 267.44746563530987, 25.72851731642294, 50.2482358311191, 10.105741511511418, 193.0090328936931, 242.16798791533478, 39.648464187783205, 159.3499139561802, 28.118359652455005, 62.6282279289202, 164.83895649669932, 73.18508403053936, 110.16493654962441, 168.40666761692708, 267.8603886072499, 213.90796331236706, 124.17924132120368, 231.43704446725934, 63.34348446791769, 164.82322943616253, 100.95781545605833, 192.6461275375021, 19.887349329554755, 38.363775037738804, 35.81596858271153, 113.3458349053624, 230.7853915479533, 54.85288701360539, 39.375153673344265, 203.76325915064663, 1.2486882150991712, 111.99514158105654, 174.21926844518845, 10.863772486422565, 246.3828621771652, 23.366795255903288, 1.686513537743613, 3.0493282149260565, 143.97200227841205, 11.169618052507685, 151.88844071902219, 78.45110531031017, 178.76726219687225, 5.491533832319006, 183.23617029079, 53.44679168121165, 100.62718867369004, 51.62880880817706, 4.512686208328209, 171.62334218999183, 202.77443414774723, 128.4407517753692, 43.32782179174049, 246.32318803637418, 132.52041148399576, 85.60806980806116, 98.80891037849513, 185.52092658311363, 103.72089663179854]}, "sampler_perf": {"mean_raw_obs_processing_ms": 24.612889016885457, "mean_inference_ms": 21.186329230406663, "mean_action_processing_ms": 5.908154806035579, "mean_env_wait_ms": 37.33530745612723, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.09543001651763916, "StateBufferConnector_ms": 0.03673684597015381, "ViewRequirementAgentConnector_ms": 1.255206823348999}, "num_episodes": 0, "episode_return_max": 286.6692231913454, "episode_return_min": -53.94695511723343, "episode_return_mean": 102.60472273081903, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 149312, "num_agent_steps_trained": 149312, "num_env_steps_sampled": 37328, "num_env_steps_trained": 37328, "num_env_steps_sampled_this_iter": 0, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 0.0, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 37328, "num_env_steps_sampled_lifetime": 37328, "num_agent_steps_sampled_lifetime": 149312, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 149312, "timers": {"training_iteration_time_ms": 61783.982, "restore_workers_time_ms": 24.884, "training_step_time_ms": 61699.254, "sample_time_ms": 61674.713, "learn_time_ms": 311236.026, "learn_throughput": 59.967, "synch_weights_time_ms": 43.334}, "counters": {"num_env_steps_sampled": 37328, "num_env_steps_trained": 37328, "num_agent_steps_sampled": 149312, "num_agent_steps_trained": 149312}, "done": false, "training_iteration": 59, "trial_id": "d7bca_00000", "date": "2024-08-20_13-14-28", "timestamp": 1724139868, "time_this_iter_s": 123.64272689819336, "time_total_s": 8389.475441455841, "pid": 36059, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 16000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x32cf2f4c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 8389.475441455841, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 96.62774566473988, "ram_util_percent": 83.58150289017343}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {}, "num_env_steps_sampled": 37328, "num_env_steps_trained": 37328, "num_agent_steps_sampled": 149312, "num_agent_steps_trained": 149312}, "env_runners": {"episode_reward_max": 286.6692231913454, "episode_reward_min": -53.94695511723343, "episode_reward_mean": 102.60472273081903, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -382.5350217575324, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 179.13622751357744, "predator_policy": 388.3350217575325}, "policy_reward_mean": {"prey_policy": -50.61742331228365, "predator_policy": 101.91978467769317}, "custom_metrics": {}, "hist_stats": {"episode_reward": [35.10000000000023, -2.2956613079459616, 52.30000000000035, 93.99999999999946, 41.27668545957155, 138.35998813581944, 47.000000000000355, 189.59999999999982, 46.100000000000314, 122.59999999999911, 172.99184762314727, 183.89999999999952, 165.26660970450598, 63.400000000000325, 224.23591029611316, 118.26513246444676, 57.049342065984625, 56.287512516221504, 91.49999999999856, 77.70000000000017, 286.6692231913454, 34.20000000000022, 135.4999999999999, 189.7622134181783, 204.95900501687956, 41.46117592104707, 160.52089757879483, 41.90000000000027, 159.99999999999952, 56.25035590474681, 189.40904152072758, 32.4000000000002, 135.49999999999923, 137.09999999999957, -53.94695511723343, 170.90494465410117, 56.10000000000025, 60.20000000000013, 34.75612756781972, 43.60000000000028, 40.265044310772325, 47.1298862953699, 48.40000000000023, 36.202116310375594, 74.49999999999962, 153.19999999999987, 40.1000000000002, 131.19999999999982, 52.570622032848895, 56.000000000000156, 129.1999999999993, 86.20000000000002, 28.831075919194078, 160.79999999999959, 81.33852172443821, 103.01543537877356, 169.88064982359512, 48.30000000000023, 52.529310579969625, 48.028025438635616, 198.59999999999948, 184.470358209413, 37.06861395355878, 80.95181844992561, 33.900000000000134, 135.39999999999944, 148.89999999999955, 133.69999999999916, 226.89999999999938, 68.3000000000002, 154.45814550558052, 41.47674734270453, 180.74087067540847, 60.139037304427255, 153.66325386820998, 109.81254335834268, 96.80000000000011, 108.61895163315396, 159.3546697445331, 53.10000000000013, 125.29999999999959, 34.93780403323022, 139.0999999999999, 206.80167211533725, 40.50000000000029, 68.40000000000009, 88.29999999999927, 242.69999999999993, 37.700000000000266, 104.09999999999903, 229.34134979067687, 152.6250807412044, 157.8592262743011, 37.26670789146122, 35.20000000000023, 108.04468364708873, 87.5999999999994, 92.41177405235972, 131.94864151087714, 94.40623855187317], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [13.573129738316304, -53.54665936669982, -254.04609845621002, -260.27960040372835, -140.65478211067654, -73.1171426718985, 39.583255312047925, -34.03651010327775, -114.83317908671795, -92.66853807147267, -96.4272326280199, 93.09870255859556, -64.80740741555226, 20.000000000000014, 20.626642410773584, -16.792242611230414, 18.848497587615384, -92.85980597895414, 69.17606926139403, -109.36249015041209, -285.2321358475945, 105.74800812423979, 132.7888944272447, -19.35385941243218, -25.356623210719427, 11.326871936077456, -78.03601550180139, -20.07740583328924, 28.904313331271958, 85.71002709904536, -84.17058524148602, -101.59193807470932, -247.8691803256373, -34.87488956710395, -49.40531904969436, -141.19228141836533, -107.134889946308, 73.87102816456981, 4.171128342528487, -6.373188196460497, 72.0443042732162, -52.54708787865346, -32.67477650531073, -33.11217620680012, 17.408091439294907, -110.92817899556306, 80.28766474857159, -53.604483480981195, 64.90005398718623, -328.3984316256627, -221.37365036394135, -15.540567450569034, -217.97172194166885, 76.83739839192134, -62.4215290072797, -67.19987230581766, 82.82590198976501, -215.4723347673664, -63.01766150909464, -253.83034574412602, -72.05610867549865, 89.36722870345912, -103.9034532802869, -142.29070810227037, 0.5594712651248201, 21.887655692545323, -382.5350217575324, 117.78599718266575, -341.68754507993606, -271.3757928143444, 42.05974767402415, -113.91576456218526, 10.584749159468316, -368.0370289653096, -96.60173288891873, 6.578081936680414, -116.41208622158636, -38.927412945968925, -335.88260364800084, 33.30132488528524, -27.102952922490367, -70.03840438982733, -11.808869660467748, -17.067235360537826, 10.174001800704053, -2.962232113254194, -5.251613856427011, -54.123434986458186, -77.75098136410048, -19.99080009629646, 33.88040540161318, 40.0118549587175, 18.203034292193653, -101.55435256341609, 84.66934503983893, -118.51718584134521, -111.25275039532056, -35.27706169307365, 12.962713255211035, -154.80174341253127, -108.368940102753, 45.92361009447094, 66.26530936409696, -54.85406764413665, -50.32982812857711, -6.234569676365133, 43.52535653925046, -20.284647818951065, -122.72911794687963, -30.02930181547257, 64.88866316909824, -29.828281979136015, 27.845266783971347, 9.541578665059246, 1.103496687474779, 7.009962407567832, -8.299879170194934, -72.54471461247661, -97.58563081684744, -33.94553553761412, 161.42330774007206, -112.95182525200485, -6.1055308568346724, 40.28710026868663, -159.2584299113319, 1.9693763855458568, -203.51123731867187, -41.75335832068283, -112.73519084767737, -9.86848498904447, -75.14768969882805, 64.9005559888798, -41.26096743109789, 11.98667537860044, 89.1022150662958, -53.133135240501986, -21.790897701337713, 102.87572050846154, -103.60518017643587, -2.753002690682439, -77.5059788586302, -136.78681328113666, -35.26167272819433, 0.7616669233566751, 99.3892737675306, -121.76317749732668, -221.41484542454427, -0.26256937414734516, -81.64046493632515, 47.835445195899766, 41.62225202827415, -159.27689309555132, 8.414915969460758, -94.96493654962522, -101.89030278114168, -225.75780180988139, 42.3879814213417, -221.12051631037914, -194.2370444672595, -47.443484467917465, -68.94976936260595, -71.53127552961595, -175.21866179031935, -2.377011043507998, 7.336224962261236, 57.5840314172886, 148.94400313475802, -286.27355747273646, -38.05288701360526, -15.675153673344045, -157.06325915064687, 20.451311784900852, -34.19514158105644, -163.71926844518902, 179.13622751357744, -193.68286217716528, -5.466795255903271, 18.11348646225638, 73.35067178507347, -116.27200227841195, 81.3532898949211, -15.069998875773695, -1.5790888906085807, -103.01419787536915, 39.20269946596015, -70.07117731476804, -109.82064133551206, -6.986631127929058, -36.128808808176835, 15.187313791671755, -14.673585565722401, -251.67950712492743, 6.628822658497688, -90.79739622560763, -223.17849208443, -63.253333383580255, -19.653256456869457, -32.815082218808726, 25.002451968907792, -219.83803663194715], "policy_predator_policy_reward": [5.826870261683667, 69.24665936669969, 324.2059226722713, 187.82411487972215, 153.05478211067583, 113.01714267189817, 17.61674468795218, 70.83651010327776, 56.871368154986286, 191.90703446277513, 141.68851820524378, 0.0, 91.80740741555158, 0.0, 54.17335758922649, 131.5922426112305, 1.0515024123846184, 119.05980597895365, 36.62393073860571, 126.16249015041168, 294.04458931930264, 58.43138602720072, 27.098306487098423, 43.366658498089144, 101.5982771707111, 77.69808380843789, 92.33601550180148, 69.17740583328944, 11.711242094735995, 97.91032777106007, 159.598841430636, 144.42881435000547, 256.62014258831397, 83.17326937041157, 64.7437860571049, 182.14132692717635, 121.33488994630724, 3.428971835429686, 17.92887165747148, 61.97318819646065, 71.37501564844887, 195.79699114833366, 50.574776505310986, 49.41217620680031, 95.99190856070484, 133.02817899556257, 118.64992189155714, 44.429110259031575, 173.65858800042827, 294.7987946549283, 219.5255437438939, 58.84984999166302, 153.020176017792, 148.6350451107507, 84.92152900727922, 86.59987230581754, 35.917401426461, 256.72903135113984, 310.86582010807547, 62.23254304989086, 95.58973110505788, 76.50819038770996, 122.80345328028605, 155.79070810226966, 62.740528734875355, 50.312344307454744, 388.3350217575325, 13.51400281733393, 276.4934910271924, 282.6228917498557, 228.37632836739596, 14.384633174866076, 36.51525084053167, 377.03702896531087, 55.843560999739694, 94.38008995249868, 186.75715567238382, 3.338471062991101, 341.8826036480012, 4.298675114714987, 61.56155472910194, 75.84484689398705, 39.31993402285901, 36.68605729351662, 9.025998199295913, 32.16223211325439, 17.067987561023646, 78.50917759223691, 86.89305015310855, 85.34873130728765, 32.98846306649877, 46.31927657317061, 3.2969657078063443, 120.15435256341586, 51.96603493554656, 113.08180586595923, 51.82953263144456, 147.2709014897984, 28.814437033388117, 169.02459312393165, 122.3689401027523, 69.27638990552909, 2.934690635903009, 71.85406764413669, 69.17481916505344, 16.220654559082863, 82.67464346074956, 54.88464781895127, 149.0452344703959, 85.05170701639402, 61.64654055235777, 6.308513636455049, 122.72811266075166, 9.76569171381375, 28.196503312525255, 11.990037592432142, 39.59465245581429, 93.77925190682629, 173.417858483239, 6.14133330985798, 15.762281811455798, 134.36623570047647, 76.06028203580479, 74.22850676175635, 34.695476680536935, 159.6621907988072, 167.2233660646181, 158.99304802466287, 125.23519084767717, 31.268484989044566, 88.54768969882797, 57.09944401112018, 170.03924007813922, 8.135051974358213, 21.451638560862875, 76.27928161334323, 145.09089770133772, 0.7242794915378635, 119.58478321201947, 55.07339965509877, 101.30347201003724, 267.44746563530987, 25.72851731642294, 50.2482358311191, 10.105741511511418, 193.0090328936931, 242.16798791533478, 39.648464187783205, 159.3499139561802, 28.118359652455005, 62.6282279289202, 164.83895649669932, 73.18508403053936, 110.16493654962441, 168.40666761692708, 267.8603886072499, 213.90796331236706, 124.17924132120368, 231.43704446725934, 63.34348446791769, 164.82322943616253, 100.95781545605833, 192.6461275375021, 19.887349329554755, 38.363775037738804, 35.81596858271153, 113.3458349053624, 230.7853915479533, 54.85288701360539, 39.375153673344265, 203.76325915064663, 1.2486882150991712, 111.99514158105654, 174.21926844518845, 10.863772486422565, 246.3828621771652, 23.366795255903288, 1.686513537743613, 3.0493282149260565, 143.97200227841205, 11.169618052507685, 151.88844071902219, 78.45110531031017, 178.76726219687225, 5.491533832319006, 183.23617029079, 53.44679168121165, 100.62718867369004, 51.62880880817706, 4.512686208328209, 171.62334218999183, 202.77443414774723, 128.4407517753692, 43.32782179174049, 246.32318803637418, 132.52041148399576, 85.60806980806116, 98.80891037849513, 185.52092658311363, 103.72089663179854]}, "sampler_perf": {"mean_raw_obs_processing_ms": 24.612889016885457, "mean_inference_ms": 21.186329230406663, "mean_action_processing_ms": 5.908154806035579, "mean_env_wait_ms": 37.33530745612723, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.09543001651763916, "StateBufferConnector_ms": 0.03673684597015381, "ViewRequirementAgentConnector_ms": 1.255206823348999}, "num_episodes": 0, "episode_return_max": 286.6692231913454, "episode_return_min": -53.94695511723343, "episode_return_mean": 102.60472273081903, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 149312, "num_agent_steps_trained": 149312, "num_env_steps_sampled": 37328, "num_env_steps_trained": 37328, "num_env_steps_sampled_this_iter": 0, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 0.0, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 37328, "num_env_steps_sampled_lifetime": 37328, "num_agent_steps_sampled_lifetime": 149312, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 149312, "timers": {"training_iteration_time_ms": 61567.755, "restore_workers_time_ms": 20.574, "training_step_time_ms": 61495.907, "sample_time_ms": 61476.473, "learn_time_ms": 311236.026, "learn_throughput": 59.967, "synch_weights_time_ms": 43.334}, "counters": {"num_env_steps_sampled": 37328, "num_env_steps_trained": 37328, "num_agent_steps_sampled": 149312, "num_agent_steps_trained": 149312}, "done": false, "training_iteration": 60, "trial_id": "d7bca_00000", "date": "2024-08-20_13-16-34", "timestamp": 1724139994, "time_this_iter_s": 122.87137508392334, "time_total_s": 8512.346816539764, "pid": 36059, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 16000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x32cf5c5e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 8512.346816539764, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 95.62701149425288, "ram_util_percent": 83.5793103448276}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {}, "num_env_steps_sampled": 37328, "num_env_steps_trained": 37328, "num_agent_steps_sampled": 149312, "num_agent_steps_trained": 149312}, "env_runners": {"episode_reward_max": 286.6692231913454, "episode_reward_min": -53.94695511723343, "episode_reward_mean": 102.60472273081903, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -382.5350217575324, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 179.13622751357744, "predator_policy": 388.3350217575325}, "policy_reward_mean": {"prey_policy": -50.61742331228365, "predator_policy": 101.91978467769317}, "custom_metrics": {}, "hist_stats": {"episode_reward": [35.10000000000023, -2.2956613079459616, 52.30000000000035, 93.99999999999946, 41.27668545957155, 138.35998813581944, 47.000000000000355, 189.59999999999982, 46.100000000000314, 122.59999999999911, 172.99184762314727, 183.89999999999952, 165.26660970450598, 63.400000000000325, 224.23591029611316, 118.26513246444676, 57.049342065984625, 56.287512516221504, 91.49999999999856, 77.70000000000017, 286.6692231913454, 34.20000000000022, 135.4999999999999, 189.7622134181783, 204.95900501687956, 41.46117592104707, 160.52089757879483, 41.90000000000027, 159.99999999999952, 56.25035590474681, 189.40904152072758, 32.4000000000002, 135.49999999999923, 137.09999999999957, -53.94695511723343, 170.90494465410117, 56.10000000000025, 60.20000000000013, 34.75612756781972, 43.60000000000028, 40.265044310772325, 47.1298862953699, 48.40000000000023, 36.202116310375594, 74.49999999999962, 153.19999999999987, 40.1000000000002, 131.19999999999982, 52.570622032848895, 56.000000000000156, 129.1999999999993, 86.20000000000002, 28.831075919194078, 160.79999999999959, 81.33852172443821, 103.01543537877356, 169.88064982359512, 48.30000000000023, 52.529310579969625, 48.028025438635616, 198.59999999999948, 184.470358209413, 37.06861395355878, 80.95181844992561, 33.900000000000134, 135.39999999999944, 148.89999999999955, 133.69999999999916, 226.89999999999938, 68.3000000000002, 154.45814550558052, 41.47674734270453, 180.74087067540847, 60.139037304427255, 153.66325386820998, 109.81254335834268, 96.80000000000011, 108.61895163315396, 159.3546697445331, 53.10000000000013, 125.29999999999959, 34.93780403323022, 139.0999999999999, 206.80167211533725, 40.50000000000029, 68.40000000000009, 88.29999999999927, 242.69999999999993, 37.700000000000266, 104.09999999999903, 229.34134979067687, 152.6250807412044, 157.8592262743011, 37.26670789146122, 35.20000000000023, 108.04468364708873, 87.5999999999994, 92.41177405235972, 131.94864151087714, 94.40623855187317], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [13.573129738316304, -53.54665936669982, -254.04609845621002, -260.27960040372835, -140.65478211067654, -73.1171426718985, 39.583255312047925, -34.03651010327775, -114.83317908671795, -92.66853807147267, -96.4272326280199, 93.09870255859556, -64.80740741555226, 20.000000000000014, 20.626642410773584, -16.792242611230414, 18.848497587615384, -92.85980597895414, 69.17606926139403, -109.36249015041209, -285.2321358475945, 105.74800812423979, 132.7888944272447, -19.35385941243218, -25.356623210719427, 11.326871936077456, -78.03601550180139, -20.07740583328924, 28.904313331271958, 85.71002709904536, -84.17058524148602, -101.59193807470932, -247.8691803256373, -34.87488956710395, -49.40531904969436, -141.19228141836533, -107.134889946308, 73.87102816456981, 4.171128342528487, -6.373188196460497, 72.0443042732162, -52.54708787865346, -32.67477650531073, -33.11217620680012, 17.408091439294907, -110.92817899556306, 80.28766474857159, -53.604483480981195, 64.90005398718623, -328.3984316256627, -221.37365036394135, -15.540567450569034, -217.97172194166885, 76.83739839192134, -62.4215290072797, -67.19987230581766, 82.82590198976501, -215.4723347673664, -63.01766150909464, -253.83034574412602, -72.05610867549865, 89.36722870345912, -103.9034532802869, -142.29070810227037, 0.5594712651248201, 21.887655692545323, -382.5350217575324, 117.78599718266575, -341.68754507993606, -271.3757928143444, 42.05974767402415, -113.91576456218526, 10.584749159468316, -368.0370289653096, -96.60173288891873, 6.578081936680414, -116.41208622158636, -38.927412945968925, -335.88260364800084, 33.30132488528524, -27.102952922490367, -70.03840438982733, -11.808869660467748, -17.067235360537826, 10.174001800704053, -2.962232113254194, -5.251613856427011, -54.123434986458186, -77.75098136410048, -19.99080009629646, 33.88040540161318, 40.0118549587175, 18.203034292193653, -101.55435256341609, 84.66934503983893, -118.51718584134521, -111.25275039532056, -35.27706169307365, 12.962713255211035, -154.80174341253127, -108.368940102753, 45.92361009447094, 66.26530936409696, -54.85406764413665, -50.32982812857711, -6.234569676365133, 43.52535653925046, -20.284647818951065, -122.72911794687963, -30.02930181547257, 64.88866316909824, -29.828281979136015, 27.845266783971347, 9.541578665059246, 1.103496687474779, 7.009962407567832, -8.299879170194934, -72.54471461247661, -97.58563081684744, -33.94553553761412, 161.42330774007206, -112.95182525200485, -6.1055308568346724, 40.28710026868663, -159.2584299113319, 1.9693763855458568, -203.51123731867187, -41.75335832068283, -112.73519084767737, -9.86848498904447, -75.14768969882805, 64.9005559888798, -41.26096743109789, 11.98667537860044, 89.1022150662958, -53.133135240501986, -21.790897701337713, 102.87572050846154, -103.60518017643587, -2.753002690682439, -77.5059788586302, -136.78681328113666, -35.26167272819433, 0.7616669233566751, 99.3892737675306, -121.76317749732668, -221.41484542454427, -0.26256937414734516, -81.64046493632515, 47.835445195899766, 41.62225202827415, -159.27689309555132, 8.414915969460758, -94.96493654962522, -101.89030278114168, -225.75780180988139, 42.3879814213417, -221.12051631037914, -194.2370444672595, -47.443484467917465, -68.94976936260595, -71.53127552961595, -175.21866179031935, -2.377011043507998, 7.336224962261236, 57.5840314172886, 148.94400313475802, -286.27355747273646, -38.05288701360526, -15.675153673344045, -157.06325915064687, 20.451311784900852, -34.19514158105644, -163.71926844518902, 179.13622751357744, -193.68286217716528, -5.466795255903271, 18.11348646225638, 73.35067178507347, -116.27200227841195, 81.3532898949211, -15.069998875773695, -1.5790888906085807, -103.01419787536915, 39.20269946596015, -70.07117731476804, -109.82064133551206, -6.986631127929058, -36.128808808176835, 15.187313791671755, -14.673585565722401, -251.67950712492743, 6.628822658497688, -90.79739622560763, -223.17849208443, -63.253333383580255, -19.653256456869457, -32.815082218808726, 25.002451968907792, -219.83803663194715], "policy_predator_policy_reward": [5.826870261683667, 69.24665936669969, 324.2059226722713, 187.82411487972215, 153.05478211067583, 113.01714267189817, 17.61674468795218, 70.83651010327776, 56.871368154986286, 191.90703446277513, 141.68851820524378, 0.0, 91.80740741555158, 0.0, 54.17335758922649, 131.5922426112305, 1.0515024123846184, 119.05980597895365, 36.62393073860571, 126.16249015041168, 294.04458931930264, 58.43138602720072, 27.098306487098423, 43.366658498089144, 101.5982771707111, 77.69808380843789, 92.33601550180148, 69.17740583328944, 11.711242094735995, 97.91032777106007, 159.598841430636, 144.42881435000547, 256.62014258831397, 83.17326937041157, 64.7437860571049, 182.14132692717635, 121.33488994630724, 3.428971835429686, 17.92887165747148, 61.97318819646065, 71.37501564844887, 195.79699114833366, 50.574776505310986, 49.41217620680031, 95.99190856070484, 133.02817899556257, 118.64992189155714, 44.429110259031575, 173.65858800042827, 294.7987946549283, 219.5255437438939, 58.84984999166302, 153.020176017792, 148.6350451107507, 84.92152900727922, 86.59987230581754, 35.917401426461, 256.72903135113984, 310.86582010807547, 62.23254304989086, 95.58973110505788, 76.50819038770996, 122.80345328028605, 155.79070810226966, 62.740528734875355, 50.312344307454744, 388.3350217575325, 13.51400281733393, 276.4934910271924, 282.6228917498557, 228.37632836739596, 14.384633174866076, 36.51525084053167, 377.03702896531087, 55.843560999739694, 94.38008995249868, 186.75715567238382, 3.338471062991101, 341.8826036480012, 4.298675114714987, 61.56155472910194, 75.84484689398705, 39.31993402285901, 36.68605729351662, 9.025998199295913, 32.16223211325439, 17.067987561023646, 78.50917759223691, 86.89305015310855, 85.34873130728765, 32.98846306649877, 46.31927657317061, 3.2969657078063443, 120.15435256341586, 51.96603493554656, 113.08180586595923, 51.82953263144456, 147.2709014897984, 28.814437033388117, 169.02459312393165, 122.3689401027523, 69.27638990552909, 2.934690635903009, 71.85406764413669, 69.17481916505344, 16.220654559082863, 82.67464346074956, 54.88464781895127, 149.0452344703959, 85.05170701639402, 61.64654055235777, 6.308513636455049, 122.72811266075166, 9.76569171381375, 28.196503312525255, 11.990037592432142, 39.59465245581429, 93.77925190682629, 173.417858483239, 6.14133330985798, 15.762281811455798, 134.36623570047647, 76.06028203580479, 74.22850676175635, 34.695476680536935, 159.6621907988072, 167.2233660646181, 158.99304802466287, 125.23519084767717, 31.268484989044566, 88.54768969882797, 57.09944401112018, 170.03924007813922, 8.135051974358213, 21.451638560862875, 76.27928161334323, 145.09089770133772, 0.7242794915378635, 119.58478321201947, 55.07339965509877, 101.30347201003724, 267.44746563530987, 25.72851731642294, 50.2482358311191, 10.105741511511418, 193.0090328936931, 242.16798791533478, 39.648464187783205, 159.3499139561802, 28.118359652455005, 62.6282279289202, 164.83895649669932, 73.18508403053936, 110.16493654962441, 168.40666761692708, 267.8603886072499, 213.90796331236706, 124.17924132120368, 231.43704446725934, 63.34348446791769, 164.82322943616253, 100.95781545605833, 192.6461275375021, 19.887349329554755, 38.363775037738804, 35.81596858271153, 113.3458349053624, 230.7853915479533, 54.85288701360539, 39.375153673344265, 203.76325915064663, 1.2486882150991712, 111.99514158105654, 174.21926844518845, 10.863772486422565, 246.3828621771652, 23.366795255903288, 1.686513537743613, 3.0493282149260565, 143.97200227841205, 11.169618052507685, 151.88844071902219, 78.45110531031017, 178.76726219687225, 5.491533832319006, 183.23617029079, 53.44679168121165, 100.62718867369004, 51.62880880817706, 4.512686208328209, 171.62334218999183, 202.77443414774723, 128.4407517753692, 43.32782179174049, 246.32318803637418, 132.52041148399576, 85.60806980806116, 98.80891037849513, 185.52092658311363, 103.72089663179854]}, "sampler_perf": {"mean_raw_obs_processing_ms": 24.612889016885457, "mean_inference_ms": 21.186329230406663, "mean_action_processing_ms": 5.908154806035579, "mean_env_wait_ms": 37.33530745612723, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.09543001651763916, "StateBufferConnector_ms": 0.03673684597015381, "ViewRequirementAgentConnector_ms": 1.255206823348999}, "num_episodes": 0, "episode_return_max": 286.6692231913454, "episode_return_min": -53.94695511723343, "episode_return_mean": 102.60472273081903, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 149312, "num_agent_steps_trained": 149312, "num_env_steps_sampled": 37328, "num_env_steps_trained": 37328, "num_env_steps_sampled_this_iter": 0, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 0.0, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 37328, "num_env_steps_sampled_lifetime": 37328, "num_agent_steps_sampled_lifetime": 149312, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 149312, "timers": {"training_iteration_time_ms": 61489.634, "restore_workers_time_ms": 19.676, "training_step_time_ms": 61420.574, "sample_time_ms": 61400.603, "learn_time_ms": 311236.026, "learn_throughput": 59.967, "synch_weights_time_ms": 43.334}, "counters": {"num_env_steps_sampled": 37328, "num_env_steps_trained": 37328, "num_agent_steps_sampled": 149312, "num_agent_steps_trained": 149312}, "done": false, "training_iteration": 61, "trial_id": "d7bca_00000", "date": "2024-08-20_13-18-42", "timestamp": 1724140122, "time_this_iter_s": 123.3475091457367, "time_total_s": 8635.694325685501, "pid": 36059, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 16000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x32cf61f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 8635.694325685501, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 97.3778409090909, "ram_util_percent": 83.59829545454546}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {}, "num_env_steps_sampled": 37328, "num_env_steps_trained": 37328, "num_agent_steps_sampled": 149312, "num_agent_steps_trained": 149312}, "env_runners": {"episode_reward_max": 286.6692231913454, "episode_reward_min": -53.94695511723343, "episode_reward_mean": 102.60472273081903, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -382.5350217575324, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 179.13622751357744, "predator_policy": 388.3350217575325}, "policy_reward_mean": {"prey_policy": -50.61742331228365, "predator_policy": 101.91978467769317}, "custom_metrics": {}, "hist_stats": {"episode_reward": [35.10000000000023, -2.2956613079459616, 52.30000000000035, 93.99999999999946, 41.27668545957155, 138.35998813581944, 47.000000000000355, 189.59999999999982, 46.100000000000314, 122.59999999999911, 172.99184762314727, 183.89999999999952, 165.26660970450598, 63.400000000000325, 224.23591029611316, 118.26513246444676, 57.049342065984625, 56.287512516221504, 91.49999999999856, 77.70000000000017, 286.6692231913454, 34.20000000000022, 135.4999999999999, 189.7622134181783, 204.95900501687956, 41.46117592104707, 160.52089757879483, 41.90000000000027, 159.99999999999952, 56.25035590474681, 189.40904152072758, 32.4000000000002, 135.49999999999923, 137.09999999999957, -53.94695511723343, 170.90494465410117, 56.10000000000025, 60.20000000000013, 34.75612756781972, 43.60000000000028, 40.265044310772325, 47.1298862953699, 48.40000000000023, 36.202116310375594, 74.49999999999962, 153.19999999999987, 40.1000000000002, 131.19999999999982, 52.570622032848895, 56.000000000000156, 129.1999999999993, 86.20000000000002, 28.831075919194078, 160.79999999999959, 81.33852172443821, 103.01543537877356, 169.88064982359512, 48.30000000000023, 52.529310579969625, 48.028025438635616, 198.59999999999948, 184.470358209413, 37.06861395355878, 80.95181844992561, 33.900000000000134, 135.39999999999944, 148.89999999999955, 133.69999999999916, 226.89999999999938, 68.3000000000002, 154.45814550558052, 41.47674734270453, 180.74087067540847, 60.139037304427255, 153.66325386820998, 109.81254335834268, 96.80000000000011, 108.61895163315396, 159.3546697445331, 53.10000000000013, 125.29999999999959, 34.93780403323022, 139.0999999999999, 206.80167211533725, 40.50000000000029, 68.40000000000009, 88.29999999999927, 242.69999999999993, 37.700000000000266, 104.09999999999903, 229.34134979067687, 152.6250807412044, 157.8592262743011, 37.26670789146122, 35.20000000000023, 108.04468364708873, 87.5999999999994, 92.41177405235972, 131.94864151087714, 94.40623855187317], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [13.573129738316304, -53.54665936669982, -254.04609845621002, -260.27960040372835, -140.65478211067654, -73.1171426718985, 39.583255312047925, -34.03651010327775, -114.83317908671795, -92.66853807147267, -96.4272326280199, 93.09870255859556, -64.80740741555226, 20.000000000000014, 20.626642410773584, -16.792242611230414, 18.848497587615384, -92.85980597895414, 69.17606926139403, -109.36249015041209, -285.2321358475945, 105.74800812423979, 132.7888944272447, -19.35385941243218, -25.356623210719427, 11.326871936077456, -78.03601550180139, -20.07740583328924, 28.904313331271958, 85.71002709904536, -84.17058524148602, -101.59193807470932, -247.8691803256373, -34.87488956710395, -49.40531904969436, -141.19228141836533, -107.134889946308, 73.87102816456981, 4.171128342528487, -6.373188196460497, 72.0443042732162, -52.54708787865346, -32.67477650531073, -33.11217620680012, 17.408091439294907, -110.92817899556306, 80.28766474857159, -53.604483480981195, 64.90005398718623, -328.3984316256627, -221.37365036394135, -15.540567450569034, -217.97172194166885, 76.83739839192134, -62.4215290072797, -67.19987230581766, 82.82590198976501, -215.4723347673664, -63.01766150909464, -253.83034574412602, -72.05610867549865, 89.36722870345912, -103.9034532802869, -142.29070810227037, 0.5594712651248201, 21.887655692545323, -382.5350217575324, 117.78599718266575, -341.68754507993606, -271.3757928143444, 42.05974767402415, -113.91576456218526, 10.584749159468316, -368.0370289653096, -96.60173288891873, 6.578081936680414, -116.41208622158636, -38.927412945968925, -335.88260364800084, 33.30132488528524, -27.102952922490367, -70.03840438982733, -11.808869660467748, -17.067235360537826, 10.174001800704053, -2.962232113254194, -5.251613856427011, -54.123434986458186, -77.75098136410048, -19.99080009629646, 33.88040540161318, 40.0118549587175, 18.203034292193653, -101.55435256341609, 84.66934503983893, -118.51718584134521, -111.25275039532056, -35.27706169307365, 12.962713255211035, -154.80174341253127, -108.368940102753, 45.92361009447094, 66.26530936409696, -54.85406764413665, -50.32982812857711, -6.234569676365133, 43.52535653925046, -20.284647818951065, -122.72911794687963, -30.02930181547257, 64.88866316909824, -29.828281979136015, 27.845266783971347, 9.541578665059246, 1.103496687474779, 7.009962407567832, -8.299879170194934, -72.54471461247661, -97.58563081684744, -33.94553553761412, 161.42330774007206, -112.95182525200485, -6.1055308568346724, 40.28710026868663, -159.2584299113319, 1.9693763855458568, -203.51123731867187, -41.75335832068283, -112.73519084767737, -9.86848498904447, -75.14768969882805, 64.9005559888798, -41.26096743109789, 11.98667537860044, 89.1022150662958, -53.133135240501986, -21.790897701337713, 102.87572050846154, -103.60518017643587, -2.753002690682439, -77.5059788586302, -136.78681328113666, -35.26167272819433, 0.7616669233566751, 99.3892737675306, -121.76317749732668, -221.41484542454427, -0.26256937414734516, -81.64046493632515, 47.835445195899766, 41.62225202827415, -159.27689309555132, 8.414915969460758, -94.96493654962522, -101.89030278114168, -225.75780180988139, 42.3879814213417, -221.12051631037914, -194.2370444672595, -47.443484467917465, -68.94976936260595, -71.53127552961595, -175.21866179031935, -2.377011043507998, 7.336224962261236, 57.5840314172886, 148.94400313475802, -286.27355747273646, -38.05288701360526, -15.675153673344045, -157.06325915064687, 20.451311784900852, -34.19514158105644, -163.71926844518902, 179.13622751357744, -193.68286217716528, -5.466795255903271, 18.11348646225638, 73.35067178507347, -116.27200227841195, 81.3532898949211, -15.069998875773695, -1.5790888906085807, -103.01419787536915, 39.20269946596015, -70.07117731476804, -109.82064133551206, -6.986631127929058, -36.128808808176835, 15.187313791671755, -14.673585565722401, -251.67950712492743, 6.628822658497688, -90.79739622560763, -223.17849208443, -63.253333383580255, -19.653256456869457, -32.815082218808726, 25.002451968907792, -219.83803663194715], "policy_predator_policy_reward": [5.826870261683667, 69.24665936669969, 324.2059226722713, 187.82411487972215, 153.05478211067583, 113.01714267189817, 17.61674468795218, 70.83651010327776, 56.871368154986286, 191.90703446277513, 141.68851820524378, 0.0, 91.80740741555158, 0.0, 54.17335758922649, 131.5922426112305, 1.0515024123846184, 119.05980597895365, 36.62393073860571, 126.16249015041168, 294.04458931930264, 58.43138602720072, 27.098306487098423, 43.366658498089144, 101.5982771707111, 77.69808380843789, 92.33601550180148, 69.17740583328944, 11.711242094735995, 97.91032777106007, 159.598841430636, 144.42881435000547, 256.62014258831397, 83.17326937041157, 64.7437860571049, 182.14132692717635, 121.33488994630724, 3.428971835429686, 17.92887165747148, 61.97318819646065, 71.37501564844887, 195.79699114833366, 50.574776505310986, 49.41217620680031, 95.99190856070484, 133.02817899556257, 118.64992189155714, 44.429110259031575, 173.65858800042827, 294.7987946549283, 219.5255437438939, 58.84984999166302, 153.020176017792, 148.6350451107507, 84.92152900727922, 86.59987230581754, 35.917401426461, 256.72903135113984, 310.86582010807547, 62.23254304989086, 95.58973110505788, 76.50819038770996, 122.80345328028605, 155.79070810226966, 62.740528734875355, 50.312344307454744, 388.3350217575325, 13.51400281733393, 276.4934910271924, 282.6228917498557, 228.37632836739596, 14.384633174866076, 36.51525084053167, 377.03702896531087, 55.843560999739694, 94.38008995249868, 186.75715567238382, 3.338471062991101, 341.8826036480012, 4.298675114714987, 61.56155472910194, 75.84484689398705, 39.31993402285901, 36.68605729351662, 9.025998199295913, 32.16223211325439, 17.067987561023646, 78.50917759223691, 86.89305015310855, 85.34873130728765, 32.98846306649877, 46.31927657317061, 3.2969657078063443, 120.15435256341586, 51.96603493554656, 113.08180586595923, 51.82953263144456, 147.2709014897984, 28.814437033388117, 169.02459312393165, 122.3689401027523, 69.27638990552909, 2.934690635903009, 71.85406764413669, 69.17481916505344, 16.220654559082863, 82.67464346074956, 54.88464781895127, 149.0452344703959, 85.05170701639402, 61.64654055235777, 6.308513636455049, 122.72811266075166, 9.76569171381375, 28.196503312525255, 11.990037592432142, 39.59465245581429, 93.77925190682629, 173.417858483239, 6.14133330985798, 15.762281811455798, 134.36623570047647, 76.06028203580479, 74.22850676175635, 34.695476680536935, 159.6621907988072, 167.2233660646181, 158.99304802466287, 125.23519084767717, 31.268484989044566, 88.54768969882797, 57.09944401112018, 170.03924007813922, 8.135051974358213, 21.451638560862875, 76.27928161334323, 145.09089770133772, 0.7242794915378635, 119.58478321201947, 55.07339965509877, 101.30347201003724, 267.44746563530987, 25.72851731642294, 50.2482358311191, 10.105741511511418, 193.0090328936931, 242.16798791533478, 39.648464187783205, 159.3499139561802, 28.118359652455005, 62.6282279289202, 164.83895649669932, 73.18508403053936, 110.16493654962441, 168.40666761692708, 267.8603886072499, 213.90796331236706, 124.17924132120368, 231.43704446725934, 63.34348446791769, 164.82322943616253, 100.95781545605833, 192.6461275375021, 19.887349329554755, 38.363775037738804, 35.81596858271153, 113.3458349053624, 230.7853915479533, 54.85288701360539, 39.375153673344265, 203.76325915064663, 1.2486882150991712, 111.99514158105654, 174.21926844518845, 10.863772486422565, 246.3828621771652, 23.366795255903288, 1.686513537743613, 3.0493282149260565, 143.97200227841205, 11.169618052507685, 151.88844071902219, 78.45110531031017, 178.76726219687225, 5.491533832319006, 183.23617029079, 53.44679168121165, 100.62718867369004, 51.62880880817706, 4.512686208328209, 171.62334218999183, 202.77443414774723, 128.4407517753692, 43.32782179174049, 246.32318803637418, 132.52041148399576, 85.60806980806116, 98.80891037849513, 185.52092658311363, 103.72089663179854]}, "sampler_perf": {"mean_raw_obs_processing_ms": 24.612889016885457, "mean_inference_ms": 21.186329230406663, "mean_action_processing_ms": 5.908154806035579, "mean_env_wait_ms": 37.33530745612723, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.09543001651763916, "StateBufferConnector_ms": 0.03673684597015381, "ViewRequirementAgentConnector_ms": 1.255206823348999}, "num_episodes": 0, "episode_return_max": 286.6692231913454, "episode_return_min": -53.94695511723343, "episode_return_mean": 102.60472273081903, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 149312, "num_agent_steps_trained": 149312, "num_env_steps_sampled": 37328, "num_env_steps_trained": 37328, "num_env_steps_sampled_this_iter": 0, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 0.0, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 37328, "num_env_steps_sampled_lifetime": 37328, "num_agent_steps_sampled_lifetime": 149312, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 149312, "timers": {"training_iteration_time_ms": 61461.713, "restore_workers_time_ms": 17.556, "training_step_time_ms": 61400.82, "sample_time_ms": 61382.266, "learn_time_ms": 311236.026, "learn_throughput": 59.967, "synch_weights_time_ms": 43.334}, "counters": {"num_env_steps_sampled": 37328, "num_env_steps_trained": 37328, "num_agent_steps_sampled": 149312, "num_agent_steps_trained": 149312}, "done": false, "training_iteration": 62, "trial_id": "d7bca_00000", "date": "2024-08-20_13-20-48", "timestamp": 1724140248, "time_this_iter_s": 122.76278138160706, "time_total_s": 8758.457107067108, "pid": 36059, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 16000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3ae8b8d30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 8758.457107067108, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 96.67383720930233, "ram_util_percent": 83.59011627906978}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {}, "num_env_steps_sampled": 37328, "num_env_steps_trained": 37328, "num_agent_steps_sampled": 149312, "num_agent_steps_trained": 149312}, "env_runners": {"episode_reward_max": 286.6692231913454, "episode_reward_min": -53.94695511723343, "episode_reward_mean": 102.60472273081903, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -382.5350217575324, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 179.13622751357744, "predator_policy": 388.3350217575325}, "policy_reward_mean": {"prey_policy": -50.61742331228365, "predator_policy": 101.91978467769317}, "custom_metrics": {}, "hist_stats": {"episode_reward": [35.10000000000023, -2.2956613079459616, 52.30000000000035, 93.99999999999946, 41.27668545957155, 138.35998813581944, 47.000000000000355, 189.59999999999982, 46.100000000000314, 122.59999999999911, 172.99184762314727, 183.89999999999952, 165.26660970450598, 63.400000000000325, 224.23591029611316, 118.26513246444676, 57.049342065984625, 56.287512516221504, 91.49999999999856, 77.70000000000017, 286.6692231913454, 34.20000000000022, 135.4999999999999, 189.7622134181783, 204.95900501687956, 41.46117592104707, 160.52089757879483, 41.90000000000027, 159.99999999999952, 56.25035590474681, 189.40904152072758, 32.4000000000002, 135.49999999999923, 137.09999999999957, -53.94695511723343, 170.90494465410117, 56.10000000000025, 60.20000000000013, 34.75612756781972, 43.60000000000028, 40.265044310772325, 47.1298862953699, 48.40000000000023, 36.202116310375594, 74.49999999999962, 153.19999999999987, 40.1000000000002, 131.19999999999982, 52.570622032848895, 56.000000000000156, 129.1999999999993, 86.20000000000002, 28.831075919194078, 160.79999999999959, 81.33852172443821, 103.01543537877356, 169.88064982359512, 48.30000000000023, 52.529310579969625, 48.028025438635616, 198.59999999999948, 184.470358209413, 37.06861395355878, 80.95181844992561, 33.900000000000134, 135.39999999999944, 148.89999999999955, 133.69999999999916, 226.89999999999938, 68.3000000000002, 154.45814550558052, 41.47674734270453, 180.74087067540847, 60.139037304427255, 153.66325386820998, 109.81254335834268, 96.80000000000011, 108.61895163315396, 159.3546697445331, 53.10000000000013, 125.29999999999959, 34.93780403323022, 139.0999999999999, 206.80167211533725, 40.50000000000029, 68.40000000000009, 88.29999999999927, 242.69999999999993, 37.700000000000266, 104.09999999999903, 229.34134979067687, 152.6250807412044, 157.8592262743011, 37.26670789146122, 35.20000000000023, 108.04468364708873, 87.5999999999994, 92.41177405235972, 131.94864151087714, 94.40623855187317], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [13.573129738316304, -53.54665936669982, -254.04609845621002, -260.27960040372835, -140.65478211067654, -73.1171426718985, 39.583255312047925, -34.03651010327775, -114.83317908671795, -92.66853807147267, -96.4272326280199, 93.09870255859556, -64.80740741555226, 20.000000000000014, 20.626642410773584, -16.792242611230414, 18.848497587615384, -92.85980597895414, 69.17606926139403, -109.36249015041209, -285.2321358475945, 105.74800812423979, 132.7888944272447, -19.35385941243218, -25.356623210719427, 11.326871936077456, -78.03601550180139, -20.07740583328924, 28.904313331271958, 85.71002709904536, -84.17058524148602, -101.59193807470932, -247.8691803256373, -34.87488956710395, -49.40531904969436, -141.19228141836533, -107.134889946308, 73.87102816456981, 4.171128342528487, -6.373188196460497, 72.0443042732162, -52.54708787865346, -32.67477650531073, -33.11217620680012, 17.408091439294907, -110.92817899556306, 80.28766474857159, -53.604483480981195, 64.90005398718623, -328.3984316256627, -221.37365036394135, -15.540567450569034, -217.97172194166885, 76.83739839192134, -62.4215290072797, -67.19987230581766, 82.82590198976501, -215.4723347673664, -63.01766150909464, -253.83034574412602, -72.05610867549865, 89.36722870345912, -103.9034532802869, -142.29070810227037, 0.5594712651248201, 21.887655692545323, -382.5350217575324, 117.78599718266575, -341.68754507993606, -271.3757928143444, 42.05974767402415, -113.91576456218526, 10.584749159468316, -368.0370289653096, -96.60173288891873, 6.578081936680414, -116.41208622158636, -38.927412945968925, -335.88260364800084, 33.30132488528524, -27.102952922490367, -70.03840438982733, -11.808869660467748, -17.067235360537826, 10.174001800704053, -2.962232113254194, -5.251613856427011, -54.123434986458186, -77.75098136410048, -19.99080009629646, 33.88040540161318, 40.0118549587175, 18.203034292193653, -101.55435256341609, 84.66934503983893, -118.51718584134521, -111.25275039532056, -35.27706169307365, 12.962713255211035, -154.80174341253127, -108.368940102753, 45.92361009447094, 66.26530936409696, -54.85406764413665, -50.32982812857711, -6.234569676365133, 43.52535653925046, -20.284647818951065, -122.72911794687963, -30.02930181547257, 64.88866316909824, -29.828281979136015, 27.845266783971347, 9.541578665059246, 1.103496687474779, 7.009962407567832, -8.299879170194934, -72.54471461247661, -97.58563081684744, -33.94553553761412, 161.42330774007206, -112.95182525200485, -6.1055308568346724, 40.28710026868663, -159.2584299113319, 1.9693763855458568, -203.51123731867187, -41.75335832068283, -112.73519084767737, -9.86848498904447, -75.14768969882805, 64.9005559888798, -41.26096743109789, 11.98667537860044, 89.1022150662958, -53.133135240501986, -21.790897701337713, 102.87572050846154, -103.60518017643587, -2.753002690682439, -77.5059788586302, -136.78681328113666, -35.26167272819433, 0.7616669233566751, 99.3892737675306, -121.76317749732668, -221.41484542454427, -0.26256937414734516, -81.64046493632515, 47.835445195899766, 41.62225202827415, -159.27689309555132, 8.414915969460758, -94.96493654962522, -101.89030278114168, -225.75780180988139, 42.3879814213417, -221.12051631037914, -194.2370444672595, -47.443484467917465, -68.94976936260595, -71.53127552961595, -175.21866179031935, -2.377011043507998, 7.336224962261236, 57.5840314172886, 148.94400313475802, -286.27355747273646, -38.05288701360526, -15.675153673344045, -157.06325915064687, 20.451311784900852, -34.19514158105644, -163.71926844518902, 179.13622751357744, -193.68286217716528, -5.466795255903271, 18.11348646225638, 73.35067178507347, -116.27200227841195, 81.3532898949211, -15.069998875773695, -1.5790888906085807, -103.01419787536915, 39.20269946596015, -70.07117731476804, -109.82064133551206, -6.986631127929058, -36.128808808176835, 15.187313791671755, -14.673585565722401, -251.67950712492743, 6.628822658497688, -90.79739622560763, -223.17849208443, -63.253333383580255, -19.653256456869457, -32.815082218808726, 25.002451968907792, -219.83803663194715], "policy_predator_policy_reward": [5.826870261683667, 69.24665936669969, 324.2059226722713, 187.82411487972215, 153.05478211067583, 113.01714267189817, 17.61674468795218, 70.83651010327776, 56.871368154986286, 191.90703446277513, 141.68851820524378, 0.0, 91.80740741555158, 0.0, 54.17335758922649, 131.5922426112305, 1.0515024123846184, 119.05980597895365, 36.62393073860571, 126.16249015041168, 294.04458931930264, 58.43138602720072, 27.098306487098423, 43.366658498089144, 101.5982771707111, 77.69808380843789, 92.33601550180148, 69.17740583328944, 11.711242094735995, 97.91032777106007, 159.598841430636, 144.42881435000547, 256.62014258831397, 83.17326937041157, 64.7437860571049, 182.14132692717635, 121.33488994630724, 3.428971835429686, 17.92887165747148, 61.97318819646065, 71.37501564844887, 195.79699114833366, 50.574776505310986, 49.41217620680031, 95.99190856070484, 133.02817899556257, 118.64992189155714, 44.429110259031575, 173.65858800042827, 294.7987946549283, 219.5255437438939, 58.84984999166302, 153.020176017792, 148.6350451107507, 84.92152900727922, 86.59987230581754, 35.917401426461, 256.72903135113984, 310.86582010807547, 62.23254304989086, 95.58973110505788, 76.50819038770996, 122.80345328028605, 155.79070810226966, 62.740528734875355, 50.312344307454744, 388.3350217575325, 13.51400281733393, 276.4934910271924, 282.6228917498557, 228.37632836739596, 14.384633174866076, 36.51525084053167, 377.03702896531087, 55.843560999739694, 94.38008995249868, 186.75715567238382, 3.338471062991101, 341.8826036480012, 4.298675114714987, 61.56155472910194, 75.84484689398705, 39.31993402285901, 36.68605729351662, 9.025998199295913, 32.16223211325439, 17.067987561023646, 78.50917759223691, 86.89305015310855, 85.34873130728765, 32.98846306649877, 46.31927657317061, 3.2969657078063443, 120.15435256341586, 51.96603493554656, 113.08180586595923, 51.82953263144456, 147.2709014897984, 28.814437033388117, 169.02459312393165, 122.3689401027523, 69.27638990552909, 2.934690635903009, 71.85406764413669, 69.17481916505344, 16.220654559082863, 82.67464346074956, 54.88464781895127, 149.0452344703959, 85.05170701639402, 61.64654055235777, 6.308513636455049, 122.72811266075166, 9.76569171381375, 28.196503312525255, 11.990037592432142, 39.59465245581429, 93.77925190682629, 173.417858483239, 6.14133330985798, 15.762281811455798, 134.36623570047647, 76.06028203580479, 74.22850676175635, 34.695476680536935, 159.6621907988072, 167.2233660646181, 158.99304802466287, 125.23519084767717, 31.268484989044566, 88.54768969882797, 57.09944401112018, 170.03924007813922, 8.135051974358213, 21.451638560862875, 76.27928161334323, 145.09089770133772, 0.7242794915378635, 119.58478321201947, 55.07339965509877, 101.30347201003724, 267.44746563530987, 25.72851731642294, 50.2482358311191, 10.105741511511418, 193.0090328936931, 242.16798791533478, 39.648464187783205, 159.3499139561802, 28.118359652455005, 62.6282279289202, 164.83895649669932, 73.18508403053936, 110.16493654962441, 168.40666761692708, 267.8603886072499, 213.90796331236706, 124.17924132120368, 231.43704446725934, 63.34348446791769, 164.82322943616253, 100.95781545605833, 192.6461275375021, 19.887349329554755, 38.363775037738804, 35.81596858271153, 113.3458349053624, 230.7853915479533, 54.85288701360539, 39.375153673344265, 203.76325915064663, 1.2486882150991712, 111.99514158105654, 174.21926844518845, 10.863772486422565, 246.3828621771652, 23.366795255903288, 1.686513537743613, 3.0493282149260565, 143.97200227841205, 11.169618052507685, 151.88844071902219, 78.45110531031017, 178.76726219687225, 5.491533832319006, 183.23617029079, 53.44679168121165, 100.62718867369004, 51.62880880817706, 4.512686208328209, 171.62334218999183, 202.77443414774723, 128.4407517753692, 43.32782179174049, 246.32318803637418, 132.52041148399576, 85.60806980806116, 98.80891037849513, 185.52092658311363, 103.72089663179854]}, "sampler_perf": {"mean_raw_obs_processing_ms": 24.612889016885457, "mean_inference_ms": 21.186329230406663, "mean_action_processing_ms": 5.908154806035579, "mean_env_wait_ms": 37.33530745612723, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.09543001651763916, "StateBufferConnector_ms": 0.03673684597015381, "ViewRequirementAgentConnector_ms": 1.255206823348999}, "num_episodes": 0, "episode_return_max": 286.6692231913454, "episode_return_min": -53.94695511723343, "episode_return_mean": 102.60472273081903, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 149312, "num_agent_steps_trained": 149312, "num_env_steps_sampled": 37328, "num_env_steps_trained": 37328, "num_env_steps_sampled_this_iter": 0, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 0.0, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 37328, "num_env_steps_sampled_lifetime": 37328, "num_agent_steps_sampled_lifetime": 149312, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 149312, "timers": {"training_iteration_time_ms": 61560.807, "restore_workers_time_ms": 16.508, "training_step_time_ms": 61493.888, "sample_time_ms": 61470.724, "learn_time_ms": 311236.026, "learn_throughput": 59.967, "synch_weights_time_ms": 43.334}, "counters": {"num_env_steps_sampled": 37328, "num_env_steps_trained": 37328, "num_agent_steps_sampled": 149312, "num_agent_steps_trained": 149312}, "done": false, "training_iteration": 63, "trial_id": "d7bca_00000", "date": "2024-08-20_13-22-56", "timestamp": 1724140376, "time_this_iter_s": 126.06802463531494, "time_total_s": 8884.525131702423, "pid": 36059, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 16000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x32cf5c5e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 8884.525131702423, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 89.60225988700564, "ram_util_percent": 83.82881355932204}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {}, "num_env_steps_sampled": 37328, "num_env_steps_trained": 37328, "num_agent_steps_sampled": 149312, "num_agent_steps_trained": 149312}, "env_runners": {"episode_reward_max": 286.6692231913454, "episode_reward_min": -53.94695511723343, "episode_reward_mean": 102.60472273081903, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -382.5350217575324, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 179.13622751357744, "predator_policy": 388.3350217575325}, "policy_reward_mean": {"prey_policy": -50.61742331228365, "predator_policy": 101.91978467769317}, "custom_metrics": {}, "hist_stats": {"episode_reward": [35.10000000000023, -2.2956613079459616, 52.30000000000035, 93.99999999999946, 41.27668545957155, 138.35998813581944, 47.000000000000355, 189.59999999999982, 46.100000000000314, 122.59999999999911, 172.99184762314727, 183.89999999999952, 165.26660970450598, 63.400000000000325, 224.23591029611316, 118.26513246444676, 57.049342065984625, 56.287512516221504, 91.49999999999856, 77.70000000000017, 286.6692231913454, 34.20000000000022, 135.4999999999999, 189.7622134181783, 204.95900501687956, 41.46117592104707, 160.52089757879483, 41.90000000000027, 159.99999999999952, 56.25035590474681, 189.40904152072758, 32.4000000000002, 135.49999999999923, 137.09999999999957, -53.94695511723343, 170.90494465410117, 56.10000000000025, 60.20000000000013, 34.75612756781972, 43.60000000000028, 40.265044310772325, 47.1298862953699, 48.40000000000023, 36.202116310375594, 74.49999999999962, 153.19999999999987, 40.1000000000002, 131.19999999999982, 52.570622032848895, 56.000000000000156, 129.1999999999993, 86.20000000000002, 28.831075919194078, 160.79999999999959, 81.33852172443821, 103.01543537877356, 169.88064982359512, 48.30000000000023, 52.529310579969625, 48.028025438635616, 198.59999999999948, 184.470358209413, 37.06861395355878, 80.95181844992561, 33.900000000000134, 135.39999999999944, 148.89999999999955, 133.69999999999916, 226.89999999999938, 68.3000000000002, 154.45814550558052, 41.47674734270453, 180.74087067540847, 60.139037304427255, 153.66325386820998, 109.81254335834268, 96.80000000000011, 108.61895163315396, 159.3546697445331, 53.10000000000013, 125.29999999999959, 34.93780403323022, 139.0999999999999, 206.80167211533725, 40.50000000000029, 68.40000000000009, 88.29999999999927, 242.69999999999993, 37.700000000000266, 104.09999999999903, 229.34134979067687, 152.6250807412044, 157.8592262743011, 37.26670789146122, 35.20000000000023, 108.04468364708873, 87.5999999999994, 92.41177405235972, 131.94864151087714, 94.40623855187317], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [13.573129738316304, -53.54665936669982, -254.04609845621002, -260.27960040372835, -140.65478211067654, -73.1171426718985, 39.583255312047925, -34.03651010327775, -114.83317908671795, -92.66853807147267, -96.4272326280199, 93.09870255859556, -64.80740741555226, 20.000000000000014, 20.626642410773584, -16.792242611230414, 18.848497587615384, -92.85980597895414, 69.17606926139403, -109.36249015041209, -285.2321358475945, 105.74800812423979, 132.7888944272447, -19.35385941243218, -25.356623210719427, 11.326871936077456, -78.03601550180139, -20.07740583328924, 28.904313331271958, 85.71002709904536, -84.17058524148602, -101.59193807470932, -247.8691803256373, -34.87488956710395, -49.40531904969436, -141.19228141836533, -107.134889946308, 73.87102816456981, 4.171128342528487, -6.373188196460497, 72.0443042732162, -52.54708787865346, -32.67477650531073, -33.11217620680012, 17.408091439294907, -110.92817899556306, 80.28766474857159, -53.604483480981195, 64.90005398718623, -328.3984316256627, -221.37365036394135, -15.540567450569034, -217.97172194166885, 76.83739839192134, -62.4215290072797, -67.19987230581766, 82.82590198976501, -215.4723347673664, -63.01766150909464, -253.83034574412602, -72.05610867549865, 89.36722870345912, -103.9034532802869, -142.29070810227037, 0.5594712651248201, 21.887655692545323, -382.5350217575324, 117.78599718266575, -341.68754507993606, -271.3757928143444, 42.05974767402415, -113.91576456218526, 10.584749159468316, -368.0370289653096, -96.60173288891873, 6.578081936680414, -116.41208622158636, -38.927412945968925, -335.88260364800084, 33.30132488528524, -27.102952922490367, -70.03840438982733, -11.808869660467748, -17.067235360537826, 10.174001800704053, -2.962232113254194, -5.251613856427011, -54.123434986458186, -77.75098136410048, -19.99080009629646, 33.88040540161318, 40.0118549587175, 18.203034292193653, -101.55435256341609, 84.66934503983893, -118.51718584134521, -111.25275039532056, -35.27706169307365, 12.962713255211035, -154.80174341253127, -108.368940102753, 45.92361009447094, 66.26530936409696, -54.85406764413665, -50.32982812857711, -6.234569676365133, 43.52535653925046, -20.284647818951065, -122.72911794687963, -30.02930181547257, 64.88866316909824, -29.828281979136015, 27.845266783971347, 9.541578665059246, 1.103496687474779, 7.009962407567832, -8.299879170194934, -72.54471461247661, -97.58563081684744, -33.94553553761412, 161.42330774007206, -112.95182525200485, -6.1055308568346724, 40.28710026868663, -159.2584299113319, 1.9693763855458568, -203.51123731867187, -41.75335832068283, -112.73519084767737, -9.86848498904447, -75.14768969882805, 64.9005559888798, -41.26096743109789, 11.98667537860044, 89.1022150662958, -53.133135240501986, -21.790897701337713, 102.87572050846154, -103.60518017643587, -2.753002690682439, -77.5059788586302, -136.78681328113666, -35.26167272819433, 0.7616669233566751, 99.3892737675306, -121.76317749732668, -221.41484542454427, -0.26256937414734516, -81.64046493632515, 47.835445195899766, 41.62225202827415, -159.27689309555132, 8.414915969460758, -94.96493654962522, -101.89030278114168, -225.75780180988139, 42.3879814213417, -221.12051631037914, -194.2370444672595, -47.443484467917465, -68.94976936260595, -71.53127552961595, -175.21866179031935, -2.377011043507998, 7.336224962261236, 57.5840314172886, 148.94400313475802, -286.27355747273646, -38.05288701360526, -15.675153673344045, -157.06325915064687, 20.451311784900852, -34.19514158105644, -163.71926844518902, 179.13622751357744, -193.68286217716528, -5.466795255903271, 18.11348646225638, 73.35067178507347, -116.27200227841195, 81.3532898949211, -15.069998875773695, -1.5790888906085807, -103.01419787536915, 39.20269946596015, -70.07117731476804, -109.82064133551206, -6.986631127929058, -36.128808808176835, 15.187313791671755, -14.673585565722401, -251.67950712492743, 6.628822658497688, -90.79739622560763, -223.17849208443, -63.253333383580255, -19.653256456869457, -32.815082218808726, 25.002451968907792, -219.83803663194715], "policy_predator_policy_reward": [5.826870261683667, 69.24665936669969, 324.2059226722713, 187.82411487972215, 153.05478211067583, 113.01714267189817, 17.61674468795218, 70.83651010327776, 56.871368154986286, 191.90703446277513, 141.68851820524378, 0.0, 91.80740741555158, 0.0, 54.17335758922649, 131.5922426112305, 1.0515024123846184, 119.05980597895365, 36.62393073860571, 126.16249015041168, 294.04458931930264, 58.43138602720072, 27.098306487098423, 43.366658498089144, 101.5982771707111, 77.69808380843789, 92.33601550180148, 69.17740583328944, 11.711242094735995, 97.91032777106007, 159.598841430636, 144.42881435000547, 256.62014258831397, 83.17326937041157, 64.7437860571049, 182.14132692717635, 121.33488994630724, 3.428971835429686, 17.92887165747148, 61.97318819646065, 71.37501564844887, 195.79699114833366, 50.574776505310986, 49.41217620680031, 95.99190856070484, 133.02817899556257, 118.64992189155714, 44.429110259031575, 173.65858800042827, 294.7987946549283, 219.5255437438939, 58.84984999166302, 153.020176017792, 148.6350451107507, 84.92152900727922, 86.59987230581754, 35.917401426461, 256.72903135113984, 310.86582010807547, 62.23254304989086, 95.58973110505788, 76.50819038770996, 122.80345328028605, 155.79070810226966, 62.740528734875355, 50.312344307454744, 388.3350217575325, 13.51400281733393, 276.4934910271924, 282.6228917498557, 228.37632836739596, 14.384633174866076, 36.51525084053167, 377.03702896531087, 55.843560999739694, 94.38008995249868, 186.75715567238382, 3.338471062991101, 341.8826036480012, 4.298675114714987, 61.56155472910194, 75.84484689398705, 39.31993402285901, 36.68605729351662, 9.025998199295913, 32.16223211325439, 17.067987561023646, 78.50917759223691, 86.89305015310855, 85.34873130728765, 32.98846306649877, 46.31927657317061, 3.2969657078063443, 120.15435256341586, 51.96603493554656, 113.08180586595923, 51.82953263144456, 147.2709014897984, 28.814437033388117, 169.02459312393165, 122.3689401027523, 69.27638990552909, 2.934690635903009, 71.85406764413669, 69.17481916505344, 16.220654559082863, 82.67464346074956, 54.88464781895127, 149.0452344703959, 85.05170701639402, 61.64654055235777, 6.308513636455049, 122.72811266075166, 9.76569171381375, 28.196503312525255, 11.990037592432142, 39.59465245581429, 93.77925190682629, 173.417858483239, 6.14133330985798, 15.762281811455798, 134.36623570047647, 76.06028203580479, 74.22850676175635, 34.695476680536935, 159.6621907988072, 167.2233660646181, 158.99304802466287, 125.23519084767717, 31.268484989044566, 88.54768969882797, 57.09944401112018, 170.03924007813922, 8.135051974358213, 21.451638560862875, 76.27928161334323, 145.09089770133772, 0.7242794915378635, 119.58478321201947, 55.07339965509877, 101.30347201003724, 267.44746563530987, 25.72851731642294, 50.2482358311191, 10.105741511511418, 193.0090328936931, 242.16798791533478, 39.648464187783205, 159.3499139561802, 28.118359652455005, 62.6282279289202, 164.83895649669932, 73.18508403053936, 110.16493654962441, 168.40666761692708, 267.8603886072499, 213.90796331236706, 124.17924132120368, 231.43704446725934, 63.34348446791769, 164.82322943616253, 100.95781545605833, 192.6461275375021, 19.887349329554755, 38.363775037738804, 35.81596858271153, 113.3458349053624, 230.7853915479533, 54.85288701360539, 39.375153673344265, 203.76325915064663, 1.2486882150991712, 111.99514158105654, 174.21926844518845, 10.863772486422565, 246.3828621771652, 23.366795255903288, 1.686513537743613, 3.0493282149260565, 143.97200227841205, 11.169618052507685, 151.88844071902219, 78.45110531031017, 178.76726219687225, 5.491533832319006, 183.23617029079, 53.44679168121165, 100.62718867369004, 51.62880880817706, 4.512686208328209, 171.62334218999183, 202.77443414774723, 128.4407517753692, 43.32782179174049, 246.32318803637418, 132.52041148399576, 85.60806980806116, 98.80891037849513, 185.52092658311363, 103.72089663179854]}, "sampler_perf": {"mean_raw_obs_processing_ms": 24.612889016885457, "mean_inference_ms": 21.186329230406663, "mean_action_processing_ms": 5.908154806035579, "mean_env_wait_ms": 37.33530745612723, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.09543001651763916, "StateBufferConnector_ms": 0.03673684597015381, "ViewRequirementAgentConnector_ms": 1.255206823348999}, "num_episodes": 0, "episode_return_max": 286.6692231913454, "episode_return_min": -53.94695511723343, "episode_return_mean": 102.60472273081903, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 149312, "num_agent_steps_trained": 149312, "num_env_steps_sampled": 37328, "num_env_steps_trained": 37328, "num_env_steps_sampled_this_iter": 0, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 0.0, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 37328, "num_env_steps_sampled_lifetime": 37328, "num_agent_steps_sampled_lifetime": 149312, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 149312, "timers": {"training_iteration_time_ms": 61533.452, "restore_workers_time_ms": 18.175, "training_step_time_ms": 61461.353, "sample_time_ms": 61438.596, "learn_time_ms": 311236.026, "learn_throughput": 59.967, "synch_weights_time_ms": 43.334}, "counters": {"num_env_steps_sampled": 37328, "num_env_steps_trained": 37328, "num_agent_steps_sampled": 149312, "num_agent_steps_trained": 149312}, "done": false, "training_iteration": 64, "trial_id": "d7bca_00000", "date": "2024-08-20_13-25-11", "timestamp": 1724140511, "time_this_iter_s": 129.88549780845642, "time_total_s": 9014.41062951088, "pid": 36059, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 16000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3ae8b80d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 9014.41062951088, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 75.86740331491713, "ram_util_percent": 85.69889502762432}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {}, "num_env_steps_sampled": 37328, "num_env_steps_trained": 37328, "num_agent_steps_sampled": 149312, "num_agent_steps_trained": 149312}, "env_runners": {"episode_reward_max": 286.6692231913454, "episode_reward_min": -53.94695511723343, "episode_reward_mean": 102.60472273081903, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -382.5350217575324, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 179.13622751357744, "predator_policy": 388.3350217575325}, "policy_reward_mean": {"prey_policy": -50.61742331228365, "predator_policy": 101.91978467769317}, "custom_metrics": {}, "hist_stats": {"episode_reward": [35.10000000000023, -2.2956613079459616, 52.30000000000035, 93.99999999999946, 41.27668545957155, 138.35998813581944, 47.000000000000355, 189.59999999999982, 46.100000000000314, 122.59999999999911, 172.99184762314727, 183.89999999999952, 165.26660970450598, 63.400000000000325, 224.23591029611316, 118.26513246444676, 57.049342065984625, 56.287512516221504, 91.49999999999856, 77.70000000000017, 286.6692231913454, 34.20000000000022, 135.4999999999999, 189.7622134181783, 204.95900501687956, 41.46117592104707, 160.52089757879483, 41.90000000000027, 159.99999999999952, 56.25035590474681, 189.40904152072758, 32.4000000000002, 135.49999999999923, 137.09999999999957, -53.94695511723343, 170.90494465410117, 56.10000000000025, 60.20000000000013, 34.75612756781972, 43.60000000000028, 40.265044310772325, 47.1298862953699, 48.40000000000023, 36.202116310375594, 74.49999999999962, 153.19999999999987, 40.1000000000002, 131.19999999999982, 52.570622032848895, 56.000000000000156, 129.1999999999993, 86.20000000000002, 28.831075919194078, 160.79999999999959, 81.33852172443821, 103.01543537877356, 169.88064982359512, 48.30000000000023, 52.529310579969625, 48.028025438635616, 198.59999999999948, 184.470358209413, 37.06861395355878, 80.95181844992561, 33.900000000000134, 135.39999999999944, 148.89999999999955, 133.69999999999916, 226.89999999999938, 68.3000000000002, 154.45814550558052, 41.47674734270453, 180.74087067540847, 60.139037304427255, 153.66325386820998, 109.81254335834268, 96.80000000000011, 108.61895163315396, 159.3546697445331, 53.10000000000013, 125.29999999999959, 34.93780403323022, 139.0999999999999, 206.80167211533725, 40.50000000000029, 68.40000000000009, 88.29999999999927, 242.69999999999993, 37.700000000000266, 104.09999999999903, 229.34134979067687, 152.6250807412044, 157.8592262743011, 37.26670789146122, 35.20000000000023, 108.04468364708873, 87.5999999999994, 92.41177405235972, 131.94864151087714, 94.40623855187317], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [13.573129738316304, -53.54665936669982, -254.04609845621002, -260.27960040372835, -140.65478211067654, -73.1171426718985, 39.583255312047925, -34.03651010327775, -114.83317908671795, -92.66853807147267, -96.4272326280199, 93.09870255859556, -64.80740741555226, 20.000000000000014, 20.626642410773584, -16.792242611230414, 18.848497587615384, -92.85980597895414, 69.17606926139403, -109.36249015041209, -285.2321358475945, 105.74800812423979, 132.7888944272447, -19.35385941243218, -25.356623210719427, 11.326871936077456, -78.03601550180139, -20.07740583328924, 28.904313331271958, 85.71002709904536, -84.17058524148602, -101.59193807470932, -247.8691803256373, -34.87488956710395, -49.40531904969436, -141.19228141836533, -107.134889946308, 73.87102816456981, 4.171128342528487, -6.373188196460497, 72.0443042732162, -52.54708787865346, -32.67477650531073, -33.11217620680012, 17.408091439294907, -110.92817899556306, 80.28766474857159, -53.604483480981195, 64.90005398718623, -328.3984316256627, -221.37365036394135, -15.540567450569034, -217.97172194166885, 76.83739839192134, -62.4215290072797, -67.19987230581766, 82.82590198976501, -215.4723347673664, -63.01766150909464, -253.83034574412602, -72.05610867549865, 89.36722870345912, -103.9034532802869, -142.29070810227037, 0.5594712651248201, 21.887655692545323, -382.5350217575324, 117.78599718266575, -341.68754507993606, -271.3757928143444, 42.05974767402415, -113.91576456218526, 10.584749159468316, -368.0370289653096, -96.60173288891873, 6.578081936680414, -116.41208622158636, -38.927412945968925, -335.88260364800084, 33.30132488528524, -27.102952922490367, -70.03840438982733, -11.808869660467748, -17.067235360537826, 10.174001800704053, -2.962232113254194, -5.251613856427011, -54.123434986458186, -77.75098136410048, -19.99080009629646, 33.88040540161318, 40.0118549587175, 18.203034292193653, -101.55435256341609, 84.66934503983893, -118.51718584134521, -111.25275039532056, -35.27706169307365, 12.962713255211035, -154.80174341253127, -108.368940102753, 45.92361009447094, 66.26530936409696, -54.85406764413665, -50.32982812857711, -6.234569676365133, 43.52535653925046, -20.284647818951065, -122.72911794687963, -30.02930181547257, 64.88866316909824, -29.828281979136015, 27.845266783971347, 9.541578665059246, 1.103496687474779, 7.009962407567832, -8.299879170194934, -72.54471461247661, -97.58563081684744, -33.94553553761412, 161.42330774007206, -112.95182525200485, -6.1055308568346724, 40.28710026868663, -159.2584299113319, 1.9693763855458568, -203.51123731867187, -41.75335832068283, -112.73519084767737, -9.86848498904447, -75.14768969882805, 64.9005559888798, -41.26096743109789, 11.98667537860044, 89.1022150662958, -53.133135240501986, -21.790897701337713, 102.87572050846154, -103.60518017643587, -2.753002690682439, -77.5059788586302, -136.78681328113666, -35.26167272819433, 0.7616669233566751, 99.3892737675306, -121.76317749732668, -221.41484542454427, -0.26256937414734516, -81.64046493632515, 47.835445195899766, 41.62225202827415, -159.27689309555132, 8.414915969460758, -94.96493654962522, -101.89030278114168, -225.75780180988139, 42.3879814213417, -221.12051631037914, -194.2370444672595, -47.443484467917465, -68.94976936260595, -71.53127552961595, -175.21866179031935, -2.377011043507998, 7.336224962261236, 57.5840314172886, 148.94400313475802, -286.27355747273646, -38.05288701360526, -15.675153673344045, -157.06325915064687, 20.451311784900852, -34.19514158105644, -163.71926844518902, 179.13622751357744, -193.68286217716528, -5.466795255903271, 18.11348646225638, 73.35067178507347, -116.27200227841195, 81.3532898949211, -15.069998875773695, -1.5790888906085807, -103.01419787536915, 39.20269946596015, -70.07117731476804, -109.82064133551206, -6.986631127929058, -36.128808808176835, 15.187313791671755, -14.673585565722401, -251.67950712492743, 6.628822658497688, -90.79739622560763, -223.17849208443, -63.253333383580255, -19.653256456869457, -32.815082218808726, 25.002451968907792, -219.83803663194715], "policy_predator_policy_reward": [5.826870261683667, 69.24665936669969, 324.2059226722713, 187.82411487972215, 153.05478211067583, 113.01714267189817, 17.61674468795218, 70.83651010327776, 56.871368154986286, 191.90703446277513, 141.68851820524378, 0.0, 91.80740741555158, 0.0, 54.17335758922649, 131.5922426112305, 1.0515024123846184, 119.05980597895365, 36.62393073860571, 126.16249015041168, 294.04458931930264, 58.43138602720072, 27.098306487098423, 43.366658498089144, 101.5982771707111, 77.69808380843789, 92.33601550180148, 69.17740583328944, 11.711242094735995, 97.91032777106007, 159.598841430636, 144.42881435000547, 256.62014258831397, 83.17326937041157, 64.7437860571049, 182.14132692717635, 121.33488994630724, 3.428971835429686, 17.92887165747148, 61.97318819646065, 71.37501564844887, 195.79699114833366, 50.574776505310986, 49.41217620680031, 95.99190856070484, 133.02817899556257, 118.64992189155714, 44.429110259031575, 173.65858800042827, 294.7987946549283, 219.5255437438939, 58.84984999166302, 153.020176017792, 148.6350451107507, 84.92152900727922, 86.59987230581754, 35.917401426461, 256.72903135113984, 310.86582010807547, 62.23254304989086, 95.58973110505788, 76.50819038770996, 122.80345328028605, 155.79070810226966, 62.740528734875355, 50.312344307454744, 388.3350217575325, 13.51400281733393, 276.4934910271924, 282.6228917498557, 228.37632836739596, 14.384633174866076, 36.51525084053167, 377.03702896531087, 55.843560999739694, 94.38008995249868, 186.75715567238382, 3.338471062991101, 341.8826036480012, 4.298675114714987, 61.56155472910194, 75.84484689398705, 39.31993402285901, 36.68605729351662, 9.025998199295913, 32.16223211325439, 17.067987561023646, 78.50917759223691, 86.89305015310855, 85.34873130728765, 32.98846306649877, 46.31927657317061, 3.2969657078063443, 120.15435256341586, 51.96603493554656, 113.08180586595923, 51.82953263144456, 147.2709014897984, 28.814437033388117, 169.02459312393165, 122.3689401027523, 69.27638990552909, 2.934690635903009, 71.85406764413669, 69.17481916505344, 16.220654559082863, 82.67464346074956, 54.88464781895127, 149.0452344703959, 85.05170701639402, 61.64654055235777, 6.308513636455049, 122.72811266075166, 9.76569171381375, 28.196503312525255, 11.990037592432142, 39.59465245581429, 93.77925190682629, 173.417858483239, 6.14133330985798, 15.762281811455798, 134.36623570047647, 76.06028203580479, 74.22850676175635, 34.695476680536935, 159.6621907988072, 167.2233660646181, 158.99304802466287, 125.23519084767717, 31.268484989044566, 88.54768969882797, 57.09944401112018, 170.03924007813922, 8.135051974358213, 21.451638560862875, 76.27928161334323, 145.09089770133772, 0.7242794915378635, 119.58478321201947, 55.07339965509877, 101.30347201003724, 267.44746563530987, 25.72851731642294, 50.2482358311191, 10.105741511511418, 193.0090328936931, 242.16798791533478, 39.648464187783205, 159.3499139561802, 28.118359652455005, 62.6282279289202, 164.83895649669932, 73.18508403053936, 110.16493654962441, 168.40666761692708, 267.8603886072499, 213.90796331236706, 124.17924132120368, 231.43704446725934, 63.34348446791769, 164.82322943616253, 100.95781545605833, 192.6461275375021, 19.887349329554755, 38.363775037738804, 35.81596858271153, 113.3458349053624, 230.7853915479533, 54.85288701360539, 39.375153673344265, 203.76325915064663, 1.2486882150991712, 111.99514158105654, 174.21926844518845, 10.863772486422565, 246.3828621771652, 23.366795255903288, 1.686513537743613, 3.0493282149260565, 143.97200227841205, 11.169618052507685, 151.88844071902219, 78.45110531031017, 178.76726219687225, 5.491533832319006, 183.23617029079, 53.44679168121165, 100.62718867369004, 51.62880880817706, 4.512686208328209, 171.62334218999183, 202.77443414774723, 128.4407517753692, 43.32782179174049, 246.32318803637418, 132.52041148399576, 85.60806980806116, 98.80891037849513, 185.52092658311363, 103.72089663179854]}, "sampler_perf": {"mean_raw_obs_processing_ms": 24.612889016885457, "mean_inference_ms": 21.186329230406663, "mean_action_processing_ms": 5.908154806035579, "mean_env_wait_ms": 37.33530745612723, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.09543001651763916, "StateBufferConnector_ms": 0.03673684597015381, "ViewRequirementAgentConnector_ms": 1.255206823348999}, "num_episodes": 0, "episode_return_max": 286.6692231913454, "episode_return_min": -53.94695511723343, "episode_return_mean": 102.60472273081903, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 149312, "num_agent_steps_trained": 149312, "num_env_steps_sampled": 37328, "num_env_steps_trained": 37328, "num_env_steps_sampled_this_iter": 0, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 0.0, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 37328, "num_env_steps_sampled_lifetime": 37328, "num_agent_steps_sampled_lifetime": 149312, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 149312, "timers": {"training_iteration_time_ms": 62158.324, "restore_workers_time_ms": 38.662, "training_step_time_ms": 61985.282, "sample_time_ms": 61943.817, "learn_time_ms": 311236.026, "learn_throughput": 59.967, "synch_weights_time_ms": 43.334}, "counters": {"num_env_steps_sampled": 37328, "num_env_steps_trained": 37328, "num_agent_steps_sampled": 149312, "num_agent_steps_trained": 149312}, "done": false, "training_iteration": 65, "trial_id": "d7bca_00000", "date": "2024-08-20_13-27-59", "timestamp": 1724140679, "time_this_iter_s": 139.50472807884216, "time_total_s": 9153.915357589722, "pid": 36059, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 16000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3ae8b8670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 9153.915357589722, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 56.61106194690266, "ram_util_percent": 86.08716814159291}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {}, "num_env_steps_sampled": 37328, "num_env_steps_trained": 37328, "num_agent_steps_sampled": 149312, "num_agent_steps_trained": 149312}, "env_runners": {"episode_reward_max": 286.6692231913454, "episode_reward_min": -53.94695511723343, "episode_reward_mean": 102.60472273081903, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -382.5350217575324, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 179.13622751357744, "predator_policy": 388.3350217575325}, "policy_reward_mean": {"prey_policy": -50.61742331228365, "predator_policy": 101.91978467769317}, "custom_metrics": {}, "hist_stats": {"episode_reward": [35.10000000000023, -2.2956613079459616, 52.30000000000035, 93.99999999999946, 41.27668545957155, 138.35998813581944, 47.000000000000355, 189.59999999999982, 46.100000000000314, 122.59999999999911, 172.99184762314727, 183.89999999999952, 165.26660970450598, 63.400000000000325, 224.23591029611316, 118.26513246444676, 57.049342065984625, 56.287512516221504, 91.49999999999856, 77.70000000000017, 286.6692231913454, 34.20000000000022, 135.4999999999999, 189.7622134181783, 204.95900501687956, 41.46117592104707, 160.52089757879483, 41.90000000000027, 159.99999999999952, 56.25035590474681, 189.40904152072758, 32.4000000000002, 135.49999999999923, 137.09999999999957, -53.94695511723343, 170.90494465410117, 56.10000000000025, 60.20000000000013, 34.75612756781972, 43.60000000000028, 40.265044310772325, 47.1298862953699, 48.40000000000023, 36.202116310375594, 74.49999999999962, 153.19999999999987, 40.1000000000002, 131.19999999999982, 52.570622032848895, 56.000000000000156, 129.1999999999993, 86.20000000000002, 28.831075919194078, 160.79999999999959, 81.33852172443821, 103.01543537877356, 169.88064982359512, 48.30000000000023, 52.529310579969625, 48.028025438635616, 198.59999999999948, 184.470358209413, 37.06861395355878, 80.95181844992561, 33.900000000000134, 135.39999999999944, 148.89999999999955, 133.69999999999916, 226.89999999999938, 68.3000000000002, 154.45814550558052, 41.47674734270453, 180.74087067540847, 60.139037304427255, 153.66325386820998, 109.81254335834268, 96.80000000000011, 108.61895163315396, 159.3546697445331, 53.10000000000013, 125.29999999999959, 34.93780403323022, 139.0999999999999, 206.80167211533725, 40.50000000000029, 68.40000000000009, 88.29999999999927, 242.69999999999993, 37.700000000000266, 104.09999999999903, 229.34134979067687, 152.6250807412044, 157.8592262743011, 37.26670789146122, 35.20000000000023, 108.04468364708873, 87.5999999999994, 92.41177405235972, 131.94864151087714, 94.40623855187317], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [13.573129738316304, -53.54665936669982, -254.04609845621002, -260.27960040372835, -140.65478211067654, -73.1171426718985, 39.583255312047925, -34.03651010327775, -114.83317908671795, -92.66853807147267, -96.4272326280199, 93.09870255859556, -64.80740741555226, 20.000000000000014, 20.626642410773584, -16.792242611230414, 18.848497587615384, -92.85980597895414, 69.17606926139403, -109.36249015041209, -285.2321358475945, 105.74800812423979, 132.7888944272447, -19.35385941243218, -25.356623210719427, 11.326871936077456, -78.03601550180139, -20.07740583328924, 28.904313331271958, 85.71002709904536, -84.17058524148602, -101.59193807470932, -247.8691803256373, -34.87488956710395, -49.40531904969436, -141.19228141836533, -107.134889946308, 73.87102816456981, 4.171128342528487, -6.373188196460497, 72.0443042732162, -52.54708787865346, -32.67477650531073, -33.11217620680012, 17.408091439294907, -110.92817899556306, 80.28766474857159, -53.604483480981195, 64.90005398718623, -328.3984316256627, -221.37365036394135, -15.540567450569034, -217.97172194166885, 76.83739839192134, -62.4215290072797, -67.19987230581766, 82.82590198976501, -215.4723347673664, -63.01766150909464, -253.83034574412602, -72.05610867549865, 89.36722870345912, -103.9034532802869, -142.29070810227037, 0.5594712651248201, 21.887655692545323, -382.5350217575324, 117.78599718266575, -341.68754507993606, -271.3757928143444, 42.05974767402415, -113.91576456218526, 10.584749159468316, -368.0370289653096, -96.60173288891873, 6.578081936680414, -116.41208622158636, -38.927412945968925, -335.88260364800084, 33.30132488528524, -27.102952922490367, -70.03840438982733, -11.808869660467748, -17.067235360537826, 10.174001800704053, -2.962232113254194, -5.251613856427011, -54.123434986458186, -77.75098136410048, -19.99080009629646, 33.88040540161318, 40.0118549587175, 18.203034292193653, -101.55435256341609, 84.66934503983893, -118.51718584134521, -111.25275039532056, -35.27706169307365, 12.962713255211035, -154.80174341253127, -108.368940102753, 45.92361009447094, 66.26530936409696, -54.85406764413665, -50.32982812857711, -6.234569676365133, 43.52535653925046, -20.284647818951065, -122.72911794687963, -30.02930181547257, 64.88866316909824, -29.828281979136015, 27.845266783971347, 9.541578665059246, 1.103496687474779, 7.009962407567832, -8.299879170194934, -72.54471461247661, -97.58563081684744, -33.94553553761412, 161.42330774007206, -112.95182525200485, -6.1055308568346724, 40.28710026868663, -159.2584299113319, 1.9693763855458568, -203.51123731867187, -41.75335832068283, -112.73519084767737, -9.86848498904447, -75.14768969882805, 64.9005559888798, -41.26096743109789, 11.98667537860044, 89.1022150662958, -53.133135240501986, -21.790897701337713, 102.87572050846154, -103.60518017643587, -2.753002690682439, -77.5059788586302, -136.78681328113666, -35.26167272819433, 0.7616669233566751, 99.3892737675306, -121.76317749732668, -221.41484542454427, -0.26256937414734516, -81.64046493632515, 47.835445195899766, 41.62225202827415, -159.27689309555132, 8.414915969460758, -94.96493654962522, -101.89030278114168, -225.75780180988139, 42.3879814213417, -221.12051631037914, -194.2370444672595, -47.443484467917465, -68.94976936260595, -71.53127552961595, -175.21866179031935, -2.377011043507998, 7.336224962261236, 57.5840314172886, 148.94400313475802, -286.27355747273646, -38.05288701360526, -15.675153673344045, -157.06325915064687, 20.451311784900852, -34.19514158105644, -163.71926844518902, 179.13622751357744, -193.68286217716528, -5.466795255903271, 18.11348646225638, 73.35067178507347, -116.27200227841195, 81.3532898949211, -15.069998875773695, -1.5790888906085807, -103.01419787536915, 39.20269946596015, -70.07117731476804, -109.82064133551206, -6.986631127929058, -36.128808808176835, 15.187313791671755, -14.673585565722401, -251.67950712492743, 6.628822658497688, -90.79739622560763, -223.17849208443, -63.253333383580255, -19.653256456869457, -32.815082218808726, 25.002451968907792, -219.83803663194715], "policy_predator_policy_reward": [5.826870261683667, 69.24665936669969, 324.2059226722713, 187.82411487972215, 153.05478211067583, 113.01714267189817, 17.61674468795218, 70.83651010327776, 56.871368154986286, 191.90703446277513, 141.68851820524378, 0.0, 91.80740741555158, 0.0, 54.17335758922649, 131.5922426112305, 1.0515024123846184, 119.05980597895365, 36.62393073860571, 126.16249015041168, 294.04458931930264, 58.43138602720072, 27.098306487098423, 43.366658498089144, 101.5982771707111, 77.69808380843789, 92.33601550180148, 69.17740583328944, 11.711242094735995, 97.91032777106007, 159.598841430636, 144.42881435000547, 256.62014258831397, 83.17326937041157, 64.7437860571049, 182.14132692717635, 121.33488994630724, 3.428971835429686, 17.92887165747148, 61.97318819646065, 71.37501564844887, 195.79699114833366, 50.574776505310986, 49.41217620680031, 95.99190856070484, 133.02817899556257, 118.64992189155714, 44.429110259031575, 173.65858800042827, 294.7987946549283, 219.5255437438939, 58.84984999166302, 153.020176017792, 148.6350451107507, 84.92152900727922, 86.59987230581754, 35.917401426461, 256.72903135113984, 310.86582010807547, 62.23254304989086, 95.58973110505788, 76.50819038770996, 122.80345328028605, 155.79070810226966, 62.740528734875355, 50.312344307454744, 388.3350217575325, 13.51400281733393, 276.4934910271924, 282.6228917498557, 228.37632836739596, 14.384633174866076, 36.51525084053167, 377.03702896531087, 55.843560999739694, 94.38008995249868, 186.75715567238382, 3.338471062991101, 341.8826036480012, 4.298675114714987, 61.56155472910194, 75.84484689398705, 39.31993402285901, 36.68605729351662, 9.025998199295913, 32.16223211325439, 17.067987561023646, 78.50917759223691, 86.89305015310855, 85.34873130728765, 32.98846306649877, 46.31927657317061, 3.2969657078063443, 120.15435256341586, 51.96603493554656, 113.08180586595923, 51.82953263144456, 147.2709014897984, 28.814437033388117, 169.02459312393165, 122.3689401027523, 69.27638990552909, 2.934690635903009, 71.85406764413669, 69.17481916505344, 16.220654559082863, 82.67464346074956, 54.88464781895127, 149.0452344703959, 85.05170701639402, 61.64654055235777, 6.308513636455049, 122.72811266075166, 9.76569171381375, 28.196503312525255, 11.990037592432142, 39.59465245581429, 93.77925190682629, 173.417858483239, 6.14133330985798, 15.762281811455798, 134.36623570047647, 76.06028203580479, 74.22850676175635, 34.695476680536935, 159.6621907988072, 167.2233660646181, 158.99304802466287, 125.23519084767717, 31.268484989044566, 88.54768969882797, 57.09944401112018, 170.03924007813922, 8.135051974358213, 21.451638560862875, 76.27928161334323, 145.09089770133772, 0.7242794915378635, 119.58478321201947, 55.07339965509877, 101.30347201003724, 267.44746563530987, 25.72851731642294, 50.2482358311191, 10.105741511511418, 193.0090328936931, 242.16798791533478, 39.648464187783205, 159.3499139561802, 28.118359652455005, 62.6282279289202, 164.83895649669932, 73.18508403053936, 110.16493654962441, 168.40666761692708, 267.8603886072499, 213.90796331236706, 124.17924132120368, 231.43704446725934, 63.34348446791769, 164.82322943616253, 100.95781545605833, 192.6461275375021, 19.887349329554755, 38.363775037738804, 35.81596858271153, 113.3458349053624, 230.7853915479533, 54.85288701360539, 39.375153673344265, 203.76325915064663, 1.2486882150991712, 111.99514158105654, 174.21926844518845, 10.863772486422565, 246.3828621771652, 23.366795255903288, 1.686513537743613, 3.0493282149260565, 143.97200227841205, 11.169618052507685, 151.88844071902219, 78.45110531031017, 178.76726219687225, 5.491533832319006, 183.23617029079, 53.44679168121165, 100.62718867369004, 51.62880880817706, 4.512686208328209, 171.62334218999183, 202.77443414774723, 128.4407517753692, 43.32782179174049, 246.32318803637418, 132.52041148399576, 85.60806980806116, 98.80891037849513, 185.52092658311363, 103.72089663179854]}, "sampler_perf": {"mean_raw_obs_processing_ms": 24.612889016885457, "mean_inference_ms": 21.186329230406663, "mean_action_processing_ms": 5.908154806035579, "mean_env_wait_ms": 37.33530745612723, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.09543001651763916, "StateBufferConnector_ms": 0.03673684597015381, "ViewRequirementAgentConnector_ms": 1.255206823348999}, "num_episodes": 0, "episode_return_max": 286.6692231913454, "episode_return_min": -53.94695511723343, "episode_return_mean": 102.60472273081903, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 149312, "num_agent_steps_trained": 149312, "num_env_steps_sampled": 37328, "num_env_steps_trained": 37328, "num_env_steps_sampled_this_iter": 0, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 0.0, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 37328, "num_env_steps_sampled_lifetime": 37328, "num_agent_steps_sampled_lifetime": 149312, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 149312, "timers": {"training_iteration_time_ms": 62870.497, "restore_workers_time_ms": 95.229, "training_step_time_ms": 62573.391, "sample_time_ms": 62492.129, "learn_time_ms": 311236.026, "learn_throughput": 59.967, "synch_weights_time_ms": 43.334}, "counters": {"num_env_steps_sampled": 37328, "num_env_steps_trained": 37328, "num_agent_steps_sampled": 149312, "num_agent_steps_trained": 149312}, "done": false, "training_iteration": 66, "trial_id": "d7bca_00000", "date": "2024-08-20_13-30-51", "timestamp": 1724140851, "time_this_iter_s": 140.62999868392944, "time_total_s": 9294.545356273651, "pid": 36059, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 16000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3ae8b8700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 9294.545356273651, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 37.502586206896545, "ram_util_percent": 84.7271551724138}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {}, "num_env_steps_sampled": 37328, "num_env_steps_trained": 37328, "num_agent_steps_sampled": 149312, "num_agent_steps_trained": 149312}, "env_runners": {"episode_reward_max": 286.6692231913454, "episode_reward_min": -53.94695511723343, "episode_reward_mean": 102.60472273081903, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -382.5350217575324, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 179.13622751357744, "predator_policy": 388.3350217575325}, "policy_reward_mean": {"prey_policy": -50.61742331228365, "predator_policy": 101.91978467769317}, "custom_metrics": {}, "hist_stats": {"episode_reward": [35.10000000000023, -2.2956613079459616, 52.30000000000035, 93.99999999999946, 41.27668545957155, 138.35998813581944, 47.000000000000355, 189.59999999999982, 46.100000000000314, 122.59999999999911, 172.99184762314727, 183.89999999999952, 165.26660970450598, 63.400000000000325, 224.23591029611316, 118.26513246444676, 57.049342065984625, 56.287512516221504, 91.49999999999856, 77.70000000000017, 286.6692231913454, 34.20000000000022, 135.4999999999999, 189.7622134181783, 204.95900501687956, 41.46117592104707, 160.52089757879483, 41.90000000000027, 159.99999999999952, 56.25035590474681, 189.40904152072758, 32.4000000000002, 135.49999999999923, 137.09999999999957, -53.94695511723343, 170.90494465410117, 56.10000000000025, 60.20000000000013, 34.75612756781972, 43.60000000000028, 40.265044310772325, 47.1298862953699, 48.40000000000023, 36.202116310375594, 74.49999999999962, 153.19999999999987, 40.1000000000002, 131.19999999999982, 52.570622032848895, 56.000000000000156, 129.1999999999993, 86.20000000000002, 28.831075919194078, 160.79999999999959, 81.33852172443821, 103.01543537877356, 169.88064982359512, 48.30000000000023, 52.529310579969625, 48.028025438635616, 198.59999999999948, 184.470358209413, 37.06861395355878, 80.95181844992561, 33.900000000000134, 135.39999999999944, 148.89999999999955, 133.69999999999916, 226.89999999999938, 68.3000000000002, 154.45814550558052, 41.47674734270453, 180.74087067540847, 60.139037304427255, 153.66325386820998, 109.81254335834268, 96.80000000000011, 108.61895163315396, 159.3546697445331, 53.10000000000013, 125.29999999999959, 34.93780403323022, 139.0999999999999, 206.80167211533725, 40.50000000000029, 68.40000000000009, 88.29999999999927, 242.69999999999993, 37.700000000000266, 104.09999999999903, 229.34134979067687, 152.6250807412044, 157.8592262743011, 37.26670789146122, 35.20000000000023, 108.04468364708873, 87.5999999999994, 92.41177405235972, 131.94864151087714, 94.40623855187317], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [13.573129738316304, -53.54665936669982, -254.04609845621002, -260.27960040372835, -140.65478211067654, -73.1171426718985, 39.583255312047925, -34.03651010327775, -114.83317908671795, -92.66853807147267, -96.4272326280199, 93.09870255859556, -64.80740741555226, 20.000000000000014, 20.626642410773584, -16.792242611230414, 18.848497587615384, -92.85980597895414, 69.17606926139403, -109.36249015041209, -285.2321358475945, 105.74800812423979, 132.7888944272447, -19.35385941243218, -25.356623210719427, 11.326871936077456, -78.03601550180139, -20.07740583328924, 28.904313331271958, 85.71002709904536, -84.17058524148602, -101.59193807470932, -247.8691803256373, -34.87488956710395, -49.40531904969436, -141.19228141836533, -107.134889946308, 73.87102816456981, 4.171128342528487, -6.373188196460497, 72.0443042732162, -52.54708787865346, -32.67477650531073, -33.11217620680012, 17.408091439294907, -110.92817899556306, 80.28766474857159, -53.604483480981195, 64.90005398718623, -328.3984316256627, -221.37365036394135, -15.540567450569034, -217.97172194166885, 76.83739839192134, -62.4215290072797, -67.19987230581766, 82.82590198976501, -215.4723347673664, -63.01766150909464, -253.83034574412602, -72.05610867549865, 89.36722870345912, -103.9034532802869, -142.29070810227037, 0.5594712651248201, 21.887655692545323, -382.5350217575324, 117.78599718266575, -341.68754507993606, -271.3757928143444, 42.05974767402415, -113.91576456218526, 10.584749159468316, -368.0370289653096, -96.60173288891873, 6.578081936680414, -116.41208622158636, -38.927412945968925, -335.88260364800084, 33.30132488528524, -27.102952922490367, -70.03840438982733, -11.808869660467748, -17.067235360537826, 10.174001800704053, -2.962232113254194, -5.251613856427011, -54.123434986458186, -77.75098136410048, -19.99080009629646, 33.88040540161318, 40.0118549587175, 18.203034292193653, -101.55435256341609, 84.66934503983893, -118.51718584134521, -111.25275039532056, -35.27706169307365, 12.962713255211035, -154.80174341253127, -108.368940102753, 45.92361009447094, 66.26530936409696, -54.85406764413665, -50.32982812857711, -6.234569676365133, 43.52535653925046, -20.284647818951065, -122.72911794687963, -30.02930181547257, 64.88866316909824, -29.828281979136015, 27.845266783971347, 9.541578665059246, 1.103496687474779, 7.009962407567832, -8.299879170194934, -72.54471461247661, -97.58563081684744, -33.94553553761412, 161.42330774007206, -112.95182525200485, -6.1055308568346724, 40.28710026868663, -159.2584299113319, 1.9693763855458568, -203.51123731867187, -41.75335832068283, -112.73519084767737, -9.86848498904447, -75.14768969882805, 64.9005559888798, -41.26096743109789, 11.98667537860044, 89.1022150662958, -53.133135240501986, -21.790897701337713, 102.87572050846154, -103.60518017643587, -2.753002690682439, -77.5059788586302, -136.78681328113666, -35.26167272819433, 0.7616669233566751, 99.3892737675306, -121.76317749732668, -221.41484542454427, -0.26256937414734516, -81.64046493632515, 47.835445195899766, 41.62225202827415, -159.27689309555132, 8.414915969460758, -94.96493654962522, -101.89030278114168, -225.75780180988139, 42.3879814213417, -221.12051631037914, -194.2370444672595, -47.443484467917465, -68.94976936260595, -71.53127552961595, -175.21866179031935, -2.377011043507998, 7.336224962261236, 57.5840314172886, 148.94400313475802, -286.27355747273646, -38.05288701360526, -15.675153673344045, -157.06325915064687, 20.451311784900852, -34.19514158105644, -163.71926844518902, 179.13622751357744, -193.68286217716528, -5.466795255903271, 18.11348646225638, 73.35067178507347, -116.27200227841195, 81.3532898949211, -15.069998875773695, -1.5790888906085807, -103.01419787536915, 39.20269946596015, -70.07117731476804, -109.82064133551206, -6.986631127929058, -36.128808808176835, 15.187313791671755, -14.673585565722401, -251.67950712492743, 6.628822658497688, -90.79739622560763, -223.17849208443, -63.253333383580255, -19.653256456869457, -32.815082218808726, 25.002451968907792, -219.83803663194715], "policy_predator_policy_reward": [5.826870261683667, 69.24665936669969, 324.2059226722713, 187.82411487972215, 153.05478211067583, 113.01714267189817, 17.61674468795218, 70.83651010327776, 56.871368154986286, 191.90703446277513, 141.68851820524378, 0.0, 91.80740741555158, 0.0, 54.17335758922649, 131.5922426112305, 1.0515024123846184, 119.05980597895365, 36.62393073860571, 126.16249015041168, 294.04458931930264, 58.43138602720072, 27.098306487098423, 43.366658498089144, 101.5982771707111, 77.69808380843789, 92.33601550180148, 69.17740583328944, 11.711242094735995, 97.91032777106007, 159.598841430636, 144.42881435000547, 256.62014258831397, 83.17326937041157, 64.7437860571049, 182.14132692717635, 121.33488994630724, 3.428971835429686, 17.92887165747148, 61.97318819646065, 71.37501564844887, 195.79699114833366, 50.574776505310986, 49.41217620680031, 95.99190856070484, 133.02817899556257, 118.64992189155714, 44.429110259031575, 173.65858800042827, 294.7987946549283, 219.5255437438939, 58.84984999166302, 153.020176017792, 148.6350451107507, 84.92152900727922, 86.59987230581754, 35.917401426461, 256.72903135113984, 310.86582010807547, 62.23254304989086, 95.58973110505788, 76.50819038770996, 122.80345328028605, 155.79070810226966, 62.740528734875355, 50.312344307454744, 388.3350217575325, 13.51400281733393, 276.4934910271924, 282.6228917498557, 228.37632836739596, 14.384633174866076, 36.51525084053167, 377.03702896531087, 55.843560999739694, 94.38008995249868, 186.75715567238382, 3.338471062991101, 341.8826036480012, 4.298675114714987, 61.56155472910194, 75.84484689398705, 39.31993402285901, 36.68605729351662, 9.025998199295913, 32.16223211325439, 17.067987561023646, 78.50917759223691, 86.89305015310855, 85.34873130728765, 32.98846306649877, 46.31927657317061, 3.2969657078063443, 120.15435256341586, 51.96603493554656, 113.08180586595923, 51.82953263144456, 147.2709014897984, 28.814437033388117, 169.02459312393165, 122.3689401027523, 69.27638990552909, 2.934690635903009, 71.85406764413669, 69.17481916505344, 16.220654559082863, 82.67464346074956, 54.88464781895127, 149.0452344703959, 85.05170701639402, 61.64654055235777, 6.308513636455049, 122.72811266075166, 9.76569171381375, 28.196503312525255, 11.990037592432142, 39.59465245581429, 93.77925190682629, 173.417858483239, 6.14133330985798, 15.762281811455798, 134.36623570047647, 76.06028203580479, 74.22850676175635, 34.695476680536935, 159.6621907988072, 167.2233660646181, 158.99304802466287, 125.23519084767717, 31.268484989044566, 88.54768969882797, 57.09944401112018, 170.03924007813922, 8.135051974358213, 21.451638560862875, 76.27928161334323, 145.09089770133772, 0.7242794915378635, 119.58478321201947, 55.07339965509877, 101.30347201003724, 267.44746563530987, 25.72851731642294, 50.2482358311191, 10.105741511511418, 193.0090328936931, 242.16798791533478, 39.648464187783205, 159.3499139561802, 28.118359652455005, 62.6282279289202, 164.83895649669932, 73.18508403053936, 110.16493654962441, 168.40666761692708, 267.8603886072499, 213.90796331236706, 124.17924132120368, 231.43704446725934, 63.34348446791769, 164.82322943616253, 100.95781545605833, 192.6461275375021, 19.887349329554755, 38.363775037738804, 35.81596858271153, 113.3458349053624, 230.7853915479533, 54.85288701360539, 39.375153673344265, 203.76325915064663, 1.2486882150991712, 111.99514158105654, 174.21926844518845, 10.863772486422565, 246.3828621771652, 23.366795255903288, 1.686513537743613, 3.0493282149260565, 143.97200227841205, 11.169618052507685, 151.88844071902219, 78.45110531031017, 178.76726219687225, 5.491533832319006, 183.23617029079, 53.44679168121165, 100.62718867369004, 51.62880880817706, 4.512686208328209, 171.62334218999183, 202.77443414774723, 128.4407517753692, 43.32782179174049, 246.32318803637418, 132.52041148399576, 85.60806980806116, 98.80891037849513, 185.52092658311363, 103.72089663179854]}, "sampler_perf": {"mean_raw_obs_processing_ms": 24.612889016885457, "mean_inference_ms": 21.186329230406663, "mean_action_processing_ms": 5.908154806035579, "mean_env_wait_ms": 37.33530745612723, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.09543001651763916, "StateBufferConnector_ms": 0.03673684597015381, "ViewRequirementAgentConnector_ms": 1.255206823348999}, "num_episodes": 0, "episode_return_max": 286.6692231913454, "episode_return_min": -53.94695511723343, "episode_return_mean": 102.60472273081903, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 149312, "num_agent_steps_trained": 149312, "num_env_steps_sampled": 37328, "num_env_steps_trained": 37328, "num_env_steps_sampled_this_iter": 0, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 0.0, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 37328, "num_env_steps_sampled_lifetime": 37328, "num_agent_steps_sampled_lifetime": 149312, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 149312, "timers": {"training_iteration_time_ms": 63458.788, "restore_workers_time_ms": 113.941, "training_step_time_ms": 63119.659, "sample_time_ms": 63027.302, "learn_time_ms": 311236.026, "learn_throughput": 59.967, "synch_weights_time_ms": 43.334}, "counters": {"num_env_steps_sampled": 37328, "num_env_steps_trained": 37328, "num_agent_steps_sampled": 149312, "num_agent_steps_trained": 149312}, "done": false, "training_iteration": 67, "trial_id": "d7bca_00000", "date": "2024-08-20_13-33-45", "timestamp": 1724141025, "time_this_iter_s": 133.66564083099365, "time_total_s": 9428.210997104645, "pid": 36059, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 16000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x32cf5c0d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 9428.210997104645, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 33.3079831932773, "ram_util_percent": 85.10042016806723}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {}, "num_env_steps_sampled": 37328, "num_env_steps_trained": 37328, "num_agent_steps_sampled": 149312, "num_agent_steps_trained": 149312}, "env_runners": {"episode_reward_max": 286.6692231913454, "episode_reward_min": -53.94695511723343, "episode_reward_mean": 102.60472273081903, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -382.5350217575324, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 179.13622751357744, "predator_policy": 388.3350217575325}, "policy_reward_mean": {"prey_policy": -50.61742331228365, "predator_policy": 101.91978467769317}, "custom_metrics": {}, "hist_stats": {"episode_reward": [35.10000000000023, -2.2956613079459616, 52.30000000000035, 93.99999999999946, 41.27668545957155, 138.35998813581944, 47.000000000000355, 189.59999999999982, 46.100000000000314, 122.59999999999911, 172.99184762314727, 183.89999999999952, 165.26660970450598, 63.400000000000325, 224.23591029611316, 118.26513246444676, 57.049342065984625, 56.287512516221504, 91.49999999999856, 77.70000000000017, 286.6692231913454, 34.20000000000022, 135.4999999999999, 189.7622134181783, 204.95900501687956, 41.46117592104707, 160.52089757879483, 41.90000000000027, 159.99999999999952, 56.25035590474681, 189.40904152072758, 32.4000000000002, 135.49999999999923, 137.09999999999957, -53.94695511723343, 170.90494465410117, 56.10000000000025, 60.20000000000013, 34.75612756781972, 43.60000000000028, 40.265044310772325, 47.1298862953699, 48.40000000000023, 36.202116310375594, 74.49999999999962, 153.19999999999987, 40.1000000000002, 131.19999999999982, 52.570622032848895, 56.000000000000156, 129.1999999999993, 86.20000000000002, 28.831075919194078, 160.79999999999959, 81.33852172443821, 103.01543537877356, 169.88064982359512, 48.30000000000023, 52.529310579969625, 48.028025438635616, 198.59999999999948, 184.470358209413, 37.06861395355878, 80.95181844992561, 33.900000000000134, 135.39999999999944, 148.89999999999955, 133.69999999999916, 226.89999999999938, 68.3000000000002, 154.45814550558052, 41.47674734270453, 180.74087067540847, 60.139037304427255, 153.66325386820998, 109.81254335834268, 96.80000000000011, 108.61895163315396, 159.3546697445331, 53.10000000000013, 125.29999999999959, 34.93780403323022, 139.0999999999999, 206.80167211533725, 40.50000000000029, 68.40000000000009, 88.29999999999927, 242.69999999999993, 37.700000000000266, 104.09999999999903, 229.34134979067687, 152.6250807412044, 157.8592262743011, 37.26670789146122, 35.20000000000023, 108.04468364708873, 87.5999999999994, 92.41177405235972, 131.94864151087714, 94.40623855187317], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [13.573129738316304, -53.54665936669982, -254.04609845621002, -260.27960040372835, -140.65478211067654, -73.1171426718985, 39.583255312047925, -34.03651010327775, -114.83317908671795, -92.66853807147267, -96.4272326280199, 93.09870255859556, -64.80740741555226, 20.000000000000014, 20.626642410773584, -16.792242611230414, 18.848497587615384, -92.85980597895414, 69.17606926139403, -109.36249015041209, -285.2321358475945, 105.74800812423979, 132.7888944272447, -19.35385941243218, -25.356623210719427, 11.326871936077456, -78.03601550180139, -20.07740583328924, 28.904313331271958, 85.71002709904536, -84.17058524148602, -101.59193807470932, -247.8691803256373, -34.87488956710395, -49.40531904969436, -141.19228141836533, -107.134889946308, 73.87102816456981, 4.171128342528487, -6.373188196460497, 72.0443042732162, -52.54708787865346, -32.67477650531073, -33.11217620680012, 17.408091439294907, -110.92817899556306, 80.28766474857159, -53.604483480981195, 64.90005398718623, -328.3984316256627, -221.37365036394135, -15.540567450569034, -217.97172194166885, 76.83739839192134, -62.4215290072797, -67.19987230581766, 82.82590198976501, -215.4723347673664, -63.01766150909464, -253.83034574412602, -72.05610867549865, 89.36722870345912, -103.9034532802869, -142.29070810227037, 0.5594712651248201, 21.887655692545323, -382.5350217575324, 117.78599718266575, -341.68754507993606, -271.3757928143444, 42.05974767402415, -113.91576456218526, 10.584749159468316, -368.0370289653096, -96.60173288891873, 6.578081936680414, -116.41208622158636, -38.927412945968925, -335.88260364800084, 33.30132488528524, -27.102952922490367, -70.03840438982733, -11.808869660467748, -17.067235360537826, 10.174001800704053, -2.962232113254194, -5.251613856427011, -54.123434986458186, -77.75098136410048, -19.99080009629646, 33.88040540161318, 40.0118549587175, 18.203034292193653, -101.55435256341609, 84.66934503983893, -118.51718584134521, -111.25275039532056, -35.27706169307365, 12.962713255211035, -154.80174341253127, -108.368940102753, 45.92361009447094, 66.26530936409696, -54.85406764413665, -50.32982812857711, -6.234569676365133, 43.52535653925046, -20.284647818951065, -122.72911794687963, -30.02930181547257, 64.88866316909824, -29.828281979136015, 27.845266783971347, 9.541578665059246, 1.103496687474779, 7.009962407567832, -8.299879170194934, -72.54471461247661, -97.58563081684744, -33.94553553761412, 161.42330774007206, -112.95182525200485, -6.1055308568346724, 40.28710026868663, -159.2584299113319, 1.9693763855458568, -203.51123731867187, -41.75335832068283, -112.73519084767737, -9.86848498904447, -75.14768969882805, 64.9005559888798, -41.26096743109789, 11.98667537860044, 89.1022150662958, -53.133135240501986, -21.790897701337713, 102.87572050846154, -103.60518017643587, -2.753002690682439, -77.5059788586302, -136.78681328113666, -35.26167272819433, 0.7616669233566751, 99.3892737675306, -121.76317749732668, -221.41484542454427, -0.26256937414734516, -81.64046493632515, 47.835445195899766, 41.62225202827415, -159.27689309555132, 8.414915969460758, -94.96493654962522, -101.89030278114168, -225.75780180988139, 42.3879814213417, -221.12051631037914, -194.2370444672595, -47.443484467917465, -68.94976936260595, -71.53127552961595, -175.21866179031935, -2.377011043507998, 7.336224962261236, 57.5840314172886, 148.94400313475802, -286.27355747273646, -38.05288701360526, -15.675153673344045, -157.06325915064687, 20.451311784900852, -34.19514158105644, -163.71926844518902, 179.13622751357744, -193.68286217716528, -5.466795255903271, 18.11348646225638, 73.35067178507347, -116.27200227841195, 81.3532898949211, -15.069998875773695, -1.5790888906085807, -103.01419787536915, 39.20269946596015, -70.07117731476804, -109.82064133551206, -6.986631127929058, -36.128808808176835, 15.187313791671755, -14.673585565722401, -251.67950712492743, 6.628822658497688, -90.79739622560763, -223.17849208443, -63.253333383580255, -19.653256456869457, -32.815082218808726, 25.002451968907792, -219.83803663194715], "policy_predator_policy_reward": [5.826870261683667, 69.24665936669969, 324.2059226722713, 187.82411487972215, 153.05478211067583, 113.01714267189817, 17.61674468795218, 70.83651010327776, 56.871368154986286, 191.90703446277513, 141.68851820524378, 0.0, 91.80740741555158, 0.0, 54.17335758922649, 131.5922426112305, 1.0515024123846184, 119.05980597895365, 36.62393073860571, 126.16249015041168, 294.04458931930264, 58.43138602720072, 27.098306487098423, 43.366658498089144, 101.5982771707111, 77.69808380843789, 92.33601550180148, 69.17740583328944, 11.711242094735995, 97.91032777106007, 159.598841430636, 144.42881435000547, 256.62014258831397, 83.17326937041157, 64.7437860571049, 182.14132692717635, 121.33488994630724, 3.428971835429686, 17.92887165747148, 61.97318819646065, 71.37501564844887, 195.79699114833366, 50.574776505310986, 49.41217620680031, 95.99190856070484, 133.02817899556257, 118.64992189155714, 44.429110259031575, 173.65858800042827, 294.7987946549283, 219.5255437438939, 58.84984999166302, 153.020176017792, 148.6350451107507, 84.92152900727922, 86.59987230581754, 35.917401426461, 256.72903135113984, 310.86582010807547, 62.23254304989086, 95.58973110505788, 76.50819038770996, 122.80345328028605, 155.79070810226966, 62.740528734875355, 50.312344307454744, 388.3350217575325, 13.51400281733393, 276.4934910271924, 282.6228917498557, 228.37632836739596, 14.384633174866076, 36.51525084053167, 377.03702896531087, 55.843560999739694, 94.38008995249868, 186.75715567238382, 3.338471062991101, 341.8826036480012, 4.298675114714987, 61.56155472910194, 75.84484689398705, 39.31993402285901, 36.68605729351662, 9.025998199295913, 32.16223211325439, 17.067987561023646, 78.50917759223691, 86.89305015310855, 85.34873130728765, 32.98846306649877, 46.31927657317061, 3.2969657078063443, 120.15435256341586, 51.96603493554656, 113.08180586595923, 51.82953263144456, 147.2709014897984, 28.814437033388117, 169.02459312393165, 122.3689401027523, 69.27638990552909, 2.934690635903009, 71.85406764413669, 69.17481916505344, 16.220654559082863, 82.67464346074956, 54.88464781895127, 149.0452344703959, 85.05170701639402, 61.64654055235777, 6.308513636455049, 122.72811266075166, 9.76569171381375, 28.196503312525255, 11.990037592432142, 39.59465245581429, 93.77925190682629, 173.417858483239, 6.14133330985798, 15.762281811455798, 134.36623570047647, 76.06028203580479, 74.22850676175635, 34.695476680536935, 159.6621907988072, 167.2233660646181, 158.99304802466287, 125.23519084767717, 31.268484989044566, 88.54768969882797, 57.09944401112018, 170.03924007813922, 8.135051974358213, 21.451638560862875, 76.27928161334323, 145.09089770133772, 0.7242794915378635, 119.58478321201947, 55.07339965509877, 101.30347201003724, 267.44746563530987, 25.72851731642294, 50.2482358311191, 10.105741511511418, 193.0090328936931, 242.16798791533478, 39.648464187783205, 159.3499139561802, 28.118359652455005, 62.6282279289202, 164.83895649669932, 73.18508403053936, 110.16493654962441, 168.40666761692708, 267.8603886072499, 213.90796331236706, 124.17924132120368, 231.43704446725934, 63.34348446791769, 164.82322943616253, 100.95781545605833, 192.6461275375021, 19.887349329554755, 38.363775037738804, 35.81596858271153, 113.3458349053624, 230.7853915479533, 54.85288701360539, 39.375153673344265, 203.76325915064663, 1.2486882150991712, 111.99514158105654, 174.21926844518845, 10.863772486422565, 246.3828621771652, 23.366795255903288, 1.686513537743613, 3.0493282149260565, 143.97200227841205, 11.169618052507685, 151.88844071902219, 78.45110531031017, 178.76726219687225, 5.491533832319006, 183.23617029079, 53.44679168121165, 100.62718867369004, 51.62880880817706, 4.512686208328209, 171.62334218999183, 202.77443414774723, 128.4407517753692, 43.32782179174049, 246.32318803637418, 132.52041148399576, 85.60806980806116, 98.80891037849513, 185.52092658311363, 103.72089663179854]}, "sampler_perf": {"mean_raw_obs_processing_ms": 24.612889016885457, "mean_inference_ms": 21.186329230406663, "mean_action_processing_ms": 5.908154806035579, "mean_env_wait_ms": 37.33530745612723, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.09543001651763916, "StateBufferConnector_ms": 0.03673684597015381, "ViewRequirementAgentConnector_ms": 1.255206823348999}, "num_episodes": 0, "episode_return_max": 286.6692231913454, "episode_return_min": -53.94695511723343, "episode_return_mean": 102.60472273081903, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 149312, "num_agent_steps_trained": 149312, "num_env_steps_sampled": 37328, "num_env_steps_trained": 37328, "num_env_steps_sampled_this_iter": 0, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 0.0, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 37328, "num_env_steps_sampled_lifetime": 37328, "num_agent_steps_sampled_lifetime": 149312, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 149312, "timers": {"training_iteration_time_ms": 63548.737, "restore_workers_time_ms": 122.736, "training_step_time_ms": 63193.562, "sample_time_ms": 63100.297, "learn_time_ms": 311236.026, "learn_throughput": 59.967, "synch_weights_time_ms": 43.334}, "counters": {"num_env_steps_sampled": 37328, "num_env_steps_trained": 37328, "num_agent_steps_sampled": 149312, "num_agent_steps_trained": 149312}, "done": false, "training_iteration": 68, "trial_id": "d7bca_00000", "date": "2024-08-20_13-36-20", "timestamp": 1724141180, "time_this_iter_s": 124.72146105766296, "time_total_s": 9552.932458162308, "pid": 36059, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 16000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x32cf2f160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 9552.932458162308, "iterations_since_restore": 68, "perf": {"cpu_util_percent": 82.82714285714285, "ram_util_percent": 85.57190476190478}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {}, "num_env_steps_sampled": 37328, "num_env_steps_trained": 37328, "num_agent_steps_sampled": 149312, "num_agent_steps_trained": 149312}, "env_runners": {"episode_reward_max": 286.6692231913454, "episode_reward_min": -53.94695511723343, "episode_reward_mean": 102.60472273081903, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -382.5350217575324, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 179.13622751357744, "predator_policy": 388.3350217575325}, "policy_reward_mean": {"prey_policy": -50.61742331228365, "predator_policy": 101.91978467769317}, "custom_metrics": {}, "hist_stats": {"episode_reward": [35.10000000000023, -2.2956613079459616, 52.30000000000035, 93.99999999999946, 41.27668545957155, 138.35998813581944, 47.000000000000355, 189.59999999999982, 46.100000000000314, 122.59999999999911, 172.99184762314727, 183.89999999999952, 165.26660970450598, 63.400000000000325, 224.23591029611316, 118.26513246444676, 57.049342065984625, 56.287512516221504, 91.49999999999856, 77.70000000000017, 286.6692231913454, 34.20000000000022, 135.4999999999999, 189.7622134181783, 204.95900501687956, 41.46117592104707, 160.52089757879483, 41.90000000000027, 159.99999999999952, 56.25035590474681, 189.40904152072758, 32.4000000000002, 135.49999999999923, 137.09999999999957, -53.94695511723343, 170.90494465410117, 56.10000000000025, 60.20000000000013, 34.75612756781972, 43.60000000000028, 40.265044310772325, 47.1298862953699, 48.40000000000023, 36.202116310375594, 74.49999999999962, 153.19999999999987, 40.1000000000002, 131.19999999999982, 52.570622032848895, 56.000000000000156, 129.1999999999993, 86.20000000000002, 28.831075919194078, 160.79999999999959, 81.33852172443821, 103.01543537877356, 169.88064982359512, 48.30000000000023, 52.529310579969625, 48.028025438635616, 198.59999999999948, 184.470358209413, 37.06861395355878, 80.95181844992561, 33.900000000000134, 135.39999999999944, 148.89999999999955, 133.69999999999916, 226.89999999999938, 68.3000000000002, 154.45814550558052, 41.47674734270453, 180.74087067540847, 60.139037304427255, 153.66325386820998, 109.81254335834268, 96.80000000000011, 108.61895163315396, 159.3546697445331, 53.10000000000013, 125.29999999999959, 34.93780403323022, 139.0999999999999, 206.80167211533725, 40.50000000000029, 68.40000000000009, 88.29999999999927, 242.69999999999993, 37.700000000000266, 104.09999999999903, 229.34134979067687, 152.6250807412044, 157.8592262743011, 37.26670789146122, 35.20000000000023, 108.04468364708873, 87.5999999999994, 92.41177405235972, 131.94864151087714, 94.40623855187317], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [13.573129738316304, -53.54665936669982, -254.04609845621002, -260.27960040372835, -140.65478211067654, -73.1171426718985, 39.583255312047925, -34.03651010327775, -114.83317908671795, -92.66853807147267, -96.4272326280199, 93.09870255859556, -64.80740741555226, 20.000000000000014, 20.626642410773584, -16.792242611230414, 18.848497587615384, -92.85980597895414, 69.17606926139403, -109.36249015041209, -285.2321358475945, 105.74800812423979, 132.7888944272447, -19.35385941243218, -25.356623210719427, 11.326871936077456, -78.03601550180139, -20.07740583328924, 28.904313331271958, 85.71002709904536, -84.17058524148602, -101.59193807470932, -247.8691803256373, -34.87488956710395, -49.40531904969436, -141.19228141836533, -107.134889946308, 73.87102816456981, 4.171128342528487, -6.373188196460497, 72.0443042732162, -52.54708787865346, -32.67477650531073, -33.11217620680012, 17.408091439294907, -110.92817899556306, 80.28766474857159, -53.604483480981195, 64.90005398718623, -328.3984316256627, -221.37365036394135, -15.540567450569034, -217.97172194166885, 76.83739839192134, -62.4215290072797, -67.19987230581766, 82.82590198976501, -215.4723347673664, -63.01766150909464, -253.83034574412602, -72.05610867549865, 89.36722870345912, -103.9034532802869, -142.29070810227037, 0.5594712651248201, 21.887655692545323, -382.5350217575324, 117.78599718266575, -341.68754507993606, -271.3757928143444, 42.05974767402415, -113.91576456218526, 10.584749159468316, -368.0370289653096, -96.60173288891873, 6.578081936680414, -116.41208622158636, -38.927412945968925, -335.88260364800084, 33.30132488528524, -27.102952922490367, -70.03840438982733, -11.808869660467748, -17.067235360537826, 10.174001800704053, -2.962232113254194, -5.251613856427011, -54.123434986458186, -77.75098136410048, -19.99080009629646, 33.88040540161318, 40.0118549587175, 18.203034292193653, -101.55435256341609, 84.66934503983893, -118.51718584134521, -111.25275039532056, -35.27706169307365, 12.962713255211035, -154.80174341253127, -108.368940102753, 45.92361009447094, 66.26530936409696, -54.85406764413665, -50.32982812857711, -6.234569676365133, 43.52535653925046, -20.284647818951065, -122.72911794687963, -30.02930181547257, 64.88866316909824, -29.828281979136015, 27.845266783971347, 9.541578665059246, 1.103496687474779, 7.009962407567832, -8.299879170194934, -72.54471461247661, -97.58563081684744, -33.94553553761412, 161.42330774007206, -112.95182525200485, -6.1055308568346724, 40.28710026868663, -159.2584299113319, 1.9693763855458568, -203.51123731867187, -41.75335832068283, -112.73519084767737, -9.86848498904447, -75.14768969882805, 64.9005559888798, -41.26096743109789, 11.98667537860044, 89.1022150662958, -53.133135240501986, -21.790897701337713, 102.87572050846154, -103.60518017643587, -2.753002690682439, -77.5059788586302, -136.78681328113666, -35.26167272819433, 0.7616669233566751, 99.3892737675306, -121.76317749732668, -221.41484542454427, -0.26256937414734516, -81.64046493632515, 47.835445195899766, 41.62225202827415, -159.27689309555132, 8.414915969460758, -94.96493654962522, -101.89030278114168, -225.75780180988139, 42.3879814213417, -221.12051631037914, -194.2370444672595, -47.443484467917465, -68.94976936260595, -71.53127552961595, -175.21866179031935, -2.377011043507998, 7.336224962261236, 57.5840314172886, 148.94400313475802, -286.27355747273646, -38.05288701360526, -15.675153673344045, -157.06325915064687, 20.451311784900852, -34.19514158105644, -163.71926844518902, 179.13622751357744, -193.68286217716528, -5.466795255903271, 18.11348646225638, 73.35067178507347, -116.27200227841195, 81.3532898949211, -15.069998875773695, -1.5790888906085807, -103.01419787536915, 39.20269946596015, -70.07117731476804, -109.82064133551206, -6.986631127929058, -36.128808808176835, 15.187313791671755, -14.673585565722401, -251.67950712492743, 6.628822658497688, -90.79739622560763, -223.17849208443, -63.253333383580255, -19.653256456869457, -32.815082218808726, 25.002451968907792, -219.83803663194715], "policy_predator_policy_reward": [5.826870261683667, 69.24665936669969, 324.2059226722713, 187.82411487972215, 153.05478211067583, 113.01714267189817, 17.61674468795218, 70.83651010327776, 56.871368154986286, 191.90703446277513, 141.68851820524378, 0.0, 91.80740741555158, 0.0, 54.17335758922649, 131.5922426112305, 1.0515024123846184, 119.05980597895365, 36.62393073860571, 126.16249015041168, 294.04458931930264, 58.43138602720072, 27.098306487098423, 43.366658498089144, 101.5982771707111, 77.69808380843789, 92.33601550180148, 69.17740583328944, 11.711242094735995, 97.91032777106007, 159.598841430636, 144.42881435000547, 256.62014258831397, 83.17326937041157, 64.7437860571049, 182.14132692717635, 121.33488994630724, 3.428971835429686, 17.92887165747148, 61.97318819646065, 71.37501564844887, 195.79699114833366, 50.574776505310986, 49.41217620680031, 95.99190856070484, 133.02817899556257, 118.64992189155714, 44.429110259031575, 173.65858800042827, 294.7987946549283, 219.5255437438939, 58.84984999166302, 153.020176017792, 148.6350451107507, 84.92152900727922, 86.59987230581754, 35.917401426461, 256.72903135113984, 310.86582010807547, 62.23254304989086, 95.58973110505788, 76.50819038770996, 122.80345328028605, 155.79070810226966, 62.740528734875355, 50.312344307454744, 388.3350217575325, 13.51400281733393, 276.4934910271924, 282.6228917498557, 228.37632836739596, 14.384633174866076, 36.51525084053167, 377.03702896531087, 55.843560999739694, 94.38008995249868, 186.75715567238382, 3.338471062991101, 341.8826036480012, 4.298675114714987, 61.56155472910194, 75.84484689398705, 39.31993402285901, 36.68605729351662, 9.025998199295913, 32.16223211325439, 17.067987561023646, 78.50917759223691, 86.89305015310855, 85.34873130728765, 32.98846306649877, 46.31927657317061, 3.2969657078063443, 120.15435256341586, 51.96603493554656, 113.08180586595923, 51.82953263144456, 147.2709014897984, 28.814437033388117, 169.02459312393165, 122.3689401027523, 69.27638990552909, 2.934690635903009, 71.85406764413669, 69.17481916505344, 16.220654559082863, 82.67464346074956, 54.88464781895127, 149.0452344703959, 85.05170701639402, 61.64654055235777, 6.308513636455049, 122.72811266075166, 9.76569171381375, 28.196503312525255, 11.990037592432142, 39.59465245581429, 93.77925190682629, 173.417858483239, 6.14133330985798, 15.762281811455798, 134.36623570047647, 76.06028203580479, 74.22850676175635, 34.695476680536935, 159.6621907988072, 167.2233660646181, 158.99304802466287, 125.23519084767717, 31.268484989044566, 88.54768969882797, 57.09944401112018, 170.03924007813922, 8.135051974358213, 21.451638560862875, 76.27928161334323, 145.09089770133772, 0.7242794915378635, 119.58478321201947, 55.07339965509877, 101.30347201003724, 267.44746563530987, 25.72851731642294, 50.2482358311191, 10.105741511511418, 193.0090328936931, 242.16798791533478, 39.648464187783205, 159.3499139561802, 28.118359652455005, 62.6282279289202, 164.83895649669932, 73.18508403053936, 110.16493654962441, 168.40666761692708, 267.8603886072499, 213.90796331236706, 124.17924132120368, 231.43704446725934, 63.34348446791769, 164.82322943616253, 100.95781545605833, 192.6461275375021, 19.887349329554755, 38.363775037738804, 35.81596858271153, 113.3458349053624, 230.7853915479533, 54.85288701360539, 39.375153673344265, 203.76325915064663, 1.2486882150991712, 111.99514158105654, 174.21926844518845, 10.863772486422565, 246.3828621771652, 23.366795255903288, 1.686513537743613, 3.0493282149260565, 143.97200227841205, 11.169618052507685, 151.88844071902219, 78.45110531031017, 178.76726219687225, 5.491533832319006, 183.23617029079, 53.44679168121165, 100.62718867369004, 51.62880880817706, 4.512686208328209, 171.62334218999183, 202.77443414774723, 128.4407517753692, 43.32782179174049, 246.32318803637418, 132.52041148399576, 85.60806980806116, 98.80891037849513, 185.52092658311363, 103.72089663179854]}, "sampler_perf": {"mean_raw_obs_processing_ms": 24.612889016885457, "mean_inference_ms": 21.186329230406663, "mean_action_processing_ms": 5.908154806035579, "mean_env_wait_ms": 37.33530745612723, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.09543001651763916, "StateBufferConnector_ms": 0.03673684597015381, "ViewRequirementAgentConnector_ms": 1.255206823348999}, "num_episodes": 0, "episode_return_max": 286.6692231913454, "episode_return_min": -53.94695511723343, "episode_return_mean": 102.60472273081903, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 149312, "num_agent_steps_trained": 149312, "num_env_steps_sampled": 37328, "num_env_steps_trained": 37328, "num_env_steps_sampled_this_iter": 0, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 0.0, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 37328, "num_env_steps_sampled_lifetime": 37328, "num_agent_steps_sampled_lifetime": 149312, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 149312, "timers": {"training_iteration_time_ms": 63527.068, "restore_workers_time_ms": 126.228, "training_step_time_ms": 63165.561, "sample_time_ms": 63070.347, "learn_time_ms": 311236.026, "learn_throughput": 59.967, "synch_weights_time_ms": 43.334}, "counters": {"num_env_steps_sampled": 37328, "num_env_steps_trained": 37328, "num_agent_steps_sampled": 149312, "num_agent_steps_trained": 149312}, "done": false, "training_iteration": 69, "trial_id": "d7bca_00000", "date": "2024-08-20_13-38-28", "timestamp": 1724141308, "time_this_iter_s": 123.4008719921112, "time_total_s": 9676.333330154419, "pid": 36059, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 16000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b0d8cd30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 9676.333330154419, "iterations_since_restore": 69, "perf": {"cpu_util_percent": 96.50459770114944, "ram_util_percent": 83.58160919540232}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {}, "num_env_steps_sampled": 37328, "num_env_steps_trained": 37328, "num_agent_steps_sampled": 149312, "num_agent_steps_trained": 149312}, "env_runners": {"episode_reward_max": 286.6692231913454, "episode_reward_min": -53.94695511723343, "episode_reward_mean": 102.60472273081903, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -382.5350217575324, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 179.13622751357744, "predator_policy": 388.3350217575325}, "policy_reward_mean": {"prey_policy": -50.61742331228365, "predator_policy": 101.91978467769317}, "custom_metrics": {}, "hist_stats": {"episode_reward": [35.10000000000023, -2.2956613079459616, 52.30000000000035, 93.99999999999946, 41.27668545957155, 138.35998813581944, 47.000000000000355, 189.59999999999982, 46.100000000000314, 122.59999999999911, 172.99184762314727, 183.89999999999952, 165.26660970450598, 63.400000000000325, 224.23591029611316, 118.26513246444676, 57.049342065984625, 56.287512516221504, 91.49999999999856, 77.70000000000017, 286.6692231913454, 34.20000000000022, 135.4999999999999, 189.7622134181783, 204.95900501687956, 41.46117592104707, 160.52089757879483, 41.90000000000027, 159.99999999999952, 56.25035590474681, 189.40904152072758, 32.4000000000002, 135.49999999999923, 137.09999999999957, -53.94695511723343, 170.90494465410117, 56.10000000000025, 60.20000000000013, 34.75612756781972, 43.60000000000028, 40.265044310772325, 47.1298862953699, 48.40000000000023, 36.202116310375594, 74.49999999999962, 153.19999999999987, 40.1000000000002, 131.19999999999982, 52.570622032848895, 56.000000000000156, 129.1999999999993, 86.20000000000002, 28.831075919194078, 160.79999999999959, 81.33852172443821, 103.01543537877356, 169.88064982359512, 48.30000000000023, 52.529310579969625, 48.028025438635616, 198.59999999999948, 184.470358209413, 37.06861395355878, 80.95181844992561, 33.900000000000134, 135.39999999999944, 148.89999999999955, 133.69999999999916, 226.89999999999938, 68.3000000000002, 154.45814550558052, 41.47674734270453, 180.74087067540847, 60.139037304427255, 153.66325386820998, 109.81254335834268, 96.80000000000011, 108.61895163315396, 159.3546697445331, 53.10000000000013, 125.29999999999959, 34.93780403323022, 139.0999999999999, 206.80167211533725, 40.50000000000029, 68.40000000000009, 88.29999999999927, 242.69999999999993, 37.700000000000266, 104.09999999999903, 229.34134979067687, 152.6250807412044, 157.8592262743011, 37.26670789146122, 35.20000000000023, 108.04468364708873, 87.5999999999994, 92.41177405235972, 131.94864151087714, 94.40623855187317], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [13.573129738316304, -53.54665936669982, -254.04609845621002, -260.27960040372835, -140.65478211067654, -73.1171426718985, 39.583255312047925, -34.03651010327775, -114.83317908671795, -92.66853807147267, -96.4272326280199, 93.09870255859556, -64.80740741555226, 20.000000000000014, 20.626642410773584, -16.792242611230414, 18.848497587615384, -92.85980597895414, 69.17606926139403, -109.36249015041209, -285.2321358475945, 105.74800812423979, 132.7888944272447, -19.35385941243218, -25.356623210719427, 11.326871936077456, -78.03601550180139, -20.07740583328924, 28.904313331271958, 85.71002709904536, -84.17058524148602, -101.59193807470932, -247.8691803256373, -34.87488956710395, -49.40531904969436, -141.19228141836533, -107.134889946308, 73.87102816456981, 4.171128342528487, -6.373188196460497, 72.0443042732162, -52.54708787865346, -32.67477650531073, -33.11217620680012, 17.408091439294907, -110.92817899556306, 80.28766474857159, -53.604483480981195, 64.90005398718623, -328.3984316256627, -221.37365036394135, -15.540567450569034, -217.97172194166885, 76.83739839192134, -62.4215290072797, -67.19987230581766, 82.82590198976501, -215.4723347673664, -63.01766150909464, -253.83034574412602, -72.05610867549865, 89.36722870345912, -103.9034532802869, -142.29070810227037, 0.5594712651248201, 21.887655692545323, -382.5350217575324, 117.78599718266575, -341.68754507993606, -271.3757928143444, 42.05974767402415, -113.91576456218526, 10.584749159468316, -368.0370289653096, -96.60173288891873, 6.578081936680414, -116.41208622158636, -38.927412945968925, -335.88260364800084, 33.30132488528524, -27.102952922490367, -70.03840438982733, -11.808869660467748, -17.067235360537826, 10.174001800704053, -2.962232113254194, -5.251613856427011, -54.123434986458186, -77.75098136410048, -19.99080009629646, 33.88040540161318, 40.0118549587175, 18.203034292193653, -101.55435256341609, 84.66934503983893, -118.51718584134521, -111.25275039532056, -35.27706169307365, 12.962713255211035, -154.80174341253127, -108.368940102753, 45.92361009447094, 66.26530936409696, -54.85406764413665, -50.32982812857711, -6.234569676365133, 43.52535653925046, -20.284647818951065, -122.72911794687963, -30.02930181547257, 64.88866316909824, -29.828281979136015, 27.845266783971347, 9.541578665059246, 1.103496687474779, 7.009962407567832, -8.299879170194934, -72.54471461247661, -97.58563081684744, -33.94553553761412, 161.42330774007206, -112.95182525200485, -6.1055308568346724, 40.28710026868663, -159.2584299113319, 1.9693763855458568, -203.51123731867187, -41.75335832068283, -112.73519084767737, -9.86848498904447, -75.14768969882805, 64.9005559888798, -41.26096743109789, 11.98667537860044, 89.1022150662958, -53.133135240501986, -21.790897701337713, 102.87572050846154, -103.60518017643587, -2.753002690682439, -77.5059788586302, -136.78681328113666, -35.26167272819433, 0.7616669233566751, 99.3892737675306, -121.76317749732668, -221.41484542454427, -0.26256937414734516, -81.64046493632515, 47.835445195899766, 41.62225202827415, -159.27689309555132, 8.414915969460758, -94.96493654962522, -101.89030278114168, -225.75780180988139, 42.3879814213417, -221.12051631037914, -194.2370444672595, -47.443484467917465, -68.94976936260595, -71.53127552961595, -175.21866179031935, -2.377011043507998, 7.336224962261236, 57.5840314172886, 148.94400313475802, -286.27355747273646, -38.05288701360526, -15.675153673344045, -157.06325915064687, 20.451311784900852, -34.19514158105644, -163.71926844518902, 179.13622751357744, -193.68286217716528, -5.466795255903271, 18.11348646225638, 73.35067178507347, -116.27200227841195, 81.3532898949211, -15.069998875773695, -1.5790888906085807, -103.01419787536915, 39.20269946596015, -70.07117731476804, -109.82064133551206, -6.986631127929058, -36.128808808176835, 15.187313791671755, -14.673585565722401, -251.67950712492743, 6.628822658497688, -90.79739622560763, -223.17849208443, -63.253333383580255, -19.653256456869457, -32.815082218808726, 25.002451968907792, -219.83803663194715], "policy_predator_policy_reward": [5.826870261683667, 69.24665936669969, 324.2059226722713, 187.82411487972215, 153.05478211067583, 113.01714267189817, 17.61674468795218, 70.83651010327776, 56.871368154986286, 191.90703446277513, 141.68851820524378, 0.0, 91.80740741555158, 0.0, 54.17335758922649, 131.5922426112305, 1.0515024123846184, 119.05980597895365, 36.62393073860571, 126.16249015041168, 294.04458931930264, 58.43138602720072, 27.098306487098423, 43.366658498089144, 101.5982771707111, 77.69808380843789, 92.33601550180148, 69.17740583328944, 11.711242094735995, 97.91032777106007, 159.598841430636, 144.42881435000547, 256.62014258831397, 83.17326937041157, 64.7437860571049, 182.14132692717635, 121.33488994630724, 3.428971835429686, 17.92887165747148, 61.97318819646065, 71.37501564844887, 195.79699114833366, 50.574776505310986, 49.41217620680031, 95.99190856070484, 133.02817899556257, 118.64992189155714, 44.429110259031575, 173.65858800042827, 294.7987946549283, 219.5255437438939, 58.84984999166302, 153.020176017792, 148.6350451107507, 84.92152900727922, 86.59987230581754, 35.917401426461, 256.72903135113984, 310.86582010807547, 62.23254304989086, 95.58973110505788, 76.50819038770996, 122.80345328028605, 155.79070810226966, 62.740528734875355, 50.312344307454744, 388.3350217575325, 13.51400281733393, 276.4934910271924, 282.6228917498557, 228.37632836739596, 14.384633174866076, 36.51525084053167, 377.03702896531087, 55.843560999739694, 94.38008995249868, 186.75715567238382, 3.338471062991101, 341.8826036480012, 4.298675114714987, 61.56155472910194, 75.84484689398705, 39.31993402285901, 36.68605729351662, 9.025998199295913, 32.16223211325439, 17.067987561023646, 78.50917759223691, 86.89305015310855, 85.34873130728765, 32.98846306649877, 46.31927657317061, 3.2969657078063443, 120.15435256341586, 51.96603493554656, 113.08180586595923, 51.82953263144456, 147.2709014897984, 28.814437033388117, 169.02459312393165, 122.3689401027523, 69.27638990552909, 2.934690635903009, 71.85406764413669, 69.17481916505344, 16.220654559082863, 82.67464346074956, 54.88464781895127, 149.0452344703959, 85.05170701639402, 61.64654055235777, 6.308513636455049, 122.72811266075166, 9.76569171381375, 28.196503312525255, 11.990037592432142, 39.59465245581429, 93.77925190682629, 173.417858483239, 6.14133330985798, 15.762281811455798, 134.36623570047647, 76.06028203580479, 74.22850676175635, 34.695476680536935, 159.6621907988072, 167.2233660646181, 158.99304802466287, 125.23519084767717, 31.268484989044566, 88.54768969882797, 57.09944401112018, 170.03924007813922, 8.135051974358213, 21.451638560862875, 76.27928161334323, 145.09089770133772, 0.7242794915378635, 119.58478321201947, 55.07339965509877, 101.30347201003724, 267.44746563530987, 25.72851731642294, 50.2482358311191, 10.105741511511418, 193.0090328936931, 242.16798791533478, 39.648464187783205, 159.3499139561802, 28.118359652455005, 62.6282279289202, 164.83895649669932, 73.18508403053936, 110.16493654962441, 168.40666761692708, 267.8603886072499, 213.90796331236706, 124.17924132120368, 231.43704446725934, 63.34348446791769, 164.82322943616253, 100.95781545605833, 192.6461275375021, 19.887349329554755, 38.363775037738804, 35.81596858271153, 113.3458349053624, 230.7853915479533, 54.85288701360539, 39.375153673344265, 203.76325915064663, 1.2486882150991712, 111.99514158105654, 174.21926844518845, 10.863772486422565, 246.3828621771652, 23.366795255903288, 1.686513537743613, 3.0493282149260565, 143.97200227841205, 11.169618052507685, 151.88844071902219, 78.45110531031017, 178.76726219687225, 5.491533832319006, 183.23617029079, 53.44679168121165, 100.62718867369004, 51.62880880817706, 4.512686208328209, 171.62334218999183, 202.77443414774723, 128.4407517753692, 43.32782179174049, 246.32318803637418, 132.52041148399576, 85.60806980806116, 98.80891037849513, 185.52092658311363, 103.72089663179854]}, "sampler_perf": {"mean_raw_obs_processing_ms": 24.612889016885457, "mean_inference_ms": 21.186329230406663, "mean_action_processing_ms": 5.908154806035579, "mean_env_wait_ms": 37.33530745612723, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.09543001651763916, "StateBufferConnector_ms": 0.03673684597015381, "ViewRequirementAgentConnector_ms": 1.255206823348999}, "num_episodes": 0, "episode_return_max": 286.6692231913454, "episode_return_min": -53.94695511723343, "episode_return_mean": 102.60472273081903, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 149312, "num_agent_steps_trained": 149312, "num_env_steps_sampled": 37328, "num_env_steps_trained": 37328, "num_env_steps_sampled_this_iter": 0, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 0.0, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 37328, "num_env_steps_sampled_lifetime": 37328, "num_agent_steps_sampled_lifetime": 149312, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 149312, "timers": {"training_iteration_time_ms": 63537.651, "restore_workers_time_ms": 126.714, "training_step_time_ms": 63174.769, "sample_time_ms": 63078.316, "learn_time_ms": 311236.026, "learn_throughput": 59.967, "synch_weights_time_ms": 43.334}, "counters": {"num_env_steps_sampled": 37328, "num_env_steps_trained": 37328, "num_agent_steps_sampled": 149312, "num_agent_steps_trained": 149312}, "done": false, "training_iteration": 70, "trial_id": "d7bca_00000", "date": "2024-08-20_13-40-33", "timestamp": 1724141433, "time_this_iter_s": 122.79279804229736, "time_total_s": 9799.126128196716, "pid": 36059, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 16000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3ae8b8ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 9799.126128196716, "iterations_since_restore": 70, "perf": {"cpu_util_percent": 96.23941176470589, "ram_util_percent": 83.60941176470588}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {}, "num_env_steps_sampled": 37328, "num_env_steps_trained": 37328, "num_agent_steps_sampled": 149312, "num_agent_steps_trained": 149312}, "env_runners": {"episode_reward_max": 286.6692231913454, "episode_reward_min": -53.94695511723343, "episode_reward_mean": 102.60472273081903, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -382.5350217575324, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 179.13622751357744, "predator_policy": 388.3350217575325}, "policy_reward_mean": {"prey_policy": -50.61742331228365, "predator_policy": 101.91978467769317}, "custom_metrics": {}, "hist_stats": {"episode_reward": [35.10000000000023, -2.2956613079459616, 52.30000000000035, 93.99999999999946, 41.27668545957155, 138.35998813581944, 47.000000000000355, 189.59999999999982, 46.100000000000314, 122.59999999999911, 172.99184762314727, 183.89999999999952, 165.26660970450598, 63.400000000000325, 224.23591029611316, 118.26513246444676, 57.049342065984625, 56.287512516221504, 91.49999999999856, 77.70000000000017, 286.6692231913454, 34.20000000000022, 135.4999999999999, 189.7622134181783, 204.95900501687956, 41.46117592104707, 160.52089757879483, 41.90000000000027, 159.99999999999952, 56.25035590474681, 189.40904152072758, 32.4000000000002, 135.49999999999923, 137.09999999999957, -53.94695511723343, 170.90494465410117, 56.10000000000025, 60.20000000000013, 34.75612756781972, 43.60000000000028, 40.265044310772325, 47.1298862953699, 48.40000000000023, 36.202116310375594, 74.49999999999962, 153.19999999999987, 40.1000000000002, 131.19999999999982, 52.570622032848895, 56.000000000000156, 129.1999999999993, 86.20000000000002, 28.831075919194078, 160.79999999999959, 81.33852172443821, 103.01543537877356, 169.88064982359512, 48.30000000000023, 52.529310579969625, 48.028025438635616, 198.59999999999948, 184.470358209413, 37.06861395355878, 80.95181844992561, 33.900000000000134, 135.39999999999944, 148.89999999999955, 133.69999999999916, 226.89999999999938, 68.3000000000002, 154.45814550558052, 41.47674734270453, 180.74087067540847, 60.139037304427255, 153.66325386820998, 109.81254335834268, 96.80000000000011, 108.61895163315396, 159.3546697445331, 53.10000000000013, 125.29999999999959, 34.93780403323022, 139.0999999999999, 206.80167211533725, 40.50000000000029, 68.40000000000009, 88.29999999999927, 242.69999999999993, 37.700000000000266, 104.09999999999903, 229.34134979067687, 152.6250807412044, 157.8592262743011, 37.26670789146122, 35.20000000000023, 108.04468364708873, 87.5999999999994, 92.41177405235972, 131.94864151087714, 94.40623855187317], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [13.573129738316304, -53.54665936669982, -254.04609845621002, -260.27960040372835, -140.65478211067654, -73.1171426718985, 39.583255312047925, -34.03651010327775, -114.83317908671795, -92.66853807147267, -96.4272326280199, 93.09870255859556, -64.80740741555226, 20.000000000000014, 20.626642410773584, -16.792242611230414, 18.848497587615384, -92.85980597895414, 69.17606926139403, -109.36249015041209, -285.2321358475945, 105.74800812423979, 132.7888944272447, -19.35385941243218, -25.356623210719427, 11.326871936077456, -78.03601550180139, -20.07740583328924, 28.904313331271958, 85.71002709904536, -84.17058524148602, -101.59193807470932, -247.8691803256373, -34.87488956710395, -49.40531904969436, -141.19228141836533, -107.134889946308, 73.87102816456981, 4.171128342528487, -6.373188196460497, 72.0443042732162, -52.54708787865346, -32.67477650531073, -33.11217620680012, 17.408091439294907, -110.92817899556306, 80.28766474857159, -53.604483480981195, 64.90005398718623, -328.3984316256627, -221.37365036394135, -15.540567450569034, -217.97172194166885, 76.83739839192134, -62.4215290072797, -67.19987230581766, 82.82590198976501, -215.4723347673664, -63.01766150909464, -253.83034574412602, -72.05610867549865, 89.36722870345912, -103.9034532802869, -142.29070810227037, 0.5594712651248201, 21.887655692545323, -382.5350217575324, 117.78599718266575, -341.68754507993606, -271.3757928143444, 42.05974767402415, -113.91576456218526, 10.584749159468316, -368.0370289653096, -96.60173288891873, 6.578081936680414, -116.41208622158636, -38.927412945968925, -335.88260364800084, 33.30132488528524, -27.102952922490367, -70.03840438982733, -11.808869660467748, -17.067235360537826, 10.174001800704053, -2.962232113254194, -5.251613856427011, -54.123434986458186, -77.75098136410048, -19.99080009629646, 33.88040540161318, 40.0118549587175, 18.203034292193653, -101.55435256341609, 84.66934503983893, -118.51718584134521, -111.25275039532056, -35.27706169307365, 12.962713255211035, -154.80174341253127, -108.368940102753, 45.92361009447094, 66.26530936409696, -54.85406764413665, -50.32982812857711, -6.234569676365133, 43.52535653925046, -20.284647818951065, -122.72911794687963, -30.02930181547257, 64.88866316909824, -29.828281979136015, 27.845266783971347, 9.541578665059246, 1.103496687474779, 7.009962407567832, -8.299879170194934, -72.54471461247661, -97.58563081684744, -33.94553553761412, 161.42330774007206, -112.95182525200485, -6.1055308568346724, 40.28710026868663, -159.2584299113319, 1.9693763855458568, -203.51123731867187, -41.75335832068283, -112.73519084767737, -9.86848498904447, -75.14768969882805, 64.9005559888798, -41.26096743109789, 11.98667537860044, 89.1022150662958, -53.133135240501986, -21.790897701337713, 102.87572050846154, -103.60518017643587, -2.753002690682439, -77.5059788586302, -136.78681328113666, -35.26167272819433, 0.7616669233566751, 99.3892737675306, -121.76317749732668, -221.41484542454427, -0.26256937414734516, -81.64046493632515, 47.835445195899766, 41.62225202827415, -159.27689309555132, 8.414915969460758, -94.96493654962522, -101.89030278114168, -225.75780180988139, 42.3879814213417, -221.12051631037914, -194.2370444672595, -47.443484467917465, -68.94976936260595, -71.53127552961595, -175.21866179031935, -2.377011043507998, 7.336224962261236, 57.5840314172886, 148.94400313475802, -286.27355747273646, -38.05288701360526, -15.675153673344045, -157.06325915064687, 20.451311784900852, -34.19514158105644, -163.71926844518902, 179.13622751357744, -193.68286217716528, -5.466795255903271, 18.11348646225638, 73.35067178507347, -116.27200227841195, 81.3532898949211, -15.069998875773695, -1.5790888906085807, -103.01419787536915, 39.20269946596015, -70.07117731476804, -109.82064133551206, -6.986631127929058, -36.128808808176835, 15.187313791671755, -14.673585565722401, -251.67950712492743, 6.628822658497688, -90.79739622560763, -223.17849208443, -63.253333383580255, -19.653256456869457, -32.815082218808726, 25.002451968907792, -219.83803663194715], "policy_predator_policy_reward": [5.826870261683667, 69.24665936669969, 324.2059226722713, 187.82411487972215, 153.05478211067583, 113.01714267189817, 17.61674468795218, 70.83651010327776, 56.871368154986286, 191.90703446277513, 141.68851820524378, 0.0, 91.80740741555158, 0.0, 54.17335758922649, 131.5922426112305, 1.0515024123846184, 119.05980597895365, 36.62393073860571, 126.16249015041168, 294.04458931930264, 58.43138602720072, 27.098306487098423, 43.366658498089144, 101.5982771707111, 77.69808380843789, 92.33601550180148, 69.17740583328944, 11.711242094735995, 97.91032777106007, 159.598841430636, 144.42881435000547, 256.62014258831397, 83.17326937041157, 64.7437860571049, 182.14132692717635, 121.33488994630724, 3.428971835429686, 17.92887165747148, 61.97318819646065, 71.37501564844887, 195.79699114833366, 50.574776505310986, 49.41217620680031, 95.99190856070484, 133.02817899556257, 118.64992189155714, 44.429110259031575, 173.65858800042827, 294.7987946549283, 219.5255437438939, 58.84984999166302, 153.020176017792, 148.6350451107507, 84.92152900727922, 86.59987230581754, 35.917401426461, 256.72903135113984, 310.86582010807547, 62.23254304989086, 95.58973110505788, 76.50819038770996, 122.80345328028605, 155.79070810226966, 62.740528734875355, 50.312344307454744, 388.3350217575325, 13.51400281733393, 276.4934910271924, 282.6228917498557, 228.37632836739596, 14.384633174866076, 36.51525084053167, 377.03702896531087, 55.843560999739694, 94.38008995249868, 186.75715567238382, 3.338471062991101, 341.8826036480012, 4.298675114714987, 61.56155472910194, 75.84484689398705, 39.31993402285901, 36.68605729351662, 9.025998199295913, 32.16223211325439, 17.067987561023646, 78.50917759223691, 86.89305015310855, 85.34873130728765, 32.98846306649877, 46.31927657317061, 3.2969657078063443, 120.15435256341586, 51.96603493554656, 113.08180586595923, 51.82953263144456, 147.2709014897984, 28.814437033388117, 169.02459312393165, 122.3689401027523, 69.27638990552909, 2.934690635903009, 71.85406764413669, 69.17481916505344, 16.220654559082863, 82.67464346074956, 54.88464781895127, 149.0452344703959, 85.05170701639402, 61.64654055235777, 6.308513636455049, 122.72811266075166, 9.76569171381375, 28.196503312525255, 11.990037592432142, 39.59465245581429, 93.77925190682629, 173.417858483239, 6.14133330985798, 15.762281811455798, 134.36623570047647, 76.06028203580479, 74.22850676175635, 34.695476680536935, 159.6621907988072, 167.2233660646181, 158.99304802466287, 125.23519084767717, 31.268484989044566, 88.54768969882797, 57.09944401112018, 170.03924007813922, 8.135051974358213, 21.451638560862875, 76.27928161334323, 145.09089770133772, 0.7242794915378635, 119.58478321201947, 55.07339965509877, 101.30347201003724, 267.44746563530987, 25.72851731642294, 50.2482358311191, 10.105741511511418, 193.0090328936931, 242.16798791533478, 39.648464187783205, 159.3499139561802, 28.118359652455005, 62.6282279289202, 164.83895649669932, 73.18508403053936, 110.16493654962441, 168.40666761692708, 267.8603886072499, 213.90796331236706, 124.17924132120368, 231.43704446725934, 63.34348446791769, 164.82322943616253, 100.95781545605833, 192.6461275375021, 19.887349329554755, 38.363775037738804, 35.81596858271153, 113.3458349053624, 230.7853915479533, 54.85288701360539, 39.375153673344265, 203.76325915064663, 1.2486882150991712, 111.99514158105654, 174.21926844518845, 10.863772486422565, 246.3828621771652, 23.366795255903288, 1.686513537743613, 3.0493282149260565, 143.97200227841205, 11.169618052507685, 151.88844071902219, 78.45110531031017, 178.76726219687225, 5.491533832319006, 183.23617029079, 53.44679168121165, 100.62718867369004, 51.62880880817706, 4.512686208328209, 171.62334218999183, 202.77443414774723, 128.4407517753692, 43.32782179174049, 246.32318803637418, 132.52041148399576, 85.60806980806116, 98.80891037849513, 185.52092658311363, 103.72089663179854]}, "sampler_perf": {"mean_raw_obs_processing_ms": 24.612889016885457, "mean_inference_ms": 21.186329230406663, "mean_action_processing_ms": 5.908154806035579, "mean_env_wait_ms": 37.33530745612723, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.09543001651763916, "StateBufferConnector_ms": 0.03673684597015381, "ViewRequirementAgentConnector_ms": 1.255206823348999}, "num_episodes": 0, "episode_return_max": 286.6692231913454, "episode_return_min": -53.94695511723343, "episode_return_mean": 102.60472273081903, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 149312, "num_agent_steps_trained": 149312, "num_env_steps_sampled": 37328, "num_env_steps_trained": 37328, "num_env_steps_sampled_this_iter": 0, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 0.0, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 37328, "num_env_steps_sampled_lifetime": 37328, "num_agent_steps_sampled_lifetime": 149312, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 149312, "timers": {"training_iteration_time_ms": 63548.583, "restore_workers_time_ms": 129.486, "training_step_time_ms": 63183.582, "sample_time_ms": 63087.989, "learn_time_ms": 311236.026, "learn_throughput": 59.967, "synch_weights_time_ms": 43.334}, "counters": {"num_env_steps_sampled": 37328, "num_env_steps_trained": 37328, "num_agent_steps_sampled": 149312, "num_agent_steps_trained": 149312}, "done": false, "training_iteration": 71, "trial_id": "d7bca_00000", "date": "2024-08-20_13-42-39", "timestamp": 1724141559, "time_this_iter_s": 122.83893132209778, "time_total_s": 9921.965059518814, "pid": 36059, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 16000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x32cf2f550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 9921.965059518814, "iterations_since_restore": 71, "perf": {"cpu_util_percent": 96.20643274853803, "ram_util_percent": 83.63976608187136}}
