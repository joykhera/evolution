{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0875272366972197, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.077480618663566, "policy_loss": -0.0348450070569814, "vf_loss": 8.108737920579456, "vf_explained_var": 0.02159110777592533, "kl": 0.01793847349615938, "entropy": 1.5912344681522834, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 945.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3847447924276508, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.632770870097731, "policy_loss": -0.035269468933807085, "vf_loss": 6.665111782184984, "vf_explained_var": 0.04206973449893729, "kl": 0.014642675521203533, "entropy": 1.5951432479752434, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 945.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "env_runners": {"episode_reward_max": 292.440717645681, "episode_reward_min": -36.94289709185351, "episode_reward_mean": 70.81834180134028, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 3600, "policy_reward_min": {"prey_policy": -251.0420213402382, "predator_policy": 5.507842623690538}, "policy_reward_max": {"prey_policy": 165.42465161013854, "predator_policy": 284.5385595466586}, "policy_reward_mean": {"prey_policy": -79.13660644363227, "predator_policy": 114.54577734430238}, "custom_metrics": {}, "hist_stats": {"episode_reward": [95.9899999999999, 104.31365632242031, 41.227705648545424, 29.39000000000028, 40.887667286793075, 164.09396555242006, 73.65000000000002, 70.10515760461561, 2.749999999999983, 119.05417945550154, 292.440717645681, 45.84000000000005, 3.029999999999977, 99.55000000000047, 49.51999999999982, 76.92000000000068, -36.94289709185351, 2.9099999999999815], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-67.2548732544074, -37.0498158466797, -155.0191781801652, -44.039579036730004, -48.200774574736656, -229.94420756587914, -67.93276929421457, -124.3583697469928, -78.82317562659706, -158.14311366116047, 104.91825657339112, -210.73669801711623, -28.9630818172507, 9.843761262681163, -17.776348476237047, -219.6033335211529, -145.00900858684992, -106.81051699854179, -6.9795778919844995, -76.16125552739537, 81.73220984316544, 165.42465161013854, -18.893859496255832, -29.1442587414464, -90.76057893942041, -251.0420213402382, -8.486132671573397, 59.28168315069649, -174.19382527114658, -218.1623820970383, -121.78226337153066, -15.919900326029708, -218.2106109526174, -146.05035177247393, -143.40785861456246, -11.258673192410027], "policy_predator_policy_reward": [148.6448732544076, 51.649815846679616, 153.9759358014822, 149.3964777378336, 55.50439976059624, 263.8682880285644, 82.14276929421473, 139.53836974699234, 100.42295629714889, 177.43100027740215, 30.865708979029154, 239.0466980171161, 47.38308181725064, 45.386238737318614, 207.87679412940858, 99.60804547259686, 146.22900858685054, 108.34051699854257, 75.82723139651729, 126.36778147836395, 39.77601356868661, 5.507842623690538, 20.703859496256094, 73.17425874144628, 92.21057893942039, 252.62202134023767, 10.406132671573356, 38.348316849303465, 216.92440772545189, 224.9517996427316, 125.70402879028184, 88.91813490727922, 284.5385595466586, 42.77950608657865, 144.45785861456267, 13.11867319240999]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7152201766670069, "mean_inference_ms": 2.4608946328138512, "mean_action_processing_ms": 0.28930875966100206, "mean_env_wait_ms": 0.22969032002236953, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006999572118123372, "StateBufferConnector_ms": 0.003274944093492296, "ViewRequirementAgentConnector_ms": 0.09896821445888943}, "num_episodes": 18, "episode_return_max": 292.440717645681, "episode_return_min": -36.94289709185351, "episode_return_mean": 70.81834180134028, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 30.287988940904857, "num_env_steps_trained_throughput_per_sec": 30.287988940904857, "timesteps_total": 4000, "num_env_steps_sampled_lifetime": 4000, "num_agent_steps_sampled_lifetime": 16000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 16000, "timers": {"training_iteration_time_ms": 132065.562, "restore_workers_time_ms": 0.017, "training_step_time_ms": 132065.504, "sample_time_ms": 1745.754, "learn_time_ms": 130300.442, "learn_throughput": 30.698, "synch_weights_time_ms": 15.128}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "done": false, "training_iteration": 1, "trial_id": "b941d_00000", "date": "2024-08-17_07-56-04", "timestamp": 1723861564, "time_this_iter_s": 132.09740591049194, "time_total_s": 132.09740591049194, "pid": 81115, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[32, [4, 4], 2], [64, [3, 3], 2], [128, [3, 3], 1]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [256, 256], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b0458f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 132.09740591049194, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 24.039893617021278, "ram_util_percent": 82.1877659574468}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.768939940386979, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.663991873100321, "policy_loss": -0.05097660411866234, "vf_loss": 7.711239769092943, "vf_explained_var": 0.059120994270163235, "kl": 0.01864348853314657, "entropy": 1.559216558933258, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 2835.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.9177740918580817, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.347728516311242, "policy_loss": -0.06121851572453996, "vf_loss": 6.404964788628634, "vf_explained_var": 0.05337412770463045, "kl": 0.019911250870485137, "entropy": 1.5572505875870033, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 2835.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "env_runners": {"episode_reward_max": 292.440717645681, "episode_reward_min": -36.94289709185351, "episode_reward_mean": 82.92884534169757, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 7200, "policy_reward_min": {"prey_policy": -320.31427141534624, "predator_policy": 5.507842623690538}, "policy_reward_max": {"prey_policy": 165.42465161013854, "predator_policy": 315.1430480500075}, "policy_reward_mean": {"prey_policy": -79.25640759149545, "predator_policy": 120.72083026234415}, "custom_metrics": {}, "hist_stats": {"episode_reward": [95.9899999999999, 104.31365632242031, 41.227705648545424, 29.39000000000028, 40.887667286793075, 164.09396555242006, 73.65000000000002, 70.10515760461561, 2.749999999999983, 119.05417945550154, 292.440717645681, 45.84000000000005, 3.029999999999977, 99.55000000000047, 49.51999999999982, 76.92000000000068, -36.94289709185351, 2.9099999999999815, 90.65000000000097, 252.87999999999954, 167.8499999999999, 51.510251092558846, 87.33199253373101, -19.426833058417543, 67.56557996763728, 62.72999999999991, 213.57000000000005, 169.66328457951627, 154.69211080858685, 12.53999999999999, 81.16000000000003, 28.780000000000324, 27.83236993741768, 36.41999999999985, 88.9713144107366, 135.9882096052197], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-67.2548732544074, -37.0498158466797, -155.0191781801652, -44.039579036730004, -48.200774574736656, -229.94420756587914, -67.93276929421457, -124.3583697469928, -78.82317562659706, -158.14311366116047, 104.91825657339112, -210.73669801711623, -28.9630818172507, 9.843761262681163, -17.776348476237047, -219.6033335211529, -145.00900858684992, -106.81051699854179, -6.9795778919844995, -76.16125552739537, 81.73220984316544, 165.42465161013854, -18.893859496255832, -29.1442587414464, -90.76057893942041, -251.0420213402382, -8.486132671573397, 59.28168315069649, -174.19382527114658, -218.1623820970383, -121.78226337153066, -15.919900326029708, -218.2106109526174, -146.05035177247393, -143.40785861456246, -11.258673192410027, 16.774354215158116, 3.938010199048361, 119.87472507147943, 16.41108041904522, 117.5275319087948, -50.839837839754836, -16.019874916794578, -220.79628310914725, -72.77450694007655, -54.18334634637779, -292.73281421114683, -111.88751412304642, 14.121844669700177, -320.31427141534624, -109.84375778336003, -123.19230854456082, 22.863063359630985, -32.08703453226004, 92.09000000000054, -319.60636299642357, 118.14388754318368, -43.59665227894515, -111.2063529068876, -79.4388569004119, -82.44553614067344, -22.550141574425673, -96.58647886624738, -70.19179677709131, -187.6437479696346, -81.55598580456915, -66.86022267419015, -105.51391271415517, -99.75699602078215, -179.6606129140463, -298.70245238595123, -129.30035331664578], "policy_predator_policy_reward": [148.6448732544076, 51.649815846679616, 153.9759358014822, 149.3964777378336, 55.50439976059624, 263.8682880285644, 82.14276929421473, 139.53836974699234, 100.42295629714889, 177.43100027740215, 30.865708979029154, 239.0466980171161, 47.38308181725064, 45.386238737318614, 207.87679412940858, 99.60804547259686, 146.22900858685054, 108.34051699854257, 75.82723139651729, 126.36778147836395, 39.77601356868661, 5.507842623690538, 20.703859496256094, 73.17425874144628, 92.21057893942039, 252.62202134023767, 10.406132671573356, 38.348316849303465, 216.92440772545189, 224.9517996427316, 125.70402879028184, 88.91813490727922, 284.5385595466586, 42.77950608657865, 144.45785861456267, 13.11867319240999, 57.145645784842, 12.791989800951606, 34.09682112372085, 82.49737338575491, 51.085146216386846, 50.07715971457283, 157.63105865539143, 130.6953504631081, 165.93470005898013, 48.35514576120478, 102.74445562998368, 282.4490396457911, 89.33725524226088, 284.4207514710218, 169.16375778336007, 126.60230854456107, 131.30875160956995, 91.485219563059, 118.17061839042248, 279.0090291855172, 35.532032288065196, 44.612843256283064, 112.50635290688805, 90.6788569004122, 161.81553614067317, 24.34014157442592, 116.70440576544041, 78.85386987789887, 169.00573326745675, 128.02637044416426, 68.48022267418999, 140.31391271415544, 158.65549021819217, 209.73343312737202, 315.1430480500075, 248.8479672578085]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.696261491948316, "mean_inference_ms": 2.607925442086529, "mean_action_processing_ms": 0.27864163839031353, "mean_env_wait_ms": 0.22475103246022515, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007909205224778917, "StateBufferConnector_ms": 0.0035872062047322593, "ViewRequirementAgentConnector_ms": 0.10042289892832439}, "num_episodes": 18, "episode_return_max": 292.440717645681, "episode_return_min": -36.94289709185351, "episode_return_mean": 82.92884534169757, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 30.171948940734904, "num_env_steps_trained_throughput_per_sec": 30.171948940734904, "timesteps_total": 8000, "num_env_steps_sampled_lifetime": 8000, "num_agent_steps_sampled_lifetime": 32000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 32000, "timers": {"training_iteration_time_ms": 132319.534, "restore_workers_time_ms": 0.045, "training_step_time_ms": 132319.43, "sample_time_ms": 1874.913, "learn_time_ms": 130427.481, "learn_throughput": 30.668, "synch_weights_time_ms": 12.775}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "done": false, "training_iteration": 2, "trial_id": "b941d_00000", "date": "2024-08-17_07-58-19", "timestamp": 1723861699, "time_this_iter_s": 132.62163496017456, "time_total_s": 264.7190408706665, "pid": 81115, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[32, [4, 4], 2], [64, [3, 3], 2], [128, [3, 3], 1]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [256, 256], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b0458ca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 264.7190408706665, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 28.4109375, "ram_util_percent": 82.36302083333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.7368998423455255, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.539584631390042, "policy_loss": -0.06366458398390995, "vf_loss": 6.598298644514942, "vf_explained_var": 0.05965623199624359, "kl": 0.024752907744866357, "entropy": 1.5292007696060907, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 4725.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.7976154941099662, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 5.105630434883965, "policy_loss": -0.057833814574898314, "vf_loss": 5.159076895411053, "vf_explained_var": 0.0644074905486334, "kl": 0.02193675839752515, "entropy": 1.5327037056917867, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 4725.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "env_runners": {"episode_reward_max": 314.14855019591505, "episode_reward_min": -36.94289709185351, "episode_reward_mean": 78.81983185821971, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 10800, "policy_reward_min": {"prey_policy": -414.6781710652911, "predator_policy": 2.0}, "policy_reward_max": {"prey_policy": 165.42465161013854, "predator_policy": 415.07817106529075}, "policy_reward_mean": {"prey_policy": -87.77872411140915, "predator_policy": 127.18864004051895}, "custom_metrics": {}, "hist_stats": {"episode_reward": [95.9899999999999, 104.31365632242031, 41.227705648545424, 29.39000000000028, 40.887667286793075, 164.09396555242006, 73.65000000000002, 70.10515760461561, 2.749999999999983, 119.05417945550154, 292.440717645681, 45.84000000000005, 3.029999999999977, 99.55000000000047, 49.51999999999982, 76.92000000000068, -36.94289709185351, 2.9099999999999815, 90.65000000000097, 252.87999999999954, 167.8499999999999, 51.510251092558846, 87.33199253373101, -19.426833058417543, 67.56557996763728, 62.72999999999991, 213.57000000000005, 169.66328457951627, 154.69211080858685, 12.53999999999999, 81.16000000000003, 28.780000000000324, 27.83236993741768, 36.41999999999985, 88.9713144107366, 135.9882096052197, 19.190000000000026, 107.18000000000046, 42.119999999999834, 3.6599999999999655, 94.32956720249483, -2.432613268227284, 182.81999999999982, 4.8699999999999815, 115.2500000000009, 90.91965490136454, 87.30000000000037, 74.46543476664381, 2.221894244559437, 42.99999999999956, 314.14855019591505, 59.04999999999992, 4.009999999999997, 28.730000000000224], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-67.2548732544074, -37.0498158466797, -155.0191781801652, -44.039579036730004, -48.200774574736656, -229.94420756587914, -67.93276929421457, -124.3583697469928, -78.82317562659706, -158.14311366116047, 104.91825657339112, -210.73669801711623, -28.9630818172507, 9.843761262681163, -17.776348476237047, -219.6033335211529, -145.00900858684992, -106.81051699854179, -6.9795778919844995, -76.16125552739537, 81.73220984316544, 165.42465161013854, -18.893859496255832, -29.1442587414464, -90.76057893942041, -251.0420213402382, -8.486132671573397, 59.28168315069649, -174.19382527114658, -218.1623820970383, -121.78226337153066, -15.919900326029708, -218.2106109526174, -146.05035177247393, -143.40785861456246, -11.258673192410027, 16.774354215158116, 3.938010199048361, 119.87472507147943, 16.41108041904522, 117.5275319087948, -50.839837839754836, -16.019874916794578, -220.79628310914725, -72.77450694007655, -54.18334634637779, -292.73281421114683, -111.88751412304642, 14.121844669700177, -320.31427141534624, -109.84375778336003, -123.19230854456082, 22.863063359630985, -32.08703453226004, 92.09000000000054, -319.60636299642357, 118.14388754318368, -43.59665227894515, -111.2063529068876, -79.4388569004119, -82.44553614067344, -22.550141574425673, -96.58647886624738, -70.19179677709131, -187.6437479696346, -81.55598580456915, -66.86022267419015, -105.51391271415517, -99.75699602078215, -179.6606129140463, -298.70245238595123, -129.30035331664578, -46.8155036237338, -207.3569802474633, -26.07463695636304, -34.54999445704491, -321.1254383863351, -1.1400641497600756, -20.499835495814658, -21.114341640731272, -139.95793864795306, -45.09317694723459, -91.51661221605025, -58.299613785280116, 143.24199737046732, -66.0019792511879, -96.53482164835694, -75.90196446968672, -121.5973405065956, 84.30473264530478, -325.92282307927746, -32.61980961138185, 58.70482927629979, -414.6781710652911, 3.9057880327842582, -181.54890953072092, -258.1595338559077, -123.04247304301728, 38.14565753911686, -139.8519028159331, -5.249659960223482, 151.44206975608623, -170.1167891252746, -265.1901729519297, -294.09239903426936, -305.4215365316052, -345.5874676332706, -18.324041396881704], "policy_predator_policy_reward": [148.6448732544076, 51.649815846679616, 153.9759358014822, 149.3964777378336, 55.50439976059624, 263.8682880285644, 82.14276929421473, 139.53836974699234, 100.42295629714889, 177.43100027740215, 30.865708979029154, 239.0466980171161, 47.38308181725064, 45.386238737318614, 207.87679412940858, 99.60804547259686, 146.22900858685054, 108.34051699854257, 75.82723139651729, 126.36778147836395, 39.77601356868661, 5.507842623690538, 20.703859496256094, 73.17425874144628, 92.21057893942039, 252.62202134023767, 10.406132671573356, 38.348316849303465, 216.92440772545189, 224.9517996427316, 125.70402879028184, 88.91813490727922, 284.5385595466586, 42.77950608657865, 144.45785861456267, 13.11867319240999, 57.145645784842, 12.791989800951606, 34.09682112372085, 82.49737338575491, 51.085146216386846, 50.07715971457283, 157.63105865539143, 130.6953504631081, 165.93470005898013, 48.35514576120478, 102.74445562998368, 282.4490396457911, 89.33725524226088, 284.4207514710218, 169.16375778336007, 126.60230854456107, 131.30875160956995, 91.485219563059, 118.17061839042248, 279.0090291855172, 35.532032288065196, 44.612843256283064, 112.50635290688805, 90.6788569004122, 161.81553614067317, 24.34014157442592, 116.70440576544041, 78.85386987789887, 169.00573326745675, 128.02637044416426, 68.48022267418999, 140.31391271415544, 158.65549021819217, 209.73343312737202, 315.1430480500075, 248.8479672578085, 48.4055036237335, 224.95698024746324, 130.83653067349698, 36.96810073991109, 361.27543838633505, 3.110064149760057, 22.33983549581494, 22.934341640731557, 213.4427350733946, 65.93794772428743, 5.664863180253431, 141.71874955284932, 29.902860519589726, 75.67712136113177, 175.30678611804427, 2.0, 123.1473405065964, 29.395267354695573, 320.3586345271567, 129.10365306486668, 28.19517072370016, 415.07817106529075, 172.78134411487437, 79.32721214970539, 59.64453041793285, 323.77937072555153, 139.99068991836106, 4.715555358454913, 47.121783639920736, 120.83435676013175, 228.3367891252745, 266.02017295193, 297.79239903426924, 305.73153653160506, 346.0174676332704, 46.6240413968817]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6810542961087914, "mean_inference_ms": 2.6741146772521556, "mean_action_processing_ms": 0.2711431973694295, "mean_env_wait_ms": 0.22088936506903603, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007715490129258897, "StateBufferConnector_ms": 0.003514024946424696, "ViewRequirementAgentConnector_ms": 0.09979627750538013}, "num_episodes": 18, "episode_return_max": 314.14855019591505, "episode_return_min": -36.94289709185351, "episode_return_mean": 78.81983185821971, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 30.025819653250043, "num_env_steps_trained_throughput_per_sec": 30.025819653250043, "timesteps_total": 12000, "num_env_steps_sampled_lifetime": 12000, "num_agent_steps_sampled_lifetime": 48000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 48000, "timers": {"training_iteration_time_ms": 132619.251, "restore_workers_time_ms": 0.034, "training_step_time_ms": 132619.169, "sample_time_ms": 1885.098, "learn_time_ms": 130717.604, "learn_throughput": 30.6, "synch_weights_time_ms": 13.145}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "done": false, "training_iteration": 3, "trial_id": "b941d_00000", "date": "2024-08-17_08-00-32", "timestamp": 1723861832, "time_this_iter_s": 133.2664132118225, "time_total_s": 397.985454082489, "pid": 81115, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[32, [4, 4], 2], [64, [3, 3], 2], [128, [3, 3], 1]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [256, 256], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b0464e50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 397.985454082489, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 22.241052631578942, "ram_util_percent": 80.70421052631579}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.706047432384794, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.00010000000000000003, "total_loss": 5.459690746680769, "policy_loss": -0.06632501124626114, "vf_loss": 5.519549823059607, "vf_explained_var": 0.08053623724866796, "kl": 0.021553023159915634, "entropy": 1.5073099694554768, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 6615.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.515298365474378, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.00010000000000000003, "total_loss": 3.9773292815243755, "policy_loss": -0.062123953064819847, "vf_loss": 4.033463021182509, "vf_explained_var": 0.08143180886273661, "kl": 0.019967368430704954, "entropy": 1.5007102170318523, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 6615.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "env_runners": {"episode_reward_max": 314.14855019591505, "episode_reward_min": -36.94289709185351, "episode_reward_mean": 79.63092637594758, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 14400, "policy_reward_min": {"prey_policy": -414.6781710652911, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 197.14088942482795, "predator_policy": 415.07817106529075}, "policy_reward_mean": {"prey_policy": -80.56494210832713, "predator_policy": 120.38040529630085}, "custom_metrics": {}, "hist_stats": {"episode_reward": [95.9899999999999, 104.31365632242031, 41.227705648545424, 29.39000000000028, 40.887667286793075, 164.09396555242006, 73.65000000000002, 70.10515760461561, 2.749999999999983, 119.05417945550154, 292.440717645681, 45.84000000000005, 3.029999999999977, 99.55000000000047, 49.51999999999982, 76.92000000000068, -36.94289709185351, 2.9099999999999815, 90.65000000000097, 252.87999999999954, 167.8499999999999, 51.510251092558846, 87.33199253373101, -19.426833058417543, 67.56557996763728, 62.72999999999991, 213.57000000000005, 169.66328457951627, 154.69211080858685, 12.53999999999999, 81.16000000000003, 28.780000000000324, 27.83236993741768, 36.41999999999985, 88.9713144107366, 135.9882096052197, 19.190000000000026, 107.18000000000046, 42.119999999999834, 3.6599999999999655, 94.32956720249483, -2.432613268227284, 182.81999999999982, 4.8699999999999815, 115.2500000000009, 90.91965490136454, 87.30000000000037, 74.46543476664381, 2.221894244559437, 42.99999999999956, 314.14855019591505, 59.04999999999992, 4.009999999999997, 28.730000000000224, 54.77665879365534, 212.7485885174599, 8.629999999999983, 2.2499999999999956, 53.79999999999953, 131.07384699117145, 39.06329699556088, 171.06999999999988, 199.42000000000004, 47.17022682401306, 25.470000000000233, 15.271659698126266, 64.3299999999999, 96.70000000000066, 124.58000000000027, 3.519999999999969, 128.47977315165468, 98.8017277527198], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-67.2548732544074, -37.0498158466797, -155.0191781801652, -44.039579036730004, -48.200774574736656, -229.94420756587914, -67.93276929421457, -124.3583697469928, -78.82317562659706, -158.14311366116047, 104.91825657339112, -210.73669801711623, -28.9630818172507, 9.843761262681163, -17.776348476237047, -219.6033335211529, -145.00900858684992, -106.81051699854179, -6.9795778919844995, -76.16125552739537, 81.73220984316544, 165.42465161013854, -18.893859496255832, -29.1442587414464, -90.76057893942041, -251.0420213402382, -8.486132671573397, 59.28168315069649, -174.19382527114658, -218.1623820970383, -121.78226337153066, -15.919900326029708, -218.2106109526174, -146.05035177247393, -143.40785861456246, -11.258673192410027, 16.774354215158116, 3.938010199048361, 119.87472507147943, 16.41108041904522, 117.5275319087948, -50.839837839754836, -16.019874916794578, -220.79628310914725, -72.77450694007655, -54.18334634637779, -292.73281421114683, -111.88751412304642, 14.121844669700177, -320.31427141534624, -109.84375778336003, -123.19230854456082, 22.863063359630985, -32.08703453226004, 92.09000000000054, -319.60636299642357, 118.14388754318368, -43.59665227894515, -111.2063529068876, -79.4388569004119, -82.44553614067344, -22.550141574425673, -96.58647886624738, -70.19179677709131, -187.6437479696346, -81.55598580456915, -66.86022267419015, -105.51391271415517, -99.75699602078215, -179.6606129140463, -298.70245238595123, -129.30035331664578, -46.8155036237338, -207.3569802474633, -26.07463695636304, -34.54999445704491, -321.1254383863351, -1.1400641497600756, -20.499835495814658, -21.114341640731272, -139.95793864795306, -45.09317694723459, -91.51661221605025, -58.299613785280116, 143.24199737046732, -66.0019792511879, -96.53482164835694, -75.90196446968672, -121.5973405065956, 84.30473264530478, -325.92282307927746, -32.61980961138185, 58.70482927629979, -414.6781710652911, 3.9057880327842582, -181.54890953072092, -258.1595338559077, -123.04247304301728, 38.14565753911686, -139.8519028159331, -5.249659960223482, 151.44206975608623, -170.1167891252746, -265.1901729519297, -294.09239903426936, -305.4215365316052, -345.5874676332706, -18.324041396881704, -324.7278594845189, 15.55741967548291, 28.641524715721133, 106.89535316670994, -237.45445527407287, -52.047902224900305, -47.46649597564525, -283.78083275912644, 36.52271202850352, -84.90620929222756, 2.0000000000000013, -130.89178330237792, -272.15553252976116, -135.31699626390264, 0.9775395549836315, 144.18412976647318, -160.89104095858644, 197.14088942482795, -1.2952484503634951, -191.27044403195387, 2.0000000000000013, -253.9287453878267, -160.69084000193712, -206.22059543566252, 24.770000000000117, 33.92400047587949, -25.428806446321968, 76.44499057698957, 107.72024988099562, -14.69682547703791, -29.994783483071924, -25.26905552691934, 124.91028928876224, -323.84970309343, -58.865281812783515, -1.7891209098211283], "policy_predator_policy_reward": [148.6448732544076, 51.649815846679616, 153.9759358014822, 149.3964777378336, 55.50439976059624, 263.8682880285644, 82.14276929421473, 139.53836974699234, 100.42295629714889, 177.43100027740215, 30.865708979029154, 239.0466980171161, 47.38308181725064, 45.386238737318614, 207.87679412940858, 99.60804547259686, 146.22900858685054, 108.34051699854257, 75.82723139651729, 126.36778147836395, 39.77601356868661, 5.507842623690538, 20.703859496256094, 73.17425874144628, 92.21057893942039, 252.62202134023767, 10.406132671573356, 38.348316849303465, 216.92440772545189, 224.9517996427316, 125.70402879028184, 88.91813490727922, 284.5385595466586, 42.77950608657865, 144.45785861456267, 13.11867319240999, 57.145645784842, 12.791989800951606, 34.09682112372085, 82.49737338575491, 51.085146216386846, 50.07715971457283, 157.63105865539143, 130.6953504631081, 165.93470005898013, 48.35514576120478, 102.74445562998368, 282.4490396457911, 89.33725524226088, 284.4207514710218, 169.16375778336007, 126.60230854456107, 131.30875160956995, 91.485219563059, 118.17061839042248, 279.0090291855172, 35.532032288065196, 44.612843256283064, 112.50635290688805, 90.6788569004122, 161.81553614067317, 24.34014157442592, 116.70440576544041, 78.85386987789887, 169.00573326745675, 128.02637044416426, 68.48022267418999, 140.31391271415544, 158.65549021819217, 209.73343312737202, 315.1430480500075, 248.8479672578085, 48.4055036237335, 224.95698024746324, 130.83653067349698, 36.96810073991109, 361.27543838633505, 3.110064149760057, 22.33983549581494, 22.934341640731557, 213.4427350733946, 65.93794772428743, 5.664863180253431, 141.71874955284932, 29.902860519589726, 75.67712136113177, 175.30678611804427, 2.0, 123.1473405065964, 29.395267354695573, 320.3586345271567, 129.10365306486668, 28.19517072370016, 415.07817106529075, 172.78134411487437, 79.32721214970539, 59.64453041793285, 323.77937072555153, 139.99068991836106, 4.715555358454913, 47.121783639920736, 120.83435676013175, 228.3367891252745, 266.02017295193, 297.79239903426924, 305.73153653160506, 346.0174676332704, 46.6240413968817, 34.694946809269176, 329.25215179342223, 47.12938718157963, 30.082323453448822, 244.34445527407263, 53.78790222489996, 49.086495975644965, 284.4108327591264, 15.827287971496265, 86.35620929222829, 223.06247822296478, 36.90315207058405, 253.97582848961812, 192.55999729960504, 18.40127679399728, 7.507053884545907, 163.17015153375831, 0.0, 100.13779536003464, 139.59812394629517, 0.0, 277.3987453878266, 174.98249970006347, 207.20059543566222, 0.0, 5.635999524120322, 27.208806446322246, 18.475009423010754, 14.949750119004356, 16.606825477037976, 31.714783483072193, 27.0690555269196, 3.0294838628933007, 324.3897030934295, 90.18757304418214, 69.26855743114196]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6715520375726819, "mean_inference_ms": 2.740540439078363, "mean_action_processing_ms": 0.266839370355257, "mean_env_wait_ms": 0.21898658016564146, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007720953888363308, "StateBufferConnector_ms": 0.003545979658762614, "ViewRequirementAgentConnector_ms": 0.10212014118830363}, "num_episodes": 18, "episode_return_max": 314.14855019591505, "episode_return_min": -36.94289709185351, "episode_return_mean": 79.63092637594758, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 29.6076184452774, "num_env_steps_trained_throughput_per_sec": 29.6076184452774, "timesteps_total": 16000, "num_env_steps_sampled_lifetime": 16000, "num_agent_steps_sampled_lifetime": 64000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 64000, "timers": {"training_iteration_time_ms": 133239.531, "restore_workers_time_ms": 0.029, "training_step_time_ms": 133239.459, "sample_time_ms": 1938.767, "learn_time_ms": 131283.4, "learn_throughput": 30.468, "synch_weights_time_ms": 13.158}, "counters": {"num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "done": false, "training_iteration": 4, "trial_id": "b941d_00000", "date": "2024-08-17_08-02-48", "timestamp": 1723861968, "time_this_iter_s": 135.14387893676758, "time_total_s": 533.1293330192566, "pid": 81115, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[32, [4, 4], 2], [64, [3, 3], 2], [128, [3, 3], 1]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [256, 256], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b0498ca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 533.1293330192566, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 24.472916666666666, "ram_util_percent": 80.04062499999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.322920039848045, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.00010000000000000003, "total_loss": 6.3980228093566085, "policy_loss": -0.06730090782561256, "vf_loss": 6.455385108725735, "vf_explained_var": 0.08989825617699396, "kl": 0.02208575182764173, "entropy": 1.476917732644964, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 8505.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.8310663404288117, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.00010000000000000003, "total_loss": 4.632712295572594, "policy_loss": -0.06125108805058829, "vf_loss": 4.686326551563526, "vf_explained_var": 0.05665202721086129, "kl": 0.025456095003415717, "entropy": 1.4506883497591372, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 8505.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "env_runners": {"episode_reward_max": 361.06999999999994, "episode_reward_min": -100.25995285107277, "episode_reward_mean": 84.00016789373065, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 19800, "policy_reward_min": {"prey_policy": -414.6781710652911, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 455.98513526338155}, "policy_reward_mean": {"prey_policy": -80.77760115653632, "predator_policy": 122.77768510340155}, "custom_metrics": {}, "hist_stats": {"episode_reward": [95.9899999999999, 104.31365632242031, 41.227705648545424, 29.39000000000028, 40.887667286793075, 164.09396555242006, 73.65000000000002, 70.10515760461561, 2.749999999999983, 119.05417945550154, 292.440717645681, 45.84000000000005, 3.029999999999977, 99.55000000000047, 49.51999999999982, 76.92000000000068, -36.94289709185351, 2.9099999999999815, 90.65000000000097, 252.87999999999954, 167.8499999999999, 51.510251092558846, 87.33199253373101, -19.426833058417543, 67.56557996763728, 62.72999999999991, 213.57000000000005, 169.66328457951627, 154.69211080858685, 12.53999999999999, 81.16000000000003, 28.780000000000324, 27.83236993741768, 36.41999999999985, 88.9713144107366, 135.9882096052197, 19.190000000000026, 107.18000000000046, 42.119999999999834, 3.6599999999999655, 94.32956720249483, -2.432613268227284, 182.81999999999982, 4.8699999999999815, 115.2500000000009, 90.91965490136454, 87.30000000000037, 74.46543476664381, 2.221894244559437, 42.99999999999956, 314.14855019591505, 59.04999999999992, 4.009999999999997, 28.730000000000224, 54.77665879365534, 212.7485885174599, 8.629999999999983, 2.2499999999999956, 53.79999999999953, 131.07384699117145, 39.06329699556088, 171.06999999999988, 199.42000000000004, 47.17022682401306, 25.470000000000233, 15.271659698126266, 64.3299999999999, 96.70000000000066, 124.58000000000027, 3.519999999999969, 128.47977315165468, 98.8017277527198, -100.25995285107277, 107.7219765726194, 114.75999999999998, 122.27591937717516, -28.345599463404977, 14.44319232731854, 200.61999999999972, 188.16921959085755, 195.8899999999997, 112.33000000000035, 3.9199999999999604, 361.06999999999994, 100.82956171669714, 107.29000000000015, 2.2899999999999885, 159.19000000000034, 321.09040895313024, 50.55619704628231, 35.456672732319255, 120.1600000000002, 24.52478044413877, 186.12999999999988, 43.39538360362077, 70.14128838096177, 3.279999999999973, 6.869999999999939, 58.79087398046234], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-67.2548732544074, -37.0498158466797, -155.0191781801652, -44.039579036730004, -48.200774574736656, -229.94420756587914, -67.93276929421457, -124.3583697469928, -78.82317562659706, -158.14311366116047, 104.91825657339112, -210.73669801711623, -28.9630818172507, 9.843761262681163, -17.776348476237047, -219.6033335211529, -145.00900858684992, -106.81051699854179, -6.9795778919844995, -76.16125552739537, 81.73220984316544, 165.42465161013854, -18.893859496255832, -29.1442587414464, -90.76057893942041, -251.0420213402382, -8.486132671573397, 59.28168315069649, -174.19382527114658, -218.1623820970383, -121.78226337153066, -15.919900326029708, -218.2106109526174, -146.05035177247393, -143.40785861456246, -11.258673192410027, 16.774354215158116, 3.938010199048361, 119.87472507147943, 16.41108041904522, 117.5275319087948, -50.839837839754836, -16.019874916794578, -220.79628310914725, -72.77450694007655, -54.18334634637779, -292.73281421114683, -111.88751412304642, 14.121844669700177, -320.31427141534624, -109.84375778336003, -123.19230854456082, 22.863063359630985, -32.08703453226004, 92.09000000000054, -319.60636299642357, 118.14388754318368, -43.59665227894515, -111.2063529068876, -79.4388569004119, -82.44553614067344, -22.550141574425673, -96.58647886624738, -70.19179677709131, -187.6437479696346, -81.55598580456915, -66.86022267419015, -105.51391271415517, -99.75699602078215, -179.6606129140463, -298.70245238595123, -129.30035331664578, -46.8155036237338, -207.3569802474633, -26.07463695636304, -34.54999445704491, -321.1254383863351, -1.1400641497600756, -20.499835495814658, -21.114341640731272, -139.95793864795306, -45.09317694723459, -91.51661221605025, -58.299613785280116, 143.24199737046732, -66.0019792511879, -96.53482164835694, -75.90196446968672, -121.5973405065956, 84.30473264530478, -325.92282307927746, -32.61980961138185, 58.70482927629979, -414.6781710652911, 3.9057880327842582, -181.54890953072092, -258.1595338559077, -123.04247304301728, 38.14565753911686, -139.8519028159331, -5.249659960223482, 151.44206975608623, -170.1167891252746, -265.1901729519297, -294.09239903426936, -305.4215365316052, -345.5874676332706, -18.324041396881704, -324.7278594845189, 15.55741967548291, 28.641524715721133, 106.89535316670994, -237.45445527407287, -52.047902224900305, -47.46649597564525, -283.78083275912644, 36.52271202850352, -84.90620929222756, 2.0000000000000013, -130.89178330237792, -272.15553252976116, -135.31699626390264, 0.9775395549836315, 144.18412976647318, -160.89104095858644, 197.14088942482795, -1.2952484503634951, -191.27044403195387, 2.0000000000000013, -253.9287453878267, -160.69084000193712, -206.22059543566252, 24.770000000000117, 33.92400047587949, -25.428806446321968, 76.44499057698957, 107.72024988099562, -14.69682547703791, -29.994783483071924, -25.26905552691934, 124.91028928876224, -323.84970309343, -58.865281812783515, -1.7891209098211283, -367.96214746316264, -349.8913907175398, -19.10606168720481, -16.784150717267735, -220.30753554459594, -24.808759574653635, 42.81615522256122, -204.32204549697283, -335.63398153009337, -224.26646534229027, -17.570892474568844, -166.93983093682525, 200.0, -272.9760511568464, 64.93981373771437, -98.79914895740939, 194.06000000000003, -29.41717153926595, 60.44607305463173, -41.42133925492245, -6.653331383313363, 2.0000000000000013, 192.11041052429294, 135.43597445506822, -13.127390178086142, 1.1016536894583069, 26.952245285574232, -249.36295663006285, -378.5090742454727, -23.122584040336918, -35.59801102611747, 156.21711618065734, 200.0, -86.20682460916703, -0.021774581466807448, -281.76176572247, -87.51264573533065, 2.0000000000000013, 30.176885949233586, -336.79124055577256, -36.84492566646202, -0.5650194249974785, 2.0000000000000013, 181.35907918507655, -220.0566167027093, -409.08721507977333, -353.6038375704506, -410.0962871776739, 2.0000000000000013, -162.04840076220623, -103.85412221131227, -85.65463765365689, -6.773495724870829, -208.76964360402158], "policy_predator_policy_reward": [148.6448732544076, 51.649815846679616, 153.9759358014822, 149.3964777378336, 55.50439976059624, 263.8682880285644, 82.14276929421473, 139.53836974699234, 100.42295629714889, 177.43100027740215, 30.865708979029154, 239.0466980171161, 47.38308181725064, 45.386238737318614, 207.87679412940858, 99.60804547259686, 146.22900858685054, 108.34051699854257, 75.82723139651729, 126.36778147836395, 39.77601356868661, 5.507842623690538, 20.703859496256094, 73.17425874144628, 92.21057893942039, 252.62202134023767, 10.406132671573356, 38.348316849303465, 216.92440772545189, 224.9517996427316, 125.70402879028184, 88.91813490727922, 284.5385595466586, 42.77950608657865, 144.45785861456267, 13.11867319240999, 57.145645784842, 12.791989800951606, 34.09682112372085, 82.49737338575491, 51.085146216386846, 50.07715971457283, 157.63105865539143, 130.6953504631081, 165.93470005898013, 48.35514576120478, 102.74445562998368, 282.4490396457911, 89.33725524226088, 284.4207514710218, 169.16375778336007, 126.60230854456107, 131.30875160956995, 91.485219563059, 118.17061839042248, 279.0090291855172, 35.532032288065196, 44.612843256283064, 112.50635290688805, 90.6788569004122, 161.81553614067317, 24.34014157442592, 116.70440576544041, 78.85386987789887, 169.00573326745675, 128.02637044416426, 68.48022267418999, 140.31391271415544, 158.65549021819217, 209.73343312737202, 315.1430480500075, 248.8479672578085, 48.4055036237335, 224.95698024746324, 130.83653067349698, 36.96810073991109, 361.27543838633505, 3.110064149760057, 22.33983549581494, 22.934341640731557, 213.4427350733946, 65.93794772428743, 5.664863180253431, 141.71874955284932, 29.902860519589726, 75.67712136113177, 175.30678611804427, 2.0, 123.1473405065964, 29.395267354695573, 320.3586345271567, 129.10365306486668, 28.19517072370016, 415.07817106529075, 172.78134411487437, 79.32721214970539, 59.64453041793285, 323.77937072555153, 139.99068991836106, 4.715555358454913, 47.121783639920736, 120.83435676013175, 228.3367891252745, 266.02017295193, 297.79239903426924, 305.73153653160506, 346.0174676332704, 46.6240413968817, 34.694946809269176, 329.25215179342223, 47.12938718157963, 30.082323453448822, 244.34445527407263, 53.78790222489996, 49.086495975644965, 284.4108327591264, 15.827287971496265, 86.35620929222829, 223.06247822296478, 36.90315207058405, 253.97582848961812, 192.55999729960504, 18.40127679399728, 7.507053884545907, 163.17015153375831, 0.0, 100.13779536003464, 139.59812394629517, 0.0, 277.3987453878266, 174.98249970006347, 207.20059543566222, 0.0, 5.635999524120322, 27.208806446322246, 18.475009423010754, 14.949750119004356, 16.606825477037976, 31.714783483072193, 27.0690555269196, 3.0294838628933007, 324.3897030934295, 90.18757304418214, 69.26855743114196, 455.98513526338155, 161.6084500662476, 121.4362722830547, 22.17591669403735, 220.95753554459534, 138.91875957465362, 235.73086332589386, 48.0509463256915, 95.01875664073545, 436.5360907682424, 35.40851839012377, 163.5453973485886, 21.57120118976981, 252.02484996707622, 5.74104973474608, 216.2875050758069, 0.0, 31.247171539266223, 15.067225882051684, 78.23804031823865, 8.573331383313322, 0.0, 3.88958947570705, 29.63402554493181, 40.2876434236328, 72.56765478169122, 79.48775471442595, 250.21295663006208, 378.9490742454724, 24.972584040337207, 37.36801102611714, 1.2028838193428497, 121.68239816380115, 85.61483539849607, 138.10231492802473, 194.23742242219433, 36.92196148534689, 84.04735698230392, 89.04311405076645, 337.7312405557726, 23.299799869135676, 38.63492566646166, 0.0, 2.7709208149235165, 235.54684377730857, 436.99237160879386, 429.1592733749301, 404.682139754156, 0.0, 163.32840076220685, 109.03412221131286, 87.34463765365776, 177.8604607425683, 96.47355256678647]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6672503071233529, "mean_inference_ms": 2.830733408827967, "mean_action_processing_ms": 0.2642135572466543, "mean_env_wait_ms": 0.21833613857325088, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007920433776547211, "StateBufferConnector_ms": 0.00368453035450945, "ViewRequirementAgentConnector_ms": 0.10811752743191189}, "num_episodes": 27, "episode_return_max": 361.06999999999994, "episode_return_min": -100.25995285107277, "episode_return_mean": 84.00016789373065, "episodes_this_iter": 27}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 30.557370147356025, "num_env_steps_trained_throughput_per_sec": 30.557370147356025, "timesteps_total": 20000, "num_env_steps_sampled_lifetime": 20000, "num_agent_steps_sampled_lifetime": 80000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 80000, "timers": {"training_iteration_time_ms": 132771.89, "restore_workers_time_ms": 0.026, "training_step_time_ms": 132771.824, "sample_time_ms": 2004.613, "learn_time_ms": 130750.199, "learn_throughput": 30.593, "synch_weights_time_ms": 13.246}, "counters": {"num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "done": false, "training_iteration": 5, "trial_id": "b941d_00000", "date": "2024-08-17_08-04-59", "timestamp": 1723862099, "time_this_iter_s": 130.9540638923645, "time_total_s": 664.0833969116211, "pid": 81115, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[32, [4, 4], 2], [64, [3, 3], 2], [128, [3, 3], 1]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [256, 256], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b04a58b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 664.0833969116211, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 34.32648648648649, "ram_util_percent": 81.30216216216216}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.099200199331556, "cur_kl_coeff": 0.675, "cur_lr": 0.00010000000000000003, "total_loss": 7.258673587173381, "policy_loss": -0.06798475306880261, "vf_loss": 7.315330031813768, "vf_explained_var": 0.1224588482783585, "kl": 0.016782696661118014, "entropy": 1.4691347611013543, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 10395.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.999329364930511, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.00010000000000000003, "total_loss": 5.485698477427165, "policy_loss": -0.06020533192740191, "vf_loss": 5.536636628801861, "vf_explained_var": 0.05931333644049508, "kl": 0.020593709484750942, "entropy": 1.3989320244107928, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 10395.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "env_runners": {"episode_reward_max": 361.06999999999994, "episode_reward_min": -100.25995285107277, "episode_reward_mean": 87.02158859108268, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -507.25233414378636, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 508.2230421121848}, "policy_reward_mean": {"prey_policy": -84.58629401641309, "predator_policy": 128.09708831195437}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2.9099999999999815, 90.65000000000097, 252.87999999999954, 167.8499999999999, 51.510251092558846, 87.33199253373101, -19.426833058417543, 67.56557996763728, 62.72999999999991, 213.57000000000005, 169.66328457951627, 154.69211080858685, 12.53999999999999, 81.16000000000003, 28.780000000000324, 27.83236993741768, 36.41999999999985, 88.9713144107366, 135.9882096052197, 19.190000000000026, 107.18000000000046, 42.119999999999834, 3.6599999999999655, 94.32956720249483, -2.432613268227284, 182.81999999999982, 4.8699999999999815, 115.2500000000009, 90.91965490136454, 87.30000000000037, 74.46543476664381, 2.221894244559437, 42.99999999999956, 314.14855019591505, 59.04999999999992, 4.009999999999997, 28.730000000000224, 54.77665879365534, 212.7485885174599, 8.629999999999983, 2.2499999999999956, 53.79999999999953, 131.07384699117145, 39.06329699556088, 171.06999999999988, 199.42000000000004, 47.17022682401306, 25.470000000000233, 15.271659698126266, 64.3299999999999, 96.70000000000066, 124.58000000000027, 3.519999999999969, 128.47977315165468, 98.8017277527198, -100.25995285107277, 107.7219765726194, 114.75999999999998, 122.27591937717516, -28.345599463404977, 14.44319232731854, 200.61999999999972, 188.16921959085755, 195.8899999999997, 112.33000000000035, 3.9199999999999604, 361.06999999999994, 100.82956171669714, 107.29000000000015, 2.2899999999999885, 159.19000000000034, 321.09040895313024, 50.55619704628231, 35.456672732319255, 120.1600000000002, 24.52478044413877, 186.12999999999988, 43.39538360362077, 70.14128838096177, 3.279999999999973, 6.869999999999939, 58.79087398046234, 0.5106956023236844, 84.69957789784802, 164.6259743068154, 3.789999999999963, 80.29000000000003, 65.16700236136414, 142.63035033595935, 3.3340239184564613, 161.8500000000001, 149.54443111262643, 109.99897247016386, 144.40999999999968, 42.573427229626496, 152.4840198621147, 58.223604647156684, 1.8699999999999983, 122.11000000000065, 169.85031030860443], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-143.40785861456246, -11.258673192410027, 16.774354215158116, 3.938010199048361, 119.87472507147943, 16.41108041904522, 117.5275319087948, -50.839837839754836, -16.019874916794578, -220.79628310914725, -72.77450694007655, -54.18334634637779, -292.73281421114683, -111.88751412304642, 14.121844669700177, -320.31427141534624, -109.84375778336003, -123.19230854456082, 22.863063359630985, -32.08703453226004, 92.09000000000054, -319.60636299642357, 118.14388754318368, -43.59665227894515, -111.2063529068876, -79.4388569004119, -82.44553614067344, -22.550141574425673, -96.58647886624738, -70.19179677709131, -187.6437479696346, -81.55598580456915, -66.86022267419015, -105.51391271415517, -99.75699602078215, -179.6606129140463, -298.70245238595123, -129.30035331664578, -46.8155036237338, -207.3569802474633, -26.07463695636304, -34.54999445704491, -321.1254383863351, -1.1400641497600756, -20.499835495814658, -21.114341640731272, -139.95793864795306, -45.09317694723459, -91.51661221605025, -58.299613785280116, 143.24199737046732, -66.0019792511879, -96.53482164835694, -75.90196446968672, -121.5973405065956, 84.30473264530478, -325.92282307927746, -32.61980961138185, 58.70482927629979, -414.6781710652911, 3.9057880327842582, -181.54890953072092, -258.1595338559077, -123.04247304301728, 38.14565753911686, -139.8519028159331, -5.249659960223482, 151.44206975608623, -170.1167891252746, -265.1901729519297, -294.09239903426936, -305.4215365316052, -345.5874676332706, -18.324041396881704, -324.7278594845189, 15.55741967548291, 28.641524715721133, 106.89535316670994, -237.45445527407287, -52.047902224900305, -47.46649597564525, -283.78083275912644, 36.52271202850352, -84.90620929222756, 2.0000000000000013, -130.89178330237792, -272.15553252976116, -135.31699626390264, 0.9775395549836315, 144.18412976647318, -160.89104095858644, 197.14088942482795, -1.2952484503634951, -191.27044403195387, 2.0000000000000013, -253.9287453878267, -160.69084000193712, -206.22059543566252, 24.770000000000117, 33.92400047587949, -25.428806446321968, 76.44499057698957, 107.72024988099562, -14.69682547703791, -29.994783483071924, -25.26905552691934, 124.91028928876224, -323.84970309343, -58.865281812783515, -1.7891209098211283, -367.96214746316264, -349.8913907175398, -19.10606168720481, -16.784150717267735, -220.30753554459594, -24.808759574653635, 42.81615522256122, -204.32204549697283, -335.63398153009337, -224.26646534229027, -17.570892474568844, -166.93983093682525, 200.0, -272.9760511568464, 64.93981373771437, -98.79914895740939, 194.06000000000003, -29.41717153926595, 60.44607305463173, -41.42133925492245, -6.653331383313363, 2.0000000000000013, 192.11041052429294, 135.43597445506822, -13.127390178086142, 1.1016536894583069, 26.952245285574232, -249.36295663006285, -378.5090742454727, -23.122584040336918, -35.59801102611747, 156.21711618065734, 200.0, -86.20682460916703, -0.021774581466807448, -281.76176572247, -87.51264573533065, 2.0000000000000013, 30.176885949233586, -336.79124055577256, -36.84492566646202, -0.5650194249974785, 2.0000000000000013, 181.35907918507655, -220.0566167027093, -409.08721507977333, -353.6038375704506, -410.0962871776739, 2.0000000000000013, -162.04840076220623, -103.85412221131227, -85.65463765365689, -6.773495724870829, -208.76964360402158, -155.477869119104, -83.88201184039191, 76.42729920575546, -123.44779730119188, -21.98502912936605, -52.57069839790512, -27.896830979434903, 1.026014347292848, 62.75396265919778, -150.11270061941667, 35.10881758374221, -206.2945163039689, -249.0649221207471, 104.2851075629068, -87.3143730065827, -507.25233414378636, 145.40282402621273, -69.82363403695332, -241.13670633923385, -27.469927299050163, -91.25487383283895, -241.81213189256258, 123.81956931300257, -317.9299806138517, -274.0330789549803, -376.5688083362075, 136.37002851910256, -124.88471806479092, -64.6808509024679, -172.25163317541984, -54.51192468023733, -452.2362701051066, 44.36766738944007, -80.30550076148639, -148.9273805534848, 56.02013745169762], "policy_predator_policy_reward": [144.45785861456267, 13.11867319240999, 57.145645784842, 12.791989800951606, 34.09682112372085, 82.49737338575491, 51.085146216386846, 50.07715971457283, 157.63105865539143, 130.6953504631081, 165.93470005898013, 48.35514576120478, 102.74445562998368, 282.4490396457911, 89.33725524226088, 284.4207514710218, 169.16375778336007, 126.60230854456107, 131.30875160956995, 91.485219563059, 118.17061839042248, 279.0090291855172, 35.532032288065196, 44.612843256283064, 112.50635290688805, 90.6788569004122, 161.81553614067317, 24.34014157442592, 116.70440576544041, 78.85386987789887, 169.00573326745675, 128.02637044416426, 68.48022267418999, 140.31391271415544, 158.65549021819217, 209.73343312737202, 315.1430480500075, 248.8479672578085, 48.4055036237335, 224.95698024746324, 130.83653067349698, 36.96810073991109, 361.27543838633505, 3.110064149760057, 22.33983549581494, 22.934341640731557, 213.4427350733946, 65.93794772428743, 5.664863180253431, 141.71874955284932, 29.902860519589726, 75.67712136113177, 175.30678611804427, 2.0, 123.1473405065964, 29.395267354695573, 320.3586345271567, 129.10365306486668, 28.19517072370016, 415.07817106529075, 172.78134411487437, 79.32721214970539, 59.64453041793285, 323.77937072555153, 139.99068991836106, 4.715555358454913, 47.121783639920736, 120.83435676013175, 228.3367891252745, 266.02017295193, 297.79239903426924, 305.73153653160506, 346.0174676332704, 46.6240413968817, 34.694946809269176, 329.25215179342223, 47.12938718157963, 30.082323453448822, 244.34445527407263, 53.78790222489996, 49.086495975644965, 284.4108327591264, 15.827287971496265, 86.35620929222829, 223.06247822296478, 36.90315207058405, 253.97582848961812, 192.55999729960504, 18.40127679399728, 7.507053884545907, 163.17015153375831, 0.0, 100.13779536003464, 139.59812394629517, 0.0, 277.3987453878266, 174.98249970006347, 207.20059543566222, 0.0, 5.635999524120322, 27.208806446322246, 18.475009423010754, 14.949750119004356, 16.606825477037976, 31.714783483072193, 27.0690555269196, 3.0294838628933007, 324.3897030934295, 90.18757304418214, 69.26855743114196, 455.98513526338155, 161.6084500662476, 121.4362722830547, 22.17591669403735, 220.95753554459534, 138.91875957465362, 235.73086332589386, 48.0509463256915, 95.01875664073545, 436.5360907682424, 35.40851839012377, 163.5453973485886, 21.57120118976981, 252.02484996707622, 5.74104973474608, 216.2875050758069, 0.0, 31.247171539266223, 15.067225882051684, 78.23804031823865, 8.573331383313322, 0.0, 3.88958947570705, 29.63402554493181, 40.2876434236328, 72.56765478169122, 79.48775471442595, 250.21295663006208, 378.9490742454724, 24.972584040337207, 37.36801102611714, 1.2028838193428497, 121.68239816380115, 85.61483539849607, 138.10231492802473, 194.23742242219433, 36.92196148534689, 84.04735698230392, 89.04311405076645, 337.7312405557726, 23.299799869135676, 38.63492566646166, 0.0, 2.7709208149235165, 235.54684377730857, 436.99237160879386, 429.1592733749301, 404.682139754156, 0.0, 163.32840076220685, 109.03412221131286, 87.34463765365776, 177.8604607425683, 96.47355256678647, 30.802967858928906, 209.06760870289116, 26.240172866943357, 105.47990312634104, 18.82560245306052, 220.35609938102607, 29.696830979435184, 0.9639856527071534, 9.056504043542983, 158.5922339166749, 60.690628172681535, 175.66207290890955, 0.9230455177959581, 286.4871193760038, 508.2230421121848, 89.67768895664133, 14.847175973787248, 71.423634036953, 247.89251696863488, 170.25854778227557, 165.80796282267818, 277.25801537288737, 14.399429332516881, 324.1209819683314, 315.33906283449846, 377.83625168631556, 130.11625524822213, 10.882454159581545, 167.55529539194373, 127.60079333310058, 56.13192468023705, 452.4862701051065, 76.07233261055994, 81.97550076148724, 109.84922433215074, 152.90832907824094]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6580675036307068, "mean_inference_ms": 2.9362398794783555, "mean_action_processing_ms": 0.25845922537102584, "mean_env_wait_ms": 0.21595602293904803, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007452607154846191, "StateBufferConnector_ms": 0.0036772489547729492, "ViewRequirementAgentConnector_ms": 0.1084136962890625}, "num_episodes": 18, "episode_return_max": 361.06999999999994, "episode_return_min": -100.25995285107277, "episode_return_mean": 87.02158859108268, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 30.741144706480597, "num_env_steps_trained_throughput_per_sec": 30.741144706480597, "timesteps_total": 24000, "num_env_steps_sampled_lifetime": 24000, "num_agent_steps_sampled_lifetime": 96000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 96000, "timers": {"training_iteration_time_ms": 132329.705, "restore_workers_time_ms": 0.024, "training_step_time_ms": 132329.644, "sample_time_ms": 2002.295, "learn_time_ms": 130310.556, "learn_throughput": 30.696, "synch_weights_time_ms": 13.315}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "done": false, "training_iteration": 6, "trial_id": "b941d_00000", "date": "2024-08-17_08-07-09", "timestamp": 1723862229, "time_this_iter_s": 130.15995597839355, "time_total_s": 794.2433528900146, "pid": 81115, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[32, [4, 4], 2], [64, [3, 3], 2], [128, [3, 3], 1]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [256, 256], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b04a5550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 794.2433528900146, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 34.47010869565217, "ram_util_percent": 81.34891304347825}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 12.74731558081965, "cur_kl_coeff": 0.675, "cur_lr": 0.00010000000000000003, "total_loss": 7.879268664153165, "policy_loss": -0.06400514276188221, "vf_loss": 7.930962458110991, "vf_explained_var": 0.16228799186055623, "kl": 0.018239007995861704, "entropy": 1.4685933881966526, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 12285.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.343247643917326, "cur_kl_coeff": 0.675, "cur_lr": 0.00010000000000000003, "total_loss": 5.313727604775202, "policy_loss": -0.057162018073969104, "vf_loss": 5.35893449985161, "vf_explained_var": 0.05883232866014753, "kl": 0.01771128940333887, "entropy": 1.3549148462436817, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 12285.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000}, "env_runners": {"episode_reward_max": 361.06999999999994, "episode_reward_min": -100.25995285107277, "episode_reward_mean": 99.92809354259714, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -568.4617738696408, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 571.4917738696407}, "policy_reward_mean": {"prey_policy": -86.24787094027346, "predator_policy": 136.21191771157194}, "custom_metrics": {}, "hist_stats": {"episode_reward": [135.9882096052197, 19.190000000000026, 107.18000000000046, 42.119999999999834, 3.6599999999999655, 94.32956720249483, -2.432613268227284, 182.81999999999982, 4.8699999999999815, 115.2500000000009, 90.91965490136454, 87.30000000000037, 74.46543476664381, 2.221894244559437, 42.99999999999956, 314.14855019591505, 59.04999999999992, 4.009999999999997, 28.730000000000224, 54.77665879365534, 212.7485885174599, 8.629999999999983, 2.2499999999999956, 53.79999999999953, 131.07384699117145, 39.06329699556088, 171.06999999999988, 199.42000000000004, 47.17022682401306, 25.470000000000233, 15.271659698126266, 64.3299999999999, 96.70000000000066, 124.58000000000027, 3.519999999999969, 128.47977315165468, 98.8017277527198, -100.25995285107277, 107.7219765726194, 114.75999999999998, 122.27591937717516, -28.345599463404977, 14.44319232731854, 200.61999999999972, 188.16921959085755, 195.8899999999997, 112.33000000000035, 3.9199999999999604, 361.06999999999994, 100.82956171669714, 107.29000000000015, 2.2899999999999885, 159.19000000000034, 321.09040895313024, 50.55619704628231, 35.456672732319255, 120.1600000000002, 24.52478044413877, 186.12999999999988, 43.39538360362077, 70.14128838096177, 3.279999999999973, 6.869999999999939, 58.79087398046234, 0.5106956023236844, 84.69957789784802, 164.6259743068154, 3.789999999999963, 80.29000000000003, 65.16700236136414, 142.63035033595935, 3.3340239184564613, 161.8500000000001, 149.54443111262643, 109.99897247016386, 144.40999999999968, 42.573427229626496, 152.4840198621147, 58.223604647156684, 1.8699999999999983, 122.11000000000065, 169.85031030860443, 243.88999999999993, 290.0499999999993, 298.65, 186.2952702131802, 119.17952855063166, 191.1799999999997, 39.936361880975234, 96.28197901785283, 214.7897882422757, 85.5500000000001, 97.36000000000094, 75.673769879104, 69.62489215098955, 87.72316896012259, 203.16361251062352, 219.5614141092535, 255.8287513999113, 93.54202850829587], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-298.70245238595123, -129.30035331664578, -46.8155036237338, -207.3569802474633, -26.07463695636304, -34.54999445704491, -321.1254383863351, -1.1400641497600756, -20.499835495814658, -21.114341640731272, -139.95793864795306, -45.09317694723459, -91.51661221605025, -58.299613785280116, 143.24199737046732, -66.0019792511879, -96.53482164835694, -75.90196446968672, -121.5973405065956, 84.30473264530478, -325.92282307927746, -32.61980961138185, 58.70482927629979, -414.6781710652911, 3.9057880327842582, -181.54890953072092, -258.1595338559077, -123.04247304301728, 38.14565753911686, -139.8519028159331, -5.249659960223482, 151.44206975608623, -170.1167891252746, -265.1901729519297, -294.09239903426936, -305.4215365316052, -345.5874676332706, -18.324041396881704, -324.7278594845189, 15.55741967548291, 28.641524715721133, 106.89535316670994, -237.45445527407287, -52.047902224900305, -47.46649597564525, -283.78083275912644, 36.52271202850352, -84.90620929222756, 2.0000000000000013, -130.89178330237792, -272.15553252976116, -135.31699626390264, 0.9775395549836315, 144.18412976647318, -160.89104095858644, 197.14088942482795, -1.2952484503634951, -191.27044403195387, 2.0000000000000013, -253.9287453878267, -160.69084000193712, -206.22059543566252, 24.770000000000117, 33.92400047587949, -25.428806446321968, 76.44499057698957, 107.72024988099562, -14.69682547703791, -29.994783483071924, -25.26905552691934, 124.91028928876224, -323.84970309343, -58.865281812783515, -1.7891209098211283, -367.96214746316264, -349.8913907175398, -19.10606168720481, -16.784150717267735, -220.30753554459594, -24.808759574653635, 42.81615522256122, -204.32204549697283, -335.63398153009337, -224.26646534229027, -17.570892474568844, -166.93983093682525, 200.0, -272.9760511568464, 64.93981373771437, -98.79914895740939, 194.06000000000003, -29.41717153926595, 60.44607305463173, -41.42133925492245, -6.653331383313363, 2.0000000000000013, 192.11041052429294, 135.43597445506822, -13.127390178086142, 1.1016536894583069, 26.952245285574232, -249.36295663006285, -378.5090742454727, -23.122584040336918, -35.59801102611747, 156.21711618065734, 200.0, -86.20682460916703, -0.021774581466807448, -281.76176572247, -87.51264573533065, 2.0000000000000013, 30.176885949233586, -336.79124055577256, -36.84492566646202, -0.5650194249974785, 2.0000000000000013, 181.35907918507655, -220.0566167027093, -409.08721507977333, -353.6038375704506, -410.0962871776739, 2.0000000000000013, -162.04840076220623, -103.85412221131227, -85.65463765365689, -6.773495724870829, -208.76964360402158, -155.477869119104, -83.88201184039191, 76.42729920575546, -123.44779730119188, -21.98502912936605, -52.57069839790512, -27.896830979434903, 1.026014347292848, 62.75396265919778, -150.11270061941667, 35.10881758374221, -206.2945163039689, -249.0649221207471, 104.2851075629068, -87.3143730065827, -507.25233414378636, 145.40282402621273, -69.82363403695332, -241.13670633923385, -27.469927299050163, -91.25487383283895, -241.81213189256258, 123.81956931300257, -317.9299806138517, -274.0330789549803, -376.5688083362075, 136.37002851910256, -124.88471806479092, -64.6808509024679, -172.25163317541984, -54.51192468023733, -452.2362701051066, 44.36766738944007, -80.30550076148639, -148.9273805534848, 56.02013745169762, -115.47453114716154, 183.24539401305282, 107.93000000000036, 176.3678679386698, 134.41802238124725, 109.01826502655737, -568.4617738696408, 183.26527021318017, -5.4895679080373085, -381.86147492247153, -209.14703836227594, 180.17788564470357, -220.7164469780367, -245.99874855528876, -291.64439737736814, 80.05770122170603, 105.31959638006455, -24.582445578777275, -104.90696266388304, -396.55300837896965, 94.16856474061633, -143.37974878589597, -301.7317873180603, -41.317127858883204, -71.09618958709721, -54.495159506967916, -238.01326939505645, -79.07791058741712, -136.10252786841022, -35.69508208396658, -494.14587252913515, 66.08725255689367, 182.58808245512608, -25.52347745641253, -241.17276981126378, -92.57920953470112], "policy_predator_policy_reward": [315.1430480500075, 248.8479672578085, 48.4055036237335, 224.95698024746324, 130.83653067349698, 36.96810073991109, 361.27543838633505, 3.110064149760057, 22.33983549581494, 22.934341640731557, 213.4427350733946, 65.93794772428743, 5.664863180253431, 141.71874955284932, 29.902860519589726, 75.67712136113177, 175.30678611804427, 2.0, 123.1473405065964, 29.395267354695573, 320.3586345271567, 129.10365306486668, 28.19517072370016, 415.07817106529075, 172.78134411487437, 79.32721214970539, 59.64453041793285, 323.77937072555153, 139.99068991836106, 4.715555358454913, 47.121783639920736, 120.83435676013175, 228.3367891252745, 266.02017295193, 297.79239903426924, 305.73153653160506, 346.0174676332704, 46.6240413968817, 34.694946809269176, 329.25215179342223, 47.12938718157963, 30.082323453448822, 244.34445527407263, 53.78790222489996, 49.086495975644965, 284.4108327591264, 15.827287971496265, 86.35620929222829, 223.06247822296478, 36.90315207058405, 253.97582848961812, 192.55999729960504, 18.40127679399728, 7.507053884545907, 163.17015153375831, 0.0, 100.13779536003464, 139.59812394629517, 0.0, 277.3987453878266, 174.98249970006347, 207.20059543566222, 0.0, 5.635999524120322, 27.208806446322246, 18.475009423010754, 14.949750119004356, 16.606825477037976, 31.714783483072193, 27.0690555269196, 3.0294838628933007, 324.3897030934295, 90.18757304418214, 69.26855743114196, 455.98513526338155, 161.6084500662476, 121.4362722830547, 22.17591669403735, 220.95753554459534, 138.91875957465362, 235.73086332589386, 48.0509463256915, 95.01875664073545, 436.5360907682424, 35.40851839012377, 163.5453973485886, 21.57120118976981, 252.02484996707622, 5.74104973474608, 216.2875050758069, 0.0, 31.247171539266223, 15.067225882051684, 78.23804031823865, 8.573331383313322, 0.0, 3.88958947570705, 29.63402554493181, 40.2876434236328, 72.56765478169122, 79.48775471442595, 250.21295663006208, 378.9490742454724, 24.972584040337207, 37.36801102611714, 1.2028838193428497, 121.68239816380115, 85.61483539849607, 138.10231492802473, 194.23742242219433, 36.92196148534689, 84.04735698230392, 89.04311405076645, 337.7312405557726, 23.299799869135676, 38.63492566646166, 0.0, 2.7709208149235165, 235.54684377730857, 436.99237160879386, 429.1592733749301, 404.682139754156, 0.0, 163.32840076220685, 109.03412221131286, 87.34463765365776, 177.8604607425683, 96.47355256678647, 30.802967858928906, 209.06760870289116, 26.240172866943357, 105.47990312634104, 18.82560245306052, 220.35609938102607, 29.696830979435184, 0.9639856527071534, 9.056504043542983, 158.5922339166749, 60.690628172681535, 175.66207290890955, 0.9230455177959581, 286.4871193760038, 508.2230421121848, 89.67768895664133, 14.847175973787248, 71.423634036953, 247.89251696863488, 170.25854778227557, 165.80796282267818, 277.25801537288737, 14.399429332516881, 324.1209819683314, 315.33906283449846, 377.83625168631556, 130.11625524822213, 10.882454159581545, 167.55529539194373, 127.60079333310058, 56.13192468023705, 452.4862701051065, 76.07233261055994, 81.97550076148724, 109.84922433215074, 152.90832907824094, 173.2545311471613, 2.8646059869471125, 0.0, 5.752132061330103, 40.581977618752845, 14.631734973442613, 571.4917738696407, 0.0, 192.79368422225247, 313.7368871588875, 210.31703836227493, 9.832114355296428, 320.9788712827187, 185.67268613158132, 294.58864832630735, 13.280026847206598, 0.0, 134.05263744098957, 190.01696266388313, 396.99300837896925, 0.0, 146.5711840452789, 382.0069813541159, 36.71570370193056, 132.57072525010102, 62.64551599495293, 315.546438355179, 89.26791058741745, 176.97646204982107, 197.98476041317943, 228.22991560444123, 419.3901184770534, 94.55287399564277, 4.2112724055559, 148.33673592580192, 278.95727192845766]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6524811891907671, "mean_inference_ms": 3.0004167567676996, "mean_action_processing_ms": 0.2556849412691313, "mean_env_wait_ms": 0.21524325506072928, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006708979606628418, "StateBufferConnector_ms": 0.0035762786865234375, "ViewRequirementAgentConnector_ms": 0.10872423648834229}, "num_episodes": 18, "episode_return_max": 361.06999999999994, "episode_return_min": -100.25995285107277, "episode_return_mean": 99.92809354259714, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 22.92452592794586, "num_env_steps_trained_throughput_per_sec": 22.92452592794586, "timesteps_total": 28000, "num_env_steps_sampled_lifetime": 28000, "num_agent_steps_sampled_lifetime": 112000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 112000, "timers": {"training_iteration_time_ms": 138351.978, "restore_workers_time_ms": 0.022, "training_step_time_ms": 138351.92, "sample_time_ms": 2012.32, "learn_time_ms": 136321.966, "learn_throughput": 29.342, "synch_weights_time_ms": 13.801}, "counters": {"num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000}, "done": false, "training_iteration": 7, "trial_id": "b941d_00000", "date": "2024-08-17_08-10-03", "timestamp": 1723862403, "time_this_iter_s": 174.5128297805786, "time_total_s": 968.7561826705933, "pid": 81115, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[32, [4, 4], 2], [64, [3, 3], 2], [128, [3, 3], 1]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [256, 256], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b03880d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 968.7561826705933, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 36.22164948453608, "ram_util_percent": 81.09690721649486}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.34262787923611, "cur_kl_coeff": 0.675, "cur_lr": 0.00010000000000000003, "total_loss": 7.722678107559366, "policy_loss": -0.07099329052029779, "vf_loss": 7.780175539299294, "vf_explained_var": 0.13799765690293891, "kl": 0.019993838721697334, "entropy": 1.4521328064499708, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 14175.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1402169221923466, "cur_kl_coeff": 0.675, "cur_lr": 0.00010000000000000003, "total_loss": 5.783495336865622, "policy_loss": -0.06371698265121609, "vf_loss": 5.833170031492042, "vf_explained_var": 0.04358222863030812, "kl": 0.02080338274837011, "entropy": 1.3090061294969428, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 14175.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000}, "env_runners": {"episode_reward_max": 361.06999999999994, "episode_reward_min": -100.25995285107277, "episode_reward_mean": 99.71238467141737, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -568.4617738696408, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 571.4917738696407}, "policy_reward_mean": {"prey_policy": -93.5515978423078, "predator_policy": 143.4077901780164}, "custom_metrics": {}, "hist_stats": {"episode_reward": [28.730000000000224, 54.77665879365534, 212.7485885174599, 8.629999999999983, 2.2499999999999956, 53.79999999999953, 131.07384699117145, 39.06329699556088, 171.06999999999988, 199.42000000000004, 47.17022682401306, 25.470000000000233, 15.271659698126266, 64.3299999999999, 96.70000000000066, 124.58000000000027, 3.519999999999969, 128.47977315165468, 98.8017277527198, -100.25995285107277, 107.7219765726194, 114.75999999999998, 122.27591937717516, -28.345599463404977, 14.44319232731854, 200.61999999999972, 188.16921959085755, 195.8899999999997, 112.33000000000035, 3.9199999999999604, 361.06999999999994, 100.82956171669714, 107.29000000000015, 2.2899999999999885, 159.19000000000034, 321.09040895313024, 50.55619704628231, 35.456672732319255, 120.1600000000002, 24.52478044413877, 186.12999999999988, 43.39538360362077, 70.14128838096177, 3.279999999999973, 6.869999999999939, 58.79087398046234, 0.5106956023236844, 84.69957789784802, 164.6259743068154, 3.789999999999963, 80.29000000000003, 65.16700236136414, 142.63035033595935, 3.3340239184564613, 161.8500000000001, 149.54443111262643, 109.99897247016386, 144.40999999999968, 42.573427229626496, 152.4840198621147, 58.223604647156684, 1.8699999999999983, 122.11000000000065, 169.85031030860443, 243.88999999999993, 290.0499999999993, 298.65, 186.2952702131802, 119.17952855063166, 191.1799999999997, 39.936361880975234, 96.28197901785283, 214.7897882422757, 85.5500000000001, 97.36000000000094, 75.673769879104, 69.62489215098955, 87.72316896012259, 203.16361251062352, 219.5614141092535, 255.8287513999113, 93.54202850829587, 96.55000000000028, 96.30000000000048, 30.76748085115433, 196.40505184689746, -8.256958038355517, 53.26999999999999, 4.882678125181631, 78.22000000000001, -8.038157252437976, 173.48999999999978, 161.77999999999963, 113.85867860078093, 35.457311382598114, 143.72000000000028, 110.60688812570025, 27.85083701181365, 42.68599987666077, 6.9699999999999775], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-345.5874676332706, -18.324041396881704, -324.7278594845189, 15.55741967548291, 28.641524715721133, 106.89535316670994, -237.45445527407287, -52.047902224900305, -47.46649597564525, -283.78083275912644, 36.52271202850352, -84.90620929222756, 2.0000000000000013, -130.89178330237792, -272.15553252976116, -135.31699626390264, 0.9775395549836315, 144.18412976647318, -160.89104095858644, 197.14088942482795, -1.2952484503634951, -191.27044403195387, 2.0000000000000013, -253.9287453878267, -160.69084000193712, -206.22059543566252, 24.770000000000117, 33.92400047587949, -25.428806446321968, 76.44499057698957, 107.72024988099562, -14.69682547703791, -29.994783483071924, -25.26905552691934, 124.91028928876224, -323.84970309343, -58.865281812783515, -1.7891209098211283, -367.96214746316264, -349.8913907175398, -19.10606168720481, -16.784150717267735, -220.30753554459594, -24.808759574653635, 42.81615522256122, -204.32204549697283, -335.63398153009337, -224.26646534229027, -17.570892474568844, -166.93983093682525, 200.0, -272.9760511568464, 64.93981373771437, -98.79914895740939, 194.06000000000003, -29.41717153926595, 60.44607305463173, -41.42133925492245, -6.653331383313363, 2.0000000000000013, 192.11041052429294, 135.43597445506822, -13.127390178086142, 1.1016536894583069, 26.952245285574232, -249.36295663006285, -378.5090742454727, -23.122584040336918, -35.59801102611747, 156.21711618065734, 200.0, -86.20682460916703, -0.021774581466807448, -281.76176572247, -87.51264573533065, 2.0000000000000013, 30.176885949233586, -336.79124055577256, -36.84492566646202, -0.5650194249974785, 2.0000000000000013, 181.35907918507655, -220.0566167027093, -409.08721507977333, -353.6038375704506, -410.0962871776739, 2.0000000000000013, -162.04840076220623, -103.85412221131227, -85.65463765365689, -6.773495724870829, -208.76964360402158, -155.477869119104, -83.88201184039191, 76.42729920575546, -123.44779730119188, -21.98502912936605, -52.57069839790512, -27.896830979434903, 1.026014347292848, 62.75396265919778, -150.11270061941667, 35.10881758374221, -206.2945163039689, -249.0649221207471, 104.2851075629068, -87.3143730065827, -507.25233414378636, 145.40282402621273, -69.82363403695332, -241.13670633923385, -27.469927299050163, -91.25487383283895, -241.81213189256258, 123.81956931300257, -317.9299806138517, -274.0330789549803, -376.5688083362075, 136.37002851910256, -124.88471806479092, -64.6808509024679, -172.25163317541984, -54.51192468023733, -452.2362701051066, 44.36766738944007, -80.30550076148639, -148.9273805534848, 56.02013745169762, -115.47453114716154, 183.24539401305282, 107.93000000000036, 176.3678679386698, 134.41802238124725, 109.01826502655737, -568.4617738696408, 183.26527021318017, -5.4895679080373085, -381.86147492247153, -209.14703836227594, 180.17788564470357, -220.7164469780367, -245.99874855528876, -291.64439737736814, 80.05770122170603, 105.31959638006455, -24.582445578777275, -104.90696266388304, -396.55300837896965, 94.16856474061633, -143.37974878589597, -301.7317873180603, -41.317127858883204, -71.09618958709721, -54.495159506967916, -238.01326939505645, -79.07791058741712, -136.10252786841022, -35.69508208396658, -494.14587252913515, 66.08725255689367, 182.58808245512608, -25.52347745641253, -241.17276981126378, -92.57920953470112, -116.51931993884155, -141.69087896152436, 71.19001624676231, -477.5515383997807, -105.36878552884974, -259.8984094717385, 1.3649968891882622, -5.616426868572327, -286.9862582987954, -126.69797034770482, -173.4787102614342, -334.3055727024504, -8.407426650497573, -35.04023955182762, -252.63732469417945, -80.28512145574031, -218.8833744640283, -315.341759326353, 163.37, -150.04391247972558, -6.181217717824289, -9.000259303373785, -99.54156982856014, 85.80825424360943, -405.8252228058303, -177.52820493381665, 78.71145394598894, -174.1861757455676, -162.9390526570353, -25.65789043946997, -463.53984445278917, -238.0063393568773, -163.44819434727862, -229.96770859777993, -1.0437545267793662, -453.30379173435233], "policy_predator_policy_reward": [346.0174676332704, 46.6240413968817, 34.694946809269176, 329.25215179342223, 47.12938718157963, 30.082323453448822, 244.34445527407263, 53.78790222489996, 49.086495975644965, 284.4108327591264, 15.827287971496265, 86.35620929222829, 223.06247822296478, 36.90315207058405, 253.97582848961812, 192.55999729960504, 18.40127679399728, 7.507053884545907, 163.17015153375831, 0.0, 100.13779536003464, 139.59812394629517, 0.0, 277.3987453878266, 174.98249970006347, 207.20059543566222, 0.0, 5.635999524120322, 27.208806446322246, 18.475009423010754, 14.949750119004356, 16.606825477037976, 31.714783483072193, 27.0690555269196, 3.0294838628933007, 324.3897030934295, 90.18757304418214, 69.26855743114196, 455.98513526338155, 161.6084500662476, 121.4362722830547, 22.17591669403735, 220.95753554459534, 138.91875957465362, 235.73086332589386, 48.0509463256915, 95.01875664073545, 436.5360907682424, 35.40851839012377, 163.5453973485886, 21.57120118976981, 252.02484996707622, 5.74104973474608, 216.2875050758069, 0.0, 31.247171539266223, 15.067225882051684, 78.23804031823865, 8.573331383313322, 0.0, 3.88958947570705, 29.63402554493181, 40.2876434236328, 72.56765478169122, 79.48775471442595, 250.21295663006208, 378.9490742454724, 24.972584040337207, 37.36801102611714, 1.2028838193428497, 121.68239816380115, 85.61483539849607, 138.10231492802473, 194.23742242219433, 36.92196148534689, 84.04735698230392, 89.04311405076645, 337.7312405557726, 23.299799869135676, 38.63492566646166, 0.0, 2.7709208149235165, 235.54684377730857, 436.99237160879386, 429.1592733749301, 404.682139754156, 0.0, 163.32840076220685, 109.03412221131286, 87.34463765365776, 177.8604607425683, 96.47355256678647, 30.802967858928906, 209.06760870289116, 26.240172866943357, 105.47990312634104, 18.82560245306052, 220.35609938102607, 29.696830979435184, 0.9639856527071534, 9.056504043542983, 158.5922339166749, 60.690628172681535, 175.66207290890955, 0.9230455177959581, 286.4871193760038, 508.2230421121848, 89.67768895664133, 14.847175973787248, 71.423634036953, 247.89251696863488, 170.25854778227557, 165.80796282267818, 277.25801537288737, 14.399429332516881, 324.1209819683314, 315.33906283449846, 377.83625168631556, 130.11625524822213, 10.882454159581545, 167.55529539194373, 127.60079333310058, 56.13192468023705, 452.4862701051065, 76.07233261055994, 81.97550076148724, 109.84922433215074, 152.90832907824094, 173.2545311471613, 2.8646059869471125, 0.0, 5.752132061330103, 40.581977618752845, 14.631734973442613, 571.4917738696407, 0.0, 192.79368422225247, 313.7368871588875, 210.31703836227493, 9.832114355296428, 320.9788712827187, 185.67268613158132, 294.58864832630735, 13.280026847206598, 0.0, 134.05263744098957, 190.01696266388313, 396.99300837896925, 0.0, 146.5711840452789, 382.0069813541159, 36.71570370193056, 132.57072525010102, 62.64551599495293, 315.546438355179, 89.26791058741745, 176.97646204982107, 197.98476041317943, 228.22991560444123, 419.3901184770534, 94.55287399564277, 4.2112724055559, 148.33673592580192, 278.95727192845766, 211.7593199388414, 143.0008789615234, 24.739983753238107, 477.9215383997805, 394.0201038036085, 2.014572048133501, 70.57455382572283, 130.08192800055897, 159.0470156075648, 246.38025500057898, 225.8587102614343, 335.19557270244957, 30.285978019596012, 18.044366307911034, 287.7273246941795, 123.41512145574089, 207.14309410582683, 319.0438824321159, 0.0, 160.16391247972462, 0.0, 176.9614770211981, 113.16336846168267, 14.4286257240486, 243.35212195249323, 375.45861716975116, 63.60854605401103, 175.58617574556632, 234.37413944218494, 64.82969178002026, 531.9584046791658, 197.43861614231358, 320.22053886327745, 115.88136395844136, 3.0137545267793455, 458.30379173435233]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6524180184721807, "mean_inference_ms": 3.06011310791645, "mean_action_processing_ms": 0.25517450903111144, "mean_env_wait_ms": 0.21596119624915544, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006362199783325195, "StateBufferConnector_ms": 0.0036962032318115234, "ViewRequirementAgentConnector_ms": 0.11433529853820801}, "num_episodes": 18, "episode_return_max": 361.06999999999994, "episode_return_min": -100.25995285107277, "episode_return_mean": 99.71238467141737, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 29.953967823393178, "num_env_steps_trained_throughput_per_sec": 29.953967823393178, "timesteps_total": 32000, "num_env_steps_sampled_lifetime": 32000, "num_agent_steps_sampled_lifetime": 128000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 128000, "timers": {"training_iteration_time_ms": 137750.261, "restore_workers_time_ms": 0.021, "training_step_time_ms": 137750.205, "sample_time_ms": 2033.049, "learn_time_ms": 135698.582, "learn_throughput": 29.477, "synch_weights_time_ms": 14.811}, "counters": {"num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000}, "done": false, "training_iteration": 8, "trial_id": "b941d_00000", "date": "2024-08-17_08-12-17", "timestamp": 1723862537, "time_this_iter_s": 133.56865119934082, "time_total_s": 1102.324833869934, "pid": 81115, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[32, [4, 4], 2], [64, [3, 3], 2], [128, [3, 3], 1]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [256, 256], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b04a9b80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1102.324833869934, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 23.108421052631577, "ram_util_percent": 77.73368421052632}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.24584728201861, "cur_kl_coeff": 0.675, "cur_lr": 0.00010000000000000003, "total_loss": 8.224000040185514, "policy_loss": -0.06563391396061335, "vf_loss": 8.276733530892265, "vf_explained_var": 0.14216558592660086, "kl": 0.019111758258394035, "entropy": 1.4312573317497497, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 16065.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.1323498835639345, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.00010000000000000003, "total_loss": 6.78828967790755, "policy_loss": -0.053873883879364086, "vf_loss": 6.827385538847989, "vf_explained_var": 0.08132688459895906, "kl": 0.014595581106839886, "entropy": 1.2484574129341772, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 16065.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "env_runners": {"episode_reward_max": 361.06999999999994, "episode_reward_min": -28.345599463404977, "episode_reward_mean": 103.28940399734387, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -568.4617738696408, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 571.4917738696407}, "policy_reward_mean": {"prey_policy": -114.44156751899044, "predator_policy": 166.08626951766223}, "custom_metrics": {}, "hist_stats": {"episode_reward": [122.27591937717516, -28.345599463404977, 14.44319232731854, 200.61999999999972, 188.16921959085755, 195.8899999999997, 112.33000000000035, 3.9199999999999604, 361.06999999999994, 100.82956171669714, 107.29000000000015, 2.2899999999999885, 159.19000000000034, 321.09040895313024, 50.55619704628231, 35.456672732319255, 120.1600000000002, 24.52478044413877, 186.12999999999988, 43.39538360362077, 70.14128838096177, 3.279999999999973, 6.869999999999939, 58.79087398046234, 0.5106956023236844, 84.69957789784802, 164.6259743068154, 3.789999999999963, 80.29000000000003, 65.16700236136414, 142.63035033595935, 3.3340239184564613, 161.8500000000001, 149.54443111262643, 109.99897247016386, 144.40999999999968, 42.573427229626496, 152.4840198621147, 58.223604647156684, 1.8699999999999983, 122.11000000000065, 169.85031030860443, 243.88999999999993, 290.0499999999993, 298.65, 186.2952702131802, 119.17952855063166, 191.1799999999997, 39.936361880975234, 96.28197901785283, 214.7897882422757, 85.5500000000001, 97.36000000000094, 75.673769879104, 69.62489215098955, 87.72316896012259, 203.16361251062352, 219.5614141092535, 255.8287513999113, 93.54202850829587, 96.55000000000028, 96.30000000000048, 30.76748085115433, 196.40505184689746, -8.256958038355517, 53.26999999999999, 4.882678125181631, 78.22000000000001, -8.038157252437976, 173.48999999999978, 161.77999999999963, 113.85867860078093, 35.457311382598114, 143.72000000000028, 110.60688812570025, 27.85083701181365, 42.68599987666077, 6.9699999999999775, 104.0800000000002, 103.20093756569688, 191.61574215139413, 34.803151416347426, 168.59000000000006, 1.5599999999999927, 110.87000000000013, 82.89719916371905, 59.47999999999995, 84.67199902326314, 20.62420004851223, 1.639999999999995, 33.459999999999994, 113.60251337822194, -4.453799570278526, 1.7199999999999969, 189.81565018952296, -5.009184480145812, 74.50739050057881, 136.74928788993145, 160.95464776179261, 320.42999999999995], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [42.81615522256122, -204.32204549697283, -335.63398153009337, -224.26646534229027, -17.570892474568844, -166.93983093682525, 200.0, -272.9760511568464, 64.93981373771437, -98.79914895740939, 194.06000000000003, -29.41717153926595, 60.44607305463173, -41.42133925492245, -6.653331383313363, 2.0000000000000013, 192.11041052429294, 135.43597445506822, -13.127390178086142, 1.1016536894583069, 26.952245285574232, -249.36295663006285, -378.5090742454727, -23.122584040336918, -35.59801102611747, 156.21711618065734, 200.0, -86.20682460916703, -0.021774581466807448, -281.76176572247, -87.51264573533065, 2.0000000000000013, 30.176885949233586, -336.79124055577256, -36.84492566646202, -0.5650194249974785, 2.0000000000000013, 181.35907918507655, -220.0566167027093, -409.08721507977333, -353.6038375704506, -410.0962871776739, 2.0000000000000013, -162.04840076220623, -103.85412221131227, -85.65463765365689, -6.773495724870829, -208.76964360402158, -155.477869119104, -83.88201184039191, 76.42729920575546, -123.44779730119188, -21.98502912936605, -52.57069839790512, -27.896830979434903, 1.026014347292848, 62.75396265919778, -150.11270061941667, 35.10881758374221, -206.2945163039689, -249.0649221207471, 104.2851075629068, -87.3143730065827, -507.25233414378636, 145.40282402621273, -69.82363403695332, -241.13670633923385, -27.469927299050163, -91.25487383283895, -241.81213189256258, 123.81956931300257, -317.9299806138517, -274.0330789549803, -376.5688083362075, 136.37002851910256, -124.88471806479092, -64.6808509024679, -172.25163317541984, -54.51192468023733, -452.2362701051066, 44.36766738944007, -80.30550076148639, -148.9273805534848, 56.02013745169762, -115.47453114716154, 183.24539401305282, 107.93000000000036, 176.3678679386698, 134.41802238124725, 109.01826502655737, -568.4617738696408, 183.26527021318017, -5.4895679080373085, -381.86147492247153, -209.14703836227594, 180.17788564470357, -220.7164469780367, -245.99874855528876, -291.64439737736814, 80.05770122170603, 105.31959638006455, -24.582445578777275, -104.90696266388304, -396.55300837896965, 94.16856474061633, -143.37974878589597, -301.7317873180603, -41.317127858883204, -71.09618958709721, -54.495159506967916, -238.01326939505645, -79.07791058741712, -136.10252786841022, -35.69508208396658, -494.14587252913515, 66.08725255689367, 182.58808245512608, -25.52347745641253, -241.17276981126378, -92.57920953470112, -116.51931993884155, -141.69087896152436, 71.19001624676231, -477.5515383997807, -105.36878552884974, -259.8984094717385, 1.3649968891882622, -5.616426868572327, -286.9862582987954, -126.69797034770482, -173.4787102614342, -334.3055727024504, -8.407426650497573, -35.04023955182762, -252.63732469417945, -80.28512145574031, -218.8833744640283, -315.341759326353, 163.37, -150.04391247972558, -6.181217717824289, -9.000259303373785, -99.54156982856014, 85.80825424360943, -405.8252228058303, -177.52820493381665, 78.71145394598894, -174.1861757455676, -162.9390526570353, -25.65789043946997, -463.53984445278917, -238.0063393568773, -163.44819434727862, -229.96770859777993, -1.0437545267793662, -453.30379173435233, -76.52580018072264, -180.92674860342228, -142.83794069911542, -313.15315720732093, -166.48484524158386, -237.40055502824188, -381.73958225024415, -121.90159385591362, -283.71438851578404, 95.19534741885538, -353.0438931343902, -222.07720386898256, -203.3819885608894, 108.0255420856582, 25.83643184611225, -126.86909116943599, -140.44809330929374, -253.33359240225855, -58.39597330556093, -405.0509948162384, -446.87105200355995, -6.645576990012679, -317.8100873442049, -458.26224989775136, -286.55466511858026, -209.92040675436866, -250.38624688246878, -300.2922818465675, -151.93917004765132, -393.454672190695, -406.35276022345425, -89.63079980451414, 188.57722351231098, -374.3679556692551, -331.60368669255854, -5.349184480145804, 32.96286235789844, -366.8742134204379, -179.94526157089933, -74.76002828861029, -98.88753919665024, 52.25328954547905, 62.961889341706716, 189.36574482574323], "policy_predator_policy_reward": [235.73086332589386, 48.0509463256915, 95.01875664073545, 436.5360907682424, 35.40851839012377, 163.5453973485886, 21.57120118976981, 252.02484996707622, 5.74104973474608, 216.2875050758069, 0.0, 31.247171539266223, 15.067225882051684, 78.23804031823865, 8.573331383313322, 0.0, 3.88958947570705, 29.63402554493181, 40.2876434236328, 72.56765478169122, 79.48775471442595, 250.21295663006208, 378.9490742454724, 24.972584040337207, 37.36801102611714, 1.2028838193428497, 121.68239816380115, 85.61483539849607, 138.10231492802473, 194.23742242219433, 36.92196148534689, 84.04735698230392, 89.04311405076645, 337.7312405557726, 23.299799869135676, 38.63492566646166, 0.0, 2.7709208149235165, 235.54684377730857, 436.99237160879386, 429.1592733749301, 404.682139754156, 0.0, 163.32840076220685, 109.03412221131286, 87.34463765365776, 177.8604607425683, 96.47355256678647, 30.802967858928906, 209.06760870289116, 26.240172866943357, 105.47990312634104, 18.82560245306052, 220.35609938102607, 29.696830979435184, 0.9639856527071534, 9.056504043542983, 158.5922339166749, 60.690628172681535, 175.66207290890955, 0.9230455177959581, 286.4871193760038, 508.2230421121848, 89.67768895664133, 14.847175973787248, 71.423634036953, 247.89251696863488, 170.25854778227557, 165.80796282267818, 277.25801537288737, 14.399429332516881, 324.1209819683314, 315.33906283449846, 377.83625168631556, 130.11625524822213, 10.882454159581545, 167.55529539194373, 127.60079333310058, 56.13192468023705, 452.4862701051065, 76.07233261055994, 81.97550076148724, 109.84922433215074, 152.90832907824094, 173.2545311471613, 2.8646059869471125, 0.0, 5.752132061330103, 40.581977618752845, 14.631734973442613, 571.4917738696407, 0.0, 192.79368422225247, 313.7368871588875, 210.31703836227493, 9.832114355296428, 320.9788712827187, 185.67268613158132, 294.58864832630735, 13.280026847206598, 0.0, 134.05263744098957, 190.01696266388313, 396.99300837896925, 0.0, 146.5711840452789, 382.0069813541159, 36.71570370193056, 132.57072525010102, 62.64551599495293, 315.546438355179, 89.26791058741745, 176.97646204982107, 197.98476041317943, 228.22991560444123, 419.3901184770534, 94.55287399564277, 4.2112724055559, 148.33673592580192, 278.95727192845766, 211.7593199388414, 143.0008789615234, 24.739983753238107, 477.9215383997805, 394.0201038036085, 2.014572048133501, 70.57455382572283, 130.08192800055897, 159.0470156075648, 246.38025500057898, 225.8587102614343, 335.19557270244957, 30.285978019596012, 18.044366307911034, 287.7273246941795, 123.41512145574089, 207.14309410582683, 319.0438824321159, 0.0, 160.16391247972462, 0.0, 176.9614770211981, 113.16336846168267, 14.4286257240486, 243.35212195249323, 375.45861716975116, 63.60854605401103, 175.58617574556632, 234.37413944218494, 64.82969178002026, 531.9584046791658, 197.43861614231358, 320.22053886327745, 115.88136395844136, 3.0137545267793455, 458.30379173435233, 248.83250037019192, 112.70004841395253, 196.99982964255014, 362.19220582958195, 286.399038226654, 309.1021041945645, 397.8710171779287, 140.57331034457633, 284.3043885157842, 72.80465258114462, 353.3938931343899, 223.2872038689823, 84.15466832653439, 122.07177814869662, 55.59076731760618, 128.3390911694367, 140.79005932054253, 312.4716263910085, 135.24436120456704, 412.87460594049566, 53.10972047872267, 421.03110856336195, 318.4500873442043, 459.26224989775136, 318.82466511858, 211.1104067543681, 196.21990562927212, 468.06113647798475, 381.8094593101457, 159.1305833579222, 407.585180762125, 90.11837926584371, 0.8284266772122326, 374.77795566925494, 331.94368669255823, 0.0, 12.316366227031743, 396.1023753360863, 340.9089292898482, 50.545648459593316, 187.81933521777742, 19.769562195186698, 66.3981106582934, 1.7042551742567325]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6548567816517417, "mean_inference_ms": 3.097494251395265, "mean_action_processing_ms": 0.2551039743192046, "mean_env_wait_ms": 0.21697710195743933, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005709290504455566, "StateBufferConnector_ms": 0.0036431550979614258, "ViewRequirementAgentConnector_ms": 0.11422097682952881}, "num_episodes": 22, "episode_return_max": 361.06999999999994, "episode_return_min": -28.345599463404977, "episode_return_mean": 103.28940399734387, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 30.299167385554536, "num_env_steps_trained_throughput_per_sec": 30.299167385554536, "timesteps_total": 36000, "num_env_steps_sampled_lifetime": 36000, "num_agent_steps_sampled_lifetime": 144000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 144000, "timers": {"training_iteration_time_ms": 137113.214, "restore_workers_time_ms": 0.02, "training_step_time_ms": 137113.16, "sample_time_ms": 2044.936, "learn_time_ms": 135049.921, "learn_throughput": 29.619, "synch_weights_time_ms": 14.672}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "done": false, "training_iteration": 9, "trial_id": "b941d_00000", "date": "2024-08-17_08-14-29", "timestamp": 1723862669, "time_this_iter_s": 132.03314304351807, "time_total_s": 1234.3579769134521, "pid": 81115, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[32, [4, 4], 2], [64, [3, 3], 2], [128, [3, 3], 1]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [256, 256], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b04a9550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1234.3579769134521, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 20.825531914893617, "ram_util_percent": 77.15585106382979}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.793910228070759, "cur_kl_coeff": 0.675, "cur_lr": 0.00010000000000000003, "total_loss": 8.969814231660632, "policy_loss": -0.07496673802773729, "vf_loss": 9.030815381347818, "vf_explained_var": 0.2025170210492674, "kl": 0.02068972473020449, "entropy": 1.390649057128442, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 17955.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.10081741519706, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.00010000000000000003, "total_loss": 7.755724050128271, "policy_loss": -0.061889816953667576, "vf_loss": 7.801416684458496, "vf_explained_var": 0.08683938913875155, "kl": 0.01599722912290818, "entropy": 1.1840569441911404, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 17955.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000}, "env_runners": {"episode_reward_max": 334.6106149065876, "episode_reward_min": -8.256958038355517, "episode_reward_mean": 104.18125126661315, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -568.4617738696408, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 189.36574482574323, "predator_policy": 571.4917738696407}, "policy_reward_mean": {"prey_policy": -145.3575692580355, "predator_policy": 197.44819489134196}, "custom_metrics": {}, "hist_stats": {"episode_reward": [58.79087398046234, 0.5106956023236844, 84.69957789784802, 164.6259743068154, 3.789999999999963, 80.29000000000003, 65.16700236136414, 142.63035033595935, 3.3340239184564613, 161.8500000000001, 149.54443111262643, 109.99897247016386, 144.40999999999968, 42.573427229626496, 152.4840198621147, 58.223604647156684, 1.8699999999999983, 122.11000000000065, 169.85031030860443, 243.88999999999993, 290.0499999999993, 298.65, 186.2952702131802, 119.17952855063166, 191.1799999999997, 39.936361880975234, 96.28197901785283, 214.7897882422757, 85.5500000000001, 97.36000000000094, 75.673769879104, 69.62489215098955, 87.72316896012259, 203.16361251062352, 219.5614141092535, 255.8287513999113, 93.54202850829587, 96.55000000000028, 96.30000000000048, 30.76748085115433, 196.40505184689746, -8.256958038355517, 53.26999999999999, 4.882678125181631, 78.22000000000001, -8.038157252437976, 173.48999999999978, 161.77999999999963, 113.85867860078093, 35.457311382598114, 143.72000000000028, 110.60688812570025, 27.85083701181365, 42.68599987666077, 6.9699999999999775, 104.0800000000002, 103.20093756569688, 191.61574215139413, 34.803151416347426, 168.59000000000006, 1.5599999999999927, 110.87000000000013, 82.89719916371905, 59.47999999999995, 84.67199902326314, 20.62420004851223, 1.639999999999995, 33.459999999999994, 113.60251337822194, -4.453799570278526, 1.7199999999999969, 189.81565018952296, -5.009184480145812, 74.50739050057881, 136.74928788993145, 160.95464776179261, 320.42999999999995, 28.359172450268414, 44.870000000000005, 15.979999999999963, 168.9137746445661, 64.17609385233455, 85.95926015478094, 200.3645999216663, 28.850909237631335, 118.46000000000005, 22.530000000000065, 163.17287208444066, 112.481279117809, 74.92000000000017, 2.1882900039243376, 122.52603687402888, 334.6106149065876, 170.37242087614754, 144.71649581761454, 45.41090954890921, 67.13732420631494, 179.6012584292123, 207.13999999999942, 88.02043950978992], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-6.773495724870829, -208.76964360402158, -155.477869119104, -83.88201184039191, 76.42729920575546, -123.44779730119188, -21.98502912936605, -52.57069839790512, -27.896830979434903, 1.026014347292848, 62.75396265919778, -150.11270061941667, 35.10881758374221, -206.2945163039689, -249.0649221207471, 104.2851075629068, -87.3143730065827, -507.25233414378636, 145.40282402621273, -69.82363403695332, -241.13670633923385, -27.469927299050163, -91.25487383283895, -241.81213189256258, 123.81956931300257, -317.9299806138517, -274.0330789549803, -376.5688083362075, 136.37002851910256, -124.88471806479092, -64.6808509024679, -172.25163317541984, -54.51192468023733, -452.2362701051066, 44.36766738944007, -80.30550076148639, -148.9273805534848, 56.02013745169762, -115.47453114716154, 183.24539401305282, 107.93000000000036, 176.3678679386698, 134.41802238124725, 109.01826502655737, -568.4617738696408, 183.26527021318017, -5.4895679080373085, -381.86147492247153, -209.14703836227594, 180.17788564470357, -220.7164469780367, -245.99874855528876, -291.64439737736814, 80.05770122170603, 105.31959638006455, -24.582445578777275, -104.90696266388304, -396.55300837896965, 94.16856474061633, -143.37974878589597, -301.7317873180603, -41.317127858883204, -71.09618958709721, -54.495159506967916, -238.01326939505645, -79.07791058741712, -136.10252786841022, -35.69508208396658, -494.14587252913515, 66.08725255689367, 182.58808245512608, -25.52347745641253, -241.17276981126378, -92.57920953470112, -116.51931993884155, -141.69087896152436, 71.19001624676231, -477.5515383997807, -105.36878552884974, -259.8984094717385, 1.3649968891882622, -5.616426868572327, -286.9862582987954, -126.69797034770482, -173.4787102614342, -334.3055727024504, -8.407426650497573, -35.04023955182762, -252.63732469417945, -80.28512145574031, -218.8833744640283, -315.341759326353, 163.37, -150.04391247972558, -6.181217717824289, -9.000259303373785, -99.54156982856014, 85.80825424360943, -405.8252228058303, -177.52820493381665, 78.71145394598894, -174.1861757455676, -162.9390526570353, -25.65789043946997, -463.53984445278917, -238.0063393568773, -163.44819434727862, -229.96770859777993, -1.0437545267793662, -453.30379173435233, -76.52580018072264, -180.92674860342228, -142.83794069911542, -313.15315720732093, -166.48484524158386, -237.40055502824188, -381.73958225024415, -121.90159385591362, -283.71438851578404, 95.19534741885538, -353.0438931343902, -222.07720386898256, -203.3819885608894, 108.0255420856582, 25.83643184611225, -126.86909116943599, -140.44809330929374, -253.33359240225855, -58.39597330556093, -405.0509948162384, -446.87105200355995, -6.645576990012679, -317.8100873442049, -458.26224989775136, -286.55466511858026, -209.92040675436866, -250.38624688246878, -300.2922818465675, -151.93917004765132, -393.454672190695, -406.35276022345425, -89.63079980451414, 188.57722351231098, -374.3679556692551, -331.60368669255854, -5.349184480145804, 32.96286235789844, -366.8742134204379, -179.94526157089933, -74.76002828861029, -98.88753919665024, 52.25328954547905, 62.961889341706716, 189.36574482574323, -371.9011462276756, -194.83470436741948, -9.908704201103546, -257.3411456354759, -449.9922208491999, 0.3214849827227357, 157.43, -362.3681839912107, -373.56394546030896, -244.33862438037505, -262.0374614283086, -70.19187335308489, 52.33151549602542, -433.00068074642206, -341.48208637520264, -329.18291500340115, -295.8653012242264, -158.703696531923, -297.22948167359635, -478.80173649588005, -240.77411546125157, -43.63015965820609, -184.8637542421979, -295.47304052990734, -219.38481963727693, -130.49614880438028, -398.6810918553188, -288.95908228634363, -56.619489787615784, -208.66960564644071, 111.32104071532433, -432.5647235339857, -222.82693257927727, 95.43416455680901, 34.36514532282587, -262.6561363806342, -415.86254622141, -237.30464952869087, -281.6073737909649, -468.70890523498593, -124.18394933367902, -64.63723273860666, 166.2161636102969, -90.49303232175687, 79.39840358045463, -459.08774891749493], "policy_predator_policy_reward": [177.8604607425683, 96.47355256678647, 30.802967858928906, 209.06760870289116, 26.240172866943357, 105.47990312634104, 18.82560245306052, 220.35609938102607, 29.696830979435184, 0.9639856527071534, 9.056504043542983, 158.5922339166749, 60.690628172681535, 175.66207290890955, 0.9230455177959581, 286.4871193760038, 508.2230421121848, 89.67768895664133, 14.847175973787248, 71.423634036953, 247.89251696863488, 170.25854778227557, 165.80796282267818, 277.25801537288737, 14.399429332516881, 324.1209819683314, 315.33906283449846, 377.83625168631556, 130.11625524822213, 10.882454159581545, 167.55529539194373, 127.60079333310058, 56.13192468023705, 452.4862701051065, 76.07233261055994, 81.97550076148724, 109.84922433215074, 152.90832907824094, 173.2545311471613, 2.8646059869471125, 0.0, 5.752132061330103, 40.581977618752845, 14.631734973442613, 571.4917738696407, 0.0, 192.79368422225247, 313.7368871588875, 210.31703836227493, 9.832114355296428, 320.9788712827187, 185.67268613158132, 294.58864832630735, 13.280026847206598, 0.0, 134.05263744098957, 190.01696266388313, 396.99300837896925, 0.0, 146.5711840452789, 382.0069813541159, 36.71570370193056, 132.57072525010102, 62.64551599495293, 315.546438355179, 89.26791058741745, 176.97646204982107, 197.98476041317943, 228.22991560444123, 419.3901184770534, 94.55287399564277, 4.2112724055559, 148.33673592580192, 278.95727192845766, 211.7593199388414, 143.0008789615234, 24.739983753238107, 477.9215383997805, 394.0201038036085, 2.014572048133501, 70.57455382572283, 130.08192800055897, 159.0470156075648, 246.38025500057898, 225.8587102614343, 335.19557270244957, 30.285978019596012, 18.044366307911034, 287.7273246941795, 123.41512145574089, 207.14309410582683, 319.0438824321159, 0.0, 160.16391247972462, 0.0, 176.9614770211981, 113.16336846168267, 14.4286257240486, 243.35212195249323, 375.45861716975116, 63.60854605401103, 175.58617574556632, 234.37413944218494, 64.82969178002026, 531.9584046791658, 197.43861614231358, 320.22053886327745, 115.88136395844136, 3.0137545267793455, 458.30379173435233, 248.83250037019192, 112.70004841395253, 196.99982964255014, 362.19220582958195, 286.399038226654, 309.1021041945645, 397.8710171779287, 140.57331034457633, 284.3043885157842, 72.80465258114462, 353.3938931343899, 223.2872038689823, 84.15466832653439, 122.07177814869662, 55.59076731760618, 128.3390911694367, 140.79005932054253, 312.4716263910085, 135.24436120456704, 412.87460594049566, 53.10972047872267, 421.03110856336195, 318.4500873442043, 459.26224989775136, 318.82466511858, 211.1104067543681, 196.21990562927212, 468.06113647798475, 381.8094593101457, 159.1305833579222, 407.585180762125, 90.11837926584371, 0.8284266772122326, 374.77795566925494, 331.94368669255823, 0.0, 12.316366227031743, 396.1023753360863, 340.9089292898482, 50.545648459593316, 187.81933521777742, 19.769562195186698, 66.3981106582934, 1.7042551742567325, 381.1992086083236, 213.895814437039, 54.10870420110331, 258.0111456354753, 463.9922208491999, 1.6585150172772658, 254.84554487025, 119.0064137655269, 404.00564378243695, 278.0730199105813, 135.78517168930338, 282.4034232468704, 165.54700669314693, 415.486758478916, 386.2928294864896, 313.22308112974525, 361.94530122422634, 211.08369653192275, 305.709481673596, 492.8517364958801, 288.89963511931717, 158.6775120845812, 247.18891388738552, 345.6291600025275, 255.58469425025353, 169.21627419140293, 419.290141566489, 270.5383225790973, 7.206931580583212, 380.60820072750175, 300.2384837779523, 355.61581394729694, 232.45788238860862, 65.30730651000702, 83.10252552685077, 289.9049613485721, 304.4569777662779, 394.1211275327315, 339.67469799727985, 477.77890523498576, 239.27090074914122, 129.15153975235705, 16.833836389703126, 114.58303232175743, 467.70978484683, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6530636095224531, "mean_inference_ms": 3.118638266523426, "mean_action_processing_ms": 0.25387864144388733, "mean_env_wait_ms": 0.21739811822580954, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005035400390625, "StateBufferConnector_ms": 0.0037413835525512695, "ViewRequirementAgentConnector_ms": 0.11282968521118164}, "num_episodes": 23, "episode_return_max": 334.6106149065876, "episode_return_min": -8.256958038355517, "episode_return_mean": 104.18125126661315, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 30.553084401059618, "num_env_steps_trained_throughput_per_sec": 30.553084401059618, "timesteps_total": 40000, "num_env_steps_sampled_lifetime": 40000, "num_agent_steps_sampled_lifetime": 160000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 160000, "timers": {"training_iteration_time_ms": 136493.861, "restore_workers_time_ms": 0.019, "training_step_time_ms": 136493.809, "sample_time_ms": 2040.459, "learn_time_ms": 134435.701, "learn_throughput": 29.754, "synch_weights_time_ms": 14.28}, "counters": {"num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000}, "done": false, "training_iteration": 10, "trial_id": "b941d_00000", "date": "2024-08-17_08-16-40", "timestamp": 1723862800, "time_this_iter_s": 130.92475700378418, "time_total_s": 1365.2827339172363, "pid": 81115, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[32, [4, 4], 2], [64, [3, 3], 2], [128, [3, 3], 1]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [256, 256], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b04a9310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1365.2827339172363, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 19.088709677419356, "ram_util_percent": 76.71989247311829}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.047825967824018, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.00010000000000000003, "total_loss": 8.649246249123225, "policy_loss": -0.07384381041315104, "vf_loss": 8.705559387913457, "vf_explained_var": 0.18613941344634566, "kl": 0.01731422318368782, "entropy": 1.390144300586963, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 19845.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.389259807016484, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.00010000000000000003, "total_loss": 7.944623247530094, "policy_loss": -0.06253726858234221, "vf_loss": 7.991413021339941, "vf_explained_var": 0.07874102854224109, "kl": 0.015553073160294579, "entropy": 1.1737765460418015, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 19845.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000}, "env_runners": {"episode_reward_max": 334.6106149065876, "episode_reward_min": -28.673301273532758, "episode_reward_mean": 102.6623242944464, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -640.1834061569069, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 189.36574482574323, "predator_policy": 640.2909929198494}, "policy_reward_mean": {"prey_policy": -169.79416526453147, "predator_policy": 221.1253274117545}, "custom_metrics": {}, "hist_stats": {"episode_reward": [169.85031030860443, 243.88999999999993, 290.0499999999993, 298.65, 186.2952702131802, 119.17952855063166, 191.1799999999997, 39.936361880975234, 96.28197901785283, 214.7897882422757, 85.5500000000001, 97.36000000000094, 75.673769879104, 69.62489215098955, 87.72316896012259, 203.16361251062352, 219.5614141092535, 255.8287513999113, 93.54202850829587, 96.55000000000028, 96.30000000000048, 30.76748085115433, 196.40505184689746, -8.256958038355517, 53.26999999999999, 4.882678125181631, 78.22000000000001, -8.038157252437976, 173.48999999999978, 161.77999999999963, 113.85867860078093, 35.457311382598114, 143.72000000000028, 110.60688812570025, 27.85083701181365, 42.68599987666077, 6.9699999999999775, 104.0800000000002, 103.20093756569688, 191.61574215139413, 34.803151416347426, 168.59000000000006, 1.5599999999999927, 110.87000000000013, 82.89719916371905, 59.47999999999995, 84.67199902326314, 20.62420004851223, 1.639999999999995, 33.459999999999994, 113.60251337822194, -4.453799570278526, 1.7199999999999969, 189.81565018952296, -5.009184480145812, 74.50739050057881, 136.74928788993145, 160.95464776179261, 320.42999999999995, 28.359172450268414, 44.870000000000005, 15.979999999999963, 168.9137746445661, 64.17609385233455, 85.95926015478094, 200.3645999216663, 28.850909237631335, 118.46000000000005, 22.530000000000065, 163.17287208444066, 112.481279117809, 74.92000000000017, 2.1882900039243376, 122.52603687402888, 334.6106149065876, 170.37242087614754, 144.71649581761454, 45.41090954890921, 67.13732420631494, 179.6012584292123, 207.13999999999942, 88.02043950978992, 67.35926443854936, -0.7079827643139769, 19.650000000000173, -28.673301273532758, 111.52815439541111, 82.48667183830845, 83.3860713120428, 54.626362619795756, 212.04635259300892, 12.061742762787553, 66.30929600417768, 7.713341300757039, 32.03610195956907, 159.04924577142177, -3.854278909769093, 259.5012711743096, 86.73122866255345, 173.7607146231665], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-148.9273805534848, 56.02013745169762, -115.47453114716154, 183.24539401305282, 107.93000000000036, 176.3678679386698, 134.41802238124725, 109.01826502655737, -568.4617738696408, 183.26527021318017, -5.4895679080373085, -381.86147492247153, -209.14703836227594, 180.17788564470357, -220.7164469780367, -245.99874855528876, -291.64439737736814, 80.05770122170603, 105.31959638006455, -24.582445578777275, -104.90696266388304, -396.55300837896965, 94.16856474061633, -143.37974878589597, -301.7317873180603, -41.317127858883204, -71.09618958709721, -54.495159506967916, -238.01326939505645, -79.07791058741712, -136.10252786841022, -35.69508208396658, -494.14587252913515, 66.08725255689367, 182.58808245512608, -25.52347745641253, -241.17276981126378, -92.57920953470112, -116.51931993884155, -141.69087896152436, 71.19001624676231, -477.5515383997807, -105.36878552884974, -259.8984094717385, 1.3649968891882622, -5.616426868572327, -286.9862582987954, -126.69797034770482, -173.4787102614342, -334.3055727024504, -8.407426650497573, -35.04023955182762, -252.63732469417945, -80.28512145574031, -218.8833744640283, -315.341759326353, 163.37, -150.04391247972558, -6.181217717824289, -9.000259303373785, -99.54156982856014, 85.80825424360943, -405.8252228058303, -177.52820493381665, 78.71145394598894, -174.1861757455676, -162.9390526570353, -25.65789043946997, -463.53984445278917, -238.0063393568773, -163.44819434727862, -229.96770859777993, -1.0437545267793662, -453.30379173435233, -76.52580018072264, -180.92674860342228, -142.83794069911542, -313.15315720732093, -166.48484524158386, -237.40055502824188, -381.73958225024415, -121.90159385591362, -283.71438851578404, 95.19534741885538, -353.0438931343902, -222.07720386898256, -203.3819885608894, 108.0255420856582, 25.83643184611225, -126.86909116943599, -140.44809330929374, -253.33359240225855, -58.39597330556093, -405.0509948162384, -446.87105200355995, -6.645576990012679, -317.8100873442049, -458.26224989775136, -286.55466511858026, -209.92040675436866, -250.38624688246878, -300.2922818465675, -151.93917004765132, -393.454672190695, -406.35276022345425, -89.63079980451414, 188.57722351231098, -374.3679556692551, -331.60368669255854, -5.349184480145804, 32.96286235789844, -366.8742134204379, -179.94526157089933, -74.76002828861029, -98.88753919665024, 52.25328954547905, 62.961889341706716, 189.36574482574323, -371.9011462276756, -194.83470436741948, -9.908704201103546, -257.3411456354759, -449.9922208491999, 0.3214849827227357, 157.43, -362.3681839912107, -373.56394546030896, -244.33862438037505, -262.0374614283086, -70.19187335308489, 52.33151549602542, -433.00068074642206, -341.48208637520264, -329.18291500340115, -295.8653012242264, -158.703696531923, -297.22948167359635, -478.80173649588005, -240.77411546125157, -43.63015965820609, -184.8637542421979, -295.47304052990734, -219.38481963727693, -130.49614880438028, -398.6810918553188, -288.95908228634363, -56.619489787615784, -208.66960564644071, 111.32104071532433, -432.5647235339857, -222.82693257927727, 95.43416455680901, 34.36514532282587, -262.6561363806342, -415.86254622141, -237.30464952869087, -281.6073737909649, -468.70890523498593, -124.18394933367902, -64.63723273860666, 166.2161636102969, -90.49303232175687, 79.39840358045463, -459.08774891749493, -245.29409012066318, -348.6349632237197, -432.89834263085686, -640.1834061569069, -263.16067693212955, -276.7558030202313, -58.71978378720734, -390.4668736677979, -333.94369878454114, -74.51413757571595, -298.7362156037383, -383.5220910621132, -398.8048024491191, -156.46223637986128, -409.3512728593317, -308.0001252658316, 123.617548611334, -141.19606620928562, -213.00472572677637, -294.62481013385485, -141.8938383276579, -7.087940653756638, -150.56597638785684, -376.20731936825314, -3.867977497812916, -306.2154221929969, -493.6868329663108, 94.78622981675525, -278.42124240765946, -381.44386956138055, 47.348789002999, -510.1947939606271, -105.3142978724682, -155.2771435553536, 38.898315736878814, -353.7002788046719], "policy_predator_policy_reward": [109.84922433215074, 152.90832907824094, 173.2545311471613, 2.8646059869471125, 0.0, 5.752132061330103, 40.581977618752845, 14.631734973442613, 571.4917738696407, 0.0, 192.79368422225247, 313.7368871588875, 210.31703836227493, 9.832114355296428, 320.9788712827187, 185.67268613158132, 294.58864832630735, 13.280026847206598, 0.0, 134.05263744098957, 190.01696266388313, 396.99300837896925, 0.0, 146.5711840452789, 382.0069813541159, 36.71570370193056, 132.57072525010102, 62.64551599495293, 315.546438355179, 89.26791058741745, 176.97646204982107, 197.98476041317943, 228.22991560444123, 419.3901184770534, 94.55287399564277, 4.2112724055559, 148.33673592580192, 278.95727192845766, 211.7593199388414, 143.0008789615234, 24.739983753238107, 477.9215383997805, 394.0201038036085, 2.014572048133501, 70.57455382572283, 130.08192800055897, 159.0470156075648, 246.38025500057898, 225.8587102614343, 335.19557270244957, 30.285978019596012, 18.044366307911034, 287.7273246941795, 123.41512145574089, 207.14309410582683, 319.0438824321159, 0.0, 160.16391247972462, 0.0, 176.9614770211981, 113.16336846168267, 14.4286257240486, 243.35212195249323, 375.45861716975116, 63.60854605401103, 175.58617574556632, 234.37413944218494, 64.82969178002026, 531.9584046791658, 197.43861614231358, 320.22053886327745, 115.88136395844136, 3.0137545267793455, 458.30379173435233, 248.83250037019192, 112.70004841395253, 196.99982964255014, 362.19220582958195, 286.399038226654, 309.1021041945645, 397.8710171779287, 140.57331034457633, 284.3043885157842, 72.80465258114462, 353.3938931343899, 223.2872038689823, 84.15466832653439, 122.07177814869662, 55.59076731760618, 128.3390911694367, 140.79005932054253, 312.4716263910085, 135.24436120456704, 412.87460594049566, 53.10972047872267, 421.03110856336195, 318.4500873442043, 459.26224989775136, 318.82466511858, 211.1104067543681, 196.21990562927212, 468.06113647798475, 381.8094593101457, 159.1305833579222, 407.585180762125, 90.11837926584371, 0.8284266772122326, 374.77795566925494, 331.94368669255823, 0.0, 12.316366227031743, 396.1023753360863, 340.9089292898482, 50.545648459593316, 187.81933521777742, 19.769562195186698, 66.3981106582934, 1.7042551742567325, 381.1992086083236, 213.895814437039, 54.10870420110331, 258.0111456354753, 463.9922208491999, 1.6585150172772658, 254.84554487025, 119.0064137655269, 404.00564378243695, 278.0730199105813, 135.78517168930338, 282.4034232468704, 165.54700669314693, 415.486758478916, 386.2928294864896, 313.22308112974525, 361.94530122422634, 211.08369653192275, 305.709481673596, 492.8517364958801, 288.89963511931717, 158.6775120845812, 247.18891388738552, 345.6291600025275, 255.58469425025353, 169.21627419140293, 419.290141566489, 270.5383225790973, 7.206931580583212, 380.60820072750175, 300.2384837779523, 355.61581394729694, 232.45788238860862, 65.30730651000702, 83.10252552685077, 289.9049613485721, 304.4569777662779, 394.1211275327315, 339.67469799727985, 477.77890523498576, 239.27090074914122, 129.15153975235705, 16.833836389703126, 114.58303232175743, 467.70978484683, 0.0, 346.285586467217, 315.00273131571487, 432.0827731036003, 640.2909929198494, 281.680676932129, 277.8858030202303, 28.29239097484944, 392.22096520662257, 329.8212764861643, 190.16471426950264, 464.23900072332583, 300.50597778083386, 405.34661728347686, 233.30649285754595, 395.1753360162059, 376.80242472875324, 0.0, 229.62487019096037, 302.96251562194755, 216.72876300147044, 151.00712703167912, 64.28394795391304, 166.80319723221473, 367.68343982465194, 200.9307822933399, 141.18871935703905, 304.5407921039373, 253.40905681703993, 408.4388723652736, 247.57196069399646, 270.55151193515337, 451.79576419678443, 136.27900757220252, 211.0436625181732, 284.4810952224611, 204.081582468498]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6518770231058261, "mean_inference_ms": 3.12912690832102, "mean_action_processing_ms": 0.25329549777688115, "mean_env_wait_ms": 0.21776382055058555, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005110383033752441, "StateBufferConnector_ms": 0.0037581920623779297, "ViewRequirementAgentConnector_ms": 0.11337995529174805}, "num_episodes": 18, "episode_return_max": 334.6106149065876, "episode_return_min": -28.673301273532758, "episode_return_mean": 102.6623242944464, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 30.614080531943355, "num_env_steps_trained_throughput_per_sec": 30.614080531943355, "timesteps_total": 44000, "num_env_steps_sampled_lifetime": 44000, "num_agent_steps_sampled_lifetime": 176000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 176000, "timers": {"training_iteration_time_ms": 136353.189, "restore_workers_time_ms": 0.019, "training_step_time_ms": 136353.139, "sample_time_ms": 2065.271, "learn_time_ms": 134270.726, "learn_throughput": 29.791, "synch_weights_time_ms": 14.093}, "counters": {"num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000}, "done": false, "training_iteration": 11, "trial_id": "b941d_00000", "date": "2024-08-17_08-18-51", "timestamp": 1723862931, "time_this_iter_s": 130.67542576789856, "time_total_s": 1495.958159685135, "pid": 81115, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[32, [4, 4], 2], [64, [3, 3], 2], [128, [3, 3], 1]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [256, 256], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b04b4c10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1495.958159685135, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 21.066486486486486, "ram_util_percent": 76.82756756756757}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 12.767537850236137, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.00010000000000000003, "total_loss": 9.261665617221247, "policy_loss": -0.06679044883826343, "vf_loss": 9.312872618720645, "vf_explained_var": 0.266449348257963, "kl": 0.015391059703591165, "entropy": 1.3830222908151213, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 21735.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.484774975928049, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.00010000000000000003, "total_loss": 8.440131418036405, "policy_loss": -0.06103894060955595, "vf_loss": 8.48552721290992, "vf_explained_var": 0.06145440194972608, "kl": 0.015450032153037859, "entropy": 1.1657560685955028, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 21735.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000}, "env_runners": {"episode_reward_max": 334.6106149065876, "episode_reward_min": -28.673301273532758, "episode_reward_mean": 93.96067604185193, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -640.1834061569069, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 189.36574482574323, "predator_policy": 640.2909929198494}, "policy_reward_mean": {"prey_policy": -192.00280866959815, "predator_policy": 238.98314669052397}, "custom_metrics": {}, "hist_stats": {"episode_reward": [93.54202850829587, 96.55000000000028, 96.30000000000048, 30.76748085115433, 196.40505184689746, -8.256958038355517, 53.26999999999999, 4.882678125181631, 78.22000000000001, -8.038157252437976, 173.48999999999978, 161.77999999999963, 113.85867860078093, 35.457311382598114, 143.72000000000028, 110.60688812570025, 27.85083701181365, 42.68599987666077, 6.9699999999999775, 104.0800000000002, 103.20093756569688, 191.61574215139413, 34.803151416347426, 168.59000000000006, 1.5599999999999927, 110.87000000000013, 82.89719916371905, 59.47999999999995, 84.67199902326314, 20.62420004851223, 1.639999999999995, 33.459999999999994, 113.60251337822194, -4.453799570278526, 1.7199999999999969, 189.81565018952296, -5.009184480145812, 74.50739050057881, 136.74928788993145, 160.95464776179261, 320.42999999999995, 28.359172450268414, 44.870000000000005, 15.979999999999963, 168.9137746445661, 64.17609385233455, 85.95926015478094, 200.3645999216663, 28.850909237631335, 118.46000000000005, 22.530000000000065, 163.17287208444066, 112.481279117809, 74.92000000000017, 2.1882900039243376, 122.52603687402888, 334.6106149065876, 170.37242087614754, 144.71649581761454, 45.41090954890921, 67.13732420631494, 179.6012584292123, 207.13999999999942, 88.02043950978992, 67.35926443854936, -0.7079827643139769, 19.650000000000173, -28.673301273532758, 111.52815439541111, 82.48667183830845, 83.3860713120428, 54.626362619795756, 212.04635259300892, 12.061742762787553, 66.30929600417768, 7.713341300757039, 32.03610195956907, 159.04924577142177, -3.854278909769093, 259.5012711743096, 86.73122866255345, 173.7607146231665, 136.0702701955036, 129.54721540444217, 205.34410268414226, 4.5908606022015395, 173.8700000000003, 107.20999999999998, 64.26789935456043, 185.48144064944336, 116.6720420061177, 170.54742986834577, 184.72802185213772, 164.61360708318188, 189.27, 21.59999999999998, 4.897299910938856, 81.74625538385632, 85.49757696920568, 48.47], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-241.17276981126378, -92.57920953470112, -116.51931993884155, -141.69087896152436, 71.19001624676231, -477.5515383997807, -105.36878552884974, -259.8984094717385, 1.3649968891882622, -5.616426868572327, -286.9862582987954, -126.69797034770482, -173.4787102614342, -334.3055727024504, -8.407426650497573, -35.04023955182762, -252.63732469417945, -80.28512145574031, -218.8833744640283, -315.341759326353, 163.37, -150.04391247972558, -6.181217717824289, -9.000259303373785, -99.54156982856014, 85.80825424360943, -405.8252228058303, -177.52820493381665, 78.71145394598894, -174.1861757455676, -162.9390526570353, -25.65789043946997, -463.53984445278917, -238.0063393568773, -163.44819434727862, -229.96770859777993, -1.0437545267793662, -453.30379173435233, -76.52580018072264, -180.92674860342228, -142.83794069911542, -313.15315720732093, -166.48484524158386, -237.40055502824188, -381.73958225024415, -121.90159385591362, -283.71438851578404, 95.19534741885538, -353.0438931343902, -222.07720386898256, -203.3819885608894, 108.0255420856582, 25.83643184611225, -126.86909116943599, -140.44809330929374, -253.33359240225855, -58.39597330556093, -405.0509948162384, -446.87105200355995, -6.645576990012679, -317.8100873442049, -458.26224989775136, -286.55466511858026, -209.92040675436866, -250.38624688246878, -300.2922818465675, -151.93917004765132, -393.454672190695, -406.35276022345425, -89.63079980451414, 188.57722351231098, -374.3679556692551, -331.60368669255854, -5.349184480145804, 32.96286235789844, -366.8742134204379, -179.94526157089933, -74.76002828861029, -98.88753919665024, 52.25328954547905, 62.961889341706716, 189.36574482574323, -371.9011462276756, -194.83470436741948, -9.908704201103546, -257.3411456354759, -449.9922208491999, 0.3214849827227357, 157.43, -362.3681839912107, -373.56394546030896, -244.33862438037505, -262.0374614283086, -70.19187335308489, 52.33151549602542, -433.00068074642206, -341.48208637520264, -329.18291500340115, -295.8653012242264, -158.703696531923, -297.22948167359635, -478.80173649588005, -240.77411546125157, -43.63015965820609, -184.8637542421979, -295.47304052990734, -219.38481963727693, -130.49614880438028, -398.6810918553188, -288.95908228634363, -56.619489787615784, -208.66960564644071, 111.32104071532433, -432.5647235339857, -222.82693257927727, 95.43416455680901, 34.36514532282587, -262.6561363806342, -415.86254622141, -237.30464952869087, -281.6073737909649, -468.70890523498593, -124.18394933367902, -64.63723273860666, 166.2161636102969, -90.49303232175687, 79.39840358045463, -459.08774891749493, -245.29409012066318, -348.6349632237197, -432.89834263085686, -640.1834061569069, -263.16067693212955, -276.7558030202313, -58.71978378720734, -390.4668736677979, -333.94369878454114, -74.51413757571595, -298.7362156037383, -383.5220910621132, -398.8048024491191, -156.46223637986128, -409.3512728593317, -308.0001252658316, 123.617548611334, -141.19606620928562, -213.00472572677637, -294.62481013385485, -141.8938383276579, -7.087940653756638, -150.56597638785684, -376.20731936825314, -3.867977497812916, -306.2154221929969, -493.6868329663108, 94.78622981675525, -278.42124240765946, -381.44386956138055, 47.348789002999, -510.1947939606271, -105.3142978724682, -155.2771435553536, 38.898315736878814, -353.7002788046719, -258.44223535507143, 28.46268470856632, -479.03419837933006, -181.6321043417126, 129.76307156810242, -238.1926253200464, -432.40830379968827, -338.0515968497722, 104.66940154920414, -229.59612747662908, -344.1867881769877, -37.89039219746397, -392.93456893529714, -231.66254480085615, -415.3270072983339, -28.24140468322231, 9.511466190384198, -243.0761947548709, 55.9467506416212, -120.61939681801944, 175.51989491515602, -378.48810123510026, -391.4943470590222, 38.47668541922137, -7.416256567291967, 68.7043982723352, -319.3641032870086, -335.18152257599104, -359.8958605825254, -432.4717289190819, -167.01807280940827, -159.2065091329014, -364.9144078963541, -188.3808612583558, -281.90862856301027, -371.42503445375485], "policy_predator_policy_reward": [148.33673592580192, 278.95727192845766, 211.7593199388414, 143.0008789615234, 24.739983753238107, 477.9215383997805, 394.0201038036085, 2.014572048133501, 70.57455382572283, 130.08192800055897, 159.0470156075648, 246.38025500057898, 225.8587102614343, 335.19557270244957, 30.285978019596012, 18.044366307911034, 287.7273246941795, 123.41512145574089, 207.14309410582683, 319.0438824321159, 0.0, 160.16391247972462, 0.0, 176.9614770211981, 113.16336846168267, 14.4286257240486, 243.35212195249323, 375.45861716975116, 63.60854605401103, 175.58617574556632, 234.37413944218494, 64.82969178002026, 531.9584046791658, 197.43861614231358, 320.22053886327745, 115.88136395844136, 3.0137545267793455, 458.30379173435233, 248.83250037019192, 112.70004841395253, 196.99982964255014, 362.19220582958195, 286.399038226654, 309.1021041945645, 397.8710171779287, 140.57331034457633, 284.3043885157842, 72.80465258114462, 353.3938931343899, 223.2872038689823, 84.15466832653439, 122.07177814869662, 55.59076731760618, 128.3390911694367, 140.79005932054253, 312.4716263910085, 135.24436120456704, 412.87460594049566, 53.10972047872267, 421.03110856336195, 318.4500873442043, 459.26224989775136, 318.82466511858, 211.1104067543681, 196.21990562927212, 468.06113647798475, 381.8094593101457, 159.1305833579222, 407.585180762125, 90.11837926584371, 0.8284266772122326, 374.77795566925494, 331.94368669255823, 0.0, 12.316366227031743, 396.1023753360863, 340.9089292898482, 50.545648459593316, 187.81933521777742, 19.769562195186698, 66.3981106582934, 1.7042551742567325, 381.1992086083236, 213.895814437039, 54.10870420110331, 258.0111456354753, 463.9922208491999, 1.6585150172772658, 254.84554487025, 119.0064137655269, 404.00564378243695, 278.0730199105813, 135.78517168930338, 282.4034232468704, 165.54700669314693, 415.486758478916, 386.2928294864896, 313.22308112974525, 361.94530122422634, 211.08369653192275, 305.709481673596, 492.8517364958801, 288.89963511931717, 158.6775120845812, 247.18891388738552, 345.6291600025275, 255.58469425025353, 169.21627419140293, 419.290141566489, 270.5383225790973, 7.206931580583212, 380.60820072750175, 300.2384837779523, 355.61581394729694, 232.45788238860862, 65.30730651000702, 83.10252552685077, 289.9049613485721, 304.4569777662779, 394.1211275327315, 339.67469799727985, 477.77890523498576, 239.27090074914122, 129.15153975235705, 16.833836389703126, 114.58303232175743, 467.70978484683, 0.0, 346.285586467217, 315.00273131571487, 432.0827731036003, 640.2909929198494, 281.680676932129, 277.8858030202303, 28.29239097484944, 392.22096520662257, 329.8212764861643, 190.16471426950264, 464.23900072332583, 300.50597778083386, 405.34661728347686, 233.30649285754595, 395.1753360162059, 376.80242472875324, 0.0, 229.62487019096037, 302.96251562194755, 216.72876300147044, 151.00712703167912, 64.28394795391304, 166.80319723221473, 367.68343982465194, 200.9307822933399, 141.18871935703905, 304.5407921039373, 253.40905681703993, 408.4388723652736, 247.57196069399646, 270.55151193515337, 451.79576419678443, 136.27900757220252, 211.0436625181732, 284.4810952224611, 204.081582468498, 273.2225055505745, 92.82731529143378, 386.0282337256954, 404.1852843997896, 313.773656436086, 0.0, 438.60603591094093, 336.4447253407207, 68.39059845079588, 230.40612747662854, 344.99678817698754, 144.29039219746414, 351.8237390841725, 337.0412740065412, 260.2911153905884, 368.75873724041145, 58.7562865250734, 291.48048404552947, 42.74163473227471, 192.4784413124688, 7.830522088303395, 379.865706083778, 351.349155754833, 166.2821129681496, 86.08298948306391, 41.89886881189308, 320.9641032870089, 355.18152257599104, 450.32791438231044, 346.9369750302352, 256.0023795679083, 151.96845775825824, 365.4444078963543, 273.3484382275615, 318.12862856301007, 383.67503445375485]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6508596944592483, "mean_inference_ms": 3.1342106363012534, "mean_action_processing_ms": 0.2526161339596731, "mean_env_wait_ms": 0.21781975587524088, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0050356388092041016, "StateBufferConnector_ms": 0.003721475601196289, "ViewRequirementAgentConnector_ms": 0.11188304424285889}, "num_episodes": 18, "episode_return_max": 334.6106149065876, "episode_return_min": -28.673301273532758, "episode_return_mean": 93.96067604185193, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 31.32808772417881, "num_env_steps_trained_throughput_per_sec": 31.32808772417881, "timesteps_total": 48000, "num_env_steps_sampled_lifetime": 48000, "num_agent_steps_sampled_lifetime": 192000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 192000, "timers": {"training_iteration_time_ms": 135863.934, "restore_workers_time_ms": 0.012, "training_step_time_ms": 135863.896, "sample_time_ms": 2064.347, "learn_time_ms": 133782.507, "learn_throughput": 29.899, "synch_weights_time_ms": 14.35}, "counters": {"num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000}, "done": false, "training_iteration": 12, "trial_id": "b941d_00000", "date": "2024-08-17_08-20-58", "timestamp": 1723863058, "time_this_iter_s": 127.68584418296814, "time_total_s": 1623.644003868103, "pid": 81115, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[32, [4, 4], 2], [64, [3, 3], 2], [128, [3, 3], 1]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [256, 256], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b0495820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1623.644003868103, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 34.87900552486188, "ram_util_percent": 77.3182320441989}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 11.508029449175275, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.00010000000000000003, "total_loss": 8.923824481610898, "policy_loss": -0.06808948451111084, "vf_loss": 8.975756877818435, "vf_explained_var": 0.33489370749741004, "kl": 0.01595761728453451, "entropy": 1.3821905236395577, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 23625.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.345976556041253, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.00010000000000000003, "total_loss": 7.466886479261691, "policy_loss": -0.05332523142381832, "vf_loss": 7.50545461997784, "vf_explained_var": 0.0646521269013642, "kl": 0.014574896446192807, "entropy": 1.1634651771298161, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 23625.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 208000, "num_agent_steps_trained": 208000}, "env_runners": {"episode_reward_max": 334.6106149065876, "episode_reward_min": -28.673301273532758, "episode_reward_mean": 101.00317566081867, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -640.1834061569069, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 189.36574482574323, "predator_policy": 640.2909929198494}, "policy_reward_mean": {"prey_policy": -202.26931851377995, "predator_policy": 252.77090634418914}, "custom_metrics": {}, "hist_stats": {"episode_reward": [6.9699999999999775, 104.0800000000002, 103.20093756569688, 191.61574215139413, 34.803151416347426, 168.59000000000006, 1.5599999999999927, 110.87000000000013, 82.89719916371905, 59.47999999999995, 84.67199902326314, 20.62420004851223, 1.639999999999995, 33.459999999999994, 113.60251337822194, -4.453799570278526, 1.7199999999999969, 189.81565018952296, -5.009184480145812, 74.50739050057881, 136.74928788993145, 160.95464776179261, 320.42999999999995, 28.359172450268414, 44.870000000000005, 15.979999999999963, 168.9137746445661, 64.17609385233455, 85.95926015478094, 200.3645999216663, 28.850909237631335, 118.46000000000005, 22.530000000000065, 163.17287208444066, 112.481279117809, 74.92000000000017, 2.1882900039243376, 122.52603687402888, 334.6106149065876, 170.37242087614754, 144.71649581761454, 45.41090954890921, 67.13732420631494, 179.6012584292123, 207.13999999999942, 88.02043950978992, 67.35926443854936, -0.7079827643139769, 19.650000000000173, -28.673301273532758, 111.52815439541111, 82.48667183830845, 83.3860713120428, 54.626362619795756, 212.04635259300892, 12.061742762787553, 66.30929600417768, 7.713341300757039, 32.03610195956907, 159.04924577142177, -3.854278909769093, 259.5012711743096, 86.73122866255345, 173.7607146231665, 136.0702701955036, 129.54721540444217, 205.34410268414226, 4.5908606022015395, 173.8700000000003, 107.20999999999998, 64.26789935456043, 185.48144064944336, 116.6720420061177, 170.54742986834577, 184.72802185213772, 164.61360708318188, 189.27, 21.59999999999998, 4.897299910938856, 81.74625538385632, 85.49757696920568, 48.47, 105.7706985583373, 88.86999999999998, 119.02441521627367, 52.52991012177082, 42.0054165608224, 221.50996027279822, 230.27900937308462, 185.66165843717013, 116.81843677754745, 138.5300000000002, 194.50276406521863, 1.73, 163.31721589480202, 123.25000000000027, 113.56357171039856, 160.4859404076064, 32.130105380382545, 57.362698158751286], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-1.0437545267793662, -453.30379173435233, -76.52580018072264, -180.92674860342228, -142.83794069911542, -313.15315720732093, -166.48484524158386, -237.40055502824188, -381.73958225024415, -121.90159385591362, -283.71438851578404, 95.19534741885538, -353.0438931343902, -222.07720386898256, -203.3819885608894, 108.0255420856582, 25.83643184611225, -126.86909116943599, -140.44809330929374, -253.33359240225855, -58.39597330556093, -405.0509948162384, -446.87105200355995, -6.645576990012679, -317.8100873442049, -458.26224989775136, -286.55466511858026, -209.92040675436866, -250.38624688246878, -300.2922818465675, -151.93917004765132, -393.454672190695, -406.35276022345425, -89.63079980451414, 188.57722351231098, -374.3679556692551, -331.60368669255854, -5.349184480145804, 32.96286235789844, -366.8742134204379, -179.94526157089933, -74.76002828861029, -98.88753919665024, 52.25328954547905, 62.961889341706716, 189.36574482574323, -371.9011462276756, -194.83470436741948, -9.908704201103546, -257.3411456354759, -449.9922208491999, 0.3214849827227357, 157.43, -362.3681839912107, -373.56394546030896, -244.33862438037505, -262.0374614283086, -70.19187335308489, 52.33151549602542, -433.00068074642206, -341.48208637520264, -329.18291500340115, -295.8653012242264, -158.703696531923, -297.22948167359635, -478.80173649588005, -240.77411546125157, -43.63015965820609, -184.8637542421979, -295.47304052990734, -219.38481963727693, -130.49614880438028, -398.6810918553188, -288.95908228634363, -56.619489787615784, -208.66960564644071, 111.32104071532433, -432.5647235339857, -222.82693257927727, 95.43416455680901, 34.36514532282587, -262.6561363806342, -415.86254622141, -237.30464952869087, -281.6073737909649, -468.70890523498593, -124.18394933367902, -64.63723273860666, 166.2161636102969, -90.49303232175687, 79.39840358045463, -459.08774891749493, -245.29409012066318, -348.6349632237197, -432.89834263085686, -640.1834061569069, -263.16067693212955, -276.7558030202313, -58.71978378720734, -390.4668736677979, -333.94369878454114, -74.51413757571595, -298.7362156037383, -383.5220910621132, -398.8048024491191, -156.46223637986128, -409.3512728593317, -308.0001252658316, 123.617548611334, -141.19606620928562, -213.00472572677637, -294.62481013385485, -141.8938383276579, -7.087940653756638, -150.56597638785684, -376.20731936825314, -3.867977497812916, -306.2154221929969, -493.6868329663108, 94.78622981675525, -278.42124240765946, -381.44386956138055, 47.348789002999, -510.1947939606271, -105.3142978724682, -155.2771435553536, 38.898315736878814, -353.7002788046719, -258.44223535507143, 28.46268470856632, -479.03419837933006, -181.6321043417126, 129.76307156810242, -238.1926253200464, -432.40830379968827, -338.0515968497722, 104.66940154920414, -229.59612747662908, -344.1867881769877, -37.89039219746397, -392.93456893529714, -231.66254480085615, -415.3270072983339, -28.24140468322231, 9.511466190384198, -243.0761947548709, 55.9467506416212, -120.61939681801944, 175.51989491515602, -378.48810123510026, -391.4943470590222, 38.47668541922137, -7.416256567291967, 68.7043982723352, -319.3641032870086, -335.18152257599104, -359.8958605825254, -432.4717289190819, -167.01807280940827, -159.2065091329014, -364.9144078963541, -188.3808612583558, -281.90862856301027, -371.42503445375485, -97.77560246113725, -265.1627343166713, -432.8599715808726, 21.487482051953307, -275.6819475479351, -116.56921308145706, -195.8750221243471, -194.12005536642806, -404.12156555233787, -401.7508247785303, -487.89696552053914, 103.80557996880515, -61.22037292252416, -354.58337986074787, -45.235907394388626, -130.5910383592991, -367.89138713494503, -103.05984780062616, -134.48575020998558, -71.52705152038337, -69.95585234366204, -446.8031600801655, -409.57282857497796, -335.14335108009016, -78.45943575178694, -217.03566620751985, -243.02245409910043, 85.01904442403644, -13.655488819940677, -387.2538408316654, 88.74565711163143, -408.6863407781499, -95.7610319617253, -329.2749611214535, -230.90962660518295, -124.29902421286337], "policy_predator_policy_reward": [3.0137545267793455, 458.30379173435233, 248.83250037019192, 112.70004841395253, 196.99982964255014, 362.19220582958195, 286.399038226654, 309.1021041945645, 397.8710171779287, 140.57331034457633, 284.3043885157842, 72.80465258114462, 353.3938931343899, 223.2872038689823, 84.15466832653439, 122.07177814869662, 55.59076731760618, 128.3390911694367, 140.79005932054253, 312.4716263910085, 135.24436120456704, 412.87460594049566, 53.10972047872267, 421.03110856336195, 318.4500873442043, 459.26224989775136, 318.82466511858, 211.1104067543681, 196.21990562927212, 468.06113647798475, 381.8094593101457, 159.1305833579222, 407.585180762125, 90.11837926584371, 0.8284266772122326, 374.77795566925494, 331.94368669255823, 0.0, 12.316366227031743, 396.1023753360863, 340.9089292898482, 50.545648459593316, 187.81933521777742, 19.769562195186698, 66.3981106582934, 1.7042551742567325, 381.1992086083236, 213.895814437039, 54.10870420110331, 258.0111456354753, 463.9922208491999, 1.6585150172772658, 254.84554487025, 119.0064137655269, 404.00564378243695, 278.0730199105813, 135.78517168930338, 282.4034232468704, 165.54700669314693, 415.486758478916, 386.2928294864896, 313.22308112974525, 361.94530122422634, 211.08369653192275, 305.709481673596, 492.8517364958801, 288.89963511931717, 158.6775120845812, 247.18891388738552, 345.6291600025275, 255.58469425025353, 169.21627419140293, 419.290141566489, 270.5383225790973, 7.206931580583212, 380.60820072750175, 300.2384837779523, 355.61581394729694, 232.45788238860862, 65.30730651000702, 83.10252552685077, 289.9049613485721, 304.4569777662779, 394.1211275327315, 339.67469799727985, 477.77890523498576, 239.27090074914122, 129.15153975235705, 16.833836389703126, 114.58303232175743, 467.70978484683, 0.0, 346.285586467217, 315.00273131571487, 432.0827731036003, 640.2909929198494, 281.680676932129, 277.8858030202303, 28.29239097484944, 392.22096520662257, 329.8212764861643, 190.16471426950264, 464.23900072332583, 300.50597778083386, 405.34661728347686, 233.30649285754595, 395.1753360162059, 376.80242472875324, 0.0, 229.62487019096037, 302.96251562194755, 216.72876300147044, 151.00712703167912, 64.28394795391304, 166.80319723221473, 367.68343982465194, 200.9307822933399, 141.18871935703905, 304.5407921039373, 253.40905681703993, 408.4388723652736, 247.57196069399646, 270.55151193515337, 451.79576419678443, 136.27900757220252, 211.0436625181732, 284.4810952224611, 204.081582468498, 273.2225055505745, 92.82731529143378, 386.0282337256954, 404.1852843997896, 313.773656436086, 0.0, 438.60603591094093, 336.4447253407207, 68.39059845079588, 230.40612747662854, 344.99678817698754, 144.29039219746414, 351.8237390841725, 337.0412740065412, 260.2911153905884, 368.75873724041145, 58.7562865250734, 291.48048404552947, 42.74163473227471, 192.4784413124688, 7.830522088303395, 379.865706083778, 351.349155754833, 166.2821129681496, 86.08298948306391, 41.89886881189308, 320.9641032870089, 355.18152257599104, 450.32791438231044, 346.9369750302352, 256.0023795679083, 151.96845775825824, 365.4444078963543, 273.3484382275615, 318.12862856301007, 383.67503445375485, 172.01122949873616, 296.6978058374087, 433.1099715808724, 67.13251794804657, 165.24088248475658, 346.034693360909, 176.01351651592228, 266.51147109662304, 431.42953488853874, 416.4482720031514, 440.5537174653039, 165.04762835922847, 384.8523278600332, 261.23043429632355, 310.9406687456361, 50.547935445221945, 333.4401029254894, 254.3295687876295, 135.98575020998487, 208.55705152038337, 393.69976003057, 317.5620164584763, 410.78282857497777, 335.6633510800897, 162.26816154669942, 296.5441563074097, 243.83245409909983, 37.420955575963625, 71.27747685095898, 443.19542451104485, 183.16505250966713, 297.2615715644573, 104.75113734210787, 352.4149611214535, 229.84308740153696, 182.72826157525955]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6490619883970454, "mean_inference_ms": 3.1324609785377775, "mean_action_processing_ms": 0.2519364899224896, "mean_env_wait_ms": 0.2175350872105385, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004855036735534668, "StateBufferConnector_ms": 0.00359344482421875, "ViewRequirementAgentConnector_ms": 0.10673832893371582}, "num_episodes": 18, "episode_return_max": 334.6106149065876, "episode_return_min": -28.673301273532758, "episode_return_mean": 101.00317566081867, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 208000, "num_agent_steps_trained": 208000, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 30.985246303680572, "num_env_steps_trained_throughput_per_sec": 30.985246303680572, "timesteps_total": 52000, "num_env_steps_sampled_lifetime": 52000, "num_agent_steps_sampled_lifetime": 208000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 208000, "timers": {"training_iteration_time_ms": 135451.436, "restore_workers_time_ms": 0.012, "training_step_time_ms": 135451.398, "sample_time_ms": 2072.386, "learn_time_ms": 133362.129, "learn_throughput": 29.994, "synch_weights_time_ms": 14.187}, "counters": {"num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 208000, "num_agent_steps_trained": 208000}, "done": false, "training_iteration": 13, "trial_id": "b941d_00000", "date": "2024-08-17_08-23-07", "timestamp": 1723863187, "time_this_iter_s": 129.13892078399658, "time_total_s": 1752.7829246520996, "pid": 81115, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[32, [4, 4], 2], [64, [3, 3], 2], [128, [3, 3], 1]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [256, 256], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b0495b80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1752.7829246520996, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 34.86393442622951, "ram_util_percent": 77.64480874316939}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 12.129762459558155, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.00010000000000000003, "total_loss": 8.725859980860715, "policy_loss": -0.07294173845873465, "vf_loss": 8.781505342009206, "vf_explained_var": 0.3394773177053563, "kl": 0.017082856506682693, "entropy": 1.3680391437792905, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 25515.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.047469849056668, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.00010000000000000003, "total_loss": 8.012321783247447, "policy_loss": -0.06223184216136812, "vf_loss": 8.0584231616328, "vf_explained_var": 0.06080325930206864, "kl": 0.015931324982818088, "entropy": 1.1254006895438704, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 25515.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 224000}, "env_runners": {"episode_reward_max": 379.21, "episode_reward_min": -35.923706161721825, "episode_reward_mean": 111.89718014902435, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -640.1834061569069, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 195.05, "predator_policy": 640.2909929198494}, "policy_reward_mean": {"prey_policy": -208.6628444487205, "predator_policy": 264.6114345232325}, "custom_metrics": {}, "hist_stats": {"episode_reward": [64.17609385233455, 85.95926015478094, 200.3645999216663, 28.850909237631335, 118.46000000000005, 22.530000000000065, 163.17287208444066, 112.481279117809, 74.92000000000017, 2.1882900039243376, 122.52603687402888, 334.6106149065876, 170.37242087614754, 144.71649581761454, 45.41090954890921, 67.13732420631494, 179.6012584292123, 207.13999999999942, 88.02043950978992, 67.35926443854936, -0.7079827643139769, 19.650000000000173, -28.673301273532758, 111.52815439541111, 82.48667183830845, 83.3860713120428, 54.626362619795756, 212.04635259300892, 12.061742762787553, 66.30929600417768, 7.713341300757039, 32.03610195956907, 159.04924577142177, -3.854278909769093, 259.5012711743096, 86.73122866255345, 173.7607146231665, 136.0702701955036, 129.54721540444217, 205.34410268414226, 4.5908606022015395, 173.8700000000003, 107.20999999999998, 64.26789935456043, 185.48144064944336, 116.6720420061177, 170.54742986834577, 184.72802185213772, 164.61360708318188, 189.27, 21.59999999999998, 4.897299910938856, 81.74625538385632, 85.49757696920568, 48.47, 105.7706985583373, 88.86999999999998, 119.02441521627367, 52.52991012177082, 42.0054165608224, 221.50996027279822, 230.27900937308462, 185.66165843717013, 116.81843677754745, 138.5300000000002, 194.50276406521863, 1.73, 163.31721589480202, 123.25000000000027, 113.56357171039856, 160.4859404076064, 32.130105380382545, 57.362698158751286, 40.41, 193.22638415410557, 279.8271335260544, 95.00399597216237, 0.5200000000000011, 98.96752875841177, 208.51317965860872, 213.9294018675742, 49.09000000000006, 8.62999999999997, 151.5852355108259, 221.9652822471393, 379.21, 84.46000000000008, 46.6029221301265, 82.10999999999999, 40.56001439842817, 128.5730909682503, 110.07384485568024, -35.923706161721825, 96.20940158810937, 162.74000000000004, 95.78793149564099, 194.9473852150328, 167.71871704249912, 137.6976156363731, 87.86777209065771], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-373.56394546030896, -244.33862438037505, -262.0374614283086, -70.19187335308489, 52.33151549602542, -433.00068074642206, -341.48208637520264, -329.18291500340115, -295.8653012242264, -158.703696531923, -297.22948167359635, -478.80173649588005, -240.77411546125157, -43.63015965820609, -184.8637542421979, -295.47304052990734, -219.38481963727693, -130.49614880438028, -398.6810918553188, -288.95908228634363, -56.619489787615784, -208.66960564644071, 111.32104071532433, -432.5647235339857, -222.82693257927727, 95.43416455680901, 34.36514532282587, -262.6561363806342, -415.86254622141, -237.30464952869087, -281.6073737909649, -468.70890523498593, -124.18394933367902, -64.63723273860666, 166.2161636102969, -90.49303232175687, 79.39840358045463, -459.08774891749493, -245.29409012066318, -348.6349632237197, -432.89834263085686, -640.1834061569069, -263.16067693212955, -276.7558030202313, -58.71978378720734, -390.4668736677979, -333.94369878454114, -74.51413757571595, -298.7362156037383, -383.5220910621132, -398.8048024491191, -156.46223637986128, -409.3512728593317, -308.0001252658316, 123.617548611334, -141.19606620928562, -213.00472572677637, -294.62481013385485, -141.8938383276579, -7.087940653756638, -150.56597638785684, -376.20731936825314, -3.867977497812916, -306.2154221929969, -493.6868329663108, 94.78622981675525, -278.42124240765946, -381.44386956138055, 47.348789002999, -510.1947939606271, -105.3142978724682, -155.2771435553536, 38.898315736878814, -353.7002788046719, -258.44223535507143, 28.46268470856632, -479.03419837933006, -181.6321043417126, 129.76307156810242, -238.1926253200464, -432.40830379968827, -338.0515968497722, 104.66940154920414, -229.59612747662908, -344.1867881769877, -37.89039219746397, -392.93456893529714, -231.66254480085615, -415.3270072983339, -28.24140468322231, 9.511466190384198, -243.0761947548709, 55.9467506416212, -120.61939681801944, 175.51989491515602, -378.48810123510026, -391.4943470590222, 38.47668541922137, -7.416256567291967, 68.7043982723352, -319.3641032870086, -335.18152257599104, -359.8958605825254, -432.4717289190819, -167.01807280940827, -159.2065091329014, -364.9144078963541, -188.3808612583558, -281.90862856301027, -371.42503445375485, -97.77560246113725, -265.1627343166713, -432.8599715808726, 21.487482051953307, -275.6819475479351, -116.56921308145706, -195.8750221243471, -194.12005536642806, -404.12156555233787, -401.7508247785303, -487.89696552053914, 103.80557996880515, -61.22037292252416, -354.58337986074787, -45.235907394388626, -130.5910383592991, -367.89138713494503, -103.05984780062616, -134.48575020998558, -71.52705152038337, -69.95585234366204, -446.8031600801655, -409.57282857497796, -335.14335108009016, -78.45943575178694, -217.03566620751985, -243.02245409910043, 85.01904442403644, -13.655488819940677, -387.2538408316654, 88.74565711163143, -408.6863407781499, -95.7610319617253, -329.2749611214535, -230.90962660518295, -124.29902421286337, -299.30958687295146, -413.48317862373614, -413.1557598756728, -267.8183937321784, -98.21001893606467, -7.192510916716929, -397.3890935241203, -230.309781208554, -418.45657217123426, -323.66186790230665, -55.64491836206621, -156.73241212337726, -549.219374082763, -2.413969388688031, -184.58709606546722, -70.8711399744646, -198.27840083522955, -330.3464249001444, -61.685244690215924, -509.62039288159315, 51.522555806854015, -384.14409045097284, 121.97868700487345, -440.64029942267325, 195.05, 184.16, -325.110828609366, -147.99066911677085, -298.8671669084017, -528.0463684065438, -89.31270061592616, -500.7179954964354, -286.4751762604412, -1.789010623014533, 3.7717483172604886, -258.90727136234045, -93.39130066532115, -456.0162261832818, -321.46091161721796, -247.01759494974323, -432.5867508986039, -9.739182028202563, -340.5219806264145, 162.38, -213.02465998633795, -215.98423436653863, -408.9464601455281, 0.09458419847495492, -392.60069201589107, 106.25081083484551, -108.97709096550379, -126.87149655297279, -87.04137420854805, -4.303019788400366], "policy_predator_policy_reward": [404.00564378243695, 278.0730199105813, 135.78517168930338, 282.4034232468704, 165.54700669314693, 415.486758478916, 386.2928294864896, 313.22308112974525, 361.94530122422634, 211.08369653192275, 305.709481673596, 492.8517364958801, 288.89963511931717, 158.6775120845812, 247.18891388738552, 345.6291600025275, 255.58469425025353, 169.21627419140293, 419.290141566489, 270.5383225790973, 7.206931580583212, 380.60820072750175, 300.2384837779523, 355.61581394729694, 232.45788238860862, 65.30730651000702, 83.10252552685077, 289.9049613485721, 304.4569777662779, 394.1211275327315, 339.67469799727985, 477.77890523498576, 239.27090074914122, 129.15153975235705, 16.833836389703126, 114.58303232175743, 467.70978484683, 0.0, 346.285586467217, 315.00273131571487, 432.0827731036003, 640.2909929198494, 281.680676932129, 277.8858030202303, 28.29239097484944, 392.22096520662257, 329.8212764861643, 190.16471426950264, 464.23900072332583, 300.50597778083386, 405.34661728347686, 233.30649285754595, 395.1753360162059, 376.80242472875324, 0.0, 229.62487019096037, 302.96251562194755, 216.72876300147044, 151.00712703167912, 64.28394795391304, 166.80319723221473, 367.68343982465194, 200.9307822933399, 141.18871935703905, 304.5407921039373, 253.40905681703993, 408.4388723652736, 247.57196069399646, 270.55151193515337, 451.79576419678443, 136.27900757220252, 211.0436625181732, 284.4810952224611, 204.081582468498, 273.2225055505745, 92.82731529143378, 386.0282337256954, 404.1852843997896, 313.773656436086, 0.0, 438.60603591094093, 336.4447253407207, 68.39059845079588, 230.40612747662854, 344.99678817698754, 144.29039219746414, 351.8237390841725, 337.0412740065412, 260.2911153905884, 368.75873724041145, 58.7562865250734, 291.48048404552947, 42.74163473227471, 192.4784413124688, 7.830522088303395, 379.865706083778, 351.349155754833, 166.2821129681496, 86.08298948306391, 41.89886881189308, 320.9641032870089, 355.18152257599104, 450.32791438231044, 346.9369750302352, 256.0023795679083, 151.96845775825824, 365.4444078963543, 273.3484382275615, 318.12862856301007, 383.67503445375485, 172.01122949873616, 296.6978058374087, 433.1099715808724, 67.13251794804657, 165.24088248475658, 346.034693360909, 176.01351651592228, 266.51147109662304, 431.42953488853874, 416.4482720031514, 440.5537174653039, 165.04762835922847, 384.8523278600332, 261.23043429632355, 310.9406687456361, 50.547935445221945, 333.4401029254894, 254.3295687876295, 135.98575020998487, 208.55705152038337, 393.69976003057, 317.5620164584763, 410.78282857497777, 335.6633510800897, 162.26816154669942, 296.5441563074097, 243.83245409909983, 37.420955575963625, 71.27747685095898, 443.19542451104485, 183.16505250966713, 297.2615715644573, 104.75113734210787, 352.4149611214535, 229.84308740153696, 182.72826157525955, 339.3095868729515, 413.89317862373616, 469.44454755369856, 404.7559902082568, 145.01640234797534, 240.21326103086048, 217.22997230621488, 505.47289839862185, 418.55657217123417, 324.08186790230627, 163.23025178321998, 148.1146074606345, 519.8919580811248, 240.25456504893518, 266.7883254064793, 202.5993125010262, 199.34840083522857, 378.3664249001444, 63.3152446902156, 516.620392881593, 99.64267970397187, 384.56409045097274, 385.14387478904206, 155.48301987589716, 0.0, 0.0, 325.54082860936563, 232.020669116771, 355.44466510135646, 518.0717923437156, 171.402700615926, 500.73799549643536, 29.819964494540482, 299.00423678734353, 123.85134265098971, 259.85727136233965, 317.34966615903807, 342.1317055452459, 341.06248828396804, 191.49231212127086, 432.65675089860383, 105.87858361631217, 340.88198062641465, 0.0, 369.02802999801315, 155.76879585050358, 396.9647251695696, 206.8345359925166, 92.51653729087496, 361.55206093266986, 72.6510445705015, 300.89515858434874, 54.3363704004777, 124.87579568712829]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6468895334779217, "mean_inference_ms": 3.1160135531327495, "mean_action_processing_ms": 0.2509464500992466, "mean_env_wait_ms": 0.21644703435780768, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004723191261291504, "StateBufferConnector_ms": 0.003508925437927246, "ViewRequirementAgentConnector_ms": 0.10375595092773438}, "num_episodes": 27, "episode_return_max": 379.21, "episode_return_min": -35.923706161721825, "episode_return_mean": 111.89718014902435, "episodes_this_iter": 27}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 224000, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 7.890781829334774, "num_env_steps_trained_throughput_per_sec": 7.890781829334774, "timesteps_total": 56000, "num_env_steps_sampled_lifetime": 56000, "num_agent_steps_sampled_lifetime": 224000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 224000, "timers": {"training_iteration_time_ms": 172633.461, "restore_workers_time_ms": 0.012, "training_step_time_ms": 172633.424, "sample_time_ms": 2059.329, "learn_time_ms": 170557.571, "learn_throughput": 23.452, "synch_weights_time_ms": 14.385}, "counters": {"num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 224000}, "done": false, "training_iteration": 14, "trial_id": "b941d_00000", "date": "2024-08-17_08-31-34", "timestamp": 1723863694, "time_this_iter_s": 506.9429929256439, "time_total_s": 2259.7259175777435, "pid": 81115, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[32, [4, 4], 2], [64, [3, 3], 2], [128, [3, 3], 1]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [256, 256], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b04b4dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2259.7259175777435, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 26.154418604651166, "ram_util_percent": 77.6553488372093}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.595758603868031, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.00010000000000000003, "total_loss": 8.919267630198645, "policy_loss": -0.07994498474666327, "vf_loss": 8.981742943910064, "vf_explained_var": 0.3817932307404816, "kl": 0.017253998387119888, "entropy": 1.3576393686905108, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 27405.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.305058051290966, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.00010000000000000003, "total_loss": 7.770166213424117, "policy_loss": -0.0618859277180736, "vf_loss": 7.816069101151966, "vf_explained_var": 0.09800027612025144, "kl": 0.01578571681700928, "entropy": 1.1127623085307066, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 27405.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000}, "env_runners": {"episode_reward_max": 379.21, "episode_reward_min": -35.923706161721825, "episode_reward_mean": 122.76313115030769, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -640.1834061569069, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 195.05, "predator_policy": 640.2909929198494}, "policy_reward_mean": {"prey_policy": -199.41663235768326, "predator_policy": 260.798197932837}, "custom_metrics": {}, "hist_stats": {"episode_reward": [88.02043950978992, 67.35926443854936, -0.7079827643139769, 19.650000000000173, -28.673301273532758, 111.52815439541111, 82.48667183830845, 83.3860713120428, 54.626362619795756, 212.04635259300892, 12.061742762787553, 66.30929600417768, 7.713341300757039, 32.03610195956907, 159.04924577142177, -3.854278909769093, 259.5012711743096, 86.73122866255345, 173.7607146231665, 136.0702701955036, 129.54721540444217, 205.34410268414226, 4.5908606022015395, 173.8700000000003, 107.20999999999998, 64.26789935456043, 185.48144064944336, 116.6720420061177, 170.54742986834577, 184.72802185213772, 164.61360708318188, 189.27, 21.59999999999998, 4.897299910938856, 81.74625538385632, 85.49757696920568, 48.47, 105.7706985583373, 88.86999999999998, 119.02441521627367, 52.52991012177082, 42.0054165608224, 221.50996027279822, 230.27900937308462, 185.66165843717013, 116.81843677754745, 138.5300000000002, 194.50276406521863, 1.73, 163.31721589480202, 123.25000000000027, 113.56357171039856, 160.4859404076064, 32.130105380382545, 57.362698158751286, 40.41, 193.22638415410557, 279.8271335260544, 95.00399597216237, 0.5200000000000011, 98.96752875841177, 208.51317965860872, 213.9294018675742, 49.09000000000006, 8.62999999999997, 151.5852355108259, 221.9652822471393, 379.21, 84.46000000000008, 46.6029221301265, 82.10999999999999, 40.56001439842817, 128.5730909682503, 110.07384485568024, -35.923706161721825, 96.20940158810937, 162.74000000000004, 95.78793149564099, 194.9473852150328, 167.71871704249912, 137.6976156363731, 87.86777209065771, 163.25705946255087, 259.51000000000005, 158.47636360285023, 156.35999999999987, 185.61994849951506, 195.85708314994045, 301.4999107965619, 321.14145590205436, 255.27616074104841, 182.9444805137364, 163.7912164861561, 69.97863288080046, 221.00869107983598, 80.53000000000007, 230.84986922293504, 177.07999999999996, 17.533181640145962, 90.49941118160326], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [79.39840358045463, -459.08774891749493, -245.29409012066318, -348.6349632237197, -432.89834263085686, -640.1834061569069, -263.16067693212955, -276.7558030202313, -58.71978378720734, -390.4668736677979, -333.94369878454114, -74.51413757571595, -298.7362156037383, -383.5220910621132, -398.8048024491191, -156.46223637986128, -409.3512728593317, -308.0001252658316, 123.617548611334, -141.19606620928562, -213.00472572677637, -294.62481013385485, -141.8938383276579, -7.087940653756638, -150.56597638785684, -376.20731936825314, -3.867977497812916, -306.2154221929969, -493.6868329663108, 94.78622981675525, -278.42124240765946, -381.44386956138055, 47.348789002999, -510.1947939606271, -105.3142978724682, -155.2771435553536, 38.898315736878814, -353.7002788046719, -258.44223535507143, 28.46268470856632, -479.03419837933006, -181.6321043417126, 129.76307156810242, -238.1926253200464, -432.40830379968827, -338.0515968497722, 104.66940154920414, -229.59612747662908, -344.1867881769877, -37.89039219746397, -392.93456893529714, -231.66254480085615, -415.3270072983339, -28.24140468322231, 9.511466190384198, -243.0761947548709, 55.9467506416212, -120.61939681801944, 175.51989491515602, -378.48810123510026, -391.4943470590222, 38.47668541922137, -7.416256567291967, 68.7043982723352, -319.3641032870086, -335.18152257599104, -359.8958605825254, -432.4717289190819, -167.01807280940827, -159.2065091329014, -364.9144078963541, -188.3808612583558, -281.90862856301027, -371.42503445375485, -97.77560246113725, -265.1627343166713, -432.8599715808726, 21.487482051953307, -275.6819475479351, -116.56921308145706, -195.8750221243471, -194.12005536642806, -404.12156555233787, -401.7508247785303, -487.89696552053914, 103.80557996880515, -61.22037292252416, -354.58337986074787, -45.235907394388626, -130.5910383592991, -367.89138713494503, -103.05984780062616, -134.48575020998558, -71.52705152038337, -69.95585234366204, -446.8031600801655, -409.57282857497796, -335.14335108009016, -78.45943575178694, -217.03566620751985, -243.02245409910043, 85.01904442403644, -13.655488819940677, -387.2538408316654, 88.74565711163143, -408.6863407781499, -95.7610319617253, -329.2749611214535, -230.90962660518295, -124.29902421286337, -299.30958687295146, -413.48317862373614, -413.1557598756728, -267.8183937321784, -98.21001893606467, -7.192510916716929, -397.3890935241203, -230.309781208554, -418.45657217123426, -323.66186790230665, -55.64491836206621, -156.73241212337726, -549.219374082763, -2.413969388688031, -184.58709606546722, -70.8711399744646, -198.27840083522955, -330.3464249001444, -61.685244690215924, -509.62039288159315, 51.522555806854015, -384.14409045097284, 121.97868700487345, -440.64029942267325, 195.05, 184.16, -325.110828609366, -147.99066911677085, -298.8671669084017, -528.0463684065438, -89.31270061592616, -500.7179954964354, -286.4751762604412, -1.789010623014533, 3.7717483172604886, -258.90727136234045, -93.39130066532115, -456.0162261832818, -321.46091161721796, -247.01759494974323, -432.5867508986039, -9.739182028202563, -340.5219806264145, 162.38, -213.02465998633795, -215.98423436653863, -408.9464601455281, 0.09458419847495492, -392.60069201589107, 106.25081083484551, -108.97709096550379, -126.87149655297279, -87.04137420854805, -4.303019788400366, -417.56009681640865, 128.0093324871564, 96.12120629241873, 38.030234512139785, -159.12106424012677, -49.295255971607105, -369.94747159285464, 96.7605379314405, -231.22571833936146, -168.46649419753345, -35.68827520468866, -109.56579567446485, 123.75874529616732, -361.4611184468724, 191.09, -440.7961213936899, -169.05405540616414, -43.32615280883468, 0.8710541420272865, -413.398601293468, -16.088720118035912, -276.2905651271645, -379.8582381083874, -390.0450774765477, -215.64911797386583, -104.94088799886633, -124.47964844434225, -313.70922134928264, -72.37168830182547, -83.63728511571307, -403.87526801192456, 140.19082201732164, -324.2352939128911, -417.4802375844869, -262.8217987795169, -104.32680732667934], "policy_predator_policy_reward": [467.70978484683, 0.0, 346.285586467217, 315.00273131571487, 432.0827731036003, 640.2909929198494, 281.680676932129, 277.8858030202303, 28.29239097484944, 392.22096520662257, 329.8212764861643, 190.16471426950264, 464.23900072332583, 300.50597778083386, 405.34661728347686, 233.30649285754595, 395.1753360162059, 376.80242472875324, 0.0, 229.62487019096037, 302.96251562194755, 216.72876300147044, 151.00712703167912, 64.28394795391304, 166.80319723221473, 367.68343982465194, 200.9307822933399, 141.18871935703905, 304.5407921039373, 253.40905681703993, 408.4388723652736, 247.57196069399646, 270.55151193515337, 451.79576419678443, 136.27900757220252, 211.0436625181732, 284.4810952224611, 204.081582468498, 273.2225055505745, 92.82731529143378, 386.0282337256954, 404.1852843997896, 313.773656436086, 0.0, 438.60603591094093, 336.4447253407207, 68.39059845079588, 230.40612747662854, 344.99678817698754, 144.29039219746414, 351.8237390841725, 337.0412740065412, 260.2911153905884, 368.75873724041145, 58.7562865250734, 291.48048404552947, 42.74163473227471, 192.4784413124688, 7.830522088303395, 379.865706083778, 351.349155754833, 166.2821129681496, 86.08298948306391, 41.89886881189308, 320.9641032870089, 355.18152257599104, 450.32791438231044, 346.9369750302352, 256.0023795679083, 151.96845775825824, 365.4444078963543, 273.3484382275615, 318.12862856301007, 383.67503445375485, 172.01122949873616, 296.6978058374087, 433.1099715808724, 67.13251794804657, 165.24088248475658, 346.034693360909, 176.01351651592228, 266.51147109662304, 431.42953488853874, 416.4482720031514, 440.5537174653039, 165.04762835922847, 384.8523278600332, 261.23043429632355, 310.9406687456361, 50.547935445221945, 333.4401029254894, 254.3295687876295, 135.98575020998487, 208.55705152038337, 393.69976003057, 317.5620164584763, 410.78282857497777, 335.6633510800897, 162.26816154669942, 296.5441563074097, 243.83245409909983, 37.420955575963625, 71.27747685095898, 443.19542451104485, 183.16505250966713, 297.2615715644573, 104.75113734210787, 352.4149611214535, 229.84308740153696, 182.72826157525955, 339.3095868729515, 413.89317862373616, 469.44454755369856, 404.7559902082568, 145.01640234797534, 240.21326103086048, 217.22997230621488, 505.47289839862185, 418.55657217123417, 324.08186790230627, 163.23025178321998, 148.1146074606345, 519.8919580811248, 240.25456504893518, 266.7883254064793, 202.5993125010262, 199.34840083522857, 378.3664249001444, 63.3152446902156, 516.620392881593, 99.64267970397187, 384.56409045097274, 385.14387478904206, 155.48301987589716, 0.0, 0.0, 325.54082860936563, 232.020669116771, 355.44466510135646, 518.0717923437156, 171.402700615926, 500.73799549643536, 29.819964494540482, 299.00423678734353, 123.85134265098971, 259.85727136233965, 317.34966615903807, 342.1317055452459, 341.06248828396804, 191.49231212127086, 432.65675089860383, 105.87858361631217, 340.88198062641465, 0.0, 369.02802999801315, 155.76879585050358, 396.9647251695696, 206.8345359925166, 92.51653729087496, 361.55206093266986, 72.6510445705015, 300.89515858434874, 54.3363704004777, 124.87579568712829, 417.81771939482553, 34.990104396977635, 8.963731681439409, 116.39482751400215, 232.7255624809031, 134.16712133368108, 370.3074715928544, 59.23946206855949, 276.622050049277, 308.69011098713304, 101.08885972318498, 240.02229430590913, 237.90431872175233, 301.2979652255146, 173.87322657214614, 396.9743507235983, 396.0818573942645, 71.57451156178328, 259.38129010172105, 336.0907375634571, 418.1460356569006, 38.0244660744559, 444.38399393114224, 395.4979545345926, 225.07861787782434, 316.52007917474407, 204.5196484443422, 314.1992213492824, 248.91020493717872, 137.94863770329496, 403.9352680119245, 36.82917798267835, 360.35624618049627, 398.8924669570272, 396.2355316514995, 61.41248563629967]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6435087094723977, "mean_inference_ms": 3.1185228926313457, "mean_action_processing_ms": 0.2501974093420184, "mean_env_wait_ms": 0.21596176482933457, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0044318437576293945, "StateBufferConnector_ms": 0.003217458724975586, "ViewRequirementAgentConnector_ms": 0.09906435012817383}, "num_episodes": 18, "episode_return_max": 379.21, "episode_return_min": -35.923706161721825, "episode_return_mean": 122.76313115030769, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 30.55555509012423, "num_env_steps_trained_throughput_per_sec": 30.55555509012423, "timesteps_total": 60000, "num_env_steps_sampled_lifetime": 60000, "num_agent_steps_sampled_lifetime": 240000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 240000, "timers": {"training_iteration_time_ms": 172634.239, "restore_workers_time_ms": 0.012, "training_step_time_ms": 172634.202, "sample_time_ms": 2030.046, "learn_time_ms": 170587.793, "learn_throughput": 23.448, "synch_weights_time_ms": 14.356}, "counters": {"num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000}, "done": false, "training_iteration": 15, "trial_id": "b941d_00000", "date": "2024-08-17_08-33-45", "timestamp": 1723863825, "time_this_iter_s": 130.91374897956848, "time_total_s": 2390.639666557312, "pid": 81115, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[32, [4, 4], 2], [64, [3, 3], 2], [128, [3, 3], 1]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [256, 256], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b04a98b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2390.639666557312, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 19.21989247311828, "ram_util_percent": 75.81935483870967}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 19.089894603926037, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.00010000000000000003, "total_loss": 8.611638716793564, "policy_loss": -0.0693159292254932, "vf_loss": 8.665960696639207, "vf_explained_var": 0.3975570846486975, "kl": 0.014808831728842243, "entropy": 1.3404577781283666, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 29295.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.078278335187801, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.00010000000000000003, "total_loss": 6.660595993011717, "policy_loss": -0.055481715203341705, "vf_loss": 6.701264726043378, "vf_explained_var": 0.10043636960958047, "kl": 0.014630119651684355, "entropy": 1.1310170001138455, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 29295.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 256000, "num_agent_steps_trained": 256000}, "env_runners": {"episode_reward_max": 379.21, "episode_reward_min": -35.923706161721825, "episode_reward_mean": 139.08963331783207, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -579.7529990769456, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 197.03, "predator_policy": 567.0435631205854}, "policy_reward_mean": {"prey_policy": -182.88829221823116, "predator_policy": 252.43310887714702}, "custom_metrics": {}, "hist_stats": {"episode_reward": [173.7607146231665, 136.0702701955036, 129.54721540444217, 205.34410268414226, 4.5908606022015395, 173.8700000000003, 107.20999999999998, 64.26789935456043, 185.48144064944336, 116.6720420061177, 170.54742986834577, 184.72802185213772, 164.61360708318188, 189.27, 21.59999999999998, 4.897299910938856, 81.74625538385632, 85.49757696920568, 48.47, 105.7706985583373, 88.86999999999998, 119.02441521627367, 52.52991012177082, 42.0054165608224, 221.50996027279822, 230.27900937308462, 185.66165843717013, 116.81843677754745, 138.5300000000002, 194.50276406521863, 1.73, 163.31721589480202, 123.25000000000027, 113.56357171039856, 160.4859404076064, 32.130105380382545, 57.362698158751286, 40.41, 193.22638415410557, 279.8271335260544, 95.00399597216237, 0.5200000000000011, 98.96752875841177, 208.51317965860872, 213.9294018675742, 49.09000000000006, 8.62999999999997, 151.5852355108259, 221.9652822471393, 379.21, 84.46000000000008, 46.6029221301265, 82.10999999999999, 40.56001439842817, 128.5730909682503, 110.07384485568024, -35.923706161721825, 96.20940158810937, 162.74000000000004, 95.78793149564099, 194.9473852150328, 167.71871704249912, 137.6976156363731, 87.86777209065771, 163.25705946255087, 259.51000000000005, 158.47636360285023, 156.35999999999987, 185.61994849951506, 195.85708314994045, 301.4999107965619, 321.14145590205436, 255.27616074104841, 182.9444805137364, 163.7912164861561, 69.97863288080046, 221.00869107983598, 80.53000000000007, 230.84986922293504, 177.07999999999996, 17.533181640145962, 90.49941118160326, 114.95000000000022, 231.57639566745115, 278.6158689281593, 52.54574022396337, 237.0, 182.85013645742208, 136.30229030560875, 293.7938174204479, 211.1208147570671, 255.83519412474666, 54.5498893636383, 65.49482316366493, 1.0799999999999987, 204.11999999999995, 74.06057204467604, 139.07679267010332, 130.41102763354087, 278.536835386815], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [38.898315736878814, -353.7002788046719, -258.44223535507143, 28.46268470856632, -479.03419837933006, -181.6321043417126, 129.76307156810242, -238.1926253200464, -432.40830379968827, -338.0515968497722, 104.66940154920414, -229.59612747662908, -344.1867881769877, -37.89039219746397, -392.93456893529714, -231.66254480085615, -415.3270072983339, -28.24140468322231, 9.511466190384198, -243.0761947548709, 55.9467506416212, -120.61939681801944, 175.51989491515602, -378.48810123510026, -391.4943470590222, 38.47668541922137, -7.416256567291967, 68.7043982723352, -319.3641032870086, -335.18152257599104, -359.8958605825254, -432.4717289190819, -167.01807280940827, -159.2065091329014, -364.9144078963541, -188.3808612583558, -281.90862856301027, -371.42503445375485, -97.77560246113725, -265.1627343166713, -432.8599715808726, 21.487482051953307, -275.6819475479351, -116.56921308145706, -195.8750221243471, -194.12005536642806, -404.12156555233787, -401.7508247785303, -487.89696552053914, 103.80557996880515, -61.22037292252416, -354.58337986074787, -45.235907394388626, -130.5910383592991, -367.89138713494503, -103.05984780062616, -134.48575020998558, -71.52705152038337, -69.95585234366204, -446.8031600801655, -409.57282857497796, -335.14335108009016, -78.45943575178694, -217.03566620751985, -243.02245409910043, 85.01904442403644, -13.655488819940677, -387.2538408316654, 88.74565711163143, -408.6863407781499, -95.7610319617253, -329.2749611214535, -230.90962660518295, -124.29902421286337, -299.30958687295146, -413.48317862373614, -413.1557598756728, -267.8183937321784, -98.21001893606467, -7.192510916716929, -397.3890935241203, -230.309781208554, -418.45657217123426, -323.66186790230665, -55.64491836206621, -156.73241212337726, -549.219374082763, -2.413969388688031, -184.58709606546722, -70.8711399744646, -198.27840083522955, -330.3464249001444, -61.685244690215924, -509.62039288159315, 51.522555806854015, -384.14409045097284, 121.97868700487345, -440.64029942267325, 195.05, 184.16, -325.110828609366, -147.99066911677085, -298.8671669084017, -528.0463684065438, -89.31270061592616, -500.7179954964354, -286.4751762604412, -1.789010623014533, 3.7717483172604886, -258.90727136234045, -93.39130066532115, -456.0162261832818, -321.46091161721796, -247.01759494974323, -432.5867508986039, -9.739182028202563, -340.5219806264145, 162.38, -213.02465998633795, -215.98423436653863, -408.9464601455281, 0.09458419847495492, -392.60069201589107, 106.25081083484551, -108.97709096550379, -126.87149655297279, -87.04137420854805, -4.303019788400366, -417.56009681640865, 128.0093324871564, 96.12120629241873, 38.030234512139785, -159.12106424012677, -49.295255971607105, -369.94747159285464, 96.7605379314405, -231.22571833936146, -168.46649419753345, -35.68827520468866, -109.56579567446485, 123.75874529616732, -361.4611184468724, 191.09, -440.7961213936899, -169.05405540616414, -43.32615280883468, 0.8710541420272865, -413.398601293468, -16.088720118035912, -276.2905651271645, -379.8582381083874, -390.0450774765477, -215.64911797386583, -104.94088799886633, -124.47964844434225, -313.70922134928264, -72.37168830182547, -83.63728511571307, -403.87526801192456, 140.19082201732164, -324.2352939128911, -417.4802375844869, -262.8217987795169, -104.32680732667934, -230.63280744170453, 112.10882802289453, 18.81047500040187, -46.34375604450078, 135.4991053281652, -49.78886399195534, -343.65221559899186, -277.5637863179238, 116.07871764827496, -212.2232999874487, -307.6962270746995, -196.05213528811274, -91.92257054635982, -389.57216965404933, 28.83844857669837, 98.2933399487638, 107.68814889970196, -406.69915647403616, 181.21105209595368, -486.4268834652765, -182.2639382416677, -381.486728369708, -579.7529990769456, -129.94997144233224, -512.3257470046922, -187.00283077181663, -378.79150447923956, 197.03, -172.16472719871885, -557.9240017867073, 15.991691800440528, -286.58525121930643, 1.114900674905049, -34.1268164557502, -97.22585982474646, 138.79001340315395], "policy_predator_policy_reward": [284.4810952224611, 204.081582468498, 273.2225055505745, 92.82731529143378, 386.0282337256954, 404.1852843997896, 313.773656436086, 0.0, 438.60603591094093, 336.4447253407207, 68.39059845079588, 230.40612747662854, 344.99678817698754, 144.29039219746414, 351.8237390841725, 337.0412740065412, 260.2911153905884, 368.75873724041145, 58.7562865250734, 291.48048404552947, 42.74163473227471, 192.4784413124688, 7.830522088303395, 379.865706083778, 351.349155754833, 166.2821129681496, 86.08298948306391, 41.89886881189308, 320.9641032870089, 355.18152257599104, 450.32791438231044, 346.9369750302352, 256.0023795679083, 151.96845775825824, 365.4444078963543, 273.3484382275615, 318.12862856301007, 383.67503445375485, 172.01122949873616, 296.6978058374087, 433.1099715808724, 67.13251794804657, 165.24088248475658, 346.034693360909, 176.01351651592228, 266.51147109662304, 431.42953488853874, 416.4482720031514, 440.5537174653039, 165.04762835922847, 384.8523278600332, 261.23043429632355, 310.9406687456361, 50.547935445221945, 333.4401029254894, 254.3295687876295, 135.98575020998487, 208.55705152038337, 393.69976003057, 317.5620164584763, 410.78282857497777, 335.6633510800897, 162.26816154669942, 296.5441563074097, 243.83245409909983, 37.420955575963625, 71.27747685095898, 443.19542451104485, 183.16505250966713, 297.2615715644573, 104.75113734210787, 352.4149611214535, 229.84308740153696, 182.72826157525955, 339.3095868729515, 413.89317862373616, 469.44454755369856, 404.7559902082568, 145.01640234797534, 240.21326103086048, 217.22997230621488, 505.47289839862185, 418.55657217123417, 324.08186790230627, 163.23025178321998, 148.1146074606345, 519.8919580811248, 240.25456504893518, 266.7883254064793, 202.5993125010262, 199.34840083522857, 378.3664249001444, 63.3152446902156, 516.620392881593, 99.64267970397187, 384.56409045097274, 385.14387478904206, 155.48301987589716, 0.0, 0.0, 325.54082860936563, 232.020669116771, 355.44466510135646, 518.0717923437156, 171.402700615926, 500.73799549643536, 29.819964494540482, 299.00423678734353, 123.85134265098971, 259.85727136233965, 317.34966615903807, 342.1317055452459, 341.06248828396804, 191.49231212127086, 432.65675089860383, 105.87858361631217, 340.88198062641465, 0.0, 369.02802999801315, 155.76879585050358, 396.9647251695696, 206.8345359925166, 92.51653729087496, 361.55206093266986, 72.6510445705015, 300.89515858434874, 54.3363704004777, 124.87579568712829, 417.81771939482553, 34.990104396977635, 8.963731681439409, 116.39482751400215, 232.7255624809031, 134.16712133368108, 370.3074715928544, 59.23946206855949, 276.622050049277, 308.69011098713304, 101.08885972318498, 240.02229430590913, 237.90431872175233, 301.2979652255146, 173.87322657214614, 396.9743507235983, 396.0818573942645, 71.57451156178328, 259.38129010172105, 336.0907375634571, 418.1460356569006, 38.0244660744559, 444.38399393114224, 395.4979545345926, 225.07861787782434, 316.52007917474407, 204.5196484443422, 314.1992213492824, 248.91020493717872, 137.94863770329496, 403.9352680119245, 36.82917798267835, 360.35624618049627, 398.8924669570272, 396.2355316514995, 61.41248563629967, 231.73280744170353, 1.7411719771054686, 55.44551511337068, 203.66416159817925, 36.03315542061463, 156.87247217133472, 291.8241306353191, 381.9376115055597, 49.92128235172503, 283.22329998744874, 428.94315034528273, 257.655348474952, 220.84655252530325, 396.9504779807147, 70.64020098613051, 96.02182790885504, 351.79197916222125, 158.33984316918, 105.68291714547044, 455.36810834859864, 282.2360192653861, 336.0645367096271, 208.1542305623559, 567.0435631205854, 512.3357470046922, 188.07283077181566, 385.8815044792395, 0.0, 523.4732757148118, 280.6760253152892, 101.3806613678659, 308.2896907211032, 40.12779338443262, 123.29515002995309, 37.2849833565102, 199.68769845189735]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6411644760345286, "mean_inference_ms": 3.1117645454006166, "mean_action_processing_ms": 0.24952857659903344, "mean_env_wait_ms": 0.21533993929230366, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004521727561950684, "StateBufferConnector_ms": 0.0032377243041992188, "ViewRequirementAgentConnector_ms": 0.1001591682434082}, "num_episodes": 18, "episode_return_max": 379.21, "episode_return_min": -35.923706161721825, "episode_return_mean": 139.08963331783207, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 256000, "num_agent_steps_trained": 256000, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 30.855205253283664, "num_env_steps_trained_throughput_per_sec": 30.855205253283664, "timesteps_total": 64000, "num_env_steps_sampled_lifetime": 64000, "num_agent_steps_sampled_lifetime": 256000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 256000, "timers": {"training_iteration_time_ms": 172586.138, "restore_workers_time_ms": 0.012, "training_step_time_ms": 172586.101, "sample_time_ms": 2029.255, "learn_time_ms": 170540.322, "learn_throughput": 23.455, "synch_weights_time_ms": 14.564}, "counters": {"num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 256000, "num_agent_steps_trained": 256000}, "done": false, "training_iteration": 16, "trial_id": "b941d_00000", "date": "2024-08-17_08-35-55", "timestamp": 1723863955, "time_this_iter_s": 129.65018606185913, "time_total_s": 2520.289852619171, "pid": 81115, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[32, [4, 4], 2], [64, [3, 3], 2], [128, [3, 3], 1]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [256, 256], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b0403820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2520.289852619171, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 20.34891304347826, "ram_util_percent": 75.83913043478262}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 20.415348624300073, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.00010000000000000003, "total_loss": 9.187144515627907, "policy_loss": -0.0670395189359114, "vf_loss": 9.2387697492327, "vf_explained_var": 0.38730613661821556, "kl": 0.015223968523275323, "entropy": 1.336689717807467, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 31185.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.108139269818705, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.00010000000000000003, "total_loss": 6.750506417208879, "policy_loss": -0.05238033045125169, "vf_loss": 6.78736374491737, "vf_explained_var": 0.09959309974675457, "kl": 0.01533135741832729, "entropy": 1.104404272824999, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 31185.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 272000, "num_agent_steps_trained": 272000}, "env_runners": {"episode_reward_max": 379.21, "episode_reward_min": -35.923706161721825, "episode_reward_mean": 149.65959083585133, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -579.7529990769456, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 197.03, "predator_policy": 567.0435631205854}, "policy_reward_mean": {"prey_policy": -172.3469363538057, "predator_policy": 247.1767317717312}, "custom_metrics": {}, "hist_stats": {"episode_reward": [48.47, 105.7706985583373, 88.86999999999998, 119.02441521627367, 52.52991012177082, 42.0054165608224, 221.50996027279822, 230.27900937308462, 185.66165843717013, 116.81843677754745, 138.5300000000002, 194.50276406521863, 1.73, 163.31721589480202, 123.25000000000027, 113.56357171039856, 160.4859404076064, 32.130105380382545, 57.362698158751286, 40.41, 193.22638415410557, 279.8271335260544, 95.00399597216237, 0.5200000000000011, 98.96752875841177, 208.51317965860872, 213.9294018675742, 49.09000000000006, 8.62999999999997, 151.5852355108259, 221.9652822471393, 379.21, 84.46000000000008, 46.6029221301265, 82.10999999999999, 40.56001439842817, 128.5730909682503, 110.07384485568024, -35.923706161721825, 96.20940158810937, 162.74000000000004, 95.78793149564099, 194.9473852150328, 167.71871704249912, 137.6976156363731, 87.86777209065771, 163.25705946255087, 259.51000000000005, 158.47636360285023, 156.35999999999987, 185.61994849951506, 195.85708314994045, 301.4999107965619, 321.14145590205436, 255.27616074104841, 182.9444805137364, 163.7912164861561, 69.97863288080046, 221.00869107983598, 80.53000000000007, 230.84986922293504, 177.07999999999996, 17.533181640145962, 90.49941118160326, 114.95000000000022, 231.57639566745115, 278.6158689281593, 52.54574022396337, 237.0, 182.85013645742208, 136.30229030560875, 293.7938174204479, 211.1208147570671, 255.83519412474666, 54.5498893636383, 65.49482316366493, 1.0799999999999987, 204.11999999999995, 74.06057204467604, 139.07679267010332, 130.41102763354087, 278.536835386815, 178.2384071931324, 175.48855546917068, 96.51023594519467, 246.13084274918444, 124.76999999999992, 221.33640194961475, 121.6479388168257, 240.03442384664783, 76.65331922812537, 377.08, 343.70697500758615, 186.0322412108238, 9.639999999999969, 198.3875721036669, 90.00792601709931, 194.00000000000017, 237.76646608941914, 139.2791827626784], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-281.90862856301027, -371.42503445375485, -97.77560246113725, -265.1627343166713, -432.8599715808726, 21.487482051953307, -275.6819475479351, -116.56921308145706, -195.8750221243471, -194.12005536642806, -404.12156555233787, -401.7508247785303, -487.89696552053914, 103.80557996880515, -61.22037292252416, -354.58337986074787, -45.235907394388626, -130.5910383592991, -367.89138713494503, -103.05984780062616, -134.48575020998558, -71.52705152038337, -69.95585234366204, -446.8031600801655, -409.57282857497796, -335.14335108009016, -78.45943575178694, -217.03566620751985, -243.02245409910043, 85.01904442403644, -13.655488819940677, -387.2538408316654, 88.74565711163143, -408.6863407781499, -95.7610319617253, -329.2749611214535, -230.90962660518295, -124.29902421286337, -299.30958687295146, -413.48317862373614, -413.1557598756728, -267.8183937321784, -98.21001893606467, -7.192510916716929, -397.3890935241203, -230.309781208554, -418.45657217123426, -323.66186790230665, -55.64491836206621, -156.73241212337726, -549.219374082763, -2.413969388688031, -184.58709606546722, -70.8711399744646, -198.27840083522955, -330.3464249001444, -61.685244690215924, -509.62039288159315, 51.522555806854015, -384.14409045097284, 121.97868700487345, -440.64029942267325, 195.05, 184.16, -325.110828609366, -147.99066911677085, -298.8671669084017, -528.0463684065438, -89.31270061592616, -500.7179954964354, -286.4751762604412, -1.789010623014533, 3.7717483172604886, -258.90727136234045, -93.39130066532115, -456.0162261832818, -321.46091161721796, -247.01759494974323, -432.5867508986039, -9.739182028202563, -340.5219806264145, 162.38, -213.02465998633795, -215.98423436653863, -408.9464601455281, 0.09458419847495492, -392.60069201589107, 106.25081083484551, -108.97709096550379, -126.87149655297279, -87.04137420854805, -4.303019788400366, -417.56009681640865, 128.0093324871564, 96.12120629241873, 38.030234512139785, -159.12106424012677, -49.295255971607105, -369.94747159285464, 96.7605379314405, -231.22571833936146, -168.46649419753345, -35.68827520468866, -109.56579567446485, 123.75874529616732, -361.4611184468724, 191.09, -440.7961213936899, -169.05405540616414, -43.32615280883468, 0.8710541420272865, -413.398601293468, -16.088720118035912, -276.2905651271645, -379.8582381083874, -390.0450774765477, -215.64911797386583, -104.94088799886633, -124.47964844434225, -313.70922134928264, -72.37168830182547, -83.63728511571307, -403.87526801192456, 140.19082201732164, -324.2352939128911, -417.4802375844869, -262.8217987795169, -104.32680732667934, -230.63280744170453, 112.10882802289453, 18.81047500040187, -46.34375604450078, 135.4991053281652, -49.78886399195534, -343.65221559899186, -277.5637863179238, 116.07871764827496, -212.2232999874487, -307.6962270746995, -196.05213528811274, -91.92257054635982, -389.57216965404933, 28.83844857669837, 98.2933399487638, 107.68814889970196, -406.69915647403616, 181.21105209595368, -486.4268834652765, -182.2639382416677, -381.486728369708, -579.7529990769456, -129.94997144233224, -512.3257470046922, -187.00283077181663, -378.79150447923956, 197.03, -172.16472719871885, -557.9240017867073, 15.991691800440528, -286.58525121930643, 1.114900674905049, -34.1268164557502, -97.22585982474646, 138.79001340315395, -83.5379087094166, 9.068221860884668, 11.769297611559509, -202.18837953712875, -61.042822468999, -494.0742781503876, -190.708231882579, 45.94665017583035, -392.2456364719696, -24.476986360912036, 97.87605877673064, -283.6833286070104, -469.74825973206595, 66.21312164406231, -61.60665558136242, -50.88159126091189, -437.83086721078996, -164.67293772113075, 160.92676873169563, 190.18047363927514, -4.164574629018375, 103.23007510204881, -239.68016195797296, -42.47988526842409, -351.4972108305239, -382.1618915602737, -253.12556794337715, 41.604501222592255, -82.63443865268394, -272.0726723870695, 165.93848218353065, -173.82791479131612, 133.35126132074868, -456.1449951139286, -128.56659505240714, -393.6548178157555], "policy_predator_policy_reward": [318.12862856301007, 383.67503445375485, 172.01122949873616, 296.6978058374087, 433.1099715808724, 67.13251794804657, 165.24088248475658, 346.034693360909, 176.01351651592228, 266.51147109662304, 431.42953488853874, 416.4482720031514, 440.5537174653039, 165.04762835922847, 384.8523278600332, 261.23043429632355, 310.9406687456361, 50.547935445221945, 333.4401029254894, 254.3295687876295, 135.98575020998487, 208.55705152038337, 393.69976003057, 317.5620164584763, 410.78282857497777, 335.6633510800897, 162.26816154669942, 296.5441563074097, 243.83245409909983, 37.420955575963625, 71.27747685095898, 443.19542451104485, 183.16505250966713, 297.2615715644573, 104.75113734210787, 352.4149611214535, 229.84308740153696, 182.72826157525955, 339.3095868729515, 413.89317862373616, 469.44454755369856, 404.7559902082568, 145.01640234797534, 240.21326103086048, 217.22997230621488, 505.47289839862185, 418.55657217123417, 324.08186790230627, 163.23025178321998, 148.1146074606345, 519.8919580811248, 240.25456504893518, 266.7883254064793, 202.5993125010262, 199.34840083522857, 378.3664249001444, 63.3152446902156, 516.620392881593, 99.64267970397187, 384.56409045097274, 385.14387478904206, 155.48301987589716, 0.0, 0.0, 325.54082860936563, 232.020669116771, 355.44466510135646, 518.0717923437156, 171.402700615926, 500.73799549643536, 29.819964494540482, 299.00423678734353, 123.85134265098971, 259.85727136233965, 317.34966615903807, 342.1317055452459, 341.06248828396804, 191.49231212127086, 432.65675089860383, 105.87858361631217, 340.88198062641465, 0.0, 369.02802999801315, 155.76879585050358, 396.9647251695696, 206.8345359925166, 92.51653729087496, 361.55206093266986, 72.6510445705015, 300.89515858434874, 54.3363704004777, 124.87579568712829, 417.81771939482553, 34.990104396977635, 8.963731681439409, 116.39482751400215, 232.7255624809031, 134.16712133368108, 370.3074715928544, 59.23946206855949, 276.622050049277, 308.69011098713304, 101.08885972318498, 240.02229430590913, 237.90431872175233, 301.2979652255146, 173.87322657214614, 396.9743507235983, 396.0818573942645, 71.57451156178328, 259.38129010172105, 336.0907375634571, 418.1460356569006, 38.0244660744559, 444.38399393114224, 395.4979545345926, 225.07861787782434, 316.52007917474407, 204.5196484443422, 314.1992213492824, 248.91020493717872, 137.94863770329496, 403.9352680119245, 36.82917798267835, 360.35624618049627, 398.8924669570272, 396.2355316514995, 61.41248563629967, 231.73280744170353, 1.7411719771054686, 55.44551511337068, 203.66416159817925, 36.03315542061463, 156.87247217133472, 291.8241306353191, 381.9376115055597, 49.92128235172503, 283.22329998744874, 428.94315034528273, 257.655348474952, 220.84655252530325, 396.9504779807147, 70.64020098613051, 96.02182790885504, 351.79197916222125, 158.33984316918, 105.68291714547044, 455.36810834859864, 282.2360192653861, 336.0645367096271, 208.1542305623559, 567.0435631205854, 512.3357470046922, 188.07283077181566, 385.8815044792395, 0.0, 523.4732757148118, 280.6760253152892, 101.3806613678659, 308.2896907211032, 40.12779338443262, 123.29515002995309, 37.2849833565102, 199.68769845189735, 160.43343202997994, 92.27466201168362, 276.3930490906934, 89.51458830404673, 189.7645334770613, 461.86280308751907, 120.41757839153892, 270.4748460643942, 460.10645285869845, 81.38616997418234, 183.56603236216472, 223.57763941772993, 431.59550399024096, 93.58757291458855, 61.550594133573924, 290.972076555348, 466.77781123385756, 212.37931292618856, 25.073231268304383, 0.8995263607248897, 87.83171687780269, 156.80975765675305, 360.0343511248537, 108.15793731236722, 360.56721083052395, 382.7318915602739, 126.58972699335452, 283.3189118310974, 140.04339021937363, 304.67164683747893, 88.57616413531841, 113.31326847246729, 477.91404297809896, 82.64615690450005, 201.54130330002528, 459.9592923308159]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.639458769396201, "mean_inference_ms": 3.1093749022390726, "mean_action_processing_ms": 0.24908104396127695, "mean_env_wait_ms": 0.21500492806186855, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0046155452728271484, "StateBufferConnector_ms": 0.003300905227661133, "ViewRequirementAgentConnector_ms": 0.10264575481414795}, "num_episodes": 18, "episode_return_max": 379.21, "episode_return_min": -35.923706161721825, "episode_return_mean": 149.65959083585133, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 272000, "num_agent_steps_trained": 272000, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 30.420250614525756, "num_env_steps_trained_throughput_per_sec": 30.420250614525756, "timesteps_total": 68000, "num_env_steps_sampled_lifetime": 68000, "num_agent_steps_sampled_lifetime": 272000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 272000, "timers": {"training_iteration_time_ms": 168286.712, "restore_workers_time_ms": 0.012, "training_step_time_ms": 168286.676, "sample_time_ms": 2031.333, "learn_time_ms": 166239.878, "learn_throughput": 24.062, "synch_weights_time_ms": 13.914}, "counters": {"num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 272000, "num_agent_steps_trained": 272000}, "done": false, "training_iteration": 17, "trial_id": "b941d_00000", "date": "2024-08-17_08-38-07", "timestamp": 1723864087, "time_this_iter_s": 131.49536085128784, "time_total_s": 2651.785213470459, "pid": 81115, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[32, [4, 4], 2], [64, [3, 3], 2], [128, [3, 3], 1]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [256, 256], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b04a9700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2651.785213470459, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 18.934759358288773, "ram_util_percent": 76.14438502673796}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 18.12029147021985, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.00010000000000000003, "total_loss": 9.202085611555312, "policy_loss": -0.08027186935358538, "vf_loss": 9.265565226822304, "vf_explained_var": 0.3911991601583188, "kl": 0.01658495054404804, "entropy": 1.2985019162218407, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 33075.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.1650001148067455, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.00010000000000000003, "total_loss": 7.4749774947999015, "policy_loss": -0.056373218925196734, "vf_loss": 7.515599393844605, "vf_explained_var": 0.09192626403753089, "kl": 0.015556851482738263, "entropy": 1.0536567744123873, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 33075.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000}, "env_runners": {"episode_reward_max": 379.21, "episode_reward_min": -35.923706161721825, "episode_reward_mean": 159.1092073796154, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -579.7529990769456, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 197.03, "predator_policy": 567.0435631205854}, "policy_reward_mean": {"prey_policy": -165.9343681975853, "predator_policy": 245.48897188739286}, "custom_metrics": {}, "hist_stats": {"episode_reward": [95.00399597216237, 0.5200000000000011, 98.96752875841177, 208.51317965860872, 213.9294018675742, 49.09000000000006, 8.62999999999997, 151.5852355108259, 221.9652822471393, 379.21, 84.46000000000008, 46.6029221301265, 82.10999999999999, 40.56001439842817, 128.5730909682503, 110.07384485568024, -35.923706161721825, 96.20940158810937, 162.74000000000004, 95.78793149564099, 194.9473852150328, 167.71871704249912, 137.6976156363731, 87.86777209065771, 163.25705946255087, 259.51000000000005, 158.47636360285023, 156.35999999999987, 185.61994849951506, 195.85708314994045, 301.4999107965619, 321.14145590205436, 255.27616074104841, 182.9444805137364, 163.7912164861561, 69.97863288080046, 221.00869107983598, 80.53000000000007, 230.84986922293504, 177.07999999999996, 17.533181640145962, 90.49941118160326, 114.95000000000022, 231.57639566745115, 278.6158689281593, 52.54574022396337, 237.0, 182.85013645742208, 136.30229030560875, 293.7938174204479, 211.1208147570671, 255.83519412474666, 54.5498893636383, 65.49482316366493, 1.0799999999999987, 204.11999999999995, 74.06057204467604, 139.07679267010332, 130.41102763354087, 278.536835386815, 178.2384071931324, 175.48855546917068, 96.51023594519467, 246.13084274918444, 124.76999999999992, 221.33640194961475, 121.6479388168257, 240.03442384664783, 76.65331922812537, 377.08, 343.70697500758615, 186.0322412108238, 9.639999999999969, 198.3875721036669, 90.00792601709931, 194.00000000000017, 237.76646608941914, 139.2791827626784, 202.98696669832398, 96.80439443415587, 33.57269088768547, 91.46037897974163, 189.93898228488055, 195.78095869594335, 12.774917015457849, 2.689999999999987, 221.5551668147006, 197.0725418467636, 251.48232830746971, 141.16999999999993, 276.8811282654492, 191.31156325647007, 292.1483332757809, 205.9001544713526, 184.40000000000003, 54.31239107733466, 144.833476990317, 307.8886704750488, 224.1029515958576, 135.1689776187965], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-397.3890935241203, -230.309781208554, -418.45657217123426, -323.66186790230665, -55.64491836206621, -156.73241212337726, -549.219374082763, -2.413969388688031, -184.58709606546722, -70.8711399744646, -198.27840083522955, -330.3464249001444, -61.685244690215924, -509.62039288159315, 51.522555806854015, -384.14409045097284, 121.97868700487345, -440.64029942267325, 195.05, 184.16, -325.110828609366, -147.99066911677085, -298.8671669084017, -528.0463684065438, -89.31270061592616, -500.7179954964354, -286.4751762604412, -1.789010623014533, 3.7717483172604886, -258.90727136234045, -93.39130066532115, -456.0162261832818, -321.46091161721796, -247.01759494974323, -432.5867508986039, -9.739182028202563, -340.5219806264145, 162.38, -213.02465998633795, -215.98423436653863, -408.9464601455281, 0.09458419847495492, -392.60069201589107, 106.25081083484551, -108.97709096550379, -126.87149655297279, -87.04137420854805, -4.303019788400366, -417.56009681640865, 128.0093324871564, 96.12120629241873, 38.030234512139785, -159.12106424012677, -49.295255971607105, -369.94747159285464, 96.7605379314405, -231.22571833936146, -168.46649419753345, -35.68827520468866, -109.56579567446485, 123.75874529616732, -361.4611184468724, 191.09, -440.7961213936899, -169.05405540616414, -43.32615280883468, 0.8710541420272865, -413.398601293468, -16.088720118035912, -276.2905651271645, -379.8582381083874, -390.0450774765477, -215.64911797386583, -104.94088799886633, -124.47964844434225, -313.70922134928264, -72.37168830182547, -83.63728511571307, -403.87526801192456, 140.19082201732164, -324.2352939128911, -417.4802375844869, -262.8217987795169, -104.32680732667934, -230.63280744170453, 112.10882802289453, 18.81047500040187, -46.34375604450078, 135.4991053281652, -49.78886399195534, -343.65221559899186, -277.5637863179238, 116.07871764827496, -212.2232999874487, -307.6962270746995, -196.05213528811274, -91.92257054635982, -389.57216965404933, 28.83844857669837, 98.2933399487638, 107.68814889970196, -406.69915647403616, 181.21105209595368, -486.4268834652765, -182.2639382416677, -381.486728369708, -579.7529990769456, -129.94997144233224, -512.3257470046922, -187.00283077181663, -378.79150447923956, 197.03, -172.16472719871885, -557.9240017867073, 15.991691800440528, -286.58525121930643, 1.114900674905049, -34.1268164557502, -97.22585982474646, 138.79001340315395, -83.5379087094166, 9.068221860884668, 11.769297611559509, -202.18837953712875, -61.042822468999, -494.0742781503876, -190.708231882579, 45.94665017583035, -392.2456364719696, -24.476986360912036, 97.87605877673064, -283.6833286070104, -469.74825973206595, 66.21312164406231, -61.60665558136242, -50.88159126091189, -437.83086721078996, -164.67293772113075, 160.92676873169563, 190.18047363927514, -4.164574629018375, 103.23007510204881, -239.68016195797296, -42.47988526842409, -351.4972108305239, -382.1618915602737, -253.12556794337715, 41.604501222592255, -82.63443865268394, -272.0726723870695, 165.93848218353065, -173.82791479131612, 133.35126132074868, -456.1449951139286, -128.56659505240714, -393.6548178157555, -166.92920872938555, 40.28935227624637, -202.97519520743478, -146.78872268374099, -421.62299439303365, -352.59655251167527, -450.99136769858757, -233.40712887716606, -5.264149525517453, -515.2200672313962, -102.7220593488081, -163.37188643106492, -310.0933635190805, -515.0089987889716, -334.5865230214216, -175.438429561263, 57.37881397388718, 3.3695188785359127, -104.4001417335156, -119.25898729608807, 102.27637053188319, -96.98180225062703, -373.6820403857835, 64.57043150111801, 77.28707979145965, -37.7026087642364, -191.80898791988196, -435.1741936873171, 30.21983983105216, -569.908906353893, 63.40287586648782, -388.37366981209095, -442.99354621187996, 183.33422081305295, -174.56548337877564, -275.9181028924651, 40.18601171812803, -351.1870321149044, -99.79587462489131, 41.934940535943916, 16.747654202482153, -352.55591592564986, -493.80281957767147, -217.04376663707848], "policy_predator_policy_reward": [217.22997230621488, 505.47289839862185, 418.55657217123417, 324.08186790230627, 163.23025178321998, 148.1146074606345, 519.8919580811248, 240.25456504893518, 266.7883254064793, 202.5993125010262, 199.34840083522857, 378.3664249001444, 63.3152446902156, 516.620392881593, 99.64267970397187, 384.56409045097274, 385.14387478904206, 155.48301987589716, 0.0, 0.0, 325.54082860936563, 232.020669116771, 355.44466510135646, 518.0717923437156, 171.402700615926, 500.73799549643536, 29.819964494540482, 299.00423678734353, 123.85134265098971, 259.85727136233965, 317.34966615903807, 342.1317055452459, 341.06248828396804, 191.49231212127086, 432.65675089860383, 105.87858361631217, 340.88198062641465, 0.0, 369.02802999801315, 155.76879585050358, 396.9647251695696, 206.8345359925166, 92.51653729087496, 361.55206093266986, 72.6510445705015, 300.89515858434874, 54.3363704004777, 124.87579568712829, 417.81771939482553, 34.990104396977635, 8.963731681439409, 116.39482751400215, 232.7255624809031, 134.16712133368108, 370.3074715928544, 59.23946206855949, 276.622050049277, 308.69011098713304, 101.08885972318498, 240.02229430590913, 237.90431872175233, 301.2979652255146, 173.87322657214614, 396.9743507235983, 396.0818573942645, 71.57451156178328, 259.38129010172105, 336.0907375634571, 418.1460356569006, 38.0244660744559, 444.38399393114224, 395.4979545345926, 225.07861787782434, 316.52007917474407, 204.5196484443422, 314.1992213492824, 248.91020493717872, 137.94863770329496, 403.9352680119245, 36.82917798267835, 360.35624618049627, 398.8924669570272, 396.2355316514995, 61.41248563629967, 231.73280744170353, 1.7411719771054686, 55.44551511337068, 203.66416159817925, 36.03315542061463, 156.87247217133472, 291.8241306353191, 381.9376115055597, 49.92128235172503, 283.22329998744874, 428.94315034528273, 257.655348474952, 220.84655252530325, 396.9504779807147, 70.64020098613051, 96.02182790885504, 351.79197916222125, 158.33984316918, 105.68291714547044, 455.36810834859864, 282.2360192653861, 336.0645367096271, 208.1542305623559, 567.0435631205854, 512.3357470046922, 188.07283077181566, 385.8815044792395, 0.0, 523.4732757148118, 280.6760253152892, 101.3806613678659, 308.2896907211032, 40.12779338443262, 123.29515002995309, 37.2849833565102, 199.68769845189735, 160.43343202997994, 92.27466201168362, 276.3930490906934, 89.51458830404673, 189.7645334770613, 461.86280308751907, 120.41757839153892, 270.4748460643942, 460.10645285869845, 81.38616997418234, 183.56603236216472, 223.57763941772993, 431.59550399024096, 93.58757291458855, 61.550594133573924, 290.972076555348, 466.77781123385756, 212.37931292618856, 25.073231268304383, 0.8995263607248897, 87.83171687780269, 156.80975765675305, 360.0343511248537, 108.15793731236722, 360.56721083052395, 382.7318915602739, 126.58972699335452, 283.3189118310974, 140.04339021937363, 304.67164683747893, 88.57616413531841, 113.31326847246729, 477.91404297809896, 82.64615690450005, 201.54130330002528, 459.9592923308159, 13.82255014798345, 315.80427300347975, 143.3600505747667, 303.2082617505648, 436.7130201074193, 371.0792176849749, 445.76285731472774, 330.0960182407673, 309.1132311908879, 401.3099678509058, 161.67340919967003, 300.2014952761461, 321.8082805345378, 516.0689987889715, 336.0465230214214, 176.66842956126214, 76.04976100072243, 84.75707296155527, 212.89663111012752, 207.83503976623956, 40.68899706301896, 205.4987629631944, 373.8520403857836, 76.42956849888196, 100.80387219051089, 136.4927850477151, 388.1563861703435, 430.1383586933258, 316.7077658672437, 515.1296339313786, 343.2860843690667, 187.58486404788843, 443.2435462118798, 0.8157791869470419, 295.35746848227274, 209.4385088663012, 337.2254767118839, 118.60902067520952, 212.66036207661762, 153.0892424873787, 242.11248236254386, 317.79873095648134, 473.51882368869576, 372.4967401448509]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6380466479992303, "mean_inference_ms": 3.103544698483609, "mean_action_processing_ms": 0.24884046033768265, "mean_env_wait_ms": 0.21491950018948786, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004808306694030762, "StateBufferConnector_ms": 0.0033609867095947266, "ViewRequirementAgentConnector_ms": 0.10641491413116455}, "num_episodes": 22, "episode_return_max": 379.21, "episode_return_min": -35.923706161721825, "episode_return_mean": 159.1092073796154, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 30.764029214233034, "num_env_steps_trained_throughput_per_sec": 30.764029214233034, "timesteps_total": 72000, "num_env_steps_sampled_lifetime": 72000, "num_agent_steps_sampled_lifetime": 288000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 288000, "timers": {"training_iteration_time_ms": 167935.087, "restore_workers_time_ms": 0.012, "training_step_time_ms": 167935.05, "sample_time_ms": 2019.211, "learn_time_ms": 165901.335, "learn_throughput": 24.111, "synch_weights_time_ms": 13.179}, "counters": {"num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000}, "done": false, "training_iteration": 18, "trial_id": "b941d_00000", "date": "2024-08-17_08-40-17", "timestamp": 1723864217, "time_this_iter_s": 130.02773213386536, "time_total_s": 2781.8129456043243, "pid": 81115, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[32, [4, 4], 2], [64, [3, 3], 2], [128, [3, 3], 1]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [256, 256], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b04a5dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2781.8129456043243, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 19.43945945945946, "ram_util_percent": 75.59945945945945}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 20.58546440399513, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.00010000000000000003, "total_loss": 9.085557942163376, "policy_loss": -0.08173121424544623, "vf_loss": 9.150101423515844, "vf_explained_var": 0.38550958116218526, "kl": 0.016975513400048627, "entropy": 1.3009246643888888, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 34965.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.288607612741057, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.00010000000000000003, "total_loss": 8.075090533968002, "policy_loss": -0.06337432565817994, "vf_loss": 8.122171486244, "vf_explained_var": 0.0908557789666312, "kl": 0.01609223945788231, "entropy": 1.0181455422961523, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 34965.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 304000, "num_agent_steps_trained": 304000}, "env_runners": {"episode_reward_max": 377.08, "episode_reward_min": -18.36288794092987, "episode_reward_mean": 168.2712611543363, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -579.7529990769456, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 197.03, "predator_policy": 567.0435631205854}, "policy_reward_mean": {"prey_policy": -163.96968116605024, "predator_policy": 248.1053117432183}, "custom_metrics": {}, "hist_stats": {"episode_reward": [87.86777209065771, 163.25705946255087, 259.51000000000005, 158.47636360285023, 156.35999999999987, 185.61994849951506, 195.85708314994045, 301.4999107965619, 321.14145590205436, 255.27616074104841, 182.9444805137364, 163.7912164861561, 69.97863288080046, 221.00869107983598, 80.53000000000007, 230.84986922293504, 177.07999999999996, 17.533181640145962, 90.49941118160326, 114.95000000000022, 231.57639566745115, 278.6158689281593, 52.54574022396337, 237.0, 182.85013645742208, 136.30229030560875, 293.7938174204479, 211.1208147570671, 255.83519412474666, 54.5498893636383, 65.49482316366493, 1.0799999999999987, 204.11999999999995, 74.06057204467604, 139.07679267010332, 130.41102763354087, 278.536835386815, 178.2384071931324, 175.48855546917068, 96.51023594519467, 246.13084274918444, 124.76999999999992, 221.33640194961475, 121.6479388168257, 240.03442384664783, 76.65331922812537, 377.08, 343.70697500758615, 186.0322412108238, 9.639999999999969, 198.3875721036669, 90.00792601709931, 194.00000000000017, 237.76646608941914, 139.2791827626784, 202.98696669832398, 96.80439443415587, 33.57269088768547, 91.46037897974163, 189.93898228488055, 195.78095869594335, 12.774917015457849, 2.689999999999987, 221.5551668147006, 197.0725418467636, 251.48232830746971, 141.16999999999993, 276.8811282654492, 191.31156325647007, 292.1483332757809, 205.9001544713526, 184.40000000000003, 54.31239107733466, 144.833476990317, 307.8886704750488, 224.1029515958576, 135.1689776187965, 231.713332196121, -18.36288794092987, 59.4747394316308, 82.08856184124753, 241.6425783183286, 196.25231011020378, 0.6700000000000024, 221.6618440479428, 272.8127606168996, 179.99196441386243, 84.03375492362521, 321.34939224034565, 119.64508534558178, 193.65161909807523, 220.12428005593443, 184.28851130197728, 153.78117867515707, 74.25605886751566, 66.17602023698016, 170.7181990885785, 168.27763782355737, 368.60546741759117, 62.3248105450088], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-87.04137420854805, -4.303019788400366, -417.56009681640865, 128.0093324871564, 96.12120629241873, 38.030234512139785, -159.12106424012677, -49.295255971607105, -369.94747159285464, 96.7605379314405, -231.22571833936146, -168.46649419753345, -35.68827520468866, -109.56579567446485, 123.75874529616732, -361.4611184468724, 191.09, -440.7961213936899, -169.05405540616414, -43.32615280883468, 0.8710541420272865, -413.398601293468, -16.088720118035912, -276.2905651271645, -379.8582381083874, -390.0450774765477, -215.64911797386583, -104.94088799886633, -124.47964844434225, -313.70922134928264, -72.37168830182547, -83.63728511571307, -403.87526801192456, 140.19082201732164, -324.2352939128911, -417.4802375844869, -262.8217987795169, -104.32680732667934, -230.63280744170453, 112.10882802289453, 18.81047500040187, -46.34375604450078, 135.4991053281652, -49.78886399195534, -343.65221559899186, -277.5637863179238, 116.07871764827496, -212.2232999874487, -307.6962270746995, -196.05213528811274, -91.92257054635982, -389.57216965404933, 28.83844857669837, 98.2933399487638, 107.68814889970196, -406.69915647403616, 181.21105209595368, -486.4268834652765, -182.2639382416677, -381.486728369708, -579.7529990769456, -129.94997144233224, -512.3257470046922, -187.00283077181663, -378.79150447923956, 197.03, -172.16472719871885, -557.9240017867073, 15.991691800440528, -286.58525121930643, 1.114900674905049, -34.1268164557502, -97.22585982474646, 138.79001340315395, -83.5379087094166, 9.068221860884668, 11.769297611559509, -202.18837953712875, -61.042822468999, -494.0742781503876, -190.708231882579, 45.94665017583035, -392.2456364719696, -24.476986360912036, 97.87605877673064, -283.6833286070104, -469.74825973206595, 66.21312164406231, -61.60665558136242, -50.88159126091189, -437.83086721078996, -164.67293772113075, 160.92676873169563, 190.18047363927514, -4.164574629018375, 103.23007510204881, -239.68016195797296, -42.47988526842409, -351.4972108305239, -382.1618915602737, -253.12556794337715, 41.604501222592255, -82.63443865268394, -272.0726723870695, 165.93848218353065, -173.82791479131612, 133.35126132074868, -456.1449951139286, -128.56659505240714, -393.6548178157555, -166.92920872938555, 40.28935227624637, -202.97519520743478, -146.78872268374099, -421.62299439303365, -352.59655251167527, -450.99136769858757, -233.40712887716606, -5.264149525517453, -515.2200672313962, -102.7220593488081, -163.37188643106492, -310.0933635190805, -515.0089987889716, -334.5865230214216, -175.438429561263, 57.37881397388718, 3.3695188785359127, -104.4001417335156, -119.25898729608807, 102.27637053188319, -96.98180225062703, -373.6820403857835, 64.57043150111801, 77.28707979145965, -37.7026087642364, -191.80898791988196, -435.1741936873171, 30.21983983105216, -569.908906353893, 63.40287586648782, -388.37366981209095, -442.99354621187996, 183.33422081305295, -174.56548337877564, -275.9181028924651, 40.18601171812803, -351.1870321149044, -99.79587462489131, 41.934940535943916, 16.747654202482153, -352.55591592564986, -493.80281957767147, -217.04376663707848, -489.4829173912817, 78.08455568803755, -402.9951547086671, -505.3510686656849, -529.2608868643902, -245.8853514127806, -142.12853141141647, -29.561535017373217, -256.3263465310681, 98.17538696448992, 13.718286750828707, -134.3765137563368, -341.70777426980027, -397.23205430652916, -55.34542240001065, -389.63727789443004, -10.462881663046147, 48.7613461450279, -247.52670747121607, -6.060464141649767, -216.6681857892168, -375.4115603707681, -100.08871539575927, 109.65884917488461, -438.904632855675, -22.439965447566927, -361.60361501209684, 70.49636234218711, 50.933344816359394, -13.546353941135735, -332.98145650440415, 135.53465389888572, -92.3367711078272, -16.580821797132813, -127.6557724772716, -438.33787537475615, -142.16018499842613, -434.874686405554, -497.096657884668, -206.73618585213285, -337.6176571611693, -255.96349363122744, -142.2197242753613, 195.18475317196396, -518.6642012974872, -445.52918738270176], "policy_predator_policy_reward": [54.3363704004777, 124.87579568712829, 417.81771939482553, 34.990104396977635, 8.963731681439409, 116.39482751400215, 232.7255624809031, 134.16712133368108, 370.3074715928544, 59.23946206855949, 276.622050049277, 308.69011098713304, 101.08885972318498, 240.02229430590913, 237.90431872175233, 301.2979652255146, 173.87322657214614, 396.9743507235983, 396.0818573942645, 71.57451156178328, 259.38129010172105, 336.0907375634571, 418.1460356569006, 38.0244660744559, 444.38399393114224, 395.4979545345926, 225.07861787782434, 316.52007917474407, 204.5196484443422, 314.1992213492824, 248.91020493717872, 137.94863770329496, 403.9352680119245, 36.82917798267835, 360.35624618049627, 398.8924669570272, 396.2355316514995, 61.41248563629967, 231.73280744170353, 1.7411719771054686, 55.44551511337068, 203.66416159817925, 36.03315542061463, 156.87247217133472, 291.8241306353191, 381.9376115055597, 49.92128235172503, 283.22329998744874, 428.94315034528273, 257.655348474952, 220.84655252530325, 396.9504779807147, 70.64020098613051, 96.02182790885504, 351.79197916222125, 158.33984316918, 105.68291714547044, 455.36810834859864, 282.2360192653861, 336.0645367096271, 208.1542305623559, 567.0435631205854, 512.3357470046922, 188.07283077181566, 385.8815044792395, 0.0, 523.4732757148118, 280.6760253152892, 101.3806613678659, 308.2896907211032, 40.12779338443262, 123.29515002995309, 37.2849833565102, 199.68769845189735, 160.43343202997994, 92.27466201168362, 276.3930490906934, 89.51458830404673, 189.7645334770613, 461.86280308751907, 120.41757839153892, 270.4748460643942, 460.10645285869845, 81.38616997418234, 183.56603236216472, 223.57763941772993, 431.59550399024096, 93.58757291458855, 61.550594133573924, 290.972076555348, 466.77781123385756, 212.37931292618856, 25.073231268304383, 0.8995263607248897, 87.83171687780269, 156.80975765675305, 360.0343511248537, 108.15793731236722, 360.56721083052395, 382.7318915602739, 126.58972699335452, 283.3189118310974, 140.04339021937363, 304.67164683747893, 88.57616413531841, 113.31326847246729, 477.91404297809896, 82.64615690450005, 201.54130330002528, 459.9592923308159, 13.82255014798345, 315.80427300347975, 143.3600505747667, 303.2082617505648, 436.7130201074193, 371.0792176849749, 445.76285731472774, 330.0960182407673, 309.1132311908879, 401.3099678509058, 161.67340919967003, 300.2014952761461, 321.8082805345378, 516.0689987889715, 336.0465230214214, 176.66842956126214, 76.04976100072243, 84.75707296155527, 212.89663111012752, 207.83503976623956, 40.68899706301896, 205.4987629631944, 373.8520403857836, 76.42956849888196, 100.80387219051089, 136.4927850477151, 388.1563861703435, 430.1383586933258, 316.7077658672437, 515.1296339313786, 343.2860843690667, 187.58486404788843, 443.2435462118798, 0.8157791869470419, 295.35746848227274, 209.4385088663012, 337.2254767118839, 118.60902067520952, 212.66036207661762, 153.0892424873787, 242.11248236254386, 317.79873095648134, 473.51882368869576, 372.4967401448509, 487.3292640909557, 155.78242980840943, 495.65678420938696, 394.32655122403514, 529.2608868643902, 305.36009084441133, 213.18359873807066, 40.59502953196685, 62.377470017449674, 337.4160678674571, 65.95094980853484, 250.9595873071768, 342.18777426980006, 397.42205430652905, 343.80043602867516, 322.84410831370826, 129.15951414190343, 105.35478199301429, 431.0211707835584, 2.557965243169401, 176.9266352757486, 499.18686580786107, 180.78316319830583, 130.996095262914, 439.08463285567495, 141.90505079314866, 407.00165671023314, 77.7572150577518, 29.2254589799522, 153.51183020075845, 334.09145650440314, 47.64385740309186, 136.3158809333166, 126.38289064680049, 114.24101476057344, 526.00869195897, 317.36551351368956, 325.8453781272701, 399.33502116287883, 475.21602166250074, 309.19704523835816, 452.66174337759577, 201.06204137365393, 114.57839714733468, 505.15801980905053, 521.3601794161474]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6370487810089275, "mean_inference_ms": 3.10600846619146, "mean_action_processing_ms": 0.2483578284879113, "mean_env_wait_ms": 0.2150230221640615, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004918217658996582, "StateBufferConnector_ms": 0.0033930540084838867, "ViewRequirementAgentConnector_ms": 0.10731256008148193}, "num_episodes": 23, "episode_return_max": 377.08, "episode_return_min": -18.36288794092987, "episode_return_mean": 168.2712611543363, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 304000, "num_agent_steps_trained": 304000, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 30.733974879441824, "num_env_steps_trained_throughput_per_sec": 30.733974879441824, "timesteps_total": 76000, "num_env_steps_sampled_lifetime": 76000, "num_agent_steps_sampled_lifetime": 304000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 304000, "timers": {"training_iteration_time_ms": 167748.317, "restore_workers_time_ms": 0.012, "training_step_time_ms": 167748.28, "sample_time_ms": 1998.444, "learn_time_ms": 165735.479, "learn_throughput": 24.135, "synch_weights_time_ms": 13.172}, "counters": {"num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 304000, "num_agent_steps_trained": 304000}, "done": false, "training_iteration": 19, "trial_id": "b941d_00000", "date": "2024-08-17_08-42-27", "timestamp": 1723864347, "time_this_iter_s": 130.1585350036621, "time_total_s": 2911.9714806079865, "pid": 81115, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[32, [4, 4], 2], [64, [3, 3], 2], [128, [3, 3], 1]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [256, 256], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b04a58b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2911.9714806079865, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 19.292391304347827, "ram_util_percent": 75.56141304347828}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 22.0467763504654, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.00010000000000000003, "total_loss": 9.054357223914414, "policy_loss": -0.07096068808616746, "vf_loss": 9.109741075707491, "vf_explained_var": 0.3133996096552995, "kl": 0.015384516163451325, "entropy": 1.2781121038255236, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 36855.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.932313840540629, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.00010000000000000003, "total_loss": 7.585473351503806, "policy_loss": -0.05684660319337454, "vf_loss": 7.627262392750493, "vf_explained_var": 0.09020501756794239, "kl": 0.01487167190868012, "entropy": 1.0279271645836099, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 36855.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000}, "env_runners": {"episode_reward_max": 377.08, "episode_reward_min": -18.36288794092987, "episode_reward_mean": 167.3454057787454, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -592.2156844163691, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 197.03, "predator_policy": 613.0019755428475}, "policy_reward_mean": {"prey_policy": -169.90734976977225, "predator_policy": 253.58005265914485}, "custom_metrics": {}, "hist_stats": {"episode_reward": [90.49941118160326, 114.95000000000022, 231.57639566745115, 278.6158689281593, 52.54574022396337, 237.0, 182.85013645742208, 136.30229030560875, 293.7938174204479, 211.1208147570671, 255.83519412474666, 54.5498893636383, 65.49482316366493, 1.0799999999999987, 204.11999999999995, 74.06057204467604, 139.07679267010332, 130.41102763354087, 278.536835386815, 178.2384071931324, 175.48855546917068, 96.51023594519467, 246.13084274918444, 124.76999999999992, 221.33640194961475, 121.6479388168257, 240.03442384664783, 76.65331922812537, 377.08, 343.70697500758615, 186.0322412108238, 9.639999999999969, 198.3875721036669, 90.00792601709931, 194.00000000000017, 237.76646608941914, 139.2791827626784, 202.98696669832398, 96.80439443415587, 33.57269088768547, 91.46037897974163, 189.93898228488055, 195.78095869594335, 12.774917015457849, 2.689999999999987, 221.5551668147006, 197.0725418467636, 251.48232830746971, 141.16999999999993, 276.8811282654492, 191.31156325647007, 292.1483332757809, 205.9001544713526, 184.40000000000003, 54.31239107733466, 144.833476990317, 307.8886704750488, 224.1029515958576, 135.1689776187965, 231.713332196121, -18.36288794092987, 59.4747394316308, 82.08856184124753, 241.6425783183286, 196.25231011020378, 0.6700000000000024, 221.6618440479428, 272.8127606168996, 179.99196441386243, 84.03375492362521, 321.34939224034565, 119.64508534558178, 193.65161909807523, 220.12428005593443, 184.28851130197728, 153.78117867515707, 74.25605886751566, 66.17602023698016, 170.7181990885785, 168.27763782355737, 368.60546741759117, 62.3248105450088, 290.7433870833298, 270.4106510685518, 137.29408373503065, 192.12620607203493, 297.80151154128566, 172.90579453248927, 138.8818592848006, 79.01240139488876, 90.87000000000013, 369.1579741975806, 107.62146504464386, 159.61788943421982, 110.9500000000004, 108.9244671662285, 78.21597761461578, 135.67952223419357, 300.11844912390035, 95.66464898189781], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-262.8217987795169, -104.32680732667934, -230.63280744170453, 112.10882802289453, 18.81047500040187, -46.34375604450078, 135.4991053281652, -49.78886399195534, -343.65221559899186, -277.5637863179238, 116.07871764827496, -212.2232999874487, -307.6962270746995, -196.05213528811274, -91.92257054635982, -389.57216965404933, 28.83844857669837, 98.2933399487638, 107.68814889970196, -406.69915647403616, 181.21105209595368, -486.4268834652765, -182.2639382416677, -381.486728369708, -579.7529990769456, -129.94997144233224, -512.3257470046922, -187.00283077181663, -378.79150447923956, 197.03, -172.16472719871885, -557.9240017867073, 15.991691800440528, -286.58525121930643, 1.114900674905049, -34.1268164557502, -97.22585982474646, 138.79001340315395, -83.5379087094166, 9.068221860884668, 11.769297611559509, -202.18837953712875, -61.042822468999, -494.0742781503876, -190.708231882579, 45.94665017583035, -392.2456364719696, -24.476986360912036, 97.87605877673064, -283.6833286070104, -469.74825973206595, 66.21312164406231, -61.60665558136242, -50.88159126091189, -437.83086721078996, -164.67293772113075, 160.92676873169563, 190.18047363927514, -4.164574629018375, 103.23007510204881, -239.68016195797296, -42.47988526842409, -351.4972108305239, -382.1618915602737, -253.12556794337715, 41.604501222592255, -82.63443865268394, -272.0726723870695, 165.93848218353065, -173.82791479131612, 133.35126132074868, -456.1449951139286, -128.56659505240714, -393.6548178157555, -166.92920872938555, 40.28935227624637, -202.97519520743478, -146.78872268374099, -421.62299439303365, -352.59655251167527, -450.99136769858757, -233.40712887716606, -5.264149525517453, -515.2200672313962, -102.7220593488081, -163.37188643106492, -310.0933635190805, -515.0089987889716, -334.5865230214216, -175.438429561263, 57.37881397388718, 3.3695188785359127, -104.4001417335156, -119.25898729608807, 102.27637053188319, -96.98180225062703, -373.6820403857835, 64.57043150111801, 77.28707979145965, -37.7026087642364, -191.80898791988196, -435.1741936873171, 30.21983983105216, -569.908906353893, 63.40287586648782, -388.37366981209095, -442.99354621187996, 183.33422081305295, -174.56548337877564, -275.9181028924651, 40.18601171812803, -351.1870321149044, -99.79587462489131, 41.934940535943916, 16.747654202482153, -352.55591592564986, -493.80281957767147, -217.04376663707848, -489.4829173912817, 78.08455568803755, -402.9951547086671, -505.3510686656849, -529.2608868643902, -245.8853514127806, -142.12853141141647, -29.561535017373217, -256.3263465310681, 98.17538696448992, 13.718286750828707, -134.3765137563368, -341.70777426980027, -397.23205430652916, -55.34542240001065, -389.63727789443004, -10.462881663046147, 48.7613461450279, -247.52670747121607, -6.060464141649767, -216.6681857892168, -375.4115603707681, -100.08871539575927, 109.65884917488461, -438.904632855675, -22.439965447566927, -361.60361501209684, 70.49636234218711, 50.933344816359394, -13.546353941135735, -332.98145650440415, 135.53465389888572, -92.3367711078272, -16.580821797132813, -127.6557724772716, -438.33787537475615, -142.16018499842613, -434.874686405554, -497.096657884668, -206.73618585213285, -337.6176571611693, -255.96349363122744, -142.2197242753613, 195.18475317196396, -518.6642012974872, -445.52918738270176, -183.27018990509526, 58.93353526828071, 6.695138456780045, -492.20185625141266, -123.09439021352213, -428.84086119148634, 11.818910430762081, -493.49482268700416, -592.2156844163691, 95.51348867109786, -446.96067381331443, -10.97636973143635, -364.93714545679734, -18.475630638166837, -433.3611997236299, -306.13131492187836, -33.88917797248489, -67.13852506709134, 163.56393980164813, 124.8554121004846, -317.58608166272523, -261.05417248754355, 7.029745804081074, -130.3336689815379, -201.3551814980646, -147.57308681368053, -242.30054081233064, -209.8249229184875, -167.8953492113285, -256.0749357732216, -304.39094369286784, -146.8767996219857, -188.16654071872736, -99.23707589587026, -191.982480421859, -164.38420100530942], "policy_predator_policy_reward": [396.2355316514995, 61.41248563629967, 231.73280744170353, 1.7411719771054686, 55.44551511337068, 203.66416159817925, 36.03315542061463, 156.87247217133472, 291.8241306353191, 381.9376115055597, 49.92128235172503, 283.22329998744874, 428.94315034528273, 257.655348474952, 220.84655252530325, 396.9504779807147, 70.64020098613051, 96.02182790885504, 351.79197916222125, 158.33984316918, 105.68291714547044, 455.36810834859864, 282.2360192653861, 336.0645367096271, 208.1542305623559, 567.0435631205854, 512.3357470046922, 188.07283077181566, 385.8815044792395, 0.0, 523.4732757148118, 280.6760253152892, 101.3806613678659, 308.2896907211032, 40.12779338443262, 123.29515002995309, 37.2849833565102, 199.68769845189735, 160.43343202997994, 92.27466201168362, 276.3930490906934, 89.51458830404673, 189.7645334770613, 461.86280308751907, 120.41757839153892, 270.4748460643942, 460.10645285869845, 81.38616997418234, 183.56603236216472, 223.57763941772993, 431.59550399024096, 93.58757291458855, 61.550594133573924, 290.972076555348, 466.77781123385756, 212.37931292618856, 25.073231268304383, 0.8995263607248897, 87.83171687780269, 156.80975765675305, 360.0343511248537, 108.15793731236722, 360.56721083052395, 382.7318915602739, 126.58972699335452, 283.3189118310974, 140.04339021937363, 304.67164683747893, 88.57616413531841, 113.31326847246729, 477.91404297809896, 82.64615690450005, 201.54130330002528, 459.9592923308159, 13.82255014798345, 315.80427300347975, 143.3600505747667, 303.2082617505648, 436.7130201074193, 371.0792176849749, 445.76285731472774, 330.0960182407673, 309.1132311908879, 401.3099678509058, 161.67340919967003, 300.2014952761461, 321.8082805345378, 516.0689987889715, 336.0465230214214, 176.66842956126214, 76.04976100072243, 84.75707296155527, 212.89663111012752, 207.83503976623956, 40.68899706301896, 205.4987629631944, 373.8520403857836, 76.42956849888196, 100.80387219051089, 136.4927850477151, 388.1563861703435, 430.1383586933258, 316.7077658672437, 515.1296339313786, 343.2860843690667, 187.58486404788843, 443.2435462118798, 0.8157791869470419, 295.35746848227274, 209.4385088663012, 337.2254767118839, 118.60902067520952, 212.66036207661762, 153.0892424873787, 242.11248236254386, 317.79873095648134, 473.51882368869576, 372.4967401448509, 487.3292640909557, 155.78242980840943, 495.65678420938696, 394.32655122403514, 529.2608868643902, 305.36009084441133, 213.18359873807066, 40.59502953196685, 62.377470017449674, 337.4160678674571, 65.95094980853484, 250.9595873071768, 342.18777426980006, 397.42205430652905, 343.80043602867516, 322.84410831370826, 129.15951414190343, 105.35478199301429, 431.0211707835584, 2.557965243169401, 176.9266352757486, 499.18686580786107, 180.78316319830583, 130.996095262914, 439.08463285567495, 141.90505079314866, 407.00165671023314, 77.7572150577518, 29.2254589799522, 153.51183020075845, 334.09145650440314, 47.64385740309186, 136.3158809333166, 126.38289064680049, 114.24101476057344, 526.00869195897, 317.36551351368956, 325.8453781272701, 399.33502116287883, 475.21602166250074, 309.19704523835816, 452.66174337759577, 201.06204137365393, 114.57839714733468, 505.15801980905053, 521.3601794161474, 250.47436586374502, 164.6056758563993, 268.86790194278416, 487.04946692040016, 232.92535802947168, 456.30397711056753, 60.80014278542976, 613.0019755428475, 319.3245247009507, 475.17918258560644, 440.6404628051875, 190.20237527205242, 415.39758750278725, 106.89704787697741, 424.9910468223185, 393.5138692180785, 73.00468505411293, 118.89301798546335, 33.182468331205214, 47.55615396424263, 531.665801200051, 154.59591799486122, 183.1807784247672, 99.74103418690956, 222.29518149806376, 237.58308681368047, 286.11848091252244, 274.9314499845235, 232.07120268249375, 270.11505991667053, 209.25519287208732, 377.6920726769598, 257.06913058362517, 330.45293515487253, 84.04876756297293, 367.98256284609306]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6365291365834358, "mean_inference_ms": 3.108635784947061, "mean_action_processing_ms": 0.2482655966762887, "mean_env_wait_ms": 0.21508951034365162, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005030035972595215, "StateBufferConnector_ms": 0.0034635066986083984, "ViewRequirementAgentConnector_ms": 0.10932433605194092}, "num_episodes": 18, "episode_return_max": 377.08, "episode_return_min": -18.36288794092987, "episode_return_mean": 167.3454057787454, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 30.767151899685697, "num_env_steps_trained_throughput_per_sec": 30.767151899685697, "timesteps_total": 80000, "num_env_steps_sampled_lifetime": 80000, "num_agent_steps_sampled_lifetime": 320000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 320000, "timers": {"training_iteration_time_ms": 167657.227, "restore_workers_time_ms": 0.012, "training_step_time_ms": 167657.191, "sample_time_ms": 2001.253, "learn_time_ms": 165641.555, "learn_throughput": 24.149, "synch_weights_time_ms": 13.18}, "counters": {"num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000}, "done": false, "training_iteration": 20, "trial_id": "b941d_00000", "date": "2024-08-17_08-44-37", "timestamp": 1723864477, "time_this_iter_s": 130.01520705223083, "time_total_s": 3041.9866876602173, "pid": 81115, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[32, [4, 4], 2], [64, [3, 3], 2], [128, [3, 3], 1]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [256, 256], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b04959d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3041.9866876602173, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 19.62810810810811, "ram_util_percent": 76.02000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 27.20900640475056, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.00010000000000000003, "total_loss": 8.666865080121964, "policy_loss": -0.07867133706123149, "vf_loss": 8.728074369228706, "vf_explained_var": 0.44965949481126494, "kl": 0.017246490218310713, "entropy": 1.247392026961796, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 38745.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.505997688240475, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.00010000000000000003, "total_loss": 6.886803857107011, "policy_loss": -0.05504420466041045, "vf_loss": 6.9254908263998685, "vf_explained_var": 0.1337578517734689, "kl": 0.016155288220080177, "entropy": 1.0408252068612942, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 38745.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000}, "env_runners": {"episode_reward_max": 377.08, "episode_reward_min": -18.36288794092987, "episode_reward_mean": 168.04802241630313, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -592.2156844163691, "predator_policy": 0.8157791869470419}, "policy_reward_max": {"prey_policy": 195.18475317196396, "predator_policy": 613.0019755428475}, "policy_reward_mean": {"prey_policy": -169.50938986692904, "predator_policy": 253.53340107508055}, "custom_metrics": {}, "hist_stats": {"episode_reward": [278.536835386815, 178.2384071931324, 175.48855546917068, 96.51023594519467, 246.13084274918444, 124.76999999999992, 221.33640194961475, 121.6479388168257, 240.03442384664783, 76.65331922812537, 377.08, 343.70697500758615, 186.0322412108238, 9.639999999999969, 198.3875721036669, 90.00792601709931, 194.00000000000017, 237.76646608941914, 139.2791827626784, 202.98696669832398, 96.80439443415587, 33.57269088768547, 91.46037897974163, 189.93898228488055, 195.78095869594335, 12.774917015457849, 2.689999999999987, 221.5551668147006, 197.0725418467636, 251.48232830746971, 141.16999999999993, 276.8811282654492, 191.31156325647007, 292.1483332757809, 205.9001544713526, 184.40000000000003, 54.31239107733466, 144.833476990317, 307.8886704750488, 224.1029515958576, 135.1689776187965, 231.713332196121, -18.36288794092987, 59.4747394316308, 82.08856184124753, 241.6425783183286, 196.25231011020378, 0.6700000000000024, 221.6618440479428, 272.8127606168996, 179.99196441386243, 84.03375492362521, 321.34939224034565, 119.64508534558178, 193.65161909807523, 220.12428005593443, 184.28851130197728, 153.78117867515707, 74.25605886751566, 66.17602023698016, 170.7181990885785, 168.27763782355737, 368.60546741759117, 62.3248105450088, 290.7433870833298, 270.4106510685518, 137.29408373503065, 192.12620607203493, 297.80151154128566, 172.90579453248927, 138.8818592848006, 79.01240139488876, 90.87000000000013, 369.1579741975806, 107.62146504464386, 159.61788943421982, 110.9500000000004, 108.9244671662285, 78.21597761461578, 135.67952223419357, 300.11844912390035, 95.66464898189781, 22.371062734256913, 184.8181350244297, 73.29649170352849, 292.32, 163.95651818443173, 79.46000000000011, 373.7869333766748, 197.91034986946966, 262.93486524255746, 0.13767707898568737, 270.94705913106407, 157.60967673454337, 111.07000000000001, 126.95057603057779, 161.56661558958217, 181.8321131901976, 104.07636380757813, 59.099999999999994], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-97.22585982474646, 138.79001340315395, -83.5379087094166, 9.068221860884668, 11.769297611559509, -202.18837953712875, -61.042822468999, -494.0742781503876, -190.708231882579, 45.94665017583035, -392.2456364719696, -24.476986360912036, 97.87605877673064, -283.6833286070104, -469.74825973206595, 66.21312164406231, -61.60665558136242, -50.88159126091189, -437.83086721078996, -164.67293772113075, 160.92676873169563, 190.18047363927514, -4.164574629018375, 103.23007510204881, -239.68016195797296, -42.47988526842409, -351.4972108305239, -382.1618915602737, -253.12556794337715, 41.604501222592255, -82.63443865268394, -272.0726723870695, 165.93848218353065, -173.82791479131612, 133.35126132074868, -456.1449951139286, -128.56659505240714, -393.6548178157555, -166.92920872938555, 40.28935227624637, -202.97519520743478, -146.78872268374099, -421.62299439303365, -352.59655251167527, -450.99136769858757, -233.40712887716606, -5.264149525517453, -515.2200672313962, -102.7220593488081, -163.37188643106492, -310.0933635190805, -515.0089987889716, -334.5865230214216, -175.438429561263, 57.37881397388718, 3.3695188785359127, -104.4001417335156, -119.25898729608807, 102.27637053188319, -96.98180225062703, -373.6820403857835, 64.57043150111801, 77.28707979145965, -37.7026087642364, -191.80898791988196, -435.1741936873171, 30.21983983105216, -569.908906353893, 63.40287586648782, -388.37366981209095, -442.99354621187996, 183.33422081305295, -174.56548337877564, -275.9181028924651, 40.18601171812803, -351.1870321149044, -99.79587462489131, 41.934940535943916, 16.747654202482153, -352.55591592564986, -493.80281957767147, -217.04376663707848, -489.4829173912817, 78.08455568803755, -402.9951547086671, -505.3510686656849, -529.2608868643902, -245.8853514127806, -142.12853141141647, -29.561535017373217, -256.3263465310681, 98.17538696448992, 13.718286750828707, -134.3765137563368, -341.70777426980027, -397.23205430652916, -55.34542240001065, -389.63727789443004, -10.462881663046147, 48.7613461450279, -247.52670747121607, -6.060464141649767, -216.6681857892168, -375.4115603707681, -100.08871539575927, 109.65884917488461, -438.904632855675, -22.439965447566927, -361.60361501209684, 70.49636234218711, 50.933344816359394, -13.546353941135735, -332.98145650440415, 135.53465389888572, -92.3367711078272, -16.580821797132813, -127.6557724772716, -438.33787537475615, -142.16018499842613, -434.874686405554, -497.096657884668, -206.73618585213285, -337.6176571611693, -255.96349363122744, -142.2197242753613, 195.18475317196396, -518.6642012974872, -445.52918738270176, -183.27018990509526, 58.93353526828071, 6.695138456780045, -492.20185625141266, -123.09439021352213, -428.84086119148634, 11.818910430762081, -493.49482268700416, -592.2156844163691, 95.51348867109786, -446.96067381331443, -10.97636973143635, -364.93714545679734, -18.475630638166837, -433.3611997236299, -306.13131492187836, -33.88917797248489, -67.13852506709134, 163.56393980164813, 124.8554121004846, -317.58608166272523, -261.05417248754355, 7.029745804081074, -130.3336689815379, -201.3551814980646, -147.57308681368053, -242.30054081233064, -209.8249229184875, -167.8953492113285, -256.0749357732216, -304.39094369286784, -146.8767996219857, -188.16654071872736, -99.23707589587026, -191.982480421859, -164.38420100530942, -529.4696720528511, -190.5049885473146, -92.66754494853888, -37.13838124202459, -266.64032023575214, -43.064166501440795, 111.09448048980298, -25.270827116430695, -3.7956113942584864, -137.859694441309, -368.34271617246367, -102.09888707622738, 140.65997845492703, 163.66529858194173, -179.24013378779512, -292.83274455732925, 17.418489853440782, 142.74313792641433, -403.84479376622505, -360.7508960678808, -408.133566740931, -8.722068994196121, 16.02375909090111, -130.9630150342068, -443.67069561484266, -62.41594165305443, 63.27786855013822, -214.45428376183324, -94.8334188006135, -392.4042455820688, -214.03939238503875, -63.98676071767731, -110.02590707216294, -506.6124546988203, -438.0420490938377, -248.8981403637248], "policy_predator_policy_reward": [37.2849833565102, 199.68769845189735, 160.43343202997994, 92.27466201168362, 276.3930490906934, 89.51458830404673, 189.7645334770613, 461.86280308751907, 120.41757839153892, 270.4748460643942, 460.10645285869845, 81.38616997418234, 183.56603236216472, 223.57763941772993, 431.59550399024096, 93.58757291458855, 61.550594133573924, 290.972076555348, 466.77781123385756, 212.37931292618856, 25.073231268304383, 0.8995263607248897, 87.83171687780269, 156.80975765675305, 360.0343511248537, 108.15793731236722, 360.56721083052395, 382.7318915602739, 126.58972699335452, 283.3189118310974, 140.04339021937363, 304.67164683747893, 88.57616413531841, 113.31326847246729, 477.91404297809896, 82.64615690450005, 201.54130330002528, 459.9592923308159, 13.82255014798345, 315.80427300347975, 143.3600505747667, 303.2082617505648, 436.7130201074193, 371.0792176849749, 445.76285731472774, 330.0960182407673, 309.1132311908879, 401.3099678509058, 161.67340919967003, 300.2014952761461, 321.8082805345378, 516.0689987889715, 336.0465230214214, 176.66842956126214, 76.04976100072243, 84.75707296155527, 212.89663111012752, 207.83503976623956, 40.68899706301896, 205.4987629631944, 373.8520403857836, 76.42956849888196, 100.80387219051089, 136.4927850477151, 388.1563861703435, 430.1383586933258, 316.7077658672437, 515.1296339313786, 343.2860843690667, 187.58486404788843, 443.2435462118798, 0.8157791869470419, 295.35746848227274, 209.4385088663012, 337.2254767118839, 118.60902067520952, 212.66036207661762, 153.0892424873787, 242.11248236254386, 317.79873095648134, 473.51882368869576, 372.4967401448509, 487.3292640909557, 155.78242980840943, 495.65678420938696, 394.32655122403514, 529.2608868643902, 305.36009084441133, 213.18359873807066, 40.59502953196685, 62.377470017449674, 337.4160678674571, 65.95094980853484, 250.9595873071768, 342.18777426980006, 397.42205430652905, 343.80043602867516, 322.84410831370826, 129.15951414190343, 105.35478199301429, 431.0211707835584, 2.557965243169401, 176.9266352757486, 499.18686580786107, 180.78316319830583, 130.996095262914, 439.08463285567495, 141.90505079314866, 407.00165671023314, 77.7572150577518, 29.2254589799522, 153.51183020075845, 334.09145650440314, 47.64385740309186, 136.3158809333166, 126.38289064680049, 114.24101476057344, 526.00869195897, 317.36551351368956, 325.8453781272701, 399.33502116287883, 475.21602166250074, 309.19704523835816, 452.66174337759577, 201.06204137365393, 114.57839714733468, 505.15801980905053, 521.3601794161474, 250.47436586374502, 164.6056758563993, 268.86790194278416, 487.04946692040016, 232.92535802947168, 456.30397711056753, 60.80014278542976, 613.0019755428475, 319.3245247009507, 475.17918258560644, 440.6404628051875, 190.20237527205242, 415.39758750278725, 106.89704787697741, 424.9910468223185, 393.5138692180785, 73.00468505411293, 118.89301798546335, 33.182468331205214, 47.55615396424263, 531.665801200051, 154.59591799486122, 183.1807784247672, 99.74103418690956, 222.29518149806376, 237.58308681368047, 286.11848091252244, 274.9314499845235, 232.07120268249375, 270.11505991667053, 209.25519287208732, 377.6920726769598, 257.06913058362517, 330.45293515487253, 84.04876756297293, 367.98256284609306, 528.104760880636, 214.24096245378684, 167.18754494853908, 147.43651626645422, 313.53828333925867, 69.46269510146239, 45.055519510197, 161.44082711643054, 237.0262966889756, 68.58552733102371, 368.4127161724637, 181.48888707622754, 34.07880688656179, 35.382849453244255, 306.20934130241966, 363.7738869121747, 32.373031633162576, 70.40020582953977, 404.0796485485018, 360.65371836458974, 281.7207659401624, 406.0819289260285, 107.92786453476043, 164.62106814308913, 443.68069561484265, 173.4759416530544, 268.473986469911, 9.653004772361012, 445.6195893012102, 203.18469067105434, 384.32257905809587, 75.53568723481823, 458.8984166438635, 261.81630893469776, 438.1420490938377, 307.8981403637248]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6361165622918393, "mean_inference_ms": 3.1111827314114726, "mean_action_processing_ms": 0.24814278493199995, "mean_env_wait_ms": 0.2151429202918033, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00503230094909668, "StateBufferConnector_ms": 0.003548741340637207, "ViewRequirementAgentConnector_ms": 0.10998427867889404}, "num_episodes": 18, "episode_return_max": 377.08, "episode_return_min": -18.36288794092987, "episode_return_mean": 168.04802241630313, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 30.899600438519304, "num_env_steps_trained_throughput_per_sec": 30.899600438519304, "timesteps_total": 84000, "num_env_steps_sampled_lifetime": 84000, "num_agent_steps_sampled_lifetime": 336000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 336000, "timers": {"training_iteration_time_ms": 167536.495, "restore_workers_time_ms": 0.012, "training_step_time_ms": 167536.459, "sample_time_ms": 1996.596, "learn_time_ms": 165525.414, "learn_throughput": 24.165, "synch_weights_time_ms": 13.262}, "counters": {"num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000}, "done": false, "training_iteration": 21, "trial_id": "b941d_00000", "date": "2024-08-17_08-46-46", "timestamp": 1723864606, "time_this_iter_s": 129.4577112197876, "time_total_s": 3171.444398880005, "pid": 81115, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[32, [4, 4], 2], [64, [3, 3], 2], [128, [3, 3], 1]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [256, 256], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b04955e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3171.444398880005, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 19.132608695652173, "ram_util_percent": 75.8570652173913}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 21.63423994647132, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.00010000000000000003, "total_loss": 8.720995340145453, "policy_loss": -0.07428480951834923, "vf_loss": 8.778105159285207, "vf_explained_var": 0.252560815262416, "kl": 0.01696295803331821, "entropy": 1.202382199411039, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 40635.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.646459655534653, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.00010000000000000003, "total_loss": 7.504418498498422, "policy_loss": -0.057828484505548006, "vf_loss": 7.5461579017538245, "vf_explained_var": 0.11550015327791688, "kl": 0.015890455581233563, "entropy": 0.9722438225985834, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 40635.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 352000, "num_agent_steps_trained": 352000}, "env_runners": {"episode_reward_max": 373.7869333766748, "episode_reward_min": -18.36288794092987, "episode_reward_mean": 149.7906124235423, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -592.2156844163691, "predator_policy": 0.8157791869470419}, "policy_reward_max": {"prey_policy": 195.18475317196396, "predator_policy": 613.0019755428475}, "policy_reward_mean": {"prey_policy": -192.64453177759168, "predator_policy": 267.5398379893628}, "custom_metrics": {}, "hist_stats": {"episode_reward": [139.2791827626784, 202.98696669832398, 96.80439443415587, 33.57269088768547, 91.46037897974163, 189.93898228488055, 195.78095869594335, 12.774917015457849, 2.689999999999987, 221.5551668147006, 197.0725418467636, 251.48232830746971, 141.16999999999993, 276.8811282654492, 191.31156325647007, 292.1483332757809, 205.9001544713526, 184.40000000000003, 54.31239107733466, 144.833476990317, 307.8886704750488, 224.1029515958576, 135.1689776187965, 231.713332196121, -18.36288794092987, 59.4747394316308, 82.08856184124753, 241.6425783183286, 196.25231011020378, 0.6700000000000024, 221.6618440479428, 272.8127606168996, 179.99196441386243, 84.03375492362521, 321.34939224034565, 119.64508534558178, 193.65161909807523, 220.12428005593443, 184.28851130197728, 153.78117867515707, 74.25605886751566, 66.17602023698016, 170.7181990885785, 168.27763782355737, 368.60546741759117, 62.3248105450088, 290.7433870833298, 270.4106510685518, 137.29408373503065, 192.12620607203493, 297.80151154128566, 172.90579453248927, 138.8818592848006, 79.01240139488876, 90.87000000000013, 369.1579741975806, 107.62146504464386, 159.61788943421982, 110.9500000000004, 108.9244671662285, 78.21597761461578, 135.67952223419357, 300.11844912390035, 95.66464898189781, 22.371062734256913, 184.8181350244297, 73.29649170352849, 292.32, 163.95651818443173, 79.46000000000011, 373.7869333766748, 197.91034986946966, 262.93486524255746, 0.13767707898568737, 270.94705913106407, 157.60967673454337, 111.07000000000001, 126.95057603057779, 161.56661558958217, 181.8321131901976, 104.07636380757813, 59.099999999999994, 78.99969754164472, 96.14333488063178, 74.64960396102013, 15.67, 100.67940037272254, 161.50224028450367, 84.74710172605968, 44.310481481247336, 7.569424864233357, 180.40404623471161, 272.11, 142.22610178105572, 3.7699999999999636, -0.9453199118986895, 33.9706071464658, 15.892379100810523, 72.13648143441327, 186.39156083959483], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-128.56659505240714, -393.6548178157555, -166.92920872938555, 40.28935227624637, -202.97519520743478, -146.78872268374099, -421.62299439303365, -352.59655251167527, -450.99136769858757, -233.40712887716606, -5.264149525517453, -515.2200672313962, -102.7220593488081, -163.37188643106492, -310.0933635190805, -515.0089987889716, -334.5865230214216, -175.438429561263, 57.37881397388718, 3.3695188785359127, -104.4001417335156, -119.25898729608807, 102.27637053188319, -96.98180225062703, -373.6820403857835, 64.57043150111801, 77.28707979145965, -37.7026087642364, -191.80898791988196, -435.1741936873171, 30.21983983105216, -569.908906353893, 63.40287586648782, -388.37366981209095, -442.99354621187996, 183.33422081305295, -174.56548337877564, -275.9181028924651, 40.18601171812803, -351.1870321149044, -99.79587462489131, 41.934940535943916, 16.747654202482153, -352.55591592564986, -493.80281957767147, -217.04376663707848, -489.4829173912817, 78.08455568803755, -402.9951547086671, -505.3510686656849, -529.2608868643902, -245.8853514127806, -142.12853141141647, -29.561535017373217, -256.3263465310681, 98.17538696448992, 13.718286750828707, -134.3765137563368, -341.70777426980027, -397.23205430652916, -55.34542240001065, -389.63727789443004, -10.462881663046147, 48.7613461450279, -247.52670747121607, -6.060464141649767, -216.6681857892168, -375.4115603707681, -100.08871539575927, 109.65884917488461, -438.904632855675, -22.439965447566927, -361.60361501209684, 70.49636234218711, 50.933344816359394, -13.546353941135735, -332.98145650440415, 135.53465389888572, -92.3367711078272, -16.580821797132813, -127.6557724772716, -438.33787537475615, -142.16018499842613, -434.874686405554, -497.096657884668, -206.73618585213285, -337.6176571611693, -255.96349363122744, -142.2197242753613, 195.18475317196396, -518.6642012974872, -445.52918738270176, -183.27018990509526, 58.93353526828071, 6.695138456780045, -492.20185625141266, -123.09439021352213, -428.84086119148634, 11.818910430762081, -493.49482268700416, -592.2156844163691, 95.51348867109786, -446.96067381331443, -10.97636973143635, -364.93714545679734, -18.475630638166837, -433.3611997236299, -306.13131492187836, -33.88917797248489, -67.13852506709134, 163.56393980164813, 124.8554121004846, -317.58608166272523, -261.05417248754355, 7.029745804081074, -130.3336689815379, -201.3551814980646, -147.57308681368053, -242.30054081233064, -209.8249229184875, -167.8953492113285, -256.0749357732216, -304.39094369286784, -146.8767996219857, -188.16654071872736, -99.23707589587026, -191.982480421859, -164.38420100530942, -529.4696720528511, -190.5049885473146, -92.66754494853888, -37.13838124202459, -266.64032023575214, -43.064166501440795, 111.09448048980298, -25.270827116430695, -3.7956113942584864, -137.859694441309, -368.34271617246367, -102.09888707622738, 140.65997845492703, 163.66529858194173, -179.24013378779512, -292.83274455732925, 17.418489853440782, 142.74313792641433, -403.84479376622505, -360.7508960678808, -408.133566740931, -8.722068994196121, 16.02375909090111, -130.9630150342068, -443.67069561484266, -62.41594165305443, 63.27786855013822, -214.45428376183324, -94.8334188006135, -392.4042455820688, -214.03939238503875, -63.98676071767731, -110.02590707216294, -506.6124546988203, -438.0420490938377, -248.8981403637248, -420.2326604842819, -214.556688599817, -246.717529480201, -303.47896952400384, -236.07370563320018, -228.3544171332062, -438.9868234586223, -417.1314333618487, -291.65481017833974, -166.94476057671514, -141.02400462203556, -341.00364401576417, -55.78068770061539, -384.82390631421976, -353.1838124348255, -443.14418430779193, -584.5902169818607, -461.88638713287713, -484.13978400013536, -70.81600015531771, 109.3767904693522, -98.91830081619972, -55.55298555077524, 91.85574472407696, -33.01145479819561, 1.03135035059203, -208.86370368079494, -279.0528037866018, -113.41360999927312, -309.38250144497056, -358.9798771548713, -277.2616207617993, -158.21345001922234, -502.1376856187929, -414.18603937774463, 157.38806044647023], "policy_predator_policy_reward": [201.54130330002528, 459.9592923308159, 13.82255014798345, 315.80427300347975, 143.3600505747667, 303.2082617505648, 436.7130201074193, 371.0792176849749, 445.76285731472774, 330.0960182407673, 309.1132311908879, 401.3099678509058, 161.67340919967003, 300.2014952761461, 321.8082805345378, 516.0689987889715, 336.0465230214214, 176.66842956126214, 76.04976100072243, 84.75707296155527, 212.89663111012752, 207.83503976623956, 40.68899706301896, 205.4987629631944, 373.8520403857836, 76.42956849888196, 100.80387219051089, 136.4927850477151, 388.1563861703435, 430.1383586933258, 316.7077658672437, 515.1296339313786, 343.2860843690667, 187.58486404788843, 443.2435462118798, 0.8157791869470419, 295.35746848227274, 209.4385088663012, 337.2254767118839, 118.60902067520952, 212.66036207661762, 153.0892424873787, 242.11248236254386, 317.79873095648134, 473.51882368869576, 372.4967401448509, 487.3292640909557, 155.78242980840943, 495.65678420938696, 394.32655122403514, 529.2608868643902, 305.36009084441133, 213.18359873807066, 40.59502953196685, 62.377470017449674, 337.4160678674571, 65.95094980853484, 250.9595873071768, 342.18777426980006, 397.42205430652905, 343.80043602867516, 322.84410831370826, 129.15951414190343, 105.35478199301429, 431.0211707835584, 2.557965243169401, 176.9266352757486, 499.18686580786107, 180.78316319830583, 130.996095262914, 439.08463285567495, 141.90505079314866, 407.00165671023314, 77.7572150577518, 29.2254589799522, 153.51183020075845, 334.09145650440314, 47.64385740309186, 136.3158809333166, 126.38289064680049, 114.24101476057344, 526.00869195897, 317.36551351368956, 325.8453781272701, 399.33502116287883, 475.21602166250074, 309.19704523835816, 452.66174337759577, 201.06204137365393, 114.57839714733468, 505.15801980905053, 521.3601794161474, 250.47436586374502, 164.6056758563993, 268.86790194278416, 487.04946692040016, 232.92535802947168, 456.30397711056753, 60.80014278542976, 613.0019755428475, 319.3245247009507, 475.17918258560644, 440.6404628051875, 190.20237527205242, 415.39758750278725, 106.89704787697741, 424.9910468223185, 393.5138692180785, 73.00468505411293, 118.89301798546335, 33.182468331205214, 47.55615396424263, 531.665801200051, 154.59591799486122, 183.1807784247672, 99.74103418690956, 222.29518149806376, 237.58308681368047, 286.11848091252244, 274.9314499845235, 232.07120268249375, 270.11505991667053, 209.25519287208732, 377.6920726769598, 257.06913058362517, 330.45293515487253, 84.04876756297293, 367.98256284609306, 528.104760880636, 214.24096245378684, 167.18754494853908, 147.43651626645422, 313.53828333925867, 69.46269510146239, 45.055519510197, 161.44082711643054, 237.0262966889756, 68.58552733102371, 368.4127161724637, 181.48888707622754, 34.07880688656179, 35.382849453244255, 306.20934130241966, 363.7738869121747, 32.373031633162576, 70.40020582953977, 404.0796485485018, 360.65371836458974, 281.7207659401624, 406.0819289260285, 107.92786453476043, 164.62106814308913, 443.68069561484265, 173.4759416530544, 268.473986469911, 9.653004772361012, 445.6195893012102, 203.18469067105434, 384.32257905809587, 75.53568723481823, 458.8984166438635, 261.81630893469776, 438.1420490938377, 307.8981403637248, 423.62674264150843, 290.1623039842352, 402.12203208856664, 244.21780179626967, 118.72687779864108, 420.350848928785, 439.56682345862185, 432.2214333618486, 347.6723999351865, 211.60657119259088, 399.92984741101066, 243.60004151129257, 128.96529744031915, 396.38639830057565, 377.1614137585296, 463.4770644653352, 511.1328643701331, 542.9131646088382, 491.08253933120716, 244.27729105895818, 64.6332095306478, 197.01830081619963, 26.85203222545269, 79.0713103823011, 34.791454798195254, 0.9586496494079713, 324.95323916568105, 162.01794838981607, 183.97679734402627, 272.7899212466838, 116.15499521965597, 535.9788817978243, 281.939217356841, 450.54839971558744, 16.433963649115853, 426.7555761217537]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6356848498988938, "mean_inference_ms": 3.1128157665803906, "mean_action_processing_ms": 0.24797763262625458, "mean_env_wait_ms": 0.21512949254644917, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005108833312988281, "StateBufferConnector_ms": 0.0035653114318847656, "ViewRequirementAgentConnector_ms": 0.11075735092163086}, "num_episodes": 18, "episode_return_max": 373.7869333766748, "episode_return_min": -18.36288794092987, "episode_return_mean": 149.7906124235423, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 352000, "num_agent_steps_trained": 352000, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 2.4406060637912685, "num_env_steps_trained_throughput_per_sec": 2.4406060637912685, "timesteps_total": 88000, "num_env_steps_sampled_lifetime": 88000, "num_agent_steps_sampled_lifetime": 352000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 352000, "timers": {"training_iteration_time_ms": 318662.117, "restore_workers_time_ms": 0.012, "training_step_time_ms": 318662.08, "sample_time_ms": 2008.56, "learn_time_ms": 316638.585, "learn_throughput": 12.633, "synch_weights_time_ms": 13.52}, "counters": {"num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 352000, "num_agent_steps_trained": 352000}, "done": false, "training_iteration": 22, "trial_id": "b941d_00000", "date": "2024-08-17_09-14-05", "timestamp": 1723866245, "time_this_iter_s": 1638.9679300785065, "time_total_s": 4810.412328958511, "pid": 81115, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[32, [4, 4], 2], [64, [3, 3], 2], [128, [3, 3], 1]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [256, 256], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b04a9040>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4810.412328958511, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 22.33636363636364, "ram_util_percent": 77.0855614973262}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 20.796616142389006, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.00010000000000000003, "total_loss": 8.530051341637101, "policy_loss": -0.09119680781760031, "vf_loss": 8.60238169337076, "vf_explained_var": 0.3593476109088413, "kl": 0.018633511340767638, "entropy": 1.1913320771600835, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 42525.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.462171901218475, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.00010000000000000003, "total_loss": 7.746827448234356, "policy_loss": -0.06841938750690253, "vf_loss": 7.797650863001587, "vf_explained_var": 0.1148186928380734, "kl": 0.01737875010958019, "entropy": 0.9801124266531102, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 42525.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 368000, "num_agent_steps_trained": 368000}, "env_runners": {"episode_reward_max": 373.7869333766748, "episode_reward_min": -9.40850080635774, "episode_reward_mean": 135.34366018281148, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -592.2156844163691, "predator_policy": 0.9586496494079713}, "policy_reward_max": {"prey_policy": 195.18475317196396, "predator_policy": 613.0019755428475}, "policy_reward_mean": {"prey_policy": -194.80081458111556, "predator_policy": 262.4726446725212}, "custom_metrics": {}, "hist_stats": {"episode_reward": [241.6425783183286, 196.25231011020378, 0.6700000000000024, 221.6618440479428, 272.8127606168996, 179.99196441386243, 84.03375492362521, 321.34939224034565, 119.64508534558178, 193.65161909807523, 220.12428005593443, 184.28851130197728, 153.78117867515707, 74.25605886751566, 66.17602023698016, 170.7181990885785, 168.27763782355737, 368.60546741759117, 62.3248105450088, 290.7433870833298, 270.4106510685518, 137.29408373503065, 192.12620607203493, 297.80151154128566, 172.90579453248927, 138.8818592848006, 79.01240139488876, 90.87000000000013, 369.1579741975806, 107.62146504464386, 159.61788943421982, 110.9500000000004, 108.9244671662285, 78.21597761461578, 135.67952223419357, 300.11844912390035, 95.66464898189781, 22.371062734256913, 184.8181350244297, 73.29649170352849, 292.32, 163.95651818443173, 79.46000000000011, 373.7869333766748, 197.91034986946966, 262.93486524255746, 0.13767707898568737, 270.94705913106407, 157.60967673454337, 111.07000000000001, 126.95057603057779, 161.56661558958217, 181.8321131901976, 104.07636380757813, 59.099999999999994, 78.99969754164472, 96.14333488063178, 74.64960396102013, 15.67, 100.67940037272254, 161.50224028450367, 84.74710172605968, 44.310481481247336, 7.569424864233357, 180.40404623471161, 272.11, 142.22610178105572, 3.7699999999999636, -0.9453199118986895, 33.9706071464658, 15.892379100810523, 72.13648143441327, 186.39156083959483, 138.75157396441625, 124.33013652743902, 40.59153707821733, 109.79742528356685, 268.4700492510068, -9.40850080635774, 164.23335332953863, 48.36710182566816, 11.575871804224958, 26.73359055844261, 153.01143582827635, 161.95033091180628, 58.71396293381008, 151.36608316970518, 105.28011010461948, 90.89050671028016, -5.590091285881241, 29.29091783635554, 100.97734483598875, 51.11940234675088, 195.35295777389095, 39.63579363337524, 9.42612480590286, 182.92797063102563, 112.22651184097865, 164.4231763161489, 179.2899999999999], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-256.3263465310681, 98.17538696448992, 13.718286750828707, -134.3765137563368, -341.70777426980027, -397.23205430652916, -55.34542240001065, -389.63727789443004, -10.462881663046147, 48.7613461450279, -247.52670747121607, -6.060464141649767, -216.6681857892168, -375.4115603707681, -100.08871539575927, 109.65884917488461, -438.904632855675, -22.439965447566927, -361.60361501209684, 70.49636234218711, 50.933344816359394, -13.546353941135735, -332.98145650440415, 135.53465389888572, -92.3367711078272, -16.580821797132813, -127.6557724772716, -438.33787537475615, -142.16018499842613, -434.874686405554, -497.096657884668, -206.73618585213285, -337.6176571611693, -255.96349363122744, -142.2197242753613, 195.18475317196396, -518.6642012974872, -445.52918738270176, -183.27018990509526, 58.93353526828071, 6.695138456780045, -492.20185625141266, -123.09439021352213, -428.84086119148634, 11.818910430762081, -493.49482268700416, -592.2156844163691, 95.51348867109786, -446.96067381331443, -10.97636973143635, -364.93714545679734, -18.475630638166837, -433.3611997236299, -306.13131492187836, -33.88917797248489, -67.13852506709134, 163.56393980164813, 124.8554121004846, -317.58608166272523, -261.05417248754355, 7.029745804081074, -130.3336689815379, -201.3551814980646, -147.57308681368053, -242.30054081233064, -209.8249229184875, -167.8953492113285, -256.0749357732216, -304.39094369286784, -146.8767996219857, -188.16654071872736, -99.23707589587026, -191.982480421859, -164.38420100530942, -529.4696720528511, -190.5049885473146, -92.66754494853888, -37.13838124202459, -266.64032023575214, -43.064166501440795, 111.09448048980298, -25.270827116430695, -3.7956113942584864, -137.859694441309, -368.34271617246367, -102.09888707622738, 140.65997845492703, 163.66529858194173, -179.24013378779512, -292.83274455732925, 17.418489853440782, 142.74313792641433, -403.84479376622505, -360.7508960678808, -408.133566740931, -8.722068994196121, 16.02375909090111, -130.9630150342068, -443.67069561484266, -62.41594165305443, 63.27786855013822, -214.45428376183324, -94.8334188006135, -392.4042455820688, -214.03939238503875, -63.98676071767731, -110.02590707216294, -506.6124546988203, -438.0420490938377, -248.8981403637248, -420.2326604842819, -214.556688599817, -246.717529480201, -303.47896952400384, -236.07370563320018, -228.3544171332062, -438.9868234586223, -417.1314333618487, -291.65481017833974, -166.94476057671514, -141.02400462203556, -341.00364401576417, -55.78068770061539, -384.82390631421976, -353.1838124348255, -443.14418430779193, -584.5902169818607, -461.88638713287713, -484.13978400013536, -70.81600015531771, 109.3767904693522, -98.91830081619972, -55.55298555077524, 91.85574472407696, -33.01145479819561, 1.03135035059203, -208.86370368079494, -279.0528037866018, -113.41360999927312, -309.38250144497056, -358.9798771548713, -277.2616207617993, -158.21345001922234, -502.1376856187929, -414.18603937774463, 157.38806044647023, -105.75544631546461, 28.711889587814767, -389.74555026143787, 42.429261001910014, -220.48172142819726, -332.2052031389666, -365.8645211828366, -157.44134040085987, 116.72001896094785, -38.310482922775165, -211.6314157775121, -286.88615021375153, -149.75993776770144, -131.7262779518614, -28.77753166142869, -326.78502147049204, -362.4365165010618, -308.51149471718054, -268.8194491144774, -140.458175155593, -16.34560550540122, -436.97888389408484, 103.73375762680878, -390.47268228430517, -140.93059983514638, -497.6547170881446, -398.1787225486772, -110.65201067512439, -267.71216669094133, -248.59620084573848, 4.790938533556983, -453.20180643171295, -404.44338705497074, -388.9805334475776, -71.65941295248601, -562.8224590328085, -1.680458237383814, -336.862183923384, -230.32817727774298, -124.46918747036361, -339.68072326504983, 65.53454580427568, -380.91448820515967, -557.1394775940868, -190.5586630944687, -49.53987808898055, 77.28826146862879, -519.9364886957433, -85.6632017296366, -142.10346790452695, -76.17623390987676, -203.36074116325358, 79.24770821562048, -387.0498669026938], "policy_predator_policy_reward": [62.377470017449674, 337.4160678674571, 65.95094980853484, 250.9595873071768, 342.18777426980006, 397.42205430652905, 343.80043602867516, 322.84410831370826, 129.15951414190343, 105.35478199301429, 431.0211707835584, 2.557965243169401, 176.9266352757486, 499.18686580786107, 180.78316319830583, 130.996095262914, 439.08463285567495, 141.90505079314866, 407.00165671023314, 77.7572150577518, 29.2254589799522, 153.51183020075845, 334.09145650440314, 47.64385740309186, 136.3158809333166, 126.38289064680049, 114.24101476057344, 526.00869195897, 317.36551351368956, 325.8453781272701, 399.33502116287883, 475.21602166250074, 309.19704523835816, 452.66174337759577, 201.06204137365393, 114.57839714733468, 505.15801980905053, 521.3601794161474, 250.47436586374502, 164.6056758563993, 268.86790194278416, 487.04946692040016, 232.92535802947168, 456.30397711056753, 60.80014278542976, 613.0019755428475, 319.3245247009507, 475.17918258560644, 440.6404628051875, 190.20237527205242, 415.39758750278725, 106.89704787697741, 424.9910468223185, 393.5138692180785, 73.00468505411293, 118.89301798546335, 33.182468331205214, 47.55615396424263, 531.665801200051, 154.59591799486122, 183.1807784247672, 99.74103418690956, 222.29518149806376, 237.58308681368047, 286.11848091252244, 274.9314499845235, 232.07120268249375, 270.11505991667053, 209.25519287208732, 377.6920726769598, 257.06913058362517, 330.45293515487253, 84.04876756297293, 367.98256284609306, 528.104760880636, 214.24096245378684, 167.18754494853908, 147.43651626645422, 313.53828333925867, 69.46269510146239, 45.055519510197, 161.44082711643054, 237.0262966889756, 68.58552733102371, 368.4127161724637, 181.48888707622754, 34.07880688656179, 35.382849453244255, 306.20934130241966, 363.7738869121747, 32.373031633162576, 70.40020582953977, 404.0796485485018, 360.65371836458974, 281.7207659401624, 406.0819289260285, 107.92786453476043, 164.62106814308913, 443.68069561484265, 173.4759416530544, 268.473986469911, 9.653004772361012, 445.6195893012102, 203.18469067105434, 384.32257905809587, 75.53568723481823, 458.8984166438635, 261.81630893469776, 438.1420490938377, 307.8981403637248, 423.62674264150843, 290.1623039842352, 402.12203208856664, 244.21780179626967, 118.72687779864108, 420.350848928785, 439.56682345862185, 432.2214333618486, 347.6723999351865, 211.60657119259088, 399.92984741101066, 243.60004151129257, 128.96529744031915, 396.38639830057565, 377.1614137585296, 463.4770644653352, 511.1328643701331, 542.9131646088382, 491.08253933120716, 244.27729105895818, 64.6332095306478, 197.01830081619963, 26.85203222545269, 79.0713103823011, 34.791454798195254, 0.9586496494079713, 324.95323916568105, 162.01794838981607, 183.97679734402627, 272.7899212466838, 116.15499521965597, 535.9788817978243, 281.939217356841, 450.54839971558744, 16.433963649115853, 426.7555761217537, 139.31889681992675, 76.47623387213973, 333.52266416422054, 138.12376162274597, 321.4618805636348, 271.8165810817451, 391.401052884583, 241.70223398268047, 88.93657794474444, 101.12393526808961, 346.4380130374312, 142.67105214747505, 416.20257374688055, 29.51699530222094, 244.3924746879788, 159.53718026961056, 458.0062605687095, 224.51762245375753, 296.4286421469886, 139.582572681523, 231.49298378214556, 374.84294144561716, 366.7723172373459, 81.9169383319569, 269.2824601181117, 428.0168197389887, 303.251641547658, 356.9451748458483, 305.0594037750644, 316.52907386623394, 83.00873458470289, 456.29264002373276, 310.6841987206796, 477.1496304959871, 566.6211415817796, 97.1516482398705, 85.07615080682432, 354.44383618993237, 306.48932086315807, 99.42744623169891, 325.76064243897173, 143.73849279569313, 415.517963386127, 562.1717960464945, 107.79450515481273, 141.73016083453808, 86.1662403658392, 539.4099574923008, 275.5579355628517, 64.4352459122908, 291.8484290346215, 152.11172235465773, 31.56948147767466, 455.52267720939847]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.636804398911731, "mean_inference_ms": 23.23495236000755, "mean_action_processing_ms": 0.24814823312101347, "mean_env_wait_ms": 3.082399328259554, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005598783493041992, "StateBufferConnector_ms": 0.003775954246520996, "ViewRequirementAgentConnector_ms": 0.1123272180557251}, "num_episodes": 27, "episode_return_max": 373.7869333766748, "episode_return_min": -9.40850080635774, "episode_return_mean": 135.34366018281148, "episodes_this_iter": 27}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 368000, "num_agent_steps_trained": 368000, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 0.7000418648102484, "num_env_steps_trained_throughput_per_sec": 0.7000418648102484, "timesteps_total": 92000, "num_env_steps_sampled_lifetime": 92000, "num_agent_steps_sampled_lifetime": 368000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 368000, "timers": {"training_iteration_time_ms": 877147.146, "restore_workers_time_ms": 0.012, "training_step_time_ms": 877147.102, "sample_time_ms": 99976.246, "learn_time_ms": 777154.524, "learn_throughput": 5.147, "synch_weights_time_ms": 14.641}, "counters": {"num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 368000, "num_agent_steps_trained": 368000}, "done": false, "training_iteration": 23, "trial_id": "b941d_00000", "date": "2024-08-17_10-49-19", "timestamp": 1723871959, "time_this_iter_s": 5713.998739004135, "time_total_s": 10524.411067962646, "pid": 81115, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[32, [4, 4], 2], [64, [3, 3], 2], [128, [3, 3], 1]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [256, 256], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b04a9550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 10524.411067962646, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 24.120207253886015, "ram_util_percent": 80.12487046632124}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 19.1423943364431, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.00010000000000000003, "total_loss": 7.900258206311988, "policy_loss": -0.07839980735184832, "vf_loss": 7.960990202363837, "vf_explained_var": 0.2281259721864468, "kl": 0.01744969442258706, "entropy": 1.185712985449998, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 44415.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.151119153587906, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.00010000000000000003, "total_loss": 7.689113393157879, "policy_loss": -0.053126830428533216, "vf_loss": 7.727901372203121, "vf_explained_var": 0.1195963113396256, "kl": 0.014161808731698049, "entropy": 0.9800349458815559, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 44415.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000}, "env_runners": {"episode_reward_max": 373.7869333766748, "episode_reward_min": -9.40850080635774, "episode_reward_mean": 120.66356215556692, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -592.2156844163691, "predator_policy": 0.9586496494079713}, "policy_reward_max": {"prey_policy": 163.66529858194173, "predator_policy": 613.0019755428475}, "policy_reward_mean": {"prey_policy": -206.79044024145765, "predator_policy": 267.1222213192411}, "custom_metrics": {}, "hist_stats": {"episode_reward": [62.3248105450088, 290.7433870833298, 270.4106510685518, 137.29408373503065, 192.12620607203493, 297.80151154128566, 172.90579453248927, 138.8818592848006, 79.01240139488876, 90.87000000000013, 369.1579741975806, 107.62146504464386, 159.61788943421982, 110.9500000000004, 108.9244671662285, 78.21597761461578, 135.67952223419357, 300.11844912390035, 95.66464898189781, 22.371062734256913, 184.8181350244297, 73.29649170352849, 292.32, 163.95651818443173, 79.46000000000011, 373.7869333766748, 197.91034986946966, 262.93486524255746, 0.13767707898568737, 270.94705913106407, 157.60967673454337, 111.07000000000001, 126.95057603057779, 161.56661558958217, 181.8321131901976, 104.07636380757813, 59.099999999999994, 78.99969754164472, 96.14333488063178, 74.64960396102013, 15.67, 100.67940037272254, 161.50224028450367, 84.74710172605968, 44.310481481247336, 7.569424864233357, 180.40404623471161, 272.11, 142.22610178105572, 3.7699999999999636, -0.9453199118986895, 33.9706071464658, 15.892379100810523, 72.13648143441327, 186.39156083959483, 138.75157396441625, 124.33013652743902, 40.59153707821733, 109.79742528356685, 268.4700492510068, -9.40850080635774, 164.23335332953863, 48.36710182566816, 11.575871804224958, 26.73359055844261, 153.01143582827635, 161.95033091180628, 58.71396293381008, 151.36608316970518, 105.28011010461948, 90.89050671028016, -5.590091285881241, 29.29091783635554, 100.97734483598875, 51.11940234675088, 195.35295777389095, 39.63579363337524, 9.42612480590286, 182.92797063102563, 112.22651184097865, 164.4231763161489, 179.2899999999999, 115.0454309037798, 171.2942669875233, 78.78178761646933, 177.8450846391125, 157.82033557585748, 3.069999999999977, 13.20999999999997, 1.6257763408382186, 41.31067794995509, 42.224114892451, 144.33000000000018, 112.56600248253076, 92.99999999999996, 132.90269093750746, 117.51065188283211, 20.823440000697467, 296.08, 50.48859964814615], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-518.6642012974872, -445.52918738270176, -183.27018990509526, 58.93353526828071, 6.695138456780045, -492.20185625141266, -123.09439021352213, -428.84086119148634, 11.818910430762081, -493.49482268700416, -592.2156844163691, 95.51348867109786, -446.96067381331443, -10.97636973143635, -364.93714545679734, -18.475630638166837, -433.3611997236299, -306.13131492187836, -33.88917797248489, -67.13852506709134, 163.56393980164813, 124.8554121004846, -317.58608166272523, -261.05417248754355, 7.029745804081074, -130.3336689815379, -201.3551814980646, -147.57308681368053, -242.30054081233064, -209.8249229184875, -167.8953492113285, -256.0749357732216, -304.39094369286784, -146.8767996219857, -188.16654071872736, -99.23707589587026, -191.982480421859, -164.38420100530942, -529.4696720528511, -190.5049885473146, -92.66754494853888, -37.13838124202459, -266.64032023575214, -43.064166501440795, 111.09448048980298, -25.270827116430695, -3.7956113942584864, -137.859694441309, -368.34271617246367, -102.09888707622738, 140.65997845492703, 163.66529858194173, -179.24013378779512, -292.83274455732925, 17.418489853440782, 142.74313792641433, -403.84479376622505, -360.7508960678808, -408.133566740931, -8.722068994196121, 16.02375909090111, -130.9630150342068, -443.67069561484266, -62.41594165305443, 63.27786855013822, -214.45428376183324, -94.8334188006135, -392.4042455820688, -214.03939238503875, -63.98676071767731, -110.02590707216294, -506.6124546988203, -438.0420490938377, -248.8981403637248, -420.2326604842819, -214.556688599817, -246.717529480201, -303.47896952400384, -236.07370563320018, -228.3544171332062, -438.9868234586223, -417.1314333618487, -291.65481017833974, -166.94476057671514, -141.02400462203556, -341.00364401576417, -55.78068770061539, -384.82390631421976, -353.1838124348255, -443.14418430779193, -584.5902169818607, -461.88638713287713, -484.13978400013536, -70.81600015531771, 109.3767904693522, -98.91830081619972, -55.55298555077524, 91.85574472407696, -33.01145479819561, 1.03135035059203, -208.86370368079494, -279.0528037866018, -113.41360999927312, -309.38250144497056, -358.9798771548713, -277.2616207617993, -158.21345001922234, -502.1376856187929, -414.18603937774463, 157.38806044647023, -105.75544631546461, 28.711889587814767, -389.74555026143787, 42.429261001910014, -220.48172142819726, -332.2052031389666, -365.8645211828366, -157.44134040085987, 116.72001896094785, -38.310482922775165, -211.6314157775121, -286.88615021375153, -149.75993776770144, -131.7262779518614, -28.77753166142869, -326.78502147049204, -362.4365165010618, -308.51149471718054, -268.8194491144774, -140.458175155593, -16.34560550540122, -436.97888389408484, 103.73375762680878, -390.47268228430517, -140.93059983514638, -497.6547170881446, -398.1787225486772, -110.65201067512439, -267.71216669094133, -248.59620084573848, 4.790938533556983, -453.20180643171295, -404.44338705497074, -388.9805334475776, -71.65941295248601, -562.8224590328085, -1.680458237383814, -336.862183923384, -230.32817727774298, -124.46918747036361, -339.68072326504983, 65.53454580427568, -380.91448820515967, -557.1394775940868, -190.5586630944687, -49.53987808898055, 77.28826146862879, -519.9364886957433, -85.6632017296366, -142.10346790452695, -76.17623390987676, -203.36074116325358, 79.24770821562048, -387.0498669026938, -124.23264177684277, -136.3661945623164, -324.2093736287483, 15.722012696349395, -162.45415209052882, -210.477307836059, -404.21590960600196, -145.72754771167726, -310.13661731618396, -126.0131934661816, 0.4802636819880927, -423.07481754113246, -69.88309601833484, -238.1389667447093, -435.7676720342514, -428.0801854859512, -316.39725932280606, -531.6388905753067, -7.2557475168486985, -378.55799260308487, 124.5508172523206, -256.00438681162217, -588.5041275525565, -190.06325167658775, -190.6118160586258, 2.0000000000000013, -484.94332726894874, 2.0000000000000013, -204.80537341267475, -453.5247293375647, -118.58446630914297, -162.51475348921244, -68.15785299454853, 145.78508533403186, -438.0710567671098, -429.4873789691641], "policy_predator_policy_reward": [505.15801980905053, 521.3601794161474, 250.47436586374502, 164.6056758563993, 268.86790194278416, 487.04946692040016, 232.92535802947168, 456.30397711056753, 60.80014278542976, 613.0019755428475, 319.3245247009507, 475.17918258560644, 440.6404628051875, 190.20237527205242, 415.39758750278725, 106.89704787697741, 424.9910468223185, 393.5138692180785, 73.00468505411293, 118.89301798546335, 33.182468331205214, 47.55615396424263, 531.665801200051, 154.59591799486122, 183.1807784247672, 99.74103418690956, 222.29518149806376, 237.58308681368047, 286.11848091252244, 274.9314499845235, 232.07120268249375, 270.11505991667053, 209.25519287208732, 377.6920726769598, 257.06913058362517, 330.45293515487253, 84.04876756297293, 367.98256284609306, 528.104760880636, 214.24096245378684, 167.18754494853908, 147.43651626645422, 313.53828333925867, 69.46269510146239, 45.055519510197, 161.44082711643054, 237.0262966889756, 68.58552733102371, 368.4127161724637, 181.48888707622754, 34.07880688656179, 35.382849453244255, 306.20934130241966, 363.7738869121747, 32.373031633162576, 70.40020582953977, 404.0796485485018, 360.65371836458974, 281.7207659401624, 406.0819289260285, 107.92786453476043, 164.62106814308913, 443.68069561484265, 173.4759416530544, 268.473986469911, 9.653004772361012, 445.6195893012102, 203.18469067105434, 384.32257905809587, 75.53568723481823, 458.8984166438635, 261.81630893469776, 438.1420490938377, 307.8981403637248, 423.62674264150843, 290.1623039842352, 402.12203208856664, 244.21780179626967, 118.72687779864108, 420.350848928785, 439.56682345862185, 432.2214333618486, 347.6723999351865, 211.60657119259088, 399.92984741101066, 243.60004151129257, 128.96529744031915, 396.38639830057565, 377.1614137585296, 463.4770644653352, 511.1328643701331, 542.9131646088382, 491.08253933120716, 244.27729105895818, 64.6332095306478, 197.01830081619963, 26.85203222545269, 79.0713103823011, 34.791454798195254, 0.9586496494079713, 324.95323916568105, 162.01794838981607, 183.97679734402627, 272.7899212466838, 116.15499521965597, 535.9788817978243, 281.939217356841, 450.54839971558744, 16.433963649115853, 426.7555761217537, 139.31889681992675, 76.47623387213973, 333.52266416422054, 138.12376162274597, 321.4618805636348, 271.8165810817451, 391.401052884583, 241.70223398268047, 88.93657794474444, 101.12393526808961, 346.4380130374312, 142.67105214747505, 416.20257374688055, 29.51699530222094, 244.3924746879788, 159.53718026961056, 458.0062605687095, 224.51762245375753, 296.4286421469886, 139.582572681523, 231.49298378214556, 374.84294144561716, 366.7723172373459, 81.9169383319569, 269.2824601181117, 428.0168197389887, 303.251641547658, 356.9451748458483, 305.0594037750644, 316.52907386623394, 83.00873458470289, 456.29264002373276, 310.6841987206796, 477.1496304959871, 566.6211415817796, 97.1516482398705, 85.07615080682432, 354.44383618993237, 306.48932086315807, 99.42744623169891, 325.76064243897173, 143.73849279569313, 415.517963386127, 562.1717960464945, 107.79450515481273, 141.73016083453808, 86.1662403658392, 539.4099574923008, 275.5579355628517, 64.4352459122908, 291.8484290346215, 152.11172235465773, 31.56948147767466, 455.52267720939847, 218.05162579227988, 157.59264145065922, 447.6091962540097, 32.17243166591251, 272.55135321832586, 179.16189432473013, 539.7287536409539, 188.05978831583823, 361.8238932217645, 232.1462531364585, 1.4997363180119088, 424.1648175411324, 71.51309601833567, 249.7189667447088, 435.2545865379267, 430.2190473231141, 419.52100663584497, 469.82582121222316, 317.9078233445346, 110.13003166784992, 12.892414100355559, 262.8911554589452, 542.8283469023515, 348.3050348093229, 86.73650740974699, 194.87530864887884, 224.61950195181876, 391.2265162546377, 205.54133080625306, 570.2994238268184, 108.82242694307655, 193.10023285597634, 128.45847663814604, 89.99429102237067, 440.05002757896267, 477.99700780545675]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6378212253644229, "mean_inference_ms": 36.11322813122945, "mean_action_processing_ms": 0.24904347415350359, "mean_env_wait_ms": 4.914893089867439, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0061457157135009766, "StateBufferConnector_ms": 0.0038083791732788086, "ViewRequirementAgentConnector_ms": 0.11349272727966309}, "num_episodes": 18, "episode_return_max": 373.7869333766748, "episode_return_min": -9.40850080635774, "episode_return_mean": 120.66356215556692, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 0.5453545917764187, "num_env_steps_trained_throughput_per_sec": 0.5453545917764187, "timesteps_total": 96000, "num_env_steps_sampled_lifetime": 96000, "num_agent_steps_sampled_lifetime": 384000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 384000, "timers": {"training_iteration_time_ms": 1559922.824, "restore_workers_time_ms": 0.012, "training_step_time_ms": 1559922.78, "sample_time_ms": 100039.589, "learn_time_ms": 1459866.249, "learn_throughput": 2.74, "synch_weights_time_ms": 14.601}, "counters": {"num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000}, "done": false, "training_iteration": 24, "trial_id": "b941d_00000", "date": "2024-08-17_12-51-34", "timestamp": 1723879294, "time_this_iter_s": 7334.711295843124, "time_total_s": 17859.12236380577, "pid": 81115, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[32, [4, 4], 2], [64, [3, 3], 2], [128, [3, 3], 1]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [256, 256], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b0464670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 17859.12236380577, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 27.219289340101522, "ram_util_percent": 81.61370558375636}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 18.36419341690326, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.00010000000000000003, "total_loss": 8.39584186897076, "policy_loss": -0.0886059022986542, "vf_loss": 8.465732368338045, "vf_explained_var": 0.23074514462203577, "kl": 0.018484361900998187, "entropy": 1.1555686914731587, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 46305.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.121870566928197, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.00010000000000000003, "total_loss": 7.578217670400306, "policy_loss": -0.06216748110486796, "vf_loss": 7.624893899947878, "vf_explained_var": 0.13183565833581187, "kl": 0.015299993709708514, "entropy": 0.9096854882265525, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 46305.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 400000, "num_agent_steps_trained": 400000}, "env_runners": {"episode_reward_max": 373.7869333766748, "episode_reward_min": -20.589385742856702, "episode_reward_mean": 104.34516948980536, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -588.5041275525565, "predator_policy": 0.9586496494079713}, "policy_reward_max": {"prey_policy": 163.66529858194173, "predator_policy": 570.2994238268184}, "policy_reward_mean": {"prey_policy": -218.6054211883497, "predator_policy": 270.77800593325236}, "custom_metrics": {}, "hist_stats": {"episode_reward": [95.66464898189781, 22.371062734256913, 184.8181350244297, 73.29649170352849, 292.32, 163.95651818443173, 79.46000000000011, 373.7869333766748, 197.91034986946966, 262.93486524255746, 0.13767707898568737, 270.94705913106407, 157.60967673454337, 111.07000000000001, 126.95057603057779, 161.56661558958217, 181.8321131901976, 104.07636380757813, 59.099999999999994, 78.99969754164472, 96.14333488063178, 74.64960396102013, 15.67, 100.67940037272254, 161.50224028450367, 84.74710172605968, 44.310481481247336, 7.569424864233357, 180.40404623471161, 272.11, 142.22610178105572, 3.7699999999999636, -0.9453199118986895, 33.9706071464658, 15.892379100810523, 72.13648143441327, 186.39156083959483, 138.75157396441625, 124.33013652743902, 40.59153707821733, 109.79742528356685, 268.4700492510068, -9.40850080635774, 164.23335332953863, 48.36710182566816, 11.575871804224958, 26.73359055844261, 153.01143582827635, 161.95033091180628, 58.71396293381008, 151.36608316970518, 105.28011010461948, 90.89050671028016, -5.590091285881241, 29.29091783635554, 100.97734483598875, 51.11940234675088, 195.35295777389095, 39.63579363337524, 9.42612480590286, 182.92797063102563, 112.22651184097865, 164.4231763161489, 179.2899999999999, 115.0454309037798, 171.2942669875233, 78.78178761646933, 177.8450846391125, 157.82033557585748, 3.069999999999977, 13.20999999999997, 1.6257763408382186, 41.31067794995509, 42.224114892451, 144.33000000000018, 112.56600248253076, 92.99999999999996, 132.90269093750746, 117.51065188283211, 20.823440000697467, 296.08, 50.48859964814615, -20.589385742856702, 43.540350908669716, 66.81529296379188, 145.97687460618832, 78.18658354154138, 62.63665715940004, 96.18943568177257, 31.193575276319244, 131.21669688476194, 78.91656098083197, 80.46363288293102, 15.317176377247902, 8.959999999999964, 121.16860147773197, 190.45366509571915, 204.08245251056832, 27.679884627517193, 108.60912826450863], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-191.982480421859, -164.38420100530942, -529.4696720528511, -190.5049885473146, -92.66754494853888, -37.13838124202459, -266.64032023575214, -43.064166501440795, 111.09448048980298, -25.270827116430695, -3.7956113942584864, -137.859694441309, -368.34271617246367, -102.09888707622738, 140.65997845492703, 163.66529858194173, -179.24013378779512, -292.83274455732925, 17.418489853440782, 142.74313792641433, -403.84479376622505, -360.7508960678808, -408.133566740931, -8.722068994196121, 16.02375909090111, -130.9630150342068, -443.67069561484266, -62.41594165305443, 63.27786855013822, -214.45428376183324, -94.8334188006135, -392.4042455820688, -214.03939238503875, -63.98676071767731, -110.02590707216294, -506.6124546988203, -438.0420490938377, -248.8981403637248, -420.2326604842819, -214.556688599817, -246.717529480201, -303.47896952400384, -236.07370563320018, -228.3544171332062, -438.9868234586223, -417.1314333618487, -291.65481017833974, -166.94476057671514, -141.02400462203556, -341.00364401576417, -55.78068770061539, -384.82390631421976, -353.1838124348255, -443.14418430779193, -584.5902169818607, -461.88638713287713, -484.13978400013536, -70.81600015531771, 109.3767904693522, -98.91830081619972, -55.55298555077524, 91.85574472407696, -33.01145479819561, 1.03135035059203, -208.86370368079494, -279.0528037866018, -113.41360999927312, -309.38250144497056, -358.9798771548713, -277.2616207617993, -158.21345001922234, -502.1376856187929, -414.18603937774463, 157.38806044647023, -105.75544631546461, 28.711889587814767, -389.74555026143787, 42.429261001910014, -220.48172142819726, -332.2052031389666, -365.8645211828366, -157.44134040085987, 116.72001896094785, -38.310482922775165, -211.6314157775121, -286.88615021375153, -149.75993776770144, -131.7262779518614, -28.77753166142869, -326.78502147049204, -362.4365165010618, -308.51149471718054, -268.8194491144774, -140.458175155593, -16.34560550540122, -436.97888389408484, 103.73375762680878, -390.47268228430517, -140.93059983514638, -497.6547170881446, -398.1787225486772, -110.65201067512439, -267.71216669094133, -248.59620084573848, 4.790938533556983, -453.20180643171295, -404.44338705497074, -388.9805334475776, -71.65941295248601, -562.8224590328085, -1.680458237383814, -336.862183923384, -230.32817727774298, -124.46918747036361, -339.68072326504983, 65.53454580427568, -380.91448820515967, -557.1394775940868, -190.5586630944687, -49.53987808898055, 77.28826146862879, -519.9364886957433, -85.6632017296366, -142.10346790452695, -76.17623390987676, -203.36074116325358, 79.24770821562048, -387.0498669026938, -124.23264177684277, -136.3661945623164, -324.2093736287483, 15.722012696349395, -162.45415209052882, -210.477307836059, -404.21590960600196, -145.72754771167726, -310.13661731618396, -126.0131934661816, 0.4802636819880927, -423.07481754113246, -69.88309601833484, -238.1389667447093, -435.7676720342514, -428.0801854859512, -316.39725932280606, -531.6388905753067, -7.2557475168486985, -378.55799260308487, 124.5508172523206, -256.00438681162217, -588.5041275525565, -190.06325167658775, -190.6118160586258, 2.0000000000000013, -484.94332726894874, 2.0000000000000013, -204.80537341267475, -453.5247293375647, -118.58446630914297, -162.51475348921244, -68.15785299454853, 145.78508533403186, -438.0710567671098, -429.4873789691641, -349.58342186461573, -170.9675629115106, -323.42130237839564, -81.82693893802251, -490.39152780454816, -330.3066309345037, -366.5710865891842, -267.1028655223496, -375.7163545851654, -160.16195407701366, -196.88077079072096, -327.8871361085635, -230.02079034304742, -39.114522659997576, -180.21166631482808, -292.96320897547065, -92.439481372124, -375.9193198938674, -364.815207422156, -516.5836833326593, -274.0619939584918, -352.5725753541137, -463.4551411744583, -434.0200338269707, -488.8603958731591, -1.6441967099659989, -299.13470001672283, -168.92947246180097, -295.86276377821616, 2.86068026524309, -51.256671190331886, -446.7462468244129, -138.27140832163525, -378.79276565532973, -136.5241384361288, -66.2792934682893], "policy_predator_policy_reward": [84.04876756297293, 367.98256284609306, 528.104760880636, 214.24096245378684, 167.18754494853908, 147.43651626645422, 313.53828333925867, 69.46269510146239, 45.055519510197, 161.44082711643054, 237.0262966889756, 68.58552733102371, 368.4127161724637, 181.48888707622754, 34.07880688656179, 35.382849453244255, 306.20934130241966, 363.7738869121747, 32.373031633162576, 70.40020582953977, 404.0796485485018, 360.65371836458974, 281.7207659401624, 406.0819289260285, 107.92786453476043, 164.62106814308913, 443.68069561484265, 173.4759416530544, 268.473986469911, 9.653004772361012, 445.6195893012102, 203.18469067105434, 384.32257905809587, 75.53568723481823, 458.8984166438635, 261.81630893469776, 438.1420490938377, 307.8981403637248, 423.62674264150843, 290.1623039842352, 402.12203208856664, 244.21780179626967, 118.72687779864108, 420.350848928785, 439.56682345862185, 432.2214333618486, 347.6723999351865, 211.60657119259088, 399.92984741101066, 243.60004151129257, 128.96529744031915, 396.38639830057565, 377.1614137585296, 463.4770644653352, 511.1328643701331, 542.9131646088382, 491.08253933120716, 244.27729105895818, 64.6332095306478, 197.01830081619963, 26.85203222545269, 79.0713103823011, 34.791454798195254, 0.9586496494079713, 324.95323916568105, 162.01794838981607, 183.97679734402627, 272.7899212466838, 116.15499521965597, 535.9788817978243, 281.939217356841, 450.54839971558744, 16.433963649115853, 426.7555761217537, 139.31889681992675, 76.47623387213973, 333.52266416422054, 138.12376162274597, 321.4618805636348, 271.8165810817451, 391.401052884583, 241.70223398268047, 88.93657794474444, 101.12393526808961, 346.4380130374312, 142.67105214747505, 416.20257374688055, 29.51699530222094, 244.3924746879788, 159.53718026961056, 458.0062605687095, 224.51762245375753, 296.4286421469886, 139.582572681523, 231.49298378214556, 374.84294144561716, 366.7723172373459, 81.9169383319569, 269.2824601181117, 428.0168197389887, 303.251641547658, 356.9451748458483, 305.0594037750644, 316.52907386623394, 83.00873458470289, 456.29264002373276, 310.6841987206796, 477.1496304959871, 566.6211415817796, 97.1516482398705, 85.07615080682432, 354.44383618993237, 306.48932086315807, 99.42744623169891, 325.76064243897173, 143.73849279569313, 415.517963386127, 562.1717960464945, 107.79450515481273, 141.73016083453808, 86.1662403658392, 539.4099574923008, 275.5579355628517, 64.4352459122908, 291.8484290346215, 152.11172235465773, 31.56948147767466, 455.52267720939847, 218.05162579227988, 157.59264145065922, 447.6091962540097, 32.17243166591251, 272.55135321832586, 179.16189432473013, 539.7287536409539, 188.05978831583823, 361.8238932217645, 232.1462531364585, 1.4997363180119088, 424.1648175411324, 71.51309601833567, 249.7189667447088, 435.2545865379267, 430.2190473231141, 419.52100663584497, 469.82582121222316, 317.9078233445346, 110.13003166784992, 12.892414100355559, 262.8911554589452, 542.8283469023515, 348.3050348093229, 86.73650740974699, 194.87530864887884, 224.61950195181876, 391.2265162546377, 205.54133080625306, 570.2994238268184, 108.82242694307655, 193.10023285597634, 128.45847663814604, 89.99429102237067, 440.05002757896267, 477.99700780545675, 427.6941299601202, 72.26746907314923, 53.82506374259263, 394.9635284824952, 462.23104961023546, 425.2824020926081, 453.67915247279603, 325.9716742449247, 419.9464430638348, 194.11844913988614, 312.65328984573915, 274.75127421294457, 115.96040269088624, 249.36434599393107, 438.62512981628396, 65.74332075033318, 258.83577805736576, 340.7397200933879, 525.3606264597615, 434.9548252758859, 397.71777782772887, 309.3804243678065, 468.66488114581443, 444.12747023286244, 495.8603958731591, 3.6041967099659655, 293.247680364467, 295.9850935917883, 222.97661441407107, 260.47913419462094, 289.9753070486156, 412.1100634766974, 503.78871053162425, 40.95534807285684, 126.21174886072721, 185.20081130819835]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6394744430878083, "mean_inference_ms": 48.468021552544855, "mean_action_processing_ms": 0.24990794565269298, "mean_env_wait_ms": 6.674123760872763, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007772088050842285, "StateBufferConnector_ms": 0.003856658935546875, "ViewRequirementAgentConnector_ms": 0.11494565010070801}, "num_episodes": 18, "episode_return_max": 373.7869333766748, "episode_return_min": -20.589385742856702, "episode_return_mean": 104.34516948980536, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 400000, "num_agent_steps_trained": 400000, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 0.5457546546265221, "num_env_steps_trained_throughput_per_sec": 0.5457546546265221, "timesteps_total": 100000, "num_env_steps_sampled_lifetime": 100000, "num_agent_steps_sampled_lifetime": 400000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 400000, "timers": {"training_iteration_time_ms": 2279761.99, "restore_workers_time_ms": 0.012, "training_step_time_ms": 2279761.945, "sample_time_ms": 100056.387, "learn_time_ms": 2179688.379, "learn_throughput": 1.835, "synch_weights_time_ms": 14.755}, "counters": {"num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 400000, "num_agent_steps_trained": 400000}, "done": false, "training_iteration": 25, "trial_id": "b941d_00000", "date": "2024-08-17_14-53-43", "timestamp": 1723886623, "time_this_iter_s": 7329.348901987076, "time_total_s": 25188.471265792847, "pid": 81115, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[32, [4, 4], 2], [64, [3, 3], 2], [128, [3, 3], 1]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [256, 256], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b03ed5e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 25188.471265792847, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 26.89842931937173, "ram_util_percent": 81.29424083769634}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 20.091252196024335, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.00010000000000000003, "total_loss": 8.693859520160332, "policy_loss": -0.08463800656892576, "vf_loss": 8.760165906078601, "vf_explained_var": 0.33146659517414356, "kl": 0.018105306575434233, "entropy": 1.1365280638926873, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 48195.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.557848528390208, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.00010000000000000003, "total_loss": 7.538161718782294, "policy_loss": -0.06517845071549158, "vf_loss": 7.586098253159296, "vf_explained_var": 0.1517447323080093, "kl": 0.017029047612489714, "entropy": 0.9284742148149581, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 48195.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 416000, "num_agent_steps_trained": 416000}, "env_runners": {"episode_reward_max": 373.57354481224303, "episode_reward_min": -20.589385742856702, "episode_reward_mean": 98.9217059370033, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -588.5041275525565, "predator_policy": 0.9586496494079713}, "policy_reward_max": {"prey_policy": 158.14913358762823, "predator_policy": 570.2994238268184}, "policy_reward_mean": {"prey_policy": -228.8470601517048, "predator_policy": 278.30791312020636}, "custom_metrics": {}, "hist_stats": {"episode_reward": [59.099999999999994, 78.99969754164472, 96.14333488063178, 74.64960396102013, 15.67, 100.67940037272254, 161.50224028450367, 84.74710172605968, 44.310481481247336, 7.569424864233357, 180.40404623471161, 272.11, 142.22610178105572, 3.7699999999999636, -0.9453199118986895, 33.9706071464658, 15.892379100810523, 72.13648143441327, 186.39156083959483, 138.75157396441625, 124.33013652743902, 40.59153707821733, 109.79742528356685, 268.4700492510068, -9.40850080635774, 164.23335332953863, 48.36710182566816, 11.575871804224958, 26.73359055844261, 153.01143582827635, 161.95033091180628, 58.71396293381008, 151.36608316970518, 105.28011010461948, 90.89050671028016, -5.590091285881241, 29.29091783635554, 100.97734483598875, 51.11940234675088, 195.35295777389095, 39.63579363337524, 9.42612480590286, 182.92797063102563, 112.22651184097865, 164.4231763161489, 179.2899999999999, 115.0454309037798, 171.2942669875233, 78.78178761646933, 177.8450846391125, 157.82033557585748, 3.069999999999977, 13.20999999999997, 1.6257763408382186, 41.31067794995509, 42.224114892451, 144.33000000000018, 112.56600248253076, 92.99999999999996, 132.90269093750746, 117.51065188283211, 20.823440000697467, 296.08, 50.48859964814615, -20.589385742856702, 43.540350908669716, 66.81529296379188, 145.97687460618832, 78.18658354154138, 62.63665715940004, 96.18943568177257, 31.193575276319244, 131.21669688476194, 78.91656098083197, 80.46363288293102, 15.317176377247902, 8.959999999999964, 121.16860147773197, 190.45366509571915, 204.08245251056832, 27.679884627517193, 108.60912826450863, 139.69050129195745, 156.47360706275148, 49.1502866766537, 92.72605836333103, 26.974183578624313, 164.67464307537426, 373.57354481224303, 60.77387320122001, 1.890000000000002, 156.68392633233424, 59.51981324926119, 75.14807642159194, 148.72966617726792, 178.4151077306885, 114.12091269288364, 198.21841527859212, 261.45308239830626, 60.14703305649134], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-438.0420490938377, -248.8981403637248, -420.2326604842819, -214.556688599817, -246.717529480201, -303.47896952400384, -236.07370563320018, -228.3544171332062, -438.9868234586223, -417.1314333618487, -291.65481017833974, -166.94476057671514, -141.02400462203556, -341.00364401576417, -55.78068770061539, -384.82390631421976, -353.1838124348255, -443.14418430779193, -584.5902169818607, -461.88638713287713, -484.13978400013536, -70.81600015531771, 109.3767904693522, -98.91830081619972, -55.55298555077524, 91.85574472407696, -33.01145479819561, 1.03135035059203, -208.86370368079494, -279.0528037866018, -113.41360999927312, -309.38250144497056, -358.9798771548713, -277.2616207617993, -158.21345001922234, -502.1376856187929, -414.18603937774463, 157.38806044647023, -105.75544631546461, 28.711889587814767, -389.74555026143787, 42.429261001910014, -220.48172142819726, -332.2052031389666, -365.8645211828366, -157.44134040085987, 116.72001896094785, -38.310482922775165, -211.6314157775121, -286.88615021375153, -149.75993776770144, -131.7262779518614, -28.77753166142869, -326.78502147049204, -362.4365165010618, -308.51149471718054, -268.8194491144774, -140.458175155593, -16.34560550540122, -436.97888389408484, 103.73375762680878, -390.47268228430517, -140.93059983514638, -497.6547170881446, -398.1787225486772, -110.65201067512439, -267.71216669094133, -248.59620084573848, 4.790938533556983, -453.20180643171295, -404.44338705497074, -388.9805334475776, -71.65941295248601, -562.8224590328085, -1.680458237383814, -336.862183923384, -230.32817727774298, -124.46918747036361, -339.68072326504983, 65.53454580427568, -380.91448820515967, -557.1394775940868, -190.5586630944687, -49.53987808898055, 77.28826146862879, -519.9364886957433, -85.6632017296366, -142.10346790452695, -76.17623390987676, -203.36074116325358, 79.24770821562048, -387.0498669026938, -124.23264177684277, -136.3661945623164, -324.2093736287483, 15.722012696349395, -162.45415209052882, -210.477307836059, -404.21590960600196, -145.72754771167726, -310.13661731618396, -126.0131934661816, 0.4802636819880927, -423.07481754113246, -69.88309601833484, -238.1389667447093, -435.7676720342514, -428.0801854859512, -316.39725932280606, -531.6388905753067, -7.2557475168486985, -378.55799260308487, 124.5508172523206, -256.00438681162217, -588.5041275525565, -190.06325167658775, -190.6118160586258, 2.0000000000000013, -484.94332726894874, 2.0000000000000013, -204.80537341267475, -453.5247293375647, -118.58446630914297, -162.51475348921244, -68.15785299454853, 145.78508533403186, -438.0710567671098, -429.4873789691641, -349.58342186461573, -170.9675629115106, -323.42130237839564, -81.82693893802251, -490.39152780454816, -330.3066309345037, -366.5710865891842, -267.1028655223496, -375.7163545851654, -160.16195407701366, -196.88077079072096, -327.8871361085635, -230.02079034304742, -39.114522659997576, -180.21166631482808, -292.96320897547065, -92.439481372124, -375.9193198938674, -364.815207422156, -516.5836833326593, -274.0619939584918, -352.5725753541137, -463.4551411744583, -434.0200338269707, -488.8603958731591, -1.6441967099659989, -299.13470001672283, -168.92947246180097, -295.86276377821616, 2.86068026524309, -51.256671190331886, -446.7462468244129, -138.27140832163525, -378.79276565532973, -136.5241384361288, -66.2792934682893, -301.5475648295731, -260.76718186385335, -40.93569857170536, -74.86978846356178, -463.73458914203843, -357.2199233946941, -133.72733147513696, -209.21595232422294, -424.648136772738, -446.2700952309476, -53.98957862830406, -528.9919560250759, -219.85402538014523, 73.4010364577786, -98.97794667636569, -127.30958271958104, -39.21484651390931, -359.9453576947785, 63.53255005465382, -213.94925633559802, 19.98935050653218, -379.8877234082095, -400.2663478477761, -179.61170027451098, 71.39055759706629, -168.38642702414694, -439.87842598735585, 158.14913358762823, -18.528959209956998, -298.221395939457, -68.34949219799377, -436.0740334093226, -533.1908394013354, -39.962126805646555, -63.94397868684159, -438.5869560827787], "policy_predator_policy_reward": [438.1420490938377, 307.8981403637248, 423.62674264150843, 290.1623039842352, 402.12203208856664, 244.21780179626967, 118.72687779864108, 420.350848928785, 439.56682345862185, 432.2214333618486, 347.6723999351865, 211.60657119259088, 399.92984741101066, 243.60004151129257, 128.96529744031915, 396.38639830057565, 377.1614137585296, 463.4770644653352, 511.1328643701331, 542.9131646088382, 491.08253933120716, 244.27729105895818, 64.6332095306478, 197.01830081619963, 26.85203222545269, 79.0713103823011, 34.791454798195254, 0.9586496494079713, 324.95323916568105, 162.01794838981607, 183.97679734402627, 272.7899212466838, 116.15499521965597, 535.9788817978243, 281.939217356841, 450.54839971558744, 16.433963649115853, 426.7555761217537, 139.31889681992675, 76.47623387213973, 333.52266416422054, 138.12376162274597, 321.4618805636348, 271.8165810817451, 391.401052884583, 241.70223398268047, 88.93657794474444, 101.12393526808961, 346.4380130374312, 142.67105214747505, 416.20257374688055, 29.51699530222094, 244.3924746879788, 159.53718026961056, 458.0062605687095, 224.51762245375753, 296.4286421469886, 139.582572681523, 231.49298378214556, 374.84294144561716, 366.7723172373459, 81.9169383319569, 269.2824601181117, 428.0168197389887, 303.251641547658, 356.9451748458483, 305.0594037750644, 316.52907386623394, 83.00873458470289, 456.29264002373276, 310.6841987206796, 477.1496304959871, 566.6211415817796, 97.1516482398705, 85.07615080682432, 354.44383618993237, 306.48932086315807, 99.42744623169891, 325.76064243897173, 143.73849279569313, 415.517963386127, 562.1717960464945, 107.79450515481273, 141.73016083453808, 86.1662403658392, 539.4099574923008, 275.5579355628517, 64.4352459122908, 291.8484290346215, 152.11172235465773, 31.56948147767466, 455.52267720939847, 218.05162579227988, 157.59264145065922, 447.6091962540097, 32.17243166591251, 272.55135321832586, 179.16189432473013, 539.7287536409539, 188.05978831583823, 361.8238932217645, 232.1462531364585, 1.4997363180119088, 424.1648175411324, 71.51309601833567, 249.7189667447088, 435.2545865379267, 430.2190473231141, 419.52100663584497, 469.82582121222316, 317.9078233445346, 110.13003166784992, 12.892414100355559, 262.8911554589452, 542.8283469023515, 348.3050348093229, 86.73650740974699, 194.87530864887884, 224.61950195181876, 391.2265162546377, 205.54133080625306, 570.2994238268184, 108.82242694307655, 193.10023285597634, 128.45847663814604, 89.99429102237067, 440.05002757896267, 477.99700780545675, 427.6941299601202, 72.26746907314923, 53.82506374259263, 394.9635284824952, 462.23104961023546, 425.2824020926081, 453.67915247279603, 325.9716742449247, 419.9464430638348, 194.11844913988614, 312.65328984573915, 274.75127421294457, 115.96040269088624, 249.36434599393107, 438.62512981628396, 65.74332075033318, 258.83577805736576, 340.7397200933879, 525.3606264597615, 434.9548252758859, 397.71777782772887, 309.3804243678065, 468.66488114581443, 444.12747023286244, 495.8603958731591, 3.6041967099659655, 293.247680364467, 295.9850935917883, 222.97661441407107, 260.47913419462094, 289.9753070486156, 412.1100634766974, 503.78871053162425, 40.95534807285684, 126.21174886072721, 185.20081130819835, 296.6243538131452, 405.3808941722374, 167.2960942106828, 104.98299988733609, 385.7703999869231, 484.3343992264629, 48.369085757755585, 387.30025640493517, 480.06102946889155, 417.83138611341815, 359.5555346478804, 388.1006430808734, 308.38937580258073, 211.6371579320287, 268.08163991940523, 18.97976267776198, 40.91484651390897, 360.13535769477835, 58.36222193398395, 248.738410679294, 329.0082414767856, 90.40994467415324, 404.8685597221975, 250.15756482168123, 167.49053253103054, 78.23500307331845, 434.81275582846655, 25.331644301949492, 258.70649064050417, 172.16477720179356, 297.64621895100015, 404.9957219349091, 404.07069233888086, 430.5353562664071, 133.07978215818633, 429.59818566792495]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6410792101503026, "mean_inference_ms": 60.34847773656267, "mean_action_processing_ms": 0.2508239400103951, "mean_env_wait_ms": 8.36572363122956, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008168339729309082, "StateBufferConnector_ms": 0.0037691593170166016, "ViewRequirementAgentConnector_ms": 0.1133425235748291}, "num_episodes": 18, "episode_return_max": 373.57354481224303, "episode_return_min": -20.589385742856702, "episode_return_mean": 98.9217059370033, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 416000, "num_agent_steps_trained": 416000, "num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 0.808336908650777, "num_env_steps_trained_throughput_per_sec": 0.808336908650777, "timesteps_total": 104000, "num_env_steps_sampled_lifetime": 104000, "num_agent_steps_sampled_lifetime": 416000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 416000, "timers": {"training_iteration_time_ms": 2761641.385, "restore_workers_time_ms": 0.012, "training_step_time_ms": 2761641.341, "sample_time_ms": 100067.41, "learn_time_ms": 2661556.332, "learn_throughput": 1.503, "synch_weights_time_ms": 14.917}, "counters": {"num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 416000, "num_agent_steps_trained": 416000}, "done": false, "training_iteration": 26, "trial_id": "b941d_00000", "date": "2024-08-17_16-16-12", "timestamp": 1723891572, "time_this_iter_s": 4948.482154846191, "time_total_s": 30136.953420639038, "pid": 81115, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[32, [4, 4], 2], [64, [3, 3], 2], [128, [3, 3], 1]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [256, 256], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b03019d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 30136.953420639038, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 25.055497382198954, "ram_util_percent": 80.57958115183247}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 16.934913377156334, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.00010000000000000003, "total_loss": 8.78306083881035, "policy_loss": -0.08631226943766393, "vf_loss": 8.84922145308641, "vf_explained_var": 0.18133512542992042, "kl": 0.019902859906079876, "entropy": 1.1388259032415966, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 50085.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.637496720230769, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.00010000000000000003, "total_loss": 8.725501019866378, "policy_loss": -0.06527279419270123, "vf_loss": 8.77357510536436, "vf_explained_var": 0.12711015334205022, "kl": 0.016986390714079563, "entropy": 0.8560097252250348, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 50085.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 432000}, "env_runners": {"episode_reward_max": 373.57354481224303, "episode_reward_min": -21.256868744217357, "episode_reward_mean": 98.51855063631392, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -588.5041275525565, "predator_policy": 1.4997363180119088}, "policy_reward_max": {"prey_policy": 158.14913358762823, "predator_policy": 570.2994238268184}, "policy_reward_mean": {"prey_policy": -236.16802504071768, "predator_policy": 285.42730035887456}, "custom_metrics": {}, "hist_stats": {"episode_reward": [109.79742528356685, 268.4700492510068, -9.40850080635774, 164.23335332953863, 48.36710182566816, 11.575871804224958, 26.73359055844261, 153.01143582827635, 161.95033091180628, 58.71396293381008, 151.36608316970518, 105.28011010461948, 90.89050671028016, -5.590091285881241, 29.29091783635554, 100.97734483598875, 51.11940234675088, 195.35295777389095, 39.63579363337524, 9.42612480590286, 182.92797063102563, 112.22651184097865, 164.4231763161489, 179.2899999999999, 115.0454309037798, 171.2942669875233, 78.78178761646933, 177.8450846391125, 157.82033557585748, 3.069999999999977, 13.20999999999997, 1.6257763408382186, 41.31067794995509, 42.224114892451, 144.33000000000018, 112.56600248253076, 92.99999999999996, 132.90269093750746, 117.51065188283211, 20.823440000697467, 296.08, 50.48859964814615, -20.589385742856702, 43.540350908669716, 66.81529296379188, 145.97687460618832, 78.18658354154138, 62.63665715940004, 96.18943568177257, 31.193575276319244, 131.21669688476194, 78.91656098083197, 80.46363288293102, 15.317176377247902, 8.959999999999964, 121.16860147773197, 190.45366509571915, 204.08245251056832, 27.679884627517193, 108.60912826450863, 139.69050129195745, 156.47360706275148, 49.1502866766537, 92.72605836333103, 26.974183578624313, 164.67464307537426, 373.57354481224303, 60.77387320122001, 1.890000000000002, 156.68392633233424, 59.51981324926119, 75.14807642159194, 148.72966617726792, 178.4151077306885, 114.12091269288364, 198.21841527859212, 261.45308239830626, 60.14703305649134, 22.988702436065395, 24.550196968479025, 41.806161894468694, -21.256868744217357, 102.83647779808949, -6.9378977765156735, 84.19003161734067, 195.19871957451443, 36.68434406193539, 283.57555112383557, 137.47607289882677, 78.52601184991596, 94.22746220043916, 112.61193884507149, -4.6013915617280645, 93.59678368404765, 1.2486495363515409, 49.024912051937406, 257.09, 111.20950445403085, 133.9774364929532, 64.662059832509], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-365.8645211828366, -157.44134040085987, 116.72001896094785, -38.310482922775165, -211.6314157775121, -286.88615021375153, -149.75993776770144, -131.7262779518614, -28.77753166142869, -326.78502147049204, -362.4365165010618, -308.51149471718054, -268.8194491144774, -140.458175155593, -16.34560550540122, -436.97888389408484, 103.73375762680878, -390.47268228430517, -140.93059983514638, -497.6547170881446, -398.1787225486772, -110.65201067512439, -267.71216669094133, -248.59620084573848, 4.790938533556983, -453.20180643171295, -404.44338705497074, -388.9805334475776, -71.65941295248601, -562.8224590328085, -1.680458237383814, -336.862183923384, -230.32817727774298, -124.46918747036361, -339.68072326504983, 65.53454580427568, -380.91448820515967, -557.1394775940868, -190.5586630944687, -49.53987808898055, 77.28826146862879, -519.9364886957433, -85.6632017296366, -142.10346790452695, -76.17623390987676, -203.36074116325358, 79.24770821562048, -387.0498669026938, -124.23264177684277, -136.3661945623164, -324.2093736287483, 15.722012696349395, -162.45415209052882, -210.477307836059, -404.21590960600196, -145.72754771167726, -310.13661731618396, -126.0131934661816, 0.4802636819880927, -423.07481754113246, -69.88309601833484, -238.1389667447093, -435.7676720342514, -428.0801854859512, -316.39725932280606, -531.6388905753067, -7.2557475168486985, -378.55799260308487, 124.5508172523206, -256.00438681162217, -588.5041275525565, -190.06325167658775, -190.6118160586258, 2.0000000000000013, -484.94332726894874, 2.0000000000000013, -204.80537341267475, -453.5247293375647, -118.58446630914297, -162.51475348921244, -68.15785299454853, 145.78508533403186, -438.0710567671098, -429.4873789691641, -349.58342186461573, -170.9675629115106, -323.42130237839564, -81.82693893802251, -490.39152780454816, -330.3066309345037, -366.5710865891842, -267.1028655223496, -375.7163545851654, -160.16195407701366, -196.88077079072096, -327.8871361085635, -230.02079034304742, -39.114522659997576, -180.21166631482808, -292.96320897547065, -92.439481372124, -375.9193198938674, -364.815207422156, -516.5836833326593, -274.0619939584918, -352.5725753541137, -463.4551411744583, -434.0200338269707, -488.8603958731591, -1.6441967099659989, -299.13470001672283, -168.92947246180097, -295.86276377821616, 2.86068026524309, -51.256671190331886, -446.7462468244129, -138.27140832163525, -378.79276565532973, -136.5241384361288, -66.2792934682893, -301.5475648295731, -260.76718186385335, -40.93569857170536, -74.86978846356178, -463.73458914203843, -357.2199233946941, -133.72733147513696, -209.21595232422294, -424.648136772738, -446.2700952309476, -53.98957862830406, -528.9919560250759, -219.85402538014523, 73.4010364577786, -98.97794667636569, -127.30958271958104, -39.21484651390931, -359.9453576947785, 63.53255005465382, -213.94925633559802, 19.98935050653218, -379.8877234082095, -400.2663478477761, -179.61170027451098, 71.39055759706629, -168.38642702414694, -439.87842598735585, 158.14913358762823, -18.528959209956998, -298.221395939457, -68.34949219799377, -436.0740334093226, -533.1908394013354, -39.962126805646555, -63.94397868684159, -438.5869560827787, -514.0336301446049, -159.8436630144738, -438.99493309950685, -374.74456691636254, -87.34523441595528, -204.4459594611678, -357.5087650544544, -438.259338359429, -413.41765298590275, -364.8110474774788, -360.3638240979492, -430.26551215880005, -355.91062896504866, -370.4494838268244, -22.114436730873308, -264.17271698497836, -252.70823357429398, -252.42786741671267, 45.95357069640531, -156.43865542614662, -168.5505437008555, -65.11186346246106, -335.4078264040091, -540.0930921573009, -280.95387251682394, -369.981748826761, -312.27656199877754, -315.04975489070966, -334.4495427454086, -427.2015967682113, -231.30719829050963, -238.52524610880923, -346.22571308210024, -476.4159863026004, -50.763441909538074, -248.019951415178, -36.47433042435801, 41.489486464500786, -236.3426677395127, -363.35626654199586, -138.55305946958256, -80.33629824515094, -491.41017464287535, -44.40662033533129], "policy_predator_policy_reward": [391.401052884583, 241.70223398268047, 88.93657794474444, 101.12393526808961, 346.4380130374312, 142.67105214747505, 416.20257374688055, 29.51699530222094, 244.3924746879788, 159.53718026961056, 458.0062605687095, 224.51762245375753, 296.4286421469886, 139.582572681523, 231.49298378214556, 374.84294144561716, 366.7723172373459, 81.9169383319569, 269.2824601181117, 428.0168197389887, 303.251641547658, 356.9451748458483, 305.0594037750644, 316.52907386623394, 83.00873458470289, 456.29264002373276, 310.6841987206796, 477.1496304959871, 566.6211415817796, 97.1516482398705, 85.07615080682432, 354.44383618993237, 306.48932086315807, 99.42744623169891, 325.76064243897173, 143.73849279569313, 415.517963386127, 562.1717960464945, 107.79450515481273, 141.73016083453808, 86.1662403658392, 539.4099574923008, 275.5579355628517, 64.4352459122908, 291.8484290346215, 152.11172235465773, 31.56948147767466, 455.52267720939847, 218.05162579227988, 157.59264145065922, 447.6091962540097, 32.17243166591251, 272.55135321832586, 179.16189432473013, 539.7287536409539, 188.05978831583823, 361.8238932217645, 232.1462531364585, 1.4997363180119088, 424.1648175411324, 71.51309601833567, 249.7189667447088, 435.2545865379267, 430.2190473231141, 419.52100663584497, 469.82582121222316, 317.9078233445346, 110.13003166784992, 12.892414100355559, 262.8911554589452, 542.8283469023515, 348.3050348093229, 86.73650740974699, 194.87530864887884, 224.61950195181876, 391.2265162546377, 205.54133080625306, 570.2994238268184, 108.82242694307655, 193.10023285597634, 128.45847663814604, 89.99429102237067, 440.05002757896267, 477.99700780545675, 427.6941299601202, 72.26746907314923, 53.82506374259263, 394.9635284824952, 462.23104961023546, 425.2824020926081, 453.67915247279603, 325.9716742449247, 419.9464430638348, 194.11844913988614, 312.65328984573915, 274.75127421294457, 115.96040269088624, 249.36434599393107, 438.62512981628396, 65.74332075033318, 258.83577805736576, 340.7397200933879, 525.3606264597615, 434.9548252758859, 397.71777782772887, 309.3804243678065, 468.66488114581443, 444.12747023286244, 495.8603958731591, 3.6041967099659655, 293.247680364467, 295.9850935917883, 222.97661441407107, 260.47913419462094, 289.9753070486156, 412.1100634766974, 503.78871053162425, 40.95534807285684, 126.21174886072721, 185.20081130819835, 296.6243538131452, 405.3808941722374, 167.2960942106828, 104.98299988733609, 385.7703999869231, 484.3343992264629, 48.369085757755585, 387.30025640493517, 480.06102946889155, 417.83138611341815, 359.5555346478804, 388.1006430808734, 308.38937580258073, 211.6371579320287, 268.08163991940523, 18.97976267776198, 40.91484651390897, 360.13535769477835, 58.36222193398395, 248.738410679294, 329.0082414767856, 90.40994467415324, 404.8685597221975, 250.15756482168123, 167.49053253103054, 78.23500307331845, 434.81275582846655, 25.331644301949492, 258.70649064050417, 172.16477720179356, 297.64621895100015, 404.9957219349091, 404.07069233888086, 430.5353562664071, 133.07978215818633, 429.59818566792495, 514.7210781267991, 182.14491746834412, 426.18797607056973, 412.1017209137784, 123.34115280768515, 210.256202963907, 486.18580429231605, 288.3254303773495, 489.1288446719312, 391.9363335895391, 350.0491892113628, 433.6422492688707, 409.62955332005185, 400.9205910891612, 309.8925226909483, 171.59335059941733, 424.50602905051244, 117.31441600242869, 88.99122035525326, 305.0694154983236, 54.641536953801754, 316.49694310834025, 546.9566502948986, 407.0702801163273, 367.3908590372562, 377.7722245067675, 320.94108187971017, 418.9971738548485, 446.1056505210006, 310.9440974308909, 467.0433585698825, 96.38586951348398, 351.53858381275796, 472.35176510829393, 190.43735952570913, 157.37094585094428, 145.564330424358, 106.51051353549921, 284.5544926196975, 426.35394611584115, 6.603731724186084, 346.26306248350005, 204.65855558530546, 395.82029922540994]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6427872235524715, "mean_inference_ms": 71.36127371085597, "mean_action_processing_ms": 0.2519496815082773, "mean_env_wait_ms": 10.808764367942269, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00912010669708252, "StateBufferConnector_ms": 0.0036773681640625, "ViewRequirementAgentConnector_ms": 0.11412131786346436}, "num_episodes": 22, "episode_return_max": 373.57354481224303, "episode_return_min": -21.256868744217357, "episode_return_mean": 98.51855063631392, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 432000, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 0.6641210077265325, "num_env_steps_trained_throughput_per_sec": 0.6641210077265325, "timesteps_total": 108000, "num_env_steps_sampled_lifetime": 108000, "num_agent_steps_sampled_lifetime": 432000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 432000, "timers": {"training_iteration_time_ms": 3350792.125, "restore_workers_time_ms": 0.012, "training_step_time_ms": 3350792.079, "sample_time_ms": 100056.449, "learn_time_ms": 3250717.166, "learn_throughput": 1.23, "synch_weights_time_ms": 15.383}, "counters": {"num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 432000}, "done": false, "training_iteration": 27, "trial_id": "b941d_00000", "date": "2024-08-17_17-56-35", "timestamp": 1723897595, "time_this_iter_s": 6023.031883239746, "time_total_s": 36159.985303878784, "pid": 81115, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[32, [4, 4], 2], [64, [3, 3], 2], [128, [3, 3], 1]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [256, 256], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b03ed5e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 36159.985303878784, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 24.081481481481486, "ram_util_percent": 81.40529100529099}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.122721586908613, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.00010000000000000003, "total_loss": 8.792431545762158, "policy_loss": -0.09076542710816418, "vf_loss": 8.863266895940065, "vf_explained_var": 0.18081644404502142, "kl": 0.01968399633823183, "entropy": 1.1085171727276353, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 51975.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.386098234363334, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.00010000000000000003, "total_loss": 8.328554704201915, "policy_loss": -0.06940370341183903, "vf_loss": 8.380016909705269, "vf_explained_var": 0.08066842496079743, "kl": 0.017720000883133517, "entropy": 0.828356064248968, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 51975.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000}, "env_runners": {"episode_reward_max": 373.57354481224303, "episode_reward_min": -26.971520983645757, "episode_reward_mean": 92.72211713886614, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -588.5041275525565, "predator_policy": 1.4997363180119088}, "policy_reward_max": {"prey_policy": 158.14913358762823, "predator_policy": 570.2994238268184}, "policy_reward_mean": {"prey_policy": -253.86780359263045, "predator_policy": 300.22886216206336}, "custom_metrics": {}, "hist_stats": {"episode_reward": [179.2899999999999, 115.0454309037798, 171.2942669875233, 78.78178761646933, 177.8450846391125, 157.82033557585748, 3.069999999999977, 13.20999999999997, 1.6257763408382186, 41.31067794995509, 42.224114892451, 144.33000000000018, 112.56600248253076, 92.99999999999996, 132.90269093750746, 117.51065188283211, 20.823440000697467, 296.08, 50.48859964814615, -20.589385742856702, 43.540350908669716, 66.81529296379188, 145.97687460618832, 78.18658354154138, 62.63665715940004, 96.18943568177257, 31.193575276319244, 131.21669688476194, 78.91656098083197, 80.46363288293102, 15.317176377247902, 8.959999999999964, 121.16860147773197, 190.45366509571915, 204.08245251056832, 27.679884627517193, 108.60912826450863, 139.69050129195745, 156.47360706275148, 49.1502866766537, 92.72605836333103, 26.974183578624313, 164.67464307537426, 373.57354481224303, 60.77387320122001, 1.890000000000002, 156.68392633233424, 59.51981324926119, 75.14807642159194, 148.72966617726792, 178.4151077306885, 114.12091269288364, 198.21841527859212, 261.45308239830626, 60.14703305649134, 22.988702436065395, 24.550196968479025, 41.806161894468694, -21.256868744217357, 102.83647779808949, -6.9378977765156735, 84.19003161734067, 195.19871957451443, 36.68434406193539, 283.57555112383557, 137.47607289882677, 78.52601184991596, 94.22746220043916, 112.61193884507149, -4.6013915617280645, 93.59678368404765, 1.2486495363515409, 49.024912051937406, 257.09, 111.20950445403085, 133.9774364929532, 64.662059832509, 210.52679085115557, -26.971520983645757, 14.743563217242034, 8.508082955082973, 44.89296838734542, 157.75407495020875, 23.299107405178287, 25.733212636619296, 20.079119630393603, 102.9775722600378, 99.44234822767426, 197.6701133059209, 65.26657243194025, 21.167675783722114, 108.47747052989011, 60.3292289959743, 122.48444578777061, 32.849824533966235, -26.15261492899224, 66.67186807134934, 127.031667789225, 0.3002298731325439, 184.0462781831576], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [79.24770821562048, -387.0498669026938, -124.23264177684277, -136.3661945623164, -324.2093736287483, 15.722012696349395, -162.45415209052882, -210.477307836059, -404.21590960600196, -145.72754771167726, -310.13661731618396, -126.0131934661816, 0.4802636819880927, -423.07481754113246, -69.88309601833484, -238.1389667447093, -435.7676720342514, -428.0801854859512, -316.39725932280606, -531.6388905753067, -7.2557475168486985, -378.55799260308487, 124.5508172523206, -256.00438681162217, -588.5041275525565, -190.06325167658775, -190.6118160586258, 2.0000000000000013, -484.94332726894874, 2.0000000000000013, -204.80537341267475, -453.5247293375647, -118.58446630914297, -162.51475348921244, -68.15785299454853, 145.78508533403186, -438.0710567671098, -429.4873789691641, -349.58342186461573, -170.9675629115106, -323.42130237839564, -81.82693893802251, -490.39152780454816, -330.3066309345037, -366.5710865891842, -267.1028655223496, -375.7163545851654, -160.16195407701366, -196.88077079072096, -327.8871361085635, -230.02079034304742, -39.114522659997576, -180.21166631482808, -292.96320897547065, -92.439481372124, -375.9193198938674, -364.815207422156, -516.5836833326593, -274.0619939584918, -352.5725753541137, -463.4551411744583, -434.0200338269707, -488.8603958731591, -1.6441967099659989, -299.13470001672283, -168.92947246180097, -295.86276377821616, 2.86068026524309, -51.256671190331886, -446.7462468244129, -138.27140832163525, -378.79276565532973, -136.5241384361288, -66.2792934682893, -301.5475648295731, -260.76718186385335, -40.93569857170536, -74.86978846356178, -463.73458914203843, -357.2199233946941, -133.72733147513696, -209.21595232422294, -424.648136772738, -446.2700952309476, -53.98957862830406, -528.9919560250759, -219.85402538014523, 73.4010364577786, -98.97794667636569, -127.30958271958104, -39.21484651390931, -359.9453576947785, 63.53255005465382, -213.94925633559802, 19.98935050653218, -379.8877234082095, -400.2663478477761, -179.61170027451098, 71.39055759706629, -168.38642702414694, -439.87842598735585, 158.14913358762823, -18.528959209956998, -298.221395939457, -68.34949219799377, -436.0740334093226, -533.1908394013354, -39.962126805646555, -63.94397868684159, -438.5869560827787, -514.0336301446049, -159.8436630144738, -438.99493309950685, -374.74456691636254, -87.34523441595528, -204.4459594611678, -357.5087650544544, -438.259338359429, -413.41765298590275, -364.8110474774788, -360.3638240979492, -430.26551215880005, -355.91062896504866, -370.4494838268244, -22.114436730873308, -264.17271698497836, -252.70823357429398, -252.42786741671267, 45.95357069640531, -156.43865542614662, -168.5505437008555, -65.11186346246106, -335.4078264040091, -540.0930921573009, -280.95387251682394, -369.981748826761, -312.27656199877754, -315.04975489070966, -334.4495427454086, -427.2015967682113, -231.30719829050963, -238.52524610880923, -346.22571308210024, -476.4159863026004, -50.763441909538074, -248.019951415178, -36.47433042435801, 41.489486464500786, -236.3426677395127, -363.35626654199586, -138.55305946958256, -80.33629824515094, -491.41017464287535, -44.40662033533129, 145.54278209652443, -225.66478372829502, -437.34871410832466, -463.9673497005242, -485.6138954938097, -295.656917945013, -440.40144913862036, -185.65922350061248, -235.74125295313922, -290.1249853297709, -42.70078641676126, -544.5446058715142, -285.7951794148465, -331.4793239100395, -88.32339928736353, -232.24320112815815, -307.7698494268964, -371.38137884731333, -270.11427575012186, -431.4533448415532, -431.8373004742278, -164.24974293777856, -395.8347331930181, 30.053198507688116, -299.7722191656633, -400.0550815490311, -409.9795124457156, -488.4023495305975, -426.3804586512889, -184.19823951241233, -452.26188904144374, -56.99578625792166, -52.60839268922185, -203.984210793805, -385.05771985072914, -325.7428599742834, -218.70504791988338, -438.1847943729023, -434.96777649468135, -400.9380497630981, -347.5633584119736, -144.14061505732863, -456.98338819002544, -381.9716631468976, 86.65714988113075, -371.79308594136853], "policy_predator_policy_reward": [31.56948147767466, 455.52267720939847, 218.05162579227988, 157.59264145065922, 447.6091962540097, 32.17243166591251, 272.55135321832586, 179.16189432473013, 539.7287536409539, 188.05978831583823, 361.8238932217645, 232.1462531364585, 1.4997363180119088, 424.1648175411324, 71.51309601833567, 249.7189667447088, 435.2545865379267, 430.2190473231141, 419.52100663584497, 469.82582121222316, 317.9078233445346, 110.13003166784992, 12.892414100355559, 262.8911554589452, 542.8283469023515, 348.3050348093229, 86.73650740974699, 194.87530864887884, 224.61950195181876, 391.2265162546377, 205.54133080625306, 570.2994238268184, 108.82242694307655, 193.10023285597634, 128.45847663814604, 89.99429102237067, 440.05002757896267, 477.99700780545675, 427.6941299601202, 72.26746907314923, 53.82506374259263, 394.9635284824952, 462.23104961023546, 425.2824020926081, 453.67915247279603, 325.9716742449247, 419.9464430638348, 194.11844913988614, 312.65328984573915, 274.75127421294457, 115.96040269088624, 249.36434599393107, 438.62512981628396, 65.74332075033318, 258.83577805736576, 340.7397200933879, 525.3606264597615, 434.9548252758859, 397.71777782772887, 309.3804243678065, 468.66488114581443, 444.12747023286244, 495.8603958731591, 3.6041967099659655, 293.247680364467, 295.9850935917883, 222.97661441407107, 260.47913419462094, 289.9753070486156, 412.1100634766974, 503.78871053162425, 40.95534807285684, 126.21174886072721, 185.20081130819835, 296.6243538131452, 405.3808941722374, 167.2960942106828, 104.98299988733609, 385.7703999869231, 484.3343992264629, 48.369085757755585, 387.30025640493517, 480.06102946889155, 417.83138611341815, 359.5555346478804, 388.1006430808734, 308.38937580258073, 211.6371579320287, 268.08163991940523, 18.97976267776198, 40.91484651390897, 360.13535769477835, 58.36222193398395, 248.738410679294, 329.0082414767856, 90.40994467415324, 404.8685597221975, 250.15756482168123, 167.49053253103054, 78.23500307331845, 434.81275582846655, 25.331644301949492, 258.70649064050417, 172.16477720179356, 297.64621895100015, 404.9957219349091, 404.07069233888086, 430.5353562664071, 133.07978215818633, 429.59818566792495, 514.7210781267991, 182.14491746834412, 426.18797607056973, 412.1017209137784, 123.34115280768515, 210.256202963907, 486.18580429231605, 288.3254303773495, 489.1288446719312, 391.9363335895391, 350.0491892113628, 433.6422492688707, 409.62955332005185, 400.9205910891612, 309.8925226909483, 171.59335059941733, 424.50602905051244, 117.31441600242869, 88.99122035525326, 305.0694154983236, 54.641536953801754, 316.49694310834025, 546.9566502948986, 407.0702801163273, 367.3908590372562, 377.7722245067675, 320.94108187971017, 418.9971738548485, 446.1056505210006, 310.9440974308909, 467.0433585698825, 96.38586951348398, 351.53858381275796, 472.35176510829393, 190.43735952570913, 157.37094585094428, 145.564330424358, 106.51051353549921, 284.5544926196975, 426.35394611584115, 6.603731724186084, 346.26306248350005, 204.65855558530546, 395.82029922540994, 255.43449972200293, 35.21429276092317, 383.2503494912344, 491.09419333396863, 476.8226362952526, 319.19174036081165, 269.1686475796849, 365.40010801463046, 350.00153379048777, 220.75767287976757, 362.09053726582283, 382.90892997266053, 301.7818779049549, 338.79173282510897, 33.76676569518135, 312.53304735696014, 302.51605386271336, 396.71429404189, 440.9969258266705, 363.54826702504164, 305.5458442437343, 389.9835473959455, 109.0262015206437, 454.42544647060697, 359.77482753923135, 405.31904560740213, 465.40241955556814, 454.1471182044667, 247.99604879409503, 471.06011989949604, 164.22832490202674, 405.35857939331265, 339.86289111988884, 39.214158150908325, 380.51146734401016, 363.1389370149685, 334.45948318779637, 296.27774417599704, 418.542318041325, 484.03537628780356, 388.0797365939579, 230.6559046645689, 385.5738418497227, 453.6814393603327, 454.951554108949, 14.23066013444634]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6439658277339413, "mean_inference_ms": 68.29147188436077, "mean_action_processing_ms": 0.25257698446030036, "mean_env_wait_ms": 9.512575275124941, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0105973482131958, "StateBufferConnector_ms": 0.0036160945892333984, "ViewRequirementAgentConnector_ms": 0.11330890655517578}, "num_episodes": 23, "episode_return_max": 373.57354481224303, "episode_return_min": -26.971520983645757, "episode_return_mean": 92.72211713886614, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 0.5921025065369148, "num_env_steps_trained_throughput_per_sec": 0.5921025065369148, "timesteps_total": 112000, "num_env_steps_sampled_lifetime": 112000, "num_agent_steps_sampled_lifetime": 448000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 448000, "timers": {"training_iteration_time_ms": 4013348.627, "restore_workers_time_ms": 0.012, "training_step_time_ms": 4013348.581, "sample_time_ms": 100051.093, "learn_time_ms": 3913278.393, "learn_throughput": 1.022, "synch_weights_time_ms": 15.666}, "counters": {"num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000}, "done": false, "training_iteration": 28, "trial_id": "b941d_00000", "date": "2024-08-17_19-49-11", "timestamp": 1723904351, "time_this_iter_s": 6755.624205112457, "time_total_s": 42915.60950899124, "pid": 81115, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[32, [4, 4], 2], [64, [3, 3], 2], [128, [3, 3], 1]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [256, 256], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2966430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 42915.60950899124, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 27.786010362694306, "ram_util_percent": 80.48134715025907}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.429347773708363, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.00010000000000000003, "total_loss": 8.411778005216487, "policy_loss": -0.08797093605297425, "vf_loss": 8.479666698798932, "vf_explained_var": 0.1551330428905588, "kl": 0.019834305899139794, "entropy": 1.0692652767297453, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 53865.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.782145392264008, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.00010000000000000003, "total_loss": 8.809722576191817, "policy_loss": -0.06810007126344042, "vf_loss": 8.860379829608574, "vf_explained_var": 0.10460582069618993, "kl": 0.017227486137533544, "entropy": 0.8017235061163624, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 53865.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_agent_steps_sampled": 464000, "num_agent_steps_trained": 464000}, "env_runners": {"episode_reward_max": 373.57354481224303, "episode_reward_min": -56.537507199447695, "episode_reward_mean": 86.98350570800007, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -561.7942321225897, "predator_policy": 3.6041967099659655}, "policy_reward_max": {"prey_policy": 178.41051620068086, "predator_policy": 555.507730135956}, "policy_reward_mean": {"prey_policy": -268.3159562183163, "predator_policy": 311.80770907231613}, "custom_metrics": {}, "hist_stats": {"episode_reward": [50.48859964814615, -20.589385742856702, 43.540350908669716, 66.81529296379188, 145.97687460618832, 78.18658354154138, 62.63665715940004, 96.18943568177257, 31.193575276319244, 131.21669688476194, 78.91656098083197, 80.46363288293102, 15.317176377247902, 8.959999999999964, 121.16860147773197, 190.45366509571915, 204.08245251056832, 27.679884627517193, 108.60912826450863, 139.69050129195745, 156.47360706275148, 49.1502866766537, 92.72605836333103, 26.974183578624313, 164.67464307537426, 373.57354481224303, 60.77387320122001, 1.890000000000002, 156.68392633233424, 59.51981324926119, 75.14807642159194, 148.72966617726792, 178.4151077306885, 114.12091269288364, 198.21841527859212, 261.45308239830626, 60.14703305649134, 22.988702436065395, 24.550196968479025, 41.806161894468694, -21.256868744217357, 102.83647779808949, -6.9378977765156735, 84.19003161734067, 195.19871957451443, 36.68434406193539, 283.57555112383557, 137.47607289882677, 78.52601184991596, 94.22746220043916, 112.61193884507149, -4.6013915617280645, 93.59678368404765, 1.2486495363515409, 49.024912051937406, 257.09, 111.20950445403085, 133.9774364929532, 64.662059832509, 210.52679085115557, -26.971520983645757, 14.743563217242034, 8.508082955082973, 44.89296838734542, 157.75407495020875, 23.299107405178287, 25.733212636619296, 20.079119630393603, 102.9775722600378, 99.44234822767426, 197.6701133059209, 65.26657243194025, 21.167675783722114, 108.47747052989011, 60.3292289959743, 122.48444578777061, 32.849824533966235, -26.15261492899224, 66.67186807134934, 127.031667789225, 0.3002298731325439, 184.0462781831576, 128.1335255519764, 115.92985009888174, 121.76133748182409, 26.20207448510753, -56.537507199447695, 272.3254829911967, 4.960626758927335, 28.282625382950382, 160.33065731283503, 1.1099999999999943, 258.3563305431088, 73.10943942510549, 71.63512932568673, -13.583840002451591, 43.41218833869602, -3.487608211221369, 45.400663308983326, 47.528141530785334], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-438.0710567671098, -429.4873789691641, -349.58342186461573, -170.9675629115106, -323.42130237839564, -81.82693893802251, -490.39152780454816, -330.3066309345037, -366.5710865891842, -267.1028655223496, -375.7163545851654, -160.16195407701366, -196.88077079072096, -327.8871361085635, -230.02079034304742, -39.114522659997576, -180.21166631482808, -292.96320897547065, -92.439481372124, -375.9193198938674, -364.815207422156, -516.5836833326593, -274.0619939584918, -352.5725753541137, -463.4551411744583, -434.0200338269707, -488.8603958731591, -1.6441967099659989, -299.13470001672283, -168.92947246180097, -295.86276377821616, 2.86068026524309, -51.256671190331886, -446.7462468244129, -138.27140832163525, -378.79276565532973, -136.5241384361288, -66.2792934682893, -301.5475648295731, -260.76718186385335, -40.93569857170536, -74.86978846356178, -463.73458914203843, -357.2199233946941, -133.72733147513696, -209.21595232422294, -424.648136772738, -446.2700952309476, -53.98957862830406, -528.9919560250759, -219.85402538014523, 73.4010364577786, -98.97794667636569, -127.30958271958104, -39.21484651390931, -359.9453576947785, 63.53255005465382, -213.94925633559802, 19.98935050653218, -379.8877234082095, -400.2663478477761, -179.61170027451098, 71.39055759706629, -168.38642702414694, -439.87842598735585, 158.14913358762823, -18.528959209956998, -298.221395939457, -68.34949219799377, -436.0740334093226, -533.1908394013354, -39.962126805646555, -63.94397868684159, -438.5869560827787, -514.0336301446049, -159.8436630144738, -438.99493309950685, -374.74456691636254, -87.34523441595528, -204.4459594611678, -357.5087650544544, -438.259338359429, -413.41765298590275, -364.8110474774788, -360.3638240979492, -430.26551215880005, -355.91062896504866, -370.4494838268244, -22.114436730873308, -264.17271698497836, -252.70823357429398, -252.42786741671267, 45.95357069640531, -156.43865542614662, -168.5505437008555, -65.11186346246106, -335.4078264040091, -540.0930921573009, -280.95387251682394, -369.981748826761, -312.27656199877754, -315.04975489070966, -334.4495427454086, -427.2015967682113, -231.30719829050963, -238.52524610880923, -346.22571308210024, -476.4159863026004, -50.763441909538074, -248.019951415178, -36.47433042435801, 41.489486464500786, -236.3426677395127, -363.35626654199586, -138.55305946958256, -80.33629824515094, -491.41017464287535, -44.40662033533129, 145.54278209652443, -225.66478372829502, -437.34871410832466, -463.9673497005242, -485.6138954938097, -295.656917945013, -440.40144913862036, -185.65922350061248, -235.74125295313922, -290.1249853297709, -42.70078641676126, -544.5446058715142, -285.7951794148465, -331.4793239100395, -88.32339928736353, -232.24320112815815, -307.7698494268964, -371.38137884731333, -270.11427575012186, -431.4533448415532, -431.8373004742278, -164.24974293777856, -395.8347331930181, 30.053198507688116, -299.7722191656633, -400.0550815490311, -409.9795124457156, -488.4023495305975, -426.3804586512889, -184.19823951241233, -452.26188904144374, -56.99578625792166, -52.60839268922185, -203.984210793805, -385.05771985072914, -325.7428599742834, -218.70504791988338, -438.1847943729023, -434.96777649468135, -400.9380497630981, -347.5633584119736, -144.14061505732863, -456.98338819002544, -381.9716631468976, 86.65714988113075, -371.79308594136853, 37.98818508743075, -371.7422384739023, -283.1357829523454, -220.65934309656777, -426.0444612958476, -216.992353027899, -301.7392337348094, -561.7942321225897, -203.82714620328707, -230.98759957945995, -139.3046661471857, -110.90869691277854, -473.89384580099437, -463.7857529415081, -512.5407884840794, -2.357831193235209, -397.0122411303306, -283.06708009666136, -436.56572068399134, -344.6839217720275, 178.41051620068086, -418.3572377556335, -218.28833007836096, -282.11077157627886, -167.72342446519414, -485.40239967133846, -334.0050463478659, -443.4204304679738, -397.94628154542465, -308.6961601276506, -92.60923961048162, -488.26081124038205, -37.17519116511029, -334.74046304012785, -315.52569714997475, -308.3304370048126], "policy_predator_policy_reward": [440.05002757896267, 477.99700780545675, 427.6941299601202, 72.26746907314923, 53.82506374259263, 394.9635284824952, 462.23104961023546, 425.2824020926081, 453.67915247279603, 325.9716742449247, 419.9464430638348, 194.11844913988614, 312.65328984573915, 274.75127421294457, 115.96040269088624, 249.36434599393107, 438.62512981628396, 65.74332075033318, 258.83577805736576, 340.7397200933879, 525.3606264597615, 434.9548252758859, 397.71777782772887, 309.3804243678065, 468.66488114581443, 444.12747023286244, 495.8603958731591, 3.6041967099659655, 293.247680364467, 295.9850935917883, 222.97661441407107, 260.47913419462094, 289.9753070486156, 412.1100634766974, 503.78871053162425, 40.95534807285684, 126.21174886072721, 185.20081130819835, 296.6243538131452, 405.3808941722374, 167.2960942106828, 104.98299988733609, 385.7703999869231, 484.3343992264629, 48.369085757755585, 387.30025640493517, 480.06102946889155, 417.83138611341815, 359.5555346478804, 388.1006430808734, 308.38937580258073, 211.6371579320287, 268.08163991940523, 18.97976267776198, 40.91484651390897, 360.13535769477835, 58.36222193398395, 248.738410679294, 329.0082414767856, 90.40994467415324, 404.8685597221975, 250.15756482168123, 167.49053253103054, 78.23500307331845, 434.81275582846655, 25.331644301949492, 258.70649064050417, 172.16477720179356, 297.64621895100015, 404.9957219349091, 404.07069233888086, 430.5353562664071, 133.07978215818633, 429.59818566792495, 514.7210781267991, 182.14491746834412, 426.18797607056973, 412.1017209137784, 123.34115280768515, 210.256202963907, 486.18580429231605, 288.3254303773495, 489.1288446719312, 391.9363335895391, 350.0491892113628, 433.6422492688707, 409.62955332005185, 400.9205910891612, 309.8925226909483, 171.59335059941733, 424.50602905051244, 117.31441600242869, 88.99122035525326, 305.0694154983236, 54.641536953801754, 316.49694310834025, 546.9566502948986, 407.0702801163273, 367.3908590372562, 377.7722245067675, 320.94108187971017, 418.9971738548485, 446.1056505210006, 310.9440974308909, 467.0433585698825, 96.38586951348398, 351.53858381275796, 472.35176510829393, 190.43735952570913, 157.37094585094428, 145.564330424358, 106.51051353549921, 284.5544926196975, 426.35394611584115, 6.603731724186084, 346.26306248350005, 204.65855558530546, 395.82029922540994, 255.43449972200293, 35.21429276092317, 383.2503494912344, 491.09419333396863, 476.8226362952526, 319.19174036081165, 269.1686475796849, 365.40010801463046, 350.00153379048777, 220.75767287976757, 362.09053726582283, 382.90892997266053, 301.7818779049549, 338.79173282510897, 33.76676569518135, 312.53304735696014, 302.51605386271336, 396.71429404189, 440.9969258266705, 363.54826702504164, 305.5458442437343, 389.9835473959455, 109.0262015206437, 454.42544647060697, 359.77482753923135, 405.31904560740213, 465.40241955556814, 454.1471182044667, 247.99604879409503, 471.06011989949604, 164.22832490202674, 405.35857939331265, 339.86289111988884, 39.214158150908325, 380.51146734401016, 363.1389370149685, 334.45948318779637, 296.27774417599704, 418.542318041325, 484.03537628780356, 388.0797365939579, 230.6559046645689, 385.5738418497227, 453.6814393603327, 454.951554108949, 14.23066013444634, 169.50784425759258, 292.37973468085534, 215.375608009547, 404.3493681382478, 403.3472560519832, 361.4508957535863, 334.22781020655054, 555.507730135956, 342.386122799085, 35.8911157842132, 112.18150143113814, 410.3573446200225, 490.45062030472764, 452.1896051967019, 41.97932433611795, 501.201920724147, 336.12019898792283, 504.28977955190345, 437.6157206839913, 344.7439217720274, 107.81170608906412, 390.491346008997, 160.5203572644374, 412.98818381530674, 432.26667262270297, 292.4942808395156, 404.9401960128896, 358.9014408004984, 376.0940816426954, 373.96054836907615, 82.07626338398404, 495.30617925565895, 102.67882460646516, 314.63749290775587, 202.41435644543665, 468.96991924013486]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.282160319902824, "mean_inference_ms": 70.99098830015483, "mean_action_processing_ms": 0.25286608083963513, "mean_env_wait_ms": 10.015111372657366, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010026931762695312, "StateBufferConnector_ms": 0.0036110877990722656, "ViewRequirementAgentConnector_ms": 0.11340582370758057}, "num_episodes": 18, "episode_return_max": 373.57354481224303, "episode_return_min": -56.537507199447695, "episode_return_mean": 86.98350570800007, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 464000, "num_agent_steps_trained": 464000, "num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1.0886242160100257, "num_env_steps_trained_throughput_per_sec": 1.0886242160100257, "timesteps_total": 116000, "num_env_steps_sampled_lifetime": 116000, "num_agent_steps_sampled_lifetime": 464000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 464000, "timers": {"training_iteration_time_ms": 4367769.965, "restore_workers_time_ms": 0.012, "training_step_time_ms": 4367769.918, "sample_time_ms": 152891.874, "learn_time_ms": 4214859.064, "learn_throughput": 0.949, "synch_weights_time_ms": 15.445}, "counters": {"num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_agent_steps_sampled": 464000, "num_agent_steps_trained": 464000}, "done": false, "training_iteration": 29, "trial_id": "b941d_00000", "date": "2024-08-17_20-50-25", "timestamp": 1723908025, "time_this_iter_s": 3674.389127969742, "time_total_s": 46589.99863696098, "pid": 81115, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[32, [4, 4], 2], [64, [3, 3], 2], [128, [3, 3], 1]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [256, 256], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b03019d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 46589.99863696098, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 23.330000000000005, "ram_util_percent": 79.1821052631579}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.845441434496925, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.00010000000000000003, "total_loss": 8.827050911938702, "policy_loss": -0.08982094217229772, "vf_loss": 8.896891533130061, "vf_explained_var": 0.32077320407307336, "kl": 0.019733662922368656, "entropy": 1.0892867918683107, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 55755.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.516666689120903, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.00010000000000000003, "total_loss": 8.84386098397472, "policy_loss": -0.07338404412179318, "vf_loss": 8.897392720015592, "vf_explained_var": 0.08484786789884012, "kl": 0.01960724930962491, "entropy": 0.7776968153380843, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 55755.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000}, "env_runners": {"episode_reward_max": 373.57354481224303, "episode_reward_min": -56.537507199447695, "episode_reward_mean": 90.79837895082078, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -561.7942321225897, "predator_policy": 6.603731724186084}, "policy_reward_max": {"prey_policy": 178.41051620068086, "predator_policy": 562.6672543320466}, "policy_reward_mean": {"prey_policy": -268.936977223213, "predator_policy": 314.3361666986232}, "custom_metrics": {}, "hist_stats": {"episode_reward": [108.60912826450863, 139.69050129195745, 156.47360706275148, 49.1502866766537, 92.72605836333103, 26.974183578624313, 164.67464307537426, 373.57354481224303, 60.77387320122001, 1.890000000000002, 156.68392633233424, 59.51981324926119, 75.14807642159194, 148.72966617726792, 178.4151077306885, 114.12091269288364, 198.21841527859212, 261.45308239830626, 60.14703305649134, 22.988702436065395, 24.550196968479025, 41.806161894468694, -21.256868744217357, 102.83647779808949, -6.9378977765156735, 84.19003161734067, 195.19871957451443, 36.68434406193539, 283.57555112383557, 137.47607289882677, 78.52601184991596, 94.22746220043916, 112.61193884507149, -4.6013915617280645, 93.59678368404765, 1.2486495363515409, 49.024912051937406, 257.09, 111.20950445403085, 133.9774364929532, 64.662059832509, 210.52679085115557, -26.971520983645757, 14.743563217242034, 8.508082955082973, 44.89296838734542, 157.75407495020875, 23.299107405178287, 25.733212636619296, 20.079119630393603, 102.9775722600378, 99.44234822767426, 197.6701133059209, 65.26657243194025, 21.167675783722114, 108.47747052989011, 60.3292289959743, 122.48444578777061, 32.849824533966235, -26.15261492899224, 66.67186807134934, 127.031667789225, 0.3002298731325439, 184.0462781831576, 128.1335255519764, 115.92985009888174, 121.76133748182409, 26.20207448510753, -56.537507199447695, 272.3254829911967, 4.960626758927335, 28.282625382950382, 160.33065731283503, 1.1099999999999943, 258.3563305431088, 73.10943942510549, 71.63512932568673, -13.583840002451591, 43.41218833869602, -3.487608211221369, 45.400663308983326, 47.528141530785334, -8.035426420223438, 4.918228360189659, 2.722569616895929, -1.460519770734562, 70.09701912100967, 113.70179748882123, 57.44154663473728, 42.83640069516744, 129.63665996391978, 98.69504206232618, 256.5846243408726, 134.45576090490584, 109.1549733872039, 196.12334035127657, 262.2601274091887, 282.42067801711534, 20.37115699967855, 22.260000000000005], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-136.5241384361288, -66.2792934682893, -301.5475648295731, -260.76718186385335, -40.93569857170536, -74.86978846356178, -463.73458914203843, -357.2199233946941, -133.72733147513696, -209.21595232422294, -424.648136772738, -446.2700952309476, -53.98957862830406, -528.9919560250759, -219.85402538014523, 73.4010364577786, -98.97794667636569, -127.30958271958104, -39.21484651390931, -359.9453576947785, 63.53255005465382, -213.94925633559802, 19.98935050653218, -379.8877234082095, -400.2663478477761, -179.61170027451098, 71.39055759706629, -168.38642702414694, -439.87842598735585, 158.14913358762823, -18.528959209956998, -298.221395939457, -68.34949219799377, -436.0740334093226, -533.1908394013354, -39.962126805646555, -63.94397868684159, -438.5869560827787, -514.0336301446049, -159.8436630144738, -438.99493309950685, -374.74456691636254, -87.34523441595528, -204.4459594611678, -357.5087650544544, -438.259338359429, -413.41765298590275, -364.8110474774788, -360.3638240979492, -430.26551215880005, -355.91062896504866, -370.4494838268244, -22.114436730873308, -264.17271698497836, -252.70823357429398, -252.42786741671267, 45.95357069640531, -156.43865542614662, -168.5505437008555, -65.11186346246106, -335.4078264040091, -540.0930921573009, -280.95387251682394, -369.981748826761, -312.27656199877754, -315.04975489070966, -334.4495427454086, -427.2015967682113, -231.30719829050963, -238.52524610880923, -346.22571308210024, -476.4159863026004, -50.763441909538074, -248.019951415178, -36.47433042435801, 41.489486464500786, -236.3426677395127, -363.35626654199586, -138.55305946958256, -80.33629824515094, -491.41017464287535, -44.40662033533129, 145.54278209652443, -225.66478372829502, -437.34871410832466, -463.9673497005242, -485.6138954938097, -295.656917945013, -440.40144913862036, -185.65922350061248, -235.74125295313922, -290.1249853297709, -42.70078641676126, -544.5446058715142, -285.7951794148465, -331.4793239100395, -88.32339928736353, -232.24320112815815, -307.7698494268964, -371.38137884731333, -270.11427575012186, -431.4533448415532, -431.8373004742278, -164.24974293777856, -395.8347331930181, 30.053198507688116, -299.7722191656633, -400.0550815490311, -409.9795124457156, -488.4023495305975, -426.3804586512889, -184.19823951241233, -452.26188904144374, -56.99578625792166, -52.60839268922185, -203.984210793805, -385.05771985072914, -325.7428599742834, -218.70504791988338, -438.1847943729023, -434.96777649468135, -400.9380497630981, -347.5633584119736, -144.14061505732863, -456.98338819002544, -381.9716631468976, 86.65714988113075, -371.79308594136853, 37.98818508743075, -371.7422384739023, -283.1357829523454, -220.65934309656777, -426.0444612958476, -216.992353027899, -301.7392337348094, -561.7942321225897, -203.82714620328707, -230.98759957945995, -139.3046661471857, -110.90869691277854, -473.89384580099437, -463.7857529415081, -512.5407884840794, -2.357831193235209, -397.0122411303306, -283.06708009666136, -436.56572068399134, -344.6839217720275, 178.41051620068086, -418.3572377556335, -218.28833007836096, -282.11077157627886, -167.72342446519414, -485.40239967133846, -334.0050463478659, -443.4204304679738, -397.94628154542465, -308.6961601276506, -92.60923961048162, -488.26081124038205, -37.17519116511029, -334.74046304012785, -315.52569714997475, -308.3304370048126, -426.39183410866286, -300.90101349649893, -524.448743944692, -418.145063014263, -292.62713705963046, -178.24041070569245, -80.555273195776, -423.1811561408399, -144.20722282142822, -470.48684285684186, -138.16404561277645, -524.2567033737184, -383.8853625416264, -273.59356983394537, -382.49204414711437, -344.1005516904761, -256.990476355859, -347.10305956511473, -204.19438269008907, -310.86140501502763, -561.425799647404, 61.25181864886084, -336.5930883654219, -211.22335100513857, -49.93647657681655, -500.19303268220875, -152.48737894463, -50.39271414651439, -42.490912589060706, -457.66706783198214, -440.4434716753836, 119.6803035746101, -256.2251878222041, -316.4856971132191, -364.1770891071768, -331.76031096096403], "policy_predator_policy_reward": [126.21174886072721, 185.20081130819835, 296.6243538131452, 405.3808941722374, 167.2960942106828, 104.98299988733609, 385.7703999869231, 484.3343992264629, 48.369085757755585, 387.30025640493517, 480.06102946889155, 417.83138611341815, 359.5555346478804, 388.1006430808734, 308.38937580258073, 211.6371579320287, 268.08163991940523, 18.97976267776198, 40.91484651390897, 360.13535769477835, 58.36222193398395, 248.738410679294, 329.0082414767856, 90.40994467415324, 404.8685597221975, 250.15756482168123, 167.49053253103054, 78.23500307331845, 434.81275582846655, 25.331644301949492, 258.70649064050417, 172.16477720179356, 297.64621895100015, 404.9957219349091, 404.07069233888086, 430.5353562664071, 133.07978215818633, 429.59818566792495, 514.7210781267991, 182.14491746834412, 426.18797607056973, 412.1017209137784, 123.34115280768515, 210.256202963907, 486.18580429231605, 288.3254303773495, 489.1288446719312, 391.9363335895391, 350.0491892113628, 433.6422492688707, 409.62955332005185, 400.9205910891612, 309.8925226909483, 171.59335059941733, 424.50602905051244, 117.31441600242869, 88.99122035525326, 305.0694154983236, 54.641536953801754, 316.49694310834025, 546.9566502948986, 407.0702801163273, 367.3908590372562, 377.7722245067675, 320.94108187971017, 418.9971738548485, 446.1056505210006, 310.9440974308909, 467.0433585698825, 96.38586951348398, 351.53858381275796, 472.35176510829393, 190.43735952570913, 157.37094585094428, 145.564330424358, 106.51051353549921, 284.5544926196975, 426.35394611584115, 6.603731724186084, 346.26306248350005, 204.65855558530546, 395.82029922540994, 255.43449972200293, 35.21429276092317, 383.2503494912344, 491.09419333396863, 476.8226362952526, 319.19174036081165, 269.1686475796849, 365.40010801463046, 350.00153379048777, 220.75767287976757, 362.09053726582283, 382.90892997266053, 301.7818779049549, 338.79173282510897, 33.76676569518135, 312.53304735696014, 302.51605386271336, 396.71429404189, 440.9969258266705, 363.54826702504164, 305.5458442437343, 389.9835473959455, 109.0262015206437, 454.42544647060697, 359.77482753923135, 405.31904560740213, 465.40241955556814, 454.1471182044667, 247.99604879409503, 471.06011989949604, 164.22832490202674, 405.35857939331265, 339.86289111988884, 39.214158150908325, 380.51146734401016, 363.1389370149685, 334.45948318779637, 296.27774417599704, 418.542318041325, 484.03537628780356, 388.0797365939579, 230.6559046645689, 385.5738418497227, 453.6814393603327, 454.951554108949, 14.23066013444634, 169.50784425759258, 292.37973468085534, 215.375608009547, 404.3493681382478, 403.3472560519832, 361.4508957535863, 334.22781020655054, 555.507730135956, 342.386122799085, 35.8911157842132, 112.18150143113814, 410.3573446200225, 490.45062030472764, 452.1896051967019, 41.97932433611795, 501.201920724147, 336.12019898792283, 504.28977955190345, 437.6157206839913, 344.7439217720274, 107.81170608906412, 390.491346008997, 160.5203572644374, 412.98818381530674, 432.26667262270297, 292.4942808395156, 404.9401960128896, 358.9014408004984, 376.0940816426954, 373.96054836907615, 82.07626338398404, 495.30617925565895, 102.67882460646516, 314.63749290775587, 202.41435644543665, 468.96991924013486, 389.9987979531615, 329.25862323177716, 524.3095668420949, 423.2024684770496, 159.31036440710923, 314.27975297511034, 296.5452297593984, 205.73067980648293, 430.7494628524931, 254.04162194678534, 213.45529214326928, 562.6672543320466, 461.6969406269665, 253.22353838334172, 394.7451120020354, 374.6838845307218, 369.6366185567215, 364.093577328172, 433.4513702055444, 180.2994595618986, 528.5288834296781, 228.22972190973735, 299.2275846142364, 383.0446156612298, 293.69651938289803, 365.5879632633303, 114.73938652861595, 284.26404691380463, 339.0909039094417, 423.32720392079005, 223.6730034437598, 379.51084267412944, 413.33454469919496, 179.74749723590574, 386.2270891071769, 331.97031096096384]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.865500098430806, "mean_inference_ms": 73.68431040306325, "mean_action_processing_ms": 0.25302211234153676, "mean_env_wait_ms": 10.51302110020385, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008362531661987305, "StateBufferConnector_ms": 0.003520369529724121, "ViewRequirementAgentConnector_ms": 0.11080586910247803}, "num_episodes": 18, "episode_return_max": 373.57354481224303, "episode_return_min": -56.537507199447695, "episode_return_mean": 90.79837895082078, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 0.9579735784022143, "num_env_steps_trained_throughput_per_sec": 0.9579735784022143, "timesteps_total": 120000, "num_env_steps_sampled_lifetime": 120000, "num_agent_steps_sampled_lifetime": 480000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 480000, "timers": {"training_iteration_time_ms": 4772317.137, "restore_workers_time_ms": 0.013, "training_step_time_ms": 4772317.065, "sample_time_ms": 152891.526, "learn_time_ms": 4619404.899, "learn_throughput": 0.866, "synch_weights_time_ms": 16.806}, "counters": {"num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000}, "done": false, "training_iteration": 30, "trial_id": "b941d_00000", "date": "2024-08-17_22-00-01", "timestamp": 1723912201, "time_this_iter_s": 4175.530601024628, "time_total_s": 50765.52923798561, "pid": 81115, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[32, [4, 4], 2], [64, [3, 3], 2], [128, [3, 3], 1]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [256, 256], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b0495dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 50765.52923798561, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 25.78789473684211, "ram_util_percent": 79.36315789473684}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 12.05618945227729, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.00010000000000000003, "total_loss": 8.486334217162359, "policy_loss": -0.0914875970958737, "vf_loss": 8.558336011694852, "vf_explained_var": 0.2650838908379671, "kl": 0.019245244197790102, "entropy": 1.064879744803464, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 57645.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.68165265107281, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.00010000000000000003, "total_loss": 8.946189830921314, "policy_loss": -0.07788665780166863, "vf_loss": 9.005391169855834, "vf_explained_var": 0.02659639274632489, "kl": 0.018454629402854486, "entropy": 0.7958412225284274, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 57645.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_agent_steps_sampled": 496000, "num_agent_steps_trained": 496000}, "env_runners": {"episode_reward_max": 337.4028969732097, "episode_reward_min": -56.537507199447695, "episode_reward_mean": 83.61203371763621, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -563.5574776719069, "predator_policy": 6.603731724186084}, "policy_reward_max": {"prey_policy": 185.3081177656631, "predator_policy": 562.6672543320466}, "policy_reward_mean": {"prey_policy": -288.10466112814436, "predator_policy": 329.91067798696236}, "custom_metrics": {}, "hist_stats": {"episode_reward": [60.14703305649134, 22.988702436065395, 24.550196968479025, 41.806161894468694, -21.256868744217357, 102.83647779808949, -6.9378977765156735, 84.19003161734067, 195.19871957451443, 36.68434406193539, 283.57555112383557, 137.47607289882677, 78.52601184991596, 94.22746220043916, 112.61193884507149, -4.6013915617280645, 93.59678368404765, 1.2486495363515409, 49.024912051937406, 257.09, 111.20950445403085, 133.9774364929532, 64.662059832509, 210.52679085115557, -26.971520983645757, 14.743563217242034, 8.508082955082973, 44.89296838734542, 157.75407495020875, 23.299107405178287, 25.733212636619296, 20.079119630393603, 102.9775722600378, 99.44234822767426, 197.6701133059209, 65.26657243194025, 21.167675783722114, 108.47747052989011, 60.3292289959743, 122.48444578777061, 32.849824533966235, -26.15261492899224, 66.67186807134934, 127.031667789225, 0.3002298731325439, 184.0462781831576, 128.1335255519764, 115.92985009888174, 121.76133748182409, 26.20207448510753, -56.537507199447695, 272.3254829911967, 4.960626758927335, 28.282625382950382, 160.33065731283503, 1.1099999999999943, 258.3563305431088, 73.10943942510549, 71.63512932568673, -13.583840002451591, 43.41218833869602, -3.487608211221369, 45.400663308983326, 47.528141530785334, -8.035426420223438, 4.918228360189659, 2.722569616895929, -1.460519770734562, 70.09701912100967, 113.70179748882123, 57.44154663473728, 42.83640069516744, 129.63665996391978, 98.69504206232618, 256.5846243408726, 134.45576090490584, 109.1549733872039, 196.12334035127657, 262.2601274091887, 282.42067801711534, 20.37115699967855, 22.260000000000005, 16.25532348719182, 228.32860723991172, 3.89835802153668, 18.514423819498063, 73.0503969645312, 93.53509203416118, 27.754122375345194, 101.35655769168564, 337.4028969732097, 67.11843390938897, 161.4219696376826, 189.45209682041698, 67.88049371972228, 54.42177530718912, -21.153409420337812, 40.76330997053858, 124.38381231210612, 63.80604242535672], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-63.94397868684159, -438.5869560827787, -514.0336301446049, -159.8436630144738, -438.99493309950685, -374.74456691636254, -87.34523441595528, -204.4459594611678, -357.5087650544544, -438.259338359429, -413.41765298590275, -364.8110474774788, -360.3638240979492, -430.26551215880005, -355.91062896504866, -370.4494838268244, -22.114436730873308, -264.17271698497836, -252.70823357429398, -252.42786741671267, 45.95357069640531, -156.43865542614662, -168.5505437008555, -65.11186346246106, -335.4078264040091, -540.0930921573009, -280.95387251682394, -369.981748826761, -312.27656199877754, -315.04975489070966, -334.4495427454086, -427.2015967682113, -231.30719829050963, -238.52524610880923, -346.22571308210024, -476.4159863026004, -50.763441909538074, -248.019951415178, -36.47433042435801, 41.489486464500786, -236.3426677395127, -363.35626654199586, -138.55305946958256, -80.33629824515094, -491.41017464287535, -44.40662033533129, 145.54278209652443, -225.66478372829502, -437.34871410832466, -463.9673497005242, -485.6138954938097, -295.656917945013, -440.40144913862036, -185.65922350061248, -235.74125295313922, -290.1249853297709, -42.70078641676126, -544.5446058715142, -285.7951794148465, -331.4793239100395, -88.32339928736353, -232.24320112815815, -307.7698494268964, -371.38137884731333, -270.11427575012186, -431.4533448415532, -431.8373004742278, -164.24974293777856, -395.8347331930181, 30.053198507688116, -299.7722191656633, -400.0550815490311, -409.9795124457156, -488.4023495305975, -426.3804586512889, -184.19823951241233, -452.26188904144374, -56.99578625792166, -52.60839268922185, -203.984210793805, -385.05771985072914, -325.7428599742834, -218.70504791988338, -438.1847943729023, -434.96777649468135, -400.9380497630981, -347.5633584119736, -144.14061505732863, -456.98338819002544, -381.9716631468976, 86.65714988113075, -371.79308594136853, 37.98818508743075, -371.7422384739023, -283.1357829523454, -220.65934309656777, -426.0444612958476, -216.992353027899, -301.7392337348094, -561.7942321225897, -203.82714620328707, -230.98759957945995, -139.3046661471857, -110.90869691277854, -473.89384580099437, -463.7857529415081, -512.5407884840794, -2.357831193235209, -397.0122411303306, -283.06708009666136, -436.56572068399134, -344.6839217720275, 178.41051620068086, -418.3572377556335, -218.28833007836096, -282.11077157627886, -167.72342446519414, -485.40239967133846, -334.0050463478659, -443.4204304679738, -397.94628154542465, -308.6961601276506, -92.60923961048162, -488.26081124038205, -37.17519116511029, -334.74046304012785, -315.52569714997475, -308.3304370048126, -426.39183410866286, -300.90101349649893, -524.448743944692, -418.145063014263, -292.62713705963046, -178.24041070569245, -80.555273195776, -423.1811561408399, -144.20722282142822, -470.48684285684186, -138.16404561277645, -524.2567033737184, -383.8853625416264, -273.59356983394537, -382.49204414711437, -344.1005516904761, -256.990476355859, -347.10305956511473, -204.19438269008907, -310.86140501502763, -561.425799647404, 61.25181864886084, -336.5930883654219, -211.22335100513857, -49.93647657681655, -500.19303268220875, -152.48737894463, -50.39271414651439, -42.490912589060706, -457.66706783198214, -440.4434716753836, 119.6803035746101, -256.2251878222041, -316.4856971132191, -364.1770891071768, -331.76031096096403, -375.6630196763018, -342.06687439157344, 137.07191703080127, -503.80925323974355, -261.4984919682629, -410.7316211111237, -319.90588202156084, -406.6556550602906, -553.9910369648355, -280.35089537225707, -463.50327158134377, -406.9604924105096, -395.6704595497467, -282.293684713892, -412.54168970798304, -163.6950302845521, 185.3081177656631, -431.44552223906805, -11.274190050239874, -475.982996818096, 110.74269697067243, -465.99135561059995, -46.37949421155588, -466.93870088627204, -442.8692028753369, -294.67274120186136, -191.44248698611727, -491.43289864072966, -368.36845308364633, -563.5574776719069, -303.97914301420326, -209.60052986209706, -426.8693528767964, -127.49684450355433, -257.79886086432094, -245.08899055173714], "policy_predator_policy_reward": [133.07978215818633, 429.59818566792495, 514.7210781267991, 182.14491746834412, 426.18797607056973, 412.1017209137784, 123.34115280768515, 210.256202963907, 486.18580429231605, 288.3254303773495, 489.1288446719312, 391.9363335895391, 350.0491892113628, 433.6422492688707, 409.62955332005185, 400.9205910891612, 309.8925226909483, 171.59335059941733, 424.50602905051244, 117.31441600242869, 88.99122035525326, 305.0694154983236, 54.641536953801754, 316.49694310834025, 546.9566502948986, 407.0702801163273, 367.3908590372562, 377.7722245067675, 320.94108187971017, 418.9971738548485, 446.1056505210006, 310.9440974308909, 467.0433585698825, 96.38586951348398, 351.53858381275796, 472.35176510829393, 190.43735952570913, 157.37094585094428, 145.564330424358, 106.51051353549921, 284.5544926196975, 426.35394611584115, 6.603731724186084, 346.26306248350005, 204.65855558530546, 395.82029922540994, 255.43449972200293, 35.21429276092317, 383.2503494912344, 491.09419333396863, 476.8226362952526, 319.19174036081165, 269.1686475796849, 365.40010801463046, 350.00153379048777, 220.75767287976757, 362.09053726582283, 382.90892997266053, 301.7818779049549, 338.79173282510897, 33.76676569518135, 312.53304735696014, 302.51605386271336, 396.71429404189, 440.9969258266705, 363.54826702504164, 305.5458442437343, 389.9835473959455, 109.0262015206437, 454.42544647060697, 359.77482753923135, 405.31904560740213, 465.40241955556814, 454.1471182044667, 247.99604879409503, 471.06011989949604, 164.22832490202674, 405.35857939331265, 339.86289111988884, 39.214158150908325, 380.51146734401016, 363.1389370149685, 334.45948318779637, 296.27774417599704, 418.542318041325, 484.03537628780356, 388.0797365939579, 230.6559046645689, 385.5738418497227, 453.6814393603327, 454.951554108949, 14.23066013444634, 169.50784425759258, 292.37973468085534, 215.375608009547, 404.3493681382478, 403.3472560519832, 361.4508957535863, 334.22781020655054, 555.507730135956, 342.386122799085, 35.8911157842132, 112.18150143113814, 410.3573446200225, 490.45062030472764, 452.1896051967019, 41.97932433611795, 501.201920724147, 336.12019898792283, 504.28977955190345, 437.6157206839913, 344.7439217720274, 107.81170608906412, 390.491346008997, 160.5203572644374, 412.98818381530674, 432.26667262270297, 292.4942808395156, 404.9401960128896, 358.9014408004984, 376.0940816426954, 373.96054836907615, 82.07626338398404, 495.30617925565895, 102.67882460646516, 314.63749290775587, 202.41435644543665, 468.96991924013486, 389.9987979531615, 329.25862323177716, 524.3095668420949, 423.2024684770496, 159.31036440710923, 314.27975297511034, 296.5452297593984, 205.73067980648293, 430.7494628524931, 254.04162194678534, 213.45529214326928, 562.6672543320466, 461.6969406269665, 253.22353838334172, 394.7451120020354, 374.6838845307218, 369.6366185567215, 364.093577328172, 433.4513702055444, 180.2994595618986, 528.5288834296781, 228.22972190973735, 299.2275846142364, 383.0446156612298, 293.69651938289803, 365.5879632633303, 114.73938652861595, 284.26404691380463, 339.0909039094417, 423.32720392079005, 223.6730034437598, 379.51084267412944, 413.33454469919496, 179.74749723590574, 386.2270891071769, 331.97031096096384, 456.88248055592993, 277.1027369991371, 290.4351591822231, 304.6307842666309, 265.396849989799, 410.7316211111237, 296.5374066989407, 448.5385542024088, 487.8825600429526, 419.5097692586712, 529.0826583913845, 434.91619763462916, 417.39156580253825, 288.32670083644535, 334.8685523883198, 342.72472529590056, 255.90847843850344, 327.6318230081113, 419.8644981114981, 134.51112266622593, 50.61927266701019, 466.0513556105999, 380.2618431494413, 322.5084487688036, 343.65888209566594, 461.7635557012537, 257.48084757787115, 479.81631335616447, 407.388836280921, 503.38368505429463, 285.5297180934712, 268.813264753367, 428.95009241654697, 249.7999172759101, 300.69827024795677, 265.99562359345816]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.398157732402451, "mean_inference_ms": 76.37031658330707, "mean_action_processing_ms": 0.2532843252433268, "mean_env_wait_ms": 11.005934979109123, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007961750030517578, "StateBufferConnector_ms": 0.003542780876159668, "ViewRequirementAgentConnector_ms": 0.11490428447723389}, "num_episodes": 18, "episode_return_max": 337.4028969732097, "episode_return_min": -56.537507199447695, "episode_return_mean": 83.61203371763621, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 496000, "num_agent_steps_trained": 496000, "num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 0.7202951495887024, "num_env_steps_trained_throughput_per_sec": 0.7202951495887024, "timesteps_total": 124000, "num_env_steps_sampled_lifetime": 124000, "num_agent_steps_sampled_lifetime": 496000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 496000, "timers": {"training_iteration_time_ms": 5314699.899, "restore_workers_time_ms": 0.014, "training_step_time_ms": 5314699.822, "sample_time_ms": 152932.926, "learn_time_ms": 5161744.383, "learn_throughput": 0.775, "synch_weights_time_ms": 18.555}, "counters": {"num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_agent_steps_sampled": 496000, "num_agent_steps_trained": 496000}, "done": false, "training_iteration": 31, "trial_id": "b941d_00000", "date": "2024-08-17_23-32-34", "timestamp": 1723917754, "time_this_iter_s": 5553.296865224838, "time_total_s": 56318.82610321045, "pid": 81115, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[32, [4, 4], 2], [64, [3, 3], 2], [128, [3, 3], 1]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [256, 256], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b02b6c10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 56318.82610321045, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 47.7609375, "ram_util_percent": 79.24140625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 16.375537577760284, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.00010000000000000003, "total_loss": 7.911923984497313, "policy_loss": -0.08702256382891425, "vf_loss": 7.979575643842183, "vf_explained_var": 0.4206093301218023, "kl": 0.019131753027713118, "entropy": 1.0686953322912651, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 59535.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.069945416248665, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.00010000000000000003, "total_loss": 8.490347860225294, "policy_loss": -0.07373754136885206, "vf_loss": 8.546001673249341, "vf_explained_var": 0.10437929021618354, "kl": 0.017860473168448344, "entropy": 0.8266172679959151, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 59535.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 512000, "num_agent_steps_trained": 512000}, "env_runners": {"episode_reward_max": 368.49082860227395, "episode_reward_min": -56.537507199447695, "episode_reward_mean": 92.83155360765183, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -563.5574776719069, "predator_policy": 6.672199728793571}, "policy_reward_max": {"prey_policy": 185.3081177656631, "predator_policy": 562.6672543320466}, "policy_reward_mean": {"prey_policy": -286.76088231513603, "predator_policy": 333.1766591189618}, "custom_metrics": {}, "hist_stats": {"episode_reward": [44.89296838734542, 157.75407495020875, 23.299107405178287, 25.733212636619296, 20.079119630393603, 102.9775722600378, 99.44234822767426, 197.6701133059209, 65.26657243194025, 21.167675783722114, 108.47747052989011, 60.3292289959743, 122.48444578777061, 32.849824533966235, -26.15261492899224, 66.67186807134934, 127.031667789225, 0.3002298731325439, 184.0462781831576, 128.1335255519764, 115.92985009888174, 121.76133748182409, 26.20207448510753, -56.537507199447695, 272.3254829911967, 4.960626758927335, 28.282625382950382, 160.33065731283503, 1.1099999999999943, 258.3563305431088, 73.10943942510549, 71.63512932568673, -13.583840002451591, 43.41218833869602, -3.487608211221369, 45.400663308983326, 47.528141530785334, -8.035426420223438, 4.918228360189659, 2.722569616895929, -1.460519770734562, 70.09701912100967, 113.70179748882123, 57.44154663473728, 42.83640069516744, 129.63665996391978, 98.69504206232618, 256.5846243408726, 134.45576090490584, 109.1549733872039, 196.12334035127657, 262.2601274091887, 282.42067801711534, 20.37115699967855, 22.260000000000005, 16.25532348719182, 228.32860723991172, 3.89835802153668, 18.514423819498063, 73.0503969645312, 93.53509203416118, 27.754122375345194, 101.35655769168564, 337.4028969732097, 67.11843390938897, 161.4219696376826, 189.45209682041698, 67.88049371972228, 54.42177530718912, -21.153409420337812, 40.76330997053858, 124.38381231210612, 63.80604242535672, 140.97589494831925, 28.970582635400575, 191.73331991050202, 120.14000000000004, 188.09999999999997, 115.83402213324378, 90.17936060646548, 93.36614216893868, 62.62016630068721, 23.594329810792622, 155.98512793752568, 92.24816344446965, 72.11429175196005, 368.49082860227395, 33.85331404814125, 55.27831746414236, 339.50192799469727, 258.05242239884757, 161.0730467081689, 40.7806263920856, 168.544756674182, 28.657167260799383, -5.291600481164752, 3.5321879877081988, 61.071996823453375, 52.72668899090054, 139.45771482369742], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-235.74125295313922, -290.1249853297709, -42.70078641676126, -544.5446058715142, -285.7951794148465, -331.4793239100395, -88.32339928736353, -232.24320112815815, -307.7698494268964, -371.38137884731333, -270.11427575012186, -431.4533448415532, -431.8373004742278, -164.24974293777856, -395.8347331930181, 30.053198507688116, -299.7722191656633, -400.0550815490311, -409.9795124457156, -488.4023495305975, -426.3804586512889, -184.19823951241233, -452.26188904144374, -56.99578625792166, -52.60839268922185, -203.984210793805, -385.05771985072914, -325.7428599742834, -218.70504791988338, -438.1847943729023, -434.96777649468135, -400.9380497630981, -347.5633584119736, -144.14061505732863, -456.98338819002544, -381.9716631468976, 86.65714988113075, -371.79308594136853, 37.98818508743075, -371.7422384739023, -283.1357829523454, -220.65934309656777, -426.0444612958476, -216.992353027899, -301.7392337348094, -561.7942321225897, -203.82714620328707, -230.98759957945995, -139.3046661471857, -110.90869691277854, -473.89384580099437, -463.7857529415081, -512.5407884840794, -2.357831193235209, -397.0122411303306, -283.06708009666136, -436.56572068399134, -344.6839217720275, 178.41051620068086, -418.3572377556335, -218.28833007836096, -282.11077157627886, -167.72342446519414, -485.40239967133846, -334.0050463478659, -443.4204304679738, -397.94628154542465, -308.6961601276506, -92.60923961048162, -488.26081124038205, -37.17519116511029, -334.74046304012785, -315.52569714997475, -308.3304370048126, -426.39183410866286, -300.90101349649893, -524.448743944692, -418.145063014263, -292.62713705963046, -178.24041070569245, -80.555273195776, -423.1811561408399, -144.20722282142822, -470.48684285684186, -138.16404561277645, -524.2567033737184, -383.8853625416264, -273.59356983394537, -382.49204414711437, -344.1005516904761, -256.990476355859, -347.10305956511473, -204.19438269008907, -310.86140501502763, -561.425799647404, 61.25181864886084, -336.5930883654219, -211.22335100513857, -49.93647657681655, -500.19303268220875, -152.48737894463, -50.39271414651439, -42.490912589060706, -457.66706783198214, -440.4434716753836, 119.6803035746101, -256.2251878222041, -316.4856971132191, -364.1770891071768, -331.76031096096403, -375.6630196763018, -342.06687439157344, 137.07191703080127, -503.80925323974355, -261.4984919682629, -410.7316211111237, -319.90588202156084, -406.6556550602906, -553.9910369648355, -280.35089537225707, -463.50327158134377, -406.9604924105096, -395.6704595497467, -282.293684713892, -412.54168970798304, -163.6950302845521, 185.3081177656631, -431.44552223906805, -11.274190050239874, -475.982996818096, 110.74269697067243, -465.99135561059995, -46.37949421155588, -466.93870088627204, -442.8692028753369, -294.67274120186136, -191.44248698611727, -491.43289864072966, -368.36845308364633, -563.5574776719069, -303.97914301420326, -209.60052986209706, -426.8693528767964, -127.49684450355433, -257.79886086432094, -245.08899055173714, -369.7238402530089, 0.3443893653881293, -404.6066599661844, -60.22137373569265, 63.147699119873124, -385.8881294162298, -34.72236901427216, -439.08107809876816, 181.3778002712064, -441.3154919584327, -351.1022275510513, -255.15387650025627, -287.4114555684431, -219.33828768378459, -118.78168182621087, -378.8493137714727, -287.1194750837698, -148.72613482772138, -361.00192533023335, -365.60556223456854, -404.7373859265365, -99.46811707843858, -497.8544041027696, -153.30522629875398, -532.4973966673941, -213.7122266130702, 176.7228663913528, 22.698098306714172, -513.6076732512106, -326.19254179436155, -427.29621553590675, -403.3495536235916, -551.5490465546369, 81.62429664138952, -398.24553006255246, 166.07206198717984, -474.4350195777644, -214.88699844243249, -329.92576240411114, -273.3327453194547, -183.3682375926239, -54.10830589440795, -310.08433383384875, -372.208678000377, -311.0040430311019, -359.0884251686446, -477.8049556425967, -359.0499279255872, -430.09626242056197, -281.0823086890248, -121.66169731513234, -542.2900244147478, -493.4529084795613, -158.2135522173508], "policy_predator_policy_reward": [350.00153379048777, 220.75767287976757, 362.09053726582283, 382.90892997266053, 301.7818779049549, 338.79173282510897, 33.76676569518135, 312.53304735696014, 302.51605386271336, 396.71429404189, 440.9969258266705, 363.54826702504164, 305.5458442437343, 389.9835473959455, 109.0262015206437, 454.42544647060697, 359.77482753923135, 405.31904560740213, 465.40241955556814, 454.1471182044667, 247.99604879409503, 471.06011989949604, 164.22832490202674, 405.35857939331265, 339.86289111988884, 39.214158150908325, 380.51146734401016, 363.1389370149685, 334.45948318779637, 296.27774417599704, 418.542318041325, 484.03537628780356, 388.0797365939579, 230.6559046645689, 385.5738418497227, 453.6814393603327, 454.951554108949, 14.23066013444634, 169.50784425759258, 292.37973468085534, 215.375608009547, 404.3493681382478, 403.3472560519832, 361.4508957535863, 334.22781020655054, 555.507730135956, 342.386122799085, 35.8911157842132, 112.18150143113814, 410.3573446200225, 490.45062030472764, 452.1896051967019, 41.97932433611795, 501.201920724147, 336.12019898792283, 504.28977955190345, 437.6157206839913, 344.7439217720274, 107.81170608906412, 390.491346008997, 160.5203572644374, 412.98818381530674, 432.26667262270297, 292.4942808395156, 404.9401960128896, 358.9014408004984, 376.0940816426954, 373.96054836907615, 82.07626338398404, 495.30617925565895, 102.67882460646516, 314.63749290775587, 202.41435644543665, 468.96991924013486, 389.9987979531615, 329.25862323177716, 524.3095668420949, 423.2024684770496, 159.31036440710923, 314.27975297511034, 296.5452297593984, 205.73067980648293, 430.7494628524931, 254.04162194678534, 213.45529214326928, 562.6672543320466, 461.6969406269665, 253.22353838334172, 394.7451120020354, 374.6838845307218, 369.6366185567215, 364.093577328172, 433.4513702055444, 180.2994595618986, 528.5288834296781, 228.22972190973735, 299.2275846142364, 383.0446156612298, 293.69651938289803, 365.5879632633303, 114.73938652861595, 284.26404691380463, 339.0909039094417, 423.32720392079005, 223.6730034437598, 379.51084267412944, 413.33454469919496, 179.74749723590574, 386.2270891071769, 331.97031096096384, 456.88248055592993, 277.1027369991371, 290.4351591822231, 304.6307842666309, 265.396849989799, 410.7316211111237, 296.5374066989407, 448.5385542024088, 487.8825600429526, 419.5097692586712, 529.0826583913845, 434.91619763462916, 417.39156580253825, 288.32670083644535, 334.8685523883198, 342.72472529590056, 255.90847843850344, 327.6318230081113, 419.8644981114981, 134.51112266622593, 50.61927266701019, 466.0513556105999, 380.2618431494413, 322.5084487688036, 343.65888209566594, 461.7635557012537, 257.48084757787115, 479.81631335616447, 407.388836280921, 503.38368505429463, 285.5297180934712, 268.813264753367, 428.95009241654697, 249.7999172759101, 300.69827024795677, 265.99562359345816, 182.08328140515525, 328.27206443078467, 158.70605499505257, 335.0925613422239, 286.9312214182597, 227.54252878859927, 151.78236901427218, 442.1610780987682, 6.672199728793571, 441.36549195843264, 470.98833666535603, 251.10178951919514, 318.08807051387737, 278.8410333448156, 403.1877377494895, 187.80940001713248, 323.3385783809108, 175.12719783126656, 325.249077252451, 424.95274012314354, 320.05523589370034, 340.13539504880123, 415.6070957631783, 327.8006980828147, 532.5073966673941, 285.81651836502994, 101.07202355650273, 67.99784034770423, 452.25761910151516, 421.39590999219774, 402.51161803380205, 483.41246858983857, 497.40520829637285, 312.0214696115717, 303.6497045927852, 186.57618588143512, 429.5618674545414, 420.8331972738236, 348.6549421921895, 295.38419192346174, 260.0485601533799, 145.97274000783398, 441.9197094081976, 269.03046968682764, 311.75074581443903, 353.0501219041423, 352.34107526363, 488.0459962922618, 431.1686816856669, 341.0818862473732, 423.8333429854794, 292.8450677353017, 427.6516701573458, 363.4725053632622]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.626107965923057, "mean_inference_ms": 80.49131553849372, "mean_action_processing_ms": 0.25354523940328944, "mean_env_wait_ms": 11.73689469121313, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006800532341003418, "StateBufferConnector_ms": 0.0035309791564941406, "ViewRequirementAgentConnector_ms": 0.11296427249908447}, "num_episodes": 27, "episode_return_max": 368.49082860227395, "episode_return_min": -56.537507199447695, "episode_return_mean": 92.83155360765183, "episodes_this_iter": 27}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 512000, "num_agent_steps_trained": 512000, "num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 2.258174691727926, "num_env_steps_trained_throughput_per_sec": 2.258174691727926, "timesteps_total": 128000, "num_env_steps_sampled_lifetime": 128000, "num_agent_steps_sampled_lifetime": 512000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 512000, "timers": {"training_iteration_time_ms": 5327940.396, "restore_workers_time_ms": 0.014, "training_step_time_ms": 5327940.319, "sample_time_ms": 152921.324, "learn_time_ms": 5174996.853, "learn_throughput": 0.773, "synch_weights_time_ms": 18.369}, "counters": {"num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 512000, "num_agent_steps_trained": 512000}, "done": false, "training_iteration": 32, "trial_id": "b941d_00000", "date": "2024-08-18_00-02-05", "timestamp": 1723919525, "time_this_iter_s": 1771.347401857376, "time_total_s": 58090.173505067825, "pid": 81115, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[32, [4, 4], 2], [64, [3, 3], 2], [128, [3, 3], 1]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [256, 256], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b04a9b80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 58090.173505067825, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 25.106282722513086, "ram_util_percent": 74.07801047120418}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 12.585137011639025, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.00010000000000000003, "total_loss": 9.102010037659337, "policy_loss": -0.09107902306329124, "vf_loss": 9.173303353849542, "vf_explained_var": 0.25396245522473854, "kl": 0.01954145723578794, "entropy": 1.065798411388246, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 61425.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.040574914311605, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.00010000000000000003, "total_loss": 9.145484923307228, "policy_loss": -0.0724885148918946, "vf_loss": 9.200740992329107, "vf_explained_var": 0.04712382573930044, "kl": 0.017019704593335037, "entropy": 0.788184328274752, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 61425.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 528000, "num_agent_steps_trained": 528000}, "env_runners": {"episode_reward_max": 368.49082860227395, "episode_reward_min": -86.52785148940445, "episode_reward_mean": 97.15799372016599, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -563.5574776719069, "predator_policy": 6.672199728793571}, "policy_reward_max": {"prey_policy": 193.07, "predator_policy": 562.6672543320466}, "policy_reward_mean": {"prey_policy": -283.00105882294093, "predator_policy": 331.58005568302383}, "custom_metrics": {}, "hist_stats": {"episode_reward": [184.0462781831576, 128.1335255519764, 115.92985009888174, 121.76133748182409, 26.20207448510753, -56.537507199447695, 272.3254829911967, 4.960626758927335, 28.282625382950382, 160.33065731283503, 1.1099999999999943, 258.3563305431088, 73.10943942510549, 71.63512932568673, -13.583840002451591, 43.41218833869602, -3.487608211221369, 45.400663308983326, 47.528141530785334, -8.035426420223438, 4.918228360189659, 2.722569616895929, -1.460519770734562, 70.09701912100967, 113.70179748882123, 57.44154663473728, 42.83640069516744, 129.63665996391978, 98.69504206232618, 256.5846243408726, 134.45576090490584, 109.1549733872039, 196.12334035127657, 262.2601274091887, 282.42067801711534, 20.37115699967855, 22.260000000000005, 16.25532348719182, 228.32860723991172, 3.89835802153668, 18.514423819498063, 73.0503969645312, 93.53509203416118, 27.754122375345194, 101.35655769168564, 337.4028969732097, 67.11843390938897, 161.4219696376826, 189.45209682041698, 67.88049371972228, 54.42177530718912, -21.153409420337812, 40.76330997053858, 124.38381231210612, 63.80604242535672, 140.97589494831925, 28.970582635400575, 191.73331991050202, 120.14000000000004, 188.09999999999997, 115.83402213324378, 90.17936060646548, 93.36614216893868, 62.62016630068721, 23.594329810792622, 155.98512793752568, 92.24816344446965, 72.11429175196005, 368.49082860227395, 33.85331404814125, 55.27831746414236, 339.50192799469727, 258.05242239884757, 161.0730467081689, 40.7806263920856, 168.544756674182, 28.657167260799383, -5.291600481164752, 3.5321879877081988, 61.071996823453375, 52.72668899090054, 139.45771482369742, 1.3723274665881862, 18.570284462253365, 57.70713475602447, 302.58126686931433, 144.27199676487473, 73.5978624804595, 63.03639588618482, 56.11129613299591, 147.4975630981298, -86.52785148940445, 300.66703339458803, 51.16512132487984, 79.75112789746503, 22.07507253867226, 80.82447758243505, 217.48157227183486, 124.40917419476499, 28.327041290715133], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [86.65714988113075, -371.79308594136853, 37.98818508743075, -371.7422384739023, -283.1357829523454, -220.65934309656777, -426.0444612958476, -216.992353027899, -301.7392337348094, -561.7942321225897, -203.82714620328707, -230.98759957945995, -139.3046661471857, -110.90869691277854, -473.89384580099437, -463.7857529415081, -512.5407884840794, -2.357831193235209, -397.0122411303306, -283.06708009666136, -436.56572068399134, -344.6839217720275, 178.41051620068086, -418.3572377556335, -218.28833007836096, -282.11077157627886, -167.72342446519414, -485.40239967133846, -334.0050463478659, -443.4204304679738, -397.94628154542465, -308.6961601276506, -92.60923961048162, -488.26081124038205, -37.17519116511029, -334.74046304012785, -315.52569714997475, -308.3304370048126, -426.39183410866286, -300.90101349649893, -524.448743944692, -418.145063014263, -292.62713705963046, -178.24041070569245, -80.555273195776, -423.1811561408399, -144.20722282142822, -470.48684285684186, -138.16404561277645, -524.2567033737184, -383.8853625416264, -273.59356983394537, -382.49204414711437, -344.1005516904761, -256.990476355859, -347.10305956511473, -204.19438269008907, -310.86140501502763, -561.425799647404, 61.25181864886084, -336.5930883654219, -211.22335100513857, -49.93647657681655, -500.19303268220875, -152.48737894463, -50.39271414651439, -42.490912589060706, -457.66706783198214, -440.4434716753836, 119.6803035746101, -256.2251878222041, -316.4856971132191, -364.1770891071768, -331.76031096096403, -375.6630196763018, -342.06687439157344, 137.07191703080127, -503.80925323974355, -261.4984919682629, -410.7316211111237, -319.90588202156084, -406.6556550602906, -553.9910369648355, -280.35089537225707, -463.50327158134377, -406.9604924105096, -395.6704595497467, -282.293684713892, -412.54168970798304, -163.6950302845521, 185.3081177656631, -431.44552223906805, -11.274190050239874, -475.982996818096, 110.74269697067243, -465.99135561059995, -46.37949421155588, -466.93870088627204, -442.8692028753369, -294.67274120186136, -191.44248698611727, -491.43289864072966, -368.36845308364633, -563.5574776719069, -303.97914301420326, -209.60052986209706, -426.8693528767964, -127.49684450355433, -257.79886086432094, -245.08899055173714, -369.7238402530089, 0.3443893653881293, -404.6066599661844, -60.22137373569265, 63.147699119873124, -385.8881294162298, -34.72236901427216, -439.08107809876816, 181.3778002712064, -441.3154919584327, -351.1022275510513, -255.15387650025627, -287.4114555684431, -219.33828768378459, -118.78168182621087, -378.8493137714727, -287.1194750837698, -148.72613482772138, -361.00192533023335, -365.60556223456854, -404.7373859265365, -99.46811707843858, -497.8544041027696, -153.30522629875398, -532.4973966673941, -213.7122266130702, 176.7228663913528, 22.698098306714172, -513.6076732512106, -326.19254179436155, -427.29621553590675, -403.3495536235916, -551.5490465546369, 81.62429664138952, -398.24553006255246, 166.07206198717984, -474.4350195777644, -214.88699844243249, -329.92576240411114, -273.3327453194547, -183.3682375926239, -54.10830589440795, -310.08433383384875, -372.208678000377, -311.0040430311019, -359.0884251686446, -477.8049556425967, -359.0499279255872, -430.09626242056197, -281.0823086890248, -121.66169731513234, -542.2900244147478, -493.4529084795613, -158.2135522173508, -298.4161187654897, -493.5654248941996, -405.805877877199, -433.2414621448664, -239.8048577990632, -165.82481466068464, 193.07, -462.44924423562964, -305.30377367611817, -180.48595242564076, -513.3094796462972, -288.9873147848841, -235.88664476113541, -545.7013558730295, -388.54074557756513, -257.1111073270285, -354.4359014456331, -144.7302492984649, -256.5662156947312, -369.6249006681604, -301.2022325615636, 171.91465887252815, -253.94224345615922, -227.28998965757845, -234.011268156011, -369.3569964853424, -404.63640352873733, -324.86052044822827, -337.19218862268457, -364.3466681493901, -496.4719449691712, 156.11484942468425, -94.6497274050822, -218.51618488341248, -348.16503566004724, -357.135538412678], "policy_predator_policy_reward": [454.951554108949, 14.23066013444634, 169.50784425759258, 292.37973468085534, 215.375608009547, 404.3493681382478, 403.3472560519832, 361.4508957535863, 334.22781020655054, 555.507730135956, 342.386122799085, 35.8911157842132, 112.18150143113814, 410.3573446200225, 490.45062030472764, 452.1896051967019, 41.97932433611795, 501.201920724147, 336.12019898792283, 504.28977955190345, 437.6157206839913, 344.7439217720274, 107.81170608906412, 390.491346008997, 160.5203572644374, 412.98818381530674, 432.26667262270297, 292.4942808395156, 404.9401960128896, 358.9014408004984, 376.0940816426954, 373.96054836907615, 82.07626338398404, 495.30617925565895, 102.67882460646516, 314.63749290775587, 202.41435644543665, 468.96991924013486, 389.9987979531615, 329.25862323177716, 524.3095668420949, 423.2024684770496, 159.31036440710923, 314.27975297511034, 296.5452297593984, 205.73067980648293, 430.7494628524931, 254.04162194678534, 213.45529214326928, 562.6672543320466, 461.6969406269665, 253.22353838334172, 394.7451120020354, 374.6838845307218, 369.6366185567215, 364.093577328172, 433.4513702055444, 180.2994595618986, 528.5288834296781, 228.22972190973735, 299.2275846142364, 383.0446156612298, 293.69651938289803, 365.5879632633303, 114.73938652861595, 284.26404691380463, 339.0909039094417, 423.32720392079005, 223.6730034437598, 379.51084267412944, 413.33454469919496, 179.74749723590574, 386.2270891071769, 331.97031096096384, 456.88248055592993, 277.1027369991371, 290.4351591822231, 304.6307842666309, 265.396849989799, 410.7316211111237, 296.5374066989407, 448.5385542024088, 487.8825600429526, 419.5097692586712, 529.0826583913845, 434.91619763462916, 417.39156580253825, 288.32670083644535, 334.8685523883198, 342.72472529590056, 255.90847843850344, 327.6318230081113, 419.8644981114981, 134.51112266622593, 50.61927266701019, 466.0513556105999, 380.2618431494413, 322.5084487688036, 343.65888209566594, 461.7635557012537, 257.48084757787115, 479.81631335616447, 407.388836280921, 503.38368505429463, 285.5297180934712, 268.813264753367, 428.95009241654697, 249.7999172759101, 300.69827024795677, 265.99562359345816, 182.08328140515525, 328.27206443078467, 158.70605499505257, 335.0925613422239, 286.9312214182597, 227.54252878859927, 151.78236901427218, 442.1610780987682, 6.672199728793571, 441.36549195843264, 470.98833666535603, 251.10178951919514, 318.08807051387737, 278.8410333448156, 403.1877377494895, 187.80940001713248, 323.3385783809108, 175.12719783126656, 325.249077252451, 424.95274012314354, 320.05523589370034, 340.13539504880123, 415.6070957631783, 327.8006980828147, 532.5073966673941, 285.81651836502994, 101.07202355650273, 67.99784034770423, 452.25761910151516, 421.39590999219774, 402.51161803380205, 483.41246858983857, 497.40520829637285, 312.0214696115717, 303.6497045927852, 186.57618588143512, 429.5618674545414, 420.8331972738236, 348.6549421921895, 295.38419192346174, 260.0485601533799, 145.97274000783398, 441.9197094081976, 269.03046968682764, 311.75074581443903, 353.0501219041423, 352.34107526363, 488.0459962922618, 431.1686816856669, 341.0818862473732, 423.8333429854794, 292.8450677353017, 427.6516701573458, 363.4725053632622, 299.7884462320776, 493.5654248941996, 406.5979125178128, 451.0197119665057, 358.3781824340631, 104.95862478170905, 198.18734087052093, 373.7731702344231, 202.13053536263496, 427.93118750399833, 494.9934331524613, 380.9012237591788, 339.37256099972916, 505.25183552062015, 322.9782710088278, 378.78487802876117, 187.29702169957474, 459.36669214265277, 363.7476649841111, 175.91559988937618, 343.4693536799197, 86.48525340370371, 158.2854566939014, 374.11189774471626, 469.09642594232014, 214.02296659649804, 311.29757481170975, 440.2744217039282, 334.9257381102116, 447.43759624429794, 497.52765653157405, 60.31101128474772, 168.8644899478514, 268.7105965354082, 377.29643348282605, 356.3311818806139]}, "sampler_perf": {"mean_raw_obs_processing_ms": 9.064844191982036, "mean_inference_ms": 83.14295381312381, "mean_action_processing_ms": 0.25385967123086367, "mean_env_wait_ms": 12.218310394026469, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004913210868835449, "StateBufferConnector_ms": 0.003432750701904297, "ViewRequirementAgentConnector_ms": 0.11165130138397217}, "num_episodes": 18, "episode_return_max": 368.49082860227395, "episode_return_min": -86.52785148940445, "episode_return_mean": 97.15799372016599, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 528000, "num_agent_steps_trained": 528000, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 3.493010970926097, "num_env_steps_trained_throughput_per_sec": 3.493010970926097, "timesteps_total": 132000, "num_env_steps_sampled_lifetime": 132000, "num_agent_steps_sampled_lifetime": 528000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 528000, "timers": {"training_iteration_time_ms": 4871060.382, "restore_workers_time_ms": 0.014, "training_step_time_ms": 4871060.311, "sample_time_ms": 54950.493, "learn_time_ms": 4816088.631, "learn_throughput": 0.831, "synch_weights_time_ms": 17.5}, "counters": {"num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 528000, "num_agent_steps_trained": 528000}, "done": false, "training_iteration": 33, "trial_id": "b941d_00000", "date": "2024-08-18_00-21-11", "timestamp": 1723920671, "time_this_iter_s": 1145.1556782722473, "time_total_s": 59235.32918334007, "pid": 81115, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[32, [4, 4], 2], [64, [3, 3], 2], [128, [3, 3], 1]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [256, 256], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b0403f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 59235.32918334007, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 24.40972972972973, "ram_util_percent": 75.2827027027027}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 15.790127771241325, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.00010000000000000003, "total_loss": 8.829270988797385, "policy_loss": -0.08353616683226493, "vf_loss": 8.892772649331068, "vf_explained_var": 0.2171100840682075, "kl": 0.01978716552249357, "entropy": 1.041111884041438, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 63315.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.900640851101548, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.00010000000000000003, "total_loss": 9.014339619086533, "policy_loss": -0.06908898316077376, "vf_loss": 9.065049314751196, "vf_explained_var": 0.11473072344663912, "kl": 0.018152382917948427, "entropy": 0.7377636937868027, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 63315.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_agent_steps_sampled": 544000, "num_agent_steps_trained": 544000}, "env_runners": {"episode_reward_max": 368.49082860227395, "episode_reward_min": -86.52785148940445, "episode_reward_mean": 100.6849098813546, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -563.5574776719069, "predator_policy": 6.672199728793571}, "policy_reward_max": {"prey_policy": 193.07, "predator_policy": 562.6672543320466}, "policy_reward_mean": {"prey_policy": -283.3898235822759, "predator_policy": 333.73227852295315}, "custom_metrics": {}, "hist_stats": {"episode_reward": [47.528141530785334, -8.035426420223438, 4.918228360189659, 2.722569616895929, -1.460519770734562, 70.09701912100967, 113.70179748882123, 57.44154663473728, 42.83640069516744, 129.63665996391978, 98.69504206232618, 256.5846243408726, 134.45576090490584, 109.1549733872039, 196.12334035127657, 262.2601274091887, 282.42067801711534, 20.37115699967855, 22.260000000000005, 16.25532348719182, 228.32860723991172, 3.89835802153668, 18.514423819498063, 73.0503969645312, 93.53509203416118, 27.754122375345194, 101.35655769168564, 337.4028969732097, 67.11843390938897, 161.4219696376826, 189.45209682041698, 67.88049371972228, 54.42177530718912, -21.153409420337812, 40.76330997053858, 124.38381231210612, 63.80604242535672, 140.97589494831925, 28.970582635400575, 191.73331991050202, 120.14000000000004, 188.09999999999997, 115.83402213324378, 90.17936060646548, 93.36614216893868, 62.62016630068721, 23.594329810792622, 155.98512793752568, 92.24816344446965, 72.11429175196005, 368.49082860227395, 33.85331404814125, 55.27831746414236, 339.50192799469727, 258.05242239884757, 161.0730467081689, 40.7806263920856, 168.544756674182, 28.657167260799383, -5.291600481164752, 3.5321879877081988, 61.071996823453375, 52.72668899090054, 139.45771482369742, 1.3723274665881862, 18.570284462253365, 57.70713475602447, 302.58126686931433, 144.27199676487473, 73.5978624804595, 63.03639588618482, 56.11129613299591, 147.4975630981298, -86.52785148940445, 300.66703339458803, 51.16512132487984, 79.75112789746503, 22.07507253867226, 80.82447758243505, 217.48157227183486, 124.40917419476499, 28.327041290715133, 197.67086575131032, 340.63666357085623, 121.01292618377435, 78.35277559922051, 65.02553896266444, 108.92592108313337, 21.86261877828207, 5.439000267744666, 26.314540852410577, 164.87478778992374, 127.03946677426534, 168.70646309601437, -36.21631632834731, 96.30426081517405, 123.04095031149757, -6.632031010691158, 64.76674931457644, 146.95368808236685], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-315.52569714997475, -308.3304370048126, -426.39183410866286, -300.90101349649893, -524.448743944692, -418.145063014263, -292.62713705963046, -178.24041070569245, -80.555273195776, -423.1811561408399, -144.20722282142822, -470.48684285684186, -138.16404561277645, -524.2567033737184, -383.8853625416264, -273.59356983394537, -382.49204414711437, -344.1005516904761, -256.990476355859, -347.10305956511473, -204.19438269008907, -310.86140501502763, -561.425799647404, 61.25181864886084, -336.5930883654219, -211.22335100513857, -49.93647657681655, -500.19303268220875, -152.48737894463, -50.39271414651439, -42.490912589060706, -457.66706783198214, -440.4434716753836, 119.6803035746101, -256.2251878222041, -316.4856971132191, -364.1770891071768, -331.76031096096403, -375.6630196763018, -342.06687439157344, 137.07191703080127, -503.80925323974355, -261.4984919682629, -410.7316211111237, -319.90588202156084, -406.6556550602906, -553.9910369648355, -280.35089537225707, -463.50327158134377, -406.9604924105096, -395.6704595497467, -282.293684713892, -412.54168970798304, -163.6950302845521, 185.3081177656631, -431.44552223906805, -11.274190050239874, -475.982996818096, 110.74269697067243, -465.99135561059995, -46.37949421155588, -466.93870088627204, -442.8692028753369, -294.67274120186136, -191.44248698611727, -491.43289864072966, -368.36845308364633, -563.5574776719069, -303.97914301420326, -209.60052986209706, -426.8693528767964, -127.49684450355433, -257.79886086432094, -245.08899055173714, -369.7238402530089, 0.3443893653881293, -404.6066599661844, -60.22137373569265, 63.147699119873124, -385.8881294162298, -34.72236901427216, -439.08107809876816, 181.3778002712064, -441.3154919584327, -351.1022275510513, -255.15387650025627, -287.4114555684431, -219.33828768378459, -118.78168182621087, -378.8493137714727, -287.1194750837698, -148.72613482772138, -361.00192533023335, -365.60556223456854, -404.7373859265365, -99.46811707843858, -497.8544041027696, -153.30522629875398, -532.4973966673941, -213.7122266130702, 176.7228663913528, 22.698098306714172, -513.6076732512106, -326.19254179436155, -427.29621553590675, -403.3495536235916, -551.5490465546369, 81.62429664138952, -398.24553006255246, 166.07206198717984, -474.4350195777644, -214.88699844243249, -329.92576240411114, -273.3327453194547, -183.3682375926239, -54.10830589440795, -310.08433383384875, -372.208678000377, -311.0040430311019, -359.0884251686446, -477.8049556425967, -359.0499279255872, -430.09626242056197, -281.0823086890248, -121.66169731513234, -542.2900244147478, -493.4529084795613, -158.2135522173508, -298.4161187654897, -493.5654248941996, -405.805877877199, -433.2414621448664, -239.8048577990632, -165.82481466068464, 193.07, -462.44924423562964, -305.30377367611817, -180.48595242564076, -513.3094796462972, -288.9873147848841, -235.88664476113541, -545.7013558730295, -388.54074557756513, -257.1111073270285, -354.4359014456331, -144.7302492984649, -256.5662156947312, -369.6249006681604, -301.2022325615636, 171.91465887252815, -253.94224345615922, -227.28998965757845, -234.011268156011, -369.3569964853424, -404.63640352873733, -324.86052044822827, -337.19218862268457, -364.3466681493901, -496.4719449691712, 156.11484942468425, -94.6497274050822, -218.51618488341248, -348.16503566004724, -357.135538412678, -260.6382679608604, -116.39702387313326, -318.2555436643235, 191.21209089888316, -250.34163359993602, -240.62041871299377, -382.56552445786804, -230.69212073543537, -529.8375210951045, -370.1856381718374, -168.39093833303102, -404.3543110511163, -386.00430396956637, -310.28700891949353, -420.6839092425523, -460.85555598866046, -426.5848692626737, -353.5945792813959, -377.17081781809327, -226.04998345856194, -358.69001605407084, 2.0000000000000013, 113.94109273815032, -269.1714422732168, -361.20204984764695, -412.31685276332155, -406.62601469050776, -156.1984502894073, -386.02095182818937, -297.0944566178907, -262.08736667090704, -456.11057607442314, -317.1077088586477, -228.73762343490316, -393.377987683381, 94.82937366567663], "policy_predator_policy_reward": [202.41435644543665, 468.96991924013486, 389.9987979531615, 329.25862323177716, 524.3095668420949, 423.2024684770496, 159.31036440710923, 314.27975297511034, 296.5452297593984, 205.73067980648293, 430.7494628524931, 254.04162194678534, 213.45529214326928, 562.6672543320466, 461.6969406269665, 253.22353838334172, 394.7451120020354, 374.6838845307218, 369.6366185567215, 364.093577328172, 433.4513702055444, 180.2994595618986, 528.5288834296781, 228.22972190973735, 299.2275846142364, 383.0446156612298, 293.69651938289803, 365.5879632633303, 114.73938652861595, 284.26404691380463, 339.0909039094417, 423.32720392079005, 223.6730034437598, 379.51084267412944, 413.33454469919496, 179.74749723590574, 386.2270891071769, 331.97031096096384, 456.88248055592993, 277.1027369991371, 290.4351591822231, 304.6307842666309, 265.396849989799, 410.7316211111237, 296.5374066989407, 448.5385542024088, 487.8825600429526, 419.5097692586712, 529.0826583913845, 434.91619763462916, 417.39156580253825, 288.32670083644535, 334.8685523883198, 342.72472529590056, 255.90847843850344, 327.6318230081113, 419.8644981114981, 134.51112266622593, 50.61927266701019, 466.0513556105999, 380.2618431494413, 322.5084487688036, 343.65888209566594, 461.7635557012537, 257.48084757787115, 479.81631335616447, 407.388836280921, 503.38368505429463, 285.5297180934712, 268.813264753367, 428.95009241654697, 249.7999172759101, 300.69827024795677, 265.99562359345816, 182.08328140515525, 328.27206443078467, 158.70605499505257, 335.0925613422239, 286.9312214182597, 227.54252878859927, 151.78236901427218, 442.1610780987682, 6.672199728793571, 441.36549195843264, 470.98833666535603, 251.10178951919514, 318.08807051387737, 278.8410333448156, 403.1877377494895, 187.80940001713248, 323.3385783809108, 175.12719783126656, 325.249077252451, 424.95274012314354, 320.05523589370034, 340.13539504880123, 415.6070957631783, 327.8006980828147, 532.5073966673941, 285.81651836502994, 101.07202355650273, 67.99784034770423, 452.25761910151516, 421.39590999219774, 402.51161803380205, 483.41246858983857, 497.40520829637285, 312.0214696115717, 303.6497045927852, 186.57618588143512, 429.5618674545414, 420.8331972738236, 348.6549421921895, 295.38419192346174, 260.0485601533799, 145.97274000783398, 441.9197094081976, 269.03046968682764, 311.75074581443903, 353.0501219041423, 352.34107526363, 488.0459962922618, 431.1686816856669, 341.0818862473732, 423.8333429854794, 292.8450677353017, 427.6516701573458, 363.4725053632622, 299.7884462320776, 493.5654248941996, 406.5979125178128, 451.0197119665057, 358.3781824340631, 104.95862478170905, 198.18734087052093, 373.7731702344231, 202.13053536263496, 427.93118750399833, 494.9934331524613, 380.9012237591788, 339.37256099972916, 505.25183552062015, 322.9782710088278, 378.78487802876117, 187.29702169957474, 459.36669214265277, 363.7476649841111, 175.91559988937618, 343.4693536799197, 86.48525340370371, 158.2854566939014, 374.11189774471626, 469.09642594232014, 214.02296659649804, 311.29757481170975, 440.2744217039282, 334.9257381102116, 447.43759624429794, 497.52765653157405, 60.31101128474772, 168.8644899478514, 268.7105965354082, 377.29643348282605, 356.3311818806139, 322.551719712252, 252.15443787305202, 250.52287543021828, 217.1572409060784, 236.2388248088528, 375.73615368785073, 233.81478279542267, 457.7956379971008, 529.5385830570528, 435.51011517255364, 205.24347529752427, 476.4276951697566, 371.1252010210223, 347.0287306463196, 420.12987181378355, 466.84859368517374, 452.58486926267375, 353.90912013380614, 356.5865304454223, 411.5090586211567, 307.94761067883513, 175.78187214950032, 283.8965652531786, 40.04024737790228, 342.5425518443124, 394.76003443830876, 441.48734879882056, 217.6413769962685, 298.6348693832042, 507.5214893743734, 262.73736667090725, 448.82854506373195, 232.20048313941462, 378.41159846871267, 429.93695041796474, 15.565351682106874]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.82418989541551, "mean_inference_ms": 81.2645951984034, "mean_action_processing_ms": 0.2540162890223269, "mean_env_wait_ms": 11.875326174934857, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0052117109298706055, "StateBufferConnector_ms": 0.0037157535552978516, "ViewRequirementAgentConnector_ms": 0.11518490314483643}, "num_episodes": 18, "episode_return_max": 368.49082860227395, "episode_return_min": -86.52785148940445, "episode_return_mean": 100.6849098813546, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 544000, "num_agent_steps_trained": 544000, "num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 2.9203968187937446, "num_env_steps_trained_throughput_per_sec": 2.9203968187937446, "timesteps_total": 136000, "num_env_steps_sampled_lifetime": 136000, "num_agent_steps_sampled_lifetime": 544000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 544000, "timers": {"training_iteration_time_ms": 4274560.33, "restore_workers_time_ms": 0.014, "training_step_time_ms": 4274560.259, "sample_time_ms": 54908.729, "learn_time_ms": 4219631.145, "learn_throughput": 0.948, "synch_weights_time_ms": 17.335}, "counters": {"num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_agent_steps_sampled": 544000, "num_agent_steps_trained": 544000}, "done": false, "training_iteration": 34, "trial_id": "b941d_00000", "date": "2024-08-18_00-44-00", "timestamp": 1723922040, "time_this_iter_s": 1369.6996448040009, "time_total_s": 60605.02882814407, "pid": 81115, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[32, [4, 4], 2], [64, [3, 3], 2], [128, [3, 3], 1]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [256, 256], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2937a60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 60605.02882814407, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 21.946236559139784, "ram_util_percent": 77.01451612903226}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 11.530317690637377, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.00010000000000000003, "total_loss": 8.684059722839839, "policy_loss": -0.09635243495610893, "vf_loss": 8.759195835123617, "vf_explained_var": 0.359522177964922, "kl": 0.020954390110572894, "entropy": 1.034455337063976, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 65205.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.764323734480238, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.00010000000000000003, "total_loss": 8.966338773757693, "policy_loss": -0.07323768907891852, "vf_loss": 9.020755784473723, "vf_explained_var": 0.10994560516700543, "kl": 0.01858833279709435, "entropy": 0.7695635737565459, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 65205.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_agent_steps_sampled": 560000, "num_agent_steps_trained": 560000}, "env_runners": {"episode_reward_max": 368.49082860227395, "episode_reward_min": -98.41070675895112, "episode_reward_mean": 94.46707230030283, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -670.5429509480239, "predator_policy": 6.672199728793571}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 598.6750302592245}, "policy_reward_mean": {"prey_policy": -290.6832162726995, "predator_policy": 337.91675242285083}, "custom_metrics": {}, "hist_stats": {"episode_reward": [22.260000000000005, 16.25532348719182, 228.32860723991172, 3.89835802153668, 18.514423819498063, 73.0503969645312, 93.53509203416118, 27.754122375345194, 101.35655769168564, 337.4028969732097, 67.11843390938897, 161.4219696376826, 189.45209682041698, 67.88049371972228, 54.42177530718912, -21.153409420337812, 40.76330997053858, 124.38381231210612, 63.80604242535672, 140.97589494831925, 28.970582635400575, 191.73331991050202, 120.14000000000004, 188.09999999999997, 115.83402213324378, 90.17936060646548, 93.36614216893868, 62.62016630068721, 23.594329810792622, 155.98512793752568, 92.24816344446965, 72.11429175196005, 368.49082860227395, 33.85331404814125, 55.27831746414236, 339.50192799469727, 258.05242239884757, 161.0730467081689, 40.7806263920856, 168.544756674182, 28.657167260799383, -5.291600481164752, 3.5321879877081988, 61.071996823453375, 52.72668899090054, 139.45771482369742, 1.3723274665881862, 18.570284462253365, 57.70713475602447, 302.58126686931433, 144.27199676487473, 73.5978624804595, 63.03639588618482, 56.11129613299591, 147.4975630981298, -86.52785148940445, 300.66703339458803, 51.16512132487984, 79.75112789746503, 22.07507253867226, 80.82447758243505, 217.48157227183486, 124.40917419476499, 28.327041290715133, 197.67086575131032, 340.63666357085623, 121.01292618377435, 78.35277559922051, 65.02553896266444, 108.92592108313337, 21.86261877828207, 5.439000267744666, 26.314540852410577, 164.87478778992374, 127.03946677426534, 168.70646309601437, -36.21631632834731, 96.30426081517405, 123.04095031149757, -6.632031010691158, 64.76674931457644, 146.95368808236685, 101.59205195192365, -18.41992066366007, 159.4002906694215, 130.17412989745688, 9.853079378246012, 321.1058958707016, 0.07999999999999297, 68.79977998542184, 1.4241230376895384, 45.52824312701181, -98.41070675895112, -9.48778754278586, 20.12385463498626, 294.9061211945354, -4.046418151988521, -24.8951835621438, 75.23876638158897, 124.70204313850529], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-364.1770891071768, -331.76031096096403, -375.6630196763018, -342.06687439157344, 137.07191703080127, -503.80925323974355, -261.4984919682629, -410.7316211111237, -319.90588202156084, -406.6556550602906, -553.9910369648355, -280.35089537225707, -463.50327158134377, -406.9604924105096, -395.6704595497467, -282.293684713892, -412.54168970798304, -163.6950302845521, 185.3081177656631, -431.44552223906805, -11.274190050239874, -475.982996818096, 110.74269697067243, -465.99135561059995, -46.37949421155588, -466.93870088627204, -442.8692028753369, -294.67274120186136, -191.44248698611727, -491.43289864072966, -368.36845308364633, -563.5574776719069, -303.97914301420326, -209.60052986209706, -426.8693528767964, -127.49684450355433, -257.79886086432094, -245.08899055173714, -369.7238402530089, 0.3443893653881293, -404.6066599661844, -60.22137373569265, 63.147699119873124, -385.8881294162298, -34.72236901427216, -439.08107809876816, 181.3778002712064, -441.3154919584327, -351.1022275510513, -255.15387650025627, -287.4114555684431, -219.33828768378459, -118.78168182621087, -378.8493137714727, -287.1194750837698, -148.72613482772138, -361.00192533023335, -365.60556223456854, -404.7373859265365, -99.46811707843858, -497.8544041027696, -153.30522629875398, -532.4973966673941, -213.7122266130702, 176.7228663913528, 22.698098306714172, -513.6076732512106, -326.19254179436155, -427.29621553590675, -403.3495536235916, -551.5490465546369, 81.62429664138952, -398.24553006255246, 166.07206198717984, -474.4350195777644, -214.88699844243249, -329.92576240411114, -273.3327453194547, -183.3682375926239, -54.10830589440795, -310.08433383384875, -372.208678000377, -311.0040430311019, -359.0884251686446, -477.8049556425967, -359.0499279255872, -430.09626242056197, -281.0823086890248, -121.66169731513234, -542.2900244147478, -493.4529084795613, -158.2135522173508, -298.4161187654897, -493.5654248941996, -405.805877877199, -433.2414621448664, -239.8048577990632, -165.82481466068464, 193.07, -462.44924423562964, -305.30377367611817, -180.48595242564076, -513.3094796462972, -288.9873147848841, -235.88664476113541, -545.7013558730295, -388.54074557756513, -257.1111073270285, -354.4359014456331, -144.7302492984649, -256.5662156947312, -369.6249006681604, -301.2022325615636, 171.91465887252815, -253.94224345615922, -227.28998965757845, -234.011268156011, -369.3569964853424, -404.63640352873733, -324.86052044822827, -337.19218862268457, -364.3466681493901, -496.4719449691712, 156.11484942468425, -94.6497274050822, -218.51618488341248, -348.16503566004724, -357.135538412678, -260.6382679608604, -116.39702387313326, -318.2555436643235, 191.21209089888316, -250.34163359993602, -240.62041871299377, -382.56552445786804, -230.69212073543537, -529.8375210951045, -370.1856381718374, -168.39093833303102, -404.3543110511163, -386.00430396956637, -310.28700891949353, -420.6839092425523, -460.85555598866046, -426.5848692626737, -353.5945792813959, -377.17081781809327, -226.04998345856194, -358.69001605407084, 2.0000000000000013, 113.94109273815032, -269.1714422732168, -361.20204984764695, -412.31685276332155, -406.62601469050776, -156.1984502894073, -386.02095182818937, -297.0944566178907, -262.08736667090704, -456.11057607442314, -317.1077088586477, -228.73762343490316, -393.377987683381, 94.82937366567663, -367.3844636409837, -260.05830135376806, -228.131358845911, -479.9243482655154, -16.68587782855087, -204.70832206141307, -359.71013519567066, -210.14533467680178, -332.2816269164747, -419.12526244382724, -516.8892838219919, 200.0, -484.645428811122, -476.6869479459929, -474.59932033438525, -122.2499747395055, -415.08629697718413, -534.4975737100294, -262.9330725569933, -408.7627485353781, -362.00674022581865, -369.83132100439786, -328.0680161594783, -463.3571909629331, -392.96049824112845, -333.57049650290725, 188.24346700582794, -670.5429509480239, -81.83245374108846, -430.14836601072204, -382.80993481743496, -417.0015436939376, -167.7405456879434, -531.0683636967674, -297.8714902128884, -286.9209030249659], "policy_predator_policy_reward": [386.2270891071769, 331.97031096096384, 456.88248055592993, 277.1027369991371, 290.4351591822231, 304.6307842666309, 265.396849989799, 410.7316211111237, 296.5374066989407, 448.5385542024088, 487.8825600429526, 419.5097692586712, 529.0826583913845, 434.91619763462916, 417.39156580253825, 288.32670083644535, 334.8685523883198, 342.72472529590056, 255.90847843850344, 327.6318230081113, 419.8644981114981, 134.51112266622593, 50.61927266701019, 466.0513556105999, 380.2618431494413, 322.5084487688036, 343.65888209566594, 461.7635557012537, 257.48084757787115, 479.81631335616447, 407.388836280921, 503.38368505429463, 285.5297180934712, 268.813264753367, 428.95009241654697, 249.7999172759101, 300.69827024795677, 265.99562359345816, 182.08328140515525, 328.27206443078467, 158.70605499505257, 335.0925613422239, 286.9312214182597, 227.54252878859927, 151.78236901427218, 442.1610780987682, 6.672199728793571, 441.36549195843264, 470.98833666535603, 251.10178951919514, 318.08807051387737, 278.8410333448156, 403.1877377494895, 187.80940001713248, 323.3385783809108, 175.12719783126656, 325.249077252451, 424.95274012314354, 320.05523589370034, 340.13539504880123, 415.6070957631783, 327.8006980828147, 532.5073966673941, 285.81651836502994, 101.07202355650273, 67.99784034770423, 452.25761910151516, 421.39590999219774, 402.51161803380205, 483.41246858983857, 497.40520829637285, 312.0214696115717, 303.6497045927852, 186.57618588143512, 429.5618674545414, 420.8331972738236, 348.6549421921895, 295.38419192346174, 260.0485601533799, 145.97274000783398, 441.9197094081976, 269.03046968682764, 311.75074581443903, 353.0501219041423, 352.34107526363, 488.0459962922618, 431.1686816856669, 341.0818862473732, 423.8333429854794, 292.8450677353017, 427.6516701573458, 363.4725053632622, 299.7884462320776, 493.5654248941996, 406.5979125178128, 451.0197119665057, 358.3781824340631, 104.95862478170905, 198.18734087052093, 373.7731702344231, 202.13053536263496, 427.93118750399833, 494.9934331524613, 380.9012237591788, 339.37256099972916, 505.25183552062015, 322.9782710088278, 378.78487802876117, 187.29702169957474, 459.36669214265277, 363.7476649841111, 175.91559988937618, 343.4693536799197, 86.48525340370371, 158.2854566939014, 374.11189774471626, 469.09642594232014, 214.02296659649804, 311.29757481170975, 440.2744217039282, 334.9257381102116, 447.43759624429794, 497.52765653157405, 60.31101128474772, 168.8644899478514, 268.7105965354082, 377.29643348282605, 356.3311818806139, 322.551719712252, 252.15443787305202, 250.52287543021828, 217.1572409060784, 236.2388248088528, 375.73615368785073, 233.81478279542267, 457.7956379971008, 529.5385830570528, 435.51011517255364, 205.24347529752427, 476.4276951697566, 371.1252010210223, 347.0287306463196, 420.12987181378355, 466.84859368517374, 452.58486926267375, 353.90912013380614, 356.5865304454223, 411.5090586211567, 307.94761067883513, 175.78187214950032, 283.8965652531786, 40.04024737790228, 342.5425518443124, 394.76003443830876, 441.48734879882056, 217.6413769962685, 298.6348693832042, 507.5214893743734, 262.73736667090725, 448.82854506373195, 232.20048313941462, 378.41159846871267, 429.93695041796474, 15.565351682106874, 343.0455505497654, 385.98926639691, 458.07490704391455, 231.5608794038518, 49.91487209879803, 330.87961846058704, 313.20673214209756, 386.8228676278317, 431.5435595143692, 329.7164092241786, 416.99534506144806, 220.99983463124565, 484.65542881112196, 476.75694794599286, 180.45469164518698, 485.1943834141253, 415.7367087630473, 535.2712849618557, 303.19897150261926, 414.02509271676377, 378.2812362627887, 255.1461182084766, 359.25296202250297, 422.6844575571222, 439.31811056401693, 307.33673881500533, 178.53057487750615, 598.6750302592245, 76.0255851956413, 431.9088164041815, 390.77793968014674, 384.138355269082, 242.93931206953224, 531.1083636967674, 425.3699428706684, 284.1244935056908]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.598222463179019, "mean_inference_ms": 79.10330611879562, "mean_action_processing_ms": 0.254135063687657, "mean_env_wait_ms": 11.553261993451201, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005174875259399414, "StateBufferConnector_ms": 0.003699779510498047, "ViewRequirementAgentConnector_ms": 0.116341233253479}, "num_episodes": 18, "episode_return_max": 368.49082860227395, "episode_return_min": -98.41070675895112, "episode_return_mean": 94.46707230030283, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 560000, "num_agent_steps_trained": 560000, "num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 3.4515834188535592, "num_env_steps_trained_throughput_per_sec": 3.4515834188535592, "timesteps_total": 140000, "num_env_steps_sampled_lifetime": 140000, "num_agent_steps_sampled_lifetime": 560000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 560000, "timers": {"training_iteration_time_ms": 3657519.095, "restore_workers_time_ms": 0.014, "training_step_time_ms": 3657519.025, "sample_time_ms": 54899.394, "learn_time_ms": 3602599.269, "learn_throughput": 1.11, "synch_weights_time_ms": 17.367}, "counters": {"num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_agent_steps_sampled": 560000, "num_agent_steps_trained": 560000}, "done": false, "training_iteration": 35, "trial_id": "b941d_00000", "date": "2024-08-18_01-03-19", "timestamp": 1723923199, "time_this_iter_s": 1158.9258861541748, "time_total_s": 61763.95471429825, "pid": 81115, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[32, [4, 4], 2], [64, [3, 3], 2], [128, [3, 3], 1]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [256, 256], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2966310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 61763.95471429825, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 21.182446808510633, "ram_util_percent": 74.6351063829787}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 12.223742368486192, "cur_kl_coeff": 1.5187500000000005, "cur_lr": 0.00010000000000000003, "total_loss": 8.880478712112184, "policy_loss": -0.09247459553147631, "vf_loss": 8.948288442974999, "vf_explained_var": 0.3292826589453157, "kl": 0.016240229073423144, "entropy": 1.0216446129417924, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 67095.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.768007584286745, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.00010000000000000003, "total_loss": 9.398322685181148, "policy_loss": -0.08879583860850997, "vf_loss": 9.46790037609282, "vf_explained_var": 0.045221981863496165, "kl": 0.018980911234682884, "entropy": 0.771219259185135, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 67095.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 576000}, "env_runners": {"episode_reward_max": 368.49082860227395, "episode_reward_min": -98.41070675895112, "episode_reward_mean": 93.10414112582812, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -670.5429509480239, "predator_policy": 6.672199728793571}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 598.6750302592245}, "policy_reward_mean": {"prey_policy": -297.2899337247117, "predator_policy": 343.8420042876257}, "custom_metrics": {}, "hist_stats": {"episode_reward": [120.14000000000004, 188.09999999999997, 115.83402213324378, 90.17936060646548, 93.36614216893868, 62.62016630068721, 23.594329810792622, 155.98512793752568, 92.24816344446965, 72.11429175196005, 368.49082860227395, 33.85331404814125, 55.27831746414236, 339.50192799469727, 258.05242239884757, 161.0730467081689, 40.7806263920856, 168.544756674182, 28.657167260799383, -5.291600481164752, 3.5321879877081988, 61.071996823453375, 52.72668899090054, 139.45771482369742, 1.3723274665881862, 18.570284462253365, 57.70713475602447, 302.58126686931433, 144.27199676487473, 73.5978624804595, 63.03639588618482, 56.11129613299591, 147.4975630981298, -86.52785148940445, 300.66703339458803, 51.16512132487984, 79.75112789746503, 22.07507253867226, 80.82447758243505, 217.48157227183486, 124.40917419476499, 28.327041290715133, 197.67086575131032, 340.63666357085623, 121.01292618377435, 78.35277559922051, 65.02553896266444, 108.92592108313337, 21.86261877828207, 5.439000267744666, 26.314540852410577, 164.87478778992374, 127.03946677426534, 168.70646309601437, -36.21631632834731, 96.30426081517405, 123.04095031149757, -6.632031010691158, 64.76674931457644, 146.95368808236685, 101.59205195192365, -18.41992066366007, 159.4002906694215, 130.17412989745688, 9.853079378246012, 321.1058958707016, 0.07999999999999297, 68.79977998542184, 1.4241230376895384, 45.52824312701181, -98.41070675895112, -9.48778754278586, 20.12385463498626, 294.9061211945354, -4.046418151988521, -24.8951835621438, 75.23876638158897, 124.70204313850529, 91.3023068650555, 259.0009540183212, 97.26891776548362, 34.025614657013655, 7.936362374311608, 66.81448426829002, 40.33947307284741, -51.724536436036644, 4.420198112556024, 9.34265885139396, 21.70333092991956, 0.0799999999999943, 237.0670346253498, 39.15360936826771, 50.4704950123126, 191.20398456782658, 1.2000000000000037, 130.46934951387317, 185.95968441819937, 72.21440565186055, 276.75151309130024, 130.83714260773715], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-34.72236901427216, -439.08107809876816, 181.3778002712064, -441.3154919584327, -351.1022275510513, -255.15387650025627, -287.4114555684431, -219.33828768378459, -118.78168182621087, -378.8493137714727, -287.1194750837698, -148.72613482772138, -361.00192533023335, -365.60556223456854, -404.7373859265365, -99.46811707843858, -497.8544041027696, -153.30522629875398, -532.4973966673941, -213.7122266130702, 176.7228663913528, 22.698098306714172, -513.6076732512106, -326.19254179436155, -427.29621553590675, -403.3495536235916, -551.5490465546369, 81.62429664138952, -398.24553006255246, 166.07206198717984, -474.4350195777644, -214.88699844243249, -329.92576240411114, -273.3327453194547, -183.3682375926239, -54.10830589440795, -310.08433383384875, -372.208678000377, -311.0040430311019, -359.0884251686446, -477.8049556425967, -359.0499279255872, -430.09626242056197, -281.0823086890248, -121.66169731513234, -542.2900244147478, -493.4529084795613, -158.2135522173508, -298.4161187654897, -493.5654248941996, -405.805877877199, -433.2414621448664, -239.8048577990632, -165.82481466068464, 193.07, -462.44924423562964, -305.30377367611817, -180.48595242564076, -513.3094796462972, -288.9873147848841, -235.88664476113541, -545.7013558730295, -388.54074557756513, -257.1111073270285, -354.4359014456331, -144.7302492984649, -256.5662156947312, -369.6249006681604, -301.2022325615636, 171.91465887252815, -253.94224345615922, -227.28998965757845, -234.011268156011, -369.3569964853424, -404.63640352873733, -324.86052044822827, -337.19218862268457, -364.3466681493901, -496.4719449691712, 156.11484942468425, -94.6497274050822, -218.51618488341248, -348.16503566004724, -357.135538412678, -260.6382679608604, -116.39702387313326, -318.2555436643235, 191.21209089888316, -250.34163359993602, -240.62041871299377, -382.56552445786804, -230.69212073543537, -529.8375210951045, -370.1856381718374, -168.39093833303102, -404.3543110511163, -386.00430396956637, -310.28700891949353, -420.6839092425523, -460.85555598866046, -426.5848692626737, -353.5945792813959, -377.17081781809327, -226.04998345856194, -358.69001605407084, 2.0000000000000013, 113.94109273815032, -269.1714422732168, -361.20204984764695, -412.31685276332155, -406.62601469050776, -156.1984502894073, -386.02095182818937, -297.0944566178907, -262.08736667090704, -456.11057607442314, -317.1077088586477, -228.73762343490316, -393.377987683381, 94.82937366567663, -367.3844636409837, -260.05830135376806, -228.131358845911, -479.9243482655154, -16.68587782855087, -204.70832206141307, -359.71013519567066, -210.14533467680178, -332.2816269164747, -419.12526244382724, -516.8892838219919, 200.0, -484.645428811122, -476.6869479459929, -474.59932033438525, -122.2499747395055, -415.08629697718413, -534.4975737100294, -262.9330725569933, -408.7627485353781, -362.00674022581865, -369.83132100439786, -328.0680161594783, -463.3571909629331, -392.96049824112845, -333.57049650290725, 188.24346700582794, -670.5429509480239, -81.83245374108846, -430.14836601072204, -382.80993481743496, -417.0015436939376, -167.7405456879434, -531.0683636967674, -297.8714902128884, -286.9209030249659, -268.58428520086466, -112.57981502454277, 146.54, -423.62542467523195, -610.4469294758152, -251.16732706475776, -536.6536349306344, -282.4763902772528, -472.13255017444106, -348.7753930307449, -366.7843020350941, -411.7602363215816, -246.66881343461372, -410.4727975842864, -611.1970540337041, -369.0712796559767, -493.11340514264924, -451.4895079866546, -383.5737496907519, -348.8188428224011, -440.36461830969745, -452.72494296848566, -427.82988656998043, -551.1876724358979, -471.4219102259707, 57.44, -413.9014331775504, -196.6765475209756, -193.98252393197777, -397.25124252703483, 105.39313725369452, -432.69668665969834, -409.3002471798836, -342.9778256108148, -612.230368484897, -169.96148489164108, 168.6664352978927, -423.95541355449166, -379.3168432705935, -176.40460805348658, 129.34941271463222, -299.92419336536534, -226.07494100521416, -331.4465305519682], "policy_predator_policy_reward": [151.78236901427218, 442.1610780987682, 6.672199728793571, 441.36549195843264, 470.98833666535603, 251.10178951919514, 318.08807051387737, 278.8410333448156, 403.1877377494895, 187.80940001713248, 323.3385783809108, 175.12719783126656, 325.249077252451, 424.95274012314354, 320.05523589370034, 340.13539504880123, 415.6070957631783, 327.8006980828147, 532.5073966673941, 285.81651836502994, 101.07202355650273, 67.99784034770423, 452.25761910151516, 421.39590999219774, 402.51161803380205, 483.41246858983857, 497.40520829637285, 312.0214696115717, 303.6497045927852, 186.57618588143512, 429.5618674545414, 420.8331972738236, 348.6549421921895, 295.38419192346174, 260.0485601533799, 145.97274000783398, 441.9197094081976, 269.03046968682764, 311.75074581443903, 353.0501219041423, 352.34107526363, 488.0459962922618, 431.1686816856669, 341.0818862473732, 423.8333429854794, 292.8450677353017, 427.6516701573458, 363.4725053632622, 299.7884462320776, 493.5654248941996, 406.5979125178128, 451.0197119665057, 358.3781824340631, 104.95862478170905, 198.18734087052093, 373.7731702344231, 202.13053536263496, 427.93118750399833, 494.9934331524613, 380.9012237591788, 339.37256099972916, 505.25183552062015, 322.9782710088278, 378.78487802876117, 187.29702169957474, 459.36669214265277, 363.7476649841111, 175.91559988937618, 343.4693536799197, 86.48525340370371, 158.2854566939014, 374.11189774471626, 469.09642594232014, 214.02296659649804, 311.29757481170975, 440.2744217039282, 334.9257381102116, 447.43759624429794, 497.52765653157405, 60.31101128474772, 168.8644899478514, 268.7105965354082, 377.29643348282605, 356.3311818806139, 322.551719712252, 252.15443787305202, 250.52287543021828, 217.1572409060784, 236.2388248088528, 375.73615368785073, 233.81478279542267, 457.7956379971008, 529.5385830570528, 435.51011517255364, 205.24347529752427, 476.4276951697566, 371.1252010210223, 347.0287306463196, 420.12987181378355, 466.84859368517374, 452.58486926267375, 353.90912013380614, 356.5865304454223, 411.5090586211567, 307.94761067883513, 175.78187214950032, 283.8965652531786, 40.04024737790228, 342.5425518443124, 394.76003443830876, 441.48734879882056, 217.6413769962685, 298.6348693832042, 507.5214893743734, 262.73736667090725, 448.82854506373195, 232.20048313941462, 378.41159846871267, 429.93695041796474, 15.565351682106874, 343.0455505497654, 385.98926639691, 458.07490704391455, 231.5608794038518, 49.91487209879803, 330.87961846058704, 313.20673214209756, 386.8228676278317, 431.5435595143692, 329.7164092241786, 416.99534506144806, 220.99983463124565, 484.65542881112196, 476.75694794599286, 180.45469164518698, 485.1943834141253, 415.7367087630473, 535.2712849618557, 303.19897150261926, 414.02509271676377, 378.2812362627887, 255.1461182084766, 359.25296202250297, 422.6844575571222, 439.31811056401693, 307.33673881500533, 178.53057487750615, 598.6750302592245, 76.0255851956413, 431.9088164041815, 390.77793968014674, 384.138355269082, 242.93931206953224, 531.1083636967674, 425.3699428706684, 284.1244935056908, 376.95180628331394, 95.51460080714887, 314.3097463047149, 221.77663238883824, 408.0232478827932, 550.8599264232629, 524.129193511392, 329.0264463535085, 377.679780424175, 451.164525155322, 355.86248227627, 489.4965403486953, 373.41898561376945, 324.06209847797726, 388.09172883137643, 540.452068422267, 492.37919469566276, 456.643916546197, 291.8763594559222, 449.8588919086241, 528.2668261429686, 386.5260660651344, 427.89988656998037, 551.1976724358979, 308.5138280225301, 342.53511682879014, 400.83015218016897, 248.90143788662456, 266.65597796232856, 375.04828350899624, 84.71084731413214, 433.79668665969825, 410.33024717988354, 343.14782561081466, 503.2393123380876, 409.4218905523224, 21.11830997065861, 420.1303527041396, 383.44964669339606, 244.48621028254422, 266.0749898196559, 181.25130392237736, 205.80226650533822, 482.5563476595808]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.715037176975859, "mean_inference_ms": 75.99734034419154, "mean_action_processing_ms": 0.2542102761191063, "mean_env_wait_ms": 12.190075376385447, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005133271217346191, "StateBufferConnector_ms": 0.0036585330963134766, "ViewRequirementAgentConnector_ms": 0.1116718053817749}, "num_episodes": 22, "episode_return_max": 368.49082860227395, "episode_return_min": -98.41070675895112, "episode_return_mean": 93.10414112582812, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 576000, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1.5067156975847604, "num_env_steps_trained_throughput_per_sec": 1.5067156975847604, "timesteps_total": 144000, "num_env_steps_sampled_lifetime": 144000, "num_agent_steps_sampled_lifetime": 576000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 576000, "timers": {"training_iteration_time_ms": 3428154.009, "restore_workers_time_ms": 0.014, "training_step_time_ms": 3428153.939, "sample_time_ms": 54892.152, "learn_time_ms": 3373242.097, "learn_throughput": 1.186, "synch_weights_time_ms": 16.995}, "counters": {"num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 576000}, "done": false, "training_iteration": 36, "trial_id": "b941d_00000", "date": "2024-08-18_01-47-34", "timestamp": 1723925854, "time_this_iter_s": 2654.7852301597595, "time_total_s": 64418.73994445801, "pid": 81115, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[32, [4, 4], 2], [64, [3, 3], 2], [128, [3, 3], 1]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [256, 256], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b0403940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 64418.73994445801, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 22.17243243243243, "ram_util_percent": 72.72108108108107}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 15.344941686196302, "cur_kl_coeff": 1.5187500000000005, "cur_lr": 0.00010000000000000003, "total_loss": 8.366189329964774, "policy_loss": -0.08958174569308068, "vf_loss": 8.431745940415317, "vf_explained_var": 0.3369515250914942, "kl": 0.01581900905358343, "entropy": 1.016338551233685, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 68985.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.0267563694999335, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.00010000000000000003, "total_loss": 9.054985306250355, "policy_loss": -0.07761890884887959, "vf_loss": 9.114087405028167, "vf_explained_var": 0.10951526543450733, "kl": 0.01828820242400227, "entropy": 0.7728170934492948, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 68985.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_agent_steps_sampled": 592000, "num_agent_steps_trained": 592000}, "env_runners": {"episode_reward_max": 340.63666357085623, "episode_reward_min": -98.41070675895112, "episode_reward_mean": 88.44412012173015, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -670.5429509480239, "predator_policy": 7.167012648762582}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 598.6750302592245}, "policy_reward_mean": {"prey_policy": -303.85330909405803, "predator_policy": 348.075369154923}, "custom_metrics": {}, "hist_stats": {"episode_reward": [139.45771482369742, 1.3723274665881862, 18.570284462253365, 57.70713475602447, 302.58126686931433, 144.27199676487473, 73.5978624804595, 63.03639588618482, 56.11129613299591, 147.4975630981298, -86.52785148940445, 300.66703339458803, 51.16512132487984, 79.75112789746503, 22.07507253867226, 80.82447758243505, 217.48157227183486, 124.40917419476499, 28.327041290715133, 197.67086575131032, 340.63666357085623, 121.01292618377435, 78.35277559922051, 65.02553896266444, 108.92592108313337, 21.86261877828207, 5.439000267744666, 26.314540852410577, 164.87478778992374, 127.03946677426534, 168.70646309601437, -36.21631632834731, 96.30426081517405, 123.04095031149757, -6.632031010691158, 64.76674931457644, 146.95368808236685, 101.59205195192365, -18.41992066366007, 159.4002906694215, 130.17412989745688, 9.853079378246012, 321.1058958707016, 0.07999999999999297, 68.79977998542184, 1.4241230376895384, 45.52824312701181, -98.41070675895112, -9.48778754278586, 20.12385463498626, 294.9061211945354, -4.046418151988521, -24.8951835621438, 75.23876638158897, 124.70204313850529, 91.3023068650555, 259.0009540183212, 97.26891776548362, 34.025614657013655, 7.936362374311608, 66.81448426829002, 40.33947307284741, -51.724536436036644, 4.420198112556024, 9.34265885139396, 21.70333092991956, 0.0799999999999943, 237.0670346253498, 39.15360936826771, 50.4704950123126, 191.20398456782658, 1.2000000000000037, 130.46934951387317, 185.95968441819937, 72.21440565186055, 276.75151309130024, 130.83714260773715, 74.31863235516585, 4.820370132808581, 202.1626474735667, 4.109999999999996, 237.87736412278662, 2.1528959577213804, 39.01450030315864, 74.86312233504046, 16.558053218092905, 3.4215570096677226, -36.12510683175486, 136.9723602903868, 52.99012962536881, 201.75701264876224, -64.45609963234222, 325.69976067223115, 124.42531039766715, 203.35838690237406, 140.29335243645593, 43.7573391539796, 206.4483603531908, 29.82273052238445, 90.2085051618098], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-493.4529084795613, -158.2135522173508, -298.4161187654897, -493.5654248941996, -405.805877877199, -433.2414621448664, -239.8048577990632, -165.82481466068464, 193.07, -462.44924423562964, -305.30377367611817, -180.48595242564076, -513.3094796462972, -288.9873147848841, -235.88664476113541, -545.7013558730295, -388.54074557756513, -257.1111073270285, -354.4359014456331, -144.7302492984649, -256.5662156947312, -369.6249006681604, -301.2022325615636, 171.91465887252815, -253.94224345615922, -227.28998965757845, -234.011268156011, -369.3569964853424, -404.63640352873733, -324.86052044822827, -337.19218862268457, -364.3466681493901, -496.4719449691712, 156.11484942468425, -94.6497274050822, -218.51618488341248, -348.16503566004724, -357.135538412678, -260.6382679608604, -116.39702387313326, -318.2555436643235, 191.21209089888316, -250.34163359993602, -240.62041871299377, -382.56552445786804, -230.69212073543537, -529.8375210951045, -370.1856381718374, -168.39093833303102, -404.3543110511163, -386.00430396956637, -310.28700891949353, -420.6839092425523, -460.85555598866046, -426.5848692626737, -353.5945792813959, -377.17081781809327, -226.04998345856194, -358.69001605407084, 2.0000000000000013, 113.94109273815032, -269.1714422732168, -361.20204984764695, -412.31685276332155, -406.62601469050776, -156.1984502894073, -386.02095182818937, -297.0944566178907, -262.08736667090704, -456.11057607442314, -317.1077088586477, -228.73762343490316, -393.377987683381, 94.82937366567663, -367.3844636409837, -260.05830135376806, -228.131358845911, -479.9243482655154, -16.68587782855087, -204.70832206141307, -359.71013519567066, -210.14533467680178, -332.2816269164747, -419.12526244382724, -516.8892838219919, 200.0, -484.645428811122, -476.6869479459929, -474.59932033438525, -122.2499747395055, -415.08629697718413, -534.4975737100294, -262.9330725569933, -408.7627485353781, -362.00674022581865, -369.83132100439786, -328.0680161594783, -463.3571909629331, -392.96049824112845, -333.57049650290725, 188.24346700582794, -670.5429509480239, -81.83245374108846, -430.14836601072204, -382.80993481743496, -417.0015436939376, -167.7405456879434, -531.0683636967674, -297.8714902128884, -286.9209030249659, -268.58428520086466, -112.57981502454277, 146.54, -423.62542467523195, -610.4469294758152, -251.16732706475776, -536.6536349306344, -282.4763902772528, -472.13255017444106, -348.7753930307449, -366.7843020350941, -411.7602363215816, -246.66881343461372, -410.4727975842864, -611.1970540337041, -369.0712796559767, -493.11340514264924, -451.4895079866546, -383.5737496907519, -348.8188428224011, -440.36461830969745, -452.72494296848566, -427.82988656998043, -551.1876724358979, -471.4219102259707, 57.44, -413.9014331775504, -196.6765475209756, -193.98252393197777, -397.25124252703483, 105.39313725369452, -432.69668665969834, -409.3002471798836, -342.9778256108148, -612.230368484897, -169.96148489164108, 168.6664352978927, -423.95541355449166, -379.3168432705935, -176.40460805348658, 129.34941271463222, -299.92419336536534, -226.07494100521416, -331.4465305519682, -210.93151527689145, -422.6779696783641, -538.883504488577, -457.19006648340996, -412.57168300216034, 46.40229552943707, -401.1088115706625, -494.41996176843304, -52.08014322363231, -499.9744916815664, -398.24884343532517, -429.1937094446426, -207.3514676113883, -294.84962656521304, -365.95502596094434, -143.57836518814835, -283.039486530033, -409.4975011885166, -403.64056548839466, -449.25465751307564, -459.5140475187106, -443.3014925261794, -280.62886548131047, -343.2230904690076, -125.81354190694033, -500.21631384896375, -250.2749009236453, 182.18, -469.7240931896886, -414.14845793831626, 138.85163562122025, -47.748570882759026, -90.44896406570216, -576.8593286412462, -89.26700284966802, -452.56425167771323, -523.0990467970552, -243.95241843924572, -431.6261658498274, -419.6754752564761, -223.24123631825182, -97.55242573478898, -299.62706896099706, -130.69738349755147, -396.2467114603744, -172.16755371891537], "policy_predator_policy_reward": [427.6516701573458, 363.4725053632622, 299.7884462320776, 493.5654248941996, 406.5979125178128, 451.0197119665057, 358.3781824340631, 104.95862478170905, 198.18734087052093, 373.7731702344231, 202.13053536263496, 427.93118750399833, 494.9934331524613, 380.9012237591788, 339.37256099972916, 505.25183552062015, 322.9782710088278, 378.78487802876117, 187.29702169957474, 459.36669214265277, 363.7476649841111, 175.91559988937618, 343.4693536799197, 86.48525340370371, 158.2854566939014, 374.11189774471626, 469.09642594232014, 214.02296659649804, 311.29757481170975, 440.2744217039282, 334.9257381102116, 447.43759624429794, 497.52765653157405, 60.31101128474772, 168.8644899478514, 268.7105965354082, 377.29643348282605, 356.3311818806139, 322.551719712252, 252.15443787305202, 250.52287543021828, 217.1572409060784, 236.2388248088528, 375.73615368785073, 233.81478279542267, 457.7956379971008, 529.5385830570528, 435.51011517255364, 205.24347529752427, 476.4276951697566, 371.1252010210223, 347.0287306463196, 420.12987181378355, 466.84859368517374, 452.58486926267375, 353.90912013380614, 356.5865304454223, 411.5090586211567, 307.94761067883513, 175.78187214950032, 283.8965652531786, 40.04024737790228, 342.5425518443124, 394.76003443830876, 441.48734879882056, 217.6413769962685, 298.6348693832042, 507.5214893743734, 262.73736667090725, 448.82854506373195, 232.20048313941462, 378.41159846871267, 429.93695041796474, 15.565351682106874, 343.0455505497654, 385.98926639691, 458.07490704391455, 231.5608794038518, 49.91487209879803, 330.87961846058704, 313.20673214209756, 386.8228676278317, 431.5435595143692, 329.7164092241786, 416.99534506144806, 220.99983463124565, 484.65542881112196, 476.75694794599286, 180.45469164518698, 485.1943834141253, 415.7367087630473, 535.2712849618557, 303.19897150261926, 414.02509271676377, 378.2812362627887, 255.1461182084766, 359.25296202250297, 422.6844575571222, 439.31811056401693, 307.33673881500533, 178.53057487750615, 598.6750302592245, 76.0255851956413, 431.9088164041815, 390.77793968014674, 384.138355269082, 242.93931206953224, 531.1083636967674, 425.3699428706684, 284.1244935056908, 376.95180628331394, 95.51460080714887, 314.3097463047149, 221.77663238883824, 408.0232478827932, 550.8599264232629, 524.129193511392, 329.0264463535085, 377.679780424175, 451.164525155322, 355.86248227627, 489.4965403486953, 373.41898561376945, 324.06209847797726, 388.09172883137643, 540.452068422267, 492.37919469566276, 456.643916546197, 291.8763594559222, 449.8588919086241, 528.2668261429686, 386.5260660651344, 427.89988656998037, 551.1976724358979, 308.5138280225301, 342.53511682879014, 400.83015218016897, 248.90143788662456, 266.65597796232856, 375.04828350899624, 84.71084731413214, 433.79668665969825, 410.33024717988354, 343.14782561081466, 503.2393123380876, 409.4218905523224, 21.11830997065861, 420.1303527041396, 383.44964669339606, 244.48621028254422, 266.0749898196559, 181.25130392237736, 205.80226650533822, 482.5563476595808, 337.4648673721436, 370.4632499382775, 549.0821996724646, 451.8117414323311, 386.31971217485045, 182.01232277143967, 401.16881157066246, 498.46996176843305, 395.6682654352085, 394.26373359277744, 338.9616798892486, 490.6337689484397, 155.7813717106256, 385.4342227691329, 358.88672182445026, 225.50979165968147, 335.8057123938427, 373.28932854279924, 404.8291197085488, 451.4876603025892, 502.0957118873741, 364.5947213257611, 355.1106078689001, 405.71370837180325, 443.374248271287, 235.6457371099856, 262.68490092364493, 7.167012648762582, 451.19907401563466, 368.2173774800282, 93.96268846650251, 140.63400746726722, 391.14891793319794, 400.5846851714178, 305.18781518428005, 440.0018262454752, 364.62155176945583, 542.7232659033006, 481.21597640847386, 413.84300385180893, 276.0670939597385, 251.17492844649314, 302.8588422629166, 157.28834071801543, 341.1145017234657, 317.5082686176336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.093381148354064, "mean_inference_ms": 74.26213448172076, "mean_action_processing_ms": 0.25400491702665734, "mean_env_wait_ms": 10.84676259673342, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005046367645263672, "StateBufferConnector_ms": 0.0036323070526123047, "ViewRequirementAgentConnector_ms": 0.1111372709274292}, "num_episodes": 23, "episode_return_max": 340.63666357085623, "episode_return_min": -98.41070675895112, "episode_return_mean": 88.44412012173015, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 592000, "num_agent_steps_trained": 592000, "num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 2.869478548953171, "num_env_steps_trained_throughput_per_sec": 2.869478548953171, "timesteps_total": 148000, "num_env_steps_sampled_lifetime": 148000, "num_agent_steps_sampled_lifetime": 592000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 592000, "timers": {"training_iteration_time_ms": 2965252.284, "restore_workers_time_ms": 0.014, "training_step_time_ms": 2965252.215, "sample_time_ms": 54886.859, "learn_time_ms": 2910346.214, "learn_throughput": 1.374, "synch_weights_time_ms": 16.94}, "counters": {"num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_agent_steps_sampled": 592000, "num_agent_steps_trained": 592000}, "done": false, "training_iteration": 37, "trial_id": "b941d_00000", "date": "2024-08-18_02-10-48", "timestamp": 1723927248, "time_this_iter_s": 1393.9934267997742, "time_total_s": 65812.73337125778, "pid": 81115, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[32, [4, 4], 2], [64, [3, 3], 2], [128, [3, 3], 1]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [256, 256], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2937ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 65812.73337125778, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 20.429189189189188, "ram_util_percent": 74.68702702702704}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 15.093828122199527, "cur_kl_coeff": 1.5187500000000005, "cur_lr": 0.00010000000000000003, "total_loss": 8.9276443012177, "policy_loss": -0.08070713271357356, "vf_loss": 8.985363511181383, "vf_explained_var": 0.19046747233501818, "kl": 0.015136084999164462, "entropy": 1.0412823544292853, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 70875.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.4426109382084435, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.00010000000000000003, "total_loss": 9.106460444132487, "policy_loss": -0.07629861464039003, "vf_loss": 9.164752311302871, "vf_explained_var": 0.09224584052171657, "kl": 0.017784399154507538, "entropy": 0.7420060827303185, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 70875.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_agent_steps_sampled": 608000, "num_agent_steps_trained": 608000}, "env_runners": {"episode_reward_max": 340.63666357085623, "episode_reward_min": -98.41070675895112, "episode_reward_mean": 83.05899870132771, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -670.5429509480239, "predator_policy": 6.3610229910092695}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 598.6750302592245}, "policy_reward_mean": {"prey_policy": -313.77366532807247, "predator_policy": 355.30316467873627}, "custom_metrics": {}, "hist_stats": {"episode_reward": [28.327041290715133, 197.67086575131032, 340.63666357085623, 121.01292618377435, 78.35277559922051, 65.02553896266444, 108.92592108313337, 21.86261877828207, 5.439000267744666, 26.314540852410577, 164.87478778992374, 127.03946677426534, 168.70646309601437, -36.21631632834731, 96.30426081517405, 123.04095031149757, -6.632031010691158, 64.76674931457644, 146.95368808236685, 101.59205195192365, -18.41992066366007, 159.4002906694215, 130.17412989745688, 9.853079378246012, 321.1058958707016, 0.07999999999999297, 68.79977998542184, 1.4241230376895384, 45.52824312701181, -98.41070675895112, -9.48778754278586, 20.12385463498626, 294.9061211945354, -4.046418151988521, -24.8951835621438, 75.23876638158897, 124.70204313850529, 91.3023068650555, 259.0009540183212, 97.26891776548362, 34.025614657013655, 7.936362374311608, 66.81448426829002, 40.33947307284741, -51.724536436036644, 4.420198112556024, 9.34265885139396, 21.70333092991956, 0.0799999999999943, 237.0670346253498, 39.15360936826771, 50.4704950123126, 191.20398456782658, 1.2000000000000037, 130.46934951387317, 185.95968441819937, 72.21440565186055, 276.75151309130024, 130.83714260773715, 74.31863235516585, 4.820370132808581, 202.1626474735667, 4.109999999999996, 237.87736412278662, 2.1528959577213804, 39.01450030315864, 74.86312233504046, 16.558053218092905, 3.4215570096677226, -36.12510683175486, 136.9723602903868, 52.99012962536881, 201.75701264876224, -64.45609963234222, 325.69976067223115, 124.42531039766715, 203.35838690237406, 140.29335243645593, 43.7573391539796, 206.4483603531908, 29.82273052238445, 90.2085051618098, 38.46520427714118, 8.135855438129118, 61.31794015824085, -7.2065503225546665, 65.57971250579752, 255.27724145952095, 35.29532806001264, 16.32382786866332, 9.094381903670726, 43.16573599111818, 26.332283885232886, 255.22331773721913, 0.2200000000000022, 13.279999999999996, 137.62180864277622, 174.19367363254253, -3.7657822616006182, 126.98344943960534], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-348.16503566004724, -357.135538412678, -260.6382679608604, -116.39702387313326, -318.2555436643235, 191.21209089888316, -250.34163359993602, -240.62041871299377, -382.56552445786804, -230.69212073543537, -529.8375210951045, -370.1856381718374, -168.39093833303102, -404.3543110511163, -386.00430396956637, -310.28700891949353, -420.6839092425523, -460.85555598866046, -426.5848692626737, -353.5945792813959, -377.17081781809327, -226.04998345856194, -358.69001605407084, 2.0000000000000013, 113.94109273815032, -269.1714422732168, -361.20204984764695, -412.31685276332155, -406.62601469050776, -156.1984502894073, -386.02095182818937, -297.0944566178907, -262.08736667090704, -456.11057607442314, -317.1077088586477, -228.73762343490316, -393.377987683381, 94.82937366567663, -367.3844636409837, -260.05830135376806, -228.131358845911, -479.9243482655154, -16.68587782855087, -204.70832206141307, -359.71013519567066, -210.14533467680178, -332.2816269164747, -419.12526244382724, -516.8892838219919, 200.0, -484.645428811122, -476.6869479459929, -474.59932033438525, -122.2499747395055, -415.08629697718413, -534.4975737100294, -262.9330725569933, -408.7627485353781, -362.00674022581865, -369.83132100439786, -328.0680161594783, -463.3571909629331, -392.96049824112845, -333.57049650290725, 188.24346700582794, -670.5429509480239, -81.83245374108846, -430.14836601072204, -382.80993481743496, -417.0015436939376, -167.7405456879434, -531.0683636967674, -297.8714902128884, -286.9209030249659, -268.58428520086466, -112.57981502454277, 146.54, -423.62542467523195, -610.4469294758152, -251.16732706475776, -536.6536349306344, -282.4763902772528, -472.13255017444106, -348.7753930307449, -366.7843020350941, -411.7602363215816, -246.66881343461372, -410.4727975842864, -611.1970540337041, -369.0712796559767, -493.11340514264924, -451.4895079866546, -383.5737496907519, -348.8188428224011, -440.36461830969745, -452.72494296848566, -427.82988656998043, -551.1876724358979, -471.4219102259707, 57.44, -413.9014331775504, -196.6765475209756, -193.98252393197777, -397.25124252703483, 105.39313725369452, -432.69668665969834, -409.3002471798836, -342.9778256108148, -612.230368484897, -169.96148489164108, 168.6664352978927, -423.95541355449166, -379.3168432705935, -176.40460805348658, 129.34941271463222, -299.92419336536534, -226.07494100521416, -331.4465305519682, -210.93151527689145, -422.6779696783641, -538.883504488577, -457.19006648340996, -412.57168300216034, 46.40229552943707, -401.1088115706625, -494.41996176843304, -52.08014322363231, -499.9744916815664, -398.24884343532517, -429.1937094446426, -207.3514676113883, -294.84962656521304, -365.95502596094434, -143.57836518814835, -283.039486530033, -409.4975011885166, -403.64056548839466, -449.25465751307564, -459.5140475187106, -443.3014925261794, -280.62886548131047, -343.2230904690076, -125.81354190694033, -500.21631384896375, -250.2749009236453, 182.18, -469.7240931896886, -414.14845793831626, 138.85163562122025, -47.748570882759026, -90.44896406570216, -576.8593286412462, -89.26700284966802, -452.56425167771323, -523.0990467970552, -243.95241843924572, -431.6261658498274, -419.6754752564761, -223.24123631825182, -97.55242573478898, -299.62706896099706, -130.69738349755147, -396.2467114603744, -172.16755371891537, -288.37781064612085, -301.3866286638249, -380.0771635229216, -407.5557679078624, -457.98712347451743, -243.4223120965217, -446.96723942922307, -522.3971106645901, -281.6244519397045, -562.0127827538657, -34.564556783800356, -335.1828955354859, -415.497824795023, -300.8065040271086, -402.61463251130135, -393.6190344258732, -201.69583791550988, -413.6095031469591, -486.3749598238513, -348.71655842723555, -317.00923184958765, -117.82367376172786, 66.34808159701373, -355.6781990407817, -387.36577933887986, -511.6669151294919, -493.25202535798906, -263.4221769396712, 34.05821798447617, -398.7772648250915, -323.3309527771761, -329.15699113142625, -490.9586844940423, -497.11651042653733, -62.40195892146146, -408.86124617809077], "policy_predator_policy_reward": [377.29643348282605, 356.3311818806139, 322.551719712252, 252.15443787305202, 250.52287543021828, 217.1572409060784, 236.2388248088528, 375.73615368785073, 233.81478279542267, 457.7956379971008, 529.5385830570528, 435.51011517255364, 205.24347529752427, 476.4276951697566, 371.1252010210223, 347.0287306463196, 420.12987181378355, 466.84859368517374, 452.58486926267375, 353.90912013380614, 356.5865304454223, 411.5090586211567, 307.94761067883513, 175.78187214950032, 283.8965652531786, 40.04024737790228, 342.5425518443124, 394.76003443830876, 441.48734879882056, 217.6413769962685, 298.6348693832042, 507.5214893743734, 262.73736667090725, 448.82854506373195, 232.20048313941462, 378.41159846871267, 429.93695041796474, 15.565351682106874, 343.0455505497654, 385.98926639691, 458.07490704391455, 231.5608794038518, 49.91487209879803, 330.87961846058704, 313.20673214209756, 386.8228676278317, 431.5435595143692, 329.7164092241786, 416.99534506144806, 220.99983463124565, 484.65542881112196, 476.75694794599286, 180.45469164518698, 485.1943834141253, 415.7367087630473, 535.2712849618557, 303.19897150261926, 414.02509271676377, 378.2812362627887, 255.1461182084766, 359.25296202250297, 422.6844575571222, 439.31811056401693, 307.33673881500533, 178.53057487750615, 598.6750302592245, 76.0255851956413, 431.9088164041815, 390.77793968014674, 384.138355269082, 242.93931206953224, 531.1083636967674, 425.3699428706684, 284.1244935056908, 376.95180628331394, 95.51460080714887, 314.3097463047149, 221.77663238883824, 408.0232478827932, 550.8599264232629, 524.129193511392, 329.0264463535085, 377.679780424175, 451.164525155322, 355.86248227627, 489.4965403486953, 373.41898561376945, 324.06209847797726, 388.09172883137643, 540.452068422267, 492.37919469566276, 456.643916546197, 291.8763594559222, 449.8588919086241, 528.2668261429686, 386.5260660651344, 427.89988656998037, 551.1976724358979, 308.5138280225301, 342.53511682879014, 400.83015218016897, 248.90143788662456, 266.65597796232856, 375.04828350899624, 84.71084731413214, 433.79668665969825, 410.33024717988354, 343.14782561081466, 503.2393123380876, 409.4218905523224, 21.11830997065861, 420.1303527041396, 383.44964669339606, 244.48621028254422, 266.0749898196559, 181.25130392237736, 205.80226650533822, 482.5563476595808, 337.4648673721436, 370.4632499382775, 549.0821996724646, 451.8117414323311, 386.31971217485045, 182.01232277143967, 401.16881157066246, 498.46996176843305, 395.6682654352085, 394.26373359277744, 338.9616798892486, 490.6337689484397, 155.7813717106256, 385.4342227691329, 358.88672182445026, 225.50979165968147, 335.8057123938427, 373.28932854279924, 404.8291197085488, 451.4876603025892, 502.0957118873741, 364.5947213257611, 355.1106078689001, 405.71370837180325, 443.374248271287, 235.6457371099856, 262.68490092364493, 7.167012648762582, 451.19907401563466, 368.2173774800282, 93.96268846650251, 140.63400746726722, 391.14891793319794, 400.5846851714178, 305.18781518428005, 440.0018262454752, 364.62155176945583, 542.7232659033006, 481.21597640847386, 413.84300385180893, 276.0670939597385, 251.17492844649314, 302.8588422629166, 157.28834071801543, 341.1145017234657, 317.5082686176336, 279.1943810502294, 349.035262536857, 392.67875785947905, 403.0900290094341, 440.74412570772057, 321.98325002155923, 462.8918818165721, 499.2659179546866, 346.2608210449144, 562.9561261544533, 359.47713585749096, 265.54755792131624, 486.94463864331857, 264.6550182388246, 453.6350261856135, 358.9224686202242, 207.47147604303834, 416.92824692310137, 451.2356572420274, 427.02159700017756, 198.28223811284838, 262.8829513837007, 214.76676891125626, 329.78666626973074, 387.58577933887983, 511.6669151294919, 493.27202535798904, 276.68217693967114, 6.3610229910092695, 495.97983249238246, 461.57856108530416, 365.10305645584054, 487.19290223244167, 497.11651042653733, 290.158324958332, 308.0883295808251]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.90389971281768, "mean_inference_ms": 72.44976869324012, "mean_action_processing_ms": 0.2538406603347301, "mean_env_wait_ms": 10.576837738720098, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004984021186828613, "StateBufferConnector_ms": 0.0036362409591674805, "ViewRequirementAgentConnector_ms": 0.10937201976776123}, "num_episodes": 18, "episode_return_max": 340.63666357085623, "episode_return_min": -98.41070675895112, "episode_return_mean": 83.05899870132771, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 608000, "num_agent_steps_trained": 608000, "num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 3.1054352267558407, "num_env_steps_trained_throughput_per_sec": 3.1054352267558407, "timesteps_total": 152000, "num_env_steps_sampled_lifetime": 152000, "num_agent_steps_sampled_lifetime": 608000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 608000, "timers": {"training_iteration_time_ms": 2418500.005, "restore_workers_time_ms": 0.014, "training_step_time_ms": 2418499.938, "sample_time_ms": 54880.817, "learn_time_ms": 2363600.916, "learn_throughput": 1.692, "synch_weights_time_ms": 16.328}, "counters": {"num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_agent_steps_sampled": 608000, "num_agent_steps_trained": 608000}, "done": false, "training_iteration": 38, "trial_id": "b941d_00000", "date": "2024-08-18_02-32-16", "timestamp": 1723928536, "time_this_iter_s": 1288.0818910598755, "time_total_s": 67100.81526231766, "pid": 81115, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[32, [4, 4], 2], [64, [3, 3], 2], [128, [3, 3], 1]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [256, 256], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b0403ca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 67100.81526231766, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 20.249189189189188, "ram_util_percent": 75.28324324324323}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.470718560143123, "cur_kl_coeff": 1.5187500000000005, "cur_lr": 0.00010000000000000003, "total_loss": 8.73419247253862, "policy_loss": -0.08416014304051973, "vf_loss": 8.794785061841289, "vf_explained_var": 0.26296817644563303, "kl": 0.015517754148440624, "entropy": 1.005631656432278, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 72765.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.6894934692080055, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.00010000000000000003, "total_loss": 9.335318438212077, "policy_loss": -0.07313102935293009, "vf_loss": 9.390935840303936, "vf_explained_var": 0.06073992104126663, "kl": 0.017297420530905976, "entropy": 0.7528535390657092, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 72765.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 624000, "num_agent_steps_trained": 624000}, "env_runners": {"episode_reward_max": 325.69976067223115, "episode_reward_min": -98.41070675895112, "episode_reward_mean": 79.0775882049082, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -670.5429509480239, "predator_policy": 6.3610229910092695}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 644.7860241045256}, "policy_reward_mean": {"prey_policy": -325.3638954835011, "predator_policy": 364.9026895859551}, "custom_metrics": {}, "hist_stats": {"episode_reward": [146.95368808236685, 101.59205195192365, -18.41992066366007, 159.4002906694215, 130.17412989745688, 9.853079378246012, 321.1058958707016, 0.07999999999999297, 68.79977998542184, 1.4241230376895384, 45.52824312701181, -98.41070675895112, -9.48778754278586, 20.12385463498626, 294.9061211945354, -4.046418151988521, -24.8951835621438, 75.23876638158897, 124.70204313850529, 91.3023068650555, 259.0009540183212, 97.26891776548362, 34.025614657013655, 7.936362374311608, 66.81448426829002, 40.33947307284741, -51.724536436036644, 4.420198112556024, 9.34265885139396, 21.70333092991956, 0.0799999999999943, 237.0670346253498, 39.15360936826771, 50.4704950123126, 191.20398456782658, 1.2000000000000037, 130.46934951387317, 185.95968441819937, 72.21440565186055, 276.75151309130024, 130.83714260773715, 74.31863235516585, 4.820370132808581, 202.1626474735667, 4.109999999999996, 237.87736412278662, 2.1528959577213804, 39.01450030315864, 74.86312233504046, 16.558053218092905, 3.4215570096677226, -36.12510683175486, 136.9723602903868, 52.99012962536881, 201.75701264876224, -64.45609963234222, 325.69976067223115, 124.42531039766715, 203.35838690237406, 140.29335243645593, 43.7573391539796, 206.4483603531908, 29.82273052238445, 90.2085051618098, 38.46520427714118, 8.135855438129118, 61.31794015824085, -7.2065503225546665, 65.57971250579752, 255.27724145952095, 35.29532806001264, 16.32382786866332, 9.094381903670726, 43.16573599111818, 26.332283885232886, 255.22331773721913, 0.2200000000000022, 13.279999999999996, 137.62180864277622, 174.19367363254253, -3.7657822616006182, 126.98344943960534, 32.44, 195.2901158804532, 34.62531974858965, 8.534681342362889, 91.04973956240666, -29.68231799869139, 0.10000000000000231, 2.3111404524550823, 111.46563954831626, 33.71639834218564, 30.137211792024015, 313.8995338654949, -0.7453562503633302, 115.28027360106327, 49.50231008981004, 10.053233939988568, 273.56603495026445, 25.767214594213137], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-393.377987683381, 94.82937366567663, -367.3844636409837, -260.05830135376806, -228.131358845911, -479.9243482655154, -16.68587782855087, -204.70832206141307, -359.71013519567066, -210.14533467680178, -332.2816269164747, -419.12526244382724, -516.8892838219919, 200.0, -484.645428811122, -476.6869479459929, -474.59932033438525, -122.2499747395055, -415.08629697718413, -534.4975737100294, -262.9330725569933, -408.7627485353781, -362.00674022581865, -369.83132100439786, -328.0680161594783, -463.3571909629331, -392.96049824112845, -333.57049650290725, 188.24346700582794, -670.5429509480239, -81.83245374108846, -430.14836601072204, -382.80993481743496, -417.0015436939376, -167.7405456879434, -531.0683636967674, -297.8714902128884, -286.9209030249659, -268.58428520086466, -112.57981502454277, 146.54, -423.62542467523195, -610.4469294758152, -251.16732706475776, -536.6536349306344, -282.4763902772528, -472.13255017444106, -348.7753930307449, -366.7843020350941, -411.7602363215816, -246.66881343461372, -410.4727975842864, -611.1970540337041, -369.0712796559767, -493.11340514264924, -451.4895079866546, -383.5737496907519, -348.8188428224011, -440.36461830969745, -452.72494296848566, -427.82988656998043, -551.1876724358979, -471.4219102259707, 57.44, -413.9014331775504, -196.6765475209756, -193.98252393197777, -397.25124252703483, 105.39313725369452, -432.69668665969834, -409.3002471798836, -342.9778256108148, -612.230368484897, -169.96148489164108, 168.6664352978927, -423.95541355449166, -379.3168432705935, -176.40460805348658, 129.34941271463222, -299.92419336536534, -226.07494100521416, -331.4465305519682, -210.93151527689145, -422.6779696783641, -538.883504488577, -457.19006648340996, -412.57168300216034, 46.40229552943707, -401.1088115706625, -494.41996176843304, -52.08014322363231, -499.9744916815664, -398.24884343532517, -429.1937094446426, -207.3514676113883, -294.84962656521304, -365.95502596094434, -143.57836518814835, -283.039486530033, -409.4975011885166, -403.64056548839466, -449.25465751307564, -459.5140475187106, -443.3014925261794, -280.62886548131047, -343.2230904690076, -125.81354190694033, -500.21631384896375, -250.2749009236453, 182.18, -469.7240931896886, -414.14845793831626, 138.85163562122025, -47.748570882759026, -90.44896406570216, -576.8593286412462, -89.26700284966802, -452.56425167771323, -523.0990467970552, -243.95241843924572, -431.6261658498274, -419.6754752564761, -223.24123631825182, -97.55242573478898, -299.62706896099706, -130.69738349755147, -396.2467114603744, -172.16755371891537, -288.37781064612085, -301.3866286638249, -380.0771635229216, -407.5557679078624, -457.98712347451743, -243.4223120965217, -446.96723942922307, -522.3971106645901, -281.6244519397045, -562.0127827538657, -34.564556783800356, -335.1828955354859, -415.497824795023, -300.8065040271086, -402.61463251130135, -393.6190344258732, -201.69583791550988, -413.6095031469591, -486.3749598238513, -348.71655842723555, -317.00923184958765, -117.82367376172786, 66.34808159701373, -355.6781990407817, -387.36577933887986, -511.6669151294919, -493.25202535798906, -263.4221769396712, 34.05821798447617, -398.7772648250915, -323.3309527771761, -329.15699113142625, -490.9586844940423, -497.11651042653733, -62.40195892146146, -408.86124617809077, -245.17336554555385, -460.2546266005294, -531.4821803201808, 103.46332150056334, -258.4780715633998, -468.1463944859851, -395.0411531156648, -403.3541753427317, -224.1995610350516, -444.40199398877866, -441.4494509535151, -257.35577869450793, -570.118585533389, -503.3377353406768, -502.7210161844185, -669.5159637519515, -315.88688449643865, -377.58568522514935, -145.35194670115823, -382.6544260901767, -398.62570765429615, -424.95770273831835, -616.2309618027713, 98.60376768436672, -260.5656833212063, -501.3868736559539, -7.643672869183517, -396.8940208608683, -216.30033705528467, -465.59570037084814, -457.47994075479755, -564.5368625556019, -451.3371331704954, -15.244200694301412, -487.7615558379232, -202.0646413950025], "policy_predator_policy_reward": [429.93695041796474, 15.565351682106874, 343.0455505497654, 385.98926639691, 458.07490704391455, 231.5608794038518, 49.91487209879803, 330.87961846058704, 313.20673214209756, 386.8228676278317, 431.5435595143692, 329.7164092241786, 416.99534506144806, 220.99983463124565, 484.65542881112196, 476.75694794599286, 180.45469164518698, 485.1943834141253, 415.7367087630473, 535.2712849618557, 303.19897150261926, 414.02509271676377, 378.2812362627887, 255.1461182084766, 359.25296202250297, 422.6844575571222, 439.31811056401693, 307.33673881500533, 178.53057487750615, 598.6750302592245, 76.0255851956413, 431.9088164041815, 390.77793968014674, 384.138355269082, 242.93931206953224, 531.1083636967674, 425.3699428706684, 284.1244935056908, 376.95180628331394, 95.51460080714887, 314.3097463047149, 221.77663238883824, 408.0232478827932, 550.8599264232629, 524.129193511392, 329.0264463535085, 377.679780424175, 451.164525155322, 355.86248227627, 489.4965403486953, 373.41898561376945, 324.06209847797726, 388.09172883137643, 540.452068422267, 492.37919469566276, 456.643916546197, 291.8763594559222, 449.8588919086241, 528.2668261429686, 386.5260660651344, 427.89988656998037, 551.1976724358979, 308.5138280225301, 342.53511682879014, 400.83015218016897, 248.90143788662456, 266.65597796232856, 375.04828350899624, 84.71084731413214, 433.79668665969825, 410.33024717988354, 343.14782561081466, 503.2393123380876, 409.4218905523224, 21.11830997065861, 420.1303527041396, 383.44964669339606, 244.48621028254422, 266.0749898196559, 181.25130392237736, 205.80226650533822, 482.5563476595808, 337.4648673721436, 370.4632499382775, 549.0821996724646, 451.8117414323311, 386.31971217485045, 182.01232277143967, 401.16881157066246, 498.46996176843305, 395.6682654352085, 394.26373359277744, 338.9616798892486, 490.6337689484397, 155.7813717106256, 385.4342227691329, 358.88672182445026, 225.50979165968147, 335.8057123938427, 373.28932854279924, 404.8291197085488, 451.4876603025892, 502.0957118873741, 364.5947213257611, 355.1106078689001, 405.71370837180325, 443.374248271287, 235.6457371099856, 262.68490092364493, 7.167012648762582, 451.19907401563466, 368.2173774800282, 93.96268846650251, 140.63400746726722, 391.14891793319794, 400.5846851714178, 305.18781518428005, 440.0018262454752, 364.62155176945583, 542.7232659033006, 481.21597640847386, 413.84300385180893, 276.0670939597385, 251.17492844649314, 302.8588422629166, 157.28834071801543, 341.1145017234657, 317.5082686176336, 279.1943810502294, 349.035262536857, 392.67875785947905, 403.0900290094341, 440.74412570772057, 321.98325002155923, 462.8918818165721, 499.2659179546866, 346.2608210449144, 562.9561261544533, 359.47713585749096, 265.54755792131624, 486.94463864331857, 264.6550182388246, 453.6350261856135, 358.9224686202242, 207.47147604303834, 416.92824692310137, 451.2356572420274, 427.02159700017756, 198.28223811284838, 262.8829513837007, 214.76676891125626, 329.78666626973074, 387.58577933887983, 511.6669151294919, 493.27202535798904, 276.68217693967114, 6.3610229910092695, 495.97983249238246, 461.57856108530416, 365.10305645584054, 487.19290223244167, 497.11651042653733, 290.158324958332, 308.0883295808251, 277.603365545554, 460.2646266005294, 453.3801194081964, 169.9288552918743, 279.366863965909, 481.8829218320655, 403.5255229523489, 403.4044868484101, 319.6739828669366, 439.97731171929985, 337.22688516422727, 331.8960264851044, 570.2185855333889, 503.3377353406768, 529.7620962842996, 644.7860241045256, 473.9721357127375, 330.96607355716645, 196.1135659477781, 365.6092051857422, 412.7629194463199, 440.95770273831835, 518.8157134463095, 312.71101453758945, 258.8103270708426, 502.39687365595387, 302.6360473530179, 217.18191997809663, 265.72462411555165, 465.6737234003911, 472.23288236217826, 559.8371548882099, 278.3958408135175, 461.75152800154393, 316.7201827392572, 398.87322908788224]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.72412674064365, "mean_inference_ms": 70.73438169451953, "mean_action_processing_ms": 0.2534458903685784, "mean_env_wait_ms": 10.321403009916551, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004932522773742676, "StateBufferConnector_ms": 0.0034323930740356445, "ViewRequirementAgentConnector_ms": 0.11091160774230957}, "num_episodes": 18, "episode_return_max": 325.69976067223115, "episode_return_min": -98.41070675895112, "episode_return_mean": 79.0775882049082, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 624000, "num_agent_steps_trained": 624000, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1.2564169287701652, "num_env_steps_trained_throughput_per_sec": 1.2564169287701652, "timesteps_total": 156000, "num_env_steps_sampled_lifetime": 156000, "num_agent_steps_sampled_lifetime": 624000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 624000, "timers": {"training_iteration_time_ms": 2369429.411, "restore_workers_time_ms": 0.014, "training_step_time_ms": 2369429.342, "sample_time_ms": 2044.87, "learn_time_ms": 2367365.739, "learn_throughput": 1.69, "synch_weights_time_ms": 16.893}, "counters": {"num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 624000, "num_agent_steps_trained": 624000}, "done": false, "training_iteration": 39, "trial_id": "b941d_00000", "date": "2024-08-18_03-25-20", "timestamp": 1723931720, "time_this_iter_s": 3183.682692050934, "time_total_s": 70284.49795436859, "pid": 81115, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[32, [4, 4], 2], [64, [3, 3], 2], [128, [3, 3], 1]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [256, 256], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b03019d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 70284.49795436859, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 22.157142857142855, "ram_util_percent": 75.26507936507937}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 11.149234237620439, "cur_kl_coeff": 1.5187500000000005, "cur_lr": 0.00010000000000000003, "total_loss": 8.245943620974424, "policy_loss": -0.08935122878202015, "vf_loss": 8.311567535854522, "vf_explained_var": 0.41318240761756897, "kl": 0.015622927811333606, "entropy": 0.9843526951850406, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 74655.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.667330596434376, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.00010000000000000003, "total_loss": 9.184573788113065, "policy_loss": -0.08356329273991779, "vf_loss": 9.249917571254509, "vf_explained_var": 0.04229300075737888, "kl": 0.017994570800075684, "entropy": 0.7938435492376802, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 74655.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 640000, "num_agent_steps_trained": 640000}, "env_runners": {"episode_reward_max": 354.69498010046567, "episode_reward_min": -72.43034958074618, "episode_reward_mean": 80.12096199746564, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -669.5159637519515, "predator_policy": 6.3610229910092695}, "policy_reward_max": {"prey_policy": 186.14, "predator_policy": 644.7860241045256}, "policy_reward_mean": {"prey_policy": -327.9309116924231, "predator_policy": 367.9913926911558}, "custom_metrics": {}, "hist_stats": {"episode_reward": [34.025614657013655, 7.936362374311608, 66.81448426829002, 40.33947307284741, -51.724536436036644, 4.420198112556024, 9.34265885139396, 21.70333092991956, 0.0799999999999943, 237.0670346253498, 39.15360936826771, 50.4704950123126, 191.20398456782658, 1.2000000000000037, 130.46934951387317, 185.95968441819937, 72.21440565186055, 276.75151309130024, 130.83714260773715, 74.31863235516585, 4.820370132808581, 202.1626474735667, 4.109999999999996, 237.87736412278662, 2.1528959577213804, 39.01450030315864, 74.86312233504046, 16.558053218092905, 3.4215570096677226, -36.12510683175486, 136.9723602903868, 52.99012962536881, 201.75701264876224, -64.45609963234222, 325.69976067223115, 124.42531039766715, 203.35838690237406, 140.29335243645593, 43.7573391539796, 206.4483603531908, 29.82273052238445, 90.2085051618098, 38.46520427714118, 8.135855438129118, 61.31794015824085, -7.2065503225546665, 65.57971250579752, 255.27724145952095, 35.29532806001264, 16.32382786866332, 9.094381903670726, 43.16573599111818, 26.332283885232886, 255.22331773721913, 0.2200000000000022, 13.279999999999996, 137.62180864277622, 174.19367363254253, -3.7657822616006182, 126.98344943960534, 32.44, 195.2901158804532, 34.62531974858965, 8.534681342362889, 91.04973956240666, -29.68231799869139, 0.10000000000000231, 2.3111404524550823, 111.46563954831626, 33.71639834218564, 30.137211792024015, 313.8995338654949, -0.7453562503633302, 115.28027360106327, 49.50231008981004, 10.053233939988568, 273.56603495026445, 25.767214594213137, 45.34999999999999, 246.52480102521176, 82.29685382168023, 0.33999999999999897, 116.88615106582361, 12.470224870317384, 288.5435846724764, -50.01227007680332, -72.43034958074618, 130.62388600574948, 354.69498010046567, 193.14015529992255, 14.99776262898386, 22.661294112639766, 98.44114983228967, 27.06186177770125, 6.72185181556856, 11.27, 168.45150797093785, -11.721468816093392, 2.0600000000000023, 208.15963204880418], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-536.6536349306344, -282.4763902772528, -472.13255017444106, -348.7753930307449, -366.7843020350941, -411.7602363215816, -246.66881343461372, -410.4727975842864, -611.1970540337041, -369.0712796559767, -493.11340514264924, -451.4895079866546, -383.5737496907519, -348.8188428224011, -440.36461830969745, -452.72494296848566, -427.82988656998043, -551.1876724358979, -471.4219102259707, 57.44, -413.9014331775504, -196.6765475209756, -193.98252393197777, -397.25124252703483, 105.39313725369452, -432.69668665969834, -409.3002471798836, -342.9778256108148, -612.230368484897, -169.96148489164108, 168.6664352978927, -423.95541355449166, -379.3168432705935, -176.40460805348658, 129.34941271463222, -299.92419336536534, -226.07494100521416, -331.4465305519682, -210.93151527689145, -422.6779696783641, -538.883504488577, -457.19006648340996, -412.57168300216034, 46.40229552943707, -401.1088115706625, -494.41996176843304, -52.08014322363231, -499.9744916815664, -398.24884343532517, -429.1937094446426, -207.3514676113883, -294.84962656521304, -365.95502596094434, -143.57836518814835, -283.039486530033, -409.4975011885166, -403.64056548839466, -449.25465751307564, -459.5140475187106, -443.3014925261794, -280.62886548131047, -343.2230904690076, -125.81354190694033, -500.21631384896375, -250.2749009236453, 182.18, -469.7240931896886, -414.14845793831626, 138.85163562122025, -47.748570882759026, -90.44896406570216, -576.8593286412462, -89.26700284966802, -452.56425167771323, -523.0990467970552, -243.95241843924572, -431.6261658498274, -419.6754752564761, -223.24123631825182, -97.55242573478898, -299.62706896099706, -130.69738349755147, -396.2467114603744, -172.16755371891537, -288.37781064612085, -301.3866286638249, -380.0771635229216, -407.5557679078624, -457.98712347451743, -243.4223120965217, -446.96723942922307, -522.3971106645901, -281.6244519397045, -562.0127827538657, -34.564556783800356, -335.1828955354859, -415.497824795023, -300.8065040271086, -402.61463251130135, -393.6190344258732, -201.69583791550988, -413.6095031469591, -486.3749598238513, -348.71655842723555, -317.00923184958765, -117.82367376172786, 66.34808159701373, -355.6781990407817, -387.36577933887986, -511.6669151294919, -493.25202535798906, -263.4221769396712, 34.05821798447617, -398.7772648250915, -323.3309527771761, -329.15699113142625, -490.9586844940423, -497.11651042653733, -62.40195892146146, -408.86124617809077, -245.17336554555385, -460.2546266005294, -531.4821803201808, 103.46332150056334, -258.4780715633998, -468.1463944859851, -395.0411531156648, -403.3541753427317, -224.1995610350516, -444.40199398877866, -441.4494509535151, -257.35577869450793, -570.118585533389, -503.3377353406768, -502.7210161844185, -669.5159637519515, -315.88688449643865, -377.58568522514935, -145.35194670115823, -382.6544260901767, -398.62570765429615, -424.95770273831835, -616.2309618027713, 98.60376768436672, -260.5656833212063, -501.3868736559539, -7.643672869183517, -396.8940208608683, -216.30033705528467, -465.59570037084814, -457.47994075479755, -564.5368625556019, -451.3371331704954, -15.244200694301412, -487.7615558379232, -202.0646413950025, -560.2382666650635, -204.5696588491338, 186.14, -467.5232834220628, -215.94277163586594, -240.81814545536562, -380.7853973658797, -525.1415177327992, -488.0449465345585, -261.37087691753123, -286.68125612892754, -539.1837068270072, 43.198561841051074, -478.7390209757176, -457.0238618098078, -365.89329468850497, -531.1470302222347, -457.93772412684353, -230.33305649873907, -297.27762700727925, -390.1578844593108, 69.07868250069886, -343.5005793958964, -7.959098547138822, -388.70952841710954, -345.7830134087054, -264.9763955204431, -507.25589624959787, -181.8150395997617, -378.2744449913857, -322.0271070243396, -552.5390274982092, -60.18959786641952, -77.40804009308417, -393.9569793194405, -383.11481302172484, -24.292608057892735, -302.1998293497773, -604.3539582924105, -318.9452243037911, -502.06291313339796, -624.5830764447965, 94.33860943822596, -463.8080197514534], "policy_predator_policy_reward": [524.129193511392, 329.0264463535085, 377.679780424175, 451.164525155322, 355.86248227627, 489.4965403486953, 373.41898561376945, 324.06209847797726, 388.09172883137643, 540.452068422267, 492.37919469566276, 456.643916546197, 291.8763594559222, 449.8588919086241, 528.2668261429686, 386.5260660651344, 427.89988656998037, 551.1976724358979, 308.5138280225301, 342.53511682879014, 400.83015218016897, 248.90143788662456, 266.65597796232856, 375.04828350899624, 84.71084731413214, 433.79668665969825, 410.33024717988354, 343.14782561081466, 503.2393123380876, 409.4218905523224, 21.11830997065861, 420.1303527041396, 383.44964669339606, 244.48621028254422, 266.0749898196559, 181.25130392237736, 205.80226650533822, 482.5563476595808, 337.4648673721436, 370.4632499382775, 549.0821996724646, 451.8117414323311, 386.31971217485045, 182.01232277143967, 401.16881157066246, 498.46996176843305, 395.6682654352085, 394.26373359277744, 338.9616798892486, 490.6337689484397, 155.7813717106256, 385.4342227691329, 358.88672182445026, 225.50979165968147, 335.8057123938427, 373.28932854279924, 404.8291197085488, 451.4876603025892, 502.0957118873741, 364.5947213257611, 355.1106078689001, 405.71370837180325, 443.374248271287, 235.6457371099856, 262.68490092364493, 7.167012648762582, 451.19907401563466, 368.2173774800282, 93.96268846650251, 140.63400746726722, 391.14891793319794, 400.5846851714178, 305.18781518428005, 440.0018262454752, 364.62155176945583, 542.7232659033006, 481.21597640847386, 413.84300385180893, 276.0670939597385, 251.17492844649314, 302.8588422629166, 157.28834071801543, 341.1145017234657, 317.5082686176336, 279.1943810502294, 349.035262536857, 392.67875785947905, 403.0900290094341, 440.74412570772057, 321.98325002155923, 462.8918818165721, 499.2659179546866, 346.2608210449144, 562.9561261544533, 359.47713585749096, 265.54755792131624, 486.94463864331857, 264.6550182388246, 453.6350261856135, 358.9224686202242, 207.47147604303834, 416.92824692310137, 451.2356572420274, 427.02159700017756, 198.28223811284838, 262.8829513837007, 214.76676891125626, 329.78666626973074, 387.58577933887983, 511.6669151294919, 493.27202535798904, 276.68217693967114, 6.3610229910092695, 495.97983249238246, 461.57856108530416, 365.10305645584054, 487.19290223244167, 497.11651042653733, 290.158324958332, 308.0883295808251, 277.603365545554, 460.2646266005294, 453.3801194081964, 169.9288552918743, 279.366863965909, 481.8829218320655, 403.5255229523489, 403.4044868484101, 319.6739828669366, 439.97731171929985, 337.22688516422727, 331.8960264851044, 570.2185855333889, 503.3377353406768, 529.7620962842996, 644.7860241045256, 473.9721357127375, 330.96607355716645, 196.1135659477781, 365.6092051857422, 412.7629194463199, 440.95770273831835, 518.8157134463095, 312.71101453758945, 258.8103270708426, 502.39687365595387, 302.6360473530179, 217.18191997809663, 265.72462411555165, 465.6737234003911, 472.23288236217826, 559.8371548882099, 278.3958408135175, 461.75152800154393, 316.7201827392572, 398.87322908788224, 560.2382666650635, 249.919658849134, 78.07548438285475, 449.8326000644199, 197.36180932190064, 341.69596159101, 381.1253973658794, 525.1415177327992, 529.9088129555719, 336.39316156234116, 357.4076246376489, 480.9275631886031, 332.8085978078732, 391.27544599926944, 465.4773120752703, 307.4275743462388, 542.6149000473399, 374.0395047209921, 299.87856279391116, 358.3560067178559, 339.09518570014535, 336.6789963589322, 249.74405674896641, 294.85577649399096, 417.86227157108107, 331.6280328837174, 287.6376896330824, 507.25589624959787, 365.5556926775674, 292.9749417458693, 387.0713833493538, 514.5566129508961, 77.0127668559642, 67.30672291910861, 404.97697931944055, 383.36481302172484, 206.32448570546586, 288.6194596731421, 316.5958175735485, 594.9818962065597, 504.1229131333979, 624.5830764447965, 271.92186382958084, 305.70717853245037]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.850446883944649, "mean_inference_ms": 68.18635154263995, "mean_action_processing_ms": 0.25319510367045345, "mean_env_wait_ms": 10.92539196240934, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004999637603759766, "StateBufferConnector_ms": 0.0034363269805908203, "ViewRequirementAgentConnector_ms": 0.10708057880401611}, "num_episodes": 22, "episode_return_max": 354.69498010046567, "episode_return_min": -72.43034958074618, "episode_return_mean": 80.12096199746564, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 640000, "num_agent_steps_trained": 640000, "num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1.609789905000188, "num_env_steps_trained_throughput_per_sec": 1.609789905000188, "timesteps_total": 160000, "num_env_steps_sampled_lifetime": 160000, "num_agent_steps_sampled_lifetime": 640000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 640000, "timers": {"training_iteration_time_ms": 2200360.991, "restore_workers_time_ms": 0.014, "training_step_time_ms": 2200360.946, "sample_time_ms": 2046.494, "learn_time_ms": 2198296.909, "learn_throughput": 1.82, "synch_weights_time_ms": 15.897}, "counters": {"num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 640000, "num_agent_steps_trained": 640000}, "done": false, "training_iteration": 40, "trial_id": "b941d_00000", "date": "2024-08-18_04-06-45", "timestamp": 1723934205, "time_this_iter_s": 2484.8415150642395, "time_total_s": 72769.33946943283, "pid": 81115, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[32, [4, 4], 2], [64, [3, 3], 2], [128, [3, 3], 1]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [256, 256], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2966550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 72769.33946943283, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 22.38978494623656, "ram_util_percent": 74.88817204301075}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.360404241148126, "cur_kl_coeff": 1.5187500000000005, "cur_lr": 0.00010000000000000003, "total_loss": 8.535711428475759, "policy_loss": -0.0910765227573436, "vf_loss": 8.60234384107842, "vf_explained_var": 0.32366693527610213, "kl": 0.016094868379699815, "entropy": 1.0065156762246732, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 76545.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.360921856335231, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.00010000000000000003, "total_loss": 9.227000124996932, "policy_loss": -0.0769077771259521, "vf_loss": 9.28647756727915, "vf_explained_var": 0.0404162604972799, "kl": 0.01721514513488908, "entropy": 0.7471721277035103, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 76545.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_agent_steps_sampled": 656000, "num_agent_steps_trained": 656000}, "env_runners": {"episode_reward_max": 354.69498010046567, "episode_reward_min": -72.43034958074618, "episode_reward_mean": 81.70117195933508, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -669.5159637519515, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 186.14, "predator_policy": 644.7860241045256}, "policy_reward_mean": {"prey_policy": -325.0184341156417, "predator_policy": 365.86902009530917}, "custom_metrics": {}, "hist_stats": {"episode_reward": [237.87736412278662, 2.1528959577213804, 39.01450030315864, 74.86312233504046, 16.558053218092905, 3.4215570096677226, -36.12510683175486, 136.9723602903868, 52.99012962536881, 201.75701264876224, -64.45609963234222, 325.69976067223115, 124.42531039766715, 203.35838690237406, 140.29335243645593, 43.7573391539796, 206.4483603531908, 29.82273052238445, 90.2085051618098, 38.46520427714118, 8.135855438129118, 61.31794015824085, -7.2065503225546665, 65.57971250579752, 255.27724145952095, 35.29532806001264, 16.32382786866332, 9.094381903670726, 43.16573599111818, 26.332283885232886, 255.22331773721913, 0.2200000000000022, 13.279999999999996, 137.62180864277622, 174.19367363254253, -3.7657822616006182, 126.98344943960534, 32.44, 195.2901158804532, 34.62531974858965, 8.534681342362889, 91.04973956240666, -29.68231799869139, 0.10000000000000231, 2.3111404524550823, 111.46563954831626, 33.71639834218564, 30.137211792024015, 313.8995338654949, -0.7453562503633302, 115.28027360106327, 49.50231008981004, 10.053233939988568, 273.56603495026445, 25.767214594213137, 45.34999999999999, 246.52480102521176, 82.29685382168023, 0.33999999999999897, 116.88615106582361, 12.470224870317384, 288.5435846724764, -50.01227007680332, -72.43034958074618, 130.62388600574948, 354.69498010046567, 193.14015529992255, 14.99776262898386, 22.661294112639766, 98.44114983228967, 27.06186177770125, 6.72185181556856, 11.27, 168.45150797093785, -11.721468816093392, 2.0600000000000023, 208.15963204880418, 279.26640886885724, 133.65582157993225, 123.58000000000006, -6.470179303647528, 187.9447454183576, 2.8897849947524072, 2.079999999999986, 0.1398654139461064, 95.65192512346455, 200.04304438796163, 74.0891234576127, 336.79238648413406, 12.121401560661923, 4.279999999999992, 119.44373620519008, 107.5625798167365, 13.454711062918266, 15.492890719342851, -3.2369632939395014, 179.13176976292777, 6.297369098773784, 46.54703752630074, -39.060008048773625], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-52.08014322363231, -499.9744916815664, -398.24884343532517, -429.1937094446426, -207.3514676113883, -294.84962656521304, -365.95502596094434, -143.57836518814835, -283.039486530033, -409.4975011885166, -403.64056548839466, -449.25465751307564, -459.5140475187106, -443.3014925261794, -280.62886548131047, -343.2230904690076, -125.81354190694033, -500.21631384896375, -250.2749009236453, 182.18, -469.7240931896886, -414.14845793831626, 138.85163562122025, -47.748570882759026, -90.44896406570216, -576.8593286412462, -89.26700284966802, -452.56425167771323, -523.0990467970552, -243.95241843924572, -431.6261658498274, -419.6754752564761, -223.24123631825182, -97.55242573478898, -299.62706896099706, -130.69738349755147, -396.2467114603744, -172.16755371891537, -288.37781064612085, -301.3866286638249, -380.0771635229216, -407.5557679078624, -457.98712347451743, -243.4223120965217, -446.96723942922307, -522.3971106645901, -281.6244519397045, -562.0127827538657, -34.564556783800356, -335.1828955354859, -415.497824795023, -300.8065040271086, -402.61463251130135, -393.6190344258732, -201.69583791550988, -413.6095031469591, -486.3749598238513, -348.71655842723555, -317.00923184958765, -117.82367376172786, 66.34808159701373, -355.6781990407817, -387.36577933887986, -511.6669151294919, -493.25202535798906, -263.4221769396712, 34.05821798447617, -398.7772648250915, -323.3309527771761, -329.15699113142625, -490.9586844940423, -497.11651042653733, -62.40195892146146, -408.86124617809077, -245.17336554555385, -460.2546266005294, -531.4821803201808, 103.46332150056334, -258.4780715633998, -468.1463944859851, -395.0411531156648, -403.3541753427317, -224.1995610350516, -444.40199398877866, -441.4494509535151, -257.35577869450793, -570.118585533389, -503.3377353406768, -502.7210161844185, -669.5159637519515, -315.88688449643865, -377.58568522514935, -145.35194670115823, -382.6544260901767, -398.62570765429615, -424.95770273831835, -616.2309618027713, 98.60376768436672, -260.5656833212063, -501.3868736559539, -7.643672869183517, -396.8940208608683, -216.30033705528467, -465.59570037084814, -457.47994075479755, -564.5368625556019, -451.3371331704954, -15.244200694301412, -487.7615558379232, -202.0646413950025, -560.2382666650635, -204.5696588491338, 186.14, -467.5232834220628, -215.94277163586594, -240.81814545536562, -380.7853973658797, -525.1415177327992, -488.0449465345585, -261.37087691753123, -286.68125612892754, -539.1837068270072, 43.198561841051074, -478.7390209757176, -457.0238618098078, -365.89329468850497, -531.1470302222347, -457.93772412684353, -230.33305649873907, -297.27762700727925, -390.1578844593108, 69.07868250069886, -343.5005793958964, -7.959098547138822, -388.70952841710954, -345.7830134087054, -264.9763955204431, -507.25589624959787, -181.8150395997617, -378.2744449913857, -322.0271070243396, -552.5390274982092, -60.18959786641952, -77.40804009308417, -393.9569793194405, -383.11481302172484, -24.292608057892735, -302.1998293497773, -604.3539582924105, -318.9452243037911, -502.06291313339796, -624.5830764447965, 94.33860943822596, -463.8080197514534, 23.71345349714821, -319.24556626941705, -138.56105399662948, -402.6997003438871, -303.0559696769535, 1.434997479199339, -370.7158939727097, -340.5551205461942, 89.34818124324414, -428.6938100199586, -502.2595244733443, -442.43558312336995, -506.801012028525, 2.0000000000000013, -471.83024184320226, -480.00121695863106, -425.08405674500926, -135.1406502037502, 114.15838156314622, -493.5261148364111, -311.6971433861225, -432.5985678768809, 117.61695162382965, -386.68956623857605, -495.23802625148124, -384.08685822826993, -451.5349525060144, -367.68779690747755, -324.47723167019535, -55.25047153546558, -401.4960967250764, -183.25981263623066, -487.302610387444, -337.442189313407, -336.9026175854849, -544.063500751611, -317.7636246779696, -338.8852952164003, -470.17659171351676, -33.91813914060627, -474.9248658009626, -506.86992972136414, -493.4986042913679, -409.55275620625105, -554.1007807756043, -418.90301435776456], "policy_predator_policy_reward": [395.6682654352085, 394.26373359277744, 338.9616798892486, 490.6337689484397, 155.7813717106256, 385.4342227691329, 358.88672182445026, 225.50979165968147, 335.8057123938427, 373.28932854279924, 404.8291197085488, 451.4876603025892, 502.0957118873741, 364.5947213257611, 355.1106078689001, 405.71370837180325, 443.374248271287, 235.6457371099856, 262.68490092364493, 7.167012648762582, 451.19907401563466, 368.2173774800282, 93.96268846650251, 140.63400746726722, 391.14891793319794, 400.5846851714178, 305.18781518428005, 440.0018262454752, 364.62155176945583, 542.7232659033006, 481.21597640847386, 413.84300385180893, 276.0670939597385, 251.17492844649314, 302.8588422629166, 157.28834071801543, 341.1145017234657, 317.5082686176336, 279.1943810502294, 349.035262536857, 392.67875785947905, 403.0900290094341, 440.74412570772057, 321.98325002155923, 462.8918818165721, 499.2659179546866, 346.2608210449144, 562.9561261544533, 359.47713585749096, 265.54755792131624, 486.94463864331857, 264.6550182388246, 453.6350261856135, 358.9224686202242, 207.47147604303834, 416.92824692310137, 451.2356572420274, 427.02159700017756, 198.28223811284838, 262.8829513837007, 214.76676891125626, 329.78666626973074, 387.58577933887983, 511.6669151294919, 493.27202535798904, 276.68217693967114, 6.3610229910092695, 495.97983249238246, 461.57856108530416, 365.10305645584054, 487.19290223244167, 497.11651042653733, 290.158324958332, 308.0883295808251, 277.603365545554, 460.2646266005294, 453.3801194081964, 169.9288552918743, 279.366863965909, 481.8829218320655, 403.5255229523489, 403.4044868484101, 319.6739828669366, 439.97731171929985, 337.22688516422727, 331.8960264851044, 570.2185855333889, 503.3377353406768, 529.7620962842996, 644.7860241045256, 473.9721357127375, 330.96607355716645, 196.1135659477781, 365.6092051857422, 412.7629194463199, 440.95770273831835, 518.8157134463095, 312.71101453758945, 258.8103270708426, 502.39687365595387, 302.6360473530179, 217.18191997809663, 265.72462411555165, 465.6737234003911, 472.23288236217826, 559.8371548882099, 278.3958408135175, 461.75152800154393, 316.7201827392572, 398.87322908788224, 560.2382666650635, 249.919658849134, 78.07548438285475, 449.8326000644199, 197.36180932190064, 341.69596159101, 381.1253973658794, 525.1415177327992, 529.9088129555719, 336.39316156234116, 357.4076246376489, 480.9275631886031, 332.8085978078732, 391.27544599926944, 465.4773120752703, 307.4275743462388, 542.6149000473399, 374.0395047209921, 299.87856279391116, 358.3560067178559, 339.09518570014535, 336.6789963589322, 249.74405674896641, 294.85577649399096, 417.86227157108107, 331.6280328837174, 287.6376896330824, 507.25589624959787, 365.5556926775674, 292.9749417458693, 387.0713833493538, 514.5566129508961, 77.0127668559642, 67.30672291910861, 404.97697931944055, 383.36481302172484, 206.32448570546586, 288.6194596731421, 316.5958175735485, 594.9818962065597, 504.1229131333979, 624.5830764447965, 271.92186382958084, 305.70717853245037, 339.5795827867981, 235.21893885432786, 264.7809929420699, 410.1355829783787, 271.45648444056457, 153.74448775718932, 371.9406704544122, 332.86016476084376, 139.00454544472063, 388.2858287503511, 502.2795244733443, 445.30536811812226, 506.881012028525, 0.0, 471.94010725714827, 480.03121695863103, 370.0406586047872, 285.8359734674366, 219.92813854797564, 359.48263911325097, 330.26537439535406, 488.11946032526197, 279.1529213850988, 326.7120797137811, 411.7474807067435, 479.69880533366904, 453.61495250601433, 369.88779690747737, 119.81018009195266, 379.3612593188981, 330.6134582355677, 361.7050309424756, 494.0502894719775, 344.1492212917915, 358.9051449048253, 537.5538641516131, 318.83595219237384, 334.57600440805606, 415.1739101842448, 268.05259043280626, 499.0882235619724, 489.00394105912795, 462.92967009585107, 486.66872792806896, 545.2907098998253, 388.6530771847701]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.650049728022157, "mean_inference_ms": 66.63225261716583, "mean_action_processing_ms": 0.2527715517885165, "mean_env_wait_ms": 9.755974812050304, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00500798225402832, "StateBufferConnector_ms": 0.0034487247467041016, "ViewRequirementAgentConnector_ms": 0.10738885402679443}, "num_episodes": 23, "episode_return_max": 354.69498010046567, "episode_return_min": -72.43034958074618, "episode_return_mean": 81.70117195933508, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 656000, "num_agent_steps_trained": 656000, "num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1.0763443757225226, "num_env_steps_trained_throughput_per_sec": 1.0763443757225226, "timesteps_total": 164000, "num_env_steps_sampled_lifetime": 164000, "num_agent_steps_sampled_lifetime": 656000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 656000, "timers": {"training_iteration_time_ms": 2016661.35, "restore_workers_time_ms": 0.012, "training_step_time_ms": 2016661.309, "sample_time_ms": 2013.942, "learn_time_ms": 2014631.658, "learn_throughput": 1.985, "synch_weights_time_ms": 14.134}, "counters": {"num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_agent_steps_sampled": 656000, "num_agent_steps_trained": 656000}, "done": false, "training_iteration": 41, "trial_id": "b941d_00000", "date": "2024-08-18_05-08-41", "timestamp": 1723937921, "time_this_iter_s": 3716.3235771656036, "time_total_s": 76485.66304659843, "pid": 81115, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[32, [4, 4], 2], [64, [3, 3], 2], [128, [3, 3], 1]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [256, 256], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b0403940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 76485.66304659843, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 23.197340425531912, "ram_util_percent": 76.34521276595746}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.904394636456928, "cur_kl_coeff": 1.5187500000000005, "cur_lr": 0.00010000000000000003, "total_loss": 8.36622222542132, "policy_loss": -0.08462422743350977, "vf_loss": 8.427894003681406, "vf_explained_var": 0.23963010881943678, "kl": 0.015112704097000544, "entropy": 1.011775378291569, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 78435.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.438941343310018, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.00010000000000000003, "total_loss": 9.161107507332293, "policy_loss": -0.07683090372146575, "vf_loss": 9.220200803544786, "vf_explained_var": 0.007451898301089252, "kl": 0.017518648411203794, "entropy": 0.7377306104337097, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 78435.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 672000, "num_agent_steps_trained": 672000}, "env_runners": {"episode_reward_max": 387.25843467625174, "episode_reward_min": -72.43034958074618, "episode_reward_mean": 78.83309083970555, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -669.5159637519515, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 186.14, "predator_policy": 652.0326638571769}, "policy_reward_mean": {"prey_policy": -334.56364160403217, "predator_policy": 373.98018702388487}, "custom_metrics": {}, "hist_stats": {"episode_reward": [90.2085051618098, 38.46520427714118, 8.135855438129118, 61.31794015824085, -7.2065503225546665, 65.57971250579752, 255.27724145952095, 35.29532806001264, 16.32382786866332, 9.094381903670726, 43.16573599111818, 26.332283885232886, 255.22331773721913, 0.2200000000000022, 13.279999999999996, 137.62180864277622, 174.19367363254253, -3.7657822616006182, 126.98344943960534, 32.44, 195.2901158804532, 34.62531974858965, 8.534681342362889, 91.04973956240666, -29.68231799869139, 0.10000000000000231, 2.3111404524550823, 111.46563954831626, 33.71639834218564, 30.137211792024015, 313.8995338654949, -0.7453562503633302, 115.28027360106327, 49.50231008981004, 10.053233939988568, 273.56603495026445, 25.767214594213137, 45.34999999999999, 246.52480102521176, 82.29685382168023, 0.33999999999999897, 116.88615106582361, 12.470224870317384, 288.5435846724764, -50.01227007680332, -72.43034958074618, 130.62388600574948, 354.69498010046567, 193.14015529992255, 14.99776262898386, 22.661294112639766, 98.44114983228967, 27.06186177770125, 6.72185181556856, 11.27, 168.45150797093785, -11.721468816093392, 2.0600000000000023, 208.15963204880418, 279.26640886885724, 133.65582157993225, 123.58000000000006, -6.470179303647528, 187.9447454183576, 2.8897849947524072, 2.079999999999986, 0.1398654139461064, 95.65192512346455, 200.04304438796163, 74.0891234576127, 336.79238648413406, 12.121401560661923, 4.279999999999992, 119.44373620519008, 107.5625798167365, 13.454711062918266, 15.492890719342851, -3.2369632939395014, 179.13176976292777, 6.297369098773784, 46.54703752630074, -39.060008048773625, -3.5249841906046937, 0.0699999999999994, 5.5, 11.479999999999997, 0.4051356769728016, 139.2416487641219, 123.86543226430426, 387.25843467625174, 175.47896312320768, 0.4084760914427379, 266.25, 187.0041851327257, -2.0491439186775082, 54.95972791394944, 2.209999999999998, 26.096553291930533, 77.37248193791055, -0.003993241317717056], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-396.2467114603744, -172.16755371891537, -288.37781064612085, -301.3866286638249, -380.0771635229216, -407.5557679078624, -457.98712347451743, -243.4223120965217, -446.96723942922307, -522.3971106645901, -281.6244519397045, -562.0127827538657, -34.564556783800356, -335.1828955354859, -415.497824795023, -300.8065040271086, -402.61463251130135, -393.6190344258732, -201.69583791550988, -413.6095031469591, -486.3749598238513, -348.71655842723555, -317.00923184958765, -117.82367376172786, 66.34808159701373, -355.6781990407817, -387.36577933887986, -511.6669151294919, -493.25202535798906, -263.4221769396712, 34.05821798447617, -398.7772648250915, -323.3309527771761, -329.15699113142625, -490.9586844940423, -497.11651042653733, -62.40195892146146, -408.86124617809077, -245.17336554555385, -460.2546266005294, -531.4821803201808, 103.46332150056334, -258.4780715633998, -468.1463944859851, -395.0411531156648, -403.3541753427317, -224.1995610350516, -444.40199398877866, -441.4494509535151, -257.35577869450793, -570.118585533389, -503.3377353406768, -502.7210161844185, -669.5159637519515, -315.88688449643865, -377.58568522514935, -145.35194670115823, -382.6544260901767, -398.62570765429615, -424.95770273831835, -616.2309618027713, 98.60376768436672, -260.5656833212063, -501.3868736559539, -7.643672869183517, -396.8940208608683, -216.30033705528467, -465.59570037084814, -457.47994075479755, -564.5368625556019, -451.3371331704954, -15.244200694301412, -487.7615558379232, -202.0646413950025, -560.2382666650635, -204.5696588491338, 186.14, -467.5232834220628, -215.94277163586594, -240.81814545536562, -380.7853973658797, -525.1415177327992, -488.0449465345585, -261.37087691753123, -286.68125612892754, -539.1837068270072, 43.198561841051074, -478.7390209757176, -457.0238618098078, -365.89329468850497, -531.1470302222347, -457.93772412684353, -230.33305649873907, -297.27762700727925, -390.1578844593108, 69.07868250069886, -343.5005793958964, -7.959098547138822, -388.70952841710954, -345.7830134087054, -264.9763955204431, -507.25589624959787, -181.8150395997617, -378.2744449913857, -322.0271070243396, -552.5390274982092, -60.18959786641952, -77.40804009308417, -393.9569793194405, -383.11481302172484, -24.292608057892735, -302.1998293497773, -604.3539582924105, -318.9452243037911, -502.06291313339796, -624.5830764447965, 94.33860943822596, -463.8080197514534, 23.71345349714821, -319.24556626941705, -138.56105399662948, -402.6997003438871, -303.0559696769535, 1.434997479199339, -370.7158939727097, -340.5551205461942, 89.34818124324414, -428.6938100199586, -502.2595244733443, -442.43558312336995, -506.801012028525, 2.0000000000000013, -471.83024184320226, -480.00121695863106, -425.08405674500926, -135.1406502037502, 114.15838156314622, -493.5261148364111, -311.6971433861225, -432.5985678768809, 117.61695162382965, -386.68956623857605, -495.23802625148124, -384.08685822826993, -451.5349525060144, -367.68779690747755, -324.47723167019535, -55.25047153546558, -401.4960967250764, -183.25981263623066, -487.302610387444, -337.442189313407, -336.9026175854849, -544.063500751611, -317.7636246779696, -338.8852952164003, -470.17659171351676, -33.91813914060627, -474.9248658009626, -506.86992972136414, -493.4986042913679, -409.55275620625105, -554.1007807756043, -418.90301435776456, -353.6576986605648, -363.6490552107423, -652.0326638571769, -464.11143043541216, -323.69386164565503, -467.34775806770585, -397.0758277156346, -445.1693984952999, -499.7622467665652, -357.272306278104, 2.0000000000000013, -575.579780399799, -477.2254020784859, 2.0000000000000013, -509.4508751252517, 32.39407917911363, 0.9031270371965286, -473.58970504571136, -451.82058620087963, -339.4494065721137, 50.85188127539837, 1.5550765561648205, -71.32572749012009, -328.4232298462968, -392.6655412863416, -529.8350341935951, -459.82133090507443, -201.25377950614293, -422.12090411427977, -514.810993832599, -386.31014727896303, -459.21836405588886, -337.54639995307025, -332.3098073895924, -421.2534282733323, -519.7993620292733], "policy_predator_policy_reward": [341.1145017234657, 317.5082686176336, 279.1943810502294, 349.035262536857, 392.67875785947905, 403.0900290094341, 440.74412570772057, 321.98325002155923, 462.8918818165721, 499.2659179546866, 346.2608210449144, 562.9561261544533, 359.47713585749096, 265.54755792131624, 486.94463864331857, 264.6550182388246, 453.6350261856135, 358.9224686202242, 207.47147604303834, 416.92824692310137, 451.2356572420274, 427.02159700017756, 198.28223811284838, 262.8829513837007, 214.76676891125626, 329.78666626973074, 387.58577933887983, 511.6669151294919, 493.27202535798904, 276.68217693967114, 6.3610229910092695, 495.97983249238246, 461.57856108530416, 365.10305645584054, 487.19290223244167, 497.11651042653733, 290.158324958332, 308.0883295808251, 277.603365545554, 460.2646266005294, 453.3801194081964, 169.9288552918743, 279.366863965909, 481.8829218320655, 403.5255229523489, 403.4044868484101, 319.6739828669366, 439.97731171929985, 337.22688516422727, 331.8960264851044, 570.2185855333889, 503.3377353406768, 529.7620962842996, 644.7860241045256, 473.9721357127375, 330.96607355716645, 196.1135659477781, 365.6092051857422, 412.7629194463199, 440.95770273831835, 518.8157134463095, 312.71101453758945, 258.8103270708426, 502.39687365595387, 302.6360473530179, 217.18191997809663, 265.72462411555165, 465.6737234003911, 472.23288236217826, 559.8371548882099, 278.3958408135175, 461.75152800154393, 316.7201827392572, 398.87322908788224, 560.2382666650635, 249.919658849134, 78.07548438285475, 449.8326000644199, 197.36180932190064, 341.69596159101, 381.1253973658794, 525.1415177327992, 529.9088129555719, 336.39316156234116, 357.4076246376489, 480.9275631886031, 332.8085978078732, 391.27544599926944, 465.4773120752703, 307.4275743462388, 542.6149000473399, 374.0395047209921, 299.87856279391116, 358.3560067178559, 339.09518570014535, 336.6789963589322, 249.74405674896641, 294.85577649399096, 417.86227157108107, 331.6280328837174, 287.6376896330824, 507.25589624959787, 365.5556926775674, 292.9749417458693, 387.0713833493538, 514.5566129508961, 77.0127668559642, 67.30672291910861, 404.97697931944055, 383.36481302172484, 206.32448570546586, 288.6194596731421, 316.5958175735485, 594.9818962065597, 504.1229131333979, 624.5830764447965, 271.92186382958084, 305.70717853245037, 339.5795827867981, 235.21893885432786, 264.7809929420699, 410.1355829783787, 271.45648444056457, 153.74448775718932, 371.9406704544122, 332.86016476084376, 139.00454544472063, 388.2858287503511, 502.2795244733443, 445.30536811812226, 506.881012028525, 0.0, 471.94010725714827, 480.03121695863103, 370.0406586047872, 285.8359734674366, 219.92813854797564, 359.48263911325097, 330.26537439535406, 488.11946032526197, 279.1529213850988, 326.7120797137811, 411.7474807067435, 479.69880533366904, 453.61495250601433, 369.88779690747737, 119.81018009195266, 379.3612593188981, 330.6134582355677, 361.7050309424756, 494.0502894719775, 344.1492212917915, 358.9051449048253, 537.5538641516131, 318.83595219237384, 334.57600440805606, 415.1739101842448, 268.05259043280626, 499.0882235619724, 489.00394105912795, 462.92967009585107, 486.66872792806896, 545.2907098998253, 388.6530771847701, 468.36500158217615, 245.4167680985254, 652.0326638571769, 464.1814304354121, 329.18386164565493, 467.35775806770584, 408.31582771563455, 445.4093984952997, 499.563278070246, 357.876410651396, 287.2370796718368, 425.58434949208385, 441.5620547850934, 157.52877955769677, 412.59072879782155, 451.72450182456816, 321.9282109101098, 326.23733022161343, 451.8305862008796, 339.84788266355605, 102.14811872460163, 111.69492344383526, 217.42008927449422, 369.3330531946491, 438.41661531579797, 482.0348162454612, 436.46921373475294, 279.5656245904133, 422.2809041142796, 516.8609938325991, 386.47200752711603, 485.1530570996663, 531.9302923795468, 215.2983969010252, 421.44342827333224, 519.6053687879556]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.17450005984339, "mean_inference_ms": 65.49502066328188, "mean_action_processing_ms": 0.2524837502041567, "mean_env_wait_ms": 9.53801962819702, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0050972700119018555, "StateBufferConnector_ms": 0.0034450292587280273, "ViewRequirementAgentConnector_ms": 0.1077573299407959}, "num_episodes": 18, "episode_return_max": 387.25843467625174, "episode_return_min": -72.43034958074618, "episode_return_mean": 78.83309083970555, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 672000, "num_agent_steps_trained": 672000, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 4.105916590502899, "num_env_steps_trained_throughput_per_sec": 4.105916590502899, "timesteps_total": 168000, "num_env_steps_sampled_lifetime": 168000, "num_agent_steps_sampled_lifetime": 672000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 672000, "timers": {"training_iteration_time_ms": 1936947.529, "restore_workers_time_ms": 0.012, "training_step_time_ms": 1936947.461, "sample_time_ms": 2010.734, "learn_time_ms": 1934920.068, "learn_throughput": 2.067, "synch_weights_time_ms": 14.808}, "counters": {"num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 672000, "num_agent_steps_trained": 672000}, "done": false, "training_iteration": 42, "trial_id": "b941d_00000", "date": "2024-08-18_05-24-55", "timestamp": 1723938895, "time_this_iter_s": 974.2452421188354, "time_total_s": 77459.90828871727, "pid": 81115, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[32, [4, 4], 2], [64, [3, 3], 2], [128, [3, 3], 1]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [256, 256], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b0403dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 77459.90828871727, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 20.227322404371588, "ram_util_percent": 74.96666666666665}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 14.093190749107846, "cur_kl_coeff": 1.5187500000000005, "cur_lr": 0.00010000000000000003, "total_loss": 8.878542577905, "policy_loss": -0.08303379710719344, "vf_loss": 8.938583203472158, "vf_explained_var": 0.22848932689459867, "kl": 0.015139536984825744, "entropy": 1.035588625341496, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 80325.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.358569984524339, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.00010000000000000003, "total_loss": 9.218486227308, "policy_loss": -0.07169784591902816, "vf_loss": 9.272046825873158, "vf_explained_var": -0.01861335244128313, "kl": 0.017913319431703743, "entropy": 0.7077830675733152, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 80325.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_agent_steps_sampled": 688000, "num_agent_steps_trained": 688000}, "env_runners": {"episode_reward_max": 387.25843467625174, "episode_reward_min": -72.43034958074618, "episode_reward_mean": 80.48517218146665, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -669.5159637519515, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 187.13, "predator_policy": 652.0326638571769}, "policy_reward_mean": {"prey_policy": -338.52885311319625, "predator_policy": 378.77143920392956}, "custom_metrics": {}, "hist_stats": {"episode_reward": [126.98344943960534, 32.44, 195.2901158804532, 34.62531974858965, 8.534681342362889, 91.04973956240666, -29.68231799869139, 0.10000000000000231, 2.3111404524550823, 111.46563954831626, 33.71639834218564, 30.137211792024015, 313.8995338654949, -0.7453562503633302, 115.28027360106327, 49.50231008981004, 10.053233939988568, 273.56603495026445, 25.767214594213137, 45.34999999999999, 246.52480102521176, 82.29685382168023, 0.33999999999999897, 116.88615106582361, 12.470224870317384, 288.5435846724764, -50.01227007680332, -72.43034958074618, 130.62388600574948, 354.69498010046567, 193.14015529992255, 14.99776262898386, 22.661294112639766, 98.44114983228967, 27.06186177770125, 6.72185181556856, 11.27, 168.45150797093785, -11.721468816093392, 2.0600000000000023, 208.15963204880418, 279.26640886885724, 133.65582157993225, 123.58000000000006, -6.470179303647528, 187.9447454183576, 2.8897849947524072, 2.079999999999986, 0.1398654139461064, 95.65192512346455, 200.04304438796163, 74.0891234576127, 336.79238648413406, 12.121401560661923, 4.279999999999992, 119.44373620519008, 107.5625798167365, 13.454711062918266, 15.492890719342851, -3.2369632939395014, 179.13176976292777, 6.297369098773784, 46.54703752630074, -39.060008048773625, -3.5249841906046937, 0.0699999999999994, 5.5, 11.479999999999997, 0.4051356769728016, 139.2416487641219, 123.86543226430426, 387.25843467625174, 175.47896312320768, 0.4084760914427379, 266.25, 187.0041851327257, -2.0491439186775082, 54.95972791394944, 2.209999999999998, 26.096553291930533, 77.37248193791055, -0.003993241317717056, -21.09278750428909, 10.23901364436735, 82.46792992537463, 17.427966985402158, 80.24592853632826, 249.91000000000017, 0.19999999999999063, 138.22, -28.838886901153153, 182.20368158871227, 13.999771000087774, 81.19758977713627, -10.550923231803395, 10.967360824795543, 284.71188643558963, 81.21379469273299, 1.3821578314373109, 210.06613470911142], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-62.40195892146146, -408.86124617809077, -245.17336554555385, -460.2546266005294, -531.4821803201808, 103.46332150056334, -258.4780715633998, -468.1463944859851, -395.0411531156648, -403.3541753427317, -224.1995610350516, -444.40199398877866, -441.4494509535151, -257.35577869450793, -570.118585533389, -503.3377353406768, -502.7210161844185, -669.5159637519515, -315.88688449643865, -377.58568522514935, -145.35194670115823, -382.6544260901767, -398.62570765429615, -424.95770273831835, -616.2309618027713, 98.60376768436672, -260.5656833212063, -501.3868736559539, -7.643672869183517, -396.8940208608683, -216.30033705528467, -465.59570037084814, -457.47994075479755, -564.5368625556019, -451.3371331704954, -15.244200694301412, -487.7615558379232, -202.0646413950025, -560.2382666650635, -204.5696588491338, 186.14, -467.5232834220628, -215.94277163586594, -240.81814545536562, -380.7853973658797, -525.1415177327992, -488.0449465345585, -261.37087691753123, -286.68125612892754, -539.1837068270072, 43.198561841051074, -478.7390209757176, -457.0238618098078, -365.89329468850497, -531.1470302222347, -457.93772412684353, -230.33305649873907, -297.27762700727925, -390.1578844593108, 69.07868250069886, -343.5005793958964, -7.959098547138822, -388.70952841710954, -345.7830134087054, -264.9763955204431, -507.25589624959787, -181.8150395997617, -378.2744449913857, -322.0271070243396, -552.5390274982092, -60.18959786641952, -77.40804009308417, -393.9569793194405, -383.11481302172484, -24.292608057892735, -302.1998293497773, -604.3539582924105, -318.9452243037911, -502.06291313339796, -624.5830764447965, 94.33860943822596, -463.8080197514534, 23.71345349714821, -319.24556626941705, -138.56105399662948, -402.6997003438871, -303.0559696769535, 1.434997479199339, -370.7158939727097, -340.5551205461942, 89.34818124324414, -428.6938100199586, -502.2595244733443, -442.43558312336995, -506.801012028525, 2.0000000000000013, -471.83024184320226, -480.00121695863106, -425.08405674500926, -135.1406502037502, 114.15838156314622, -493.5261148364111, -311.6971433861225, -432.5985678768809, 117.61695162382965, -386.68956623857605, -495.23802625148124, -384.08685822826993, -451.5349525060144, -367.68779690747755, -324.47723167019535, -55.25047153546558, -401.4960967250764, -183.25981263623066, -487.302610387444, -337.442189313407, -336.9026175854849, -544.063500751611, -317.7636246779696, -338.8852952164003, -470.17659171351676, -33.91813914060627, -474.9248658009626, -506.86992972136414, -493.4986042913679, -409.55275620625105, -554.1007807756043, -418.90301435776456, -353.6576986605648, -363.6490552107423, -652.0326638571769, -464.11143043541216, -323.69386164565503, -467.34775806770585, -397.0758277156346, -445.1693984952999, -499.7622467665652, -357.272306278104, 2.0000000000000013, -575.579780399799, -477.2254020784859, 2.0000000000000013, -509.4508751252517, 32.39407917911363, 0.9031270371965286, -473.58970504571136, -451.82058620087963, -339.4494065721137, 50.85188127539837, 1.5550765561648205, -71.32572749012009, -328.4232298462968, -392.6655412863416, -529.8350341935951, -459.82133090507443, -201.25377950614293, -422.12090411427977, -514.810993832599, -386.31014727896303, -459.21836405588886, -337.54639995307025, -332.3098073895924, -421.2534282733323, -519.7993620292733, -597.9041253958048, -518.1262715240779, -342.18217995495297, -451.6467566908084, -356.87913494089196, -405.3868914647872, -444.3104862464776, -397.3139983898625, -461.6112239511694, -393.3203497848405, -83.76443531727125, 187.13, -379.48399199061805, -385.9028777109241, 21.07868708478462, -493.5577502352657, -446.2678035942254, -479.3607343929763, -234.35155977748764, -536.9699463310196, -446.83277128667584, -416.6135294250705, -399.0544957093042, -287.2873451413692, -430.85703637194155, -504.84814088917057, -512.5045548645826, -450.393994725987, 141.2958260576612, -339.31666490167277, -565.8025359222673, -433.1918111494262, -406.5754307016426, -306.70379647869873, -445.1207958065267, 32.839536931032], "policy_predator_policy_reward": [290.158324958332, 308.0883295808251, 277.603365545554, 460.2646266005294, 453.3801194081964, 169.9288552918743, 279.366863965909, 481.8829218320655, 403.5255229523489, 403.4044868484101, 319.6739828669366, 439.97731171929985, 337.22688516422727, 331.8960264851044, 570.2185855333889, 503.3377353406768, 529.7620962842996, 644.7860241045256, 473.9721357127375, 330.96607355716645, 196.1135659477781, 365.6092051857422, 412.7629194463199, 440.95770273831835, 518.8157134463095, 312.71101453758945, 258.8103270708426, 502.39687365595387, 302.6360473530179, 217.18191997809663, 265.72462411555165, 465.6737234003911, 472.23288236217826, 559.8371548882099, 278.3958408135175, 461.75152800154393, 316.7201827392572, 398.87322908788224, 560.2382666650635, 249.919658849134, 78.07548438285475, 449.8326000644199, 197.36180932190064, 341.69596159101, 381.1253973658794, 525.1415177327992, 529.9088129555719, 336.39316156234116, 357.4076246376489, 480.9275631886031, 332.8085978078732, 391.27544599926944, 465.4773120752703, 307.4275743462388, 542.6149000473399, 374.0395047209921, 299.87856279391116, 358.3560067178559, 339.09518570014535, 336.6789963589322, 249.74405674896641, 294.85577649399096, 417.86227157108107, 331.6280328837174, 287.6376896330824, 507.25589624959787, 365.5556926775674, 292.9749417458693, 387.0713833493538, 514.5566129508961, 77.0127668559642, 67.30672291910861, 404.97697931944055, 383.36481302172484, 206.32448570546586, 288.6194596731421, 316.5958175735485, 594.9818962065597, 504.1229131333979, 624.5830764447965, 271.92186382958084, 305.70717853245037, 339.5795827867981, 235.21893885432786, 264.7809929420699, 410.1355829783787, 271.45648444056457, 153.74448775718932, 371.9406704544122, 332.86016476084376, 139.00454544472063, 388.2858287503511, 502.2795244733443, 445.30536811812226, 506.881012028525, 0.0, 471.94010725714827, 480.03121695863103, 370.0406586047872, 285.8359734674366, 219.92813854797564, 359.48263911325097, 330.26537439535406, 488.11946032526197, 279.1529213850988, 326.7120797137811, 411.7474807067435, 479.69880533366904, 453.61495250601433, 369.88779690747737, 119.81018009195266, 379.3612593188981, 330.6134582355677, 361.7050309424756, 494.0502894719775, 344.1492212917915, 358.9051449048253, 537.5538641516131, 318.83595219237384, 334.57600440805606, 415.1739101842448, 268.05259043280626, 499.0882235619724, 489.00394105912795, 462.92967009585107, 486.66872792806896, 545.2907098998253, 388.6530771847701, 468.36500158217615, 245.4167680985254, 652.0326638571769, 464.1814304354121, 329.18386164565493, 467.35775806770584, 408.31582771563455, 445.4093984952997, 499.563278070246, 357.876410651396, 287.2370796718368, 425.58434949208385, 441.5620547850934, 157.52877955769677, 412.59072879782155, 451.72450182456816, 321.9282109101098, 326.23733022161343, 451.8305862008796, 339.84788266355605, 102.14811872460163, 111.69492344383526, 217.42008927449422, 369.3330531946491, 438.41661531579797, 482.0348162454612, 436.46921373475294, 279.5656245904133, 422.2809041142796, 516.8609938325991, 386.47200752711603, 485.1530570996663, 531.9302923795468, 215.2983969010252, 421.44342827333224, 519.6053687879556, 597.5042681807367, 497.43334123485715, 421.22721900628267, 382.84073128384597, 433.35999807455704, 411.3739582564967, 434.9371524845434, 424.11529913719846, 428.2539539682514, 506.92354830408675, 146.54443531727168, 0.0, 379.49399199061804, 386.0928777109239, 117.12131291521548, 493.5777502352657, 485.40077617188, 411.3888749141685, 510.68968543599266, 442.8355022612267, 442.79159772102787, 434.6544739908058, 269.79498172283775, 497.7444489049715, 494.95492421181535, 430.19932981749344, 512.5045548645826, 461.3613555507824, 277.16231377000224, 205.57041150959878, 551.5358651999156, 528.6722765645108, 406.5754307016426, 308.0859543101356, 461.82591963053227, 160.52147395407394]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.028807737810777, "mean_inference_ms": 64.10315564073906, "mean_action_processing_ms": 0.2523422013711766, "mean_env_wait_ms": 9.33088095291645, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005156874656677246, "StateBufferConnector_ms": 0.0034613609313964844, "ViewRequirementAgentConnector_ms": 0.10768890380859375}, "num_episodes": 18, "episode_return_max": 387.25843467625174, "episode_return_min": -72.43034958074618, "episode_return_mean": 80.48517218146665, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 688000, "num_agent_steps_trained": 688000, "num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 2.28339129268758, "num_env_steps_trained_throughput_per_sec": 2.28339129268758, "timesteps_total": 172000, "num_env_steps_sampled_lifetime": 172000, "num_agent_steps_sampled_lifetime": 688000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 688000, "timers": {"training_iteration_time_ms": 1997611.182, "restore_workers_time_ms": 0.014, "training_step_time_ms": 1997611.111, "sample_time_ms": 2004.687, "learn_time_ms": 1995590.27, "learn_throughput": 2.004, "synch_weights_time_ms": 14.479}, "counters": {"num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_agent_steps_sampled": 688000, "num_agent_steps_trained": 688000}, "done": false, "training_iteration": 43, "trial_id": "b941d_00000", "date": "2024-08-18_05-54-07", "timestamp": 1723940647, "time_this_iter_s": 1751.8190910816193, "time_total_s": 79211.72737979889, "pid": 81115, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[32, [4, 4], 2], [64, [3, 3], 2], [128, [3, 3], 1]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [256, 256], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2937b80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 79211.72737979889, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 21.347058823529412, "ram_util_percent": 75.61229946524064}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.122484528324591, "cur_kl_coeff": 1.5187500000000005, "cur_lr": 0.00010000000000000003, "total_loss": 8.530153334329999, "policy_loss": -0.08904369639703344, "vf_loss": 8.595687933321353, "vf_explained_var": 0.2714651774161707, "kl": 0.0154792584298583, "entropy": 1.0135188021987833, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 82215.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.109526252115845, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.00010000000000000003, "total_loss": 8.495618768722291, "policy_loss": -0.08147130699621306, "vf_loss": 8.558575778032736, "vf_explained_var": 0.12379627454848517, "kl": 0.018285704228002856, "entropy": 0.7617004295820913, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 82215.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_agent_steps_sampled": 704000, "num_agent_steps_trained": 704000}, "env_runners": {"episode_reward_max": 387.25843467625174, "episode_reward_min": -72.43034958074618, "episode_reward_mean": 79.84772624948859, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -652.0326638571769, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 187.13, "predator_policy": 652.0326638571769}, "policy_reward_mean": {"prey_policy": -332.59475856541013, "predator_policy": 372.5186216901544}, "custom_metrics": {}, "hist_stats": {"episode_reward": [25.767214594213137, 45.34999999999999, 246.52480102521176, 82.29685382168023, 0.33999999999999897, 116.88615106582361, 12.470224870317384, 288.5435846724764, -50.01227007680332, -72.43034958074618, 130.62388600574948, 354.69498010046567, 193.14015529992255, 14.99776262898386, 22.661294112639766, 98.44114983228967, 27.06186177770125, 6.72185181556856, 11.27, 168.45150797093785, -11.721468816093392, 2.0600000000000023, 208.15963204880418, 279.26640886885724, 133.65582157993225, 123.58000000000006, -6.470179303647528, 187.9447454183576, 2.8897849947524072, 2.079999999999986, 0.1398654139461064, 95.65192512346455, 200.04304438796163, 74.0891234576127, 336.79238648413406, 12.121401560661923, 4.279999999999992, 119.44373620519008, 107.5625798167365, 13.454711062918266, 15.492890719342851, -3.2369632939395014, 179.13176976292777, 6.297369098773784, 46.54703752630074, -39.060008048773625, -3.5249841906046937, 0.0699999999999994, 5.5, 11.479999999999997, 0.4051356769728016, 139.2416487641219, 123.86543226430426, 387.25843467625174, 175.47896312320768, 0.4084760914427379, 266.25, 187.0041851327257, -2.0491439186775082, 54.95972791394944, 2.209999999999998, 26.096553291930533, 77.37248193791055, -0.003993241317717056, -21.09278750428909, 10.23901364436735, 82.46792992537463, 17.427966985402158, 80.24592853632826, 249.91000000000017, 0.19999999999999063, 138.22, -28.838886901153153, 182.20368158871227, 13.999771000087774, 81.19758977713627, -10.550923231803395, 10.967360824795543, 284.71188643558963, 81.21379469273299, 1.3821578314373109, 210.06613470911142, 29.26732670183843, 0.13000000000000633, -1.8792154057172468, -30.569883430313872, -21.810578646509896, 14.030000000000005, 9.669298122353153, 118.57377279466355, 87.59570454564766, 92.24936795757574, -45.57884407886017, 7.448071486466949, 208.97346167121245, 310.65803149008065, 246.67774410947925, 0.6597754625888904, 21.572176957729923, 287.1166053699223], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-487.7615558379232, -202.0646413950025, -560.2382666650635, -204.5696588491338, 186.14, -467.5232834220628, -215.94277163586594, -240.81814545536562, -380.7853973658797, -525.1415177327992, -488.0449465345585, -261.37087691753123, -286.68125612892754, -539.1837068270072, 43.198561841051074, -478.7390209757176, -457.0238618098078, -365.89329468850497, -531.1470302222347, -457.93772412684353, -230.33305649873907, -297.27762700727925, -390.1578844593108, 69.07868250069886, -343.5005793958964, -7.959098547138822, -388.70952841710954, -345.7830134087054, -264.9763955204431, -507.25589624959787, -181.8150395997617, -378.2744449913857, -322.0271070243396, -552.5390274982092, -60.18959786641952, -77.40804009308417, -393.9569793194405, -383.11481302172484, -24.292608057892735, -302.1998293497773, -604.3539582924105, -318.9452243037911, -502.06291313339796, -624.5830764447965, 94.33860943822596, -463.8080197514534, 23.71345349714821, -319.24556626941705, -138.56105399662948, -402.6997003438871, -303.0559696769535, 1.434997479199339, -370.7158939727097, -340.5551205461942, 89.34818124324414, -428.6938100199586, -502.2595244733443, -442.43558312336995, -506.801012028525, 2.0000000000000013, -471.83024184320226, -480.00121695863106, -425.08405674500926, -135.1406502037502, 114.15838156314622, -493.5261148364111, -311.6971433861225, -432.5985678768809, 117.61695162382965, -386.68956623857605, -495.23802625148124, -384.08685822826993, -451.5349525060144, -367.68779690747755, -324.47723167019535, -55.25047153546558, -401.4960967250764, -183.25981263623066, -487.302610387444, -337.442189313407, -336.9026175854849, -544.063500751611, -317.7636246779696, -338.8852952164003, -470.17659171351676, -33.91813914060627, -474.9248658009626, -506.86992972136414, -493.4986042913679, -409.55275620625105, -554.1007807756043, -418.90301435776456, -353.6576986605648, -363.6490552107423, -652.0326638571769, -464.11143043541216, -323.69386164565503, -467.34775806770585, -397.0758277156346, -445.1693984952999, -499.7622467665652, -357.272306278104, 2.0000000000000013, -575.579780399799, -477.2254020784859, 2.0000000000000013, -509.4508751252517, 32.39407917911363, 0.9031270371965286, -473.58970504571136, -451.82058620087963, -339.4494065721137, 50.85188127539837, 1.5550765561648205, -71.32572749012009, -328.4232298462968, -392.6655412863416, -529.8350341935951, -459.82133090507443, -201.25377950614293, -422.12090411427977, -514.810993832599, -386.31014727896303, -459.21836405588886, -337.54639995307025, -332.3098073895924, -421.2534282733323, -519.7993620292733, -597.9041253958048, -518.1262715240779, -342.18217995495297, -451.6467566908084, -356.87913494089196, -405.3868914647872, -444.3104862464776, -397.3139983898625, -461.6112239511694, -393.3203497848405, -83.76443531727125, 187.13, -379.48399199061805, -385.9028777109241, 21.07868708478462, -493.5577502352657, -446.2678035942254, -479.3607343929763, -234.35155977748764, -536.9699463310196, -446.83277128667584, -416.6135294250705, -399.0544957093042, -287.2873451413692, -430.85703637194155, -504.84814088917057, -512.5045548645826, -450.393994725987, 141.2958260576612, -339.31666490167277, -565.8025359222673, -433.1918111494262, -406.5754307016426, -306.70379647869873, -445.1207958065267, 32.839536931032, -401.062059743934, -307.5116524042741, -483.47358846552567, -420.96062482579555, -452.4970085380977, -493.73423203590033, -279.90039711412106, -523.4202298649464, -453.76673484261516, -278.65337838059537, -395.7389190229406, -559.55638112619, -470.74927358030544, -259.0969226145276, -330.9885889109107, -127.94336955216667, -399.38893149456857, -135.68884577890682, -223.5643910355937, -428.60857988204697, -373.70707461489053, -374.42775757127896, -339.6341742667922, -330.3942306535024, -434.8239208223464, -33.32573058782074, 155.92608140762383, 19.794986156958025, -136.53162124804754, -346.27355576566555, -493.6381732809777, -390.24826461722995, -375.2973915945929, -528.0426722358332, -39.35252917222048, -9.40486075001688], "policy_predator_policy_reward": [316.7201827392572, 398.87322908788224, 560.2382666650635, 249.919658849134, 78.07548438285475, 449.8326000644199, 197.36180932190064, 341.69596159101, 381.1253973658794, 525.1415177327992, 529.9088129555719, 336.39316156234116, 357.4076246376489, 480.9275631886031, 332.8085978078732, 391.27544599926944, 465.4773120752703, 307.4275743462388, 542.6149000473399, 374.0395047209921, 299.87856279391116, 358.3560067178559, 339.09518570014535, 336.6789963589322, 249.74405674896641, 294.85577649399096, 417.86227157108107, 331.6280328837174, 287.6376896330824, 507.25589624959787, 365.5556926775674, 292.9749417458693, 387.0713833493538, 514.5566129508961, 77.0127668559642, 67.30672291910861, 404.97697931944055, 383.36481302172484, 206.32448570546586, 288.6194596731421, 316.5958175735485, 594.9818962065597, 504.1229131333979, 624.5830764447965, 271.92186382958084, 305.70717853245037, 339.5795827867981, 235.21893885432786, 264.7809929420699, 410.1355829783787, 271.45648444056457, 153.74448775718932, 371.9406704544122, 332.86016476084376, 139.00454544472063, 388.2858287503511, 502.2795244733443, 445.30536811812226, 506.881012028525, 0.0, 471.94010725714827, 480.03121695863103, 370.0406586047872, 285.8359734674366, 219.92813854797564, 359.48263911325097, 330.26537439535406, 488.11946032526197, 279.1529213850988, 326.7120797137811, 411.7474807067435, 479.69880533366904, 453.61495250601433, 369.88779690747737, 119.81018009195266, 379.3612593188981, 330.6134582355677, 361.7050309424756, 494.0502894719775, 344.1492212917915, 358.9051449048253, 537.5538641516131, 318.83595219237384, 334.57600440805606, 415.1739101842448, 268.05259043280626, 499.0882235619724, 489.00394105912795, 462.92967009585107, 486.66872792806896, 545.2907098998253, 388.6530771847701, 468.36500158217615, 245.4167680985254, 652.0326638571769, 464.1814304354121, 329.18386164565493, 467.35775806770584, 408.31582771563455, 445.4093984952997, 499.563278070246, 357.876410651396, 287.2370796718368, 425.58434949208385, 441.5620547850934, 157.52877955769677, 412.59072879782155, 451.72450182456816, 321.9282109101098, 326.23733022161343, 451.8305862008796, 339.84788266355605, 102.14811872460163, 111.69492344383526, 217.42008927449422, 369.3330531946491, 438.41661531579797, 482.0348162454612, 436.46921373475294, 279.5656245904133, 422.2809041142796, 516.8609938325991, 386.47200752711603, 485.1530570996663, 531.9302923795468, 215.2983969010252, 421.44342827333224, 519.6053687879556, 597.5042681807367, 497.43334123485715, 421.22721900628267, 382.84073128384597, 433.35999807455704, 411.3739582564967, 434.9371524845434, 424.11529913719846, 428.2539539682514, 506.92354830408675, 146.54443531727168, 0.0, 379.49399199061804, 386.0928777109239, 117.12131291521548, 493.5777502352657, 485.40077617188, 411.3888749141685, 510.68968543599266, 442.8355022612267, 442.79159772102787, 434.6544739908058, 269.79498172283775, 497.7444489049715, 494.95492421181535, 430.19932981749344, 512.5045548645826, 461.3613555507824, 277.16231377000224, 205.57041150959878, 551.5358651999156, 528.6722765645108, 406.5754307016426, 308.0859543101356, 461.82591963053227, 160.52147395407394, 434.27595484296893, 303.5650840070774, 483.49358846552565, 421.07062482579545, 449.9418163866676, 494.4102087816131, 528.225210845128, 244.5255327036254, 384.6695498873714, 325.93998468932983, 409.73891902294065, 559.58638112619, 435.9822518711998, 303.5332424459863, 129.7378930653301, 447.7678381924105, 387.79655276921017, 234.876929049912, 361.7437601058416, 382.67857876937484, 320.18717408798284, 382.3688140193266, 132.53348635505444, 544.9429900517064, 424.2230463311827, 252.9000667501969, 134.9369639254988, 0.0, 376.25638708949685, 353.22653403369554, 425.33035818377783, 459.2158551770188, 460.19901928788033, 464.7132215002757, 151.84035298099886, 184.03364231116092]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.890349533058595, "mean_inference_ms": 62.7796789059147, "mean_action_processing_ms": 0.25229011534107465, "mean_env_wait_ms": 9.133723649398938, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005056619644165039, "StateBufferConnector_ms": 0.0036077499389648438, "ViewRequirementAgentConnector_ms": 0.10598492622375488}, "num_episodes": 18, "episode_return_max": 387.25843467625174, "episode_return_min": -72.43034958074618, "episode_return_mean": 79.84772624948859, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 704000, "num_agent_steps_trained": 704000, "num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 6.393605596860937, "num_env_steps_trained_throughput_per_sec": 6.393605596860937, "timesteps_total": 176000, "num_env_steps_sampled_lifetime": 176000, "num_agent_steps_sampled_lifetime": 704000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 704000, "timers": {"training_iteration_time_ms": 1923206.002, "restore_workers_time_ms": 0.014, "training_step_time_ms": 1923205.93, "sample_time_ms": 2000.278, "learn_time_ms": 1921188.95, "learn_throughput": 2.082, "synch_weights_time_ms": 14.935}, "counters": {"num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_agent_steps_sampled": 704000, "num_agent_steps_trained": 704000}, "done": false, "training_iteration": 44, "trial_id": "b941d_00000", "date": "2024-08-18_06-04-33", "timestamp": 1723941273, "time_this_iter_s": 625.6599681377411, "time_total_s": 79837.38734793663, "pid": 81115, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[32, [4, 4], 2], [64, [3, 3], 2], [128, [3, 3], 1]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [256, 256], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2966430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 79837.38734793663, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 22.013513513513512, "ram_util_percent": 76.24486486486487}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.681142032966411, "cur_kl_coeff": 1.5187500000000005, "cur_lr": 0.00010000000000000003, "total_loss": 8.511433695485351, "policy_loss": -0.09251407441774274, "vf_loss": 8.579882671719506, "vf_explained_var": 0.3073402009628437, "kl": 0.01584533298141245, "entropy": 1.0057173074553252, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 84105.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.940128905054122, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.00010000000000000003, "total_loss": 9.224126183545147, "policy_loss": -0.08597646262201052, "vf_loss": 9.291014568893997, "vf_explained_var": -0.1600309046172591, "kl": 0.018852408417614624, "entropy": 0.792672531283091, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 84105.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000}, "env_runners": {"episode_reward_max": 387.25843467625174, "episode_reward_min": -73.26293938045258, "episode_reward_mean": 77.18837387030501, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -800.507432284949, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 187.13, "predator_policy": 800.507432284949}, "policy_reward_mean": {"prey_policy": -337.64308536463477, "predator_policy": 376.23727229978715}, "custom_metrics": {}, "hist_stats": {"episode_reward": [208.15963204880418, 279.26640886885724, 133.65582157993225, 123.58000000000006, -6.470179303647528, 187.9447454183576, 2.8897849947524072, 2.079999999999986, 0.1398654139461064, 95.65192512346455, 200.04304438796163, 74.0891234576127, 336.79238648413406, 12.121401560661923, 4.279999999999992, 119.44373620519008, 107.5625798167365, 13.454711062918266, 15.492890719342851, -3.2369632939395014, 179.13176976292777, 6.297369098773784, 46.54703752630074, -39.060008048773625, -3.5249841906046937, 0.0699999999999994, 5.5, 11.479999999999997, 0.4051356769728016, 139.2416487641219, 123.86543226430426, 387.25843467625174, 175.47896312320768, 0.4084760914427379, 266.25, 187.0041851327257, -2.0491439186775082, 54.95972791394944, 2.209999999999998, 26.096553291930533, 77.37248193791055, -0.003993241317717056, -21.09278750428909, 10.23901364436735, 82.46792992537463, 17.427966985402158, 80.24592853632826, 249.91000000000017, 0.19999999999999063, 138.22, -28.838886901153153, 182.20368158871227, 13.999771000087774, 81.19758977713627, -10.550923231803395, 10.967360824795543, 284.71188643558963, 81.21379469273299, 1.3821578314373109, 210.06613470911142, 29.26732670183843, 0.13000000000000633, -1.8792154057172468, -30.569883430313872, -21.810578646509896, 14.030000000000005, 9.669298122353153, 118.57377279466355, 87.59570454564766, 92.24936795757574, -45.57884407886017, 7.448071486466949, 208.97346167121245, 310.65803149008065, 246.67774410947925, 0.6597754625888904, 21.572176957729923, 287.1166053699223, 2.8563049163819256, 71.32013913777958, -1.9026846673637907, 12.841835406668572, 32.38188976090731, 290.20680439018884, 115.40280512350722, 234.92137565117923, 183.1598528613757, 123.8795299305471, -3.315550256674197, 162.80103483174065, 72.464507937233, 2.4424906541753444e-15, -4.462931518080605, 60.2185539250295, 44.636000703872526, -73.26293938045258, -5.846425056325882, 24.814286893269145, -21.2563654887995, 126.3459280999988], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [94.33860943822596, -463.8080197514534, 23.71345349714821, -319.24556626941705, -138.56105399662948, -402.6997003438871, -303.0559696769535, 1.434997479199339, -370.7158939727097, -340.5551205461942, 89.34818124324414, -428.6938100199586, -502.2595244733443, -442.43558312336995, -506.801012028525, 2.0000000000000013, -471.83024184320226, -480.00121695863106, -425.08405674500926, -135.1406502037502, 114.15838156314622, -493.5261148364111, -311.6971433861225, -432.5985678768809, 117.61695162382965, -386.68956623857605, -495.23802625148124, -384.08685822826993, -451.5349525060144, -367.68779690747755, -324.47723167019535, -55.25047153546558, -401.4960967250764, -183.25981263623066, -487.302610387444, -337.442189313407, -336.9026175854849, -544.063500751611, -317.7636246779696, -338.8852952164003, -470.17659171351676, -33.91813914060627, -474.9248658009626, -506.86992972136414, -493.4986042913679, -409.55275620625105, -554.1007807756043, -418.90301435776456, -353.6576986605648, -363.6490552107423, -652.0326638571769, -464.11143043541216, -323.69386164565503, -467.34775806770585, -397.0758277156346, -445.1693984952999, -499.7622467665652, -357.272306278104, 2.0000000000000013, -575.579780399799, -477.2254020784859, 2.0000000000000013, -509.4508751252517, 32.39407917911363, 0.9031270371965286, -473.58970504571136, -451.82058620087963, -339.4494065721137, 50.85188127539837, 1.5550765561648205, -71.32572749012009, -328.4232298462968, -392.6655412863416, -529.8350341935951, -459.82133090507443, -201.25377950614293, -422.12090411427977, -514.810993832599, -386.31014727896303, -459.21836405588886, -337.54639995307025, -332.3098073895924, -421.2534282733323, -519.7993620292733, -597.9041253958048, -518.1262715240779, -342.18217995495297, -451.6467566908084, -356.87913494089196, -405.3868914647872, -444.3104862464776, -397.3139983898625, -461.6112239511694, -393.3203497848405, -83.76443531727125, 187.13, -379.48399199061805, -385.9028777109241, 21.07868708478462, -493.5577502352657, -446.2678035942254, -479.3607343929763, -234.35155977748764, -536.9699463310196, -446.83277128667584, -416.6135294250705, -399.0544957093042, -287.2873451413692, -430.85703637194155, -504.84814088917057, -512.5045548645826, -450.393994725987, 141.2958260576612, -339.31666490167277, -565.8025359222673, -433.1918111494262, -406.5754307016426, -306.70379647869873, -445.1207958065267, 32.839536931032, -401.062059743934, -307.5116524042741, -483.47358846552567, -420.96062482579555, -452.4970085380977, -493.73423203590033, -279.90039711412106, -523.4202298649464, -453.76673484261516, -278.65337838059537, -395.7389190229406, -559.55638112619, -470.74927358030544, -259.0969226145276, -330.9885889109107, -127.94336955216667, -399.38893149456857, -135.68884577890682, -223.5643910355937, -428.60857988204697, -373.70707461489053, -374.42775757127896, -339.6341742667922, -330.3942306535024, -434.8239208223464, -33.32573058782074, 155.92608140762383, 19.794986156958025, -136.53162124804754, -346.27355576566555, -493.6381732809777, -390.24826461722995, -375.2973915945929, -528.0426722358332, -39.35252917222048, -9.40486075001688, -449.92578493766064, -389.2382983190475, -271.72517957569727, -596.1907767768481, -550.6746105407185, -462.1780242226626, -462.5319098507784, -312.36881539035375, -307.7505686834473, -368.96833509027636, 122.69749690163994, -506.1314627008946, -396.74330144465256, -105.86294373972245, -343.5909737229641, 22.865462531388772, -401.5541157129537, 32.30088697773431, -17.002272053920986, -354.84141344829663, -377.84687522873054, -317.5803737461584, -527.0719309785193, -21.150241067260907, -121.52200395917218, -421.3178317733457, -800.507432284949, -458.26844244115205, -475.9655138920339, -405.1020135512229, -422.65868034913876, -641.2244998439141, -350.0750993716316, -132.9276377501653, -444.5467067216464, -439.30666956535674, -374.0819592172162, -407.48246569791985, -456.59002740008304, -447.9722855200153, -337.5466290452532, -346.3344739008557, -528.0035924304818, 10.667514942317789], "policy_predator_policy_reward": [271.92186382958084, 305.70717853245037, 339.5795827867981, 235.21893885432786, 264.7809929420699, 410.1355829783787, 271.45648444056457, 153.74448775718932, 371.9406704544122, 332.86016476084376, 139.00454544472063, 388.2858287503511, 502.2795244733443, 445.30536811812226, 506.881012028525, 0.0, 471.94010725714827, 480.03121695863103, 370.0406586047872, 285.8359734674366, 219.92813854797564, 359.48263911325097, 330.26537439535406, 488.11946032526197, 279.1529213850988, 326.7120797137811, 411.7474807067435, 479.69880533366904, 453.61495250601433, 369.88779690747737, 119.81018009195266, 379.3612593188981, 330.6134582355677, 361.7050309424756, 494.0502894719775, 344.1492212917915, 358.9051449048253, 537.5538641516131, 318.83595219237384, 334.57600440805606, 415.1739101842448, 268.05259043280626, 499.0882235619724, 489.00394105912795, 462.92967009585107, 486.66872792806896, 545.2907098998253, 388.6530771847701, 468.36500158217615, 245.4167680985254, 652.0326638571769, 464.1814304354121, 329.18386164565493, 467.35775806770584, 408.31582771563455, 445.4093984952997, 499.563278070246, 357.876410651396, 287.2370796718368, 425.58434949208385, 441.5620547850934, 157.52877955769677, 412.59072879782155, 451.72450182456816, 321.9282109101098, 326.23733022161343, 451.8305862008796, 339.84788266355605, 102.14811872460163, 111.69492344383526, 217.42008927449422, 369.3330531946491, 438.41661531579797, 482.0348162454612, 436.46921373475294, 279.5656245904133, 422.2809041142796, 516.8609938325991, 386.47200752711603, 485.1530570996663, 531.9302923795468, 215.2983969010252, 421.44342827333224, 519.6053687879556, 597.5042681807367, 497.43334123485715, 421.22721900628267, 382.84073128384597, 433.35999807455704, 411.3739582564967, 434.9371524845434, 424.11529913719846, 428.2539539682514, 506.92354830408675, 146.54443531727168, 0.0, 379.49399199061804, 386.0928777109239, 117.12131291521548, 493.5777502352657, 485.40077617188, 411.3888749141685, 510.68968543599266, 442.8355022612267, 442.79159772102787, 434.6544739908058, 269.79498172283775, 497.7444489049715, 494.95492421181535, 430.19932981749344, 512.5045548645826, 461.3613555507824, 277.16231377000224, 205.57041150959878, 551.5358651999156, 528.6722765645108, 406.5754307016426, 308.0859543101356, 461.82591963053227, 160.52147395407394, 434.27595484296893, 303.5650840070774, 483.49358846552565, 421.07062482579545, 449.9418163866676, 494.4102087816131, 528.225210845128, 244.5255327036254, 384.6695498873714, 325.93998468932983, 409.73891902294065, 559.58638112619, 435.9822518711998, 303.5332424459863, 129.7378930653301, 447.7678381924105, 387.79655276921017, 234.876929049912, 361.7437601058416, 382.67857876937484, 320.18717408798284, 382.3688140193266, 132.53348635505444, 544.9429900517064, 424.2230463311827, 252.9000667501969, 134.9369639254988, 0.0, 376.25638708949685, 353.22653403369554, 425.33035818377783, 459.2158551770188, 460.19901928788033, 464.7132215002757, 151.84035298099886, 184.03364231116092, 441.2972004054868, 400.72318776760295, 445.009947382538, 494.2261481077862, 554.750728495021, 456.1992216009962, 457.78635796964534, 329.9562026781552, 332.09245844435446, 377.0083350902763, 346.46106446133365, 327.1797057281097, 215.05281992808895, 402.9562303797931, 244.93448933031644, 310.7123975124381, 378.9420313289356, 173.47105026765968, 241.59700977727536, 254.12620565548892, 256.28973298275145, 435.821965735464, 441.74633724260605, 269.2768696349153, 386.5606612803198, 228.7436823894307, 800.507432284949, 458.26844244115205, 479.97653633837757, 396.62805958679843, 561.145024168714, 562.9567099493685, 169.7965776664665, 357.84216015920197, 370.51298582815315, 440.07745107839753, 449.10693691173367, 326.61106294707565, 488.0181212533747, 441.35847855999253, 308.4357868524516, 354.1889506048575, 269.87049140425916, 373.81151418390454]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.725490511207423, "mean_inference_ms": 61.268956262069366, "mean_action_processing_ms": 0.2522574655648594, "mean_env_wait_ms": 8.85177745094717, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005129575729370117, "StateBufferConnector_ms": 0.0038366317749023438, "ViewRequirementAgentConnector_ms": 0.10890758037567139}, "num_episodes": 22, "episode_return_max": 387.25843467625174, "episode_return_min": -73.26293938045258, "episode_return_mean": 77.18837387030501, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 5.000394600476818, "num_env_steps_trained_throughput_per_sec": 5.000394600476818, "timesteps_total": 180000, "num_env_steps_sampled_lifetime": 180000, "num_agent_steps_sampled_lifetime": 720000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 720000, "timers": {"training_iteration_time_ms": 1887310.849, "restore_workers_time_ms": 0.014, "training_step_time_ms": 1887310.776, "sample_time_ms": 2012.658, "learn_time_ms": 1885281.691, "learn_throughput": 2.122, "synch_weights_time_ms": 14.629}, "counters": {"num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000}, "done": false, "training_iteration": 45, "trial_id": "b941d_00000", "date": "2024-08-18_06-17-53", "timestamp": 1723942073, "time_this_iter_s": 799.9788138866425, "time_total_s": 80637.36616182327, "pid": 81115, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[32, [4, 4], 2], [64, [3, 3], 2], [128, [3, 3], 1]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [256, 256], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b04030d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 80637.36616182327, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 21.15268817204301, "ram_util_percent": 76.48118279569893}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 11.534001456997382, "cur_kl_coeff": 1.5187500000000005, "cur_lr": 0.00010000000000000003, "total_loss": 8.496541826561014, "policy_loss": -0.08296021673207482, "vf_loss": 8.556154300296118, "vf_explained_var": 0.297439826070947, "kl": 0.01537301282483926, "entropy": 0.9938028611834087, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 85995.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.203368735313415, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.00010000000000000003, "total_loss": 8.981345470367916, "policy_loss": -0.07795801845184533, "vf_loss": 9.040816487710943, "vf_explained_var": -0.09265571154614605, "kl": 0.018258759210136193, "entropy": 0.754078343557933, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 85995.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_agent_steps_sampled": 736000, "num_agent_steps_trained": 736000}, "env_runners": {"episode_reward_max": 387.25843467625174, "episode_reward_min": -115.760686585663, "episode_reward_mean": 76.46306981651864, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -800.507432284949, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 194.06, "predator_policy": 800.507432284949}, "policy_reward_mean": {"prey_policy": -341.9655229039548, "predator_policy": 380.19705781221404}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-39.060008048773625, -3.5249841906046937, 0.0699999999999994, 5.5, 11.479999999999997, 0.4051356769728016, 139.2416487641219, 123.86543226430426, 387.25843467625174, 175.47896312320768, 0.4084760914427379, 266.25, 187.0041851327257, -2.0491439186775082, 54.95972791394944, 2.209999999999998, 26.096553291930533, 77.37248193791055, -0.003993241317717056, -21.09278750428909, 10.23901364436735, 82.46792992537463, 17.427966985402158, 80.24592853632826, 249.91000000000017, 0.19999999999999063, 138.22, -28.838886901153153, 182.20368158871227, 13.999771000087774, 81.19758977713627, -10.550923231803395, 10.967360824795543, 284.71188643558963, 81.21379469273299, 1.3821578314373109, 210.06613470911142, 29.26732670183843, 0.13000000000000633, -1.8792154057172468, -30.569883430313872, -21.810578646509896, 14.030000000000005, 9.669298122353153, 118.57377279466355, 87.59570454564766, 92.24936795757574, -45.57884407886017, 7.448071486466949, 208.97346167121245, 310.65803149008065, 246.67774410947925, 0.6597754625888904, 21.572176957729923, 287.1166053699223, 2.8563049163819256, 71.32013913777958, -1.9026846673637907, 12.841835406668572, 32.38188976090731, 290.20680439018884, 115.40280512350722, 234.92137565117923, 183.1598528613757, 123.8795299305471, -3.315550256674197, 162.80103483174065, 72.464507937233, 2.4424906541753444e-15, -4.462931518080605, 60.2185539250295, 44.636000703872526, -73.26293938045258, -5.846425056325882, 24.814286893269145, -21.2563654887995, 126.3459280999988, -4.03641406824296, 78.84640083242708, 241.93534292690634, 179.90626162473907, 207.699941538083, 39.77999999999999, 18.278025444787826, 182.32388197490533, -115.760686585663, 58.16798136041649, -20.409630274686975, 318.65849449845837, 28.269999999999992, -0.08280236005689745, 53.974133060002465, 25.080000000000005, 71.96437797995787, 171.08328539897818, 30.093231493260173, 181.77623620998003, 219.4423289465997, 1.109999999999999, 98.28629555359734], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-554.1007807756043, -418.90301435776456, -353.6576986605648, -363.6490552107423, -652.0326638571769, -464.11143043541216, -323.69386164565503, -467.34775806770585, -397.0758277156346, -445.1693984952999, -499.7622467665652, -357.272306278104, 2.0000000000000013, -575.579780399799, -477.2254020784859, 2.0000000000000013, -509.4508751252517, 32.39407917911363, 0.9031270371965286, -473.58970504571136, -451.82058620087963, -339.4494065721137, 50.85188127539837, 1.5550765561648205, -71.32572749012009, -328.4232298462968, -392.6655412863416, -529.8350341935951, -459.82133090507443, -201.25377950614293, -422.12090411427977, -514.810993832599, -386.31014727896303, -459.21836405588886, -337.54639995307025, -332.3098073895924, -421.2534282733323, -519.7993620292733, -597.9041253958048, -518.1262715240779, -342.18217995495297, -451.6467566908084, -356.87913494089196, -405.3868914647872, -444.3104862464776, -397.3139983898625, -461.6112239511694, -393.3203497848405, -83.76443531727125, 187.13, -379.48399199061805, -385.9028777109241, 21.07868708478462, -493.5577502352657, -446.2678035942254, -479.3607343929763, -234.35155977748764, -536.9699463310196, -446.83277128667584, -416.6135294250705, -399.0544957093042, -287.2873451413692, -430.85703637194155, -504.84814088917057, -512.5045548645826, -450.393994725987, 141.2958260576612, -339.31666490167277, -565.8025359222673, -433.1918111494262, -406.5754307016426, -306.70379647869873, -445.1207958065267, 32.839536931032, -401.062059743934, -307.5116524042741, -483.47358846552567, -420.96062482579555, -452.4970085380977, -493.73423203590033, -279.90039711412106, -523.4202298649464, -453.76673484261516, -278.65337838059537, -395.7389190229406, -559.55638112619, -470.74927358030544, -259.0969226145276, -330.9885889109107, -127.94336955216667, -399.38893149456857, -135.68884577890682, -223.5643910355937, -428.60857988204697, -373.70707461489053, -374.42775757127896, -339.6341742667922, -330.3942306535024, -434.8239208223464, -33.32573058782074, 155.92608140762383, 19.794986156958025, -136.53162124804754, -346.27355576566555, -493.6381732809777, -390.24826461722995, -375.2973915945929, -528.0426722358332, -39.35252917222048, -9.40486075001688, -449.92578493766064, -389.2382983190475, -271.72517957569727, -596.1907767768481, -550.6746105407185, -462.1780242226626, -462.5319098507784, -312.36881539035375, -307.7505686834473, -368.96833509027636, 122.69749690163994, -506.1314627008946, -396.74330144465256, -105.86294373972245, -343.5909737229641, 22.865462531388772, -401.5541157129537, 32.30088697773431, -17.002272053920986, -354.84141344829663, -377.84687522873054, -317.5803737461584, -527.0719309785193, -21.150241067260907, -121.52200395917218, -421.3178317733457, -800.507432284949, -458.26844244115205, -475.9655138920339, -405.1020135512229, -422.65868034913876, -641.2244998439141, -350.0750993716316, -132.9276377501653, -444.5467067216464, -439.30666956535674, -374.0819592172162, -407.48246569791985, -456.59002740008304, -447.9722855200153, -337.5466290452532, -346.3344739008557, -528.0035924304818, 10.667514942317789, -379.9743324419166, -489.89780021687505, -469.21896901859253, -153.8328176891276, -333.6412976716228, 194.06, -480.044615211452, -219.04599182710513, -49.8499363557103, -537.4583895393049, -250.3897571199177, -350.98148512405476, -496.6719990440758, -332.3625173743998, 2.0000000000000013, -492.987932479107, -399.52626039193865, -485.0382839742664, -262.819922990243, -515.1799014798705, -362.79180878507236, -437.73001076763245, -467.5559490474904, 185.94542987494373, -478.6283932217036, -298.8627176003405, -420.9782724388427, -438.75243195241404, -221.95661962785871, -417.5197920737237, -716.6531690036411, -335.6862522864529, -406.8498383940166, -351.15592923075286, -421.90981177168237, 2.0000000000000013, -358.03428111141943, -252.0877165257184, 175.73792485726221, -593.537947523647, -128.46680570070907, -344.7292171799254, -420.6133638796572, -468.32433118859205, -258.10699149378274, -451.4972105543936], "policy_predator_policy_reward": [545.2907098998253, 388.6530771847701, 468.36500158217615, 245.4167680985254, 652.0326638571769, 464.1814304354121, 329.18386164565493, 467.35775806770584, 408.31582771563455, 445.4093984952997, 499.563278070246, 357.876410651396, 287.2370796718368, 425.58434949208385, 441.5620547850934, 157.52877955769677, 412.59072879782155, 451.72450182456816, 321.9282109101098, 326.23733022161343, 451.8305862008796, 339.84788266355605, 102.14811872460163, 111.69492344383526, 217.42008927449422, 369.3330531946491, 438.41661531579797, 482.0348162454612, 436.46921373475294, 279.5656245904133, 422.2809041142796, 516.8609938325991, 386.47200752711603, 485.1530570996663, 531.9302923795468, 215.2983969010252, 421.44342827333224, 519.6053687879556, 597.5042681807367, 497.43334123485715, 421.22721900628267, 382.84073128384597, 433.35999807455704, 411.3739582564967, 434.9371524845434, 424.11529913719846, 428.2539539682514, 506.92354830408675, 146.54443531727168, 0.0, 379.49399199061804, 386.0928777109239, 117.12131291521548, 493.5777502352657, 485.40077617188, 411.3888749141685, 510.68968543599266, 442.8355022612267, 442.79159772102787, 434.6544739908058, 269.79498172283775, 497.7444489049715, 494.95492421181535, 430.19932981749344, 512.5045548645826, 461.3613555507824, 277.16231377000224, 205.57041150959878, 551.5358651999156, 528.6722765645108, 406.5754307016426, 308.0859543101356, 461.82591963053227, 160.52147395407394, 434.27595484296893, 303.5650840070774, 483.49358846552565, 421.07062482579545, 449.9418163866676, 494.4102087816131, 528.225210845128, 244.5255327036254, 384.6695498873714, 325.93998468932983, 409.73891902294065, 559.58638112619, 435.9822518711998, 303.5332424459863, 129.7378930653301, 447.7678381924105, 387.79655276921017, 234.876929049912, 361.7437601058416, 382.67857876937484, 320.18717408798284, 382.3688140193266, 132.53348635505444, 544.9429900517064, 424.2230463311827, 252.9000667501969, 134.9369639254988, 0.0, 376.25638708949685, 353.22653403369554, 425.33035818377783, 459.2158551770188, 460.19901928788033, 464.7132215002757, 151.84035298099886, 184.03364231116092, 441.2972004054868, 400.72318776760295, 445.009947382538, 494.2261481077862, 554.750728495021, 456.1992216009962, 457.78635796964534, 329.9562026781552, 332.09245844435446, 377.0083350902763, 346.46106446133365, 327.1797057281097, 215.05281992808895, 402.9562303797931, 244.93448933031644, 310.7123975124381, 378.9420313289356, 173.47105026765968, 241.59700977727536, 254.12620565548892, 256.28973298275145, 435.821965735464, 441.74633724260605, 269.2768696349153, 386.5606612803198, 228.7436823894307, 800.507432284949, 458.26844244115205, 479.97653633837757, 396.62805958679843, 561.145024168714, 562.9567099493685, 169.7965776664665, 357.84216015920197, 370.51298582815315, 440.07745107839753, 449.10693691173367, 326.61106294707565, 488.0181212533747, 441.35847855999253, 308.4357868524516, 354.1889506048575, 269.87049140425916, 373.81151418390454, 388.11775366769103, 477.71796492285745, 429.75705556307236, 272.14113197707394, 327.16301951609404, 54.35362108243528, 487.39614045395604, 391.60072820934005, 311.5780206422826, 483.43024679081554, 289.5997571199177, 351.55148512405424, 492.9310745016171, 354.3814673616462, 238.15243169242837, 435.1593827615839, 295.96699127844346, 472.836866502099, 440.31274377474585, 395.85506205578343, 491.3388764277158, 288.7733128503014, 302.50233772422644, 297.76667594677866, 480.68839322170356, 325.0727176003404, 422.9755573215719, 436.672344709628, 332.0253641082359, 361.42518065334843, 716.6531690036411, 360.7662522864528, 397.7452188290675, 432.22492677565987, 259.58103848120254, 331.41205868945804, 316.0955249058064, 324.1197042245914, 6.038311352717802, 593.537947523647, 432.9487129571712, 259.68963887006305, 421.6233638796572, 468.424331188592, 415.935949249686, 391.95454835208744]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.567787846902124, "mean_inference_ms": 59.70522858727381, "mean_action_processing_ms": 0.2522135981522973, "mean_env_wait_ms": 8.672422154628086, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005584597587585449, "StateBufferConnector_ms": 0.003783702850341797, "ViewRequirementAgentConnector_ms": 0.10797619819641113}, "num_episodes": 23, "episode_return_max": 387.25843467625174, "episode_return_min": -115.760686585663, "episode_return_mean": 76.46306981651864, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 736000, "num_agent_steps_trained": 736000, "num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 9.941230774344511, "num_env_steps_trained_throughput_per_sec": 9.941230774344511, "timesteps_total": 184000, "num_env_steps_sampled_lifetime": 184000, "num_agent_steps_sampled_lifetime": 736000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 736000, "timers": {"training_iteration_time_ms": 1662069.229, "restore_workers_time_ms": 0.014, "training_step_time_ms": 1662069.154, "sample_time_ms": 2012.219, "learn_time_ms": 1660039.495, "learn_throughput": 2.41, "synch_weights_time_ms": 15.201}, "counters": {"num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_agent_steps_sampled": 736000, "num_agent_steps_trained": 736000}, "done": false, "training_iteration": 46, "trial_id": "b941d_00000", "date": "2024-08-18_06-24-35", "timestamp": 1723942475, "time_this_iter_s": 402.41187500953674, "time_total_s": 81039.77803683281, "pid": 81115, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[32, [4, 4], 2], [64, [3, 3], 2], [128, [3, 3], 1]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [256, 256], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b295db80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 81039.77803683281, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 27.86, "ram_util_percent": 77.78205128205128}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.738677956692126, "cur_kl_coeff": 1.5187500000000005, "cur_lr": 0.00010000000000000003, "total_loss": 8.088958756128948, "policy_loss": -0.08745757912965639, "vf_loss": 8.153478594179507, "vf_explained_var": 0.4069358170032501, "kl": 0.015103047980749209, "entropy": 1.023209120861437, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 87885.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.36044413538837, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.00010000000000000003, "total_loss": 8.560813854358814, "policy_loss": -0.08229369692696584, "vf_loss": 8.624029886407197, "vf_explained_var": 0.04790633421726328, "kl": 0.018842141285391103, "entropy": 0.8229175381244175, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 87885.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_agent_steps_sampled": 752000, "num_agent_steps_trained": 752000}, "env_runners": {"episode_reward_max": 318.65849449845837, "episode_reward_min": -115.760686585663, "episode_reward_mean": 81.74768944339836, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -800.507432284949, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 195.327174769409, "predator_policy": 800.507432284949}, "policy_reward_mean": {"prey_policy": -330.2363994656269, "predator_policy": 371.11024418732603}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.003993241317717056, -21.09278750428909, 10.23901364436735, 82.46792992537463, 17.427966985402158, 80.24592853632826, 249.91000000000017, 0.19999999999999063, 138.22, -28.838886901153153, 182.20368158871227, 13.999771000087774, 81.19758977713627, -10.550923231803395, 10.967360824795543, 284.71188643558963, 81.21379469273299, 1.3821578314373109, 210.06613470911142, 29.26732670183843, 0.13000000000000633, -1.8792154057172468, -30.569883430313872, -21.810578646509896, 14.030000000000005, 9.669298122353153, 118.57377279466355, 87.59570454564766, 92.24936795757574, -45.57884407886017, 7.448071486466949, 208.97346167121245, 310.65803149008065, 246.67774410947925, 0.6597754625888904, 21.572176957729923, 287.1166053699223, 2.8563049163819256, 71.32013913777958, -1.9026846673637907, 12.841835406668572, 32.38188976090731, 290.20680439018884, 115.40280512350722, 234.92137565117923, 183.1598528613757, 123.8795299305471, -3.315550256674197, 162.80103483174065, 72.464507937233, 2.4424906541753444e-15, -4.462931518080605, 60.2185539250295, 44.636000703872526, -73.26293938045258, -5.846425056325882, 24.814286893269145, -21.2563654887995, 126.3459280999988, -4.03641406824296, 78.84640083242708, 241.93534292690634, 179.90626162473907, 207.699941538083, 39.77999999999999, 18.278025444787826, 182.32388197490533, -115.760686585663, 58.16798136041649, -20.409630274686975, 318.65849449845837, 28.269999999999992, -0.08280236005689745, 53.974133060002465, 25.080000000000005, 71.96437797995787, 171.08328539897818, 30.093231493260173, 181.77623620998003, 219.4423289465997, 1.109999999999999, 98.28629555359734, 97.69928749927334, -18.19908642293364, 273.5618424550986, 195.5964448939721, 67.9948282288847, 75.27999999999999, 103.16656286330786, 0.3099999999999976, 4.0500000000000025, 243.99725334054392, 23.454828309140638, 20.014895949133564, 286.8176984382236, 2.696590844339915, 298.4841521908815, 89.80898507612795, 1.4399999999999935, 175.254581736742], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-421.2534282733323, -519.7993620292733, -597.9041253958048, -518.1262715240779, -342.18217995495297, -451.6467566908084, -356.87913494089196, -405.3868914647872, -444.3104862464776, -397.3139983898625, -461.6112239511694, -393.3203497848405, -83.76443531727125, 187.13, -379.48399199061805, -385.9028777109241, 21.07868708478462, -493.5577502352657, -446.2678035942254, -479.3607343929763, -234.35155977748764, -536.9699463310196, -446.83277128667584, -416.6135294250705, -399.0544957093042, -287.2873451413692, -430.85703637194155, -504.84814088917057, -512.5045548645826, -450.393994725987, 141.2958260576612, -339.31666490167277, -565.8025359222673, -433.1918111494262, -406.5754307016426, -306.70379647869873, -445.1207958065267, 32.839536931032, -401.062059743934, -307.5116524042741, -483.47358846552567, -420.96062482579555, -452.4970085380977, -493.73423203590033, -279.90039711412106, -523.4202298649464, -453.76673484261516, -278.65337838059537, -395.7389190229406, -559.55638112619, -470.74927358030544, -259.0969226145276, -330.9885889109107, -127.94336955216667, -399.38893149456857, -135.68884577890682, -223.5643910355937, -428.60857988204697, -373.70707461489053, -374.42775757127896, -339.6341742667922, -330.3942306535024, -434.8239208223464, -33.32573058782074, 155.92608140762383, 19.794986156958025, -136.53162124804754, -346.27355576566555, -493.6381732809777, -390.24826461722995, -375.2973915945929, -528.0426722358332, -39.35252917222048, -9.40486075001688, -449.92578493766064, -389.2382983190475, -271.72517957569727, -596.1907767768481, -550.6746105407185, -462.1780242226626, -462.5319098507784, -312.36881539035375, -307.7505686834473, -368.96833509027636, 122.69749690163994, -506.1314627008946, -396.74330144465256, -105.86294373972245, -343.5909737229641, 22.865462531388772, -401.5541157129537, 32.30088697773431, -17.002272053920986, -354.84141344829663, -377.84687522873054, -317.5803737461584, -527.0719309785193, -21.150241067260907, -121.52200395917218, -421.3178317733457, -800.507432284949, -458.26844244115205, -475.9655138920339, -405.1020135512229, -422.65868034913876, -641.2244998439141, -350.0750993716316, -132.9276377501653, -444.5467067216464, -439.30666956535674, -374.0819592172162, -407.48246569791985, -456.59002740008304, -447.9722855200153, -337.5466290452532, -346.3344739008557, -528.0035924304818, 10.667514942317789, -379.9743324419166, -489.89780021687505, -469.21896901859253, -153.8328176891276, -333.6412976716228, 194.06, -480.044615211452, -219.04599182710513, -49.8499363557103, -537.4583895393049, -250.3897571199177, -350.98148512405476, -496.6719990440758, -332.3625173743998, 2.0000000000000013, -492.987932479107, -399.52626039193865, -485.0382839742664, -262.819922990243, -515.1799014798705, -362.79180878507236, -437.73001076763245, -467.5559490474904, 185.94542987494373, -478.6283932217036, -298.8627176003405, -420.9782724388427, -438.75243195241404, -221.95661962785871, -417.5197920737237, -716.6531690036411, -335.6862522864529, -406.8498383940166, -351.15592923075286, -421.90981177168237, 2.0000000000000013, -358.03428111141943, -252.0877165257184, 175.73792485726221, -593.537947523647, -128.46680570070907, -344.7292171799254, -420.6133638796572, -468.32433118859205, -258.10699149378274, -451.4972105543936, -107.88767137243778, -374.5719759089611, -261.5060788087769, -342.2996691555022, -265.916287013945, 137.77532182944844, 185.62372718915003, -545.772731564597, -466.3965784391566, -131.13988670376008, -185.07665272270503, -454.1373454787107, -171.62226549307707, -128.11468673332985, -289.86963190236133, -568.5673608251211, -416.2346615663842, -472.6269844207777, 13.005312362220735, -232.97787041144647, -351.3097821592239, -302.80734155461266, -363.45951776821283, -486.68254644295916, -420.84194178700375, 195.327174769409, -523.6378744864835, -286.70370585711123, 179.60596229229304, -380.47115174269356, -416.2619679471038, -321.9379089719705, -543.7678589981838, -320.38290998315125, -563.6893065387676, -138.6695515109734], "policy_predator_policy_reward": [421.44342827333224, 519.6053687879556, 597.5042681807367, 497.43334123485715, 421.22721900628267, 382.84073128384597, 433.35999807455704, 411.3739582564967, 434.9371524845434, 424.11529913719846, 428.2539539682514, 506.92354830408675, 146.54443531727168, 0.0, 379.49399199061804, 386.0928777109239, 117.12131291521548, 493.5777502352657, 485.40077617188, 411.3888749141685, 510.68968543599266, 442.8355022612267, 442.79159772102787, 434.6544739908058, 269.79498172283775, 497.7444489049715, 494.95492421181535, 430.19932981749344, 512.5045548645826, 461.3613555507824, 277.16231377000224, 205.57041150959878, 551.5358651999156, 528.6722765645108, 406.5754307016426, 308.0859543101356, 461.82591963053227, 160.52147395407394, 434.27595484296893, 303.5650840070774, 483.49358846552565, 421.07062482579545, 449.9418163866676, 494.4102087816131, 528.225210845128, 244.5255327036254, 384.6695498873714, 325.93998468932983, 409.73891902294065, 559.58638112619, 435.9822518711998, 303.5332424459863, 129.7378930653301, 447.7678381924105, 387.79655276921017, 234.876929049912, 361.7437601058416, 382.67857876937484, 320.18717408798284, 382.3688140193266, 132.53348635505444, 544.9429900517064, 424.2230463311827, 252.9000667501969, 134.9369639254988, 0.0, 376.25638708949685, 353.22653403369554, 425.33035818377783, 459.2158551770188, 460.19901928788033, 464.7132215002757, 151.84035298099886, 184.03364231116092, 441.2972004054868, 400.72318776760295, 445.009947382538, 494.2261481077862, 554.750728495021, 456.1992216009962, 457.78635796964534, 329.9562026781552, 332.09245844435446, 377.0083350902763, 346.46106446133365, 327.1797057281097, 215.05281992808895, 402.9562303797931, 244.93448933031644, 310.7123975124381, 378.9420313289356, 173.47105026765968, 241.59700977727536, 254.12620565548892, 256.28973298275145, 435.821965735464, 441.74633724260605, 269.2768696349153, 386.5606612803198, 228.7436823894307, 800.507432284949, 458.26844244115205, 479.97653633837757, 396.62805958679843, 561.145024168714, 562.9567099493685, 169.7965776664665, 357.84216015920197, 370.51298582815315, 440.07745107839753, 449.10693691173367, 326.61106294707565, 488.0181212533747, 441.35847855999253, 308.4357868524516, 354.1889506048575, 269.87049140425916, 373.81151418390454, 388.11775366769103, 477.71796492285745, 429.75705556307236, 272.14113197707394, 327.16301951609404, 54.35362108243528, 487.39614045395604, 391.60072820934005, 311.5780206422826, 483.43024679081554, 289.5997571199177, 351.55148512405424, 492.9310745016171, 354.3814673616462, 238.15243169242837, 435.1593827615839, 295.96699127844346, 472.836866502099, 440.31274377474585, 395.85506205578343, 491.3388764277158, 288.7733128503014, 302.50233772422644, 297.76667594677866, 480.68839322170356, 325.0727176003404, 422.9755573215719, 436.672344709628, 332.0253641082359, 361.42518065334843, 716.6531690036411, 360.7662522864528, 397.7452188290675, 432.22492677565987, 259.58103848120254, 331.41205868945804, 316.0955249058064, 324.1197042245914, 6.038311352717802, 593.537947523647, 432.9487129571712, 259.68963887006305, 421.6233638796572, 468.424331188592, 415.935949249686, 391.95454835208744, 160.416958871711, 419.74197590896097, 229.93396778225969, 355.67269375908586, 241.65262539190988, 160.05018224768537, 0.8527177048220187, 554.8927315645969, 234.1238540969188, 431.40743927488137, 256.34665272270485, 458.1473454787107, 347.9714716947474, 54.932043394966826, 290.1796319023612, 568.5673608251211, 420.27466156638417, 472.6369844207777, 193.57058225544435, 270.3992291343252, 329.22197108759013, 348.34998093538724, 514.4204984273877, 355.7364617329172, 351.89241053361224, 160.44005492220603, 523.8096615306542, 289.22850965728003, 237.47284350104252, 261.87649814023933, 397.74457427312075, 430.2642877220814, 544.9778589981836, 320.6129099831512, 374.8298658033897, 502.7835739830917]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.448282351611195, "mean_inference_ms": 58.55694831023984, "mean_action_processing_ms": 0.25242396565094877, "mean_env_wait_ms": 8.501152685091583, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006677389144897461, "StateBufferConnector_ms": 0.004004478454589844, "ViewRequirementAgentConnector_ms": 0.11311948299407959}, "num_episodes": 18, "episode_return_max": 318.65849449845837, "episode_return_min": -115.760686585663, "episode_return_mean": 81.74768944339836, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 752000, "num_agent_steps_trained": 752000, "num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 26.72709985948484, "num_env_steps_trained_throughput_per_sec": 26.72709985948484, "timesteps_total": 188000, "num_env_steps_sampled_lifetime": 188000, "num_agent_steps_sampled_lifetime": 752000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 752000, "timers": {"training_iteration_time_ms": 1537637.163, "restore_workers_time_ms": 0.014, "training_step_time_ms": 1537637.087, "sample_time_ms": 2068.066, "learn_time_ms": 1535549.939, "learn_throughput": 2.605, "synch_weights_time_ms": 16.263}, "counters": {"num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_agent_steps_sampled": 752000, "num_agent_steps_trained": 752000}, "done": false, "training_iteration": 47, "trial_id": "b941d_00000", "date": "2024-08-18_06-27-05", "timestamp": 1723942625, "time_this_iter_s": 149.70539593696594, "time_total_s": 81189.48343276978, "pid": 81115, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[32, [4, 4], 2], [64, [3, 3], 2], [128, [3, 3], 1]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [256, 256], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2937dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 81189.48343276978, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 36.60798122065728, "ram_util_percent": 82.29859154929578}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 12.157405205126162, "cur_kl_coeff": 1.5187500000000005, "cur_lr": 0.00010000000000000003, "total_loss": 8.281365253054906, "policy_loss": -0.08051683562536718, "vf_loss": 8.339302936685149, "vf_explained_var": 0.20186641377116007, "kl": 0.014866934656143228, "entropy": 1.0001996669819746, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 89775.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.272961638591907, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.00010000000000000003, "total_loss": 9.362589363824753, "policy_loss": -0.07775217375629359, "vf_loss": 9.422162032758118, "vf_explained_var": -0.24395978598998339, "kl": 0.017955079501119693, "entropy": 0.7591795115874558, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 89775.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 768000, "num_agent_steps_trained": 768000}, "env_runners": {"episode_reward_max": 318.65849449845837, "episode_reward_min": -115.760686585663, "episode_reward_mean": 83.19941896212772, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -800.507432284949, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 195.327174769409, "predator_policy": 800.507432284949}, "policy_reward_mean": {"prey_policy": -324.1910451038693, "predator_policy": 365.79075458493304}, "custom_metrics": {}, "hist_stats": {"episode_reward": [210.06613470911142, 29.26732670183843, 0.13000000000000633, -1.8792154057172468, -30.569883430313872, -21.810578646509896, 14.030000000000005, 9.669298122353153, 118.57377279466355, 87.59570454564766, 92.24936795757574, -45.57884407886017, 7.448071486466949, 208.97346167121245, 310.65803149008065, 246.67774410947925, 0.6597754625888904, 21.572176957729923, 287.1166053699223, 2.8563049163819256, 71.32013913777958, -1.9026846673637907, 12.841835406668572, 32.38188976090731, 290.20680439018884, 115.40280512350722, 234.92137565117923, 183.1598528613757, 123.8795299305471, -3.315550256674197, 162.80103483174065, 72.464507937233, 2.4424906541753444e-15, -4.462931518080605, 60.2185539250295, 44.636000703872526, -73.26293938045258, -5.846425056325882, 24.814286893269145, -21.2563654887995, 126.3459280999988, -4.03641406824296, 78.84640083242708, 241.93534292690634, 179.90626162473907, 207.699941538083, 39.77999999999999, 18.278025444787826, 182.32388197490533, -115.760686585663, 58.16798136041649, -20.409630274686975, 318.65849449845837, 28.269999999999992, -0.08280236005689745, 53.974133060002465, 25.080000000000005, 71.96437797995787, 171.08328539897818, 30.093231493260173, 181.77623620998003, 219.4423289465997, 1.109999999999999, 98.28629555359734, 97.69928749927334, -18.19908642293364, 273.5618424550986, 195.5964448939721, 67.9948282288847, 75.27999999999999, 103.16656286330786, 0.3099999999999976, 4.0500000000000025, 243.99725334054392, 23.454828309140638, 20.014895949133564, 286.8176984382236, 2.696590844339915, 298.4841521908815, 89.80898507612795, 1.4399999999999935, 175.254581736742, 117.15213673566699, 29.340000000000018, 44.230441168141176, 155.03985534903393, 0.0999999999999952, 71.18, -20.52381971788352, 4.012520695261969, 289.5800106121707, 38.1832124989929, 152.33685458730332, 0.10000000000000342, 7.199999999999999, 116.87675684571279, 184.00933373593017, 82.80301537593147, 2.1754516819001557, 45.27767266817245], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-445.1207958065267, 32.839536931032, -401.062059743934, -307.5116524042741, -483.47358846552567, -420.96062482579555, -452.4970085380977, -493.73423203590033, -279.90039711412106, -523.4202298649464, -453.76673484261516, -278.65337838059537, -395.7389190229406, -559.55638112619, -470.74927358030544, -259.0969226145276, -330.9885889109107, -127.94336955216667, -399.38893149456857, -135.68884577890682, -223.5643910355937, -428.60857988204697, -373.70707461489053, -374.42775757127896, -339.6341742667922, -330.3942306535024, -434.8239208223464, -33.32573058782074, 155.92608140762383, 19.794986156958025, -136.53162124804754, -346.27355576566555, -493.6381732809777, -390.24826461722995, -375.2973915945929, -528.0426722358332, -39.35252917222048, -9.40486075001688, -449.92578493766064, -389.2382983190475, -271.72517957569727, -596.1907767768481, -550.6746105407185, -462.1780242226626, -462.5319098507784, -312.36881539035375, -307.7505686834473, -368.96833509027636, 122.69749690163994, -506.1314627008946, -396.74330144465256, -105.86294373972245, -343.5909737229641, 22.865462531388772, -401.5541157129537, 32.30088697773431, -17.002272053920986, -354.84141344829663, -377.84687522873054, -317.5803737461584, -527.0719309785193, -21.150241067260907, -121.52200395917218, -421.3178317733457, -800.507432284949, -458.26844244115205, -475.9655138920339, -405.1020135512229, -422.65868034913876, -641.2244998439141, -350.0750993716316, -132.9276377501653, -444.5467067216464, -439.30666956535674, -374.0819592172162, -407.48246569791985, -456.59002740008304, -447.9722855200153, -337.5466290452532, -346.3344739008557, -528.0035924304818, 10.667514942317789, -379.9743324419166, -489.89780021687505, -469.21896901859253, -153.8328176891276, -333.6412976716228, 194.06, -480.044615211452, -219.04599182710513, -49.8499363557103, -537.4583895393049, -250.3897571199177, -350.98148512405476, -496.6719990440758, -332.3625173743998, 2.0000000000000013, -492.987932479107, -399.52626039193865, -485.0382839742664, -262.819922990243, -515.1799014798705, -362.79180878507236, -437.73001076763245, -467.5559490474904, 185.94542987494373, -478.6283932217036, -298.8627176003405, -420.9782724388427, -438.75243195241404, -221.95661962785871, -417.5197920737237, -716.6531690036411, -335.6862522864529, -406.8498383940166, -351.15592923075286, -421.90981177168237, 2.0000000000000013, -358.03428111141943, -252.0877165257184, 175.73792485726221, -593.537947523647, -128.46680570070907, -344.7292171799254, -420.6133638796572, -468.32433118859205, -258.10699149378274, -451.4972105543936, -107.88767137243778, -374.5719759089611, -261.5060788087769, -342.2996691555022, -265.916287013945, 137.77532182944844, 185.62372718915003, -545.772731564597, -466.3965784391566, -131.13988670376008, -185.07665272270503, -454.1373454787107, -171.62226549307707, -128.11468673332985, -289.86963190236133, -568.5673608251211, -416.2346615663842, -472.6269844207777, 13.005312362220735, -232.97787041144647, -351.3097821592239, -302.80734155461266, -363.45951776821283, -486.68254644295916, -420.84194178700375, 195.327174769409, -523.6378744864835, -286.70370585711123, 179.60596229229304, -380.47115174269356, -416.2619679471038, -321.9379089719705, -543.7678589981838, -320.38290998315125, -563.6893065387676, -138.6695515109734, -430.5258335008864, -103.57002251169313, -276.37274330408854, -414.6508710229064, -515.9741559015591, -8.022843145627427, -27.4194211517292, -514.6462762312805, -431.1869952161967, -504.5130980494363, -208.14491687533382, -552.2619791056588, -312.8377317907521, -382.6576858204727, -395.58811066972805, -517.3120469106963, -383.67835713348876, 46.175177016859124, -279.00875428004827, -485.8407990421898, -115.97773485935267, -661.583752922923, -509.65448367461585, -473.34585351014397, -363.34474537497357, -373.47865346852785, -344.7647578334195, -92.30252560797166, -201.82960375437798, -290.74848359465346, -337.8227711146259, -368.07858852651583, -367.9590675669667, -432.9751172993683, -360.13789294141725, -298.7585333731425], "policy_predator_policy_reward": [461.82591963053227, 160.52147395407394, 434.27595484296893, 303.5650840070774, 483.49358846552565, 421.07062482579545, 449.9418163866676, 494.4102087816131, 528.225210845128, 244.5255327036254, 384.6695498873714, 325.93998468932983, 409.73891902294065, 559.58638112619, 435.9822518711998, 303.5332424459863, 129.7378930653301, 447.7678381924105, 387.79655276921017, 234.876929049912, 361.7437601058416, 382.67857876937484, 320.18717408798284, 382.3688140193266, 132.53348635505444, 544.9429900517064, 424.2230463311827, 252.9000667501969, 134.9369639254988, 0.0, 376.25638708949685, 353.22653403369554, 425.33035818377783, 459.2158551770188, 460.19901928788033, 464.7132215002757, 151.84035298099886, 184.03364231116092, 441.2972004054868, 400.72318776760295, 445.009947382538, 494.2261481077862, 554.750728495021, 456.1992216009962, 457.78635796964534, 329.9562026781552, 332.09245844435446, 377.0083350902763, 346.46106446133365, 327.1797057281097, 215.05281992808895, 402.9562303797931, 244.93448933031644, 310.7123975124381, 378.9420313289356, 173.47105026765968, 241.59700977727536, 254.12620565548892, 256.28973298275145, 435.821965735464, 441.74633724260605, 269.2768696349153, 386.5606612803198, 228.7436823894307, 800.507432284949, 458.26844244115205, 479.97653633837757, 396.62805958679843, 561.145024168714, 562.9567099493685, 169.7965776664665, 357.84216015920197, 370.51298582815315, 440.07745107839753, 449.10693691173367, 326.61106294707565, 488.0181212533747, 441.35847855999253, 308.4357868524516, 354.1889506048575, 269.87049140425916, 373.81151418390454, 388.11775366769103, 477.71796492285745, 429.75705556307236, 272.14113197707394, 327.16301951609404, 54.35362108243528, 487.39614045395604, 391.60072820934005, 311.5780206422826, 483.43024679081554, 289.5997571199177, 351.55148512405424, 492.9310745016171, 354.3814673616462, 238.15243169242837, 435.1593827615839, 295.96699127844346, 472.836866502099, 440.31274377474585, 395.85506205578343, 491.3388764277158, 288.7733128503014, 302.50233772422644, 297.76667594677866, 480.68839322170356, 325.0727176003404, 422.9755573215719, 436.672344709628, 332.0253641082359, 361.42518065334843, 716.6531690036411, 360.7662522864528, 397.7452188290675, 432.22492677565987, 259.58103848120254, 331.41205868945804, 316.0955249058064, 324.1197042245914, 6.038311352717802, 593.537947523647, 432.9487129571712, 259.68963887006305, 421.6233638796572, 468.424331188592, 415.935949249686, 391.95454835208744, 160.416958871711, 419.74197590896097, 229.93396778225969, 355.67269375908586, 241.65262539190988, 160.05018224768537, 0.8527177048220187, 554.8927315645969, 234.1238540969188, 431.40743927488137, 256.34665272270485, 458.1473454787107, 347.9714716947474, 54.932043394966826, 290.1796319023612, 568.5673608251211, 420.27466156638417, 472.6369844207777, 193.57058225544435, 270.3992291343252, 329.22197108759013, 348.34998093538724, 514.4204984273877, 355.7364617329172, 351.89241053361224, 160.44005492220603, 523.8096615306542, 289.22850965728003, 237.47284350104252, 261.87649814023933, 397.74457427312075, 430.2642877220814, 544.9778589981836, 320.6129099831512, 374.8298658033897, 502.7835739830917, 250.22041337572153, 401.02757937252534, 305.6327433040887, 414.73087102290634, 496.8013432309348, 71.4260969843927, 447.83251607221615, 249.27303665982762, 431.25699521619663, 504.5430980494363, 279.2549168753337, 552.3319791056588, 281.0954384023763, 393.87615949096465, 397.3774314641968, 519.5352468114894, 304.88812857828253, 322.19506215051786, 422.4174136081261, 380.6153522131045, 374.0216497015805, 555.8766926679989, 509.6944836746158, 473.4058535101439, 370.42474537497355, 373.59865346852786, 223.04739210789594, 330.8966481792086, 450.9446344786233, 225.64278660633818, 471.4284163376401, 317.275958679433, 367.9890675669667, 435.12056898126855, 447.09693841415606, 257.07716056857606]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.3342894145985555, "mean_inference_ms": 57.46062749841527, "mean_action_processing_ms": 0.2526977603256142, "mean_env_wait_ms": 8.33747721483202, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007204174995422363, "StateBufferConnector_ms": 0.004701375961303711, "ViewRequirementAgentConnector_ms": 0.11859524250030518}, "num_episodes": 18, "episode_return_max": 318.65849449845837, "episode_return_min": -115.760686585663, "episode_return_mean": 83.19941896212772, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 768000, "num_agent_steps_trained": 768000, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 27.278378269147446, "num_env_steps_trained_throughput_per_sec": 27.278378269147446, "timesteps_total": 192000, "num_env_steps_sampled_lifetime": 192000, "num_agent_steps_sampled_lifetime": 768000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 768000, "timers": {"training_iteration_time_ms": 1423494.369, "restore_workers_time_ms": 0.014, "training_step_time_ms": 1423494.292, "sample_time_ms": 2092.089, "learn_time_ms": 1421382.405, "learn_throughput": 2.814, "synch_weights_time_ms": 16.766}, "counters": {"num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 768000, "num_agent_steps_trained": 768000}, "done": false, "training_iteration": 48, "trial_id": "b941d_00000", "date": "2024-08-18_06-29-32", "timestamp": 1723942772, "time_this_iter_s": 146.6731081008911, "time_total_s": 81336.15654087067, "pid": 81115, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[32, [4, 4], 2], [64, [3, 3], 2], [128, [3, 3], 1]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [256, 256], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b0436310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 81336.15654087067, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 33.485645933014354, "ram_util_percent": 81.3933014354067}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 11.237860819650075, "cur_kl_coeff": 1.5187500000000005, "cur_lr": 0.00010000000000000003, "total_loss": 8.503640015667708, "policy_loss": -0.08576282035046942, "vf_loss": 8.566451880288502, "vf_explained_var": 0.2018774272588195, "kl": 0.015111733026585878, "entropy": 0.9907983980796955, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 91665.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 11.578369365987324, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.00010000000000000003, "total_loss": 9.158011654445103, "policy_loss": -0.09007352044800956, "vf_loss": 9.228661080012246, "vf_explained_var": -0.33378831520282404, "kl": 0.019184285685777767, "entropy": 0.7903209126500226, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 91665.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_agent_steps_sampled": 784000, "num_agent_steps_trained": 784000}, "env_runners": {"episode_reward_max": 349.8861104663574, "episode_reward_min": -115.760686585663, "episode_reward_mean": 86.26482323905925, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -800.507432284949, "predator_policy": 0.8527177048220187}, "policy_reward_max": {"prey_policy": 195.327174769409, "predator_policy": 800.507432284949}, "policy_reward_mean": {"prey_policy": -322.03410511881685, "predator_policy": 365.16651673834644}, "custom_metrics": {}, "hist_stats": {"episode_reward": [12.841835406668572, 32.38188976090731, 290.20680439018884, 115.40280512350722, 234.92137565117923, 183.1598528613757, 123.8795299305471, -3.315550256674197, 162.80103483174065, 72.464507937233, 2.4424906541753444e-15, -4.462931518080605, 60.2185539250295, 44.636000703872526, -73.26293938045258, -5.846425056325882, 24.814286893269145, -21.2563654887995, 126.3459280999988, -4.03641406824296, 78.84640083242708, 241.93534292690634, 179.90626162473907, 207.699941538083, 39.77999999999999, 18.278025444787826, 182.32388197490533, -115.760686585663, 58.16798136041649, -20.409630274686975, 318.65849449845837, 28.269999999999992, -0.08280236005689745, 53.974133060002465, 25.080000000000005, 71.96437797995787, 171.08328539897818, 30.093231493260173, 181.77623620998003, 219.4423289465997, 1.109999999999999, 98.28629555359734, 97.69928749927334, -18.19908642293364, 273.5618424550986, 195.5964448939721, 67.9948282288847, 75.27999999999999, 103.16656286330786, 0.3099999999999976, 4.0500000000000025, 243.99725334054392, 23.454828309140638, 20.014895949133564, 286.8176984382236, 2.696590844339915, 298.4841521908815, 89.80898507612795, 1.4399999999999935, 175.254581736742, 117.15213673566699, 29.340000000000018, 44.230441168141176, 155.03985534903393, 0.0999999999999952, 71.18, -20.52381971788352, 4.012520695261969, 289.5800106121707, 38.1832124989929, 152.33685458730332, 0.10000000000000342, 7.199999999999999, 116.87675684571279, 184.00933373593017, 82.80301537593147, 2.1754516819001557, 45.27767266817245, 252.44107849347358, 110.36852242861364, 17.1, 3.179999999999998, 182.0340631342046, -31.780572157331168, 349.8861104663574, -20.214143222612098, 1.159999999999998, 1.2443317176264501, 45.118104384535286, 55.80642710799742, 250.7530972241117, 343.565333163693, 30.83246934067445, 65.59369110590731, 57.549480914704375, 58.57395620843898, 90.89823105802377, 0.15000000000000124, 58.62539921072708, 0.7775563180772034], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-462.5319098507784, -312.36881539035375, -307.7505686834473, -368.96833509027636, 122.69749690163994, -506.1314627008946, -396.74330144465256, -105.86294373972245, -343.5909737229641, 22.865462531388772, -401.5541157129537, 32.30088697773431, -17.002272053920986, -354.84141344829663, -377.84687522873054, -317.5803737461584, -527.0719309785193, -21.150241067260907, -121.52200395917218, -421.3178317733457, -800.507432284949, -458.26844244115205, -475.9655138920339, -405.1020135512229, -422.65868034913876, -641.2244998439141, -350.0750993716316, -132.9276377501653, -444.5467067216464, -439.30666956535674, -374.0819592172162, -407.48246569791985, -456.59002740008304, -447.9722855200153, -337.5466290452532, -346.3344739008557, -528.0035924304818, 10.667514942317789, -379.9743324419166, -489.89780021687505, -469.21896901859253, -153.8328176891276, -333.6412976716228, 194.06, -480.044615211452, -219.04599182710513, -49.8499363557103, -537.4583895393049, -250.3897571199177, -350.98148512405476, -496.6719990440758, -332.3625173743998, 2.0000000000000013, -492.987932479107, -399.52626039193865, -485.0382839742664, -262.819922990243, -515.1799014798705, -362.79180878507236, -437.73001076763245, -467.5559490474904, 185.94542987494373, -478.6283932217036, -298.8627176003405, -420.9782724388427, -438.75243195241404, -221.95661962785871, -417.5197920737237, -716.6531690036411, -335.6862522864529, -406.8498383940166, -351.15592923075286, -421.90981177168237, 2.0000000000000013, -358.03428111141943, -252.0877165257184, 175.73792485726221, -593.537947523647, -128.46680570070907, -344.7292171799254, -420.6133638796572, -468.32433118859205, -258.10699149378274, -451.4972105543936, -107.88767137243778, -374.5719759089611, -261.5060788087769, -342.2996691555022, -265.916287013945, 137.77532182944844, 185.62372718915003, -545.772731564597, -466.3965784391566, -131.13988670376008, -185.07665272270503, -454.1373454787107, -171.62226549307707, -128.11468673332985, -289.86963190236133, -568.5673608251211, -416.2346615663842, -472.6269844207777, 13.005312362220735, -232.97787041144647, -351.3097821592239, -302.80734155461266, -363.45951776821283, -486.68254644295916, -420.84194178700375, 195.327174769409, -523.6378744864835, -286.70370585711123, 179.60596229229304, -380.47115174269356, -416.2619679471038, -321.9379089719705, -543.7678589981838, -320.38290998315125, -563.6893065387676, -138.6695515109734, -430.5258335008864, -103.57002251169313, -276.37274330408854, -414.6508710229064, -515.9741559015591, -8.022843145627427, -27.4194211517292, -514.6462762312805, -431.1869952161967, -504.5130980494363, -208.14491687533382, -552.2619791056588, -312.8377317907521, -382.6576858204727, -395.58811066972805, -517.3120469106963, -383.67835713348876, 46.175177016859124, -279.00875428004827, -485.8407990421898, -115.97773485935267, -661.583752922923, -509.65448367461585, -473.34585351014397, -363.34474537497357, -373.47865346852785, -344.7647578334195, -92.30252560797166, -201.82960375437798, -290.74848359465346, -337.8227711146259, -368.07858852651583, -367.9590675669667, -432.9751172993683, -360.13789294141725, -298.7585333731425, -553.3217967194136, -44.10714965983408, -22.213208468429794, -430.41811387079747, -369.53387996168976, -373.86721045082805, -350.02353431975956, -488.5627625881642, -372.7290538588269, -282.3039468166981, -408.90133044501874, -307.0367714295657, 115.75033371827482, -574.2587371267492, -476.638710104924, -224.60463337325513, -486.53604768532523, -328.5842291755236, -595.905047662039, -329.0687660186906, -370.3714272648595, -334.122561567249, -288.80247764222906, -313.041381537169, -373.80865621155533, 113.54257740322981, -39.349506384982696, 148.99639478826612, -322.15066763301934, -318.5085184978303, -233.27774522889047, -346.4957510325382, -342.98638134608854, -621.6361553252692, -373.60354352941056, -377.72146886131515, -129.85263923329677, -185.07344366809076, -440.6388026164198, -411.5515946550704, -345.5520921058679, -467.43084751719516, -460.2489202836147, -419.96072910052067], "policy_predator_policy_reward": [457.78635796964534, 329.9562026781552, 332.09245844435446, 377.0083350902763, 346.46106446133365, 327.1797057281097, 215.05281992808895, 402.9562303797931, 244.93448933031644, 310.7123975124381, 378.9420313289356, 173.47105026765968, 241.59700977727536, 254.12620565548892, 256.28973298275145, 435.821965735464, 441.74633724260605, 269.2768696349153, 386.5606612803198, 228.7436823894307, 800.507432284949, 458.26844244115205, 479.97653633837757, 396.62805958679843, 561.145024168714, 562.9567099493685, 169.7965776664665, 357.84216015920197, 370.51298582815315, 440.07745107839753, 449.10693691173367, 326.61106294707565, 488.0181212533747, 441.35847855999253, 308.4357868524516, 354.1889506048575, 269.87049140425916, 373.81151418390454, 388.11775366769103, 477.71796492285745, 429.75705556307236, 272.14113197707394, 327.16301951609404, 54.35362108243528, 487.39614045395604, 391.60072820934005, 311.5780206422826, 483.43024679081554, 289.5997571199177, 351.55148512405424, 492.9310745016171, 354.3814673616462, 238.15243169242837, 435.1593827615839, 295.96699127844346, 472.836866502099, 440.31274377474585, 395.85506205578343, 491.3388764277158, 288.7733128503014, 302.50233772422644, 297.76667594677866, 480.68839322170356, 325.0727176003404, 422.9755573215719, 436.672344709628, 332.0253641082359, 361.42518065334843, 716.6531690036411, 360.7662522864528, 397.7452188290675, 432.22492677565987, 259.58103848120254, 331.41205868945804, 316.0955249058064, 324.1197042245914, 6.038311352717802, 593.537947523647, 432.9487129571712, 259.68963887006305, 421.6233638796572, 468.424331188592, 415.935949249686, 391.95454835208744, 160.416958871711, 419.74197590896097, 229.93396778225969, 355.67269375908586, 241.65262539190988, 160.05018224768537, 0.8527177048220187, 554.8927315645969, 234.1238540969188, 431.40743927488137, 256.34665272270485, 458.1473454787107, 347.9714716947474, 54.932043394966826, 290.1796319023612, 568.5673608251211, 420.27466156638417, 472.6369844207777, 193.57058225544435, 270.3992291343252, 329.22197108759013, 348.34998093538724, 514.4204984273877, 355.7364617329172, 351.89241053361224, 160.44005492220603, 523.8096615306542, 289.22850965728003, 237.47284350104252, 261.87649814023933, 397.74457427312075, 430.2642877220814, 544.9778589981836, 320.6129099831512, 374.8298658033897, 502.7835739830917, 250.22041337572153, 401.02757937252534, 305.6327433040887, 414.73087102290634, 496.8013432309348, 71.4260969843927, 447.83251607221615, 249.27303665982762, 431.25699521619663, 504.5430980494363, 279.2549168753337, 552.3319791056588, 281.0954384023763, 393.87615949096465, 397.3774314641968, 519.5352468114894, 304.88812857828253, 322.19506215051786, 422.4174136081261, 380.6153522131045, 374.0216497015805, 555.8766926679989, 509.6944836746158, 473.4058535101439, 370.42474537497355, 373.59865346852786, 223.04739210789594, 330.8966481792086, 450.9446344786233, 225.64278660633818, 471.4284163376401, 317.275958679433, 367.9890675669667, 435.12056898126855, 447.09693841415606, 257.07716056857606, 478.9480621931396, 370.92196267958167, 283.49644664793834, 279.50339811990216, 386.6038799616897, 373.897210450828, 353.1035343197596, 488.66276258816424, 436.02745822175206, 401.0396055879775, 402.1886222373914, 281.96890747986185, 280.36536147897664, 528.0291523958555, 346.9571051869826, 334.0720950685849, 487.64604768532513, 328.6342291755236, 595.905047662039, 330.31309773631693, 382.61378181303655, 366.9983114036069, 366.6724082075113, 290.97787807988374, 213.0755317283809, 297.9436443040556, 158.26832745745568, 75.65011730295411, 324.6467458793811, 346.84490959214287, 303.5292688217622, 341.83791854557427, 492.89827960110705, 529.2737379849543, 358.63302686452454, 451.2659417346401, 222.72586882425423, 183.09844513515588, 440.6688026164198, 411.6715946550703, 547.4799612403971, 324.1283775933931, 506.6007890039142, 374.3864166982984]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.468640681244624, "mean_inference_ms": 55.71505645997209, "mean_action_processing_ms": 0.25345349374036963, "mean_env_wait_ms": 8.871668279421002, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00860595703125, "StateBufferConnector_ms": 0.004772543907165527, "ViewRequirementAgentConnector_ms": 0.12540769577026367}, "num_episodes": 22, "episode_return_max": 349.8861104663574, "episode_return_min": -115.760686585663, "episode_return_mean": 86.26482323905925, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 784000, "num_agent_steps_trained": 784000, "num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 29.463643413924512, "num_env_steps_trained_throughput_per_sec": 29.463643413924512, "timesteps_total": 196000, "num_env_steps_sampled_lifetime": 196000, "num_agent_steps_sampled_lifetime": 784000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 784000, "timers": {"training_iteration_time_ms": 1118704.766, "restore_workers_time_ms": 0.015, "training_step_time_ms": 1118704.69, "sample_time_ms": 2153.187, "learn_time_ms": 1116532.161, "learn_throughput": 3.583, "synch_weights_time_ms": 16.237}, "counters": {"num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_agent_steps_sampled": 784000, "num_agent_steps_trained": 784000}, "done": false, "training_iteration": 49, "trial_id": "b941d_00000", "date": "2024-08-18_06-31-48", "timestamp": 1723942908, "time_this_iter_s": 135.79600286483765, "time_total_s": 81471.9525437355, "pid": 81115, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[32, [4, 4], 2], [64, [3, 3], 2], [128, [3, 3], 1]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [256, 256], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2966b80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 81471.9525437355, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 27.256994818652846, "ram_util_percent": 81.10880829015544}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 14.082393042246501, "cur_kl_coeff": 1.5187500000000005, "cur_lr": 0.00010000000000000003, "total_loss": 7.525871756720164, "policy_loss": -0.08285621914140406, "vf_loss": 7.586347955875296, "vf_explained_var": 0.397940675669877, "kl": 0.014735813451058465, "entropy": 0.9851717773253325, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 93555.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.187016707753378, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.00010000000000000003, "total_loss": 8.390666849146445, "policy_loss": -0.07941994466079724, "vf_loss": 8.452243948739673, "vf_explained_var": 0.028061844211406808, "kl": 0.017622585264022, "entropy": 0.8073170397332106, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 93555.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_agent_steps_sampled": 800000, "num_agent_steps_trained": 800000}, "env_runners": {"episode_reward_max": 349.8861104663574, "episode_reward_min": -115.760686585663, "episode_reward_mean": 90.85104176330601, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -716.6531690036411, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 195.327174769409, "predator_policy": 716.6531690036411}, "policy_reward_mean": {"prey_policy": -315.83862045338594, "predator_policy": 361.26414133503874}, "custom_metrics": {}, "hist_stats": {"episode_reward": [207.699941538083, 39.77999999999999, 18.278025444787826, 182.32388197490533, -115.760686585663, 58.16798136041649, -20.409630274686975, 318.65849449845837, 28.269999999999992, -0.08280236005689745, 53.974133060002465, 25.080000000000005, 71.96437797995787, 171.08328539897818, 30.093231493260173, 181.77623620998003, 219.4423289465997, 1.109999999999999, 98.28629555359734, 97.69928749927334, -18.19908642293364, 273.5618424550986, 195.5964448939721, 67.9948282288847, 75.27999999999999, 103.16656286330786, 0.3099999999999976, 4.0500000000000025, 243.99725334054392, 23.454828309140638, 20.014895949133564, 286.8176984382236, 2.696590844339915, 298.4841521908815, 89.80898507612795, 1.4399999999999935, 175.254581736742, 117.15213673566699, 29.340000000000018, 44.230441168141176, 155.03985534903393, 0.0999999999999952, 71.18, -20.52381971788352, 4.012520695261969, 289.5800106121707, 38.1832124989929, 152.33685458730332, 0.10000000000000342, 7.199999999999999, 116.87675684571279, 184.00933373593017, 82.80301537593147, 2.1754516819001557, 45.27767266817245, 252.44107849347358, 110.36852242861364, 17.1, 3.179999999999998, 182.0340631342046, -31.780572157331168, 349.8861104663574, -20.214143222612098, 1.159999999999998, 1.2443317176264501, 45.118104384535286, 55.80642710799742, 250.7530972241117, 343.565333163693, 30.83246934067445, 65.59369110590731, 57.549480914704375, 58.57395620843898, 90.89823105802377, 0.15000000000000124, 58.62539921072708, 0.7775563180772034, 2.0699999999999914, 59.99727301847189, 170.0475049653074, 12.259999999999994, 0.1600000000000006, 33.90675686780334, 11.621275602182163, 257.3692876996083, 348.8606137359012, 148.3077896256219, 118.4152837934255, 125.48877921018224, 137.041434530903, 182.82213158786794, 45.036399408787915, 0.06999999999999673, 127.63863378330916, 30.826937723415828, 44.60678719858358, -11.159313292665477, 175.588334615146, 19.015517208797817, 291.21221027303676], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-49.8499363557103, -537.4583895393049, -250.3897571199177, -350.98148512405476, -496.6719990440758, -332.3625173743998, 2.0000000000000013, -492.987932479107, -399.52626039193865, -485.0382839742664, -262.819922990243, -515.1799014798705, -362.79180878507236, -437.73001076763245, -467.5559490474904, 185.94542987494373, -478.6283932217036, -298.8627176003405, -420.9782724388427, -438.75243195241404, -221.95661962785871, -417.5197920737237, -716.6531690036411, -335.6862522864529, -406.8498383940166, -351.15592923075286, -421.90981177168237, 2.0000000000000013, -358.03428111141943, -252.0877165257184, 175.73792485726221, -593.537947523647, -128.46680570070907, -344.7292171799254, -420.6133638796572, -468.32433118859205, -258.10699149378274, -451.4972105543936, -107.88767137243778, -374.5719759089611, -261.5060788087769, -342.2996691555022, -265.916287013945, 137.77532182944844, 185.62372718915003, -545.772731564597, -466.3965784391566, -131.13988670376008, -185.07665272270503, -454.1373454787107, -171.62226549307707, -128.11468673332985, -289.86963190236133, -568.5673608251211, -416.2346615663842, -472.6269844207777, 13.005312362220735, -232.97787041144647, -351.3097821592239, -302.80734155461266, -363.45951776821283, -486.68254644295916, -420.84194178700375, 195.327174769409, -523.6378744864835, -286.70370585711123, 179.60596229229304, -380.47115174269356, -416.2619679471038, -321.9379089719705, -543.7678589981838, -320.38290998315125, -563.6893065387676, -138.6695515109734, -430.5258335008864, -103.57002251169313, -276.37274330408854, -414.6508710229064, -515.9741559015591, -8.022843145627427, -27.4194211517292, -514.6462762312805, -431.1869952161967, -504.5130980494363, -208.14491687533382, -552.2619791056588, -312.8377317907521, -382.6576858204727, -395.58811066972805, -517.3120469106963, -383.67835713348876, 46.175177016859124, -279.00875428004827, -485.8407990421898, -115.97773485935267, -661.583752922923, -509.65448367461585, -473.34585351014397, -363.34474537497357, -373.47865346852785, -344.7647578334195, -92.30252560797166, -201.82960375437798, -290.74848359465346, -337.8227711146259, -368.07858852651583, -367.9590675669667, -432.9751172993683, -360.13789294141725, -298.7585333731425, -553.3217967194136, -44.10714965983408, -22.213208468429794, -430.41811387079747, -369.53387996168976, -373.86721045082805, -350.02353431975956, -488.5627625881642, -372.7290538588269, -282.3039468166981, -408.90133044501874, -307.0367714295657, 115.75033371827482, -574.2587371267492, -476.638710104924, -224.60463337325513, -486.53604768532523, -328.5842291755236, -595.905047662039, -329.0687660186906, -370.3714272648595, -334.122561567249, -288.80247764222906, -313.041381537169, -373.80865621155533, 113.54257740322981, -39.349506384982696, 148.99639478826612, -322.15066763301934, -318.5085184978303, -233.27774522889047, -346.4957510325382, -342.98638134608854, -621.6361553252692, -373.60354352941056, -377.72146886131515, -129.85263923329677, -185.07344366809076, -440.6388026164198, -411.5515946550704, -345.5520921058679, -467.43084751719516, -460.2489202836147, -419.96072910052067, 2.0000000000000013, -463.6296052434173, -324.71349250038105, 2.0000000000000013, 29.01717154362727, -126.96860363114922, -426.15914600584955, -284.53813862677265, -466.0116229762955, -420.0110549634967, -172.8484209864144, -502.26838574626817, -378.38721569012233, -421.35162104914997, 144.31748222929232, -116.63158455538456, -461.447170558965, 189.16558937791854, -17.117215103140293, -528.3671167766281, -341.6703018101666, -235.21103583601592, -542.8192627327692, -235.55971256681556, -619.7285175747465, -35.07929906197456, -514.5636988530233, -142.98873876118074, -415.3663959024885, -372.98699047142907, -375.6872468746484, -634.2968460997627, -546.7141055028864, -155.1672727351358, -558.7598921940861, -286.4465197252752, -396.4206779959082, -168.96369945614694, -405.3240146709023, -306.5416283073169, -14.228355427101611, -392.2170804067976, -392.4145198360587, -560.4084081789417, -510.2525622668996, 167.36990729918068], "policy_predator_policy_reward": [311.5780206422826, 483.43024679081554, 289.5997571199177, 351.55148512405424, 492.9310745016171, 354.3814673616462, 238.15243169242837, 435.1593827615839, 295.96699127844346, 472.836866502099, 440.31274377474585, 395.85506205578343, 491.3388764277158, 288.7733128503014, 302.50233772422644, 297.76667594677866, 480.68839322170356, 325.0727176003404, 422.9755573215719, 436.672344709628, 332.0253641082359, 361.42518065334843, 716.6531690036411, 360.7662522864528, 397.7452188290675, 432.22492677565987, 259.58103848120254, 331.41205868945804, 316.0955249058064, 324.1197042245914, 6.038311352717802, 593.537947523647, 432.9487129571712, 259.68963887006305, 421.6233638796572, 468.424331188592, 415.935949249686, 391.95454835208744, 160.416958871711, 419.74197590896097, 229.93396778225969, 355.67269375908586, 241.65262539190988, 160.05018224768537, 0.8527177048220187, 554.8927315645969, 234.1238540969188, 431.40743927488137, 256.34665272270485, 458.1473454787107, 347.9714716947474, 54.932043394966826, 290.1796319023612, 568.5673608251211, 420.27466156638417, 472.6369844207777, 193.57058225544435, 270.3992291343252, 329.22197108759013, 348.34998093538724, 514.4204984273877, 355.7364617329172, 351.89241053361224, 160.44005492220603, 523.8096615306542, 289.22850965728003, 237.47284350104252, 261.87649814023933, 397.74457427312075, 430.2642877220814, 544.9778589981836, 320.6129099831512, 374.8298658033897, 502.7835739830917, 250.22041337572153, 401.02757937252534, 305.6327433040887, 414.73087102290634, 496.8013432309348, 71.4260969843927, 447.83251607221615, 249.27303665982762, 431.25699521619663, 504.5430980494363, 279.2549168753337, 552.3319791056588, 281.0954384023763, 393.87615949096465, 397.3774314641968, 519.5352468114894, 304.88812857828253, 322.19506215051786, 422.4174136081261, 380.6153522131045, 374.0216497015805, 555.8766926679989, 509.6944836746158, 473.4058535101439, 370.42474537497355, 373.59865346852786, 223.04739210789594, 330.8966481792086, 450.9446344786233, 225.64278660633818, 471.4284163376401, 317.275958679433, 367.9890675669667, 435.12056898126855, 447.09693841415606, 257.07716056857606, 478.9480621931396, 370.92196267958167, 283.49644664793834, 279.50339811990216, 386.6038799616897, 373.897210450828, 353.1035343197596, 488.66276258816424, 436.02745822175206, 401.0396055879775, 402.1886222373914, 281.96890747986185, 280.36536147897664, 528.0291523958555, 346.9571051869826, 334.0720950685849, 487.64604768532513, 328.6342291755236, 595.905047662039, 330.31309773631693, 382.61378181303655, 366.9983114036069, 366.6724082075113, 290.97787807988374, 213.0755317283809, 297.9436443040556, 158.26832745745568, 75.65011730295411, 324.6467458793811, 346.84490959214287, 303.5292688217622, 341.83791854557427, 492.89827960110705, 529.2737379849543, 358.63302686452454, 451.2659417346401, 222.72586882425423, 183.09844513515588, 440.6688026164198, 411.6715946550703, 547.4799612403971, 324.1283775933931, 506.6007890039142, 374.3864166982984, 0.0, 463.69960524341724, 126.74988114459448, 255.96088437425826, 116.45921097988465, 151.53972607294514, 428.19914600584957, 294.7581386267726, 466.11162297629545, 420.07105496349675, 206.7451778542168, 502.27838574626816, 392.3120291706293, 419.048083170825, 37.82391559775041, 191.85947442795, 307.10375419901646, 314.0384407179305, 370.72989981636323, 323.06222168902747, 354.6853542593487, 340.6112671802578, 403.71687101472475, 500.15088349504134, 368.6119333668735, 423.23731780074894, 489.6488421975511, 350.72572700452076, 402.6591006209461, 430.73068516175925, 375.75724687464833, 634.2968460997627, 532.6003597986896, 296.9196522226412, 539.8152304534213, 336.21811918935526, 392.6997910752672, 217.29137357537033, 371.3219663423595, 329.38436334319414, 276.8944671186439, 305.1393033304018, 431.36780178165515, 540.4706434421429, 455.9541039989927, 178.14076124176287]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.340212004103837, "mean_inference_ms": 54.75419739040895, "mean_action_processing_ms": 0.25415751803399006, "mean_env_wait_ms": 7.970169650781313, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009463191032409668, "StateBufferConnector_ms": 0.004719853401184082, "ViewRequirementAgentConnector_ms": 0.13075518608093262}, "num_episodes": 23, "episode_return_max": 349.8861104663574, "episode_return_min": -115.760686585663, "episode_return_mean": 90.85104176330601, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 800000, "num_agent_steps_trained": 800000, "num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 28.83856142745153, "num_env_steps_trained_throughput_per_sec": 28.83856142745153, "timesteps_total": 200000, "num_env_steps_sampled_lifetime": 200000, "num_agent_steps_sampled_lifetime": 800000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 800000, "timers": {"training_iteration_time_ms": 884095.452, "restore_workers_time_ms": 0.014, "training_step_time_ms": 884095.377, "sample_time_ms": 2170.483, "learn_time_ms": 881905.065, "learn_throughput": 4.536, "synch_weights_time_ms": 16.197}, "counters": {"num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_agent_steps_sampled": 800000, "num_agent_steps_trained": 800000}, "done": false, "training_iteration": 50, "trial_id": "b941d_00000", "date": "2024-08-18_06-34-06", "timestamp": 1723943046, "time_this_iter_s": 138.752032995224, "time_total_s": 81610.70457673073, "pid": 81115, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[32, [4, 4], 2], [64, [3, 3], 2], [128, [3, 3], 1]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [256, 256], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b295de50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 81610.70457673073, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 29.281725888324875, "ram_util_percent": 82.11725888324874}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.272420961831612, "cur_kl_coeff": 1.5187500000000005, "cur_lr": 0.00010000000000000003, "total_loss": 8.38432313500258, "policy_loss": -0.09407612932772036, "vf_loss": 8.454277942041871, "vf_explained_var": 0.37419893347397054, "kl": 0.015882359548602374, "entropy": 1.0125558613784729, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 95445.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 12.438806260199774, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.00010000000000000003, "total_loss": 9.121642443238112, "policy_loss": -0.09668997648842238, "vf_loss": 9.198398703115958, "vf_explained_var": -0.37818959803177565, "kl": 0.019687600295714144, "entropy": 0.7945791603711547, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 95445.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_agent_steps_sampled": 816000, "num_agent_steps_trained": 816000}, "env_runners": {"episode_reward_max": 349.8861104663574, "episode_reward_min": -62.293638792395924, "episode_reward_mean": 93.46506718945449, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -661.583752922923, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 195.327174769409, "predator_policy": 634.2968460997627}, "policy_reward_mean": {"prey_policy": -315.079508131122, "predator_policy": 361.8120417258491}, "custom_metrics": {}, "hist_stats": {"episode_reward": [98.28629555359734, 97.69928749927334, -18.19908642293364, 273.5618424550986, 195.5964448939721, 67.9948282288847, 75.27999999999999, 103.16656286330786, 0.3099999999999976, 4.0500000000000025, 243.99725334054392, 23.454828309140638, 20.014895949133564, 286.8176984382236, 2.696590844339915, 298.4841521908815, 89.80898507612795, 1.4399999999999935, 175.254581736742, 117.15213673566699, 29.340000000000018, 44.230441168141176, 155.03985534903393, 0.0999999999999952, 71.18, -20.52381971788352, 4.012520695261969, 289.5800106121707, 38.1832124989929, 152.33685458730332, 0.10000000000000342, 7.199999999999999, 116.87675684571279, 184.00933373593017, 82.80301537593147, 2.1754516819001557, 45.27767266817245, 252.44107849347358, 110.36852242861364, 17.1, 3.179999999999998, 182.0340631342046, -31.780572157331168, 349.8861104663574, -20.214143222612098, 1.159999999999998, 1.2443317176264501, 45.118104384535286, 55.80642710799742, 250.7530972241117, 343.565333163693, 30.83246934067445, 65.59369110590731, 57.549480914704375, 58.57395620843898, 90.89823105802377, 0.15000000000000124, 58.62539921072708, 0.7775563180772034, 2.0699999999999914, 59.99727301847189, 170.0475049653074, 12.259999999999994, 0.1600000000000006, 33.90675686780334, 11.621275602182163, 257.3692876996083, 348.8606137359012, 148.3077896256219, 118.4152837934255, 125.48877921018224, 137.041434530903, 182.82213158786794, 45.036399408787915, 0.06999999999999673, 127.63863378330916, 30.826937723415828, 44.60678719858358, -11.159313292665477, 175.588334615146, 19.015517208797817, 291.21221027303676, 5.119999999999997, 41.92033073283544, 319.9294057997014, 187.46251062772325, 208.2909473865007, 226.97314399792597, -62.293638792395924, 0.14999999999999813, 223.28909228529537, -9.919261706095135, 21.698085784158863, 1.8745251466356891, 52.08533304386326, 61.81167249424453, 169.67556294162614, 178.05707167912556, 92.63134138077481, 14.095218497951526], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-258.10699149378274, -451.4972105543936, -107.88767137243778, -374.5719759089611, -261.5060788087769, -342.2996691555022, -265.916287013945, 137.77532182944844, 185.62372718915003, -545.772731564597, -466.3965784391566, -131.13988670376008, -185.07665272270503, -454.1373454787107, -171.62226549307707, -128.11468673332985, -289.86963190236133, -568.5673608251211, -416.2346615663842, -472.6269844207777, 13.005312362220735, -232.97787041144647, -351.3097821592239, -302.80734155461266, -363.45951776821283, -486.68254644295916, -420.84194178700375, 195.327174769409, -523.6378744864835, -286.70370585711123, 179.60596229229304, -380.47115174269356, -416.2619679471038, -321.9379089719705, -543.7678589981838, -320.38290998315125, -563.6893065387676, -138.6695515109734, -430.5258335008864, -103.57002251169313, -276.37274330408854, -414.6508710229064, -515.9741559015591, -8.022843145627427, -27.4194211517292, -514.6462762312805, -431.1869952161967, -504.5130980494363, -208.14491687533382, -552.2619791056588, -312.8377317907521, -382.6576858204727, -395.58811066972805, -517.3120469106963, -383.67835713348876, 46.175177016859124, -279.00875428004827, -485.8407990421898, -115.97773485935267, -661.583752922923, -509.65448367461585, -473.34585351014397, -363.34474537497357, -373.47865346852785, -344.7647578334195, -92.30252560797166, -201.82960375437798, -290.74848359465346, -337.8227711146259, -368.07858852651583, -367.9590675669667, -432.9751172993683, -360.13789294141725, -298.7585333731425, -553.3217967194136, -44.10714965983408, -22.213208468429794, -430.41811387079747, -369.53387996168976, -373.86721045082805, -350.02353431975956, -488.5627625881642, -372.7290538588269, -282.3039468166981, -408.90133044501874, -307.0367714295657, 115.75033371827482, -574.2587371267492, -476.638710104924, -224.60463337325513, -486.53604768532523, -328.5842291755236, -595.905047662039, -329.0687660186906, -370.3714272648595, -334.122561567249, -288.80247764222906, -313.041381537169, -373.80865621155533, 113.54257740322981, -39.349506384982696, 148.99639478826612, -322.15066763301934, -318.5085184978303, -233.27774522889047, -346.4957510325382, -342.98638134608854, -621.6361553252692, -373.60354352941056, -377.72146886131515, -129.85263923329677, -185.07344366809076, -440.6388026164198, -411.5515946550704, -345.5520921058679, -467.43084751719516, -460.2489202836147, -419.96072910052067, 2.0000000000000013, -463.6296052434173, -324.71349250038105, 2.0000000000000013, 29.01717154362727, -126.96860363114922, -426.15914600584955, -284.53813862677265, -466.0116229762955, -420.0110549634967, -172.8484209864144, -502.26838574626817, -378.38721569012233, -421.35162104914997, 144.31748222929232, -116.63158455538456, -461.447170558965, 189.16558937791854, -17.117215103140293, -528.3671167766281, -341.6703018101666, -235.21103583601592, -542.8192627327692, -235.55971256681556, -619.7285175747465, -35.07929906197456, -514.5636988530233, -142.98873876118074, -415.3663959024885, -372.98699047142907, -375.6872468746484, -634.2968460997627, -546.7141055028864, -155.1672727351358, -558.7598921940861, -286.4465197252752, -396.4206779959082, -168.96369945614694, -405.3240146709023, -306.5416283073169, -14.228355427101611, -392.2170804067976, -392.4145198360587, -560.4084081789417, -510.2525622668996, 167.36990729918068, -441.83572995984565, -356.32337266557244, -304.36678020596764, -430.99911849564273, 32.76432051697056, -407.8262447728601, -398.51457453537233, 79.37545393305476, -409.3245096700779, -129.17597563722305, 0.5587504231111353, -453.3019901191826, -520.4736720876615, -409.5684980361606, -550.7560544088342, -362.9057485897921, -601.1972796199756, 162.32390548506106, -449.8167320634031, -425.7739934134195, -424.4312988320699, -361.4892765751405, -345.67471936925307, -529.4596482563026, -322.00789688054385, -510.31104471206567, -278.162074591111, -403.54821981020774, -54.11110961066266, -475.166764540277, 47.83433229863401, -310.56197733889576, -495.50524173354137, -263.9083005651385, -529.6356874586833, -365.3084541011382], "policy_predator_policy_reward": [415.935949249686, 391.95454835208744, 160.416958871711, 419.74197590896097, 229.93396778225969, 355.67269375908586, 241.65262539190988, 160.05018224768537, 0.8527177048220187, 554.8927315645969, 234.1238540969188, 431.40743927488137, 256.34665272270485, 458.1473454787107, 347.9714716947474, 54.932043394966826, 290.1796319023612, 568.5673608251211, 420.27466156638417, 472.6369844207777, 193.57058225544435, 270.3992291343252, 329.22197108759013, 348.34998093538724, 514.4204984273877, 355.7364617329172, 351.89241053361224, 160.44005492220603, 523.8096615306542, 289.22850965728003, 237.47284350104252, 261.87649814023933, 397.74457427312075, 430.2642877220814, 544.9778589981836, 320.6129099831512, 374.8298658033897, 502.7835739830917, 250.22041337572153, 401.02757937252534, 305.6327433040887, 414.73087102290634, 496.8013432309348, 71.4260969843927, 447.83251607221615, 249.27303665982762, 431.25699521619663, 504.5430980494363, 279.2549168753337, 552.3319791056588, 281.0954384023763, 393.87615949096465, 397.3774314641968, 519.5352468114894, 304.88812857828253, 322.19506215051786, 422.4174136081261, 380.6153522131045, 374.0216497015805, 555.8766926679989, 509.6944836746158, 473.4058535101439, 370.42474537497355, 373.59865346852786, 223.04739210789594, 330.8966481792086, 450.9446344786233, 225.64278660633818, 471.4284163376401, 317.275958679433, 367.9890675669667, 435.12056898126855, 447.09693841415606, 257.07716056857606, 478.9480621931396, 370.92196267958167, 283.49644664793834, 279.50339811990216, 386.6038799616897, 373.897210450828, 353.1035343197596, 488.66276258816424, 436.02745822175206, 401.0396055879775, 402.1886222373914, 281.96890747986185, 280.36536147897664, 528.0291523958555, 346.9571051869826, 334.0720950685849, 487.64604768532513, 328.6342291755236, 595.905047662039, 330.31309773631693, 382.61378181303655, 366.9983114036069, 366.6724082075113, 290.97787807988374, 213.0755317283809, 297.9436443040556, 158.26832745745568, 75.65011730295411, 324.6467458793811, 346.84490959214287, 303.5292688217622, 341.83791854557427, 492.89827960110705, 529.2737379849543, 358.63302686452454, 451.2659417346401, 222.72586882425423, 183.09844513515588, 440.6688026164198, 411.6715946550703, 547.4799612403971, 324.1283775933931, 506.6007890039142, 374.3864166982984, 0.0, 463.69960524341724, 126.74988114459448, 255.96088437425826, 116.45921097988465, 151.53972607294514, 428.19914600584957, 294.7581386267726, 466.11162297629545, 420.07105496349675, 206.7451778542168, 502.27838574626816, 392.3120291706293, 419.048083170825, 37.82391559775041, 191.85947442795, 307.10375419901646, 314.0384407179305, 370.72989981636323, 323.06222168902747, 354.6853542593487, 340.6112671802578, 403.71687101472475, 500.15088349504134, 368.6119333668735, 423.23731780074894, 489.6488421975511, 350.72572700452076, 402.6591006209461, 430.73068516175925, 375.75724687464833, 634.2968460997627, 532.6003597986896, 296.9196522226412, 539.8152304534213, 336.21811918935526, 392.6997910752672, 217.29137357537033, 371.3219663423595, 329.38436334319414, 276.8944671186439, 305.1393033304018, 431.36780178165515, 540.4706434421429, 455.9541039989927, 178.14076124176287, 443.83572995984565, 359.44337266557227, 330.0840736750136, 447.2021557594318, 375.7298481173573, 319.26148193823354, 201.65844126271404, 304.94318996732693, 326.66310937267474, 420.12832332112686, 378.84552756335256, 300.8708561306447, 493.3345330170437, 374.413998314382, 550.8360544088341, 362.9757485897921, 94.71512729420743, 567.4473391260022, 432.4840569860227, 433.18740678470436, 471.09964933230304, 336.51901185906564, 364.4334742868777, 512.5754184853138, 338.2252916686405, 546.178982967832, 341.8080779617622, 401.7138889338007, 310.2856252076384, 388.66781188492706, 151.87041788094135, 288.9142988384458, 374.1622976838707, 477.8825859955838, 456.4136468350183, 452.62571322275437]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.981550554138217, "mean_inference_ms": 54.05236496278746, "mean_action_processing_ms": 0.25451002735437805, "mean_env_wait_ms": 7.826310516879481, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009073138236999512, "StateBufferConnector_ms": 0.004870176315307617, "ViewRequirementAgentConnector_ms": 0.13095474243164062}, "num_episodes": 18, "episode_return_max": 349.8861104663574, "episode_return_min": -62.293638792395924, "episode_return_mean": 93.46506718945449, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 816000, "num_agent_steps_trained": 816000, "num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 3.785832988339631, "num_env_steps_trained_throughput_per_sec": 3.785832988339631, "timesteps_total": 204000, "num_env_steps_sampled_lifetime": 204000, "num_agent_steps_sampled_lifetime": 816000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 816000, "timers": {"training_iteration_time_ms": 618124.245, "restore_workers_time_ms": 0.015, "training_step_time_ms": 618124.161, "sample_time_ms": 2178.039, "learn_time_ms": 615924.913, "learn_throughput": 6.494, "synch_weights_time_ms": 17.127}, "counters": {"num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_agent_steps_sampled": 816000, "num_agent_steps_trained": 816000}, "done": false, "training_iteration": 51, "trial_id": "b941d_00000", "date": "2024-08-18_06-51-43", "timestamp": 1723944103, "time_this_iter_s": 1056.6663541793823, "time_total_s": 82667.37093091011, "pid": 81115, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[32, [4, 4], 2], [64, [3, 3], 2], [128, [3, 3], 1]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [256, 256], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b0403f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 82667.37093091011, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 30.046733668341705, "ram_util_percent": 81.34673366834171}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.335900557734979, "cur_kl_coeff": 1.5187500000000005, "cur_lr": 0.00010000000000000003, "total_loss": 8.351953292271448, "policy_loss": -0.08757238492995462, "vf_loss": 8.416363911906247, "vf_explained_var": 0.3587274847837983, "kl": 0.015250540159612804, "entropy": 1.0374454301501077, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 97335.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 12.875605031737575, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.00010000000000000003, "total_loss": 8.818364405253577, "policy_loss": -0.0759312489126666, "vf_loss": 8.876852277725462, "vf_explained_var": -0.09201512456570983, "kl": 0.01722804947567441, "entropy": 0.735944353745728, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 97335.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_agent_steps_sampled": 832000, "num_agent_steps_trained": 832000}, "env_runners": {"episode_reward_max": 349.8861104663574, "episode_reward_min": -62.293638792395924, "episode_reward_mean": 90.420887398788, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -673.8954109290834, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 189.16558937791854, "predator_policy": 673.9054109290834}, "policy_reward_mean": {"prey_policy": -326.73313750172196, "predator_policy": 371.9435812011159}, "custom_metrics": {}, "hist_stats": {"episode_reward": [175.254581736742, 117.15213673566699, 29.340000000000018, 44.230441168141176, 155.03985534903393, 0.0999999999999952, 71.18, -20.52381971788352, 4.012520695261969, 289.5800106121707, 38.1832124989929, 152.33685458730332, 0.10000000000000342, 7.199999999999999, 116.87675684571279, 184.00933373593017, 82.80301537593147, 2.1754516819001557, 45.27767266817245, 252.44107849347358, 110.36852242861364, 17.1, 3.179999999999998, 182.0340631342046, -31.780572157331168, 349.8861104663574, -20.214143222612098, 1.159999999999998, 1.2443317176264501, 45.118104384535286, 55.80642710799742, 250.7530972241117, 343.565333163693, 30.83246934067445, 65.59369110590731, 57.549480914704375, 58.57395620843898, 90.89823105802377, 0.15000000000000124, 58.62539921072708, 0.7775563180772034, 2.0699999999999914, 59.99727301847189, 170.0475049653074, 12.259999999999994, 0.1600000000000006, 33.90675686780334, 11.621275602182163, 257.3692876996083, 348.8606137359012, 148.3077896256219, 118.4152837934255, 125.48877921018224, 137.041434530903, 182.82213158786794, 45.036399408787915, 0.06999999999999673, 127.63863378330916, 30.826937723415828, 44.60678719858358, -11.159313292665477, 175.588334615146, 19.015517208797817, 291.21221027303676, 5.119999999999997, 41.92033073283544, 319.9294057997014, 187.46251062772325, 208.2909473865007, 226.97314399792597, -62.293638792395924, 0.14999999999999813, 223.28909228529537, -9.919261706095135, 21.698085784158863, 1.8745251466356891, 52.08533304386326, 61.81167249424453, 169.67556294162614, 178.05707167912556, 92.63134138077481, 14.095218497951526, 232.56713335675147, 0.10999999999999921, 24.19474899589924, 58.844555869622546, -24.951782998453403, -13.555102898884611, 126.18239449235399, 312.25608207803367, -4.615363319749806, 128.01999999999998, 91.48922249102951, 161.32963422660612, 0.009999999999999343, 0.08999999999999941, 55.072312561750586, 11.17764376023505, 82.12808986005486, 319.6930316776951], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-563.6893065387676, -138.6695515109734, -430.5258335008864, -103.57002251169313, -276.37274330408854, -414.6508710229064, -515.9741559015591, -8.022843145627427, -27.4194211517292, -514.6462762312805, -431.1869952161967, -504.5130980494363, -208.14491687533382, -552.2619791056588, -312.8377317907521, -382.6576858204727, -395.58811066972805, -517.3120469106963, -383.67835713348876, 46.175177016859124, -279.00875428004827, -485.8407990421898, -115.97773485935267, -661.583752922923, -509.65448367461585, -473.34585351014397, -363.34474537497357, -373.47865346852785, -344.7647578334195, -92.30252560797166, -201.82960375437798, -290.74848359465346, -337.8227711146259, -368.07858852651583, -367.9590675669667, -432.9751172993683, -360.13789294141725, -298.7585333731425, -553.3217967194136, -44.10714965983408, -22.213208468429794, -430.41811387079747, -369.53387996168976, -373.86721045082805, -350.02353431975956, -488.5627625881642, -372.7290538588269, -282.3039468166981, -408.90133044501874, -307.0367714295657, 115.75033371827482, -574.2587371267492, -476.638710104924, -224.60463337325513, -486.53604768532523, -328.5842291755236, -595.905047662039, -329.0687660186906, -370.3714272648595, -334.122561567249, -288.80247764222906, -313.041381537169, -373.80865621155533, 113.54257740322981, -39.349506384982696, 148.99639478826612, -322.15066763301934, -318.5085184978303, -233.27774522889047, -346.4957510325382, -342.98638134608854, -621.6361553252692, -373.60354352941056, -377.72146886131515, -129.85263923329677, -185.07344366809076, -440.6388026164198, -411.5515946550704, -345.5520921058679, -467.43084751719516, -460.2489202836147, -419.96072910052067, 2.0000000000000013, -463.6296052434173, -324.71349250038105, 2.0000000000000013, 29.01717154362727, -126.96860363114922, -426.15914600584955, -284.53813862677265, -466.0116229762955, -420.0110549634967, -172.8484209864144, -502.26838574626817, -378.38721569012233, -421.35162104914997, 144.31748222929232, -116.63158455538456, -461.447170558965, 189.16558937791854, -17.117215103140293, -528.3671167766281, -341.6703018101666, -235.21103583601592, -542.8192627327692, -235.55971256681556, -619.7285175747465, -35.07929906197456, -514.5636988530233, -142.98873876118074, -415.3663959024885, -372.98699047142907, -375.6872468746484, -634.2968460997627, -546.7141055028864, -155.1672727351358, -558.7598921940861, -286.4465197252752, -396.4206779959082, -168.96369945614694, -405.3240146709023, -306.5416283073169, -14.228355427101611, -392.2170804067976, -392.4145198360587, -560.4084081789417, -510.2525622668996, 167.36990729918068, -441.83572995984565, -356.32337266557244, -304.36678020596764, -430.99911849564273, 32.76432051697056, -407.8262447728601, -398.51457453537233, 79.37545393305476, -409.3245096700779, -129.17597563722305, 0.5587504231111353, -453.3019901191826, -520.4736720876615, -409.5684980361606, -550.7560544088342, -362.9057485897921, -601.1972796199756, 162.32390548506106, -449.8167320634031, -425.7739934134195, -424.4312988320699, -361.4892765751405, -345.67471936925307, -529.4596482563026, -322.00789688054385, -510.31104471206567, -278.162074591111, -403.54821981020774, -54.11110961066266, -475.166764540277, 47.83433229863401, -310.56197733889576, -495.50524173354137, -263.9083005651385, -529.6356874586833, -365.3084541011382, -337.1803880368657, 8.714423671705333, -370.23516605397566, -418.34124875570495, -512.3115627684857, -506.33056127989454, -508.3930857854098, 2.0000000000000013, -343.377561245806, -621.3389455010392, -433.47213935159965, -454.8915907394177, 17.095605326644062, -422.5727244574441, -448.8940920248023, 64.06369205926173, -651.1821316815071, -445.08392165271596, -673.8954109290834, -54.05027064659993, -307.019870380278, -286.3311609324379, -437.35890516951036, 115.32994838057698, -458.7770725326267, -640.9173486228078, -484.74990599953287, -435.04866488988597, -343.5118144325833, -280.2803400737522, -553.4141478245389, -373.1149117991955, -498.2372182528863, 2.0000000000000013, 65.373727424473, -436.24065898768544], "policy_predator_policy_reward": [374.8298658033897, 502.7835739830917, 250.22041337572153, 401.02757937252534, 305.6327433040887, 414.73087102290634, 496.8013432309348, 71.4260969843927, 447.83251607221615, 249.27303665982762, 431.25699521619663, 504.5430980494363, 279.2549168753337, 552.3319791056588, 281.0954384023763, 393.87615949096465, 397.3774314641968, 519.5352468114894, 304.88812857828253, 322.19506215051786, 422.4174136081261, 380.6153522131045, 374.0216497015805, 555.8766926679989, 509.6944836746158, 473.4058535101439, 370.42474537497355, 373.59865346852786, 223.04739210789594, 330.8966481792086, 450.9446344786233, 225.64278660633818, 471.4284163376401, 317.275958679433, 367.9890675669667, 435.12056898126855, 447.09693841415606, 257.07716056857606, 478.9480621931396, 370.92196267958167, 283.49644664793834, 279.50339811990216, 386.6038799616897, 373.897210450828, 353.1035343197596, 488.66276258816424, 436.02745822175206, 401.0396055879775, 402.1886222373914, 281.96890747986185, 280.36536147897664, 528.0291523958555, 346.9571051869826, 334.0720950685849, 487.64604768532513, 328.6342291755236, 595.905047662039, 330.31309773631693, 382.61378181303655, 366.9983114036069, 366.6724082075113, 290.97787807988374, 213.0755317283809, 297.9436443040556, 158.26832745745568, 75.65011730295411, 324.6467458793811, 346.84490959214287, 303.5292688217622, 341.83791854557427, 492.89827960110705, 529.2737379849543, 358.63302686452454, 451.2659417346401, 222.72586882425423, 183.09844513515588, 440.6688026164198, 411.6715946550703, 547.4799612403971, 324.1283775933931, 506.6007890039142, 374.3864166982984, 0.0, 463.69960524341724, 126.74988114459448, 255.96088437425826, 116.45921097988465, 151.53972607294514, 428.19914600584957, 294.7581386267726, 466.11162297629545, 420.07105496349675, 206.7451778542168, 502.27838574626816, 392.3120291706293, 419.048083170825, 37.82391559775041, 191.85947442795, 307.10375419901646, 314.0384407179305, 370.72989981636323, 323.06222168902747, 354.6853542593487, 340.6112671802578, 403.71687101472475, 500.15088349504134, 368.6119333668735, 423.23731780074894, 489.6488421975511, 350.72572700452076, 402.6591006209461, 430.73068516175925, 375.75724687464833, 634.2968460997627, 532.6003597986896, 296.9196522226412, 539.8152304534213, 336.21811918935526, 392.6997910752672, 217.29137357537033, 371.3219663423595, 329.38436334319414, 276.8944671186439, 305.1393033304018, 431.36780178165515, 540.4706434421429, 455.9541039989927, 178.14076124176287, 443.83572995984565, 359.44337266557227, 330.0840736750136, 447.2021557594318, 375.7298481173573, 319.26148193823354, 201.65844126271404, 304.94318996732693, 326.66310937267474, 420.12832332112686, 378.84552756335256, 300.8708561306447, 493.3345330170437, 374.413998314382, 550.8360544088341, 362.9757485897921, 94.71512729420743, 567.4473391260022, 432.4840569860227, 433.18740678470436, 471.09964933230304, 336.51901185906564, 364.4334742868777, 512.5754184853138, 338.2252916686405, 546.178982967832, 341.8080779617622, 401.7138889338007, 310.2856252076384, 388.66781188492706, 151.87041788094135, 288.9142988384458, 374.1622976838707, 477.8825859955838, 456.4136468350183, 452.62571322275437, 193.19485817948433, 367.8382395424278, 370.2851660539756, 418.4012487557049, 529.7724502394957, 513.0644228047839, 490.0792994009608, 75.15834225407181, 456.2447064860434, 483.5200172623485, 435.75591371867085, 439.052713473462, 109.84927532782751, 421.81023829532666, 315.4058658109007, 381.68061623267346, 645.5267683617574, 446.1239216527159, 673.9054109290834, 182.06027064659992, 480.8431146578534, 203.99713914589194, 437.4189051695103, 45.939685846029164, 458.78707253262667, 640.9173486228078, 484.77990599953284, 435.1086648898859, 354.1319340917309, 324.7325329763548, 548.6495956712978, 389.0571077126715, 241.45058400709834, 336.91472410584305, 331.2464034793155, 359.3135597615921]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.88729460085237, "mean_inference_ms": 53.13984639052134, "mean_action_processing_ms": 0.25555050336057256, "mean_env_wait_ms": 7.689323577564466, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008119821548461914, "StateBufferConnector_ms": 0.004905581474304199, "ViewRequirementAgentConnector_ms": 0.155798077583313}, "num_episodes": 18, "episode_return_max": 349.8861104663574, "episode_return_min": -62.293638792395924, "episode_return_mean": 90.420887398788, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 832000, "num_agent_steps_trained": 832000, "num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 2.8600374742286827, "num_env_steps_trained_throughput_per_sec": 2.8600374742286827, "timesteps_total": 208000, "num_env_steps_sampled_lifetime": 208000, "num_agent_steps_sampled_lifetime": 832000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 832000, "timers": {"training_iteration_time_ms": 660562.16, "restore_workers_time_ms": 0.015, "training_step_time_ms": 660562.101, "sample_time_ms": 2393.179, "learn_time_ms": 658147.616, "learn_throughput": 6.078, "synch_weights_time_ms": 16.602}, "counters": {"num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_agent_steps_sampled": 832000, "num_agent_steps_trained": 832000}, "done": false, "training_iteration": 52, "trial_id": "b941d_00000", "date": "2024-08-18_07-15-02", "timestamp": 1723945502, "time_this_iter_s": 1398.6119530200958, "time_total_s": 84065.9828839302, "pid": 81115, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[32, [4, 4], 2], [64, [3, 3], 2], [128, [3, 3], 1]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [256, 256], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b0436160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 84065.9828839302, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 31.385499999999993, "ram_util_percent": 80.1005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 11.832477743537337, "cur_kl_coeff": 1.5187500000000005, "cur_lr": 0.00010000000000000003, "total_loss": 8.456644471991, "policy_loss": -0.09015228133081957, "vf_loss": 8.523315196819407, "vf_explained_var": 0.35294370676474596, "kl": 0.015461128385910954, "entropy": 1.0231668043073523, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 99225.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 12.40516302812667, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.00010000000000000003, "total_loss": 8.904612084797451, "policy_loss": -0.08287280607677838, "vf_loss": 8.969610976163672, "vf_explained_var": -0.2473428110596995, "kl": 0.017653248493626875, "entropy": 0.7605124484294306, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 99225.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_agent_steps_sampled": 848000, "num_agent_steps_trained": 848000}, "env_runners": {"episode_reward_max": 349.8861104663574, "episode_reward_min": -62.293638792395924, "episode_reward_mean": 91.93225869607024, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -673.8954109290834, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 189.16558937791854, "predator_policy": 673.9054109290834}, "policy_reward_mean": {"prey_policy": -327.7750709642629, "predator_policy": 373.741200312298}, "custom_metrics": {}, "hist_stats": {"episode_reward": [45.27767266817245, 252.44107849347358, 110.36852242861364, 17.1, 3.179999999999998, 182.0340631342046, -31.780572157331168, 349.8861104663574, -20.214143222612098, 1.159999999999998, 1.2443317176264501, 45.118104384535286, 55.80642710799742, 250.7530972241117, 343.565333163693, 30.83246934067445, 65.59369110590731, 57.549480914704375, 58.57395620843898, 90.89823105802377, 0.15000000000000124, 58.62539921072708, 0.7775563180772034, 2.0699999999999914, 59.99727301847189, 170.0475049653074, 12.259999999999994, 0.1600000000000006, 33.90675686780334, 11.621275602182163, 257.3692876996083, 348.8606137359012, 148.3077896256219, 118.4152837934255, 125.48877921018224, 137.041434530903, 182.82213158786794, 45.036399408787915, 0.06999999999999673, 127.63863378330916, 30.826937723415828, 44.60678719858358, -11.159313292665477, 175.588334615146, 19.015517208797817, 291.21221027303676, 5.119999999999997, 41.92033073283544, 319.9294057997014, 187.46251062772325, 208.2909473865007, 226.97314399792597, -62.293638792395924, 0.14999999999999813, 223.28909228529537, -9.919261706095135, 21.698085784158863, 1.8745251466356891, 52.08533304386326, 61.81167249424453, 169.67556294162614, 178.05707167912556, 92.63134138077481, 14.095218497951526, 232.56713335675147, 0.10999999999999921, 24.19474899589924, 58.844555869622546, -24.951782998453403, -13.555102898884611, 126.18239449235399, 312.25608207803367, -4.615363319749806, 128.01999999999998, 91.48922249102951, 161.32963422660612, 0.009999999999999343, 0.08999999999999941, 55.072312561750586, 11.17764376023505, 82.12808986005486, 319.6930316776951, 1.3726593440617902, 169.5406827690502, 15.270996895758461, 89.32398371924187, 119.01782687900747, 1.8352514804546836, 214.4516202351754, 0.5268932962419219, 84.99287377010246, 38.01159133708502, 36.009648289395045, 25.118504340316683, 248.35201626243895, 2.2754202827874277, 221.34057252982143, 0.2799999999999945, 200.5421751023303, 131.9247644998569], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-360.13789294141725, -298.7585333731425, -553.3217967194136, -44.10714965983408, -22.213208468429794, -430.41811387079747, -369.53387996168976, -373.86721045082805, -350.02353431975956, -488.5627625881642, -372.7290538588269, -282.3039468166981, -408.90133044501874, -307.0367714295657, 115.75033371827482, -574.2587371267492, -476.638710104924, -224.60463337325513, -486.53604768532523, -328.5842291755236, -595.905047662039, -329.0687660186906, -370.3714272648595, -334.122561567249, -288.80247764222906, -313.041381537169, -373.80865621155533, 113.54257740322981, -39.349506384982696, 148.99639478826612, -322.15066763301934, -318.5085184978303, -233.27774522889047, -346.4957510325382, -342.98638134608854, -621.6361553252692, -373.60354352941056, -377.72146886131515, -129.85263923329677, -185.07344366809076, -440.6388026164198, -411.5515946550704, -345.5520921058679, -467.43084751719516, -460.2489202836147, -419.96072910052067, 2.0000000000000013, -463.6296052434173, -324.71349250038105, 2.0000000000000013, 29.01717154362727, -126.96860363114922, -426.15914600584955, -284.53813862677265, -466.0116229762955, -420.0110549634967, -172.8484209864144, -502.26838574626817, -378.38721569012233, -421.35162104914997, 144.31748222929232, -116.63158455538456, -461.447170558965, 189.16558937791854, -17.117215103140293, -528.3671167766281, -341.6703018101666, -235.21103583601592, -542.8192627327692, -235.55971256681556, -619.7285175747465, -35.07929906197456, -514.5636988530233, -142.98873876118074, -415.3663959024885, -372.98699047142907, -375.6872468746484, -634.2968460997627, -546.7141055028864, -155.1672727351358, -558.7598921940861, -286.4465197252752, -396.4206779959082, -168.96369945614694, -405.3240146709023, -306.5416283073169, -14.228355427101611, -392.2170804067976, -392.4145198360587, -560.4084081789417, -510.2525622668996, 167.36990729918068, -441.83572995984565, -356.32337266557244, -304.36678020596764, -430.99911849564273, 32.76432051697056, -407.8262447728601, -398.51457453537233, 79.37545393305476, -409.3245096700779, -129.17597563722305, 0.5587504231111353, -453.3019901191826, -520.4736720876615, -409.5684980361606, -550.7560544088342, -362.9057485897921, -601.1972796199756, 162.32390548506106, -449.8167320634031, -425.7739934134195, -424.4312988320699, -361.4892765751405, -345.67471936925307, -529.4596482563026, -322.00789688054385, -510.31104471206567, -278.162074591111, -403.54821981020774, -54.11110961066266, -475.166764540277, 47.83433229863401, -310.56197733889576, -495.50524173354137, -263.9083005651385, -529.6356874586833, -365.3084541011382, -337.1803880368657, 8.714423671705333, -370.23516605397566, -418.34124875570495, -512.3115627684857, -506.33056127989454, -508.3930857854098, 2.0000000000000013, -343.377561245806, -621.3389455010392, -433.47213935159965, -454.8915907394177, 17.095605326644062, -422.5727244574441, -448.8940920248023, 64.06369205926173, -651.1821316815071, -445.08392165271596, -673.8954109290834, -54.05027064659993, -307.019870380278, -286.3311609324379, -437.35890516951036, 115.32994838057698, -458.7770725326267, -640.9173486228078, -484.74990599953287, -435.04866488988597, -343.5118144325833, -280.2803400737522, -553.4141478245389, -373.1149117991955, -498.2372182528863, 2.0000000000000013, 65.373727424473, -436.24065898768544, -343.5108295023415, -449.7208167426945, -126.73279597530923, -437.3375247989036, -417.6977773093574, -375.96247002373264, 50.34167988256842, -380.16408147076385, -482.80723416646424, -138.26173509421636, -386.1262672923269, -445.00113534685795, -533.9790944461481, -199.70052892063097, -491.77900217864925, -379.5702239749438, -426.3121526007644, -180.02238462183598, -413.1210931889198, -262.27106412299213, -605.1291100769528, -165.18936984236092, -452.0145010585685, -430.116628092968, -54.973576991143574, -488.7188775583061, -452.7397061666227, -541.2811475406756, -436.87511709062153, -80.69711517888891, -386.90841779397573, -556.7255837686513, -477.82692733556553, -47.45896224223898, -168.28741204857914, -377.9701696318842], "policy_predator_policy_reward": [447.09693841415606, 257.07716056857606, 478.9480621931396, 370.92196267958167, 283.49644664793834, 279.50339811990216, 386.6038799616897, 373.897210450828, 353.1035343197596, 488.66276258816424, 436.02745822175206, 401.0396055879775, 402.1886222373914, 281.96890747986185, 280.36536147897664, 528.0291523958555, 346.9571051869826, 334.0720950685849, 487.64604768532513, 328.6342291755236, 595.905047662039, 330.31309773631693, 382.61378181303655, 366.9983114036069, 366.6724082075113, 290.97787807988374, 213.0755317283809, 297.9436443040556, 158.26832745745568, 75.65011730295411, 324.6467458793811, 346.84490959214287, 303.5292688217622, 341.83791854557427, 492.89827960110705, 529.2737379849543, 358.63302686452454, 451.2659417346401, 222.72586882425423, 183.09844513515588, 440.6688026164198, 411.6715946550703, 547.4799612403971, 324.1283775933931, 506.6007890039142, 374.3864166982984, 0.0, 463.69960524341724, 126.74988114459448, 255.96088437425826, 116.45921097988465, 151.53972607294514, 428.19914600584957, 294.7581386267726, 466.11162297629545, 420.07105496349675, 206.7451778542168, 502.27838574626816, 392.3120291706293, 419.048083170825, 37.82391559775041, 191.85947442795, 307.10375419901646, 314.0384407179305, 370.72989981636323, 323.06222168902747, 354.6853542593487, 340.6112671802578, 403.71687101472475, 500.15088349504134, 368.6119333668735, 423.23731780074894, 489.6488421975511, 350.72572700452076, 402.6591006209461, 430.73068516175925, 375.75724687464833, 634.2968460997627, 532.6003597986896, 296.9196522226412, 539.8152304534213, 336.21811918935526, 392.6997910752672, 217.29137357537033, 371.3219663423595, 329.38436334319414, 276.8944671186439, 305.1393033304018, 431.36780178165515, 540.4706434421429, 455.9541039989927, 178.14076124176287, 443.83572995984565, 359.44337266557227, 330.0840736750136, 447.2021557594318, 375.7298481173573, 319.26148193823354, 201.65844126271404, 304.94318996732693, 326.66310937267474, 420.12832332112686, 378.84552756335256, 300.8708561306447, 493.3345330170437, 374.413998314382, 550.8360544088341, 362.9757485897921, 94.71512729420743, 567.4473391260022, 432.4840569860227, 433.18740678470436, 471.09964933230304, 336.51901185906564, 364.4334742868777, 512.5754184853138, 338.2252916686405, 546.178982967832, 341.8080779617622, 401.7138889338007, 310.2856252076384, 388.66781188492706, 151.87041788094135, 288.9142988384458, 374.1622976838707, 477.8825859955838, 456.4136468350183, 452.62571322275437, 193.19485817948433, 367.8382395424278, 370.2851660539756, 418.4012487557049, 529.7724502394957, 513.0644228047839, 490.0792994009608, 75.15834225407181, 456.2447064860434, 483.5200172623485, 435.75591371867085, 439.052713473462, 109.84927532782751, 421.81023829532666, 315.4058658109007, 381.68061623267346, 645.5267683617574, 446.1239216527159, 673.9054109290834, 182.06027064659992, 480.8431146578534, 203.99713914589194, 437.4189051695103, 45.939685846029164, 458.78707253262667, 640.9173486228078, 484.77990599953284, 435.1086648898859, 354.1319340917309, 324.7325329763548, 548.6495956712978, 389.0571077126715, 241.45058400709834, 336.91472410584305, 331.2464034793155, 359.3135597615921, 343.8108295023412, 450.79347608675636, 327.57868338810005, 406.0323201551633, 546.5707725413683, 262.3604716874799, 418.2139973426199, 0.9323879648176213, 470.6406026604506, 269.44619347923737, 382.50598433008776, 450.4566697895515, 647.8033386263006, 300.32790497565355, 457.83352318670376, 414.0425962631311, 376.41649497021837, 314.9109160224844, 349.06381240069726, 364.33993624829895, 605.1925547530294, 201.1355734556791, 449.90618544361405, 457.3434480482391, 559.4235694578354, 232.6209013540529, 457.69607398584424, 538.6002000042416, 394.82473791628456, 344.08806688304696, 387.0284177939756, 556.8855837686514, 463.41460069703885, 262.41346398309565, 391.6272466667452, 286.55509951357493]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.796545084393424, "mean_inference_ms": 52.26247378735035, "mean_action_processing_ms": 0.2564939664016413, "mean_env_wait_ms": 7.557617441261017, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007568359375, "StateBufferConnector_ms": 0.0042084455490112305, "ViewRequirementAgentConnector_ms": 0.1531440019607544}, "num_episodes": 18, "episode_return_max": 349.8861104663574, "episode_return_min": -62.293638792395924, "episode_return_mean": 91.93225869607024, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 848000, "num_agent_steps_trained": 848000, "num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 4.388208888625374, "num_env_steps_trained_throughput_per_sec": 4.388208888625374, "timesteps_total": 212000, "num_env_steps_sampled_lifetime": 212000, "num_agent_steps_sampled_lifetime": 848000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 848000, "timers": {"training_iteration_time_ms": 576537.486, "restore_workers_time_ms": 0.014, "training_step_time_ms": 576537.431, "sample_time_ms": 2406.654, "learn_time_ms": 574109.075, "learn_throughput": 6.967, "synch_weights_time_ms": 16.918}, "counters": {"num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_agent_steps_sampled": 848000, "num_agent_steps_trained": 848000}, "done": false, "training_iteration": 53, "trial_id": "b941d_00000", "date": "2024-08-18_07-30-13", "timestamp": 1723946413, "time_this_iter_s": 911.5933408737183, "time_total_s": 84977.57622480392, "pid": 81115, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[32, [4, 4], 2], [64, [3, 3], 2], [128, [3, 3], 1]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [256, 256], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b04b4b80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 84977.57622480392, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 21.917989417989418, "ram_util_percent": 79.86349206349206}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.16022948108653, "cur_kl_coeff": 1.5187500000000005, "cur_lr": 0.00010000000000000003, "total_loss": 8.441461180631446, "policy_loss": -0.08544769038214649, "vf_loss": 8.503055461500058, "vf_explained_var": 0.04524720194478515, "kl": 0.015705951345525035, "entropy": 1.0013091587200367, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 101115.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 12.204056116575916, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.00010000000000000003, "total_loss": 9.022212015888678, "policy_loss": -0.07654979982987421, "vf_loss": 9.082546766472872, "vf_explained_var": -0.24018081322548882, "kl": 0.016014864714615887, "entropy": 0.7611745669412865, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 101115.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_agent_steps_sampled": 864000, "num_agent_steps_trained": 864000}, "env_runners": {"episode_reward_max": 348.8606137359012, "episode_reward_min": -62.293638792395924, "episode_reward_mean": 89.48549503006234, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -673.8954109290834, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 189.16558937791854, "predator_policy": 673.9054109290834}, "policy_reward_mean": {"prey_policy": -330.38896410486063, "predator_policy": 375.13171161989163}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.7775563180772034, 2.0699999999999914, 59.99727301847189, 170.0475049653074, 12.259999999999994, 0.1600000000000006, 33.90675686780334, 11.621275602182163, 257.3692876996083, 348.8606137359012, 148.3077896256219, 118.4152837934255, 125.48877921018224, 137.041434530903, 182.82213158786794, 45.036399408787915, 0.06999999999999673, 127.63863378330916, 30.826937723415828, 44.60678719858358, -11.159313292665477, 175.588334615146, 19.015517208797817, 291.21221027303676, 5.119999999999997, 41.92033073283544, 319.9294057997014, 187.46251062772325, 208.2909473865007, 226.97314399792597, -62.293638792395924, 0.14999999999999813, 223.28909228529537, -9.919261706095135, 21.698085784158863, 1.8745251466356891, 52.08533304386326, 61.81167249424453, 169.67556294162614, 178.05707167912556, 92.63134138077481, 14.095218497951526, 232.56713335675147, 0.10999999999999921, 24.19474899589924, 58.844555869622546, -24.951782998453403, -13.555102898884611, 126.18239449235399, 312.25608207803367, -4.615363319749806, 128.01999999999998, 91.48922249102951, 161.32963422660612, 0.009999999999999343, 0.08999999999999941, 55.072312561750586, 11.17764376023505, 82.12808986005486, 319.6930316776951, 1.3726593440617902, 169.5406827690502, 15.270996895758461, 89.32398371924187, 119.01782687900747, 1.8352514804546836, 214.4516202351754, 0.5268932962419219, 84.99287377010246, 38.01159133708502, 36.009648289395045, 25.118504340316683, 248.35201626243895, 2.2754202827874277, 221.34057252982143, 0.2799999999999945, 200.5421751023303, 131.9247644998569, 285.4266070714509, 18.9060160739224, -59.667776339871224, 153.06645766736708, 55.90938782221691, 29.54309416625013, 19.20568140815897, 5.640000000000002, 113.25542780175391, 250.09955500463852, 49.81030418984291, 0.0899999999999963, 43.33064085991965, 6.439293542825908e-15, 23.362191357554465, 72.89828303652443, 122.84545391343903, 0.24000000000000754, 103.98921663558441, 187.24549829971113, 234.30762633610567, 13.983221341956808], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-460.2489202836147, -419.96072910052067, 2.0000000000000013, -463.6296052434173, -324.71349250038105, 2.0000000000000013, 29.01717154362727, -126.96860363114922, -426.15914600584955, -284.53813862677265, -466.0116229762955, -420.0110549634967, -172.8484209864144, -502.26838574626817, -378.38721569012233, -421.35162104914997, 144.31748222929232, -116.63158455538456, -461.447170558965, 189.16558937791854, -17.117215103140293, -528.3671167766281, -341.6703018101666, -235.21103583601592, -542.8192627327692, -235.55971256681556, -619.7285175747465, -35.07929906197456, -514.5636988530233, -142.98873876118074, -415.3663959024885, -372.98699047142907, -375.6872468746484, -634.2968460997627, -546.7141055028864, -155.1672727351358, -558.7598921940861, -286.4465197252752, -396.4206779959082, -168.96369945614694, -405.3240146709023, -306.5416283073169, -14.228355427101611, -392.2170804067976, -392.4145198360587, -560.4084081789417, -510.2525622668996, 167.36990729918068, -441.83572995984565, -356.32337266557244, -304.36678020596764, -430.99911849564273, 32.76432051697056, -407.8262447728601, -398.51457453537233, 79.37545393305476, -409.3245096700779, -129.17597563722305, 0.5587504231111353, -453.3019901191826, -520.4736720876615, -409.5684980361606, -550.7560544088342, -362.9057485897921, -601.1972796199756, 162.32390548506106, -449.8167320634031, -425.7739934134195, -424.4312988320699, -361.4892765751405, -345.67471936925307, -529.4596482563026, -322.00789688054385, -510.31104471206567, -278.162074591111, -403.54821981020774, -54.11110961066266, -475.166764540277, 47.83433229863401, -310.56197733889576, -495.50524173354137, -263.9083005651385, -529.6356874586833, -365.3084541011382, -337.1803880368657, 8.714423671705333, -370.23516605397566, -418.34124875570495, -512.3115627684857, -506.33056127989454, -508.3930857854098, 2.0000000000000013, -343.377561245806, -621.3389455010392, -433.47213935159965, -454.8915907394177, 17.095605326644062, -422.5727244574441, -448.8940920248023, 64.06369205926173, -651.1821316815071, -445.08392165271596, -673.8954109290834, -54.05027064659993, -307.019870380278, -286.3311609324379, -437.35890516951036, 115.32994838057698, -458.7770725326267, -640.9173486228078, -484.74990599953287, -435.04866488988597, -343.5118144325833, -280.2803400737522, -553.4141478245389, -373.1149117991955, -498.2372182528863, 2.0000000000000013, 65.373727424473, -436.24065898768544, -343.5108295023415, -449.7208167426945, -126.73279597530923, -437.3375247989036, -417.6977773093574, -375.96247002373264, 50.34167988256842, -380.16408147076385, -482.80723416646424, -138.26173509421636, -386.1262672923269, -445.00113534685795, -533.9790944461481, -199.70052892063097, -491.77900217864925, -379.5702239749438, -426.3121526007644, -180.02238462183598, -413.1210931889198, -262.27106412299213, -605.1291100769528, -165.18936984236092, -452.0145010585685, -430.116628092968, -54.973576991143574, -488.7188775583061, -452.7397061666227, -541.2811475406756, -436.87511709062153, -80.69711517888891, -386.90841779397573, -556.7255837686513, -477.82692733556553, -47.45896224223898, -168.28741204857914, -377.9701696318842, 91.77055251867858, -398.24337293694, -320.7208889534326, -451.9570672582623, -297.17562950461667, -289.83333251419333, -329.76135752011015, -148.23088285607426, -318.7506244873735, -436.96793352744675, -467.14008270304055, -403.3384831760698, -387.2225700872991, -33.825119256148746, -301.02815989023816, -366.45894772334066, -99.00588745033883, -474.03815683530115, -192.33252290788772, -439.5921610247025, -3.1231159524971437, -534.9290278441127, -449.33276039484196, -551.5774723209585, -260.80248888719177, -206.3408032242407, -584.1020448494265, -583.6803654403467, -290.1370258390817, -467.34861364509084, -55.07756362771852, -558.4955255782085, -220.42226002557618, -388.9604571511274, -445.22206194061437, -564.8952737316492, -267.95389722824063, -78.76114287132191, -334.78137620066855, -133.1791423958759, -31.575994486993437, -478.9627217136054, -309.67494621611826, -594.787630458563], "policy_predator_policy_reward": [506.6007890039142, 374.3864166982984, 0.0, 463.69960524341724, 126.74988114459448, 255.96088437425826, 116.45921097988465, 151.53972607294514, 428.19914600584957, 294.7581386267726, 466.11162297629545, 420.07105496349675, 206.7451778542168, 502.27838574626816, 392.3120291706293, 419.048083170825, 37.82391559775041, 191.85947442795, 307.10375419901646, 314.0384407179305, 370.72989981636323, 323.06222168902747, 354.6853542593487, 340.6112671802578, 403.71687101472475, 500.15088349504134, 368.6119333668735, 423.23731780074894, 489.6488421975511, 350.72572700452076, 402.6591006209461, 430.73068516175925, 375.75724687464833, 634.2968460997627, 532.6003597986896, 296.9196522226412, 539.8152304534213, 336.21811918935526, 392.6997910752672, 217.29137357537033, 371.3219663423595, 329.38436334319414, 276.8944671186439, 305.1393033304018, 431.36780178165515, 540.4706434421429, 455.9541039989927, 178.14076124176287, 443.83572995984565, 359.44337266557227, 330.0840736750136, 447.2021557594318, 375.7298481173573, 319.26148193823354, 201.65844126271404, 304.94318996732693, 326.66310937267474, 420.12832332112686, 378.84552756335256, 300.8708561306447, 493.3345330170437, 374.413998314382, 550.8360544088341, 362.9757485897921, 94.71512729420743, 567.4473391260022, 432.4840569860227, 433.18740678470436, 471.09964933230304, 336.51901185906564, 364.4334742868777, 512.5754184853138, 338.2252916686405, 546.178982967832, 341.8080779617622, 401.7138889338007, 310.2856252076384, 388.66781188492706, 151.87041788094135, 288.9142988384458, 374.1622976838707, 477.8825859955838, 456.4136468350183, 452.62571322275437, 193.19485817948433, 367.8382395424278, 370.2851660539756, 418.4012487557049, 529.7724502394957, 513.0644228047839, 490.0792994009608, 75.15834225407181, 456.2447064860434, 483.5200172623485, 435.75591371867085, 439.052713473462, 109.84927532782751, 421.81023829532666, 315.4058658109007, 381.68061623267346, 645.5267683617574, 446.1239216527159, 673.9054109290834, 182.06027064659992, 480.8431146578534, 203.99713914589194, 437.4189051695103, 45.939685846029164, 458.78707253262667, 640.9173486228078, 484.77990599953284, 435.1086648898859, 354.1319340917309, 324.7325329763548, 548.6495956712978, 389.0571077126715, 241.45058400709834, 336.91472410584305, 331.2464034793155, 359.3135597615921, 343.8108295023412, 450.79347608675636, 327.57868338810005, 406.0323201551633, 546.5707725413683, 262.3604716874799, 418.2139973426199, 0.9323879648176213, 470.6406026604506, 269.44619347923737, 382.50598433008776, 450.4566697895515, 647.8033386263006, 300.32790497565355, 457.83352318670376, 414.0425962631311, 376.41649497021837, 314.9109160224844, 349.06381240069726, 364.33993624829895, 605.1925547530294, 201.1355734556791, 449.90618544361405, 457.3434480482391, 559.4235694578354, 232.6209013540529, 457.69607398584424, 538.6002000042416, 394.82473791628456, 344.08806688304696, 387.0284177939756, 556.8855837686514, 463.41460069703885, 262.41346398309565, 391.6272466667452, 286.55509951357493, 294.3671185098814, 297.53230897983093, 347.8393095327926, 443.7446627528248, 292.38831417012, 234.95287150881862, 330.2643451751553, 300.79435286839583, 388.87666440276644, 422.7512814342702, 461.3898671438041, 438.6317929015562, 3.2501281453752657, 437.0032426062314, 301.45815989023777, 371.66894772334047, 320.54576378703644, 365.7537083003572, 486.3430893814693, 395.68114955575913, 192.2360130940479, 395.62643489240463, 449.4027603948419, 551.5974723209584, 195.185653209803, 315.28827976154815, 584.1020448494265, 583.6803654403467, 323.71970306903427, 457.12812777269266, 177.10580318898232, 509.3655690534689, 343.61607224265435, 388.61209884748774, 445.36206194061435, 564.9952737316491, 449.75850871905953, 0.9457480160869721, 298.2573356256588, 356.9486812705962, 430.6577854273749, 314.18855710932974, 320.7052087211459, 597.7405892954919]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.686524078205229, "mean_inference_ms": 51.24848474154863, "mean_action_processing_ms": 0.25724519010697433, "mean_env_wait_ms": 7.367057765835638, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006048083305358887, "StateBufferConnector_ms": 0.0039321184158325195, "ViewRequirementAgentConnector_ms": 0.14279186725616455}, "num_episodes": 22, "episode_return_max": 348.8606137359012, "episode_return_min": -62.293638792395924, "episode_return_mean": 89.48549503006234, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 864000, "num_agent_steps_trained": 864000, "num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 2.6073283032481838, "num_env_steps_trained_throughput_per_sec": 2.6073283032481838, "timesteps_total": 216000, "num_env_steps_sampled_lifetime": 216000, "num_agent_steps_sampled_lifetime": 864000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 864000, "timers": {"training_iteration_time_ms": 667388.723, "restore_workers_time_ms": 0.014, "training_step_time_ms": 667388.669, "sample_time_ms": 2393.351, "learn_time_ms": 664973.151, "learn_throughput": 6.015, "synch_weights_time_ms": 17.359}, "counters": {"num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_agent_steps_sampled": 864000, "num_agent_steps_trained": 864000}, "done": false, "training_iteration": 54, "trial_id": "b941d_00000", "date": "2024-08-18_07-55-48", "timestamp": 1723947948, "time_this_iter_s": 1534.1759259700775, "time_total_s": 86511.752150774, "pid": 81115, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[32, [4, 4], 2], [64, [3, 3], 2], [128, [3, 3], 1]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [256, 256], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b295d550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 86511.752150774, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 24.47357512953368, "ram_util_percent": 81.79481865284974}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.516682687259856, "cur_kl_coeff": 1.5187500000000005, "cur_lr": 0.00010000000000000003, "total_loss": 8.753338444674457, "policy_loss": -0.08446629280199805, "vf_loss": 8.814640940560235, "vf_explained_var": 0.06839356788251766, "kl": 0.015251896776617431, "entropy": 1.00541252377172, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 103005.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 12.648250944147666, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.00010000000000000003, "total_loss": 8.982470670831267, "policy_loss": -0.08361428267046533, "vf_loss": 9.048611575081235, "vf_explained_var": -0.3934839219958694, "kl": 0.017257654495419085, "entropy": 0.7431870249213365, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 103005.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_agent_steps_sampled": 880000, "num_agent_steps_trained": 880000}, "env_runners": {"episode_reward_max": 319.9294057997014, "episode_reward_min": -83.82845376464707, "episode_reward_mean": 82.15416259439372, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -673.8954109290834, "predator_policy": 0.9323879648176213}, "policy_reward_max": {"prey_policy": 167.36990729918068, "predator_policy": 673.9054109290834}, "policy_reward_mean": {"prey_policy": -342.89553035385427, "predator_policy": 383.97261165105095}, "custom_metrics": {}, "hist_stats": {"episode_reward": [291.21221027303676, 5.119999999999997, 41.92033073283544, 319.9294057997014, 187.46251062772325, 208.2909473865007, 226.97314399792597, -62.293638792395924, 0.14999999999999813, 223.28909228529537, -9.919261706095135, 21.698085784158863, 1.8745251466356891, 52.08533304386326, 61.81167249424453, 169.67556294162614, 178.05707167912556, 92.63134138077481, 14.095218497951526, 232.56713335675147, 0.10999999999999921, 24.19474899589924, 58.844555869622546, -24.951782998453403, -13.555102898884611, 126.18239449235399, 312.25608207803367, -4.615363319749806, 128.01999999999998, 91.48922249102951, 161.32963422660612, 0.009999999999999343, 0.08999999999999941, 55.072312561750586, 11.17764376023505, 82.12808986005486, 319.6930316776951, 1.3726593440617902, 169.5406827690502, 15.270996895758461, 89.32398371924187, 119.01782687900747, 1.8352514804546836, 214.4516202351754, 0.5268932962419219, 84.99287377010246, 38.01159133708502, 36.009648289395045, 25.118504340316683, 248.35201626243895, 2.2754202827874277, 221.34057252982143, 0.2799999999999945, 200.5421751023303, 131.9247644998569, 285.4266070714509, 18.9060160739224, -59.667776339871224, 153.06645766736708, 55.90938782221691, 29.54309416625013, 19.20568140815897, 5.640000000000002, 113.25542780175391, 250.09955500463852, 49.81030418984291, 0.0899999999999963, 43.33064085991965, 6.439293542825908e-15, 23.362191357554465, 72.89828303652443, 122.84545391343903, 0.24000000000000754, 103.98921663558441, 187.24549829971113, 234.30762633610567, 13.983221341956808, 4.969999999999991, 0.0499999999999996, 9.290981423244247, 2.3400000000000016, 82.38897035717429, 270.84395540348316, 11.270000000000001, 4.3831152198640035, -7.461427856235174, 15.190045338267392, 85.27737550281908, 120.1331010491299, 28.63, 122.68082489366128, 8.80777510103062, 197.1202118761601, 65.31089068116036, -83.82845376464707, 50.10245977028224, -14.984250841632804, 225.76783618851348, 0.27999999999999403, 109.07232969159215], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-510.2525622668996, 167.36990729918068, -441.83572995984565, -356.32337266557244, -304.36678020596764, -430.99911849564273, 32.76432051697056, -407.8262447728601, -398.51457453537233, 79.37545393305476, -409.3245096700779, -129.17597563722305, 0.5587504231111353, -453.3019901191826, -520.4736720876615, -409.5684980361606, -550.7560544088342, -362.9057485897921, -601.1972796199756, 162.32390548506106, -449.8167320634031, -425.7739934134195, -424.4312988320699, -361.4892765751405, -345.67471936925307, -529.4596482563026, -322.00789688054385, -510.31104471206567, -278.162074591111, -403.54821981020774, -54.11110961066266, -475.166764540277, 47.83433229863401, -310.56197733889576, -495.50524173354137, -263.9083005651385, -529.6356874586833, -365.3084541011382, -337.1803880368657, 8.714423671705333, -370.23516605397566, -418.34124875570495, -512.3115627684857, -506.33056127989454, -508.3930857854098, 2.0000000000000013, -343.377561245806, -621.3389455010392, -433.47213935159965, -454.8915907394177, 17.095605326644062, -422.5727244574441, -448.8940920248023, 64.06369205926173, -651.1821316815071, -445.08392165271596, -673.8954109290834, -54.05027064659993, -307.019870380278, -286.3311609324379, -437.35890516951036, 115.32994838057698, -458.7770725326267, -640.9173486228078, -484.74990599953287, -435.04866488988597, -343.5118144325833, -280.2803400737522, -553.4141478245389, -373.1149117991955, -498.2372182528863, 2.0000000000000013, 65.373727424473, -436.24065898768544, -343.5108295023415, -449.7208167426945, -126.73279597530923, -437.3375247989036, -417.6977773093574, -375.96247002373264, 50.34167988256842, -380.16408147076385, -482.80723416646424, -138.26173509421636, -386.1262672923269, -445.00113534685795, -533.9790944461481, -199.70052892063097, -491.77900217864925, -379.5702239749438, -426.3121526007644, -180.02238462183598, -413.1210931889198, -262.27106412299213, -605.1291100769528, -165.18936984236092, -452.0145010585685, -430.116628092968, -54.973576991143574, -488.7188775583061, -452.7397061666227, -541.2811475406756, -436.87511709062153, -80.69711517888891, -386.90841779397573, -556.7255837686513, -477.82692733556553, -47.45896224223898, -168.28741204857914, -377.9701696318842, 91.77055251867858, -398.24337293694, -320.7208889534326, -451.9570672582623, -297.17562950461667, -289.83333251419333, -329.76135752011015, -148.23088285607426, -318.7506244873735, -436.96793352744675, -467.14008270304055, -403.3384831760698, -387.2225700872991, -33.825119256148746, -301.02815989023816, -366.45894772334066, -99.00588745033883, -474.03815683530115, -192.33252290788772, -439.5921610247025, -3.1231159524971437, -534.9290278441127, -449.33276039484196, -551.5774723209585, -260.80248888719177, -206.3408032242407, -584.1020448494265, -583.6803654403467, -290.1370258390817, -467.34861364509084, -55.07756362771852, -558.4955255782085, -220.42226002557618, -388.9604571511274, -445.22206194061437, -564.8952737316492, -267.95389722824063, -78.76114287132191, -334.78137620066855, -133.1791423958759, -31.575994486993437, -478.9627217136054, -309.67494621611826, -594.787630458563, -1.3426159998282867, -608.8691193804073, -516.5545562913459, -490.15501591767514, -440.4749396739272, -432.736476401271, -384.27282019364714, -373.1779907916189, -444.75537847340274, -231.54447214754327, -473.2351537695166, -50.519869474069665, -504.55820358735014, -575.3029537106735, -328.81380298274405, -369.2302318959506, -489.0791584332684, -435.3957070247017, -385.03764741413914, -457.2298530652226, -319.92927132725384, -491.8477511590775, -233.07058976706864, -499.16672196989134, -176.33945375490492, -459.3756049874834, -491.08345513153836, 2.0000000000000013, -290.0915441427659, -490.45084009318896, -356.6402010731671, -105.84914427241242, -77.63799169990673, -499.1461589608598, -506.72986035795736, -499.06172439648185, -477.6937705435149, -254.70540614615817, -354.2226087125846, -476.2145503759071, -461.65317173419106, -66.07932737523277, -507.2991251287274, -326.2082809325397, -397.16669294454255, 32.91194218862114], "policy_predator_policy_reward": [455.9541039989927, 178.14076124176287, 443.83572995984565, 359.44337266557227, 330.0840736750136, 447.2021557594318, 375.7298481173573, 319.26148193823354, 201.65844126271404, 304.94318996732693, 326.66310937267474, 420.12832332112686, 378.84552756335256, 300.8708561306447, 493.3345330170437, 374.413998314382, 550.8360544088341, 362.9757485897921, 94.71512729420743, 567.4473391260022, 432.4840569860227, 433.18740678470436, 471.09964933230304, 336.51901185906564, 364.4334742868777, 512.5754184853138, 338.2252916686405, 546.178982967832, 341.8080779617622, 401.7138889338007, 310.2856252076384, 388.66781188492706, 151.87041788094135, 288.9142988384458, 374.1622976838707, 477.8825859955838, 456.4136468350183, 452.62571322275437, 193.19485817948433, 367.8382395424278, 370.2851660539756, 418.4012487557049, 529.7724502394957, 513.0644228047839, 490.0792994009608, 75.15834225407181, 456.2447064860434, 483.5200172623485, 435.75591371867085, 439.052713473462, 109.84927532782751, 421.81023829532666, 315.4058658109007, 381.68061623267346, 645.5267683617574, 446.1239216527159, 673.9054109290834, 182.06027064659992, 480.8431146578534, 203.99713914589194, 437.4189051695103, 45.939685846029164, 458.78707253262667, 640.9173486228078, 484.77990599953284, 435.1086648898859, 354.1319340917309, 324.7325329763548, 548.6495956712978, 389.0571077126715, 241.45058400709834, 336.91472410584305, 331.2464034793155, 359.3135597615921, 343.8108295023412, 450.79347608675636, 327.57868338810005, 406.0323201551633, 546.5707725413683, 262.3604716874799, 418.2139973426199, 0.9323879648176213, 470.6406026604506, 269.44619347923737, 382.50598433008776, 450.4566697895515, 647.8033386263006, 300.32790497565355, 457.83352318670376, 414.0425962631311, 376.41649497021837, 314.9109160224844, 349.06381240069726, 364.33993624829895, 605.1925547530294, 201.1355734556791, 449.90618544361405, 457.3434480482391, 559.4235694578354, 232.6209013540529, 457.69607398584424, 538.6002000042416, 394.82473791628456, 344.08806688304696, 387.0284177939756, 556.8855837686514, 463.41460069703885, 262.41346398309565, 391.6272466667452, 286.55509951357493, 294.3671185098814, 297.53230897983093, 347.8393095327926, 443.7446627528248, 292.38831417012, 234.95287150881862, 330.2643451751553, 300.79435286839583, 388.87666440276644, 422.7512814342702, 461.3898671438041, 438.6317929015562, 3.2501281453752657, 437.0032426062314, 301.45815989023777, 371.66894772334047, 320.54576378703644, 365.7537083003572, 486.3430893814693, 395.68114955575913, 192.2360130940479, 395.62643489240463, 449.4027603948419, 551.5974723209584, 195.185653209803, 315.28827976154815, 584.1020448494265, 583.6803654403467, 323.71970306903427, 457.12812777269266, 177.10580318898232, 509.3655690534689, 343.61607224265435, 388.61209884748774, 445.36206194061435, 564.9952737316491, 449.75850871905953, 0.9457480160869721, 298.2573356256588, 356.9486812705962, 430.6577854273749, 314.18855710932974, 320.7052087211459, 597.7405892954919, 3.3126159998282594, 611.8691193804073, 516.5945562913458, 490.16501591767513, 445.62493967392703, 436.87745782451526, 384.402820193647, 375.3879907916188, 394.29235708255294, 364.3964638955676, 319.1041113348493, 475.4948673122204, 515.8282035873499, 575.3029537106735, 335.8876910253889, 366.5394590731695, 460.28787423286565, 456.72556336886885, 478.84045354561397, 378.61709227201465, 412.295260954649, 484.75913703450084, 359.641506501114, 492.7289062849745, 202.8194537549045, 461.5256049874833, 374.59504512845035, 237.16923489674954, 297.8693192437962, 491.48084009318893, 247.50384352371148, 412.1057136980278, 461.02246852149153, 181.07257282043588, 541.9962502306447, 379.96688075914767, 481.6957494597605, 300.80588700019496, 332.4830543323385, 482.9698539145205, 331.9464016386213, 421.55393365931593, 507.4791251287272, 326.3082809325396, 139.4389279688307, 333.88815247868195]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.580445983063856, "mean_inference_ms": 50.187875114008754, "mean_action_processing_ms": 0.2580114407473663, "mean_env_wait_ms": 7.245206952678079, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00494992733001709, "StateBufferConnector_ms": 0.0038346052169799805, "ViewRequirementAgentConnector_ms": 0.13427042961120605}, "num_episodes": 23, "episode_return_max": 319.9294057997014, "episode_return_min": -83.82845376464707, "episode_return_mean": 82.15416259439372, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 880000, "num_agent_steps_trained": 880000, "num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 11.152787118808268, "num_env_steps_trained_throughput_per_sec": 11.152787118808268, "timesteps_total": 220000, "num_env_steps_sampled_lifetime": 220000, "num_agent_steps_sampled_lifetime": 880000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 880000, "timers": {"training_iteration_time_ms": 623260.511, "restore_workers_time_ms": 0.014, "training_step_time_ms": 623260.436, "sample_time_ms": 2378.124, "learn_time_ms": 620857.593, "learn_throughput": 6.443, "synch_weights_time_ms": 19.714}, "counters": {"num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_agent_steps_sampled": 880000, "num_agent_steps_trained": 880000}, "done": false, "training_iteration": 55, "trial_id": "b941d_00000", "date": "2024-08-18_08-01-46", "timestamp": 1723948306, "time_this_iter_s": 358.7126908302307, "time_total_s": 86870.46484160423, "pid": 81115, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[32, [4, 4], 2], [64, [3, 3], 2], [128, [3, 3], 1]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [256, 256], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b04950d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 86870.46484160423, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 20.956149732620318, "ram_util_percent": 81.91604278074865}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.769859006165197, "cur_kl_coeff": 1.5187500000000005, "cur_lr": 0.00010000000000000003, "total_loss": 8.706438855014781, "policy_loss": -0.0849420113728022, "vf_loss": 8.76753290115841, "vf_explained_var": 0.14786561226087902, "kl": 0.015702364539151244, "entropy": 0.9964515517628382, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 104895.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.478105798410992, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.00010000000000000003, "total_loss": 9.238708444121023, "policy_loss": -0.08006021640751333, "vf_loss": 9.301397244892422, "vf_explained_var": -0.3708333711460154, "kl": 0.017156989587005195, "entropy": 0.743309159915914, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 104895.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_agent_steps_sampled": 896000, "num_agent_steps_trained": 896000}, "env_runners": {"episode_reward_max": 435.0438056381757, "episode_reward_min": -83.82845376464707, "episode_reward_mean": 79.13336285912715, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -673.8954109290834, "predator_policy": 0.9323879648176213}, "policy_reward_max": {"prey_policy": 179.8702222224401, "predator_policy": 673.9054109290834}, "policy_reward_mean": {"prey_policy": -351.5956156368104, "predator_policy": 391.16229706637387}, "custom_metrics": {}, "hist_stats": {"episode_reward": [14.095218497951526, 232.56713335675147, 0.10999999999999921, 24.19474899589924, 58.844555869622546, -24.951782998453403, -13.555102898884611, 126.18239449235399, 312.25608207803367, -4.615363319749806, 128.01999999999998, 91.48922249102951, 161.32963422660612, 0.009999999999999343, 0.08999999999999941, 55.072312561750586, 11.17764376023505, 82.12808986005486, 319.6930316776951, 1.3726593440617902, 169.5406827690502, 15.270996895758461, 89.32398371924187, 119.01782687900747, 1.8352514804546836, 214.4516202351754, 0.5268932962419219, 84.99287377010246, 38.01159133708502, 36.009648289395045, 25.118504340316683, 248.35201626243895, 2.2754202827874277, 221.34057252982143, 0.2799999999999945, 200.5421751023303, 131.9247644998569, 285.4266070714509, 18.9060160739224, -59.667776339871224, 153.06645766736708, 55.90938782221691, 29.54309416625013, 19.20568140815897, 5.640000000000002, 113.25542780175391, 250.09955500463852, 49.81030418984291, 0.0899999999999963, 43.33064085991965, 6.439293542825908e-15, 23.362191357554465, 72.89828303652443, 122.84545391343903, 0.24000000000000754, 103.98921663558441, 187.24549829971113, 234.30762633610567, 13.983221341956808, 4.969999999999991, 0.0499999999999996, 9.290981423244247, 2.3400000000000016, 82.38897035717429, 270.84395540348316, 11.270000000000001, 4.3831152198640035, -7.461427856235174, 15.190045338267392, 85.27737550281908, 120.1331010491299, 28.63, 122.68082489366128, 8.80777510103062, 197.1202118761601, 65.31089068116036, -83.82845376464707, 50.10245977028224, -14.984250841632804, 225.76783618851348, 0.27999999999999403, 109.07232969159215, 333.72178971632695, 306.19345247250476, 0.9406130780340642, 12.383520939809868, 27.20000000000003, 0.0600000000000005, 435.0438056381757, 55.129999999999995, 88.866138015677, 0.03000000000000913, 132.45738770998034, 35.55270252977462, 55.428177543001496, 14.625667342618286, 0.06999999999998785, 33.38489499226677, 0.5361271081714496, 176.26408246195953], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-529.6356874586833, -365.3084541011382, -337.1803880368657, 8.714423671705333, -370.23516605397566, -418.34124875570495, -512.3115627684857, -506.33056127989454, -508.3930857854098, 2.0000000000000013, -343.377561245806, -621.3389455010392, -433.47213935159965, -454.8915907394177, 17.095605326644062, -422.5727244574441, -448.8940920248023, 64.06369205926173, -651.1821316815071, -445.08392165271596, -673.8954109290834, -54.05027064659993, -307.019870380278, -286.3311609324379, -437.35890516951036, 115.32994838057698, -458.7770725326267, -640.9173486228078, -484.74990599953287, -435.04866488988597, -343.5118144325833, -280.2803400737522, -553.4141478245389, -373.1149117991955, -498.2372182528863, 2.0000000000000013, 65.373727424473, -436.24065898768544, -343.5108295023415, -449.7208167426945, -126.73279597530923, -437.3375247989036, -417.6977773093574, -375.96247002373264, 50.34167988256842, -380.16408147076385, -482.80723416646424, -138.26173509421636, -386.1262672923269, -445.00113534685795, -533.9790944461481, -199.70052892063097, -491.77900217864925, -379.5702239749438, -426.3121526007644, -180.02238462183598, -413.1210931889198, -262.27106412299213, -605.1291100769528, -165.18936984236092, -452.0145010585685, -430.116628092968, -54.973576991143574, -488.7188775583061, -452.7397061666227, -541.2811475406756, -436.87511709062153, -80.69711517888891, -386.90841779397573, -556.7255837686513, -477.82692733556553, -47.45896224223898, -168.28741204857914, -377.9701696318842, 91.77055251867858, -398.24337293694, -320.7208889534326, -451.9570672582623, -297.17562950461667, -289.83333251419333, -329.76135752011015, -148.23088285607426, -318.7506244873735, -436.96793352744675, -467.14008270304055, -403.3384831760698, -387.2225700872991, -33.825119256148746, -301.02815989023816, -366.45894772334066, -99.00588745033883, -474.03815683530115, -192.33252290788772, -439.5921610247025, -3.1231159524971437, -534.9290278441127, -449.33276039484196, -551.5774723209585, -260.80248888719177, -206.3408032242407, -584.1020448494265, -583.6803654403467, -290.1370258390817, -467.34861364509084, -55.07756362771852, -558.4955255782085, -220.42226002557618, -388.9604571511274, -445.22206194061437, -564.8952737316492, -267.95389722824063, -78.76114287132191, -334.78137620066855, -133.1791423958759, -31.575994486993437, -478.9627217136054, -309.67494621611826, -594.787630458563, -1.3426159998282867, -608.8691193804073, -516.5545562913459, -490.15501591767514, -440.4749396739272, -432.736476401271, -384.27282019364714, -373.1779907916189, -444.75537847340274, -231.54447214754327, -473.2351537695166, -50.519869474069665, -504.55820358735014, -575.3029537106735, -328.81380298274405, -369.2302318959506, -489.0791584332684, -435.3957070247017, -385.03764741413914, -457.2298530652226, -319.92927132725384, -491.8477511590775, -233.07058976706864, -499.16672196989134, -176.33945375490492, -459.3756049874834, -491.08345513153836, 2.0000000000000013, -290.0915441427659, -490.45084009318896, -356.6402010731671, -105.84914427241242, -77.63799169990673, -499.1461589608598, -506.72986035795736, -499.06172439648185, -477.6937705435149, -254.70540614615817, -354.2226087125846, -476.2145503759071, -461.65317173419106, -66.07932737523277, -507.2991251287274, -326.2082809325397, -397.16669294454255, 32.91194218862114, -445.2961049628019, 155.46973202730396, 38.09268977288989, -431.71775570194836, -576.822673350677, -513.7475103380083, -282.64940644096686, -320.8363195563913, -386.4779461824796, -547.0358953398568, -468.29163138460126, -467.4534050519655, -475.1598042481014, 179.8702222224401, -240.21348473805443, -642.523065425285, -148.67396335930468, -506.7275391317409, -541.7082639590278, -448.7021360044184, -128.69392000946561, -333.03128940983186, -613.7387440354355, -2.4134685652202306, -467.7337911762347, -558.4445018834547, -363.4212616675811, -487.83097008498544, -521.7404021285438, -469.1569975562355, -279.0655273305887, -480.0033240040423, -574.006469295631, -284.8756886505442, -130.54992045068008, -421.230258596842], "policy_predator_policy_reward": [456.4136468350183, 452.62571322275437, 193.19485817948433, 367.8382395424278, 370.2851660539756, 418.4012487557049, 529.7724502394957, 513.0644228047839, 490.0792994009608, 75.15834225407181, 456.2447064860434, 483.5200172623485, 435.75591371867085, 439.052713473462, 109.84927532782751, 421.81023829532666, 315.4058658109007, 381.68061623267346, 645.5267683617574, 446.1239216527159, 673.9054109290834, 182.06027064659992, 480.8431146578534, 203.99713914589194, 437.4189051695103, 45.939685846029164, 458.78707253262667, 640.9173486228078, 484.77990599953284, 435.1086648898859, 354.1319340917309, 324.7325329763548, 548.6495956712978, 389.0571077126715, 241.45058400709834, 336.91472410584305, 331.2464034793155, 359.3135597615921, 343.8108295023412, 450.79347608675636, 327.57868338810005, 406.0323201551633, 546.5707725413683, 262.3604716874799, 418.2139973426199, 0.9323879648176213, 470.6406026604506, 269.44619347923737, 382.50598433008776, 450.4566697895515, 647.8033386263006, 300.32790497565355, 457.83352318670376, 414.0425962631311, 376.41649497021837, 314.9109160224844, 349.06381240069726, 364.33993624829895, 605.1925547530294, 201.1355734556791, 449.90618544361405, 457.3434480482391, 559.4235694578354, 232.6209013540529, 457.69607398584424, 538.6002000042416, 394.82473791628456, 344.08806688304696, 387.0284177939756, 556.8855837686514, 463.41460069703885, 262.41346398309565, 391.6272466667452, 286.55509951357493, 294.3671185098814, 297.53230897983093, 347.8393095327926, 443.7446627528248, 292.38831417012, 234.95287150881862, 330.2643451751553, 300.79435286839583, 388.87666440276644, 422.7512814342702, 461.3898671438041, 438.6317929015562, 3.2501281453752657, 437.0032426062314, 301.45815989023777, 371.66894772334047, 320.54576378703644, 365.7537083003572, 486.3430893814693, 395.68114955575913, 192.2360130940479, 395.62643489240463, 449.4027603948419, 551.5974723209584, 195.185653209803, 315.28827976154815, 584.1020448494265, 583.6803654403467, 323.71970306903427, 457.12812777269266, 177.10580318898232, 509.3655690534689, 343.61607224265435, 388.61209884748774, 445.36206194061435, 564.9952737316491, 449.75850871905953, 0.9457480160869721, 298.2573356256588, 356.9486812705962, 430.6577854273749, 314.18855710932974, 320.7052087211459, 597.7405892954919, 3.3126159998282594, 611.8691193804073, 516.5945562913458, 490.16501591767513, 445.62493967392703, 436.87745782451526, 384.402820193647, 375.3879907916188, 394.29235708255294, 364.3964638955676, 319.1041113348493, 475.4948673122204, 515.8282035873499, 575.3029537106735, 335.8876910253889, 366.5394590731695, 460.28787423286565, 456.72556336886885, 478.84045354561397, 378.61709227201465, 412.295260954649, 484.75913703450084, 359.641506501114, 492.7289062849745, 202.8194537549045, 461.5256049874833, 374.59504512845035, 237.16923489674954, 297.8693192437962, 491.48084009318893, 247.50384352371148, 412.1057136980278, 461.02246852149153, 181.07257282043588, 541.9962502306447, 379.96688075914767, 481.6957494597605, 300.80588700019496, 332.4830543323385, 482.9698539145205, 331.9464016386213, 421.55393365931593, 507.4791251287272, 326.3082809325396, 139.4389279688307, 333.88815247868195, 261.6114733245148, 361.9366893273098, 470.7791364603482, 229.03938194121454, 577.122673350677, 514.3881234160424, 364.8243093866163, 251.04493755055083, 413.4979461824797, 547.2158953398567, 468.3316313846012, 467.47340505196547, 367.9991895742338, 362.33419808960315, 295.3434847380543, 642.523065425285, 282.9415331273896, 461.3261073793331, 541.7382639590278, 448.7021360044184, 275.7719783292666, 318.41061880001087, 563.0386443863761, 88.66627074405442, 415.43026303638203, 666.1762075663082, 376.01487380130743, 489.8630252938773, 521.8104021285437, 469.1569975562355, 424.64553056351485, 367.80821576338275, 573.8910045352634, 285.52728051908304, 313.3650235334032, 414.67923797607796]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.498584105351222, "mean_inference_ms": 49.40146690865568, "mean_action_processing_ms": 0.25847380915664475, "mean_env_wait_ms": 7.127487259557879, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004985332489013672, "StateBufferConnector_ms": 0.003660440444946289, "ViewRequirementAgentConnector_ms": 0.13367187976837158}, "num_episodes": 18, "episode_return_max": 435.0438056381757, "episode_return_min": -83.82845376464707, "episode_return_mean": 79.13336285912715, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 896000, "num_agent_steps_trained": 896000, "num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1.8561815439639278, "num_env_steps_trained_throughput_per_sec": 1.8561815439639278, "timesteps_total": 224000, "num_env_steps_sampled_lifetime": 224000, "num_agent_steps_sampled_lifetime": 896000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 896000, "timers": {"training_iteration_time_ms": 798520.209, "restore_workers_time_ms": 0.015, "training_step_time_ms": 798520.131, "sample_time_ms": 2372.7, "learn_time_ms": 796123.31, "learn_throughput": 5.024, "synch_weights_time_ms": 19.355}, "counters": {"num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_agent_steps_sampled": 896000, "num_agent_steps_trained": 896000}, "done": false, "training_iteration": 56, "trial_id": "b941d_00000", "date": "2024-08-18_08-37-41", "timestamp": 1723950461, "time_this_iter_s": 2155.0159089565277, "time_total_s": 89025.48075056076, "pid": 81115, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[32, [4, 4], 2], [64, [3, 3], 2], [128, [3, 3], 1]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [256, 256], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b0436160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 89025.48075056076, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 24.691145833333337, "ram_util_percent": 81.2171875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.035670528336176, "cur_kl_coeff": 1.5187500000000005, "cur_lr": 0.00010000000000000003, "total_loss": 9.269924489783232, "policy_loss": -0.0878473270989994, "vf_loss": 9.334447189109035, "vf_explained_var": -0.07570805209023612, "kl": 0.01535777717308217, "entropy": 0.9966716032810312, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 106785.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 11.886390939339128, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.00010000000000000003, "total_loss": 9.282762182831133, "policy_loss": -0.0782434244204076, "vf_loss": 9.344202678418034, "vf_explained_var": -0.5129364184286228, "kl": 0.016595512217150908, "entropy": 0.7340715500728163, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 106785.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_agent_steps_sampled": 912000, "num_agent_steps_trained": 912000}, "env_runners": {"episode_reward_max": 435.0438056381757, "episode_reward_min": -83.82845376464707, "episode_reward_mean": 74.36219031869786, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -642.523065425285, "predator_policy": 0.9323879648176213}, "policy_reward_max": {"prey_policy": 179.8702222224401, "predator_policy": 666.1762075663082}, "policy_reward_mean": {"prey_policy": -356.993176258682, "predator_policy": 394.1742714180309}, "custom_metrics": {}, "hist_stats": {"episode_reward": [319.6930316776951, 1.3726593440617902, 169.5406827690502, 15.270996895758461, 89.32398371924187, 119.01782687900747, 1.8352514804546836, 214.4516202351754, 0.5268932962419219, 84.99287377010246, 38.01159133708502, 36.009648289395045, 25.118504340316683, 248.35201626243895, 2.2754202827874277, 221.34057252982143, 0.2799999999999945, 200.5421751023303, 131.9247644998569, 285.4266070714509, 18.9060160739224, -59.667776339871224, 153.06645766736708, 55.90938782221691, 29.54309416625013, 19.20568140815897, 5.640000000000002, 113.25542780175391, 250.09955500463852, 49.81030418984291, 0.0899999999999963, 43.33064085991965, 6.439293542825908e-15, 23.362191357554465, 72.89828303652443, 122.84545391343903, 0.24000000000000754, 103.98921663558441, 187.24549829971113, 234.30762633610567, 13.983221341956808, 4.969999999999991, 0.0499999999999996, 9.290981423244247, 2.3400000000000016, 82.38897035717429, 270.84395540348316, 11.270000000000001, 4.3831152198640035, -7.461427856235174, 15.190045338267392, 85.27737550281908, 120.1331010491299, 28.63, 122.68082489366128, 8.80777510103062, 197.1202118761601, 65.31089068116036, -83.82845376464707, 50.10245977028224, -14.984250841632804, 225.76783618851348, 0.27999999999999403, 109.07232969159215, 333.72178971632695, 306.19345247250476, 0.9406130780340642, 12.383520939809868, 27.20000000000003, 0.0600000000000005, 435.0438056381757, 55.129999999999995, 88.866138015677, 0.03000000000000913, 132.45738770998034, 35.55270252977462, 55.428177543001496, 14.625667342618286, 0.06999999999998785, 33.38489499226677, 0.5361271081714496, 176.26408246195953, 1.101124502183249, 4.529526086944072, 80.27063873954495, 11.920005916365682, 52.92269326713894, 67.6997687676577, 0.9004884258543029, 6.060945750025235, 267.3464854734815, 53.34547087467265, 0.18999999999999373, 1.080000000000004, 77.82164005850721, 37.666130063395315, 113.63057705510397, 0.30999999999999583, 0.06000000000000405, 0.472037949394041], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [65.373727424473, -436.24065898768544, -343.5108295023415, -449.7208167426945, -126.73279597530923, -437.3375247989036, -417.6977773093574, -375.96247002373264, 50.34167988256842, -380.16408147076385, -482.80723416646424, -138.26173509421636, -386.1262672923269, -445.00113534685795, -533.9790944461481, -199.70052892063097, -491.77900217864925, -379.5702239749438, -426.3121526007644, -180.02238462183598, -413.1210931889198, -262.27106412299213, -605.1291100769528, -165.18936984236092, -452.0145010585685, -430.116628092968, -54.973576991143574, -488.7188775583061, -452.7397061666227, -541.2811475406756, -436.87511709062153, -80.69711517888891, -386.90841779397573, -556.7255837686513, -477.82692733556553, -47.45896224223898, -168.28741204857914, -377.9701696318842, 91.77055251867858, -398.24337293694, -320.7208889534326, -451.9570672582623, -297.17562950461667, -289.83333251419333, -329.76135752011015, -148.23088285607426, -318.7506244873735, -436.96793352744675, -467.14008270304055, -403.3384831760698, -387.2225700872991, -33.825119256148746, -301.02815989023816, -366.45894772334066, -99.00588745033883, -474.03815683530115, -192.33252290788772, -439.5921610247025, -3.1231159524971437, -534.9290278441127, -449.33276039484196, -551.5774723209585, -260.80248888719177, -206.3408032242407, -584.1020448494265, -583.6803654403467, -290.1370258390817, -467.34861364509084, -55.07756362771852, -558.4955255782085, -220.42226002557618, -388.9604571511274, -445.22206194061437, -564.8952737316492, -267.95389722824063, -78.76114287132191, -334.78137620066855, -133.1791423958759, -31.575994486993437, -478.9627217136054, -309.67494621611826, -594.787630458563, -1.3426159998282867, -608.8691193804073, -516.5545562913459, -490.15501591767514, -440.4749396739272, -432.736476401271, -384.27282019364714, -373.1779907916189, -444.75537847340274, -231.54447214754327, -473.2351537695166, -50.519869474069665, -504.55820358735014, -575.3029537106735, -328.81380298274405, -369.2302318959506, -489.0791584332684, -435.3957070247017, -385.03764741413914, -457.2298530652226, -319.92927132725384, -491.8477511590775, -233.07058976706864, -499.16672196989134, -176.33945375490492, -459.3756049874834, -491.08345513153836, 2.0000000000000013, -290.0915441427659, -490.45084009318896, -356.6402010731671, -105.84914427241242, -77.63799169990673, -499.1461589608598, -506.72986035795736, -499.06172439648185, -477.6937705435149, -254.70540614615817, -354.2226087125846, -476.2145503759071, -461.65317173419106, -66.07932737523277, -507.2991251287274, -326.2082809325397, -397.16669294454255, 32.91194218862114, -445.2961049628019, 155.46973202730396, 38.09268977288989, -431.71775570194836, -576.822673350677, -513.7475103380083, -282.64940644096686, -320.8363195563913, -386.4779461824796, -547.0358953398568, -468.29163138460126, -467.4534050519655, -475.1598042481014, 179.8702222224401, -240.21348473805443, -642.523065425285, -148.67396335930468, -506.7275391317409, -541.7082639590278, -448.7021360044184, -128.69392000946561, -333.03128940983186, -613.7387440354355, -2.4134685652202306, -467.7337911762347, -558.4445018834547, -363.4212616675811, -487.83097008498544, -521.7404021285438, -469.1569975562355, -279.0655273305887, -480.0033240040423, -574.006469295631, -284.8756886505442, -130.54992045068008, -421.230258596842, -349.41535647814936, -321.34674701959744, -552.1899617939904, -464.0278394092098, -320.8464655008426, -451.28248186039144, -351.7960405795828, -312.58461547400486, -78.14961212817008, -423.1288144792095, -86.04218418613429, -506.07996568747126, -337.9765996888753, -544.4978441385393, -389.9666460236229, -519.4348492619648, -423.58932782906845, 114.75382358341739, -371.42140477466364, -320.4249668441544, -430.6061595483298, -401.0115080700385, -459.5824359069675, -440.65442803496217, -496.69272667651666, -478.7982407951224, -380.09894628182866, -629.3857179113388, -144.41912643466577, -460.24007568197743, -492.04190784518386, -302.02616302805836, -415.2075623345715, -608.0024881439374, -511.37634085469324, -405.9730311939276], "policy_predator_policy_reward": [331.2464034793155, 359.3135597615921, 343.8108295023412, 450.79347608675636, 327.57868338810005, 406.0323201551633, 546.5707725413683, 262.3604716874799, 418.2139973426199, 0.9323879648176213, 470.6406026604506, 269.44619347923737, 382.50598433008776, 450.4566697895515, 647.8033386263006, 300.32790497565355, 457.83352318670376, 414.0425962631311, 376.41649497021837, 314.9109160224844, 349.06381240069726, 364.33993624829895, 605.1925547530294, 201.1355734556791, 449.90618544361405, 457.3434480482391, 559.4235694578354, 232.6209013540529, 457.69607398584424, 538.6002000042416, 394.82473791628456, 344.08806688304696, 387.0284177939756, 556.8855837686514, 463.41460069703885, 262.41346398309565, 391.6272466667452, 286.55509951357493, 294.3671185098814, 297.53230897983093, 347.8393095327926, 443.7446627528248, 292.38831417012, 234.95287150881862, 330.2643451751553, 300.79435286839583, 388.87666440276644, 422.7512814342702, 461.3898671438041, 438.6317929015562, 3.2501281453752657, 437.0032426062314, 301.45815989023777, 371.66894772334047, 320.54576378703644, 365.7537083003572, 486.3430893814693, 395.68114955575913, 192.2360130940479, 395.62643489240463, 449.4027603948419, 551.5974723209584, 195.185653209803, 315.28827976154815, 584.1020448494265, 583.6803654403467, 323.71970306903427, 457.12812777269266, 177.10580318898232, 509.3655690534689, 343.61607224265435, 388.61209884748774, 445.36206194061435, 564.9952737316491, 449.75850871905953, 0.9457480160869721, 298.2573356256588, 356.9486812705962, 430.6577854273749, 314.18855710932974, 320.7052087211459, 597.7405892954919, 3.3126159998282594, 611.8691193804073, 516.5945562913458, 490.16501591767513, 445.62493967392703, 436.87745782451526, 384.402820193647, 375.3879907916188, 394.29235708255294, 364.3964638955676, 319.1041113348493, 475.4948673122204, 515.8282035873499, 575.3029537106735, 335.8876910253889, 366.5394590731695, 460.28787423286565, 456.72556336886885, 478.84045354561397, 378.61709227201465, 412.295260954649, 484.75913703450084, 359.641506501114, 492.7289062849745, 202.8194537549045, 461.5256049874833, 374.59504512845035, 237.16923489674954, 297.8693192437962, 491.48084009318893, 247.50384352371148, 412.1057136980278, 461.02246852149153, 181.07257282043588, 541.9962502306447, 379.96688075914767, 481.6957494597605, 300.80588700019496, 332.4830543323385, 482.9698539145205, 331.9464016386213, 421.55393365931593, 507.4791251287272, 326.3082809325396, 139.4389279688307, 333.88815247868195, 261.6114733245148, 361.9366893273098, 470.7791364603482, 229.03938194121454, 577.122673350677, 514.3881234160424, 364.8243093866163, 251.04493755055083, 413.4979461824797, 547.2158953398567, 468.3316313846012, 467.47340505196547, 367.9991895742338, 362.33419808960315, 295.3434847380543, 642.523065425285, 282.9415331273896, 461.3261073793331, 541.7382639590278, 448.7021360044184, 275.7719783292666, 318.41061880001087, 563.0386443863761, 88.66627074405442, 415.43026303638203, 666.1762075663082, 376.01487380130743, 489.8630252938773, 521.8104021285437, 469.1569975562355, 424.64553056351485, 367.80821576338275, 573.8910045352634, 285.52728051908304, 313.3650235334032, 414.67923797607796, 315.42060803271903, 356.4426199672109, 523.8479747429296, 496.89935254721416, 401.854729906694, 450.54485619408484, 346.09519077323057, 330.20547119672256, 126.80342773301189, 427.3976921415076, 418.9594210254051, 240.86249761585887, 340.1040945873647, 543.2708376659044, 415.7658159253328, 499.6966251102799, 389.5076653454337, 186.67432437369933, 399.8944383395055, 345.29740415398487, 430.7061595483297, 401.1015080700384, 460.63243590696743, 440.68442803496214, 593.8760945270333, 459.43651300311285, 427.00006943551983, 620.1507248210428, 401.5600579811697, 316.72972119057715, 492.0819078451839, 302.29616302805834, 415.26756233457144, 608.0024881439374, 511.37634085469324, 406.44506914332163]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.418224363331895, "mean_inference_ms": 48.63370068318853, "mean_action_processing_ms": 0.2583477689567726, "mean_env_wait_ms": 7.013320221957786, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0047768354415893555, "StateBufferConnector_ms": 0.00343477725982666, "ViewRequirementAgentConnector_ms": 0.11080479621887207}, "num_episodes": 18, "episode_return_max": 435.0438056381757, "episode_return_min": -83.82845376464707, "episode_return_mean": 74.36219031869786, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 912000, "num_agent_steps_trained": 912000, "num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1.3497866466090487, "num_env_steps_trained_throughput_per_sec": 1.3497866466090487, "timesteps_total": 228000, "num_env_steps_sampled_lifetime": 228000, "num_agent_steps_sampled_lifetime": 912000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 912000, "timers": {"training_iteration_time_ms": 1079897.256, "restore_workers_time_ms": 0.015, "training_step_time_ms": 1079897.17, "sample_time_ms": 2348.01, "learn_time_ms": 1077523.322, "learn_throughput": 3.712, "synch_weights_time_ms": 21.353}, "counters": {"num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_agent_steps_sampled": 912000, "num_agent_steps_trained": 912000}, "done": false, "training_iteration": 57, "trial_id": "b941d_00000", "date": "2024-08-18_09-27-05", "timestamp": 1723953425, "time_this_iter_s": 2963.4822442531586, "time_total_s": 91988.96299481392, "pid": 81115, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[32, [4, 4], 2], [64, [3, 3], 2], [128, [3, 3], 1]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [256, 256], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b04b4d30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 91988.96299481392, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 25.154687499999998, "ram_util_percent": 79.74843750000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.575185238495076, "cur_kl_coeff": 1.5187500000000005, "cur_lr": 0.00010000000000000003, "total_loss": 8.65007557162532, "policy_loss": -0.0899514101310165, "vf_loss": 8.716653054353422, "vf_explained_var": 0.10872913006121519, "kl": 0.015390237122510326, "entropy": 0.9822525458045738, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 108675.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.399974768754667, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.00010000000000000003, "total_loss": 9.385293906075614, "policy_loss": -0.08588272969130052, "vf_loss": 9.453438723024236, "vf_explained_var": -0.5937619981311616, "kl": 0.017518925969466293, "entropy": 0.7594710492898548, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 108675.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_agent_steps_sampled": 928000, "num_agent_steps_trained": 928000}, "env_runners": {"episode_reward_max": 435.0438056381757, "episode_reward_min": -83.82845376464707, "episode_reward_mean": 68.16707548077974, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -642.523065425285, "predator_policy": 0.9457480160869721}, "policy_reward_max": {"prey_policy": 179.8702222224401, "predator_policy": 666.1762075663082}, "policy_reward_mean": {"prey_policy": -366.22870789564826, "predator_policy": 400.31224563603797}, "custom_metrics": {}, "hist_stats": {"episode_reward": [153.06645766736708, 55.90938782221691, 29.54309416625013, 19.20568140815897, 5.640000000000002, 113.25542780175391, 250.09955500463852, 49.81030418984291, 0.0899999999999963, 43.33064085991965, 6.439293542825908e-15, 23.362191357554465, 72.89828303652443, 122.84545391343903, 0.24000000000000754, 103.98921663558441, 187.24549829971113, 234.30762633610567, 13.983221341956808, 4.969999999999991, 0.0499999999999996, 9.290981423244247, 2.3400000000000016, 82.38897035717429, 270.84395540348316, 11.270000000000001, 4.3831152198640035, -7.461427856235174, 15.190045338267392, 85.27737550281908, 120.1331010491299, 28.63, 122.68082489366128, 8.80777510103062, 197.1202118761601, 65.31089068116036, -83.82845376464707, 50.10245977028224, -14.984250841632804, 225.76783618851348, 0.27999999999999403, 109.07232969159215, 333.72178971632695, 306.19345247250476, 0.9406130780340642, 12.383520939809868, 27.20000000000003, 0.0600000000000005, 435.0438056381757, 55.129999999999995, 88.866138015677, 0.03000000000000913, 132.45738770998034, 35.55270252977462, 55.428177543001496, 14.625667342618286, 0.06999999999998785, 33.38489499226677, 0.5361271081714496, 176.26408246195953, 1.101124502183249, 4.529526086944072, 80.27063873954495, 11.920005916365682, 52.92269326713894, 67.6997687676577, 0.9004884258543029, 6.060945750025235, 267.3464854734815, 53.34547087467265, 0.18999999999999373, 1.080000000000004, 77.82164005850721, 37.666130063395315, 113.63057705510397, 0.30999999999999583, 0.06000000000000405, 0.472037949394041, 69.59128955405045, 87.24999999999999, 102.05774539420544, 15.418595372644628, 41.298672995009724, 160.53618639748385, 22.84563024565348, -12.168378009039117, 13.579999999999991, 1.5999999999999996, 2.4301899440447894, 65.8489511477662, 0.35999999999999477, 121.0697203215684, 122.32427489767932, 0.01999999999999802, 374.4561284101712, 130.31851580499992, 3.0300000000000047, 233.82641483671557, 1.5869645360900642, -12.247026124530926], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-329.76135752011015, -148.23088285607426, -318.7506244873735, -436.96793352744675, -467.14008270304055, -403.3384831760698, -387.2225700872991, -33.825119256148746, -301.02815989023816, -366.45894772334066, -99.00588745033883, -474.03815683530115, -192.33252290788772, -439.5921610247025, -3.1231159524971437, -534.9290278441127, -449.33276039484196, -551.5774723209585, -260.80248888719177, -206.3408032242407, -584.1020448494265, -583.6803654403467, -290.1370258390817, -467.34861364509084, -55.07756362771852, -558.4955255782085, -220.42226002557618, -388.9604571511274, -445.22206194061437, -564.8952737316492, -267.95389722824063, -78.76114287132191, -334.78137620066855, -133.1791423958759, -31.575994486993437, -478.9627217136054, -309.67494621611826, -594.787630458563, -1.3426159998282867, -608.8691193804073, -516.5545562913459, -490.15501591767514, -440.4749396739272, -432.736476401271, -384.27282019364714, -373.1779907916189, -444.75537847340274, -231.54447214754327, -473.2351537695166, -50.519869474069665, -504.55820358735014, -575.3029537106735, -328.81380298274405, -369.2302318959506, -489.0791584332684, -435.3957070247017, -385.03764741413914, -457.2298530652226, -319.92927132725384, -491.8477511590775, -233.07058976706864, -499.16672196989134, -176.33945375490492, -459.3756049874834, -491.08345513153836, 2.0000000000000013, -290.0915441427659, -490.45084009318896, -356.6402010731671, -105.84914427241242, -77.63799169990673, -499.1461589608598, -506.72986035795736, -499.06172439648185, -477.6937705435149, -254.70540614615817, -354.2226087125846, -476.2145503759071, -461.65317173419106, -66.07932737523277, -507.2991251287274, -326.2082809325397, -397.16669294454255, 32.91194218862114, -445.2961049628019, 155.46973202730396, 38.09268977288989, -431.71775570194836, -576.822673350677, -513.7475103380083, -282.64940644096686, -320.8363195563913, -386.4779461824796, -547.0358953398568, -468.29163138460126, -467.4534050519655, -475.1598042481014, 179.8702222224401, -240.21348473805443, -642.523065425285, -148.67396335930468, -506.7275391317409, -541.7082639590278, -448.7021360044184, -128.69392000946561, -333.03128940983186, -613.7387440354355, -2.4134685652202306, -467.7337911762347, -558.4445018834547, -363.4212616675811, -487.83097008498544, -521.7404021285438, -469.1569975562355, -279.0655273305887, -480.0033240040423, -574.006469295631, -284.8756886505442, -130.54992045068008, -421.230258596842, -349.41535647814936, -321.34674701959744, -552.1899617939904, -464.0278394092098, -320.8464655008426, -451.28248186039144, -351.7960405795828, -312.58461547400486, -78.14961212817008, -423.1288144792095, -86.04218418613429, -506.07996568747126, -337.9765996888753, -544.4978441385393, -389.9666460236229, -519.4348492619648, -423.58932782906845, 114.75382358341739, -371.42140477466364, -320.4249668441544, -430.6061595483298, -401.0115080700385, -459.5824359069675, -440.65442803496217, -496.69272667651666, -478.7982407951224, -380.09894628182866, -629.3857179113388, -144.41912643466577, -460.24007568197743, -492.04190784518386, -302.02616302805836, -415.2075623345715, -608.0024881439374, -511.37634085469324, -405.9730311939276, -408.20511187123856, -274.7033620841109, -297.4398154642928, -151.66450929728705, -398.2753484590599, -249.7173384760756, -558.335073405509, -583.5629755968832, -517.9407461755139, -419.67468360307606, -30.350840239034095, -485.210726404875, -422.6389454565336, -431.67697643779337, -410.0669129320793, -373.20144343550356, -460.31868509867803, -562.4323899631064, -418.574053316192, -304.39204782230945, -502.358014855935, -360.18422935691467, -336.51897180028396, -285.6225280622415, -361.3386667722361, -321.5361194641303, -132.3317462153979, -512.3197176664892, -503.67713919162577, -211.34850636284125, -436.3130569803658, -500.5803669466931, 131.4141687701945, -470.65661774889384, -506.7189639660614, -211.12759655415925, -354.00519320339055, -524.9513974617058, -356.41416869309126, -122.51561694979819, -393.8368177410664, -486.847118408309, -341.1386681116448, -567.4731126362826], "policy_predator_policy_reward": [330.2643451751553, 300.79435286839583, 388.87666440276644, 422.7512814342702, 461.3898671438041, 438.6317929015562, 3.2501281453752657, 437.0032426062314, 301.45815989023777, 371.66894772334047, 320.54576378703644, 365.7537083003572, 486.3430893814693, 395.68114955575913, 192.2360130940479, 395.62643489240463, 449.4027603948419, 551.5974723209584, 195.185653209803, 315.28827976154815, 584.1020448494265, 583.6803654403467, 323.71970306903427, 457.12812777269266, 177.10580318898232, 509.3655690534689, 343.61607224265435, 388.61209884748774, 445.36206194061435, 564.9952737316491, 449.75850871905953, 0.9457480160869721, 298.2573356256588, 356.9486812705962, 430.6577854273749, 314.18855710932974, 320.7052087211459, 597.7405892954919, 3.3126159998282594, 611.8691193804073, 516.5945562913458, 490.16501591767513, 445.62493967392703, 436.87745782451526, 384.402820193647, 375.3879907916188, 394.29235708255294, 364.3964638955676, 319.1041113348493, 475.4948673122204, 515.8282035873499, 575.3029537106735, 335.8876910253889, 366.5394590731695, 460.28787423286565, 456.72556336886885, 478.84045354561397, 378.61709227201465, 412.295260954649, 484.75913703450084, 359.641506501114, 492.7289062849745, 202.8194537549045, 461.5256049874833, 374.59504512845035, 237.16923489674954, 297.8693192437962, 491.48084009318893, 247.50384352371148, 412.1057136980278, 461.02246852149153, 181.07257282043588, 541.9962502306447, 379.96688075914767, 481.6957494597605, 300.80588700019496, 332.4830543323385, 482.9698539145205, 331.9464016386213, 421.55393365931593, 507.4791251287272, 326.3082809325396, 139.4389279688307, 333.88815247868195, 261.6114733245148, 361.9366893273098, 470.7791364603482, 229.03938194121454, 577.122673350677, 514.3881234160424, 364.8243093866163, 251.04493755055083, 413.4979461824797, 547.2158953398567, 468.3316313846012, 467.47340505196547, 367.9991895742338, 362.33419808960315, 295.3434847380543, 642.523065425285, 282.9415331273896, 461.3261073793331, 541.7382639590278, 448.7021360044184, 275.7719783292666, 318.41061880001087, 563.0386443863761, 88.66627074405442, 415.43026303638203, 666.1762075663082, 376.01487380130743, 489.8630252938773, 521.8104021285437, 469.1569975562355, 424.64553056351485, 367.80821576338275, 573.8910045352634, 285.52728051908304, 313.3650235334032, 414.67923797607796, 315.42060803271903, 356.4426199672109, 523.8479747429296, 496.89935254721416, 401.854729906694, 450.54485619408484, 346.09519077323057, 330.20547119672256, 126.80342773301189, 427.3976921415076, 418.9594210254051, 240.86249761585887, 340.1040945873647, 543.2708376659044, 415.7658159253328, 499.6966251102799, 389.5076653454337, 186.67432437369933, 399.8944383395055, 345.29740415398487, 430.7061595483297, 401.1015080700384, 460.63243590696743, 440.68442803496214, 593.8760945270333, 459.43651300311285, 427.00006943551983, 620.1507248210428, 401.5600579811697, 316.72972119057715, 492.0819078451839, 302.29616302805834, 415.26756233457144, 608.0024881439374, 511.37634085469324, 406.44506914332163, 402.40731082771885, 350.092452681681, 314.5598154642927, 221.79450929728694, 386.0879013012075, 363.9625310281334, 588.6772349744796, 568.6394094005577, 497.0816909015696, 481.83241187203015, 257.572526393552, 418.5252266478417, 457.85046575742916, 419.31108638255085, 383.61307744314803, 387.48690091539555, 473.8986850986781, 562.4323899631064, 418.73405331619205, 305.8320478223095, 503.378014855935, 361.5944193009594, 354.8623362848149, 333.1281147254765, 361.47866677223607, 321.7561194641301, 514.3059733068623, 251.41521089659312, 449.2378988367182, 388.11202161542684, 436.3230569803658, 500.5903669466931, 385.01859823685925, 328.6799791520114, 467.9076834555439, 380.2573928696766, 356.02519320339053, 525.9613974617058, 341.10139092867786, 371.65480955092676, 459.45073203075145, 422.8201686547138, 348.66467123591354, 547.700083387483]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.545769074134771, "mean_inference_ms": 47.33248718540475, "mean_action_processing_ms": 0.25839189777104205, "mean_env_wait_ms": 7.486483252748029, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004793286323547363, "StateBufferConnector_ms": 0.003420114517211914, "ViewRequirementAgentConnector_ms": 0.11100554466247559}, "num_episodes": 22, "episode_return_max": 435.0438056381757, "episode_return_min": -83.82845376464707, "episode_return_mean": 68.16707548077974, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 928000, "num_agent_steps_trained": 928000, "num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 0.6376534722683415, "num_env_steps_trained_throughput_per_sec": 0.6376534722683415, "timesteps_total": 232000, "num_env_steps_sampled_lifetime": 232000, "num_agent_steps_sampled_lifetime": 928000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 928000, "timers": {"training_iteration_time_ms": 1692533.593, "restore_workers_time_ms": 0.016, "training_step_time_ms": 1692533.504, "sample_time_ms": 2329.976, "learn_time_ms": 1690177.733, "learn_throughput": 2.367, "synch_weights_time_ms": 21.152}, "counters": {"num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_agent_steps_sampled": 928000, "num_agent_steps_trained": 928000}, "done": false, "training_iteration": 58, "trial_id": "b941d_00000", "date": "2024-08-18_11-11-38", "timestamp": 1723959698, "time_this_iter_s": 6273.05010509491, "time_total_s": 98262.01309990883, "pid": 81115, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[32, [4, 4], 2], [64, [3, 3], 2], [128, [3, 3], 1]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [256, 256], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b0495e50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 98262.01309990883, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 30.988442211055272, "ram_util_percent": 80.64924623115579}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 12.008221673460865, "cur_kl_coeff": 1.5187500000000005, "cur_lr": 0.00010000000000000003, "total_loss": 9.01272773490381, "policy_loss": -0.09055837098060658, "vf_loss": 9.079291162541304, "vf_explained_var": 0.07997479435628053, "kl": 0.015799125830083822, "entropy": 1.0013990886627682, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 110565.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.173636470080684, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.00010000000000000003, "total_loss": 9.387933333967098, "policy_loss": -0.0846580093926085, "vf_loss": 9.455750292823428, "vf_explained_var": -0.5969035234085467, "kl": 0.01663313799919318, "entropy": 0.7348296088516397, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 110565.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_agent_steps_sampled": 944000, "num_agent_steps_trained": 944000}, "env_runners": {"episode_reward_max": 435.0438056381757, "episode_reward_min": -83.82845376464707, "episode_reward_mean": 61.03700708570252, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -642.523065425285, "predator_policy": 3.3126159998282594}, "policy_reward_max": {"prey_policy": 179.8702222224401, "predator_policy": 666.1762075663082}, "policy_reward_mean": {"prey_policy": -375.2692859772932, "predator_policy": 405.78778952014443}, "custom_metrics": {}, "hist_stats": {"episode_reward": [13.983221341956808, 4.969999999999991, 0.0499999999999996, 9.290981423244247, 2.3400000000000016, 82.38897035717429, 270.84395540348316, 11.270000000000001, 4.3831152198640035, -7.461427856235174, 15.190045338267392, 85.27737550281908, 120.1331010491299, 28.63, 122.68082489366128, 8.80777510103062, 197.1202118761601, 65.31089068116036, -83.82845376464707, 50.10245977028224, -14.984250841632804, 225.76783618851348, 0.27999999999999403, 109.07232969159215, 333.72178971632695, 306.19345247250476, 0.9406130780340642, 12.383520939809868, 27.20000000000003, 0.0600000000000005, 435.0438056381757, 55.129999999999995, 88.866138015677, 0.03000000000000913, 132.45738770998034, 35.55270252977462, 55.428177543001496, 14.625667342618286, 0.06999999999998785, 33.38489499226677, 0.5361271081714496, 176.26408246195953, 1.101124502183249, 4.529526086944072, 80.27063873954495, 11.920005916365682, 52.92269326713894, 67.6997687676577, 0.9004884258543029, 6.060945750025235, 267.3464854734815, 53.34547087467265, 0.18999999999999373, 1.080000000000004, 77.82164005850721, 37.666130063395315, 113.63057705510397, 0.30999999999999583, 0.06000000000000405, 0.472037949394041, 69.59128955405045, 87.24999999999999, 102.05774539420544, 15.418595372644628, 41.298672995009724, 160.53618639748385, 22.84563024565348, -12.168378009039117, 13.579999999999991, 1.5999999999999996, 2.4301899440447894, 65.8489511477662, 0.35999999999999477, 121.0697203215684, 122.32427489767932, 0.01999999999999802, 374.4561284101712, 130.31851580499992, 3.0300000000000047, 233.82641483671557, 1.5869645360900642, -12.247026124530926, 2.2869989656985923, 0.33000000000000007, 32.8257892557434, -5.054462176461492, 21.91194189529192, 36.379736099659056, 11.614081047105039, 0.030000000000001137, 2.3899999999999952, 138.06875315550522, 5.780091138630453, 40.14, -10.53801787991748, 5.853589526230527, 73.52794604372677, 145.62840308954975, 227.9095958094413, 22.747533021141845], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-309.67494621611826, -594.787630458563, -1.3426159998282867, -608.8691193804073, -516.5545562913459, -490.15501591767514, -440.4749396739272, -432.736476401271, -384.27282019364714, -373.1779907916189, -444.75537847340274, -231.54447214754327, -473.2351537695166, -50.519869474069665, -504.55820358735014, -575.3029537106735, -328.81380298274405, -369.2302318959506, -489.0791584332684, -435.3957070247017, -385.03764741413914, -457.2298530652226, -319.92927132725384, -491.8477511590775, -233.07058976706864, -499.16672196989134, -176.33945375490492, -459.3756049874834, -491.08345513153836, 2.0000000000000013, -290.0915441427659, -490.45084009318896, -356.6402010731671, -105.84914427241242, -77.63799169990673, -499.1461589608598, -506.72986035795736, -499.06172439648185, -477.6937705435149, -254.70540614615817, -354.2226087125846, -476.2145503759071, -461.65317173419106, -66.07932737523277, -507.2991251287274, -326.2082809325397, -397.16669294454255, 32.91194218862114, -445.2961049628019, 155.46973202730396, 38.09268977288989, -431.71775570194836, -576.822673350677, -513.7475103380083, -282.64940644096686, -320.8363195563913, -386.4779461824796, -547.0358953398568, -468.29163138460126, -467.4534050519655, -475.1598042481014, 179.8702222224401, -240.21348473805443, -642.523065425285, -148.67396335930468, -506.7275391317409, -541.7082639590278, -448.7021360044184, -128.69392000946561, -333.03128940983186, -613.7387440354355, -2.4134685652202306, -467.7337911762347, -558.4445018834547, -363.4212616675811, -487.83097008498544, -521.7404021285438, -469.1569975562355, -279.0655273305887, -480.0033240040423, -574.006469295631, -284.8756886505442, -130.54992045068008, -421.230258596842, -349.41535647814936, -321.34674701959744, -552.1899617939904, -464.0278394092098, -320.8464655008426, -451.28248186039144, -351.7960405795828, -312.58461547400486, -78.14961212817008, -423.1288144792095, -86.04218418613429, -506.07996568747126, -337.9765996888753, -544.4978441385393, -389.9666460236229, -519.4348492619648, -423.58932782906845, 114.75382358341739, -371.42140477466364, -320.4249668441544, -430.6061595483298, -401.0115080700385, -459.5824359069675, -440.65442803496217, -496.69272667651666, -478.7982407951224, -380.09894628182866, -629.3857179113388, -144.41912643466577, -460.24007568197743, -492.04190784518386, -302.02616302805836, -415.2075623345715, -608.0024881439374, -511.37634085469324, -405.9730311939276, -408.20511187123856, -274.7033620841109, -297.4398154642928, -151.66450929728705, -398.2753484590599, -249.7173384760756, -558.335073405509, -583.5629755968832, -517.9407461755139, -419.67468360307606, -30.350840239034095, -485.210726404875, -422.6389454565336, -431.67697643779337, -410.0669129320793, -373.20144343550356, -460.31868509867803, -562.4323899631064, -418.574053316192, -304.39204782230945, -502.358014855935, -360.18422935691467, -336.51897180028396, -285.6225280622415, -361.3386667722361, -321.5361194641303, -132.3317462153979, -512.3197176664892, -503.67713919162577, -211.34850636284125, -436.3130569803658, -500.5803669466931, 131.4141687701945, -470.65661774889384, -506.7189639660614, -211.12759655415925, -354.00519320339055, -524.9513974617058, -356.41416869309126, -122.51561694979819, -393.8368177410664, -486.847118408309, -341.1386681116448, -567.4731126362826, -586.5382444373815, -474.09275758104803, -375.5054041839696, -390.5968097621185, -158.90348501248974, -477.7920785230476, -428.33672724353613, -424.86390957870526, -565.7591748749471, -526.502779624934, -346.34144035926033, -407.7995095929509, -315.2172413228315, -433.5189809244217, -600.4864974748164, -491.32870533214503, -470.7231985606332, -416.20290390842916, 1.1253481736776971, -502.0697137259262, -422.1351053319663, -329.5783547751479, -584.9700041549888, -263.12399434460235, -318.9424710173882, -312.5048587635068, -430.04171072956245, -363.6699804787747, -330.09787109879977, -279.70756943903524, -96.68523243597707, -366.40062420372954, -178.52840032671804, -55.33956817525632, -476.06686747413005, -496.22281452425455], "policy_predator_policy_reward": [320.7052087211459, 597.7405892954919, 3.3126159998282594, 611.8691193804073, 516.5945562913458, 490.16501591767513, 445.62493967392703, 436.87745782451526, 384.402820193647, 375.3879907916188, 394.29235708255294, 364.3964638955676, 319.1041113348493, 475.4948673122204, 515.8282035873499, 575.3029537106735, 335.8876910253889, 366.5394590731695, 460.28787423286565, 456.72556336886885, 478.84045354561397, 378.61709227201465, 412.295260954649, 484.75913703450084, 359.641506501114, 492.7289062849745, 202.8194537549045, 461.5256049874833, 374.59504512845035, 237.16923489674954, 297.8693192437962, 491.48084009318893, 247.50384352371148, 412.1057136980278, 461.02246852149153, 181.07257282043588, 541.9962502306447, 379.96688075914767, 481.6957494597605, 300.80588700019496, 332.4830543323385, 482.9698539145205, 331.9464016386213, 421.55393365931593, 507.4791251287272, 326.3082809325396, 139.4389279688307, 333.88815247868195, 261.6114733245148, 361.9366893273098, 470.7791364603482, 229.03938194121454, 577.122673350677, 514.3881234160424, 364.8243093866163, 251.04493755055083, 413.4979461824797, 547.2158953398567, 468.3316313846012, 467.47340505196547, 367.9991895742338, 362.33419808960315, 295.3434847380543, 642.523065425285, 282.9415331273896, 461.3261073793331, 541.7382639590278, 448.7021360044184, 275.7719783292666, 318.41061880001087, 563.0386443863761, 88.66627074405442, 415.43026303638203, 666.1762075663082, 376.01487380130743, 489.8630252938773, 521.8104021285437, 469.1569975562355, 424.64553056351485, 367.80821576338275, 573.8910045352634, 285.52728051908304, 313.3650235334032, 414.67923797607796, 315.42060803271903, 356.4426199672109, 523.8479747429296, 496.89935254721416, 401.854729906694, 450.54485619408484, 346.09519077323057, 330.20547119672256, 126.80342773301189, 427.3976921415076, 418.9594210254051, 240.86249761585887, 340.1040945873647, 543.2708376659044, 415.7658159253328, 499.6966251102799, 389.5076653454337, 186.67432437369933, 399.8944383395055, 345.29740415398487, 430.7061595483297, 401.1015080700384, 460.63243590696743, 440.68442803496214, 593.8760945270333, 459.43651300311285, 427.00006943551983, 620.1507248210428, 401.5600579811697, 316.72972119057715, 492.0819078451839, 302.29616302805834, 415.26756233457144, 608.0024881439374, 511.37634085469324, 406.44506914332163, 402.40731082771885, 350.092452681681, 314.5598154642927, 221.79450929728694, 386.0879013012075, 363.9625310281334, 588.6772349744796, 568.6394094005577, 497.0816909015696, 481.83241187203015, 257.572526393552, 418.5252266478417, 457.85046575742916, 419.31108638255085, 383.61307744314803, 387.48690091539555, 473.8986850986781, 562.4323899631064, 418.73405331619205, 305.8320478223095, 503.378014855935, 361.5944193009594, 354.8623362848149, 333.1281147254765, 361.47866677223607, 321.7561194641301, 514.3059733068623, 251.41521089659312, 449.2378988367182, 388.11202161542684, 436.3230569803658, 500.5903669466931, 385.01859823685925, 328.6799791520114, 467.9076834555439, 380.2573928696766, 356.02519320339053, 525.9613974617058, 341.10139092867786, 371.65480955092676, 459.45073203075145, 422.8201686547138, 348.66467123591354, 547.700083387483, 473.5725319738249, 589.3454690103033, 375.75540418396946, 390.6768097621184, 189.13141803762858, 480.38993475365186, 425.7556222435726, 422.3905524022075, 594.1399845499578, 520.0339118452152, 463.75166312615886, 326.76902292571106, 354.0156197642445, 406.33468353011347, 600.4864974748164, 491.358705332145, 473.0531985606329, 416.2629039084291, 193.78484711875657, 445.22827158899776, 427.2351053319662, 330.25844591377836, 585.0000041549888, 303.2339943446022, 300.0763288449812, 320.832983055996, 489.4940651864254, 310.07121554814256, 334.0908148845519, 349.2425716970097, 281.4655485609455, 327.24871116831076, 203.55108585432814, 258.22647845708735, 497.8851098401208, 497.15210517940557]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.250480393918955, "mean_inference_ms": 47.06243842625145, "mean_action_processing_ms": 0.25799185841304584, "mean_env_wait_ms": 6.753414984057559, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0047168731689453125, "StateBufferConnector_ms": 0.0033969879150390625, "ViewRequirementAgentConnector_ms": 0.10962748527526855}, "num_episodes": 18, "episode_return_max": 435.0438056381757, "episode_return_min": -83.82845376464707, "episode_return_mean": 61.03700708570252, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 944000, "num_agent_steps_trained": 944000, "num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 0.6257642488086989, "num_env_steps_trained_throughput_per_sec": 0.6257642488086989, "timesteps_total": 236000, "num_env_steps_sampled_lifetime": 236000, "num_agent_steps_sampled_lifetime": 944000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 944000, "timers": {"training_iteration_time_ms": 2318175.905, "restore_workers_time_ms": 0.016, "training_step_time_ms": 2318175.816, "sample_time_ms": 2271.723, "learn_time_ms": 2315877.349, "learn_throughput": 1.727, "synch_weights_time_ms": 21.257}, "counters": {"num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_agent_steps_sampled": 944000, "num_agent_steps_trained": 944000}, "done": false, "training_iteration": 59, "trial_id": "b941d_00000", "date": "2024-08-18_12-58-10", "timestamp": 1723966090, "time_this_iter_s": 6392.23068189621, "time_total_s": 104654.24378180504, "pid": 81115, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[32, [4, 4], 2], [64, [3, 3], 2], [128, [3, 3], 1]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [256, 256], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b295d550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 104654.24378180504, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 27.795408163265304, "ram_util_percent": 80.59693877551021}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 12.861355407528146, "cur_kl_coeff": 1.5187500000000005, "cur_lr": 0.00010000000000000003, "total_loss": 7.830034301646803, "policy_loss": -0.08492288947925858, "vf_loss": 7.892777148251811, "vf_explained_var": 0.3690757454072357, "kl": 0.014604145912558814, "entropy": 0.9918551111032092, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 112455.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.701700615252136, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.00010000000000000003, "total_loss": 7.905228983157526, "policy_loss": -0.07334742610732084, "vf_loss": 7.9623891893518035, "vf_explained_var": 0.05561760783826233, "kl": 0.015987390401634306, "entropy": 0.75632229595588, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 112455.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_agent_steps_sampled": 960000, "num_agent_steps_trained": 960000}, "env_runners": {"episode_reward_max": 435.0438056381757, "episode_reward_min": -27.797685826082958, "episode_reward_mean": 70.45794164217723, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -683.5958950656687, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 179.8702222224401, "predator_policy": 683.5958950656687}, "policy_reward_mean": {"prey_policy": -366.0848058122233, "predator_policy": 401.31377663331193}, "custom_metrics": {}, "hist_stats": {"episode_reward": [109.07232969159215, 333.72178971632695, 306.19345247250476, 0.9406130780340642, 12.383520939809868, 27.20000000000003, 0.0600000000000005, 435.0438056381757, 55.129999999999995, 88.866138015677, 0.03000000000000913, 132.45738770998034, 35.55270252977462, 55.428177543001496, 14.625667342618286, 0.06999999999998785, 33.38489499226677, 0.5361271081714496, 176.26408246195953, 1.101124502183249, 4.529526086944072, 80.27063873954495, 11.920005916365682, 52.92269326713894, 67.6997687676577, 0.9004884258543029, 6.060945750025235, 267.3464854734815, 53.34547087467265, 0.18999999999999373, 1.080000000000004, 77.82164005850721, 37.666130063395315, 113.63057705510397, 0.30999999999999583, 0.06000000000000405, 0.472037949394041, 69.59128955405045, 87.24999999999999, 102.05774539420544, 15.418595372644628, 41.298672995009724, 160.53618639748385, 22.84563024565348, -12.168378009039117, 13.579999999999991, 1.5999999999999996, 2.4301899440447894, 65.8489511477662, 0.35999999999999477, 121.0697203215684, 122.32427489767932, 0.01999999999999802, 374.4561284101712, 130.31851580499992, 3.0300000000000047, 233.82641483671557, 1.5869645360900642, -12.247026124530926, 2.2869989656985923, 0.33000000000000007, 32.8257892557434, -5.054462176461492, 21.91194189529192, 36.379736099659056, 11.614081047105039, 0.030000000000001137, 2.3899999999999952, 138.06875315550522, 5.780091138630453, 40.14, -10.53801787991748, 5.853589526230527, 73.52794604372677, 145.62840308954975, 227.9095958094413, 22.747533021141845, -27.797685826082958, 182.33764607018787, 1.0899999999999972, 120.12000000000025, 332.0140922920899, 56.96140374805529, 45.72733800497579, 218.61613166263794, 13.140831551799527, 93.32038516692803, 0.12000000000000122, 333.4221063394371, 40.503450907775814, 29.130000000000003, 98.90769712296517, 125.79117820607517, 4.441402772720052, 7.777158572943822, 9.488585602767666, 54.22123512655236, 0.029999999999989813, 286.2471300098766, 129.03], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-397.16669294454255, 32.91194218862114, -445.2961049628019, 155.46973202730396, 38.09268977288989, -431.71775570194836, -576.822673350677, -513.7475103380083, -282.64940644096686, -320.8363195563913, -386.4779461824796, -547.0358953398568, -468.29163138460126, -467.4534050519655, -475.1598042481014, 179.8702222224401, -240.21348473805443, -642.523065425285, -148.67396335930468, -506.7275391317409, -541.7082639590278, -448.7021360044184, -128.69392000946561, -333.03128940983186, -613.7387440354355, -2.4134685652202306, -467.7337911762347, -558.4445018834547, -363.4212616675811, -487.83097008498544, -521.7404021285438, -469.1569975562355, -279.0655273305887, -480.0033240040423, -574.006469295631, -284.8756886505442, -130.54992045068008, -421.230258596842, -349.41535647814936, -321.34674701959744, -552.1899617939904, -464.0278394092098, -320.8464655008426, -451.28248186039144, -351.7960405795828, -312.58461547400486, -78.14961212817008, -423.1288144792095, -86.04218418613429, -506.07996568747126, -337.9765996888753, -544.4978441385393, -389.9666460236229, -519.4348492619648, -423.58932782906845, 114.75382358341739, -371.42140477466364, -320.4249668441544, -430.6061595483298, -401.0115080700385, -459.5824359069675, -440.65442803496217, -496.69272667651666, -478.7982407951224, -380.09894628182866, -629.3857179113388, -144.41912643466577, -460.24007568197743, -492.04190784518386, -302.02616302805836, -415.2075623345715, -608.0024881439374, -511.37634085469324, -405.9730311939276, -408.20511187123856, -274.7033620841109, -297.4398154642928, -151.66450929728705, -398.2753484590599, -249.7173384760756, -558.335073405509, -583.5629755968832, -517.9407461755139, -419.67468360307606, -30.350840239034095, -485.210726404875, -422.6389454565336, -431.67697643779337, -410.0669129320793, -373.20144343550356, -460.31868509867803, -562.4323899631064, -418.574053316192, -304.39204782230945, -502.358014855935, -360.18422935691467, -336.51897180028396, -285.6225280622415, -361.3386667722361, -321.5361194641303, -132.3317462153979, -512.3197176664892, -503.67713919162577, -211.34850636284125, -436.3130569803658, -500.5803669466931, 131.4141687701945, -470.65661774889384, -506.7189639660614, -211.12759655415925, -354.00519320339055, -524.9513974617058, -356.41416869309126, -122.51561694979819, -393.8368177410664, -486.847118408309, -341.1386681116448, -567.4731126362826, -586.5382444373815, -474.09275758104803, -375.5054041839696, -390.5968097621185, -158.90348501248974, -477.7920785230476, -428.33672724353613, -424.86390957870526, -565.7591748749471, -526.502779624934, -346.34144035926033, -407.7995095929509, -315.2172413228315, -433.5189809244217, -600.4864974748164, -491.32870533214503, -470.7231985606332, -416.20290390842916, 1.1253481736776971, -502.0697137259262, -422.1351053319663, -329.5783547751479, -584.9700041549888, -263.12399434460235, -318.9424710173882, -312.5048587635068, -430.04171072956245, -363.6699804787747, -330.09787109879977, -279.70756943903524, -96.68523243597707, -366.40062420372954, -178.52840032671804, -55.33956817525632, -476.06686747413005, -496.22281452425455, -403.0127560496133, -51.22865135415317, -468.11796723033405, 174.0000273246313, -330.2382240734783, -623.4014584289672, -0.8472672237812588, 2.0000000000000013, -16.445153131538405, 83.92223529665267, -530.0323572606077, -587.1160087418908, -546.3582561614082, -249.31390749318973, -428.01400930569116, -56.03938371726207, -449.77827687796184, -312.37908156794725, -576.0720563733714, -2.467650793689451, -625.5861163703659, -507.4754077387722, -426.54187559371604, 120.50855807034765, -370.10631483151036, -280.3341033107328, -603.1645240371691, -269.64400630442316, -292.39123815012493, -565.2315805102979, -427.4695869643832, 2.0000000000000013, -569.5549891967247, -359.94884082325495, -550.2383339242781, -486.75820785753956, -343.0983783949529, -379.5781046829642, -383.2040876490158, -376.2572269200775, -462.2123588395787, -677.0502526379045, -515.5613833580086, -84.84742002736695, -683.5958950656687, 9.932813950268496], "policy_predator_policy_reward": [139.4389279688307, 333.88815247868195, 261.6114733245148, 361.9366893273098, 470.7791364603482, 229.03938194121454, 577.122673350677, 514.3881234160424, 364.8243093866163, 251.04493755055083, 413.4979461824797, 547.2158953398567, 468.3316313846012, 467.47340505196547, 367.9991895742338, 362.33419808960315, 295.3434847380543, 642.523065425285, 282.9415331273896, 461.3261073793331, 541.7382639590278, 448.7021360044184, 275.7719783292666, 318.41061880001087, 563.0386443863761, 88.66627074405442, 415.43026303638203, 666.1762075663082, 376.01487380130743, 489.8630252938773, 521.8104021285437, 469.1569975562355, 424.64553056351485, 367.80821576338275, 573.8910045352634, 285.52728051908304, 313.3650235334032, 414.67923797607796, 315.42060803271903, 356.4426199672109, 523.8479747429296, 496.89935254721416, 401.854729906694, 450.54485619408484, 346.09519077323057, 330.20547119672256, 126.80342773301189, 427.3976921415076, 418.9594210254051, 240.86249761585887, 340.1040945873647, 543.2708376659044, 415.7658159253328, 499.6966251102799, 389.5076653454337, 186.67432437369933, 399.8944383395055, 345.29740415398487, 430.7061595483297, 401.1015080700384, 460.63243590696743, 440.68442803496214, 593.8760945270333, 459.43651300311285, 427.00006943551983, 620.1507248210428, 401.5600579811697, 316.72972119057715, 492.0819078451839, 302.29616302805834, 415.26756233457144, 608.0024881439374, 511.37634085469324, 406.44506914332163, 402.40731082771885, 350.092452681681, 314.5598154642927, 221.79450929728694, 386.0879013012075, 363.9625310281334, 588.6772349744796, 568.6394094005577, 497.0816909015696, 481.83241187203015, 257.572526393552, 418.5252266478417, 457.85046575742916, 419.31108638255085, 383.61307744314803, 387.48690091539555, 473.8986850986781, 562.4323899631064, 418.73405331619205, 305.8320478223095, 503.378014855935, 361.5944193009594, 354.8623362848149, 333.1281147254765, 361.47866677223607, 321.7561194641301, 514.3059733068623, 251.41521089659312, 449.2378988367182, 388.11202161542684, 436.3230569803658, 500.5903669466931, 385.01859823685925, 328.6799791520114, 467.9076834555439, 380.2573928696766, 356.02519320339053, 525.9613974617058, 341.10139092867786, 371.65480955092676, 459.45073203075145, 422.8201686547138, 348.66467123591354, 547.700083387483, 473.5725319738249, 589.3454690103033, 375.75540418396946, 390.6768097621184, 189.13141803762858, 480.38993475365186, 425.7556222435726, 422.3905524022075, 594.1399845499578, 520.0339118452152, 463.75166312615886, 326.76902292571106, 354.0156197642445, 406.33468353011347, 600.4864974748164, 491.358705332145, 473.0531985606329, 416.2629039084291, 193.78484711875657, 445.22827158899776, 427.2351053319662, 330.25844591377836, 585.0000041549888, 303.2339943446022, 300.0763288449812, 320.832983055996, 489.4940651864254, 310.07121554814256, 334.0908148845519, 349.2425716970097, 281.4655485609455, 327.24871116831076, 203.55108585432814, 258.22647845708735, 497.8851098401208, 497.15210517940557, 426.44372157768356, 0.0, 472.2779672303339, 4.177618745556617, 330.30822407347824, 624.4214584289672, 118.96726722378129, 0.0, 143.30956669961574, 121.22744342735994, 594.8054206847305, 579.3043490658239, 546.3582561614082, 295.04124549816527, 371.09878741713436, 331.5707372684568, 377.8591420045828, 397.4390479931259, 582.6826378826288, 89.17745445136015, 625.5861163703659, 507.5954077387721, 397.2225843048897, 242.2328395579163, 371.34976573928617, 319.5941033107327, 606.1745240371691, 295.76400630442305, 513.5389167340702, 442.9915990493173, 372.25378040118295, 179.006984769275, 346.7360031792999, 587.2092296134002, 552.0981982392484, 492.6755021155128, 352.36111450998726, 379.803954170697, 283.4856383736755, 530.1969113219699, 462.2423588395787, 677.0502526379045, 415.75355499746286, 470.90237839778894, 683.5958950656687, 119.09718604973152]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.1599597270961794, "mean_inference_ms": 46.165038327998424, "mean_action_processing_ms": 0.2577989563306948, "mean_env_wait_ms": 6.6506454306231175, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004955291748046875, "StateBufferConnector_ms": 0.0034731626510620117, "ViewRequirementAgentConnector_ms": 0.1139371395111084}, "num_episodes": 23, "episode_return_max": 435.0438056381757, "episode_return_min": -27.797685826082958, "episode_return_mean": 70.45794164217723, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 960000, "num_agent_steps_trained": 960000, "num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 0.548233576260005, "num_env_steps_trained_throughput_per_sec": 0.548233576260005, "timesteps_total": 240000, "num_env_steps_sampled_lifetime": 240000, "num_agent_steps_sampled_lifetime": 960000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 960000, "timers": {"training_iteration_time_ms": 3033921.608, "restore_workers_time_ms": 0.016, "training_step_time_ms": 3033921.519, "sample_time_ms": 2242.566, "learn_time_ms": 3031652.403, "learn_throughput": 1.319, "synch_weights_time_ms": 21.237}, "counters": {"num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_agent_steps_sampled": 960000, "num_agent_steps_trained": 960000}, "done": false, "training_iteration": 60, "trial_id": "b941d_00000", "date": "2024-08-18_14-59-47", "timestamp": 1723973387, "time_this_iter_s": 7296.260753154755, "time_total_s": 111950.5045349598, "pid": 81115, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[32, [4, 4], 2], [64, [3, 3], 2], [128, [3, 3], 1]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [256, 256], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b04b4f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 111950.5045349598, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 32.89402985074627, "ram_util_percent": 81.18955223880599}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 11.62595700120169, "cur_kl_coeff": 1.5187500000000005, "cur_lr": 0.00010000000000000003, "total_loss": 8.182750467522434, "policy_loss": -0.08636111503654213, "vf_loss": 8.246661183443019, "vf_explained_var": 0.3422985882040054, "kl": 0.01478214760895017, "entropy": 0.9594425808815729, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 114345.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 12.687043903302895, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.00010000000000000003, "total_loss": 8.776682330691624, "policy_loss": -0.08528994482907432, "vf_loss": 8.844163241462102, "vf_explained_var": -0.38234141585688114, "kl": 0.01758916830142573, "entropy": 0.7857093127947005, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 114345.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_agent_steps_sampled": 976000, "num_agent_steps_trained": 976000}, "env_runners": {"episode_reward_max": 374.4561284101712, "episode_reward_min": -33.89672650450788, "episode_reward_mean": 71.89570684666324, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -683.5958950656687, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 683.5958950656687}, "policy_reward_mean": {"prey_policy": -356.9680801441072, "predator_policy": 392.91593356743874}, "custom_metrics": {}, "hist_stats": {"episode_reward": [176.26408246195953, 1.101124502183249, 4.529526086944072, 80.27063873954495, 11.920005916365682, 52.92269326713894, 67.6997687676577, 0.9004884258543029, 6.060945750025235, 267.3464854734815, 53.34547087467265, 0.18999999999999373, 1.080000000000004, 77.82164005850721, 37.666130063395315, 113.63057705510397, 0.30999999999999583, 0.06000000000000405, 0.472037949394041, 69.59128955405045, 87.24999999999999, 102.05774539420544, 15.418595372644628, 41.298672995009724, 160.53618639748385, 22.84563024565348, -12.168378009039117, 13.579999999999991, 1.5999999999999996, 2.4301899440447894, 65.8489511477662, 0.35999999999999477, 121.0697203215684, 122.32427489767932, 0.01999999999999802, 374.4561284101712, 130.31851580499992, 3.0300000000000047, 233.82641483671557, 1.5869645360900642, -12.247026124530926, 2.2869989656985923, 0.33000000000000007, 32.8257892557434, -5.054462176461492, 21.91194189529192, 36.379736099659056, 11.614081047105039, 0.030000000000001137, 2.3899999999999952, 138.06875315550522, 5.780091138630453, 40.14, -10.53801787991748, 5.853589526230527, 73.52794604372677, 145.62840308954975, 227.9095958094413, 22.747533021141845, -27.797685826082958, 182.33764607018787, 1.0899999999999972, 120.12000000000025, 332.0140922920899, 56.96140374805529, 45.72733800497579, 218.61613166263794, 13.140831551799527, 93.32038516692803, 0.12000000000000122, 333.4221063394371, 40.503450907775814, 29.130000000000003, 98.90769712296517, 125.79117820607517, 4.441402772720052, 7.777158572943822, 9.488585602767666, 54.22123512655236, 0.029999999999989813, 286.2471300098766, 129.03, 201.45325988222598, 143.19058278149396, 256.51572441826613, 33.43562285821479, 78.39971812447514, 18.956826995100236, 6.25, -33.89672650450788, 59.17999999999999, 0.13999999999999635, 224.15538826264086, 26.852853328369655, 214.77737730974542, 325.16186801725627, 138.9736828176278, 5.322133978775394, 101.8782584526151, -16.273443495764912], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-130.54992045068008, -421.230258596842, -349.41535647814936, -321.34674701959744, -552.1899617939904, -464.0278394092098, -320.8464655008426, -451.28248186039144, -351.7960405795828, -312.58461547400486, -78.14961212817008, -423.1288144792095, -86.04218418613429, -506.07996568747126, -337.9765996888753, -544.4978441385393, -389.9666460236229, -519.4348492619648, -423.58932782906845, 114.75382358341739, -371.42140477466364, -320.4249668441544, -430.6061595483298, -401.0115080700385, -459.5824359069675, -440.65442803496217, -496.69272667651666, -478.7982407951224, -380.09894628182866, -629.3857179113388, -144.41912643466577, -460.24007568197743, -492.04190784518386, -302.02616302805836, -415.2075623345715, -608.0024881439374, -511.37634085469324, -405.9730311939276, -408.20511187123856, -274.7033620841109, -297.4398154642928, -151.66450929728705, -398.2753484590599, -249.7173384760756, -558.335073405509, -583.5629755968832, -517.9407461755139, -419.67468360307606, -30.350840239034095, -485.210726404875, -422.6389454565336, -431.67697643779337, -410.0669129320793, -373.20144343550356, -460.31868509867803, -562.4323899631064, -418.574053316192, -304.39204782230945, -502.358014855935, -360.18422935691467, -336.51897180028396, -285.6225280622415, -361.3386667722361, -321.5361194641303, -132.3317462153979, -512.3197176664892, -503.67713919162577, -211.34850636284125, -436.3130569803658, -500.5803669466931, 131.4141687701945, -470.65661774889384, -506.7189639660614, -211.12759655415925, -354.00519320339055, -524.9513974617058, -356.41416869309126, -122.51561694979819, -393.8368177410664, -486.847118408309, -341.1386681116448, -567.4731126362826, -586.5382444373815, -474.09275758104803, -375.5054041839696, -390.5968097621185, -158.90348501248974, -477.7920785230476, -428.33672724353613, -424.86390957870526, -565.7591748749471, -526.502779624934, -346.34144035926033, -407.7995095929509, -315.2172413228315, -433.5189809244217, -600.4864974748164, -491.32870533214503, -470.7231985606332, -416.20290390842916, 1.1253481736776971, -502.0697137259262, -422.1351053319663, -329.5783547751479, -584.9700041549888, -263.12399434460235, -318.9424710173882, -312.5048587635068, -430.04171072956245, -363.6699804787747, -330.09787109879977, -279.70756943903524, -96.68523243597707, -366.40062420372954, -178.52840032671804, -55.33956817525632, -476.06686747413005, -496.22281452425455, -403.0127560496133, -51.22865135415317, -468.11796723033405, 174.0000273246313, -330.2382240734783, -623.4014584289672, -0.8472672237812588, 2.0000000000000013, -16.445153131538405, 83.92223529665267, -530.0323572606077, -587.1160087418908, -546.3582561614082, -249.31390749318973, -428.01400930569116, -56.03938371726207, -449.77827687796184, -312.37908156794725, -576.0720563733714, -2.467650793689451, -625.5861163703659, -507.4754077387722, -426.54187559371604, 120.50855807034765, -370.10631483151036, -280.3341033107328, -603.1645240371691, -269.64400630442316, -292.39123815012493, -565.2315805102979, -427.4695869643832, 2.0000000000000013, -569.5549891967247, -359.94884082325495, -550.2383339242781, -486.75820785753956, -343.0983783949529, -379.5781046829642, -383.2040876490158, -376.2572269200775, -462.2123588395787, -677.0502526379045, -515.5613833580086, -84.84742002736695, -683.5958950656687, 9.932813950268496, -472.93971404692473, 0.01598010079692431, -539.8043464062096, -143.48548658377885, 171.4019489518455, -116.41554148589256, -212.75672373841195, -378.82722386077234, -180.7605061089591, -453.39633822886003, -430.0327558657194, -354.70616996371126, -383.66599846682345, -370.5069702289251, -405.62223206437136, -440.6483403817781, -178.44573271840008, -530.0632853513599, -460.3871341302327, -406.53098471066164, 7.048427186310821, -446.9159165766552, -499.8899877325578, -365.4275765153387, -548.0489505417855, -10.654879687152855, 200.0, -503.4215833054388, -130.39342512633894, -442.91175690618724, -353.32166537080286, -495.8542152471502, -71.16993912461513, -483.1189226510623, -354.452813841011, -389.5594733545419], "policy_predator_policy_reward": [313.3650235334032, 414.67923797607796, 315.42060803271903, 356.4426199672109, 523.8479747429296, 496.89935254721416, 401.854729906694, 450.54485619408484, 346.09519077323057, 330.20547119672256, 126.80342773301189, 427.3976921415076, 418.9594210254051, 240.86249761585887, 340.1040945873647, 543.2708376659044, 415.7658159253328, 499.6966251102799, 389.5076653454337, 186.67432437369933, 399.8944383395055, 345.29740415398487, 430.7061595483297, 401.1015080700384, 460.63243590696743, 440.68442803496214, 593.8760945270333, 459.43651300311285, 427.00006943551983, 620.1507248210428, 401.5600579811697, 316.72972119057715, 492.0819078451839, 302.29616302805834, 415.26756233457144, 608.0024881439374, 511.37634085469324, 406.44506914332163, 402.40731082771885, 350.092452681681, 314.5598154642927, 221.79450929728694, 386.0879013012075, 363.9625310281334, 588.6772349744796, 568.6394094005577, 497.0816909015696, 481.83241187203015, 257.572526393552, 418.5252266478417, 457.85046575742916, 419.31108638255085, 383.61307744314803, 387.48690091539555, 473.8986850986781, 562.4323899631064, 418.73405331619205, 305.8320478223095, 503.378014855935, 361.5944193009594, 354.8623362848149, 333.1281147254765, 361.47866677223607, 321.7561194641301, 514.3059733068623, 251.41521089659312, 449.2378988367182, 388.11202161542684, 436.3230569803658, 500.5903669466931, 385.01859823685925, 328.6799791520114, 467.9076834555439, 380.2573928696766, 356.02519320339053, 525.9613974617058, 341.10139092867786, 371.65480955092676, 459.45073203075145, 422.8201686547138, 348.66467123591354, 547.700083387483, 473.5725319738249, 589.3454690103033, 375.75540418396946, 390.6768097621184, 189.13141803762858, 480.38993475365186, 425.7556222435726, 422.3905524022075, 594.1399845499578, 520.0339118452152, 463.75166312615886, 326.76902292571106, 354.0156197642445, 406.33468353011347, 600.4864974748164, 491.358705332145, 473.0531985606329, 416.2629039084291, 193.78484711875657, 445.22827158899776, 427.2351053319662, 330.25844591377836, 585.0000041549888, 303.2339943446022, 300.0763288449812, 320.832983055996, 489.4940651864254, 310.07121554814256, 334.0908148845519, 349.2425716970097, 281.4655485609455, 327.24871116831076, 203.55108585432814, 258.22647845708735, 497.8851098401208, 497.15210517940557, 426.44372157768356, 0.0, 472.2779672303339, 4.177618745556617, 330.30822407347824, 624.4214584289672, 118.96726722378129, 0.0, 143.30956669961574, 121.22744342735994, 594.8054206847305, 579.3043490658239, 546.3582561614082, 295.04124549816527, 371.09878741713436, 331.5707372684568, 377.8591420045828, 397.4390479931259, 582.6826378826288, 89.17745445136015, 625.5861163703659, 507.5954077387721, 397.2225843048897, 242.2328395579163, 371.34976573928617, 319.5941033107327, 606.1745240371691, 295.76400630442305, 513.5389167340702, 442.9915990493173, 372.25378040118295, 179.006984769275, 346.7360031792999, 587.2092296134002, 552.0981982392484, 492.6755021155128, 352.36111450998726, 379.803954170697, 283.4856383736755, 530.1969113219699, 462.2423588395787, 677.0502526379045, 415.75355499746286, 470.90237839778894, 683.5958950656687, 119.09718604973152, 393.43285912919697, 280.94413469915753, 407.7479473489984, 418.7324684224817, 15.445207406103743, 186.08410954620942, 322.6812992265041, 302.3382712308948, 289.1971407954189, 423.3594216668738, 419.6812700410539, 384.0144827834769, 389.70599846682336, 370.71697022892516, 427.3428892781918, 385.0309566634494, 237.59573271839994, 530.0932853513599, 460.46713413023264, 406.5909847106616, 198.43787315088792, 465.5850045020976, 501.7640917210882, 390.40632585517784, 369.75539276794444, 403.72581477073976, 162.57282560628462, 466.01062571641063, 311.68262930380035, 400.5962355463523, 358.64379934957816, 495.8542152471502, 174.08643556657347, 482.08068466171886, 324.14484216588176, 403.594001533906]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.090097523637762, "mean_inference_ms": 45.49787195488655, "mean_action_processing_ms": 0.25767846394577854, "mean_env_wait_ms": 6.551483848126548, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004990577697753906, "StateBufferConnector_ms": 0.003529191017150879, "ViewRequirementAgentConnector_ms": 0.11599838733673096}, "num_episodes": 18, "episode_return_max": 374.4561284101712, "episode_return_min": -33.89672650450788, "episode_return_mean": 71.89570684666324, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 976000, "num_agent_steps_trained": 976000, "num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 0.8638147692495695, "num_env_steps_trained_throughput_per_sec": 0.8638147692495695, "timesteps_total": 244000, "num_env_steps_sampled_lifetime": 244000, "num_agent_steps_sampled_lifetime": 976000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 976000, "timers": {"training_iteration_time_ms": 3391326.781, "restore_workers_time_ms": 0.016, "training_step_time_ms": 3391326.695, "sample_time_ms": 2234.36, "learn_time_ms": 3389066.332, "learn_throughput": 1.18, "synch_weights_time_ms": 20.957}, "counters": {"num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_agent_steps_sampled": 976000, "num_agent_steps_trained": 976000}, "done": false, "training_iteration": 61, "trial_id": "b941d_00000", "date": "2024-08-18_16-16-57", "timestamp": 1723978017, "time_this_iter_s": 4630.680215120316, "time_total_s": 116581.18475008011, "pid": 81115, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[32, [4, 4], 2], [64, [3, 3], 2], [128, [3, 3], 1]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [256, 256], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b295d9d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 116581.18475008011, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 25.740721649484534, "ram_util_percent": 80.96855670103092}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 15.869452503623155, "cur_kl_coeff": 1.5187500000000005, "cur_lr": 0.00010000000000000003, "total_loss": 8.976683105993523, "policy_loss": -0.08717908641205184, "vf_loss": 9.040632330172906, "vf_explained_var": 0.2885166316120713, "kl": 0.015295379737133854, "entropy": 1.0093622115869372, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 116235.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 14.822548775004332, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.00010000000000000003, "total_loss": 8.995815568500095, "policy_loss": -0.07174297564924158, "vf_loss": 9.051507925356507, "vf_explained_var": -0.26775339766154216, "kl": 0.01585247319919829, "entropy": 0.7190968817188627, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 116235.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_agent_steps_sampled": 992000, "num_agent_steps_trained": 992000}, "env_runners": {"episode_reward_max": 374.4561284101712, "episode_reward_min": -33.89672650450788, "episode_reward_mean": 71.78134639771076, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -683.5958950656687, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 683.5958950656687}, "policy_reward_mean": {"prey_policy": -355.9670570985324, "predator_policy": 391.85773029738766}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.472037949394041, 69.59128955405045, 87.24999999999999, 102.05774539420544, 15.418595372644628, 41.298672995009724, 160.53618639748385, 22.84563024565348, -12.168378009039117, 13.579999999999991, 1.5999999999999996, 2.4301899440447894, 65.8489511477662, 0.35999999999999477, 121.0697203215684, 122.32427489767932, 0.01999999999999802, 374.4561284101712, 130.31851580499992, 3.0300000000000047, 233.82641483671557, 1.5869645360900642, -12.247026124530926, 2.2869989656985923, 0.33000000000000007, 32.8257892557434, -5.054462176461492, 21.91194189529192, 36.379736099659056, 11.614081047105039, 0.030000000000001137, 2.3899999999999952, 138.06875315550522, 5.780091138630453, 40.14, -10.53801787991748, 5.853589526230527, 73.52794604372677, 145.62840308954975, 227.9095958094413, 22.747533021141845, -27.797685826082958, 182.33764607018787, 1.0899999999999972, 120.12000000000025, 332.0140922920899, 56.96140374805529, 45.72733800497579, 218.61613166263794, 13.140831551799527, 93.32038516692803, 0.12000000000000122, 333.4221063394371, 40.503450907775814, 29.130000000000003, 98.90769712296517, 125.79117820607517, 4.441402772720052, 7.777158572943822, 9.488585602767666, 54.22123512655236, 0.029999999999989813, 286.2471300098766, 129.03, 201.45325988222598, 143.19058278149396, 256.51572441826613, 33.43562285821479, 78.39971812447514, 18.956826995100236, 6.25, -33.89672650450788, 59.17999999999999, 0.13999999999999635, 224.15538826264086, 26.852853328369655, 214.77737730974542, 325.16186801725627, 138.9736828176278, 5.322133978775394, 101.8782584526151, -16.273443495764912, 1.3926416061106761, 197.58602420806767, 246.32999999999996, 74.11999999999999, 22.851338538084605, 19.988645116825424, -33.63229955991069, 56.91466398195564, 41.03843259743644, 58.81079214818516, 0.049999999999997824, 42.449504875261745, 43.24847853952631, 14.389999999999995, 0.2199999999999982, 153.44048240058135, 1.000000000000005, 1.4848280954602677], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-511.37634085469324, -405.9730311939276, -408.20511187123856, -274.7033620841109, -297.4398154642928, -151.66450929728705, -398.2753484590599, -249.7173384760756, -558.335073405509, -583.5629755968832, -517.9407461755139, -419.67468360307606, -30.350840239034095, -485.210726404875, -422.6389454565336, -431.67697643779337, -410.0669129320793, -373.20144343550356, -460.31868509867803, -562.4323899631064, -418.574053316192, -304.39204782230945, -502.358014855935, -360.18422935691467, -336.51897180028396, -285.6225280622415, -361.3386667722361, -321.5361194641303, -132.3317462153979, -512.3197176664892, -503.67713919162577, -211.34850636284125, -436.3130569803658, -500.5803669466931, 131.4141687701945, -470.65661774889384, -506.7189639660614, -211.12759655415925, -354.00519320339055, -524.9513974617058, -356.41416869309126, -122.51561694979819, -393.8368177410664, -486.847118408309, -341.1386681116448, -567.4731126362826, -586.5382444373815, -474.09275758104803, -375.5054041839696, -390.5968097621185, -158.90348501248974, -477.7920785230476, -428.33672724353613, -424.86390957870526, -565.7591748749471, -526.502779624934, -346.34144035926033, -407.7995095929509, -315.2172413228315, -433.5189809244217, -600.4864974748164, -491.32870533214503, -470.7231985606332, -416.20290390842916, 1.1253481736776971, -502.0697137259262, -422.1351053319663, -329.5783547751479, -584.9700041549888, -263.12399434460235, -318.9424710173882, -312.5048587635068, -430.04171072956245, -363.6699804787747, -330.09787109879977, -279.70756943903524, -96.68523243597707, -366.40062420372954, -178.52840032671804, -55.33956817525632, -476.06686747413005, -496.22281452425455, -403.0127560496133, -51.22865135415317, -468.11796723033405, 174.0000273246313, -330.2382240734783, -623.4014584289672, -0.8472672237812588, 2.0000000000000013, -16.445153131538405, 83.92223529665267, -530.0323572606077, -587.1160087418908, -546.3582561614082, -249.31390749318973, -428.01400930569116, -56.03938371726207, -449.77827687796184, -312.37908156794725, -576.0720563733714, -2.467650793689451, -625.5861163703659, -507.4754077387722, -426.54187559371604, 120.50855807034765, -370.10631483151036, -280.3341033107328, -603.1645240371691, -269.64400630442316, -292.39123815012493, -565.2315805102979, -427.4695869643832, 2.0000000000000013, -569.5549891967247, -359.94884082325495, -550.2383339242781, -486.75820785753956, -343.0983783949529, -379.5781046829642, -383.2040876490158, -376.2572269200775, -462.2123588395787, -677.0502526379045, -515.5613833580086, -84.84742002736695, -683.5958950656687, 9.932813950268496, -472.93971404692473, 0.01598010079692431, -539.8043464062096, -143.48548658377885, 171.4019489518455, -116.41554148589256, -212.75672373841195, -378.82722386077234, -180.7605061089591, -453.39633822886003, -430.0327558657194, -354.70616996371126, -383.66599846682345, -370.5069702289251, -405.62223206437136, -440.6483403817781, -178.44573271840008, -530.0632853513599, -460.3871341302327, -406.53098471066164, 7.048427186310821, -446.9159165766552, -499.8899877325578, -365.4275765153387, -548.0489505417855, -10.654879687152855, 200.0, -503.4215833054388, -130.39342512633894, -442.91175690618724, -353.32166537080286, -495.8542152471502, -71.16993912461513, -483.1189226510623, -354.452813841011, -389.5594733545419, -466.19784103241034, -460.451631948669, -217.21658892380964, -416.63076150207894, 20.36798073786136, -2.6079105433259464, -586.0684577266412, -154.84311476726515, -309.17395636155527, -377.50763130952964, -294.1027613393108, -475.06553770717767, -481.66345372464434, -491.2202514937066, -614.5149699594983, -180.642881925939, -482.1784638489687, -140.41700775454083, -649.9385394559281, -109.56200424130628, -403.08414092948146, -606.7115262404989, -371.90310861354726, -388.38683020668225, -441.63017801881983, -427.033029237467, -601.9750809031561, -313.19814166465846, -337.96350886230607, -502.1181750806654, -19.608585671062997, -390.48865085784894, -580.1316102909557, -464.86278991073743, -410.9658373257608, -350.09397755819987], "policy_predator_policy_reward": [511.37634085469324, 406.44506914332163, 402.40731082771885, 350.092452681681, 314.5598154642927, 221.79450929728694, 386.0879013012075, 363.9625310281334, 588.6772349744796, 568.6394094005577, 497.0816909015696, 481.83241187203015, 257.572526393552, 418.5252266478417, 457.85046575742916, 419.31108638255085, 383.61307744314803, 387.48690091539555, 473.8986850986781, 562.4323899631064, 418.73405331619205, 305.8320478223095, 503.378014855935, 361.5944193009594, 354.8623362848149, 333.1281147254765, 361.47866677223607, 321.7561194641301, 514.3059733068623, 251.41521089659312, 449.2378988367182, 388.11202161542684, 436.3230569803658, 500.5903669466931, 385.01859823685925, 328.6799791520114, 467.9076834555439, 380.2573928696766, 356.02519320339053, 525.9613974617058, 341.10139092867786, 371.65480955092676, 459.45073203075145, 422.8201686547138, 348.66467123591354, 547.700083387483, 473.5725319738249, 589.3454690103033, 375.75540418396946, 390.6768097621184, 189.13141803762858, 480.38993475365186, 425.7556222435726, 422.3905524022075, 594.1399845499578, 520.0339118452152, 463.75166312615886, 326.76902292571106, 354.0156197642445, 406.33468353011347, 600.4864974748164, 491.358705332145, 473.0531985606329, 416.2629039084291, 193.78484711875657, 445.22827158899776, 427.2351053319662, 330.25844591377836, 585.0000041549888, 303.2339943446022, 300.0763288449812, 320.832983055996, 489.4940651864254, 310.07121554814256, 334.0908148845519, 349.2425716970097, 281.4655485609455, 327.24871116831076, 203.55108585432814, 258.22647845708735, 497.8851098401208, 497.15210517940557, 426.44372157768356, 0.0, 472.2779672303339, 4.177618745556617, 330.30822407347824, 624.4214584289672, 118.96726722378129, 0.0, 143.30956669961574, 121.22744342735994, 594.8054206847305, 579.3043490658239, 546.3582561614082, 295.04124549816527, 371.09878741713436, 331.5707372684568, 377.8591420045828, 397.4390479931259, 582.6826378826288, 89.17745445136015, 625.5861163703659, 507.5954077387721, 397.2225843048897, 242.2328395579163, 371.34976573928617, 319.5941033107327, 606.1745240371691, 295.76400630442305, 513.5389167340702, 442.9915990493173, 372.25378040118295, 179.006984769275, 346.7360031792999, 587.2092296134002, 552.0981982392484, 492.6755021155128, 352.36111450998726, 379.803954170697, 283.4856383736755, 530.1969113219699, 462.2423588395787, 677.0502526379045, 415.75355499746286, 470.90237839778894, 683.5958950656687, 119.09718604973152, 393.43285912919697, 280.94413469915753, 407.7479473489984, 418.7324684224817, 15.445207406103743, 186.08410954620942, 322.6812992265041, 302.3382712308948, 289.1971407954189, 423.3594216668738, 419.6812700410539, 384.0144827834769, 389.70599846682336, 370.71697022892516, 427.3428892781918, 385.0309566634494, 237.59573271839994, 530.0932853513599, 460.46713413023264, 406.5909847106616, 198.43787315088792, 465.5850045020976, 501.7640917210882, 390.40632585517784, 369.75539276794444, 403.72581477073976, 162.57282560628462, 466.01062571641063, 311.68262930380035, 400.5962355463523, 358.64379934957816, 495.8542152471502, 174.08643556657347, 482.08068466171886, 324.14484216588176, 403.594001533906, 466.19784103241034, 461.84427355477953, 518.528788778657, 312.90458585529905, 111.71201926213868, 116.85791054332606, 589.0684577266412, 225.9631147672651, 231.88961987802244, 477.6433063311468, 456.35329296435935, 332.8036511989538, 462.84651204617217, 476.4048936122681, 588.0286612341114, 264.0438546332814, 539.7359347495686, 123.89796945137714, 649.9385394559281, 168.37279638949136, 403.1341409294814, 606.7115262404989, 414.9427348647481, 387.79670883074306, 532.7144578856331, 379.1972279101799, 601.9750809031561, 327.5881416646581, 338.183508862306, 502.1181750806654, 186.28031090741393, 377.2574080220791, 581.1316102909556, 464.86278991073743, 307.53637688621507, 455.00826609320546]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.022289588753303, "mean_inference_ms": 44.85269427785455, "mean_action_processing_ms": 0.2574720503712502, "mean_env_wait_ms": 6.4555817527540675, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005408883094787598, "StateBufferConnector_ms": 0.003550887107849121, "ViewRequirementAgentConnector_ms": 0.1104966402053833}, "num_episodes": 18, "episode_return_max": 374.4561284101712, "episode_return_min": -33.89672650450788, "episode_return_mean": 71.78134639771076, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 992000, "num_agent_steps_trained": 992000, "num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 0.6294223020927376, "num_env_steps_trained_throughput_per_sec": 0.6294223020927376, "timesteps_total": 248000, "num_env_steps_sampled_lifetime": 248000, "num_agent_steps_sampled_lifetime": 992000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 992000, "timers": {"training_iteration_time_ms": 3886971.854, "restore_workers_time_ms": 0.016, "training_step_time_ms": 3886971.767, "sample_time_ms": 2030.098, "learn_time_ms": 3884916.278, "learn_throughput": 1.03, "synch_weights_time_ms": 20.78}, "counters": {"num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_agent_steps_sampled": 992000, "num_agent_steps_trained": 992000}, "done": false, "training_iteration": 62, "trial_id": "b941d_00000", "date": "2024-08-18_18-02-52", "timestamp": 1723984372, "time_this_iter_s": 6355.080920219421, "time_total_s": 122936.26567029953, "pid": 81115, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[32, [4, 4], 2], [64, [3, 3], 2], [128, [3, 3], 1]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [256, 256], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b04b4f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 122936.26567029953, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 28.769035532994923, "ram_util_percent": 80.95989847715737}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 11.90739953757594, "cur_kl_coeff": 1.5187500000000005, "cur_lr": 0.00010000000000000003, "total_loss": 7.960534365467294, "policy_loss": -0.08836342934863987, "vf_loss": 8.026572613236766, "vf_explained_var": 0.295994243703822, "kl": 0.014699710324544582, "entropy": 0.9627776015057135, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 118125.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.203251120526955, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.00010000000000000003, "total_loss": 9.182770906175886, "policy_loss": -0.0850960489044646, "vf_loss": 9.250349857693626, "vf_explained_var": -0.3958043472476737, "kl": 0.017300833576926994, "entropy": 0.7777866688039567, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 118125.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_agent_steps_sampled": 1008000, "num_agent_steps_trained": 1008000}, "env_runners": {"episode_reward_max": 383.70198348164445, "episode_reward_min": -33.89672650450788, "episode_reward_mean": 77.08820735496047, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -685.835208229548, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 685.835208229548}, "policy_reward_mean": {"prey_policy": -346.83766851185896, "predator_policy": 385.3817721893391}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-12.247026124530926, 2.2869989656985923, 0.33000000000000007, 32.8257892557434, -5.054462176461492, 21.91194189529192, 36.379736099659056, 11.614081047105039, 0.030000000000001137, 2.3899999999999952, 138.06875315550522, 5.780091138630453, 40.14, -10.53801787991748, 5.853589526230527, 73.52794604372677, 145.62840308954975, 227.9095958094413, 22.747533021141845, -27.797685826082958, 182.33764607018787, 1.0899999999999972, 120.12000000000025, 332.0140922920899, 56.96140374805529, 45.72733800497579, 218.61613166263794, 13.140831551799527, 93.32038516692803, 0.12000000000000122, 333.4221063394371, 40.503450907775814, 29.130000000000003, 98.90769712296517, 125.79117820607517, 4.441402772720052, 7.777158572943822, 9.488585602767666, 54.22123512655236, 0.029999999999989813, 286.2471300098766, 129.03, 201.45325988222598, 143.19058278149396, 256.51572441826613, 33.43562285821479, 78.39971812447514, 18.956826995100236, 6.25, -33.89672650450788, 59.17999999999999, 0.13999999999999635, 224.15538826264086, 26.852853328369655, 214.77737730974542, 325.16186801725627, 138.9736828176278, 5.322133978775394, 101.8782584526151, -16.273443495764912, 1.3926416061106761, 197.58602420806767, 246.32999999999996, 74.11999999999999, 22.851338538084605, 19.988645116825424, -33.63229955991069, 56.91466398195564, 41.03843259743644, 58.81079214818516, 0.049999999999997824, 42.449504875261745, 43.24847853952631, 14.389999999999995, 0.2199999999999982, 153.44048240058135, 1.000000000000005, 1.4848280954602677, 1.3466797258854877, 305.48553795941694, 3.6992725706469045, 6.3889813193604965, 8.964752662852346, 0.24999999999999722, 26.547838355366704, 19.432924395674586, 207.97040706316966, 238.3487131913732, -1.5139842838381972, 272.6556197182697, 84.41535266711902, 37.993105619250436, -0.5813394091824833, 122.56110492542949, 27.224360567670132, 383.70198348164445, 0.19000000000000106, 14.178872733829758, 337.6738022415212, -8.494949982050718], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-341.1386681116448, -567.4731126362826, -586.5382444373815, -474.09275758104803, -375.5054041839696, -390.5968097621185, -158.90348501248974, -477.7920785230476, -428.33672724353613, -424.86390957870526, -565.7591748749471, -526.502779624934, -346.34144035926033, -407.7995095929509, -315.2172413228315, -433.5189809244217, -600.4864974748164, -491.32870533214503, -470.7231985606332, -416.20290390842916, 1.1253481736776971, -502.0697137259262, -422.1351053319663, -329.5783547751479, -584.9700041549888, -263.12399434460235, -318.9424710173882, -312.5048587635068, -430.04171072956245, -363.6699804787747, -330.09787109879977, -279.70756943903524, -96.68523243597707, -366.40062420372954, -178.52840032671804, -55.33956817525632, -476.06686747413005, -496.22281452425455, -403.0127560496133, -51.22865135415317, -468.11796723033405, 174.0000273246313, -330.2382240734783, -623.4014584289672, -0.8472672237812588, 2.0000000000000013, -16.445153131538405, 83.92223529665267, -530.0323572606077, -587.1160087418908, -546.3582561614082, -249.31390749318973, -428.01400930569116, -56.03938371726207, -449.77827687796184, -312.37908156794725, -576.0720563733714, -2.467650793689451, -625.5861163703659, -507.4754077387722, -426.54187559371604, 120.50855807034765, -370.10631483151036, -280.3341033107328, -603.1645240371691, -269.64400630442316, -292.39123815012493, -565.2315805102979, -427.4695869643832, 2.0000000000000013, -569.5549891967247, -359.94884082325495, -550.2383339242781, -486.75820785753956, -343.0983783949529, -379.5781046829642, -383.2040876490158, -376.2572269200775, -462.2123588395787, -677.0502526379045, -515.5613833580086, -84.84742002736695, -683.5958950656687, 9.932813950268496, -472.93971404692473, 0.01598010079692431, -539.8043464062096, -143.48548658377885, 171.4019489518455, -116.41554148589256, -212.75672373841195, -378.82722386077234, -180.7605061089591, -453.39633822886003, -430.0327558657194, -354.70616996371126, -383.66599846682345, -370.5069702289251, -405.62223206437136, -440.6483403817781, -178.44573271840008, -530.0632853513599, -460.3871341302327, -406.53098471066164, 7.048427186310821, -446.9159165766552, -499.8899877325578, -365.4275765153387, -548.0489505417855, -10.654879687152855, 200.0, -503.4215833054388, -130.39342512633894, -442.91175690618724, -353.32166537080286, -495.8542152471502, -71.16993912461513, -483.1189226510623, -354.452813841011, -389.5594733545419, -466.19784103241034, -460.451631948669, -217.21658892380964, -416.63076150207894, 20.36798073786136, -2.6079105433259464, -586.0684577266412, -154.84311476726515, -309.17395636155527, -377.50763130952964, -294.1027613393108, -475.06553770717767, -481.66345372464434, -491.2202514937066, -614.5149699594983, -180.642881925939, -482.1784638489687, -140.41700775454083, -649.9385394559281, -109.56200424130628, -403.08414092948146, -606.7115262404989, -371.90310861354726, -388.38683020668225, -441.63017801881983, -427.033029237467, -601.9750809031561, -313.19814166465846, -337.96350886230607, -502.1181750806654, -19.608585671062997, -390.48865085784894, -580.1316102909557, -464.86278991073743, -410.9658373257608, -350.09397755819987, -348.0935515035715, -459.26831780643056, 93.03919271634905, -412.6868166611421, -497.4364059458357, -255.11269026884133, -488.85532056122224, -453.9266696554694, -328.0867587601706, -465.32454753778893, -305.180547024655, -685.835208229548, -479.6923573383248, -310.15067557276257, -378.04245455741415, -375.9923659738385, 116.86248118244887, -509.71588138785427, -561.3815527418831, -56.93569116742975, -577.0204445122102, -318.5875016175848, 140.0307462699207, -493.50962892399167, -91.11491296846037, -339.812000230791, -422.80554866664835, -321.5613855390122, -542.2418311148097, -418.92170852928353, 2.0000000000000013, -473.8447548000509, -489.1826354028659, -304.4108556714101, -465.2371190766328, 183.19326588819638, -483.1718028258854, -369.16129767198976, -172.28958360997765, -447.5104451650969, 193.25649761281898, -429.60374746173443, -386.89665965914986, -419.42253341248494], "policy_predator_policy_reward": [348.66467123591354, 547.700083387483, 473.5725319738249, 589.3454690103033, 375.75540418396946, 390.6768097621184, 189.13141803762858, 480.38993475365186, 425.7556222435726, 422.3905524022075, 594.1399845499578, 520.0339118452152, 463.75166312615886, 326.76902292571106, 354.0156197642445, 406.33468353011347, 600.4864974748164, 491.358705332145, 473.0531985606329, 416.2629039084291, 193.78484711875657, 445.22827158899776, 427.2351053319662, 330.25844591377836, 585.0000041549888, 303.2339943446022, 300.0763288449812, 320.832983055996, 489.4940651864254, 310.07121554814256, 334.0908148845519, 349.2425716970097, 281.4655485609455, 327.24871116831076, 203.55108585432814, 258.22647845708735, 497.8851098401208, 497.15210517940557, 426.44372157768356, 0.0, 472.2779672303339, 4.177618745556617, 330.30822407347824, 624.4214584289672, 118.96726722378129, 0.0, 143.30956669961574, 121.22744342735994, 594.8054206847305, 579.3043490658239, 546.3582561614082, 295.04124549816527, 371.09878741713436, 331.5707372684568, 377.8591420045828, 397.4390479931259, 582.6826378826288, 89.17745445136015, 625.5861163703659, 507.5954077387721, 397.2225843048897, 242.2328395579163, 371.34976573928617, 319.5941033107327, 606.1745240371691, 295.76400630442305, 513.5389167340702, 442.9915990493173, 372.25378040118295, 179.006984769275, 346.7360031792999, 587.2092296134002, 552.0981982392484, 492.6755021155128, 352.36111450998726, 379.803954170697, 283.4856383736755, 530.1969113219699, 462.2423588395787, 677.0502526379045, 415.75355499746286, 470.90237839778894, 683.5958950656687, 119.09718604973152, 393.43285912919697, 280.94413469915753, 407.7479473489984, 418.7324684224817, 15.445207406103743, 186.08410954620942, 322.6812992265041, 302.3382712308948, 289.1971407954189, 423.3594216668738, 419.6812700410539, 384.0144827834769, 389.70599846682336, 370.71697022892516, 427.3428892781918, 385.0309566634494, 237.59573271839994, 530.0932853513599, 460.46713413023264, 406.5909847106616, 198.43787315088792, 465.5850045020976, 501.7640917210882, 390.40632585517784, 369.75539276794444, 403.72581477073976, 162.57282560628462, 466.01062571641063, 311.68262930380035, 400.5962355463523, 358.64379934957816, 495.8542152471502, 174.08643556657347, 482.08068466171886, 324.14484216588176, 403.594001533906, 466.19784103241034, 461.84427355477953, 518.528788778657, 312.90458585529905, 111.71201926213868, 116.85791054332606, 589.0684577266412, 225.9631147672651, 231.88961987802244, 477.6433063311468, 456.35329296435935, 332.8036511989538, 462.84651204617217, 476.4048936122681, 588.0286612341114, 264.0438546332814, 539.7359347495686, 123.89796945137714, 649.9385394559281, 168.37279638949136, 403.1341409294814, 606.7115262404989, 414.9427348647481, 387.79670883074306, 532.7144578856331, 379.1972279101799, 601.9750809031561, 327.5881416646581, 338.183508862306, 502.1181750806654, 186.28031090741393, 377.2574080220791, 581.1316102909556, 464.86278991073743, 307.53637688621507, 455.00826609320546, 348.43023122945704, 460.2783178064305, 367.57247342364826, 257.5606884805619, 387.61974402743357, 368.62862475789, 455.8025390523402, 493.36843248371207, 312.11402456907575, 490.2620343917364, 305.4305470246548, 685.835208229548, 483.0869790382994, 333.3038922281545, 399.6001499476861, 373.86759497924106, 91.4814309120956, 509.3423763564794, 396.7862147718079, 459.8797423288775, 551.9232809554735, 342.17068089048337, 421.23999072638543, 204.89451164595522, 232.19323028400336, 283.14903558236716, 459.87777433437725, 322.4822654905337, 417.6744974295686, 542.907702805342, 314.4380966159511, 279.96776310952896, 330.63399633655916, 490.1838553053868, 310.5732774442291, 355.17255922585207, 483.1718028258854, 369.3512976719896, 178.27145266406282, 455.7074488448405, 237.40484773152906, 336.61620435890796, 383.8924326788265, 413.93181041075746]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.940435701400921, "mean_inference_ms": 44.10650770317787, "mean_action_processing_ms": 0.25727852548272045, "mean_env_wait_ms": 6.316548822389644, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006286740303039551, "StateBufferConnector_ms": 0.0037841796875, "ViewRequirementAgentConnector_ms": 0.11209976673126221}, "num_episodes": 22, "episode_return_max": 383.70198348164445, "episode_return_min": -33.89672650450788, "episode_return_mean": 77.08820735496047, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1008000, "num_agent_steps_trained": 1008000, "num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 0.545217180466062, "num_env_steps_trained_throughput_per_sec": 0.545217180466062, "timesteps_total": 252000, "num_env_steps_sampled_lifetime": 252000, "num_agent_steps_sampled_lifetime": 1008000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1008000, "timers": {"training_iteration_time_ms": 4529471.087, "restore_workers_time_ms": 0.016, "training_step_time_ms": 4529471.0, "sample_time_ms": 2051.182, "learn_time_ms": 4527393.929, "learn_throughput": 0.884, "synch_weights_time_ms": 20.984}, "counters": {"num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_agent_steps_sampled": 1008000, "num_agent_steps_trained": 1008000}, "done": false, "training_iteration": 63, "trial_id": "b941d_00000", "date": "2024-08-18_20-05-09", "timestamp": 1723991709, "time_this_iter_s": 7336.581073999405, "time_total_s": 130272.84674429893, "pid": 81115, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[32, [4, 4], 2], [64, [3, 3], 2], [128, [3, 3], 1]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [256, 256], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b04950d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 130272.84674429893, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 30.79145728643216, "ram_util_percent": 79.97989949748744}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.58020102422704, "cur_kl_coeff": 1.5187500000000005, "cur_lr": 0.00010000000000000003, "total_loss": 8.53186146493942, "policy_loss": -0.08080847790753025, "vf_loss": 8.59021507924196, "vf_explained_var": -0.06044579287054677, "kl": 0.014785103662382284, "entropy": 0.9507157033082669, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 120015.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 14.166335915825355, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.00010000000000000003, "total_loss": 8.950905805163913, "policy_loss": -0.07336178773671645, "vf_loss": 9.00827275079394, "vf_explained_var": -0.46000805266950495, "kl": 0.015797384016290845, "entropy": 0.7023735241599814, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 120015.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 256000, "num_env_steps_trained": 256000, "num_agent_steps_sampled": 1024000, "num_agent_steps_trained": 1024000}, "env_runners": {"episode_reward_max": 383.70198348164445, "episode_reward_min": -59.5744482170785, "episode_reward_mean": 77.09676763535462, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -714.4817035575763, "predator_policy": 15.445207406103743}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 711.0451522317858}, "policy_reward_mean": {"prey_policy": -351.5104264981154, "predator_policy": 390.05881031579264}, "custom_metrics": {}, "hist_stats": {"episode_reward": [332.0140922920899, 56.96140374805529, 45.72733800497579, 218.61613166263794, 13.140831551799527, 93.32038516692803, 0.12000000000000122, 333.4221063394371, 40.503450907775814, 29.130000000000003, 98.90769712296517, 125.79117820607517, 4.441402772720052, 7.777158572943822, 9.488585602767666, 54.22123512655236, 0.029999999999989813, 286.2471300098766, 129.03, 201.45325988222598, 143.19058278149396, 256.51572441826613, 33.43562285821479, 78.39971812447514, 18.956826995100236, 6.25, -33.89672650450788, 59.17999999999999, 0.13999999999999635, 224.15538826264086, 26.852853328369655, 214.77737730974542, 325.16186801725627, 138.9736828176278, 5.322133978775394, 101.8782584526151, -16.273443495764912, 1.3926416061106761, 197.58602420806767, 246.32999999999996, 74.11999999999999, 22.851338538084605, 19.988645116825424, -33.63229955991069, 56.91466398195564, 41.03843259743644, 58.81079214818516, 0.049999999999997824, 42.449504875261745, 43.24847853952631, 14.389999999999995, 0.2199999999999982, 153.44048240058135, 1.000000000000005, 1.4848280954602677, 1.3466797258854877, 305.48553795941694, 3.6992725706469045, 6.3889813193604965, 8.964752662852346, 0.24999999999999722, 26.547838355366704, 19.432924395674586, 207.97040706316966, 238.3487131913732, -1.5139842838381972, 272.6556197182697, 84.41535266711902, 37.993105619250436, -0.5813394091824833, 122.56110492542949, 27.224360567670132, 383.70198348164445, 0.19000000000000106, 14.178872733829758, 337.6738022415212, -8.494949982050718, -56.17966650126431, 22.83760500813615, -59.5744482170785, 88.81369265196459, 60.3742272641564, 2.329999999999991, -33.484784412285535, -33.287672256489124, 150.07999999999998, 76.13999999999999, 0.36999999999999034, 1.257789450050666, 0.39553254743580446, 62.203263111140565, 180.447187413296, 0.31112508890500834, 0.10999999999999543, 74.7065909518409, 15.238507363551234, 71.41449024745518, 126.91222016489982, 275.99667361252074, -11.221392337900443], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-16.445153131538405, 83.92223529665267, -530.0323572606077, -587.1160087418908, -546.3582561614082, -249.31390749318973, -428.01400930569116, -56.03938371726207, -449.77827687796184, -312.37908156794725, -576.0720563733714, -2.467650793689451, -625.5861163703659, -507.4754077387722, -426.54187559371604, 120.50855807034765, -370.10631483151036, -280.3341033107328, -603.1645240371691, -269.64400630442316, -292.39123815012493, -565.2315805102979, -427.4695869643832, 2.0000000000000013, -569.5549891967247, -359.94884082325495, -550.2383339242781, -486.75820785753956, -343.0983783949529, -379.5781046829642, -383.2040876490158, -376.2572269200775, -462.2123588395787, -677.0502526379045, -515.5613833580086, -84.84742002736695, -683.5958950656687, 9.932813950268496, -472.93971404692473, 0.01598010079692431, -539.8043464062096, -143.48548658377885, 171.4019489518455, -116.41554148589256, -212.75672373841195, -378.82722386077234, -180.7605061089591, -453.39633822886003, -430.0327558657194, -354.70616996371126, -383.66599846682345, -370.5069702289251, -405.62223206437136, -440.6483403817781, -178.44573271840008, -530.0632853513599, -460.3871341302327, -406.53098471066164, 7.048427186310821, -446.9159165766552, -499.8899877325578, -365.4275765153387, -548.0489505417855, -10.654879687152855, 200.0, -503.4215833054388, -130.39342512633894, -442.91175690618724, -353.32166537080286, -495.8542152471502, -71.16993912461513, -483.1189226510623, -354.452813841011, -389.5594733545419, -466.19784103241034, -460.451631948669, -217.21658892380964, -416.63076150207894, 20.36798073786136, -2.6079105433259464, -586.0684577266412, -154.84311476726515, -309.17395636155527, -377.50763130952964, -294.1027613393108, -475.06553770717767, -481.66345372464434, -491.2202514937066, -614.5149699594983, -180.642881925939, -482.1784638489687, -140.41700775454083, -649.9385394559281, -109.56200424130628, -403.08414092948146, -606.7115262404989, -371.90310861354726, -388.38683020668225, -441.63017801881983, -427.033029237467, -601.9750809031561, -313.19814166465846, -337.96350886230607, -502.1181750806654, -19.608585671062997, -390.48865085784894, -580.1316102909557, -464.86278991073743, -410.9658373257608, -350.09397755819987, -348.0935515035715, -459.26831780643056, 93.03919271634905, -412.6868166611421, -497.4364059458357, -255.11269026884133, -488.85532056122224, -453.9266696554694, -328.0867587601706, -465.32454753778893, -305.180547024655, -685.835208229548, -479.6923573383248, -310.15067557276257, -378.04245455741415, -375.9923659738385, 116.86248118244887, -509.71588138785427, -561.3815527418831, -56.93569116742975, -577.0204445122102, -318.5875016175848, 140.0307462699207, -493.50962892399167, -91.11491296846037, -339.812000230791, -422.80554866664835, -321.5613855390122, -542.2418311148097, -418.92170852928353, 2.0000000000000013, -473.8447548000509, -489.1826354028659, -304.4108556714101, -465.2371190766328, 183.19326588819638, -483.1718028258854, -369.16129767198976, -172.28958360997765, -447.5104451650969, 193.25649761281898, -429.60374746173443, -386.89665965914986, -419.42253341248494, -103.49639106982966, -495.0974222806445, -714.4817035575763, -467.8886383442399, -418.9252250091691, -398.6872058398407, -227.64125909835548, -495.58837473568394, -505.23872351736514, -220.98859749679943, -432.37280291756804, -367.46174030702946, -388.13942444643004, -324.04042796876837, -350.0450476256884, -331.94478675367174, 54.76740336527119, -696.8024378204697, -500.20042867433915, -165.54572443420673, -305.17628609160386, -690.321961168177, -436.3385814059705, -464.7837642141974, -497.40226731666036, -342.85427388575766, -397.89267047363927, -280.20480672409985, -427.7140200224749, -153.79276468263092, -659.7625949887799, -563.9039161224691, -490.68068850550384, -325.64441398417694, -399.4586546725799, -171.3206722520147, -432.72661347139444, -327.98969192201434, -487.1933061889473, 0.15682019690587484, -58.47904665547971, -446.84288825492115, -619.5848313698951, 0.36267720375811247, -366.9699125327032, -343.14122812084395], "policy_predator_policy_reward": [143.30956669961574, 121.22744342735994, 594.8054206847305, 579.3043490658239, 546.3582561614082, 295.04124549816527, 371.09878741713436, 331.5707372684568, 377.8591420045828, 397.4390479931259, 582.6826378826288, 89.17745445136015, 625.5861163703659, 507.5954077387721, 397.2225843048897, 242.2328395579163, 371.34976573928617, 319.5941033107327, 606.1745240371691, 295.76400630442305, 513.5389167340702, 442.9915990493173, 372.25378040118295, 179.006984769275, 346.7360031792999, 587.2092296134002, 552.0981982392484, 492.6755021155128, 352.36111450998726, 379.803954170697, 283.4856383736755, 530.1969113219699, 462.2423588395787, 677.0502526379045, 415.75355499746286, 470.90237839778894, 683.5958950656687, 119.09718604973152, 393.43285912919697, 280.94413469915753, 407.7479473489984, 418.7324684224817, 15.445207406103743, 186.08410954620942, 322.6812992265041, 302.3382712308948, 289.1971407954189, 423.3594216668738, 419.6812700410539, 384.0144827834769, 389.70599846682336, 370.71697022892516, 427.3428892781918, 385.0309566634494, 237.59573271839994, 530.0932853513599, 460.46713413023264, 406.5909847106616, 198.43787315088792, 465.5850045020976, 501.7640917210882, 390.40632585517784, 369.75539276794444, 403.72581477073976, 162.57282560628462, 466.01062571641063, 311.68262930380035, 400.5962355463523, 358.64379934957816, 495.8542152471502, 174.08643556657347, 482.08068466171886, 324.14484216588176, 403.594001533906, 466.19784103241034, 461.84427355477953, 518.528788778657, 312.90458585529905, 111.71201926213868, 116.85791054332606, 589.0684577266412, 225.9631147672651, 231.88961987802244, 477.6433063311468, 456.35329296435935, 332.8036511989538, 462.84651204617217, 476.4048936122681, 588.0286612341114, 264.0438546332814, 539.7359347495686, 123.89796945137714, 649.9385394559281, 168.37279638949136, 403.1341409294814, 606.7115262404989, 414.9427348647481, 387.79670883074306, 532.7144578856331, 379.1972279101799, 601.9750809031561, 327.5881416646581, 338.183508862306, 502.1181750806654, 186.28031090741393, 377.2574080220791, 581.1316102909556, 464.86278991073743, 307.53637688621507, 455.00826609320546, 348.43023122945704, 460.2783178064305, 367.57247342364826, 257.5606884805619, 387.61974402743357, 368.62862475789, 455.8025390523402, 493.36843248371207, 312.11402456907575, 490.2620343917364, 305.4305470246548, 685.835208229548, 483.0869790382994, 333.3038922281545, 399.6001499476861, 373.86759497924106, 91.4814309120956, 509.3423763564794, 396.7862147718079, 459.8797423288775, 551.9232809554735, 342.17068089048337, 421.23999072638543, 204.89451164595522, 232.19323028400336, 283.14903558236716, 459.87777433437725, 322.4822654905337, 417.6744974295686, 542.907702805342, 314.4380966159511, 279.96776310952896, 330.63399633655916, 490.1838553053868, 310.5732774442291, 355.17255922585207, 483.1718028258854, 369.3512976719896, 178.27145266406282, 455.7074488448405, 237.40484773152906, 336.61620435890796, 383.8924326788265, 413.93181041075746, 46.40115875637683, 496.0129880928337, 711.0451522317858, 494.1627946781662, 409.2976159476217, 348.74036668430966, 405.98226754732616, 406.06105893867766, 410.8928212347681, 375.70872704355276, 432.45280291756796, 369.71174030702934, 391.96194965995153, 286.73311834296123, 316.48887616227853, 332.2132859605925, 95.31259663472885, 696.8024378204697, 501.2304286743391, 240.65572443420663, 305.4462860916036, 690.421961168177, 436.5420999448343, 465.8380351253841, 496.9218070341326, 343.7302667157211, 299.02708147396334, 441.27365883491535, 331.17527014300595, 430.77870197539545, 660.073720077685, 563.9039161224691, 490.7006885055038, 325.73441398417697, 351.39297911826554, 294.0929387581696, 445.78512083494553, 330.1696919220142, 93.54663315630305, 464.9043430831928, 361.2476622027342, 270.986492872566, 419.44492470721036, 475.7739030714485, 373.94712364001543, 324.94262467563124]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.064281254001838, "mean_inference_ms": 43.1677134578848, "mean_action_processing_ms": 0.2576473019680522, "mean_env_wait_ms": 6.227321573821221, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006342053413391113, "StateBufferConnector_ms": 0.00384366512298584, "ViewRequirementAgentConnector_ms": 0.11540448665618896}, "num_episodes": 23, "episode_return_max": 383.70198348164445, "episode_return_min": -59.5744482170785, "episode_return_mean": 77.09676763535462, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1024000, "num_agent_steps_trained": 1024000, "num_env_steps_sampled": 256000, "num_env_steps_trained": 256000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 0.8490368539936389, "num_env_steps_trained_throughput_per_sec": 0.8490368539936389, "timesteps_total": 256000, "num_env_steps_sampled_lifetime": 256000, "num_agent_steps_sampled_lifetime": 1024000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1024000, "timers": {"training_iteration_time_ms": 4847179.411, "restore_workers_time_ms": 0.016, "training_step_time_ms": 4847179.325, "sample_time_ms": 2075.308, "learn_time_ms": 4845078.671, "learn_throughput": 0.826, "synch_weights_time_ms": 20.012}, "counters": {"num_env_steps_sampled": 256000, "num_env_steps_trained": 256000, "num_agent_steps_sampled": 1024000, "num_agent_steps_trained": 1024000}, "done": false, "training_iteration": 64, "trial_id": "b941d_00000", "date": "2024-08-18_21-23-40", "timestamp": 1723996420, "time_this_iter_s": 4711.26658987999, "time_total_s": 134984.11333417892, "pid": 81115, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[32, [4, 4], 2], [64, [3, 3], 2], [128, [3, 3], 1]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [256, 256], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b03ed5e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 134984.11333417892, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 28.72171717171717, "ram_util_percent": 81.32121212121213}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 15.385499301158562, "cur_kl_coeff": 1.5187500000000005, "cur_lr": 0.00010000000000000003, "total_loss": 7.777757375202482, "policy_loss": -0.08988074602142825, "vf_loss": 7.844830571785175, "vf_explained_var": 0.45996195680249935, "kl": 0.015017324444369234, "entropy": 0.9539726859362668, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 121905.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 14.037396933666614, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.00010000000000000003, "total_loss": 8.545475628514769, "policy_loss": -0.08307736734810368, "vf_loss": 8.611817372539056, "vf_explained_var": -0.2743876522495633, "kl": 0.016529019709216337, "entropy": 0.7714903670328634, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 121905.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 260000, "num_env_steps_trained": 260000, "num_agent_steps_sampled": 1040000, "num_agent_steps_trained": 1040000}, "env_runners": {"episode_reward_max": 388.3816145295697, "episode_reward_min": -77.48125991249817, "episode_reward_mean": 83.53559175467845, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -714.4817035575763, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 711.0451522317858}, "policy_reward_mean": {"prey_policy": -339.91614268531515, "predator_policy": 381.6839385626543}, "custom_metrics": {}, "hist_stats": {"episode_reward": [129.03, 201.45325988222598, 143.19058278149396, 256.51572441826613, 33.43562285821479, 78.39971812447514, 18.956826995100236, 6.25, -33.89672650450788, 59.17999999999999, 0.13999999999999635, 224.15538826264086, 26.852853328369655, 214.77737730974542, 325.16186801725627, 138.9736828176278, 5.322133978775394, 101.8782584526151, -16.273443495764912, 1.3926416061106761, 197.58602420806767, 246.32999999999996, 74.11999999999999, 22.851338538084605, 19.988645116825424, -33.63229955991069, 56.91466398195564, 41.03843259743644, 58.81079214818516, 0.049999999999997824, 42.449504875261745, 43.24847853952631, 14.389999999999995, 0.2199999999999982, 153.44048240058135, 1.000000000000005, 1.4848280954602677, 1.3466797258854877, 305.48553795941694, 3.6992725706469045, 6.3889813193604965, 8.964752662852346, 0.24999999999999722, 26.547838355366704, 19.432924395674586, 207.97040706316966, 238.3487131913732, -1.5139842838381972, 272.6556197182697, 84.41535266711902, 37.993105619250436, -0.5813394091824833, 122.56110492542949, 27.224360567670132, 383.70198348164445, 0.19000000000000106, 14.178872733829758, 337.6738022415212, -8.494949982050718, -56.17966650126431, 22.83760500813615, -59.5744482170785, 88.81369265196459, 60.3742272641564, 2.329999999999991, -33.484784412285535, -33.287672256489124, 150.07999999999998, 76.13999999999999, 0.36999999999999034, 1.257789450050666, 0.39553254743580446, 62.203263111140565, 180.447187413296, 0.31112508890500834, 0.10999999999999543, 74.7065909518409, 15.238507363551234, 71.41449024745518, 126.91222016489982, 275.99667361252074, -11.221392337900443, 15.17883776062874, 354.1535615055199, 225.51154956742621, 50.15, 30.575821555127057, 153.38649901887388, 18.085699739792418, -24.667483207330996, 0.13999999999999724, 152.05059615950398, 250.03221871411324, 388.3816145295697, 192.13, 197.99058281755794, 136.34, 181.6643007716972, 150.12, -77.48125991249817], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-683.5958950656687, 9.932813950268496, -472.93971404692473, 0.01598010079692431, -539.8043464062096, -143.48548658377885, 171.4019489518455, -116.41554148589256, -212.75672373841195, -378.82722386077234, -180.7605061089591, -453.39633822886003, -430.0327558657194, -354.70616996371126, -383.66599846682345, -370.5069702289251, -405.62223206437136, -440.6483403817781, -178.44573271840008, -530.0632853513599, -460.3871341302327, -406.53098471066164, 7.048427186310821, -446.9159165766552, -499.8899877325578, -365.4275765153387, -548.0489505417855, -10.654879687152855, 200.0, -503.4215833054388, -130.39342512633894, -442.91175690618724, -353.32166537080286, -495.8542152471502, -71.16993912461513, -483.1189226510623, -354.452813841011, -389.5594733545419, -466.19784103241034, -460.451631948669, -217.21658892380964, -416.63076150207894, 20.36798073786136, -2.6079105433259464, -586.0684577266412, -154.84311476726515, -309.17395636155527, -377.50763130952964, -294.1027613393108, -475.06553770717767, -481.66345372464434, -491.2202514937066, -614.5149699594983, -180.642881925939, -482.1784638489687, -140.41700775454083, -649.9385394559281, -109.56200424130628, -403.08414092948146, -606.7115262404989, -371.90310861354726, -388.38683020668225, -441.63017801881983, -427.033029237467, -601.9750809031561, -313.19814166465846, -337.96350886230607, -502.1181750806654, -19.608585671062997, -390.48865085784894, -580.1316102909557, -464.86278991073743, -410.9658373257608, -350.09397755819987, -348.0935515035715, -459.26831780643056, 93.03919271634905, -412.6868166611421, -497.4364059458357, -255.11269026884133, -488.85532056122224, -453.9266696554694, -328.0867587601706, -465.32454753778893, -305.180547024655, -685.835208229548, -479.6923573383248, -310.15067557276257, -378.04245455741415, -375.9923659738385, 116.86248118244887, -509.71588138785427, -561.3815527418831, -56.93569116742975, -577.0204445122102, -318.5875016175848, 140.0307462699207, -493.50962892399167, -91.11491296846037, -339.812000230791, -422.80554866664835, -321.5613855390122, -542.2418311148097, -418.92170852928353, 2.0000000000000013, -473.8447548000509, -489.1826354028659, -304.4108556714101, -465.2371190766328, 183.19326588819638, -483.1718028258854, -369.16129767198976, -172.28958360997765, -447.5104451650969, 193.25649761281898, -429.60374746173443, -386.89665965914986, -419.42253341248494, -103.49639106982966, -495.0974222806445, -714.4817035575763, -467.8886383442399, -418.9252250091691, -398.6872058398407, -227.64125909835548, -495.58837473568394, -505.23872351736514, -220.98859749679943, -432.37280291756804, -367.46174030702946, -388.13942444643004, -324.04042796876837, -350.0450476256884, -331.94478675367174, 54.76740336527119, -696.8024378204697, -500.20042867433915, -165.54572443420673, -305.17628609160386, -690.321961168177, -436.3385814059705, -464.7837642141974, -497.40226731666036, -342.85427388575766, -397.89267047363927, -280.20480672409985, -427.7140200224749, -153.79276468263092, -659.7625949887799, -563.9039161224691, -490.68068850550384, -325.64441398417694, -399.4586546725799, -171.3206722520147, -432.72661347139444, -327.98969192201434, -487.1933061889473, 0.15682019690587484, -58.47904665547971, -446.84288825492115, -619.5848313698951, 0.36267720375811247, -366.9699125327032, -343.14122812084395, -401.363466631902, -491.7909809368635, -515.5803100076154, 115.05121629900738, -140.12675023285854, -618.6609279338315, -221.32788446167967, -558.7448061120724, -367.3900735284708, -485.56896973806636, -41.86026906318723, -261.40519716867345, -413.98417812308975, -530.2548630097921, -339.8889699930191, -445.0905023113544, -568.1262056979997, -278.5067107440448, -574.5575733426944, -52.93016007631692, -467.94021417110554, 198.01999999999998, -586.5717279758494, 25.15282555432023, -451.6894594299445, 192.07999999999998, -432.0443199951305, -27.59092400008106, -77.01881167549423, -205.27467902500206, -379.503823559174, -26.445295269303344, -494.0028548015751, 70.48208398155401, -463.0927408278359, -467.43539961151725], "policy_predator_policy_reward": [683.5958950656687, 119.09718604973152, 393.43285912919697, 280.94413469915753, 407.7479473489984, 418.7324684224817, 15.445207406103743, 186.08410954620942, 322.6812992265041, 302.3382712308948, 289.1971407954189, 423.3594216668738, 419.6812700410539, 384.0144827834769, 389.70599846682336, 370.71697022892516, 427.3428892781918, 385.0309566634494, 237.59573271839994, 530.0932853513599, 460.46713413023264, 406.5909847106616, 198.43787315088792, 465.5850045020976, 501.7640917210882, 390.40632585517784, 369.75539276794444, 403.72581477073976, 162.57282560628462, 466.01062571641063, 311.68262930380035, 400.5962355463523, 358.64379934957816, 495.8542152471502, 174.08643556657347, 482.08068466171886, 324.14484216588176, 403.594001533906, 466.19784103241034, 461.84427355477953, 518.528788778657, 312.90458585529905, 111.71201926213868, 116.85791054332606, 589.0684577266412, 225.9631147672651, 231.88961987802244, 477.6433063311468, 456.35329296435935, 332.8036511989538, 462.84651204617217, 476.4048936122681, 588.0286612341114, 264.0438546332814, 539.7359347495686, 123.89796945137714, 649.9385394559281, 168.37279638949136, 403.1341409294814, 606.7115262404989, 414.9427348647481, 387.79670883074306, 532.7144578856331, 379.1972279101799, 601.9750809031561, 327.5881416646581, 338.183508862306, 502.1181750806654, 186.28031090741393, 377.2574080220791, 581.1316102909556, 464.86278991073743, 307.53637688621507, 455.00826609320546, 348.43023122945704, 460.2783178064305, 367.57247342364826, 257.5606884805619, 387.61974402743357, 368.62862475789, 455.8025390523402, 493.36843248371207, 312.11402456907575, 490.2620343917364, 305.4305470246548, 685.835208229548, 483.0869790382994, 333.3038922281545, 399.6001499476861, 373.86759497924106, 91.4814309120956, 509.3423763564794, 396.7862147718079, 459.8797423288775, 551.9232809554735, 342.17068089048337, 421.23999072638543, 204.89451164595522, 232.19323028400336, 283.14903558236716, 459.87777433437725, 322.4822654905337, 417.6744974295686, 542.907702805342, 314.4380966159511, 279.96776310952896, 330.63399633655916, 490.1838553053868, 310.5732774442291, 355.17255922585207, 483.1718028258854, 369.3512976719896, 178.27145266406282, 455.7074488448405, 237.40484773152906, 336.61620435890796, 383.8924326788265, 413.93181041075746, 46.40115875637683, 496.0129880928337, 711.0451522317858, 494.1627946781662, 409.2976159476217, 348.74036668430966, 405.98226754732616, 406.06105893867766, 410.8928212347681, 375.70872704355276, 432.45280291756796, 369.71174030702934, 391.96194965995153, 286.73311834296123, 316.48887616227853, 332.2132859605925, 95.31259663472885, 696.8024378204697, 501.2304286743391, 240.65572443420663, 305.4462860916036, 690.421961168177, 436.5420999448343, 465.8380351253841, 496.9218070341326, 343.7302667157211, 299.02708147396334, 441.27365883491535, 331.17527014300595, 430.77870197539545, 660.073720077685, 563.9039161224691, 490.7006885055038, 325.73441398417697, 351.39297911826554, 294.0929387581696, 445.78512083494553, 330.1696919220142, 93.54663315630305, 464.9043430831928, 361.2476622027342, 270.986492872566, 419.44492470721036, 475.7739030714485, 373.94712364001543, 324.94262467563124, 442.0478096178258, 466.28547571156815, 435.0254720438664, 319.65718317026153, 509.60279643760487, 474.69643129651183, 271.47788446167954, 558.7448061120724, 386.79093160321673, 496.74393321844707, 45.492511489602705, 411.1594537611313, 595.6041746389027, 366.7205662337716, 344.63105165961093, 415.6809374374317, 568.1262056979997, 278.64671074404475, 504.6677731694936, 274.8705564090212, 393.59935515036705, 126.35307773485174, 523.5200933258875, 426.2804236252101, 451.7394594299445, 0.0, 357.072284599451, 300.5535422133178, 178.21881167549407, 240.41467902500193, 305.7303688183637, 281.8830507818113, 494.05285480157505, 79.58791601844602, 451.16111427799115, 401.8857662488638]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.804234390182855, "mean_inference_ms": 42.784076247165466, "mean_action_processing_ms": 0.25732162580472356, "mean_env_wait_ms": 6.1402685272678035, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0060694217681884766, "StateBufferConnector_ms": 0.003708958625793457, "ViewRequirementAgentConnector_ms": 0.11065709590911865}, "num_episodes": 18, "episode_return_max": 388.3816145295697, "episode_return_min": -77.48125991249817, "episode_return_mean": 83.53559175467845, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1040000, "num_agent_steps_trained": 1040000, "num_env_steps_sampled": 260000, "num_env_steps_trained": 260000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1.5284737895096616, "num_env_steps_trained_throughput_per_sec": 1.5284737895096616, "timesteps_total": 260000, "num_env_steps_sampled_lifetime": 260000, "num_agent_steps_sampled_lifetime": 1040000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1040000, "timers": {"training_iteration_time_ms": 5073012.896, "restore_workers_time_ms": 0.016, "training_step_time_ms": 5073012.83, "sample_time_ms": 2098.25, "learn_time_ms": 5070891.383, "learn_throughput": 0.789, "synch_weights_time_ms": 17.925}, "counters": {"num_env_steps_sampled": 260000, "num_env_steps_trained": 260000, "num_agent_steps_sampled": 1040000, "num_agent_steps_trained": 1040000}, "done": false, "training_iteration": 65, "trial_id": "b941d_00000", "date": "2024-08-18_22-07-17", "timestamp": 1723999037, "time_this_iter_s": 2617.0248239040375, "time_total_s": 137601.13815808296, "pid": 81115, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[32, [4, 4], 2], [64, [3, 3], 2], [128, [3, 3], 1]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [256, 256], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b0403f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 137601.13815808296, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 26.654973821989525, "ram_util_percent": 80.39738219895288}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 11.407032199448379, "cur_kl_coeff": 1.5187500000000005, "cur_lr": 0.00010000000000000003, "total_loss": 8.153669122917941, "policy_loss": -0.0910854531528438, "vf_loss": 8.220972308910714, "vf_explained_var": 0.321791212331681, "kl": 0.015659097555750862, "entropy": 0.9808399168587235, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 123795.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 12.83672678407538, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.00010000000000000003, "total_loss": 9.109013635645468, "policy_loss": -0.08451914486509782, "vf_loss": 9.1767304914969, "vf_explained_var": -0.46849405169487, "kl": 0.01659485724392789, "entropy": 0.7304580119236437, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 123795.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_agent_steps_sampled": 1056000, "num_agent_steps_trained": 1056000}, "env_runners": {"episode_reward_max": 388.3816145295697, "episode_reward_min": -77.48125991249817, "episode_reward_mean": 83.55519509508981, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -714.4817035575763, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 711.0451522317858}, "policy_reward_mean": {"prey_policy": -341.6877529069521, "predator_policy": 383.465350454497}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-16.273443495764912, 1.3926416061106761, 197.58602420806767, 246.32999999999996, 74.11999999999999, 22.851338538084605, 19.988645116825424, -33.63229955991069, 56.91466398195564, 41.03843259743644, 58.81079214818516, 0.049999999999997824, 42.449504875261745, 43.24847853952631, 14.389999999999995, 0.2199999999999982, 153.44048240058135, 1.000000000000005, 1.4848280954602677, 1.3466797258854877, 305.48553795941694, 3.6992725706469045, 6.3889813193604965, 8.964752662852346, 0.24999999999999722, 26.547838355366704, 19.432924395674586, 207.97040706316966, 238.3487131913732, -1.5139842838381972, 272.6556197182697, 84.41535266711902, 37.993105619250436, -0.5813394091824833, 122.56110492542949, 27.224360567670132, 383.70198348164445, 0.19000000000000106, 14.178872733829758, 337.6738022415212, -8.494949982050718, -56.17966650126431, 22.83760500813615, -59.5744482170785, 88.81369265196459, 60.3742272641564, 2.329999999999991, -33.484784412285535, -33.287672256489124, 150.07999999999998, 76.13999999999999, 0.36999999999999034, 1.257789450050666, 0.39553254743580446, 62.203263111140565, 180.447187413296, 0.31112508890500834, 0.10999999999999543, 74.7065909518409, 15.238507363551234, 71.41449024745518, 126.91222016489982, 275.99667361252074, -11.221392337900443, 15.17883776062874, 354.1535615055199, 225.51154956742621, 50.15, 30.575821555127057, 153.38649901887388, 18.085699739792418, -24.667483207330996, 0.13999999999999724, 152.05059615950398, 250.03221871411324, 388.3816145295697, 192.13, 197.99058281755794, 136.34, 181.6643007716972, 150.12, -77.48125991249817, 62.501755049076564, 111.33517506342764, 194.54707771879592, 327.49686987483847, 171.3265318179811, 0.1000000000000032, 85.42450247153138, 47.23000000000001, 231.15640296524163, 187.27506303711408, 4.73893032901808, 14.36267173933724, 44.328245705784184, -28.624847348467746, 71.8302105824529, 9.06806458712832, 78.08, 319.5602511701773], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-354.452813841011, -389.5594733545419, -466.19784103241034, -460.451631948669, -217.21658892380964, -416.63076150207894, 20.36798073786136, -2.6079105433259464, -586.0684577266412, -154.84311476726515, -309.17395636155527, -377.50763130952964, -294.1027613393108, -475.06553770717767, -481.66345372464434, -491.2202514937066, -614.5149699594983, -180.642881925939, -482.1784638489687, -140.41700775454083, -649.9385394559281, -109.56200424130628, -403.08414092948146, -606.7115262404989, -371.90310861354726, -388.38683020668225, -441.63017801881983, -427.033029237467, -601.9750809031561, -313.19814166465846, -337.96350886230607, -502.1181750806654, -19.608585671062997, -390.48865085784894, -580.1316102909557, -464.86278991073743, -410.9658373257608, -350.09397755819987, -348.0935515035715, -459.26831780643056, 93.03919271634905, -412.6868166611421, -497.4364059458357, -255.11269026884133, -488.85532056122224, -453.9266696554694, -328.0867587601706, -465.32454753778893, -305.180547024655, -685.835208229548, -479.6923573383248, -310.15067557276257, -378.04245455741415, -375.9923659738385, 116.86248118244887, -509.71588138785427, -561.3815527418831, -56.93569116742975, -577.0204445122102, -318.5875016175848, 140.0307462699207, -493.50962892399167, -91.11491296846037, -339.812000230791, -422.80554866664835, -321.5613855390122, -542.2418311148097, -418.92170852928353, 2.0000000000000013, -473.8447548000509, -489.1826354028659, -304.4108556714101, -465.2371190766328, 183.19326588819638, -483.1718028258854, -369.16129767198976, -172.28958360997765, -447.5104451650969, 193.25649761281898, -429.60374746173443, -386.89665965914986, -419.42253341248494, -103.49639106982966, -495.0974222806445, -714.4817035575763, -467.8886383442399, -418.9252250091691, -398.6872058398407, -227.64125909835548, -495.58837473568394, -505.23872351736514, -220.98859749679943, -432.37280291756804, -367.46174030702946, -388.13942444643004, -324.04042796876837, -350.0450476256884, -331.94478675367174, 54.76740336527119, -696.8024378204697, -500.20042867433915, -165.54572443420673, -305.17628609160386, -690.321961168177, -436.3385814059705, -464.7837642141974, -497.40226731666036, -342.85427388575766, -397.89267047363927, -280.20480672409985, -427.7140200224749, -153.79276468263092, -659.7625949887799, -563.9039161224691, -490.68068850550384, -325.64441398417694, -399.4586546725799, -171.3206722520147, -432.72661347139444, -327.98969192201434, -487.1933061889473, 0.15682019690587484, -58.47904665547971, -446.84288825492115, -619.5848313698951, 0.36267720375811247, -366.9699125327032, -343.14122812084395, -401.363466631902, -491.7909809368635, -515.5803100076154, 115.05121629900738, -140.12675023285854, -618.6609279338315, -221.32788446167967, -558.7448061120724, -367.3900735284708, -485.56896973806636, -41.86026906318723, -261.40519716867345, -413.98417812308975, -530.2548630097921, -339.8889699930191, -445.0905023113544, -568.1262056979997, -278.5067107440448, -574.5575733426944, -52.93016007631692, -467.94021417110554, 198.01999999999998, -586.5717279758494, 25.15282555432023, -451.6894594299445, 192.07999999999998, -432.0443199951305, -27.59092400008106, -77.01881167549423, -205.27467902500206, -379.503823559174, -26.445295269303344, -494.0028548015751, 70.48208398155401, -463.0927408278359, -467.43539961151725, -507.04315680183237, -273.15407215056604, -386.7856799174803, -106.65042109870942, 141.21188105661207, -415.2728599595391, -380.6621590847245, 169.5318848660488, -222.42084783140052, -478.9272040899596, -703.7070185858062, -394.1747950185734, -460.5248211460688, -205.49764015298558, -340.79829044402317, -321.8439558480523, -405.4681404089152, -92.4234608603819, -71.93591057391595, -604.4029538499195, -440.43822590370274, -268.34201919457945, 0.38324967741737254, -473.7586484238966, -378.13115005116435, -398.03323078929594, -523.3341501653282, -445.52832461506415, -315.24604062637945, -427.72300090002784, -348.6774454438954, -429.07071281270225, -120.82329733005102, -652.7419664828248, 200.0, -377.22848736903063], "policy_predator_policy_reward": [324.14484216588176, 403.594001533906, 466.19784103241034, 461.84427355477953, 518.528788778657, 312.90458585529905, 111.71201926213868, 116.85791054332606, 589.0684577266412, 225.9631147672651, 231.88961987802244, 477.6433063311468, 456.35329296435935, 332.8036511989538, 462.84651204617217, 476.4048936122681, 588.0286612341114, 264.0438546332814, 539.7359347495686, 123.89796945137714, 649.9385394559281, 168.37279638949136, 403.1341409294814, 606.7115262404989, 414.9427348647481, 387.79670883074306, 532.7144578856331, 379.1972279101799, 601.9750809031561, 327.5881416646581, 338.183508862306, 502.1181750806654, 186.28031090741393, 377.2574080220791, 581.1316102909556, 464.86278991073743, 307.53637688621507, 455.00826609320546, 348.43023122945704, 460.2783178064305, 367.57247342364826, 257.5606884805619, 387.61974402743357, 368.62862475789, 455.8025390523402, 493.36843248371207, 312.11402456907575, 490.2620343917364, 305.4305470246548, 685.835208229548, 483.0869790382994, 333.3038922281545, 399.6001499476861, 373.86759497924106, 91.4814309120956, 509.3423763564794, 396.7862147718079, 459.8797423288775, 551.9232809554735, 342.17068089048337, 421.23999072638543, 204.89451164595522, 232.19323028400336, 283.14903558236716, 459.87777433437725, 322.4822654905337, 417.6744974295686, 542.907702805342, 314.4380966159511, 279.96776310952896, 330.63399633655916, 490.1838553053868, 310.5732774442291, 355.17255922585207, 483.1718028258854, 369.3512976719896, 178.27145266406282, 455.7074488448405, 237.40484773152906, 336.61620435890796, 383.8924326788265, 413.93181041075746, 46.40115875637683, 496.0129880928337, 711.0451522317858, 494.1627946781662, 409.2976159476217, 348.74036668430966, 405.98226754732616, 406.06105893867766, 410.8928212347681, 375.70872704355276, 432.45280291756796, 369.71174030702934, 391.96194965995153, 286.73311834296123, 316.48887616227853, 332.2132859605925, 95.31259663472885, 696.8024378204697, 501.2304286743391, 240.65572443420663, 305.4462860916036, 690.421961168177, 436.5420999448343, 465.8380351253841, 496.9218070341326, 343.7302667157211, 299.02708147396334, 441.27365883491535, 331.17527014300595, 430.77870197539545, 660.073720077685, 563.9039161224691, 490.7006885055038, 325.73441398417697, 351.39297911826554, 294.0929387581696, 445.78512083494553, 330.1696919220142, 93.54663315630305, 464.9043430831928, 361.2476622027342, 270.986492872566, 419.44492470721036, 475.7739030714485, 373.94712364001543, 324.94262467563124, 442.0478096178258, 466.28547571156815, 435.0254720438664, 319.65718317026153, 509.60279643760487, 474.69643129651183, 271.47788446167954, 558.7448061120724, 386.79093160321673, 496.74393321844707, 45.492511489602705, 411.1594537611313, 595.6041746389027, 366.7205662337716, 344.63105165961093, 415.6809374374317, 568.1262056979997, 278.64671074404475, 504.6677731694936, 274.8705564090212, 393.59935515036705, 126.35307773485174, 523.5200933258875, 426.2804236252101, 451.7394594299445, 0.0, 357.072284599451, 300.5535422133178, 178.21881167549407, 240.41467902500193, 305.7303688183637, 281.8830507818113, 494.05285480157505, 79.58791601844602, 451.16111427799115, 401.8857662488638, 466.89618893734973, 375.8027950641249, 213.75216720582804, 391.01910887378926, 73.20610948752076, 395.40194713420203, 331.3364270617892, 207.29071703172508, 453.82159348046207, 418.8529902588786, 703.7570185858062, 394.22479501857333, 509.3168942268072, 242.13006954377835, 350.90829044402307, 358.9639558480522, 331.3397447751413, 397.7082594593984, 387.1287059162328, 476.48522154471607, 457.16403053118097, 256.35514489611757, 15.521984078620722, 472.21608640719575, 382.17395275097624, 438.3186737952679, 506.63073564012484, 433.60689179179957, 403.49617265026245, 411.3030794585974, 418.96822216295567, 367.84800068077016, 198.89329733005096, 652.7519664828247, 280.11764978107357, 216.67108875813432]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.74612871297327, "mean_inference_ms": 47.407013421846294, "mean_action_processing_ms": 0.9040991366800597, "mean_env_wait_ms": 6.056490676525917, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006022930145263672, "StateBufferConnector_ms": 0.004140019416809082, "ViewRequirementAgentConnector_ms": 0.1107172966003418}, "num_episodes": 18, "episode_return_max": 388.3816145295697, "episode_return_min": -77.48125991249817, "episode_return_mean": 83.55519509508981, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1056000, "num_agent_steps_trained": 1056000, "num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 0.5485567711505744, "num_env_steps_trained_throughput_per_sec": 0.5485567711505744, "timesteps_total": 264000, "num_env_steps_sampled_lifetime": 264000, "num_agent_steps_sampled_lifetime": 1056000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1056000, "timers": {"training_iteration_time_ms": 5586702.881, "restore_workers_time_ms": 0.014, "training_step_time_ms": 5586702.82, "sample_time_ms": 97162.26, "learn_time_ms": 5489516.051, "learn_throughput": 0.729, "synch_weights_time_ms": 18.432}, "counters": {"num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_agent_steps_sampled": 1056000, "num_agent_steps_trained": 1056000}, "done": false, "training_iteration": 66, "trial_id": "b941d_00000", "date": "2024-08-19_00-08-49", "timestamp": 1724006329, "time_this_iter_s": 7291.905581951141, "time_total_s": 144893.0437400341, "pid": 81115, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[32, [4, 4], 2], [64, [3, 3], 2], [128, [3, 3], 1]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [256, 256], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b04950d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 144893.0437400341, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 30.92450980392157, "ram_util_percent": 81.64852941176468}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 12.231558696555082, "cur_kl_coeff": 1.5187500000000005, "cur_lr": 0.00010000000000000003, "total_loss": 8.294073470181258, "policy_loss": -0.09006810043581205, "vf_loss": 8.360653613610243, "vf_explained_var": 0.3230369108063834, "kl": 0.015465318439299661, "entropy": 0.9664406695063152, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 125685.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.828733563360084, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.00010000000000000003, "total_loss": 9.417442916183875, "policy_loss": -0.08226963296599155, "vf_loss": 9.482673712129946, "vf_explained_var": -0.4994303543100912, "kl": 0.016828483419499926, "entropy": 0.7099874736770752, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 125685.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 268000, "num_env_steps_trained": 268000, "num_agent_steps_sampled": 1072000, "num_agent_steps_trained": 1072000}, "env_runners": {"episode_reward_max": 536.1976661363864, "episode_reward_min": -77.48125991249817, "episode_reward_mean": 96.24906634234529, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -714.4817035575763, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 711.0451522317858}, "policy_reward_mean": {"prey_policy": -341.5937655613143, "predator_policy": 389.71829873248686}, "custom_metrics": {}, "hist_stats": {"episode_reward": [6.3889813193604965, 8.964752662852346, 0.24999999999999722, 26.547838355366704, 19.432924395674586, 207.97040706316966, 238.3487131913732, -1.5139842838381972, 272.6556197182697, 84.41535266711902, 37.993105619250436, -0.5813394091824833, 122.56110492542949, 27.224360567670132, 383.70198348164445, 0.19000000000000106, 14.178872733829758, 337.6738022415212, -8.494949982050718, -56.17966650126431, 22.83760500813615, -59.5744482170785, 88.81369265196459, 60.3742272641564, 2.329999999999991, -33.484784412285535, -33.287672256489124, 150.07999999999998, 76.13999999999999, 0.36999999999999034, 1.257789450050666, 0.39553254743580446, 62.203263111140565, 180.447187413296, 0.31112508890500834, 0.10999999999999543, 74.7065909518409, 15.238507363551234, 71.41449024745518, 126.91222016489982, 275.99667361252074, -11.221392337900443, 15.17883776062874, 354.1535615055199, 225.51154956742621, 50.15, 30.575821555127057, 153.38649901887388, 18.085699739792418, -24.667483207330996, 0.13999999999999724, 152.05059615950398, 250.03221871411324, 388.3816145295697, 192.13, 197.99058281755794, 136.34, 181.6643007716972, 150.12, -77.48125991249817, 62.501755049076564, 111.33517506342764, 194.54707771879592, 327.49686987483847, 171.3265318179811, 0.1000000000000032, 85.42450247153138, 47.23000000000001, 231.15640296524163, 187.27506303711408, 4.73893032901808, 14.36267173933724, 44.328245705784184, -28.624847348467746, 71.8302105824529, 9.06806458712832, 78.08, 319.5602511701773, 154.60918639372957, 0.03999999999999915, 8.705939603528115, 59.75699413453019, 239.04166962867177, 12.434580854244626, 152.32476040561644, 32.25000000000003, 237.10628642421426, 0.48267860720124034, 255.71008962346792, 374.47609323323604, -31.256723487425777, 0.08000000000000052, 8.784973760550338, 185.3820568017247, 78.61868807171452, -2.6481842603380263, 95.38914371592688, 105.19956341353699, 536.1976661363864, 2.6432409728003714], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-488.85532056122224, -453.9266696554694, -328.0867587601706, -465.32454753778893, -305.180547024655, -685.835208229548, -479.6923573383248, -310.15067557276257, -378.04245455741415, -375.9923659738385, 116.86248118244887, -509.71588138785427, -561.3815527418831, -56.93569116742975, -577.0204445122102, -318.5875016175848, 140.0307462699207, -493.50962892399167, -91.11491296846037, -339.812000230791, -422.80554866664835, -321.5613855390122, -542.2418311148097, -418.92170852928353, 2.0000000000000013, -473.8447548000509, -489.1826354028659, -304.4108556714101, -465.2371190766328, 183.19326588819638, -483.1718028258854, -369.16129767198976, -172.28958360997765, -447.5104451650969, 193.25649761281898, -429.60374746173443, -386.89665965914986, -419.42253341248494, -103.49639106982966, -495.0974222806445, -714.4817035575763, -467.8886383442399, -418.9252250091691, -398.6872058398407, -227.64125909835548, -495.58837473568394, -505.23872351736514, -220.98859749679943, -432.37280291756804, -367.46174030702946, -388.13942444643004, -324.04042796876837, -350.0450476256884, -331.94478675367174, 54.76740336527119, -696.8024378204697, -500.20042867433915, -165.54572443420673, -305.17628609160386, -690.321961168177, -436.3385814059705, -464.7837642141974, -497.40226731666036, -342.85427388575766, -397.89267047363927, -280.20480672409985, -427.7140200224749, -153.79276468263092, -659.7625949887799, -563.9039161224691, -490.68068850550384, -325.64441398417694, -399.4586546725799, -171.3206722520147, -432.72661347139444, -327.98969192201434, -487.1933061889473, 0.15682019690587484, -58.47904665547971, -446.84288825492115, -619.5848313698951, 0.36267720375811247, -366.9699125327032, -343.14122812084395, -401.363466631902, -491.7909809368635, -515.5803100076154, 115.05121629900738, -140.12675023285854, -618.6609279338315, -221.32788446167967, -558.7448061120724, -367.3900735284708, -485.56896973806636, -41.86026906318723, -261.40519716867345, -413.98417812308975, -530.2548630097921, -339.8889699930191, -445.0905023113544, -568.1262056979997, -278.5067107440448, -574.5575733426944, -52.93016007631692, -467.94021417110554, 198.01999999999998, -586.5717279758494, 25.15282555432023, -451.6894594299445, 192.07999999999998, -432.0443199951305, -27.59092400008106, -77.01881167549423, -205.27467902500206, -379.503823559174, -26.445295269303344, -494.0028548015751, 70.48208398155401, -463.0927408278359, -467.43539961151725, -507.04315680183237, -273.15407215056604, -386.7856799174803, -106.65042109870942, 141.21188105661207, -415.2728599595391, -380.6621590847245, 169.5318848660488, -222.42084783140052, -478.9272040899596, -703.7070185858062, -394.1747950185734, -460.5248211460688, -205.49764015298558, -340.79829044402317, -321.8439558480523, -405.4681404089152, -92.4234608603819, -71.93591057391595, -604.4029538499195, -440.43822590370274, -268.34201919457945, 0.38324967741737254, -473.7586484238966, -378.13115005116435, -398.03323078929594, -523.3341501653282, -445.52832461506415, -315.24604062637945, -427.72300090002784, -348.6774454438954, -429.07071281270225, -120.82329733005102, -652.7419664828248, 200.0, -377.22848736903063, 34.96394411559112, -557.3422143846592, -573.2331823236538, -328.04070201841336, -299.9779345336709, -580.3373259394918, -445.63971308526754, -271.01603020455616, -78.95616524018108, -500.5560869934931, -538.8771900737511, -351.8493636144383, -547.0660719010174, -422.2327346086782, -697.6905255941384, -209.64565943093586, -336.0740022924167, 52.77162667731818, -507.37644295286975, -555.0075403674645, -68.21206221135165, -585.5937966280742, 78.44791706245103, -469.50525773854696, -303.5280583181806, -429.1195228732485, -408.39106432429656, -562.7144792699378, -292.8603672360543, -381.801447865462, -234.41339503643064, -451.5624812590103, -224.30514254979153, -478.71992483264205, -377.6992009497718, -488.1399561701095, -415.5818514854223, -63.42624045188768, -270.8798403180144, -310.64170482274085, 150.2093704253579, -676.4389097097725, -561.621074814479, -564.882557594154], "policy_predator_policy_reward": [455.8025390523402, 493.36843248371207, 312.11402456907575, 490.2620343917364, 305.4305470246548, 685.835208229548, 483.0869790382994, 333.3038922281545, 399.6001499476861, 373.86759497924106, 91.4814309120956, 509.3423763564794, 396.7862147718079, 459.8797423288775, 551.9232809554735, 342.17068089048337, 421.23999072638543, 204.89451164595522, 232.19323028400336, 283.14903558236716, 459.87777433437725, 322.4822654905337, 417.6744974295686, 542.907702805342, 314.4380966159511, 279.96776310952896, 330.63399633655916, 490.1838553053868, 310.5732774442291, 355.17255922585207, 483.1718028258854, 369.3512976719896, 178.27145266406282, 455.7074488448405, 237.40484773152906, 336.61620435890796, 383.8924326788265, 413.93181041075746, 46.40115875637683, 496.0129880928337, 711.0451522317858, 494.1627946781662, 409.2976159476217, 348.74036668430966, 405.98226754732616, 406.06105893867766, 410.8928212347681, 375.70872704355276, 432.45280291756796, 369.71174030702934, 391.96194965995153, 286.73311834296123, 316.48887616227853, 332.2132859605925, 95.31259663472885, 696.8024378204697, 501.2304286743391, 240.65572443420663, 305.4462860916036, 690.421961168177, 436.5420999448343, 465.8380351253841, 496.9218070341326, 343.7302667157211, 299.02708147396334, 441.27365883491535, 331.17527014300595, 430.77870197539545, 660.073720077685, 563.9039161224691, 490.7006885055038, 325.73441398417697, 351.39297911826554, 294.0929387581696, 445.78512083494553, 330.1696919220142, 93.54663315630305, 464.9043430831928, 361.2476622027342, 270.986492872566, 419.44492470721036, 475.7739030714485, 373.94712364001543, 324.94262467563124, 442.0478096178258, 466.28547571156815, 435.0254720438664, 319.65718317026153, 509.60279643760487, 474.69643129651183, 271.47788446167954, 558.7448061120724, 386.79093160321673, 496.74393321844707, 45.492511489602705, 411.1594537611313, 595.6041746389027, 366.7205662337716, 344.63105165961093, 415.6809374374317, 568.1262056979997, 278.64671074404475, 504.6677731694936, 274.8705564090212, 393.59935515036705, 126.35307773485174, 523.5200933258875, 426.2804236252101, 451.7394594299445, 0.0, 357.072284599451, 300.5535422133178, 178.21881167549407, 240.41467902500193, 305.7303688183637, 281.8830507818113, 494.05285480157505, 79.58791601844602, 451.16111427799115, 401.8857662488638, 466.89618893734973, 375.8027950641249, 213.75216720582804, 391.01910887378926, 73.20610948752076, 395.40194713420203, 331.3364270617892, 207.29071703172508, 453.82159348046207, 418.8529902588786, 703.7570185858062, 394.22479501857333, 509.3168942268072, 242.13006954377835, 350.90829044402307, 358.9639558480522, 331.3397447751413, 397.7082594593984, 387.1287059162328, 476.48522154471607, 457.16403053118097, 256.35514489611757, 15.521984078620722, 472.21608640719575, 382.17395275097624, 438.3186737952679, 506.63073564012484, 433.60689179179957, 403.49617265026245, 411.3030794585974, 418.96822216295567, 367.84800068077016, 198.89329733005096, 652.7519664828247, 280.11764978107357, 216.67108875813432, 152.36103969309193, 524.6264169697055, 573.2331823236538, 328.0807020184133, 334.280019993953, 554.741180082738, 430.12735696429854, 346.2853804600543, 377.720425275736, 440.83349658661035, 547.8759068776358, 355.2852276647983, 516.0163211313467, 605.607245783965, 697.6905255941384, 241.89565943093572, 298.9259206198469, 221.48274141946578, 507.799121560071, 555.0675403674645, 428.89887098544204, 480.61707747745095, 337.9647998020114, 427.5686341073202, 308.27539323786743, 393.11546446613573, 408.4610643242965, 562.7244792699378, 301.49534099660366, 381.9514478654619, 453.4770221201525, 417.88091097701266, 331.4358763318639, 450.20787912228406, 307.63801556118176, 555.5529572983614, 398.76646293540756, 175.6307727178289, 359.87317694082907, 326.8479316134629, 439.86044581767555, 622.5667596031253, 578.6047752116718, 550.5420981697619]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.868386716645737, "mean_inference_ms": 52.78120930662375, "mean_action_processing_ms": 1.5417703486545522, "mean_env_wait_ms": 6.480573216607342, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005637407302856445, "StateBufferConnector_ms": 0.00419771671295166, "ViewRequirementAgentConnector_ms": 0.11198997497558594}, "num_episodes": 22, "episode_return_max": 536.1976661363864, "episode_return_min": -77.48125991249817, "episode_return_mean": 96.24906634234529, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1072000, "num_agent_steps_trained": 1072000, "num_env_steps_sampled": 268000, "num_env_steps_trained": 268000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1.0846264419909721, "num_env_steps_trained_throughput_per_sec": 1.0846264419909721, "timesteps_total": 268000, "num_env_steps_sampled_lifetime": 268000, "num_agent_steps_sampled_lifetime": 1072000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1072000, "timers": {"training_iteration_time_ms": 5659150.318, "restore_workers_time_ms": 0.015, "training_step_time_ms": 5659150.264, "sample_time_ms": 97194.219, "learn_time_ms": 5561933.957, "learn_throughput": 0.719, "synch_weights_time_ms": 15.854}, "counters": {"num_env_steps_sampled": 268000, "num_env_steps_trained": 268000, "num_agent_steps_sampled": 1072000, "num_agent_steps_trained": 1072000}, "done": false, "training_iteration": 67, "trial_id": "b941d_00000", "date": "2024-08-19_01-10-17", "timestamp": 1724010017, "time_this_iter_s": 3687.948967933655, "time_total_s": 148580.99270796776, "pid": 81115, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[32, [4, 4], 2], [64, [3, 3], 2], [128, [3, 3], 1]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [256, 256], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b04360d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 148580.99270796776, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 26.152307692307698, "ram_util_percent": 82.13487179487178}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.220793052577468, "cur_kl_coeff": 1.5187500000000005, "cur_lr": 0.00010000000000000003, "total_loss": 7.6242202569567965, "policy_loss": -0.08377742430862907, "vf_loss": 7.686513656030887, "vf_explained_var": 0.3709179269889044, "kl": 0.014145852426396646, "entropy": 0.8756435144515264, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 127575.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 12.619277466415728, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.00010000000000000003, "total_loss": 8.825764505699198, "policy_loss": -0.09264428585117299, "vf_loss": 8.899826168887829, "vf_explained_var": -0.32192625198414715, "kl": 0.0183531872989407, "entropy": 0.823380843072972, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 127575.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 272000, "num_env_steps_trained": 272000, "num_agent_steps_sampled": 1088000, "num_agent_steps_trained": 1088000}, "env_runners": {"episode_reward_max": 536.1976661363864, "episode_reward_min": -122.0584370755235, "episode_reward_mean": 99.83838241255371, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -714.4817035575763, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 711.0451522317858}, "policy_reward_mean": {"prey_policy": -338.8378727427058, "predator_policy": 388.75706394898253}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8.494949982050718, -56.17966650126431, 22.83760500813615, -59.5744482170785, 88.81369265196459, 60.3742272641564, 2.329999999999991, -33.484784412285535, -33.287672256489124, 150.07999999999998, 76.13999999999999, 0.36999999999999034, 1.257789450050666, 0.39553254743580446, 62.203263111140565, 180.447187413296, 0.31112508890500834, 0.10999999999999543, 74.7065909518409, 15.238507363551234, 71.41449024745518, 126.91222016489982, 275.99667361252074, -11.221392337900443, 15.17883776062874, 354.1535615055199, 225.51154956742621, 50.15, 30.575821555127057, 153.38649901887388, 18.085699739792418, -24.667483207330996, 0.13999999999999724, 152.05059615950398, 250.03221871411324, 388.3816145295697, 192.13, 197.99058281755794, 136.34, 181.6643007716972, 150.12, -77.48125991249817, 62.501755049076564, 111.33517506342764, 194.54707771879592, 327.49686987483847, 171.3265318179811, 0.1000000000000032, 85.42450247153138, 47.23000000000001, 231.15640296524163, 187.27506303711408, 4.73893032901808, 14.36267173933724, 44.328245705784184, -28.624847348467746, 71.8302105824529, 9.06806458712832, 78.08, 319.5602511701773, 154.60918639372957, 0.03999999999999915, 8.705939603528115, 59.75699413453019, 239.04166962867177, 12.434580854244626, 152.32476040561644, 32.25000000000003, 237.10628642421426, 0.48267860720124034, 255.71008962346792, 374.47609323323604, -31.256723487425777, 0.08000000000000052, 8.784973760550338, 185.3820568017247, 78.61868807171452, -2.6481842603380263, 95.38914371592688, 105.19956341353699, 536.1976661363864, 2.6432409728003714, 8.136953637854374, 274.80657776754015, 298.8305421895684, 223.4, 225.37625287571547, -10.963704328201, 155.4226003481578, 252.17000000000002, 2.3867193701826723, -62.953807151046426, 156.40512653550886, 82.43494495813076, -122.0584370755235, 202.52067743186933, 75.26, 375.8405459576639, 1.7807546251401494, 6.538355127790376], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-386.89665965914986, -419.42253341248494, -103.49639106982966, -495.0974222806445, -714.4817035575763, -467.8886383442399, -418.9252250091691, -398.6872058398407, -227.64125909835548, -495.58837473568394, -505.23872351736514, -220.98859749679943, -432.37280291756804, -367.46174030702946, -388.13942444643004, -324.04042796876837, -350.0450476256884, -331.94478675367174, 54.76740336527119, -696.8024378204697, -500.20042867433915, -165.54572443420673, -305.17628609160386, -690.321961168177, -436.3385814059705, -464.7837642141974, -497.40226731666036, -342.85427388575766, -397.89267047363927, -280.20480672409985, -427.7140200224749, -153.79276468263092, -659.7625949887799, -563.9039161224691, -490.68068850550384, -325.64441398417694, -399.4586546725799, -171.3206722520147, -432.72661347139444, -327.98969192201434, -487.1933061889473, 0.15682019690587484, -58.47904665547971, -446.84288825492115, -619.5848313698951, 0.36267720375811247, -366.9699125327032, -343.14122812084395, -401.363466631902, -491.7909809368635, -515.5803100076154, 115.05121629900738, -140.12675023285854, -618.6609279338315, -221.32788446167967, -558.7448061120724, -367.3900735284708, -485.56896973806636, -41.86026906318723, -261.40519716867345, -413.98417812308975, -530.2548630097921, -339.8889699930191, -445.0905023113544, -568.1262056979997, -278.5067107440448, -574.5575733426944, -52.93016007631692, -467.94021417110554, 198.01999999999998, -586.5717279758494, 25.15282555432023, -451.6894594299445, 192.07999999999998, -432.0443199951305, -27.59092400008106, -77.01881167549423, -205.27467902500206, -379.503823559174, -26.445295269303344, -494.0028548015751, 70.48208398155401, -463.0927408278359, -467.43539961151725, -507.04315680183237, -273.15407215056604, -386.7856799174803, -106.65042109870942, 141.21188105661207, -415.2728599595391, -380.6621590847245, 169.5318848660488, -222.42084783140052, -478.9272040899596, -703.7070185858062, -394.1747950185734, -460.5248211460688, -205.49764015298558, -340.79829044402317, -321.8439558480523, -405.4681404089152, -92.4234608603819, -71.93591057391595, -604.4029538499195, -440.43822590370274, -268.34201919457945, 0.38324967741737254, -473.7586484238966, -378.13115005116435, -398.03323078929594, -523.3341501653282, -445.52832461506415, -315.24604062637945, -427.72300090002784, -348.6774454438954, -429.07071281270225, -120.82329733005102, -652.7419664828248, 200.0, -377.22848736903063, 34.96394411559112, -557.3422143846592, -573.2331823236538, -328.04070201841336, -299.9779345336709, -580.3373259394918, -445.63971308526754, -271.01603020455616, -78.95616524018108, -500.5560869934931, -538.8771900737511, -351.8493636144383, -547.0660719010174, -422.2327346086782, -697.6905255941384, -209.64565943093586, -336.0740022924167, 52.77162667731818, -507.37644295286975, -555.0075403674645, -68.21206221135165, -585.5937966280742, 78.44791706245103, -469.50525773854696, -303.5280583181806, -429.1195228732485, -408.39106432429656, -562.7144792699378, -292.8603672360543, -381.801447865462, -234.41339503643064, -451.5624812590103, -224.30514254979153, -478.71992483264205, -377.6992009497718, -488.1399561701095, -415.5818514854223, -63.42624045188768, -270.8798403180144, -310.64170482274085, 150.2093704253579, -676.4389097097725, -561.621074814479, -564.882557594154, -483.5130373885757, -411.6245273678789, 38.86449998692865, -511.43772368831094, -402.30682395606044, 32.41333507215003, -18.46268110110968, -35.69819240102035, -31.920491383503382, -660.8306176726242, -517.3969660959003, -498.91405023181954, 1.144786017247915, -530.203242455854, -70.11109797994357, 11.829324025494572, -545.689782790991, -302.3872408738908, -405.03586414424717, -482.5300058320043, -457.6287296205352, -325.96824405866585, -436.69089026755034, -338.2964769936986, -498.1087515030724, -402.29591825623305, 43.09428456047992, -428.3880382250823, -170.0845102921664, -345.818746765605, -460.2804310240232, 155.44348706012738, -439.89393511721244, -356.7358095293992, -656.3275545923509, -430.7950147348081], "policy_predator_policy_reward": [383.8924326788265, 413.93181041075746, 46.40115875637683, 496.0129880928337, 711.0451522317858, 494.1627946781662, 409.2976159476217, 348.74036668430966, 405.98226754732616, 406.06105893867766, 410.8928212347681, 375.70872704355276, 432.45280291756796, 369.71174030702934, 391.96194965995153, 286.73311834296123, 316.48887616227853, 332.2132859605925, 95.31259663472885, 696.8024378204697, 501.2304286743391, 240.65572443420663, 305.4462860916036, 690.421961168177, 436.5420999448343, 465.8380351253841, 496.9218070341326, 343.7302667157211, 299.02708147396334, 441.27365883491535, 331.17527014300595, 430.77870197539545, 660.073720077685, 563.9039161224691, 490.7006885055038, 325.73441398417697, 351.39297911826554, 294.0929387581696, 445.78512083494553, 330.1696919220142, 93.54663315630305, 464.9043430831928, 361.2476622027342, 270.986492872566, 419.44492470721036, 475.7739030714485, 373.94712364001543, 324.94262467563124, 442.0478096178258, 466.28547571156815, 435.0254720438664, 319.65718317026153, 509.60279643760487, 474.69643129651183, 271.47788446167954, 558.7448061120724, 386.79093160321673, 496.74393321844707, 45.492511489602705, 411.1594537611313, 595.6041746389027, 366.7205662337716, 344.63105165961093, 415.6809374374317, 568.1262056979997, 278.64671074404475, 504.6677731694936, 274.8705564090212, 393.59935515036705, 126.35307773485174, 523.5200933258875, 426.2804236252101, 451.7394594299445, 0.0, 357.072284599451, 300.5535422133178, 178.21881167549407, 240.41467902500193, 305.7303688183637, 281.8830507818113, 494.05285480157505, 79.58791601844602, 451.16111427799115, 401.8857662488638, 466.89618893734973, 375.8027950641249, 213.75216720582804, 391.01910887378926, 73.20610948752076, 395.40194713420203, 331.3364270617892, 207.29071703172508, 453.82159348046207, 418.8529902588786, 703.7570185858062, 394.22479501857333, 509.3168942268072, 242.13006954377835, 350.90829044402307, 358.9639558480522, 331.3397447751413, 397.7082594593984, 387.1287059162328, 476.48522154471607, 457.16403053118097, 256.35514489611757, 15.521984078620722, 472.21608640719575, 382.17395275097624, 438.3186737952679, 506.63073564012484, 433.60689179179957, 403.49617265026245, 411.3030794585974, 418.96822216295567, 367.84800068077016, 198.89329733005096, 652.7519664828247, 280.11764978107357, 216.67108875813432, 152.36103969309193, 524.6264169697055, 573.2331823236538, 328.0807020184133, 334.280019993953, 554.741180082738, 430.12735696429854, 346.2853804600543, 377.720425275736, 440.83349658661035, 547.8759068776358, 355.2852276647983, 516.0163211313467, 605.607245783965, 697.6905255941384, 241.89565943093572, 298.9259206198469, 221.48274141946578, 507.799121560071, 555.0675403674645, 428.89887098544204, 480.61707747745095, 337.9647998020114, 427.5686341073202, 308.27539323786743, 393.11546446613573, 408.4610643242965, 562.7244792699378, 301.49534099660366, 381.9514478654619, 453.4770221201525, 417.88091097701266, 331.4358763318639, 450.20787912228406, 307.63801556118176, 555.5529572983614, 398.76646293540756, 175.6307727178289, 359.87317694082907, 326.8479316134629, 439.86044581767555, 622.5667596031253, 578.6047752116718, 550.5420981697619, 483.5130373885757, 419.76148100573323, 383.3133317047148, 364.0664697642078, 369.8088553069074, 298.9151757665714, 114.77268110110968, 162.78819240102032, 434.385202238431, 483.7421596934109, 432.49766641578276, 572.8496455837366, 423.0067924283312, 261.4742643584326, 178.2010979799435, 132.25067597450536, 545.699782790991, 304.7639602440733, 397.8236979496995, 426.7883648755055, 519.7918225529419, 420.210277661768, 450.1589908589746, 407.2633213604048, 529.6220454500436, 248.72418723373755, 178.0434318558705, 409.77099924060116, 245.1945102921663, 345.968746765605, 330.42155038411886, 350.2559395374408, 433.4236144726245, 364.98688479912676, 655.4617665284759, 438.1991579264734]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.248380681916594, "mean_inference_ms": 62.642491959410364, "mean_action_processing_ms": 2.1695590393000663, "mean_env_wait_ms": 5.865113582470188, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0050506591796875, "StateBufferConnector_ms": 0.00406956672668457, "ViewRequirementAgentConnector_ms": 0.11770427227020264}, "num_episodes": 18, "episode_return_max": 536.1976661363864, "episode_return_min": -122.0584370755235, "episode_return_mean": 99.83838241255371, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1088000, "num_agent_steps_trained": 1088000, "num_env_steps_sampled": 272000, "num_env_steps_trained": 272000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 0.3506692621630976, "num_env_steps_trained_throughput_per_sec": 0.3506692621630976, "timesteps_total": 272000, "num_env_steps_sampled_lifetime": 272000, "num_agent_steps_sampled_lifetime": 1088000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1088000, "timers": {"training_iteration_time_ms": 6172526.32, "restore_workers_time_ms": 0.013, "training_step_time_ms": 6172526.269, "sample_time_ms": 191224.05, "learn_time_ms": 5981280.001, "learn_throughput": 0.669, "synch_weights_time_ms": 15.862}, "counters": {"num_env_steps_sampled": 272000, "num_env_steps_trained": 272000, "num_agent_steps_sampled": 1088000, "num_agent_steps_trained": 1088000}, "done": false, "training_iteration": 68, "trial_id": "b941d_00000", "date": "2024-08-19_04-20-24", "timestamp": 1724021424, "time_this_iter_s": 11406.796653032303, "time_total_s": 159987.78936100006, "pid": 81115, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[32, [4, 4], 2], [64, [3, 3], 2], [128, [3, 3], 1]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [256, 256], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b04a98b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 159987.78936100006, "iterations_since_restore": 68, "perf": {"cpu_util_percent": 34.83827751196172, "ram_util_percent": 80.32822966507176}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 11.726677909793047, "cur_kl_coeff": 1.5187500000000005, "cur_lr": 0.00010000000000000003, "total_loss": 8.135706012968033, "policy_loss": -0.08338310300291235, "vf_loss": 8.197186916341227, "vf_explained_var": 0.3673145799725144, "kl": 0.014421202318701237, "entropy": 0.9859092075988729, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 129465.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.526148976913836, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.00010000000000000003, "total_loss": 9.0758507567108, "policy_loss": -0.07932513954213984, "vf_loss": 9.138322414418377, "vf_explained_var": -0.3714553649778719, "kl": 0.016645384816691915, "entropy": 0.7066923854843018, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 129465.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_agent_steps_sampled": 1104000, "num_agent_steps_trained": 1104000}, "env_runners": {"episode_reward_max": 536.1976661363864, "episode_reward_min": -122.0584370755235, "episode_reward_mean": 116.25473818126422, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -703.7070185858062, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 703.7570185858062}, "policy_reward_mean": {"prey_policy": -331.9864540846224, "predator_policy": 390.11382317525437}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11.221392337900443, 15.17883776062874, 354.1535615055199, 225.51154956742621, 50.15, 30.575821555127057, 153.38649901887388, 18.085699739792418, -24.667483207330996, 0.13999999999999724, 152.05059615950398, 250.03221871411324, 388.3816145295697, 192.13, 197.99058281755794, 136.34, 181.6643007716972, 150.12, -77.48125991249817, 62.501755049076564, 111.33517506342764, 194.54707771879592, 327.49686987483847, 171.3265318179811, 0.1000000000000032, 85.42450247153138, 47.23000000000001, 231.15640296524163, 187.27506303711408, 4.73893032901808, 14.36267173933724, 44.328245705784184, -28.624847348467746, 71.8302105824529, 9.06806458712832, 78.08, 319.5602511701773, 154.60918639372957, 0.03999999999999915, 8.705939603528115, 59.75699413453019, 239.04166962867177, 12.434580854244626, 152.32476040561644, 32.25000000000003, 237.10628642421426, 0.48267860720124034, 255.71008962346792, 374.47609323323604, -31.256723487425777, 0.08000000000000052, 8.784973760550338, 185.3820568017247, 78.61868807171452, -2.6481842603380263, 95.38914371592688, 105.19956341353699, 536.1976661363864, 2.6432409728003714, 8.136953637854374, 274.80657776754015, 298.8305421895684, 223.4, 225.37625287571547, -10.963704328201, 155.4226003481578, 252.17000000000002, 2.3867193701826723, -62.953807151046426, 156.40512653550886, 82.43494495813076, -122.0584370755235, 202.52067743186933, 75.26, 375.8405459576639, 1.7807546251401494, 6.538355127790376, 355.01937337970526, 319.3257903225474, 35.969177923323215, -38.946762628060426, 0.25000000000000067, 326.7002354497731, 86.74371370838573, -0.05881836374428029, 17.955542337557535, 197.04999999999998, 2.1399999999999966, 143.28244908579754, 143.89521746599323, 1.8172663117963814, 241.99612191417145, 310.68909197613743, 54.57850682579383, 66.04378358937453, 7.265139249489369, 135.3167931501045, 6.060000000000002, 103.26749526659205, 144.19284341249647], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-366.9699125327032, -343.14122812084395, -401.363466631902, -491.7909809368635, -515.5803100076154, 115.05121629900738, -140.12675023285854, -618.6609279338315, -221.32788446167967, -558.7448061120724, -367.3900735284708, -485.56896973806636, -41.86026906318723, -261.40519716867345, -413.98417812308975, -530.2548630097921, -339.8889699930191, -445.0905023113544, -568.1262056979997, -278.5067107440448, -574.5575733426944, -52.93016007631692, -467.94021417110554, 198.01999999999998, -586.5717279758494, 25.15282555432023, -451.6894594299445, 192.07999999999998, -432.0443199951305, -27.59092400008106, -77.01881167549423, -205.27467902500206, -379.503823559174, -26.445295269303344, -494.0028548015751, 70.48208398155401, -463.0927408278359, -467.43539961151725, -507.04315680183237, -273.15407215056604, -386.7856799174803, -106.65042109870942, 141.21188105661207, -415.2728599595391, -380.6621590847245, 169.5318848660488, -222.42084783140052, -478.9272040899596, -703.7070185858062, -394.1747950185734, -460.5248211460688, -205.49764015298558, -340.79829044402317, -321.8439558480523, -405.4681404089152, -92.4234608603819, -71.93591057391595, -604.4029538499195, -440.43822590370274, -268.34201919457945, 0.38324967741737254, -473.7586484238966, -378.13115005116435, -398.03323078929594, -523.3341501653282, -445.52832461506415, -315.24604062637945, -427.72300090002784, -348.6774454438954, -429.07071281270225, -120.82329733005102, -652.7419664828248, 200.0, -377.22848736903063, 34.96394411559112, -557.3422143846592, -573.2331823236538, -328.04070201841336, -299.9779345336709, -580.3373259394918, -445.63971308526754, -271.01603020455616, -78.95616524018108, -500.5560869934931, -538.8771900737511, -351.8493636144383, -547.0660719010174, -422.2327346086782, -697.6905255941384, -209.64565943093586, -336.0740022924167, 52.77162667731818, -507.37644295286975, -555.0075403674645, -68.21206221135165, -585.5937966280742, 78.44791706245103, -469.50525773854696, -303.5280583181806, -429.1195228732485, -408.39106432429656, -562.7144792699378, -292.8603672360543, -381.801447865462, -234.41339503643064, -451.5624812590103, -224.30514254979153, -478.71992483264205, -377.6992009497718, -488.1399561701095, -415.5818514854223, -63.42624045188768, -270.8798403180144, -310.64170482274085, 150.2093704253579, -676.4389097097725, -561.621074814479, -564.882557594154, -483.5130373885757, -411.6245273678789, 38.86449998692865, -511.43772368831094, -402.30682395606044, 32.41333507215003, -18.46268110110968, -35.69819240102035, -31.920491383503382, -660.8306176726242, -517.3969660959003, -498.91405023181954, 1.144786017247915, -530.203242455854, -70.11109797994357, 11.829324025494572, -545.689782790991, -302.3872408738908, -405.03586414424717, -482.5300058320043, -457.6287296205352, -325.96824405866585, -436.69089026755034, -338.2964769936986, -498.1087515030724, -402.29591825623305, 43.09428456047992, -428.3880382250823, -170.0845102921664, -345.818746765605, -460.2804310240232, 155.44348706012738, -439.89393511721244, -356.7358095293992, -656.3275545923509, -430.7950147348081, -447.5227267659528, 200.0, 81.98221697371257, -387.061724789245, -520.423508193039, -516.6781467161265, -455.78503113950296, -460.89207364198273, -469.9153974733243, -547.3171754117966, 78.57811946835666, -496.8461120828876, -517.9709758181084, -245.46172346346066, -334.46818592270347, -410.929973827975, -447.77632521797847, -424.5766530358673, 194.81496165418832, -453.20560197341075, -434.90442093294064, -552.465328780927, -387.3300385515309, -361.30375547997625, -165.4312416973148, -429.05182250707827, -400.46516306613864, -465.4753784378581, -98.52369021605438, -595.6087660538224, -595.2614738327437, 94.65506687423222, -678.0429161078383, -408.10912713688975, -501.2847439566435, -261.8926281625683, -427.38444855587585, -499.9347323078799, 92.22334987434445, -342.04495582734484, -485.29953591154833, -414.3012938338869, -298.02915276929707, -101.46271133346369, -403.11660741120255, -264.1020834607156], "policy_predator_policy_reward": [373.94712364001543, 324.94262467563124, 442.0478096178258, 466.28547571156815, 435.0254720438664, 319.65718317026153, 509.60279643760487, 474.69643129651183, 271.47788446167954, 558.7448061120724, 386.79093160321673, 496.74393321844707, 45.492511489602705, 411.1594537611313, 595.6041746389027, 366.7205662337716, 344.63105165961093, 415.6809374374317, 568.1262056979997, 278.64671074404475, 504.6677731694936, 274.8705564090212, 393.59935515036705, 126.35307773485174, 523.5200933258875, 426.2804236252101, 451.7394594299445, 0.0, 357.072284599451, 300.5535422133178, 178.21881167549407, 240.41467902500193, 305.7303688183637, 281.8830507818113, 494.05285480157505, 79.58791601844602, 451.16111427799115, 401.8857662488638, 466.89618893734973, 375.8027950641249, 213.75216720582804, 391.01910887378926, 73.20610948752076, 395.40194713420203, 331.3364270617892, 207.29071703172508, 453.82159348046207, 418.8529902588786, 703.7570185858062, 394.22479501857333, 509.3168942268072, 242.13006954377835, 350.90829044402307, 358.9639558480522, 331.3397447751413, 397.7082594593984, 387.1287059162328, 476.48522154471607, 457.16403053118097, 256.35514489611757, 15.521984078620722, 472.21608640719575, 382.17395275097624, 438.3186737952679, 506.63073564012484, 433.60689179179957, 403.49617265026245, 411.3030794585974, 418.96822216295567, 367.84800068077016, 198.89329733005096, 652.7519664828247, 280.11764978107357, 216.67108875813432, 152.36103969309193, 524.6264169697055, 573.2331823236538, 328.0807020184133, 334.280019993953, 554.741180082738, 430.12735696429854, 346.2853804600543, 377.720425275736, 440.83349658661035, 547.8759068776358, 355.2852276647983, 516.0163211313467, 605.607245783965, 697.6905255941384, 241.89565943093572, 298.9259206198469, 221.48274141946578, 507.799121560071, 555.0675403674645, 428.89887098544204, 480.61707747745095, 337.9647998020114, 427.5686341073202, 308.27539323786743, 393.11546446613573, 408.4610643242965, 562.7244792699378, 301.49534099660366, 381.9514478654619, 453.4770221201525, 417.88091097701266, 331.4358763318639, 450.20787912228406, 307.63801556118176, 555.5529572983614, 398.76646293540756, 175.6307727178289, 359.87317694082907, 326.8479316134629, 439.86044581767555, 622.5667596031253, 578.6047752116718, 550.5420981697619, 483.5130373885757, 419.76148100573323, 383.3133317047148, 364.0664697642078, 369.8088553069074, 298.9151757665714, 114.77268110110968, 162.78819240102032, 434.385202238431, 483.7421596934109, 432.49766641578276, 572.8496455837366, 423.0067924283312, 261.4742643584326, 178.2010979799435, 132.25067597450536, 545.699782790991, 304.7639602440733, 397.8236979496995, 426.7883648755055, 519.7918225529419, 420.210277661768, 450.1589908589746, 407.2633213604048, 529.6220454500436, 248.72418723373755, 178.0434318558705, 409.77099924060116, 245.1945102921663, 345.968746765605, 330.42155038411886, 350.2559395374408, 433.4236144726245, 364.98688479912676, 655.4617665284759, 438.1991579264734, 230.83988426013775, 371.70221588552045, 256.817143594134, 367.58815454394573, 472.2844067412536, 600.7864260912354, 389.2447846435244, 488.4855575099013, 469.9953974733242, 547.4871754117966, 338.0287502894459, 406.9394777748584, 477.02976633611604, 373.14664665383856, 335.61722352057006, 409.7221178663641, 413.3357197052093, 476.97280088619345, 1.2150383458116676, 454.22560197341073, 436.98442093294057, 552.5253287809271, 462.3011187508688, 429.6151243664361, 325.62591179301813, 412.75236987736804, 402.2524293779351, 465.5053784378581, 463.281827233509, 472.84675095053916, 509.8269689423798, 301.4685299922689, 490.9791619024315, 649.7513881680908, 467.548843048147, 361.6723126604388, 434.6095878053649, 499.9747323078799, 42.86344327575996, 342.2749558273445, 491.3295359115483, 414.3312938338869, 412.27602787143877, 90.48333149791391, 324.7216475339954, 486.68988675041885]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.103388952755585, "mean_inference_ms": 74.30761691406755, "mean_action_processing_ms": 3.097728355292706, "mean_env_wait_ms": 5.789272098166818, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006231427192687988, "StateBufferConnector_ms": 0.004099845886230469, "ViewRequirementAgentConnector_ms": 0.11835896968841553}, "num_episodes": 23, "episode_return_max": 536.1976661363864, "episode_return_min": -122.0584370755235, "episode_return_mean": 116.25473818126422, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1104000, "num_agent_steps_trained": 1104000, "num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 13.951671213186707, "num_env_steps_trained_throughput_per_sec": 13.951671213186707, "timesteps_total": 276000, "num_env_steps_sampled_lifetime": 276000, "num_agent_steps_sampled_lifetime": 1104000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1104000, "timers": {"training_iteration_time_ms": 5561978.355, "restore_workers_time_ms": 0.014, "training_step_time_ms": 5561978.296, "sample_time_ms": 191221.767, "learn_time_ms": 5370734.28, "learn_throughput": 0.745, "synch_weights_time_ms": 16.531}, "counters": {"num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_agent_steps_sampled": 1104000, "num_agent_steps_trained": 1104000}, "done": false, "training_iteration": 69, "trial_id": "b941d_00000", "date": "2024-08-19_04-25-11", "timestamp": 1724021711, "time_this_iter_s": 286.75269412994385, "time_total_s": 160274.54205513, "pid": 81115, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[32, [4, 4], 2], [64, [3, 3], 2], [128, [3, 3], 1]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [256, 256], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b0495e50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 160274.54205513, "iterations_since_restore": 69, "perf": {"cpu_util_percent": 20.85837837837838, "ram_util_percent": 77.56324324324325}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.081244243515862, "cur_kl_coeff": 1.5187500000000005, "cur_lr": 0.00010000000000000003, "total_loss": 8.62439068385533, "policy_loss": -0.08697466966794636, "vf_loss": 8.688653929775985, "vf_explained_var": 0.23965697906635425, "kl": 0.014954030120301371, "entropy": 0.9628906116914497, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 131355.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 14.875000937149007, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.00010000000000000003, "total_loss": 9.232019683797523, "policy_loss": -0.0791767371795017, "vf_loss": 9.294121475825234, "vf_explained_var": -0.5167221920515495, "kl": 0.016864168297259032, "entropy": 0.7306232977796484, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 131355.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 280000, "num_env_steps_trained": 280000, "num_agent_steps_sampled": 1120000, "num_agent_steps_trained": 1120000}, "env_runners": {"episode_reward_max": 536.1976661363864, "episode_reward_min": -122.0584370755235, "episode_reward_mean": 110.07977442716695, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -717.0519635237858, "predator_policy": 1.2150383458116676}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 717.0519635237858}, "policy_reward_mean": {"prey_policy": -341.89510694434847, "predator_policy": 396.9349941579319}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-77.48125991249817, 62.501755049076564, 111.33517506342764, 194.54707771879592, 327.49686987483847, 171.3265318179811, 0.1000000000000032, 85.42450247153138, 47.23000000000001, 231.15640296524163, 187.27506303711408, 4.73893032901808, 14.36267173933724, 44.328245705784184, -28.624847348467746, 71.8302105824529, 9.06806458712832, 78.08, 319.5602511701773, 154.60918639372957, 0.03999999999999915, 8.705939603528115, 59.75699413453019, 239.04166962867177, 12.434580854244626, 152.32476040561644, 32.25000000000003, 237.10628642421426, 0.48267860720124034, 255.71008962346792, 374.47609323323604, -31.256723487425777, 0.08000000000000052, 8.784973760550338, 185.3820568017247, 78.61868807171452, -2.6481842603380263, 95.38914371592688, 105.19956341353699, 536.1976661363864, 2.6432409728003714, 8.136953637854374, 274.80657776754015, 298.8305421895684, 223.4, 225.37625287571547, -10.963704328201, 155.4226003481578, 252.17000000000002, 2.3867193701826723, -62.953807151046426, 156.40512653550886, 82.43494495813076, -122.0584370755235, 202.52067743186933, 75.26, 375.8405459576639, 1.7807546251401494, 6.538355127790376, 355.01937337970526, 319.3257903225474, 35.969177923323215, -38.946762628060426, 0.25000000000000067, 326.7002354497731, 86.74371370838573, -0.05881836374428029, 17.955542337557535, 197.04999999999998, 2.1399999999999966, 143.28244908579754, 143.89521746599323, 1.8172663117963814, 241.99612191417145, 310.68909197613743, 54.57850682579383, 66.04378358937453, 7.265139249489369, 135.3167931501045, 6.060000000000002, 103.26749526659205, 144.19284341249647, 0.03999999999999071, 0.0699999999999994, 411.30170539122776, 1.0399999999999938, 109.32580795399033, 10.423015393791333, 72.42368669599765, 5.071615805358192, -7.771561172376096e-15, 279.7868225712558, 229.95912981402586, 214.33693939639244, 0.19000000000000017, 196.49183180133807, 9.060000000000002, 110.33686816788683, 193.91816816176717, -1.2695599681768215], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-463.0927408278359, -467.43539961151725, -507.04315680183237, -273.15407215056604, -386.7856799174803, -106.65042109870942, 141.21188105661207, -415.2728599595391, -380.6621590847245, 169.5318848660488, -222.42084783140052, -478.9272040899596, -703.7070185858062, -394.1747950185734, -460.5248211460688, -205.49764015298558, -340.79829044402317, -321.8439558480523, -405.4681404089152, -92.4234608603819, -71.93591057391595, -604.4029538499195, -440.43822590370274, -268.34201919457945, 0.38324967741737254, -473.7586484238966, -378.13115005116435, -398.03323078929594, -523.3341501653282, -445.52832461506415, -315.24604062637945, -427.72300090002784, -348.6774454438954, -429.07071281270225, -120.82329733005102, -652.7419664828248, 200.0, -377.22848736903063, 34.96394411559112, -557.3422143846592, -573.2331823236538, -328.04070201841336, -299.9779345336709, -580.3373259394918, -445.63971308526754, -271.01603020455616, -78.95616524018108, -500.5560869934931, -538.8771900737511, -351.8493636144383, -547.0660719010174, -422.2327346086782, -697.6905255941384, -209.64565943093586, -336.0740022924167, 52.77162667731818, -507.37644295286975, -555.0075403674645, -68.21206221135165, -585.5937966280742, 78.44791706245103, -469.50525773854696, -303.5280583181806, -429.1195228732485, -408.39106432429656, -562.7144792699378, -292.8603672360543, -381.801447865462, -234.41339503643064, -451.5624812590103, -224.30514254979153, -478.71992483264205, -377.6992009497718, -488.1399561701095, -415.5818514854223, -63.42624045188768, -270.8798403180144, -310.64170482274085, 150.2093704253579, -676.4389097097725, -561.621074814479, -564.882557594154, -483.5130373885757, -411.6245273678789, 38.86449998692865, -511.43772368831094, -402.30682395606044, 32.41333507215003, -18.46268110110968, -35.69819240102035, -31.920491383503382, -660.8306176726242, -517.3969660959003, -498.91405023181954, 1.144786017247915, -530.203242455854, -70.11109797994357, 11.829324025494572, -545.689782790991, -302.3872408738908, -405.03586414424717, -482.5300058320043, -457.6287296205352, -325.96824405866585, -436.69089026755034, -338.2964769936986, -498.1087515030724, -402.29591825623305, 43.09428456047992, -428.3880382250823, -170.0845102921664, -345.818746765605, -460.2804310240232, 155.44348706012738, -439.89393511721244, -356.7358095293992, -656.3275545923509, -430.7950147348081, -447.5227267659528, 200.0, 81.98221697371257, -387.061724789245, -520.423508193039, -516.6781467161265, -455.78503113950296, -460.89207364198273, -469.9153974733243, -547.3171754117966, 78.57811946835666, -496.8461120828876, -517.9709758181084, -245.46172346346066, -334.46818592270347, -410.929973827975, -447.77632521797847, -424.5766530358673, 194.81496165418832, -453.20560197341075, -434.90442093294064, -552.465328780927, -387.3300385515309, -361.30375547997625, -165.4312416973148, -429.05182250707827, -400.46516306613864, -465.4753784378581, -98.52369021605438, -595.6087660538224, -595.2614738327437, 94.65506687423222, -678.0429161078383, -408.10912713688975, -501.2847439566435, -261.8926281625683, -427.38444855587585, -499.9347323078799, 92.22334987434445, -342.04495582734484, -485.29953591154833, -414.3012938338869, -298.02915276929707, -101.46271133346369, -403.11660741120255, -264.1020834607156, -386.29391748442885, -663.7274670218172, -636.9861177913484, -365.15962020982124, 162.38451658447258, -483.8393283714162, -517.3526771287474, -538.3114373279353, -231.8306573081481, -250.53771576461116, -299.71105498917433, -463.25258597945503, -419.99510323352746, -387.8144141368399, -367.45638332794414, -506.4950567474856, -512.0049778454594, -717.0519635237858, -393.2199323754261, 105.27388958572607, -561.4392151559027, 174.25699372898904, -320.67166136421895, 85.32767506505053, -603.7380876663999, -340.68043106213867, -429.2944094312806, -127.13256784230197, -438.5088569047774, -359.54737791690735, -110.7758882577757, -352.7372512132938, -125.86864945399634, -338.10319275692933, -501.8223384250351, -322.1792327259976], "policy_predator_policy_reward": [451.16111427799115, 401.8857662488638, 466.89618893734973, 375.8027950641249, 213.75216720582804, 391.01910887378926, 73.20610948752076, 395.40194713420203, 331.3364270617892, 207.29071703172508, 453.82159348046207, 418.8529902588786, 703.7570185858062, 394.22479501857333, 509.3168942268072, 242.13006954377835, 350.90829044402307, 358.9639558480522, 331.3397447751413, 397.7082594593984, 387.1287059162328, 476.48522154471607, 457.16403053118097, 256.35514489611757, 15.521984078620722, 472.21608640719575, 382.17395275097624, 438.3186737952679, 506.63073564012484, 433.60689179179957, 403.49617265026245, 411.3030794585974, 418.96822216295567, 367.84800068077016, 198.89329733005096, 652.7519664828247, 280.11764978107357, 216.67108875813432, 152.36103969309193, 524.6264169697055, 573.2331823236538, 328.0807020184133, 334.280019993953, 554.741180082738, 430.12735696429854, 346.2853804600543, 377.720425275736, 440.83349658661035, 547.8759068776358, 355.2852276647983, 516.0163211313467, 605.607245783965, 697.6905255941384, 241.89565943093572, 298.9259206198469, 221.48274141946578, 507.799121560071, 555.0675403674645, 428.89887098544204, 480.61707747745095, 337.9647998020114, 427.5686341073202, 308.27539323786743, 393.11546446613573, 408.4610643242965, 562.7244792699378, 301.49534099660366, 381.9514478654619, 453.4770221201525, 417.88091097701266, 331.4358763318639, 450.20787912228406, 307.63801556118176, 555.5529572983614, 398.76646293540756, 175.6307727178289, 359.87317694082907, 326.8479316134629, 439.86044581767555, 622.5667596031253, 578.6047752116718, 550.5420981697619, 483.5130373885757, 419.76148100573323, 383.3133317047148, 364.0664697642078, 369.8088553069074, 298.9151757665714, 114.77268110110968, 162.78819240102032, 434.385202238431, 483.7421596934109, 432.49766641578276, 572.8496455837366, 423.0067924283312, 261.4742643584326, 178.2010979799435, 132.25067597450536, 545.699782790991, 304.7639602440733, 397.8236979496995, 426.7883648755055, 519.7918225529419, 420.210277661768, 450.1589908589746, 407.2633213604048, 529.6220454500436, 248.72418723373755, 178.0434318558705, 409.77099924060116, 245.1945102921663, 345.968746765605, 330.42155038411886, 350.2559395374408, 433.4236144726245, 364.98688479912676, 655.4617665284759, 438.1991579264734, 230.83988426013775, 371.70221588552045, 256.817143594134, 367.58815454394573, 472.2844067412536, 600.7864260912354, 389.2447846435244, 488.4855575099013, 469.9953974733242, 547.4871754117966, 338.0287502894459, 406.9394777748584, 477.02976633611604, 373.14664665383856, 335.61722352057006, 409.7221178663641, 413.3357197052093, 476.97280088619345, 1.2150383458116676, 454.22560197341073, 436.98442093294057, 552.5253287809271, 462.3011187508688, 429.6151243664361, 325.62591179301813, 412.75236987736804, 402.2524293779351, 465.5053784378581, 463.281827233509, 472.84675095053916, 509.8269689423798, 301.4685299922689, 490.9791619024315, 649.7513881680908, 467.548843048147, 361.6723126604388, 434.6095878053649, 499.9747323078799, 42.86344327575996, 342.2749558273445, 491.3295359115483, 414.3312938338869, 412.27602787143877, 90.48333149791391, 324.7216475339954, 486.68988675041885, 386.33391748442887, 663.7274670218172, 636.9861177913484, 365.2296202098212, 372.18854314528204, 360.5679740328893, 518.3526771287474, 538.3514373279353, 268.5683116969522, 323.1258693297972, 447.3681002566076, 326.0185561058126, 351.012022041482, 529.2211820248826, 367.55638332794416, 511.46667255284376, 512.0049778454594, 717.0519635237858, 339.9527683612881, 227.78009699966796, 554.3734889857135, 62.76786225522631, 176.93149004466767, 272.7494356508931, 603.8180876663998, 340.79043106213857, 401.8901630789638, 351.0286459959571, 438.5288569047774, 368.5873779169073, 305.51170677306476, 268.33830086589205, 299.3629254408393, 358.52708493185327, 396.9924465459516, 425.7395646369036]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.657196931806076, "mean_inference_ms": 83.53048966028348, "mean_action_processing_ms": 3.7075980262460604, "mean_env_wait_ms": 5.71543868311128, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007314920425415039, "StateBufferConnector_ms": 0.004084348678588867, "ViewRequirementAgentConnector_ms": 0.11876964569091797}, "num_episodes": 18, "episode_return_max": 536.1976661363864, "episode_return_min": -122.0584370755235, "episode_return_mean": 110.07977442716695, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1120000, "num_agent_steps_trained": 1120000, "num_env_steps_sampled": 280000, "num_env_steps_trained": 280000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 0.7540661152244806, "num_env_steps_trained_throughput_per_sec": 0.7540661152244806, "timesteps_total": 280000, "num_env_steps_sampled_lifetime": 280000, "num_agent_steps_sampled_lifetime": 1120000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1120000, "timers": {"training_iteration_time_ms": 5362819.802, "restore_workers_time_ms": 0.014, "training_step_time_ms": 5362819.74, "sample_time_ms": 191243.477, "learn_time_ms": 5171553.549, "learn_throughput": 0.773, "synch_weights_time_ms": 16.761}, "counters": {"num_env_steps_sampled": 280000, "num_env_steps_trained": 280000, "num_agent_steps_sampled": 1120000, "num_agent_steps_trained": 1120000}, "done": false, "training_iteration": 70, "trial_id": "b941d_00000", "date": "2024-08-19_05-53-36", "timestamp": 1724027016, "time_this_iter_s": 5304.621539115906, "time_total_s": 165579.1635942459, "pid": 81115, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[32, [4, 4], 2], [64, [3, 3], 2], [128, [3, 3], 1]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [256, 256], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b03019d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 165579.1635942459, "iterations_since_restore": 70, "perf": {"cpu_util_percent": 28.015897435897436, "ram_util_percent": 78.69897435897437}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 15.045732484040437, "cur_kl_coeff": 1.5187500000000005, "cur_lr": 0.00010000000000000003, "total_loss": 8.081083536652661, "policy_loss": -0.08742405507373549, "vf_loss": 8.146218759546835, "vf_explained_var": 0.16059178533377472, "kl": 0.014675765421491984, "entropy": 0.9136470724665929, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 133245.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.309473442905164, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.00010000000000000003, "total_loss": 9.410586807715198, "policy_loss": -0.08442555612036909, "vf_loss": 9.477226558059611, "vf_explained_var": -0.40952870946712594, "kl": 0.01756623424921772, "entropy": 0.7394875280125431, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 133245.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 284000, "num_env_steps_trained": 284000, "num_agent_steps_sampled": 1136000, "num_agent_steps_trained": 1136000}, "env_runners": {"episode_reward_max": 536.1976661363864, "episode_reward_min": -122.0584370755235, "episode_reward_mean": 106.57424637275595, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -717.0519635237858, "predator_policy": 1.2150383458116676}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 717.0519635237858}, "policy_reward_mean": {"prey_policy": -341.77661142083423, "predator_policy": 395.0637346072121}, "custom_metrics": {}, "hist_stats": {"episode_reward": [319.5602511701773, 154.60918639372957, 0.03999999999999915, 8.705939603528115, 59.75699413453019, 239.04166962867177, 12.434580854244626, 152.32476040561644, 32.25000000000003, 237.10628642421426, 0.48267860720124034, 255.71008962346792, 374.47609323323604, -31.256723487425777, 0.08000000000000052, 8.784973760550338, 185.3820568017247, 78.61868807171452, -2.6481842603380263, 95.38914371592688, 105.19956341353699, 536.1976661363864, 2.6432409728003714, 8.136953637854374, 274.80657776754015, 298.8305421895684, 223.4, 225.37625287571547, -10.963704328201, 155.4226003481578, 252.17000000000002, 2.3867193701826723, -62.953807151046426, 156.40512653550886, 82.43494495813076, -122.0584370755235, 202.52067743186933, 75.26, 375.8405459576639, 1.7807546251401494, 6.538355127790376, 355.01937337970526, 319.3257903225474, 35.969177923323215, -38.946762628060426, 0.25000000000000067, 326.7002354497731, 86.74371370838573, -0.05881836374428029, 17.955542337557535, 197.04999999999998, 2.1399999999999966, 143.28244908579754, 143.89521746599323, 1.8172663117963814, 241.99612191417145, 310.68909197613743, 54.57850682579383, 66.04378358937453, 7.265139249489369, 135.3167931501045, 6.060000000000002, 103.26749526659205, 144.19284341249647, 0.03999999999999071, 0.0699999999999994, 411.30170539122776, 1.0399999999999938, 109.32580795399033, 10.423015393791333, 72.42368669599765, 5.071615805358192, -7.771561172376096e-15, 279.7868225712558, 229.95912981402586, 214.33693939639244, 0.19000000000000017, 196.49183180133807, 9.060000000000002, 110.33686816788683, 193.91816816176717, -1.2695599681768215, 5.439457235576455, 246.09852139380638, 98.07163887918357, 114.50788856917768, 0.3399999999999985, -10.016021257674904, 11.420000000000002, 29.04885829800393, 131.89933796023308, 13.391472234433248, 59.8669581174325, 4.03999999999999, 212.54741533884362, 0.15999999999999548, 217.96245011508742, 10.145097004559856, -1.4493447918483326, 40.668859142845974], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [200.0, -377.22848736903063, 34.96394411559112, -557.3422143846592, -573.2331823236538, -328.04070201841336, -299.9779345336709, -580.3373259394918, -445.63971308526754, -271.01603020455616, -78.95616524018108, -500.5560869934931, -538.8771900737511, -351.8493636144383, -547.0660719010174, -422.2327346086782, -697.6905255941384, -209.64565943093586, -336.0740022924167, 52.77162667731818, -507.37644295286975, -555.0075403674645, -68.21206221135165, -585.5937966280742, 78.44791706245103, -469.50525773854696, -303.5280583181806, -429.1195228732485, -408.39106432429656, -562.7144792699378, -292.8603672360543, -381.801447865462, -234.41339503643064, -451.5624812590103, -224.30514254979153, -478.71992483264205, -377.6992009497718, -488.1399561701095, -415.5818514854223, -63.42624045188768, -270.8798403180144, -310.64170482274085, 150.2093704253579, -676.4389097097725, -561.621074814479, -564.882557594154, -483.5130373885757, -411.6245273678789, 38.86449998692865, -511.43772368831094, -402.30682395606044, 32.41333507215003, -18.46268110110968, -35.69819240102035, -31.920491383503382, -660.8306176726242, -517.3969660959003, -498.91405023181954, 1.144786017247915, -530.203242455854, -70.11109797994357, 11.829324025494572, -545.689782790991, -302.3872408738908, -405.03586414424717, -482.5300058320043, -457.6287296205352, -325.96824405866585, -436.69089026755034, -338.2964769936986, -498.1087515030724, -402.29591825623305, 43.09428456047992, -428.3880382250823, -170.0845102921664, -345.818746765605, -460.2804310240232, 155.44348706012738, -439.89393511721244, -356.7358095293992, -656.3275545923509, -430.7950147348081, -447.5227267659528, 200.0, 81.98221697371257, -387.061724789245, -520.423508193039, -516.6781467161265, -455.78503113950296, -460.89207364198273, -469.9153974733243, -547.3171754117966, 78.57811946835666, -496.8461120828876, -517.9709758181084, -245.46172346346066, -334.46818592270347, -410.929973827975, -447.77632521797847, -424.5766530358673, 194.81496165418832, -453.20560197341075, -434.90442093294064, -552.465328780927, -387.3300385515309, -361.30375547997625, -165.4312416973148, -429.05182250707827, -400.46516306613864, -465.4753784378581, -98.52369021605438, -595.6087660538224, -595.2614738327437, 94.65506687423222, -678.0429161078383, -408.10912713688975, -501.2847439566435, -261.8926281625683, -427.38444855587585, -499.9347323078799, 92.22334987434445, -342.04495582734484, -485.29953591154833, -414.3012938338869, -298.02915276929707, -101.46271133346369, -403.11660741120255, -264.1020834607156, -386.29391748442885, -663.7274670218172, -636.9861177913484, -365.15962020982124, 162.38451658447258, -483.8393283714162, -517.3526771287474, -538.3114373279353, -231.8306573081481, -250.53771576461116, -299.71105498917433, -463.25258597945503, -419.99510323352746, -387.8144141368399, -367.45638332794414, -506.4950567474856, -512.0049778454594, -717.0519635237858, -393.2199323754261, 105.27388958572607, -561.4392151559027, 174.25699372898904, -320.67166136421895, 85.32767506505053, -603.7380876663999, -340.68043106213867, -429.2944094312806, -127.13256784230197, -438.5088569047774, -359.54737791690735, -110.7758882577757, -352.7372512132938, -125.86864945399634, -338.10319275692933, -501.8223384250351, -322.1792327259976, -347.91044469530357, -328.84876685109435, 62.859996825222154, -381.7363219099609, -315.13423634740707, -420.74657417521865, 42.665459414647714, -402.52337185498624, -265.2931202061446, -477.8078498094917, -457.8010913325664, -425.956240307998, -319.57437984424917, -357.21875721606983, -456.2134476609162, -271.4442972498668, -476.6917451151338, 2.0000000000000013, -452.50501814815027, -486.5588184072351, -465.43410872149974, -191.12298821982813, -543.5421245083294, -454.4263568932068, -37.66520016932188, -467.95965660962025, -503.8774710867398, -388.82671862808905, -415.5681113366909, -94.7346864805809, -511.412567773124, -361.2406379346399, -478.7429235562676, -365.14773237180987, -207.06023757962518, -166.0430739368951], "policy_predator_policy_reward": [280.11764978107357, 216.67108875813432, 152.36103969309193, 524.6264169697055, 573.2331823236538, 328.0807020184133, 334.280019993953, 554.741180082738, 430.12735696429854, 346.2853804600543, 377.720425275736, 440.83349658661035, 547.8759068776358, 355.2852276647983, 516.0163211313467, 605.607245783965, 697.6905255941384, 241.89565943093572, 298.9259206198469, 221.48274141946578, 507.799121560071, 555.0675403674645, 428.89887098544204, 480.61707747745095, 337.9647998020114, 427.5686341073202, 308.27539323786743, 393.11546446613573, 408.4610643242965, 562.7244792699378, 301.49534099660366, 381.9514478654619, 453.4770221201525, 417.88091097701266, 331.4358763318639, 450.20787912228406, 307.63801556118176, 555.5529572983614, 398.76646293540756, 175.6307727178289, 359.87317694082907, 326.8479316134629, 439.86044581767555, 622.5667596031253, 578.6047752116718, 550.5420981697619, 483.5130373885757, 419.76148100573323, 383.3133317047148, 364.0664697642078, 369.8088553069074, 298.9151757665714, 114.77268110110968, 162.78819240102032, 434.385202238431, 483.7421596934109, 432.49766641578276, 572.8496455837366, 423.0067924283312, 261.4742643584326, 178.2010979799435, 132.25067597450536, 545.699782790991, 304.7639602440733, 397.8236979496995, 426.7883648755055, 519.7918225529419, 420.210277661768, 450.1589908589746, 407.2633213604048, 529.6220454500436, 248.72418723373755, 178.0434318558705, 409.77099924060116, 245.1945102921663, 345.968746765605, 330.42155038411886, 350.2559395374408, 433.4236144726245, 364.98688479912676, 655.4617665284759, 438.1991579264734, 230.83988426013775, 371.70221588552045, 256.817143594134, 367.58815454394573, 472.2844067412536, 600.7864260912354, 389.2447846435244, 488.4855575099013, 469.9953974733242, 547.4871754117966, 338.0287502894459, 406.9394777748584, 477.02976633611604, 373.14664665383856, 335.61722352057006, 409.7221178663641, 413.3357197052093, 476.97280088619345, 1.2150383458116676, 454.22560197341073, 436.98442093294057, 552.5253287809271, 462.3011187508688, 429.6151243664361, 325.62591179301813, 412.75236987736804, 402.2524293779351, 465.5053784378581, 463.281827233509, 472.84675095053916, 509.8269689423798, 301.4685299922689, 490.9791619024315, 649.7513881680908, 467.548843048147, 361.6723126604388, 434.6095878053649, 499.9747323078799, 42.86344327575996, 342.2749558273445, 491.3295359115483, 414.3312938338869, 412.27602787143877, 90.48333149791391, 324.7216475339954, 486.68988675041885, 386.33391748442887, 663.7274670218172, 636.9861177913484, 365.2296202098212, 372.18854314528204, 360.5679740328893, 518.3526771287474, 538.3514373279353, 268.5683116969522, 323.1258693297972, 447.3681002566076, 326.0185561058126, 351.012022041482, 529.2211820248826, 367.55638332794416, 511.46667255284376, 512.0049778454594, 717.0519635237858, 339.9527683612881, 227.78009699966796, 554.3734889857135, 62.76786225522631, 176.93149004466767, 272.7494356508931, 603.8180876663998, 340.79043106213857, 401.8901630789638, 351.0286459959571, 438.5288569047774, 368.5873779169073, 305.51170677306476, 268.33830086589205, 299.3629254408393, 358.52708493185327, 396.9924465459516, 425.7395646369036, 326.9617214605302, 355.2369473214436, 250.297393787462, 314.6774526910834, 349.2668672476321, 484.68558215417676, 64.46304717486389, 409.90275383465223, 265.5631202061444, 477.87784980949164, 453.5027430800102, 420.2385673028798, 353.384082642279, 334.8290544180396, 450.31533182480206, 306.39127138398453, 412.8744061258451, 193.71667694952106, 455.597798569941, 496.85751021987716, 454.2468442726173, 262.1772107861422, 543.5621245083294, 458.44635689320677, 284.7022958466058, 433.46997627118026, 503.9274710867398, 388.93671862808895, 395.6060121075953, 332.6592358247631, 486.0223426786888, 396.77596003363436, 477.6002454310859, 364.8410657051431, 85.65763007301172, 328.1145405863543]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.203255736464509, "mean_inference_ms": 87.77046472880141, "mean_action_processing_ms": 3.6622050535850064, "mean_env_wait_ms": 5.643564919148449, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00800478458404541, "StateBufferConnector_ms": 0.0037403106689453125, "ViewRequirementAgentConnector_ms": 0.1177283525466919}, "num_episodes": 18, "episode_return_max": 536.1976661363864, "episode_return_min": -122.0584370755235, "episode_return_mean": 106.57424637275595, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1136000, "num_agent_steps_trained": 1136000, "num_env_steps_sampled": 284000, "num_env_steps_trained": 284000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 10.973355718708234, "num_env_steps_trained_throughput_per_sec": 10.973355718708234, "timesteps_total": 284000, "num_env_steps_sampled_lifetime": 284000, "num_agent_steps_sampled_lifetime": 1136000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1136000, "timers": {"training_iteration_time_ms": 4936209.495, "restore_workers_time_ms": 0.015, "training_step_time_ms": 4936209.426, "sample_time_ms": 191250.035, "learn_time_ms": 4744936.828, "learn_throughput": 0.843, "synch_weights_time_ms": 16.31}, "counters": {"num_env_steps_sampled": 284000, "num_env_steps_trained": 284000, "num_agent_steps_sampled": 1136000, "num_agent_steps_trained": 1136000}, "done": false, "training_iteration": 71, "trial_id": "b941d_00000", "date": "2024-08-19_05-59-40", "timestamp": 1724027380, "time_this_iter_s": 364.57984709739685, "time_total_s": 165943.7434413433, "pid": 81115, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[32, [4, 4], 2], [64, [3, 3], 2], [128, [3, 3], 1]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [256, 256], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b0403040>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 165943.7434413433, "iterations_since_restore": 71, "perf": {"cpu_util_percent": 20.954010695187165, "ram_util_percent": 78.84759358288771}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 11.031462165098342, "cur_kl_coeff": 1.5187500000000005, "cur_lr": 0.00010000000000000003, "total_loss": 8.089593922902667, "policy_loss": -0.08664300407889107, "vf_loss": 8.154310125522512, "vf_explained_var": 0.26438923935410835, "kl": 0.014437393069097654, "entropy": 0.8998661391318791, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 135135.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 17.86769844678344, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.00010000000000000003, "total_loss": 9.207157789462459, "policy_loss": -0.09493534431001911, "vf_loss": 9.283844649602496, "vf_explained_var": -0.8468995620964697, "kl": 0.018023181327735536, "entropy": 0.8047157877967471, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 135135.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_agent_steps_sampled": 1152000, "num_agent_steps_trained": 1152000}, "env_runners": {"episode_reward_max": 411.30170539122776, "episode_reward_min": -123.02807370861163, "episode_reward_mean": 104.44770218030337, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -717.0519635237858, "predator_policy": 1.2150383458116676}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 717.0519635237858}, "policy_reward_mean": {"prey_policy": -332.9619888952695, "predator_policy": 385.18583998542107}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2.6432409728003714, 8.136953637854374, 274.80657776754015, 298.8305421895684, 223.4, 225.37625287571547, -10.963704328201, 155.4226003481578, 252.17000000000002, 2.3867193701826723, -62.953807151046426, 156.40512653550886, 82.43494495813076, -122.0584370755235, 202.52067743186933, 75.26, 375.8405459576639, 1.7807546251401494, 6.538355127790376, 355.01937337970526, 319.3257903225474, 35.969177923323215, -38.946762628060426, 0.25000000000000067, 326.7002354497731, 86.74371370838573, -0.05881836374428029, 17.955542337557535, 197.04999999999998, 2.1399999999999966, 143.28244908579754, 143.89521746599323, 1.8172663117963814, 241.99612191417145, 310.68909197613743, 54.57850682579383, 66.04378358937453, 7.265139249489369, 135.3167931501045, 6.060000000000002, 103.26749526659205, 144.19284341249647, 0.03999999999999071, 0.0699999999999994, 411.30170539122776, 1.0399999999999938, 109.32580795399033, 10.423015393791333, 72.42368669599765, 5.071615805358192, -7.771561172376096e-15, 279.7868225712558, 229.95912981402586, 214.33693939639244, 0.19000000000000017, 196.49183180133807, 9.060000000000002, 110.33686816788683, 193.91816816176717, -1.2695599681768215, 5.439457235576455, 246.09852139380638, 98.07163887918357, 114.50788856917768, 0.3399999999999985, -10.016021257674904, 11.420000000000002, 29.04885829800393, 131.89933796023308, 13.391472234433248, 59.8669581174325, 4.03999999999999, 212.54741533884362, 0.15999999999999548, 217.96245011508742, 10.145097004559856, -1.4493447918483326, 40.668859142845974, 95.63132606041862, 250.66905178006203, 0.6723540387007058, 327.955519577549, 140.65136329119017, 294.6058754770845, 119.80118922565863, 80.29271933227757, 27.62220117533295, 30.42961044849016, -12.604536418602722, 75.98514310438382, 181.09892795561427, 58.38348910206102, 25.953268571759992, 159.40556851129088, 353.71046622479344, -123.02807370861163, 124.25810326472987, 396.36821341070856, 18.163825053128463, -16.434310492585016], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-561.621074814479, -564.882557594154, -483.5130373885757, -411.6245273678789, 38.86449998692865, -511.43772368831094, -402.30682395606044, 32.41333507215003, -18.46268110110968, -35.69819240102035, -31.920491383503382, -660.8306176726242, -517.3969660959003, -498.91405023181954, 1.144786017247915, -530.203242455854, -70.11109797994357, 11.829324025494572, -545.689782790991, -302.3872408738908, -405.03586414424717, -482.5300058320043, -457.6287296205352, -325.96824405866585, -436.69089026755034, -338.2964769936986, -498.1087515030724, -402.29591825623305, 43.09428456047992, -428.3880382250823, -170.0845102921664, -345.818746765605, -460.2804310240232, 155.44348706012738, -439.89393511721244, -356.7358095293992, -656.3275545923509, -430.7950147348081, -447.5227267659528, 200.0, 81.98221697371257, -387.061724789245, -520.423508193039, -516.6781467161265, -455.78503113950296, -460.89207364198273, -469.9153974733243, -547.3171754117966, 78.57811946835666, -496.8461120828876, -517.9709758181084, -245.46172346346066, -334.46818592270347, -410.929973827975, -447.77632521797847, -424.5766530358673, 194.81496165418832, -453.20560197341075, -434.90442093294064, -552.465328780927, -387.3300385515309, -361.30375547997625, -165.4312416973148, -429.05182250707827, -400.46516306613864, -465.4753784378581, -98.52369021605438, -595.6087660538224, -595.2614738327437, 94.65506687423222, -678.0429161078383, -408.10912713688975, -501.2847439566435, -261.8926281625683, -427.38444855587585, -499.9347323078799, 92.22334987434445, -342.04495582734484, -485.29953591154833, -414.3012938338869, -298.02915276929707, -101.46271133346369, -403.11660741120255, -264.1020834607156, -386.29391748442885, -663.7274670218172, -636.9861177913484, -365.15962020982124, 162.38451658447258, -483.8393283714162, -517.3526771287474, -538.3114373279353, -231.8306573081481, -250.53771576461116, -299.71105498917433, -463.25258597945503, -419.99510323352746, -387.8144141368399, -367.45638332794414, -506.4950567474856, -512.0049778454594, -717.0519635237858, -393.2199323754261, 105.27388958572607, -561.4392151559027, 174.25699372898904, -320.67166136421895, 85.32767506505053, -603.7380876663999, -340.68043106213867, -429.2944094312806, -127.13256784230197, -438.5088569047774, -359.54737791690735, -110.7758882577757, -352.7372512132938, -125.86864945399634, -338.10319275692933, -501.8223384250351, -322.1792327259976, -347.91044469530357, -328.84876685109435, 62.859996825222154, -381.7363219099609, -315.13423634740707, -420.74657417521865, 42.665459414647714, -402.52337185498624, -265.2931202061446, -477.8078498094917, -457.8010913325664, -425.956240307998, -319.57437984424917, -357.21875721606983, -456.2134476609162, -271.4442972498668, -476.6917451151338, 2.0000000000000013, -452.50501814815027, -486.5588184072351, -465.43410872149974, -191.12298821982813, -543.5421245083294, -454.4263568932068, -37.66520016932188, -467.95965660962025, -503.8774710867398, -388.82671862808905, -415.5681113366909, -94.7346864805809, -511.412567773124, -361.2406379346399, -478.7429235562676, -365.14773237180987, -207.06023757962518, -166.0430739368951, -258.5109199471021, -386.2922230246561, -178.5855002556792, -351.9321706181992, -482.777002461139, -474.3820685924896, -439.6785518227203, 99.43477903208027, -323.0629758915087, -117.09799488131468, -415.78131948071564, 173.09926665190233, -108.75018370046038, -350.60165650055313, -315.2595997665333, -317.85752458606055, -312.45751538119396, -390.0660652540089, -682.3373417928718, -1.3265452907274824, -238.97913664705223, -300.4440088437545, -143.05950166883383, -453.58409682473444, -16.979956253863705, -511.21541125847654, -358.72502807185015, -343.7370545345021, -363.51710105473063, -422.50504698356855, -489.7330714092023, -0.31029010485960384, 87.87306567332871, -373.2135327833064, -530.6751828019384, -613.816685517016, -148.54878042989105, -529.0613159738049, 192.34424516319208, -413.1188992712646, -488.01753895749283, -393.44483949499835, -522.790193618772, -382.8822383538628], "policy_predator_policy_reward": [578.6047752116718, 550.5420981697619, 483.5130373885757, 419.76148100573323, 383.3133317047148, 364.0664697642078, 369.8088553069074, 298.9151757665714, 114.77268110110968, 162.78819240102032, 434.385202238431, 483.7421596934109, 432.49766641578276, 572.8496455837366, 423.0067924283312, 261.4742643584326, 178.2010979799435, 132.25067597450536, 545.699782790991, 304.7639602440733, 397.8236979496995, 426.7883648755055, 519.7918225529419, 420.210277661768, 450.1589908589746, 407.2633213604048, 529.6220454500436, 248.72418723373755, 178.0434318558705, 409.77099924060116, 245.1945102921663, 345.968746765605, 330.42155038411886, 350.2559395374408, 433.4236144726245, 364.98688479912676, 655.4617665284759, 438.1991579264734, 230.83988426013775, 371.70221588552045, 256.817143594134, 367.58815454394573, 472.2844067412536, 600.7864260912354, 389.2447846435244, 488.4855575099013, 469.9953974733242, 547.4871754117966, 338.0287502894459, 406.9394777748584, 477.02976633611604, 373.14664665383856, 335.61722352057006, 409.7221178663641, 413.3357197052093, 476.97280088619345, 1.2150383458116676, 454.22560197341073, 436.98442093294057, 552.5253287809271, 462.3011187508688, 429.6151243664361, 325.62591179301813, 412.75236987736804, 402.2524293779351, 465.5053784378581, 463.281827233509, 472.84675095053916, 509.8269689423798, 301.4685299922689, 490.9791619024315, 649.7513881680908, 467.548843048147, 361.6723126604388, 434.6095878053649, 499.9747323078799, 42.86344327575996, 342.2749558273445, 491.3295359115483, 414.3312938338869, 412.27602787143877, 90.48333149791391, 324.7216475339954, 486.68988675041885, 386.33391748442887, 663.7274670218172, 636.9861177913484, 365.2296202098212, 372.18854314528204, 360.5679740328893, 518.3526771287474, 538.3514373279353, 268.5683116969522, 323.1258693297972, 447.3681002566076, 326.0185561058126, 351.012022041482, 529.2211820248826, 367.55638332794416, 511.46667255284376, 512.0049778454594, 717.0519635237858, 339.9527683612881, 227.78009699966796, 554.3734889857135, 62.76786225522631, 176.93149004466767, 272.7494356508931, 603.8180876663998, 340.79043106213857, 401.8901630789638, 351.0286459959571, 438.5288569047774, 368.5873779169073, 305.51170677306476, 268.33830086589205, 299.3629254408393, 358.52708493185327, 396.9924465459516, 425.7395646369036, 326.9617214605302, 355.2369473214436, 250.297393787462, 314.6774526910834, 349.2668672476321, 484.68558215417676, 64.46304717486389, 409.90275383465223, 265.5631202061444, 477.87784980949164, 453.5027430800102, 420.2385673028798, 353.384082642279, 334.8290544180396, 450.31533182480206, 306.39127138398453, 412.8744061258451, 193.71667694952106, 455.597798569941, 496.85751021987716, 454.2468442726173, 262.1772107861422, 543.5621245083294, 458.44635689320677, 284.7022958466058, 433.46997627118026, 503.9274710867398, 388.93671862808895, 395.6060121075953, 332.6592358247631, 486.0223426786888, 396.77596003363436, 477.6002454310859, 364.8410657051431, 85.65763007301172, 328.1145405863543, 336.52734962354015, 403.90711940863645, 347.345047733418, 433.841674920522, 469.42740817523685, 488.40401691709224, 399.2928472646869, 268.9064451035021, 324.57806966968076, 256.23426439433285, 187.38398732653962, 349.9039409793589, 273.5389594268959, 305.61406999977567, 371.11680685450824, 342.293036830363, 385.34128021611036, 344.8045015944255, 669.657651642188, 44.4358458899012, 363.89800746696744, 162.92060160523593, 227.77440563290426, 444.85433596504765, 265.0829108542219, 444.2113846137328, 348.9504644477475, 411.8951072606653, 450.1528535570191, 361.82256305304, 489.7530714092023, 159.6958586161504, 213.2376483497584, 425.81328498501296, 407.026733075312, 614.4370615350298, 283.4558957177853, 518.4123039506402, 301.3243065875802, 315.8185609312018, 505.1713688488751, 394.4548346567442, 511.1009782213509, 378.13714325869927]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.7298502187807845, "mean_inference_ms": 92.62931719670716, "mean_action_processing_ms": 3.6180015666128313, "mean_env_wait_ms": 5.538644120883822, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008677840232849121, "StateBufferConnector_ms": 0.003695845603942871, "ViewRequirementAgentConnector_ms": 0.11760950088500977}, "num_episodes": 22, "episode_return_max": 411.30170539122776, "episode_return_min": -123.02807370861163, "episode_return_mean": 104.44770218030337, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1152000, "num_agent_steps_trained": 1152000, "num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 24.318802821435323, "num_env_steps_trained_throughput_per_sec": 24.318802821435323, "timesteps_total": 288000, "num_env_steps_sampled_lifetime": 288000, "num_agent_steps_sampled_lifetime": 1152000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1152000, "timers": {"training_iteration_time_ms": 4317154.293, "restore_workers_time_ms": 0.015, "training_step_time_ms": 4317154.225, "sample_time_ms": 191261.015, "learn_time_ms": 4125870.849, "learn_throughput": 0.969, "synch_weights_time_ms": 16.296}, "counters": {"num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_agent_steps_sampled": 1152000, "num_agent_steps_trained": 1152000}, "done": false, "training_iteration": 72, "trial_id": "b941d_00000", "date": "2024-08-19_06-02-25", "timestamp": 1724027545, "time_this_iter_s": 164.54486298561096, "time_total_s": 166108.28830432892, "pid": 81115, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[32, [4, 4], 2], [64, [3, 3], 2], [128, [3, 3], 1]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [256, 256], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b042dca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 166108.28830432892, "iterations_since_restore": 72, "perf": {"cpu_util_percent": 21.085483870967746, "ram_util_percent": 79.87795698924731}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.141859148923682, "cur_kl_coeff": 1.5187500000000005, "cur_lr": 0.00010000000000000003, "total_loss": 7.995606201161783, "policy_loss": -0.09268258423938677, "vf_loss": 8.065087182433517, "vf_explained_var": 0.38661470772728085, "kl": 0.01527678443754094, "entropy": 0.9864192774371495, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 137025.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 15.177577108176298, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.00010000000000000003, "total_loss": 8.974774697470286, "policy_loss": -0.09472207518999105, "vf_loss": 9.051724037291512, "vf_explained_var": -0.46191497757321315, "kl": 0.017553330362755228, "entropy": 0.7645577776053595, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 137025.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 292000, "num_env_steps_trained": 292000, "num_agent_steps_sampled": 1168000, "num_agent_steps_trained": 1168000}, "env_runners": {"episode_reward_max": 444.0240107737405, "episode_reward_min": -123.02807370861163, "episode_reward_mean": 106.19111662842073, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -717.0519635237858, "predator_policy": 1.2150383458116676}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 717.0519635237858}, "policy_reward_mean": {"prey_policy": -326.55590747700376, "predator_policy": 379.6514657912141}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.25000000000000067, 326.7002354497731, 86.74371370838573, -0.05881836374428029, 17.955542337557535, 197.04999999999998, 2.1399999999999966, 143.28244908579754, 143.89521746599323, 1.8172663117963814, 241.99612191417145, 310.68909197613743, 54.57850682579383, 66.04378358937453, 7.265139249489369, 135.3167931501045, 6.060000000000002, 103.26749526659205, 144.19284341249647, 0.03999999999999071, 0.0699999999999994, 411.30170539122776, 1.0399999999999938, 109.32580795399033, 10.423015393791333, 72.42368669599765, 5.071615805358192, -7.771561172376096e-15, 279.7868225712558, 229.95912981402586, 214.33693939639244, 0.19000000000000017, 196.49183180133807, 9.060000000000002, 110.33686816788683, 193.91816816176717, -1.2695599681768215, 5.439457235576455, 246.09852139380638, 98.07163887918357, 114.50788856917768, 0.3399999999999985, -10.016021257674904, 11.420000000000002, 29.04885829800393, 131.89933796023308, 13.391472234433248, 59.8669581174325, 4.03999999999999, 212.54741533884362, 0.15999999999999548, 217.96245011508742, 10.145097004559856, -1.4493447918483326, 40.668859142845974, 95.63132606041862, 250.66905178006203, 0.6723540387007058, 327.955519577549, 140.65136329119017, 294.6058754770845, 119.80118922565863, 80.29271933227757, 27.62220117533295, 30.42961044849016, -12.604536418602722, 75.98514310438382, 181.09892795561427, 58.38348910206102, 25.953268571759992, 159.40556851129088, 353.71046622479344, -123.02807370861163, 124.25810326472987, 396.36821341070856, 18.163825053128463, -16.434310492585016, 123.8249360074709, 28.06313531537973, 215.69268540029697, 29.6233496530301, 292.97512248638947, 2.3119174652330763, 2.608620408728182, 233.99609169517592, 56.1069722272722, 198.3710691576703, 8.18, 6.116628122882174, 17.79105066946649, 296.1389426619906, 69.98247422672885, 378.65481144685475, -30.90986800336654, 444.0240107737405, 72.35, 228.70747513747722, 111.57000000000009, 17.138475643113082, 190.3684665568715], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-469.9153974733243, -547.3171754117966, 78.57811946835666, -496.8461120828876, -517.9709758181084, -245.46172346346066, -334.46818592270347, -410.929973827975, -447.77632521797847, -424.5766530358673, 194.81496165418832, -453.20560197341075, -434.90442093294064, -552.465328780927, -387.3300385515309, -361.30375547997625, -165.4312416973148, -429.05182250707827, -400.46516306613864, -465.4753784378581, -98.52369021605438, -595.6087660538224, -595.2614738327437, 94.65506687423222, -678.0429161078383, -408.10912713688975, -501.2847439566435, -261.8926281625683, -427.38444855587585, -499.9347323078799, 92.22334987434445, -342.04495582734484, -485.29953591154833, -414.3012938338869, -298.02915276929707, -101.46271133346369, -403.11660741120255, -264.1020834607156, -386.29391748442885, -663.7274670218172, -636.9861177913484, -365.15962020982124, 162.38451658447258, -483.8393283714162, -517.3526771287474, -538.3114373279353, -231.8306573081481, -250.53771576461116, -299.71105498917433, -463.25258597945503, -419.99510323352746, -387.8144141368399, -367.45638332794414, -506.4950567474856, -512.0049778454594, -717.0519635237858, -393.2199323754261, 105.27388958572607, -561.4392151559027, 174.25699372898904, -320.67166136421895, 85.32767506505053, -603.7380876663999, -340.68043106213867, -429.2944094312806, -127.13256784230197, -438.5088569047774, -359.54737791690735, -110.7758882577757, -352.7372512132938, -125.86864945399634, -338.10319275692933, -501.8223384250351, -322.1792327259976, -347.91044469530357, -328.84876685109435, 62.859996825222154, -381.7363219099609, -315.13423634740707, -420.74657417521865, 42.665459414647714, -402.52337185498624, -265.2931202061446, -477.8078498094917, -457.8010913325664, -425.956240307998, -319.57437984424917, -357.21875721606983, -456.2134476609162, -271.4442972498668, -476.6917451151338, 2.0000000000000013, -452.50501814815027, -486.5588184072351, -465.43410872149974, -191.12298821982813, -543.5421245083294, -454.4263568932068, -37.66520016932188, -467.95965660962025, -503.8774710867398, -388.82671862808905, -415.5681113366909, -94.7346864805809, -511.412567773124, -361.2406379346399, -478.7429235562676, -365.14773237180987, -207.06023757962518, -166.0430739368951, -258.5109199471021, -386.2922230246561, -178.5855002556792, -351.9321706181992, -482.777002461139, -474.3820685924896, -439.6785518227203, 99.43477903208027, -323.0629758915087, -117.09799488131468, -415.78131948071564, 173.09926665190233, -108.75018370046038, -350.60165650055313, -315.2595997665333, -317.85752458606055, -312.45751538119396, -390.0660652540089, -682.3373417928718, -1.3265452907274824, -238.97913664705223, -300.4440088437545, -143.05950166883383, -453.58409682473444, -16.979956253863705, -511.21541125847654, -358.72502807185015, -343.7370545345021, -363.51710105473063, -422.50504698356855, -489.7330714092023, -0.31029010485960384, 87.87306567332871, -373.2135327833064, -530.6751828019384, -613.816685517016, -148.54878042989105, -529.0613159738049, 192.34424516319208, -413.1188992712646, -488.01753895749283, -393.44483949499835, -522.790193618772, -382.8822383538628, -108.93054588163213, -393.294137556484, -452.58758088799215, -469.3848604714838, -284.4393163681075, -95.86020562169557, -351.1003299042552, -518.8340782793454, -255.2367442447886, 160.79040128930603, -242.19227295219505, -433.49241358203955, -461.25234642470826, -525.5356802185564, -13.602811885490757, -606.042938470736, -308.4162531534511, -341.6839012679298, -437.7566432768115, -88.47489221527579, -388.77968879156316, -375.9290146033666, -211.19557553125674, -345.67858763773637, -464.817987698545, -364.0706426023259, -456.0695962942151, 136.15064906889182, -506.36371807039905, -266.6372749339965, -531.7048027322676, 86.40435144843771, -454.0851967455836, -383.17430385556395, 200.0, -449.6854971520564, -373.2950625296121, -104.36300205066459, -189.85504808800226, -476.00001882766145, 21.090494976527395, -376.7222770260316, -272.5100121802348, -441.7849933352065, -99.69417398137962, -408.1554921018485], "policy_predator_policy_reward": [469.9953974733242, 547.4871754117966, 338.0287502894459, 406.9394777748584, 477.02976633611604, 373.14664665383856, 335.61722352057006, 409.7221178663641, 413.3357197052093, 476.97280088619345, 1.2150383458116676, 454.22560197341073, 436.98442093294057, 552.5253287809271, 462.3011187508688, 429.6151243664361, 325.62591179301813, 412.75236987736804, 402.2524293779351, 465.5053784378581, 463.281827233509, 472.84675095053916, 509.8269689423798, 301.4685299922689, 490.9791619024315, 649.7513881680908, 467.548843048147, 361.6723126604388, 434.6095878053649, 499.9747323078799, 42.86344327575996, 342.2749558273445, 491.3295359115483, 414.3312938338869, 412.27602787143877, 90.48333149791391, 324.7216475339954, 486.68988675041885, 386.33391748442887, 663.7274670218172, 636.9861177913484, 365.2296202098212, 372.18854314528204, 360.5679740328893, 518.3526771287474, 538.3514373279353, 268.5683116969522, 323.1258693297972, 447.3681002566076, 326.0185561058126, 351.012022041482, 529.2211820248826, 367.55638332794416, 511.46667255284376, 512.0049778454594, 717.0519635237858, 339.9527683612881, 227.78009699966796, 554.3734889857135, 62.76786225522631, 176.93149004466767, 272.7494356508931, 603.8180876663998, 340.79043106213857, 401.8901630789638, 351.0286459959571, 438.5288569047774, 368.5873779169073, 305.51170677306476, 268.33830086589205, 299.3629254408393, 358.52708493185327, 396.9924465459516, 425.7395646369036, 326.9617214605302, 355.2369473214436, 250.297393787462, 314.6774526910834, 349.2668672476321, 484.68558215417676, 64.46304717486389, 409.90275383465223, 265.5631202061444, 477.87784980949164, 453.5027430800102, 420.2385673028798, 353.384082642279, 334.8290544180396, 450.31533182480206, 306.39127138398453, 412.8744061258451, 193.71667694952106, 455.597798569941, 496.85751021987716, 454.2468442726173, 262.1772107861422, 543.5621245083294, 458.44635689320677, 284.7022958466058, 433.46997627118026, 503.9274710867398, 388.93671862808895, 395.6060121075953, 332.6592358247631, 486.0223426786888, 396.77596003363436, 477.6002454310859, 364.8410657051431, 85.65763007301172, 328.1145405863543, 336.52734962354015, 403.90711940863645, 347.345047733418, 433.841674920522, 469.42740817523685, 488.40401691709224, 399.2928472646869, 268.9064451035021, 324.57806966968076, 256.23426439433285, 187.38398732653962, 349.9039409793589, 273.5389594268959, 305.61406999977567, 371.11680685450824, 342.293036830363, 385.34128021611036, 344.8045015944255, 669.657651642188, 44.4358458899012, 363.89800746696744, 162.92060160523593, 227.77440563290426, 444.85433596504765, 265.0829108542219, 444.2113846137328, 348.9504644477475, 411.8951072606653, 450.1528535570191, 361.82256305304, 489.7530714092023, 159.6958586161504, 213.2376483497584, 425.81328498501296, 407.026733075312, 614.4370615350298, 283.4558957177853, 518.4123039506402, 301.3243065875802, 315.8185609312018, 505.1713688488751, 394.4548346567442, 511.1009782213509, 378.13714325869927, 225.98268145443637, 400.06693799115044, 445.29424047661024, 504.74133619824494, 220.9751199669463, 375.01708742315344, 386.8379000945805, 512.7198577420497, 110.75093735715326, 276.67052808471874, 244.66270171940567, 433.333902280062, 462.4909668334364, 526.9056802185561, 309.1530063957064, 544.4888356556963, 322.40710989200716, 383.8000167566457, 379.68437036225987, 344.91823428749734, 393.8196887915631, 379.0690146033666, 213.93557553125666, 349.0552157606185, 486.71311227317335, 359.9665686971641, 403.6621816119223, 212.3957082753916, 440.99117861891307, 401.9922886122109, 491.2961786536126, 332.6590840770721, 373.5292661621141, 432.8203664356668, 374.9413422678248, 318.7681656579726, 211.17567110040818, 338.8323934798683, 428.10381416159237, 466.45872789154845, 90.20950502347276, 376.99227702603133, 306.6714207777034, 424.7620603808508, 340.78300893093984, 357.4351237091607]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.09261273993206, "mean_inference_ms": 90.76007732066223, "mean_action_processing_ms": 3.8675088818890035, "mean_env_wait_ms": 5.47078460785405, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008649945259094238, "StateBufferConnector_ms": 0.0035750865936279297, "ViewRequirementAgentConnector_ms": 0.11007535457611084}, "num_episodes": 23, "episode_return_max": 444.0240107737405, "episode_return_min": -123.02807370861163, "episode_return_mean": 106.19111662842073, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1168000, "num_agent_steps_trained": 1168000, "num_env_steps_sampled": 292000, "num_env_steps_trained": 292000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 27.889668826689856, "num_env_steps_trained_throughput_per_sec": 27.889668826689856, "timesteps_total": 292000, "num_env_steps_sampled_lifetime": 292000, "num_agent_steps_sampled_lifetime": 1168000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1168000, "timers": {"training_iteration_time_ms": 3597843.925, "restore_workers_time_ms": 0.014, "training_step_time_ms": 3597843.858, "sample_time_ms": 191255.935, "learn_time_ms": 3406566.067, "learn_throughput": 1.174, "synch_weights_time_ms": 16.174}, "counters": {"num_env_steps_sampled": 292000, "num_env_steps_trained": 292000, "num_agent_steps_sampled": 1168000, "num_agent_steps_trained": 1168000}, "done": false, "training_iteration": 73, "trial_id": "b941d_00000", "date": "2024-08-19_06-04-48", "timestamp": 1724027688, "time_this_iter_s": 143.4672818183899, "time_total_s": 166251.7555861473, "pid": 81115, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[32, [4, 4], 2], [64, [3, 3], 2], [128, [3, 3], 1]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [256, 256], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b29cae50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 166251.7555861473, "iterations_since_restore": 73, "perf": {"cpu_util_percent": 19.884408602150536, "ram_util_percent": 80.09677419354838}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 12.200310739764461, "cur_kl_coeff": 1.5187500000000005, "cur_lr": 0.00010000000000000003, "total_loss": 8.531051828747703, "policy_loss": -0.09161214892402607, "vf_loss": 8.599713640868979, "vf_explained_var": 0.2681514221209067, "kl": 0.015111335885735792, "entropy": 0.9803560005924689, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 138915.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 15.098343947703246, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.00010000000000000003, "total_loss": 8.859588615478032, "policy_loss": -0.08438080460136195, "vf_loss": 8.926722930726552, "vf_explained_var": -0.42238894820844053, "kl": 0.01703359701484548, "entropy": 0.7443119022265944, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 138915.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 296000, "num_env_steps_trained": 296000, "num_agent_steps_sampled": 1184000, "num_agent_steps_trained": 1184000}, "env_runners": {"episode_reward_max": 444.0240107737405, "episode_reward_min": -123.02807370861163, "episode_reward_mean": 105.93091731322413, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -717.0519635237858, "predator_policy": 44.4358458899012}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 717.0519635237858}, "policy_reward_mean": {"prey_policy": -322.33998649463047, "predator_policy": 375.30544515124245}, "custom_metrics": {}, "hist_stats": {"episode_reward": [144.19284341249647, 0.03999999999999071, 0.0699999999999994, 411.30170539122776, 1.0399999999999938, 109.32580795399033, 10.423015393791333, 72.42368669599765, 5.071615805358192, -7.771561172376096e-15, 279.7868225712558, 229.95912981402586, 214.33693939639244, 0.19000000000000017, 196.49183180133807, 9.060000000000002, 110.33686816788683, 193.91816816176717, -1.2695599681768215, 5.439457235576455, 246.09852139380638, 98.07163887918357, 114.50788856917768, 0.3399999999999985, -10.016021257674904, 11.420000000000002, 29.04885829800393, 131.89933796023308, 13.391472234433248, 59.8669581174325, 4.03999999999999, 212.54741533884362, 0.15999999999999548, 217.96245011508742, 10.145097004559856, -1.4493447918483326, 40.668859142845974, 95.63132606041862, 250.66905178006203, 0.6723540387007058, 327.955519577549, 140.65136329119017, 294.6058754770845, 119.80118922565863, 80.29271933227757, 27.62220117533295, 30.42961044849016, -12.604536418602722, 75.98514310438382, 181.09892795561427, 58.38348910206102, 25.953268571759992, 159.40556851129088, 353.71046622479344, -123.02807370861163, 124.25810326472987, 396.36821341070856, 18.163825053128463, -16.434310492585016, 123.8249360074709, 28.06313531537973, 215.69268540029697, 29.6233496530301, 292.97512248638947, 2.3119174652330763, 2.608620408728182, 233.99609169517592, 56.1069722272722, 198.3710691576703, 8.18, 6.116628122882174, 17.79105066946649, 296.1389426619906, 69.98247422672885, 378.65481144685475, -30.90986800336654, 444.0240107737405, 72.35, 228.70747513747722, 111.57000000000009, 17.138475643113082, 190.3684665568715, 246.31293073895665, 242.70367838655397, -0.2898523077801656, 203.09054105003872, 32.79970259377303, 9.279658850475142, 184.85794395070778, 225.67691988807894, 14.921002501718252, 79.90760422831245, 0.17999999999999328, 266.36146727919447, 73.27000000000001, 207.8857507852685, -51.92822249947762, 0.2999999999999945, 27.333481001741124, 56.31], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-403.11660741120255, -264.1020834607156, -386.29391748442885, -663.7274670218172, -636.9861177913484, -365.15962020982124, 162.38451658447258, -483.8393283714162, -517.3526771287474, -538.3114373279353, -231.8306573081481, -250.53771576461116, -299.71105498917433, -463.25258597945503, -419.99510323352746, -387.8144141368399, -367.45638332794414, -506.4950567474856, -512.0049778454594, -717.0519635237858, -393.2199323754261, 105.27388958572607, -561.4392151559027, 174.25699372898904, -320.67166136421895, 85.32767506505053, -603.7380876663999, -340.68043106213867, -429.2944094312806, -127.13256784230197, -438.5088569047774, -359.54737791690735, -110.7758882577757, -352.7372512132938, -125.86864945399634, -338.10319275692933, -501.8223384250351, -322.1792327259976, -347.91044469530357, -328.84876685109435, 62.859996825222154, -381.7363219099609, -315.13423634740707, -420.74657417521865, 42.665459414647714, -402.52337185498624, -265.2931202061446, -477.8078498094917, -457.8010913325664, -425.956240307998, -319.57437984424917, -357.21875721606983, -456.2134476609162, -271.4442972498668, -476.6917451151338, 2.0000000000000013, -452.50501814815027, -486.5588184072351, -465.43410872149974, -191.12298821982813, -543.5421245083294, -454.4263568932068, -37.66520016932188, -467.95965660962025, -503.8774710867398, -388.82671862808905, -415.5681113366909, -94.7346864805809, -511.412567773124, -361.2406379346399, -478.7429235562676, -365.14773237180987, -207.06023757962518, -166.0430739368951, -258.5109199471021, -386.2922230246561, -178.5855002556792, -351.9321706181992, -482.777002461139, -474.3820685924896, -439.6785518227203, 99.43477903208027, -323.0629758915087, -117.09799488131468, -415.78131948071564, 173.09926665190233, -108.75018370046038, -350.60165650055313, -315.2595997665333, -317.85752458606055, -312.45751538119396, -390.0660652540089, -682.3373417928718, -1.3265452907274824, -238.97913664705223, -300.4440088437545, -143.05950166883383, -453.58409682473444, -16.979956253863705, -511.21541125847654, -358.72502807185015, -343.7370545345021, -363.51710105473063, -422.50504698356855, -489.7330714092023, -0.31029010485960384, 87.87306567332871, -373.2135327833064, -530.6751828019384, -613.816685517016, -148.54878042989105, -529.0613159738049, 192.34424516319208, -413.1188992712646, -488.01753895749283, -393.44483949499835, -522.790193618772, -382.8822383538628, -108.93054588163213, -393.294137556484, -452.58758088799215, -469.3848604714838, -284.4393163681075, -95.86020562169557, -351.1003299042552, -518.8340782793454, -255.2367442447886, 160.79040128930603, -242.19227295219505, -433.49241358203955, -461.25234642470826, -525.5356802185564, -13.602811885490757, -606.042938470736, -308.4162531534511, -341.6839012679298, -437.7566432768115, -88.47489221527579, -388.77968879156316, -375.9290146033666, -211.19557553125674, -345.67858763773637, -464.817987698545, -364.0706426023259, -456.0695962942151, 136.15064906889182, -506.36371807039905, -266.6372749339965, -531.7048027322676, 86.40435144843771, -454.0851967455836, -383.17430385556395, 200.0, -449.6854971520564, -373.2950625296121, -104.36300205066459, -189.85504808800226, -476.00001882766145, 21.090494976527395, -376.7222770260316, -272.5100121802348, -441.7849933352065, -99.69417398137962, -408.1554921018485, -470.28670738443475, -127.75825761463148, -179.9087521397368, -596.707929882393, -530.3833002141147, -291.14507133239255, -113.09803679500541, -37.19844056923003, -382.0494870044979, -326.4188492365863, -466.58844257521264, -323.95907154134, -438.89277021539993, -103.98575350589726, -263.4097645941741, -432.68955046946087, -340.8512717918365, -511.23224304793234, -198.4353219136355, -482.27345649932386, -453.0948795884341, -457.69492502596256, -253.86706233686832, -97.41563497893065, -134.3647962442889, -592.2489423568863, -184.48821746745182, -19.538614050816193, -517.9641662241124, -472.37167278596814, -425.59972790858234, -264.81462299535025, -361.69563538798616, -414.0821724589961, -113.02541838576687, -569.0807888177196], "policy_predator_policy_reward": [324.7216475339954, 486.68988675041885, 386.33391748442887, 663.7274670218172, 636.9861177913484, 365.2296202098212, 372.18854314528204, 360.5679740328893, 518.3526771287474, 538.3514373279353, 268.5683116969522, 323.1258693297972, 447.3681002566076, 326.0185561058126, 351.012022041482, 529.2211820248826, 367.55638332794416, 511.46667255284376, 512.0049778454594, 717.0519635237858, 339.9527683612881, 227.78009699966796, 554.3734889857135, 62.76786225522631, 176.93149004466767, 272.7494356508931, 603.8180876663998, 340.79043106213857, 401.8901630789638, 351.0286459959571, 438.5288569047774, 368.5873779169073, 305.51170677306476, 268.33830086589205, 299.3629254408393, 358.52708493185327, 396.9924465459516, 425.7395646369036, 326.9617214605302, 355.2369473214436, 250.297393787462, 314.6774526910834, 349.2668672476321, 484.68558215417676, 64.46304717486389, 409.90275383465223, 265.5631202061444, 477.87784980949164, 453.5027430800102, 420.2385673028798, 353.384082642279, 334.8290544180396, 450.31533182480206, 306.39127138398453, 412.8744061258451, 193.71667694952106, 455.597798569941, 496.85751021987716, 454.2468442726173, 262.1772107861422, 543.5621245083294, 458.44635689320677, 284.7022958466058, 433.46997627118026, 503.9274710867398, 388.93671862808895, 395.6060121075953, 332.6592358247631, 486.0223426786888, 396.77596003363436, 477.6002454310859, 364.8410657051431, 85.65763007301172, 328.1145405863543, 336.52734962354015, 403.90711940863645, 347.345047733418, 433.841674920522, 469.42740817523685, 488.40401691709224, 399.2928472646869, 268.9064451035021, 324.57806966968076, 256.23426439433285, 187.38398732653962, 349.9039409793589, 273.5389594268959, 305.61406999977567, 371.11680685450824, 342.293036830363, 385.34128021611036, 344.8045015944255, 669.657651642188, 44.4358458899012, 363.89800746696744, 162.92060160523593, 227.77440563290426, 444.85433596504765, 265.0829108542219, 444.2113846137328, 348.9504644477475, 411.8951072606653, 450.1528535570191, 361.82256305304, 489.7530714092023, 159.6958586161504, 213.2376483497584, 425.81328498501296, 407.026733075312, 614.4370615350298, 283.4558957177853, 518.4123039506402, 301.3243065875802, 315.8185609312018, 505.1713688488751, 394.4548346567442, 511.1009782213509, 378.13714325869927, 225.98268145443637, 400.06693799115044, 445.29424047661024, 504.74133619824494, 220.9751199669463, 375.01708742315344, 386.8379000945805, 512.7198577420497, 110.75093735715326, 276.67052808471874, 244.66270171940567, 433.333902280062, 462.4909668334364, 526.9056802185561, 309.1530063957064, 544.4888356556963, 322.40710989200716, 383.8000167566457, 379.68437036225987, 344.91823428749734, 393.8196887915631, 379.0690146033666, 213.93557553125666, 349.0552157606185, 486.71311227317335, 359.9665686971641, 403.6621816119223, 212.3957082753916, 440.99117861891307, 401.9922886122109, 491.2961786536126, 332.6590840770721, 373.5292661621141, 432.8203664356668, 374.9413422678248, 318.7681656579726, 211.17567110040818, 338.8323934798683, 428.10381416159237, 466.45872789154845, 90.20950502347276, 376.99227702603133, 306.6714207777034, 424.7620603808508, 340.78300893093984, 357.4351237091607, 421.3091819675941, 423.04871377042883, 462.30570801857766, 557.0146523901059, 506.430217611244, 314.8083016274829, 181.93076382459594, 171.45625458967808, 369.6985770967296, 371.56946173812736, 466.58844257521264, 333.23873039181495, 400.9274539662472, 326.80901370575765, 412.6597858731758, 509.1164490785374, 510.1747774115749, 356.8297399299122, 448.1900232503967, 312.4263593908748, 453.12487958843406, 457.8449250259624, 302.7351715315429, 314.9089930634506, 206.6147962442889, 593.2689423568863, 77.45724186490789, 334.45534043862847, 402.87298816323823, 535.5346283473648, 425.60972790858233, 265.1046229953501, 349.99844669279787, 453.1128421559254, 166.2654183857667, 572.1507888177197]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.524077997545178, "mean_inference_ms": 90.42854187828074, "mean_action_processing_ms": 3.515984372873463, "mean_env_wait_ms": 5.403965743595865, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00750124454498291, "StateBufferConnector_ms": 0.0035108327865600586, "ViewRequirementAgentConnector_ms": 0.10501956939697266}, "num_episodes": 18, "episode_return_max": 444.0240107737405, "episode_return_min": -123.02807370861163, "episode_return_mean": 105.93091731322413, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1184000, "num_agent_steps_trained": 1184000, "num_env_steps_sampled": 296000, "num_env_steps_trained": 296000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 24.006489066341896, "num_env_steps_trained_throughput_per_sec": 24.006489066341896, "timesteps_total": 296000, "num_env_steps_sampled_lifetime": 296000, "num_agent_steps_sampled_lifetime": 1184000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1184000, "timers": {"training_iteration_time_ms": 3143384.017, "restore_workers_time_ms": 0.014, "training_step_time_ms": 3143383.949, "sample_time_ms": 191219.228, "learn_time_ms": 2952142.664, "learn_throughput": 1.355, "synch_weights_time_ms": 16.291}, "counters": {"num_env_steps_sampled": 296000, "num_env_steps_trained": 296000, "num_agent_steps_sampled": 1184000, "num_agent_steps_trained": 1184000}, "done": false, "training_iteration": 74, "trial_id": "b941d_00000", "date": "2024-08-19_06-07-35", "timestamp": 1724027855, "time_this_iter_s": 166.67196393013, "time_total_s": 166418.42755007744, "pid": 81115, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[32, [4, 4], 2], [64, [3, 3], 2], [128, [3, 3], 1]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [256, 256], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b042d700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 166418.42755007744, "iterations_since_restore": 74, "perf": {"cpu_util_percent": 19.259893048128344, "ram_util_percent": 79.83475935828876}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.268732900215834, "cur_kl_coeff": 1.5187500000000005, "cur_lr": 0.00010000000000000003, "total_loss": 9.189628591991607, "policy_loss": -0.08498509330305433, "vf_loss": 9.252570262787835, "vf_explained_var": -0.31489407019640403, "kl": 0.01451419850313927, "entropy": 0.9056587259605449, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 140805.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 17.588124725364505, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.00010000000000000003, "total_loss": 9.481990975677652, "policy_loss": -0.09478820096134706, "vf_loss": 9.558795629733455, "vf_explained_var": -0.9781313483677213, "kl": 0.017761490564049107, "entropy": 0.784521225867448, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 140805.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_agent_steps_sampled": 1200000, "num_agent_steps_trained": 1200000}, "env_runners": {"episode_reward_max": 444.0240107737405, "episode_reward_min": -123.02807370861163, "episode_reward_mean": 92.98504527355861, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -682.3373417928718, "predator_policy": 44.4358458899012}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 669.657651642188}, "policy_reward_mean": {"prey_policy": -325.62239987241145, "predator_policy": 372.11492250919065}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.2695599681768215, 5.439457235576455, 246.09852139380638, 98.07163887918357, 114.50788856917768, 0.3399999999999985, -10.016021257674904, 11.420000000000002, 29.04885829800393, 131.89933796023308, 13.391472234433248, 59.8669581174325, 4.03999999999999, 212.54741533884362, 0.15999999999999548, 217.96245011508742, 10.145097004559856, -1.4493447918483326, 40.668859142845974, 95.63132606041862, 250.66905178006203, 0.6723540387007058, 327.955519577549, 140.65136329119017, 294.6058754770845, 119.80118922565863, 80.29271933227757, 27.62220117533295, 30.42961044849016, -12.604536418602722, 75.98514310438382, 181.09892795561427, 58.38348910206102, 25.953268571759992, 159.40556851129088, 353.71046622479344, -123.02807370861163, 124.25810326472987, 396.36821341070856, 18.163825053128463, -16.434310492585016, 123.8249360074709, 28.06313531537973, 215.69268540029697, 29.6233496530301, 292.97512248638947, 2.3119174652330763, 2.608620408728182, 233.99609169517592, 56.1069722272722, 198.3710691576703, 8.18, 6.116628122882174, 17.79105066946649, 296.1389426619906, 69.98247422672885, 378.65481144685475, -30.90986800336654, 444.0240107737405, 72.35, 228.70747513747722, 111.57000000000009, 17.138475643113082, 190.3684665568715, 246.31293073895665, 242.70367838655397, -0.2898523077801656, 203.09054105003872, 32.79970259377303, 9.279658850475142, 184.85794395070778, 225.67691988807894, 14.921002501718252, 79.90760422831245, 0.17999999999999328, 266.36146727919447, 73.27000000000001, 207.8857507852685, -51.92822249947762, 0.2999999999999945, 27.333481001741124, 56.31, 40.80040953093193, 0.16999999999999993, 43.81410395938932, 2.800356117586955, 6.023535757571315, -15.853881087502693, 4.031831227322547, 46.612873515490406, 13.248245857015224, 33.734936840695596, 139.76423784350385, 13.111279864629475, 226.78044867788472, 84.21820558654387, 7.8480193621531384, 64.82021735641946, -17.604642070478622, -0.9389477401806756], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-501.8223384250351, -322.1792327259976, -347.91044469530357, -328.84876685109435, 62.859996825222154, -381.7363219099609, -315.13423634740707, -420.74657417521865, 42.665459414647714, -402.52337185498624, -265.2931202061446, -477.8078498094917, -457.8010913325664, -425.956240307998, -319.57437984424917, -357.21875721606983, -456.2134476609162, -271.4442972498668, -476.6917451151338, 2.0000000000000013, -452.50501814815027, -486.5588184072351, -465.43410872149974, -191.12298821982813, -543.5421245083294, -454.4263568932068, -37.66520016932188, -467.95965660962025, -503.8774710867398, -388.82671862808905, -415.5681113366909, -94.7346864805809, -511.412567773124, -361.2406379346399, -478.7429235562676, -365.14773237180987, -207.06023757962518, -166.0430739368951, -258.5109199471021, -386.2922230246561, -178.5855002556792, -351.9321706181992, -482.777002461139, -474.3820685924896, -439.6785518227203, 99.43477903208027, -323.0629758915087, -117.09799488131468, -415.78131948071564, 173.09926665190233, -108.75018370046038, -350.60165650055313, -315.2595997665333, -317.85752458606055, -312.45751538119396, -390.0660652540089, -682.3373417928718, -1.3265452907274824, -238.97913664705223, -300.4440088437545, -143.05950166883383, -453.58409682473444, -16.979956253863705, -511.21541125847654, -358.72502807185015, -343.7370545345021, -363.51710105473063, -422.50504698356855, -489.7330714092023, -0.31029010485960384, 87.87306567332871, -373.2135327833064, -530.6751828019384, -613.816685517016, -148.54878042989105, -529.0613159738049, 192.34424516319208, -413.1188992712646, -488.01753895749283, -393.44483949499835, -522.790193618772, -382.8822383538628, -108.93054588163213, -393.294137556484, -452.58758088799215, -469.3848604714838, -284.4393163681075, -95.86020562169557, -351.1003299042552, -518.8340782793454, -255.2367442447886, 160.79040128930603, -242.19227295219505, -433.49241358203955, -461.25234642470826, -525.5356802185564, -13.602811885490757, -606.042938470736, -308.4162531534511, -341.6839012679298, -437.7566432768115, -88.47489221527579, -388.77968879156316, -375.9290146033666, -211.19557553125674, -345.67858763773637, -464.817987698545, -364.0706426023259, -456.0695962942151, 136.15064906889182, -506.36371807039905, -266.6372749339965, -531.7048027322676, 86.40435144843771, -454.0851967455836, -383.17430385556395, 200.0, -449.6854971520564, -373.2950625296121, -104.36300205066459, -189.85504808800226, -476.00001882766145, 21.090494976527395, -376.7222770260316, -272.5100121802348, -441.7849933352065, -99.69417398137962, -408.1554921018485, -470.28670738443475, -127.75825761463148, -179.9087521397368, -596.707929882393, -530.3833002141147, -291.14507133239255, -113.09803679500541, -37.19844056923003, -382.0494870044979, -326.4188492365863, -466.58844257521264, -323.95907154134, -438.89277021539993, -103.98575350589726, -263.4097645941741, -432.68955046946087, -340.8512717918365, -511.23224304793234, -198.4353219136355, -482.27345649932386, -453.0948795884341, -457.69492502596256, -253.86706233686832, -97.41563497893065, -134.3647962442889, -592.2489423568863, -184.48821746745182, -19.538614050816193, -517.9641662241124, -472.37167278596814, -425.59972790858234, -264.81462299535025, -361.69563538798616, -414.0821724589961, -113.02541838576687, -569.0807888177196, -298.25203950150075, -379.25248701403495, -499.1575734908528, -380.9501916261986, -294.6343924868744, -345.89433726083496, -356.8633316499775, -362.3418068252939, -431.4617234175855, -352.35562696971635, -359.2210757441696, -356.56530121593147, -440.3595742209756, -469.31039103035135, -290.29755511821674, -383.91523707644603, -284.51987698351587, -389.9855102054554, -358.8069524938698, -388.92165991441794, -240.41135324831203, -267.20846078575266, -399.6967330631498, -340.0329556995156, -67.49737875883045, -529.2111503535263, -417.84724047228127, -279.0314607756795, -293.72943164149297, -457.50331005451477, -391.77183852291085, -471.53888968744394, -388.24970764730625, -334.76151858534536, -374.0063354069549, -370.431882107927], "policy_predator_policy_reward": [396.9924465459516, 425.7395646369036, 326.9617214605302, 355.2369473214436, 250.297393787462, 314.6774526910834, 349.2668672476321, 484.68558215417676, 64.46304717486389, 409.90275383465223, 265.5631202061444, 477.87784980949164, 453.5027430800102, 420.2385673028798, 353.384082642279, 334.8290544180396, 450.31533182480206, 306.39127138398453, 412.8744061258451, 193.71667694952106, 455.597798569941, 496.85751021987716, 454.2468442726173, 262.1772107861422, 543.5621245083294, 458.44635689320677, 284.7022958466058, 433.46997627118026, 503.9274710867398, 388.93671862808895, 395.6060121075953, 332.6592358247631, 486.0223426786888, 396.77596003363436, 477.6002454310859, 364.8410657051431, 85.65763007301172, 328.1145405863543, 336.52734962354015, 403.90711940863645, 347.345047733418, 433.841674920522, 469.42740817523685, 488.40401691709224, 399.2928472646869, 268.9064451035021, 324.57806966968076, 256.23426439433285, 187.38398732653962, 349.9039409793589, 273.5389594268959, 305.61406999977567, 371.11680685450824, 342.293036830363, 385.34128021611036, 344.8045015944255, 669.657651642188, 44.4358458899012, 363.89800746696744, 162.92060160523593, 227.77440563290426, 444.85433596504765, 265.0829108542219, 444.2113846137328, 348.9504644477475, 411.8951072606653, 450.1528535570191, 361.82256305304, 489.7530714092023, 159.6958586161504, 213.2376483497584, 425.81328498501296, 407.026733075312, 614.4370615350298, 283.4558957177853, 518.4123039506402, 301.3243065875802, 315.8185609312018, 505.1713688488751, 394.4548346567442, 511.1009782213509, 378.13714325869927, 225.98268145443637, 400.06693799115044, 445.29424047661024, 504.74133619824494, 220.9751199669463, 375.01708742315344, 386.8379000945805, 512.7198577420497, 110.75093735715326, 276.67052808471874, 244.66270171940567, 433.333902280062, 462.4909668334364, 526.9056802185561, 309.1530063957064, 544.4888356556963, 322.40710989200716, 383.8000167566457, 379.68437036225987, 344.91823428749734, 393.8196887915631, 379.0690146033666, 213.93557553125666, 349.0552157606185, 486.71311227317335, 359.9665686971641, 403.6621816119223, 212.3957082753916, 440.99117861891307, 401.9922886122109, 491.2961786536126, 332.6590840770721, 373.5292661621141, 432.8203664356668, 374.9413422678248, 318.7681656579726, 211.17567110040818, 338.8323934798683, 428.10381416159237, 466.45872789154845, 90.20950502347276, 376.99227702603133, 306.6714207777034, 424.7620603808508, 340.78300893093984, 357.4351237091607, 421.3091819675941, 423.04871377042883, 462.30570801857766, 557.0146523901059, 506.430217611244, 314.8083016274829, 181.93076382459594, 171.45625458967808, 369.6985770967296, 371.56946173812736, 466.58844257521264, 333.23873039181495, 400.9274539662472, 326.80901370575765, 412.6597858731758, 509.1164490785374, 510.1747774115749, 356.8297399299122, 448.1900232503967, 312.4263593908748, 453.12487958843406, 457.8449250259624, 302.7351715315429, 314.9089930634506, 206.6147962442889, 593.2689423568863, 77.45724186490789, 334.45534043862847, 402.87298816323823, 535.5346283473648, 425.60972790858233, 265.1046229953501, 349.99844669279787, 453.1128421559254, 166.2654183857667, 572.1507888177197, 378.23610071336054, 340.06883533310616, 499.1575734908528, 381.12019162619845, 310.5685520219324, 373.77428168516644, 415.73574997167617, 306.2697446211815, 405.7598845807138, 384.08100156415844, 313.9792785159022, 385.9532173566963, 444.30140544829806, 469.4003910303514, 331.39948343711063, 389.4261822730418, 309.0014283767153, 378.75220466927095, 401.3193340985399, 380.14421515044364, 312.00734469329615, 335.37670718427205, 399.3946057785989, 353.446362848696, 482.73653914226816, 340.75243864797346, 419.0995280674388, 361.9973787670655, 295.64338837246476, 463.43737268569595, 448.1584012697994, 479.9725442969748, 380.68951066803004, 324.71707349414254, 374.691642724506, 368.80762705019504]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.438224689486574, "mean_inference_ms": 89.33942791871087, "mean_action_processing_ms": 3.4752727838108344, "mean_env_wait_ms": 5.3394543596367985, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0065642595291137695, "StateBufferConnector_ms": 0.0036619901657104492, "ViewRequirementAgentConnector_ms": 0.1086118221282959}, "num_episodes": 18, "episode_return_max": 444.0240107737405, "episode_return_min": -123.02807370861163, "episode_return_mean": 92.98504527355861, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1200000, "num_agent_steps_trained": 1200000, "num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 20.36400143254785, "num_env_steps_trained_throughput_per_sec": 20.36400143254785, "timesteps_total": 300000, "num_env_steps_sampled_lifetime": 300000, "num_agent_steps_sampled_lifetime": 1200000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1200000, "timers": {"training_iteration_time_ms": 2901327.562, "restore_workers_time_ms": 0.014, "training_step_time_ms": 2901327.495, "sample_time_ms": 191223.674, "learn_time_ms": 2710081.376, "learn_throughput": 1.476, "synch_weights_time_ms": 16.489}, "counters": {"num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_agent_steps_sampled": 1200000, "num_agent_steps_trained": 1200000}, "done": false, "training_iteration": 75, "trial_id": "b941d_00000", "date": "2024-08-19_06-10-51", "timestamp": 1724028051, "time_this_iter_s": 196.46987223625183, "time_total_s": 166614.8974223137, "pid": 81115, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[32, [4, 4], 2], [64, [3, 3], 2], [128, [3, 3], 1]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [256, 256], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b04030d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 166614.8974223137, "iterations_since_restore": 75, "perf": {"cpu_util_percent": 20.99572192513369, "ram_util_percent": 80.38823529411765}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 14.594560418810163, "cur_kl_coeff": 1.5187500000000005, "cur_lr": 0.00010000000000000003, "total_loss": 7.7342152446666095, "policy_loss": -0.08789389299317485, "vf_loss": 7.799630469872207, "vf_explained_var": 0.3853358593882707, "kl": 0.014800760972942252, "entropy": 0.9889745019415699, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 142695.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 15.516306300579556, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.00010000000000000003, "total_loss": 8.84702720440254, "policy_loss": -0.08169009794170658, "vf_loss": 8.911931674947184, "vf_explained_var": -0.3151016294956207, "kl": 0.016578382685130386, "entropy": 0.790882798351308, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 142695.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 304000, "num_env_steps_trained": 304000, "num_agent_steps_sampled": 1216000, "num_agent_steps_trained": 1216000}, "env_runners": {"episode_reward_max": 444.0240107737405, "episode_reward_min": -123.02807370861163, "episode_reward_mean": 105.44981707710802, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -682.3373417928718, "predator_policy": 0.8000294848992703}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 669.657651642188}, "policy_reward_mean": {"prey_policy": -315.22347375823864, "predator_policy": 367.94838229679254}, "custom_metrics": {}, "hist_stats": {"episode_reward": [327.955519577549, 140.65136329119017, 294.6058754770845, 119.80118922565863, 80.29271933227757, 27.62220117533295, 30.42961044849016, -12.604536418602722, 75.98514310438382, 181.09892795561427, 58.38348910206102, 25.953268571759992, 159.40556851129088, 353.71046622479344, -123.02807370861163, 124.25810326472987, 396.36821341070856, 18.163825053128463, -16.434310492585016, 123.8249360074709, 28.06313531537973, 215.69268540029697, 29.6233496530301, 292.97512248638947, 2.3119174652330763, 2.608620408728182, 233.99609169517592, 56.1069722272722, 198.3710691576703, 8.18, 6.116628122882174, 17.79105066946649, 296.1389426619906, 69.98247422672885, 378.65481144685475, -30.90986800336654, 444.0240107737405, 72.35, 228.70747513747722, 111.57000000000009, 17.138475643113082, 190.3684665568715, 246.31293073895665, 242.70367838655397, -0.2898523077801656, 203.09054105003872, 32.79970259377303, 9.279658850475142, 184.85794395070778, 225.67691988807894, 14.921002501718252, 79.90760422831245, 0.17999999999999328, 266.36146727919447, 73.27000000000001, 207.8857507852685, -51.92822249947762, 0.2999999999999945, 27.333481001741124, 56.31, 40.80040953093193, 0.16999999999999993, 43.81410395938932, 2.800356117586955, 6.023535757571315, -15.853881087502693, 4.031831227322547, 46.612873515490406, 13.248245857015224, 33.734936840695596, 139.76423784350385, 13.111279864629475, 226.78044867788472, 84.21820558654387, 7.8480193621531384, 64.82021735641946, -17.604642070478622, -0.9389477401806756, 25.96107914130939, 69.40999999999998, 129.15247340584395, -23.683165079356076, 3.3645792794773657, 1.199999999999997, 192.97648803567114, 300.0073300321879, 170.1032270371045, 26.79294682735099, 371.61604428919253, 67.66771858116945, 9.842466871819934, 234.3299999999997, 143.4663011645095, 279.6469933213759, 214.93421220856703, 180.6016161299588, 78.9334845455748, -0.5307164705240877, 275.62180125947293, 24.90805992490017], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-439.6785518227203, 99.43477903208027, -323.0629758915087, -117.09799488131468, -415.78131948071564, 173.09926665190233, -108.75018370046038, -350.60165650055313, -315.2595997665333, -317.85752458606055, -312.45751538119396, -390.0660652540089, -682.3373417928718, -1.3265452907274824, -238.97913664705223, -300.4440088437545, -143.05950166883383, -453.58409682473444, -16.979956253863705, -511.21541125847654, -358.72502807185015, -343.7370545345021, -363.51710105473063, -422.50504698356855, -489.7330714092023, -0.31029010485960384, 87.87306567332871, -373.2135327833064, -530.6751828019384, -613.816685517016, -148.54878042989105, -529.0613159738049, 192.34424516319208, -413.1188992712646, -488.01753895749283, -393.44483949499835, -522.790193618772, -382.8822383538628, -108.93054588163213, -393.294137556484, -452.58758088799215, -469.3848604714838, -284.4393163681075, -95.86020562169557, -351.1003299042552, -518.8340782793454, -255.2367442447886, 160.79040128930603, -242.19227295219505, -433.49241358203955, -461.25234642470826, -525.5356802185564, -13.602811885490757, -606.042938470736, -308.4162531534511, -341.6839012679298, -437.7566432768115, -88.47489221527579, -388.77968879156316, -375.9290146033666, -211.19557553125674, -345.67858763773637, -464.817987698545, -364.0706426023259, -456.0695962942151, 136.15064906889182, -506.36371807039905, -266.6372749339965, -531.7048027322676, 86.40435144843771, -454.0851967455836, -383.17430385556395, 200.0, -449.6854971520564, -373.2950625296121, -104.36300205066459, -189.85504808800226, -476.00001882766145, 21.090494976527395, -376.7222770260316, -272.5100121802348, -441.7849933352065, -99.69417398137962, -408.1554921018485, -470.28670738443475, -127.75825761463148, -179.9087521397368, -596.707929882393, -530.3833002141147, -291.14507133239255, -113.09803679500541, -37.19844056923003, -382.0494870044979, -326.4188492365863, -466.58844257521264, -323.95907154134, -438.89277021539993, -103.98575350589726, -263.4097645941741, -432.68955046946087, -340.8512717918365, -511.23224304793234, -198.4353219136355, -482.27345649932386, -453.0948795884341, -457.69492502596256, -253.86706233686832, -97.41563497893065, -134.3647962442889, -592.2489423568863, -184.48821746745182, -19.538614050816193, -517.9641662241124, -472.37167278596814, -425.59972790858234, -264.81462299535025, -361.69563538798616, -414.0821724589961, -113.02541838576687, -569.0807888177196, -298.25203950150075, -379.25248701403495, -499.1575734908528, -380.9501916261986, -294.6343924868744, -345.89433726083496, -356.8633316499775, -362.3418068252939, -431.4617234175855, -352.35562696971635, -359.2210757441696, -356.56530121593147, -440.3595742209756, -469.31039103035135, -290.29755511821674, -383.91523707644603, -284.51987698351587, -389.9855102054554, -358.8069524938698, -388.92165991441794, -240.41135324831203, -267.20846078575266, -399.6967330631498, -340.0329556995156, -67.49737875883045, -529.2111503535263, -417.84724047228127, -279.0314607756795, -293.72943164149297, -457.50331005451477, -391.77183852291085, -471.53888968744394, -388.24970764730625, -334.76151858534536, -374.0063354069549, -370.431882107927, -367.1863980806946, -281.88923032937134, -213.24490483331027, -563.1181691356051, -273.24650225820983, -339.9661537348639, -328.3410247846042, -497.70967987712413, -422.1840666316443, -457.8918322023913, -367.0074378751497, -416.23685514171314, -521.2273655658317, 52.40736838036401, 124.35348813381977, -396.0623688831403, 2.0000000000000013, -515.5610316904892, -354.9896377657169, -343.4098328231072, 106.07314473487315, -464.5137673883434, -244.25103606841543, -380.55653881091763, -326.793324833546, -433.18456674102663, 196.21997051510073, -299.07315725606566, -226.3743479029625, -323.67507031295804, -50.015968776586334, -514.1320861173509, -108.3950010071299, -496.4141075091423, -122.32815574409116, -377.8886682930756, -306.5052628463308, -206.84813978065853, -473.2202706955283, -428.5999259438266, 147.21272263323365, -425.76351121974454, -401.62365429029654, -424.7774951603572], "policy_predator_policy_reward": [399.2928472646869, 268.9064451035021, 324.57806966968076, 256.23426439433285, 187.38398732653962, 349.9039409793589, 273.5389594268959, 305.61406999977567, 371.11680685450824, 342.293036830363, 385.34128021611036, 344.8045015944255, 669.657651642188, 44.4358458899012, 363.89800746696744, 162.92060160523593, 227.77440563290426, 444.85433596504765, 265.0829108542219, 444.2113846137328, 348.9504644477475, 411.8951072606653, 450.1528535570191, 361.82256305304, 489.7530714092023, 159.6958586161504, 213.2376483497584, 425.81328498501296, 407.026733075312, 614.4370615350298, 283.4558957177853, 518.4123039506402, 301.3243065875802, 315.8185609312018, 505.1713688488751, 394.4548346567442, 511.1009782213509, 378.13714325869927, 225.98268145443637, 400.06693799115044, 445.29424047661024, 504.74133619824494, 220.9751199669463, 375.01708742315344, 386.8379000945805, 512.7198577420497, 110.75093735715326, 276.67052808471874, 244.66270171940567, 433.333902280062, 462.4909668334364, 526.9056802185561, 309.1530063957064, 544.4888356556963, 322.40710989200716, 383.8000167566457, 379.68437036225987, 344.91823428749734, 393.8196887915631, 379.0690146033666, 213.93557553125666, 349.0552157606185, 486.71311227317335, 359.9665686971641, 403.6621816119223, 212.3957082753916, 440.99117861891307, 401.9922886122109, 491.2961786536126, 332.6590840770721, 373.5292661621141, 432.8203664356668, 374.9413422678248, 318.7681656579726, 211.17567110040818, 338.8323934798683, 428.10381416159237, 466.45872789154845, 90.20950502347276, 376.99227702603133, 306.6714207777034, 424.7620603808508, 340.78300893093984, 357.4351237091607, 421.3091819675941, 423.04871377042883, 462.30570801857766, 557.0146523901059, 506.430217611244, 314.8083016274829, 181.93076382459594, 171.45625458967808, 369.6985770967296, 371.56946173812736, 466.58844257521264, 333.23873039181495, 400.9274539662472, 326.80901370575765, 412.6597858731758, 509.1164490785374, 510.1747774115749, 356.8297399299122, 448.1900232503967, 312.4263593908748, 453.12487958843406, 457.8449250259624, 302.7351715315429, 314.9089930634506, 206.6147962442889, 593.2689423568863, 77.45724186490789, 334.45534043862847, 402.87298816323823, 535.5346283473648, 425.60972790858233, 265.1046229953501, 349.99844669279787, 453.1128421559254, 166.2654183857667, 572.1507888177197, 378.23610071336054, 340.06883533310616, 499.1575734908528, 381.12019162619845, 310.5685520219324, 373.77428168516644, 415.73574997167617, 306.2697446211815, 405.7598845807138, 384.08100156415844, 313.9792785159022, 385.9532173566963, 444.30140544829806, 469.4003910303514, 331.39948343711063, 389.4261822730418, 309.0014283767153, 378.75220466927095, 401.3193340985399, 380.14421515044364, 312.00734469329615, 335.37670718427205, 399.3946057785989, 353.446362848696, 482.73653914226816, 340.75243864797346, 419.0995280674388, 361.9973787670655, 295.64338837246476, 463.43737268569595, 448.1584012697994, 479.9725442969748, 380.68951066803004, 324.71707349414254, 374.691642724506, 368.80762705019504, 355.89279528442984, 319.1439122669451, 282.48490483331005, 563.2881691356049, 362.39277049195795, 379.97235890695856, 318.8569557823291, 483.51058380004275, 418.2485121571273, 465.1919659563855, 368.1574378751496, 416.2868551417131, 485.49918800098465, 176.2972972201541, 231.92850885224894, 339.7877019292594, 216.72894635458138, 466.93531237301266, 345.8672515819465, 379.3251658342281, 388.82443623203, 341.23223071063245, 189.01236527209164, 503.46292818841056, 420.08176274167585, 349.7385957047164, 0.8000294848992703, 336.3831572560654, 339.19205881994094, 354.32366056048915, 377.1210910424432, 466.6739571728701, 357.2920255081753, 462.45129521666405, 315.76949195692373, 365.0489482102017, 280.98144784102095, 311.30543933154223, 474.4868093785893, 426.80267079024134, 410.3404639674306, 143.83212587855334, 379.61944487214015, 471.6897645034134]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.511483245797476, "mean_inference_ms": 87.7463267087849, "mean_action_processing_ms": 3.435952818113009, "mean_env_wait_ms": 5.7220122459083544, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005833029747009277, "StateBufferConnector_ms": 0.003580451011657715, "ViewRequirementAgentConnector_ms": 0.10955619812011719}, "num_episodes": 22, "episode_return_max": 444.0240107737405, "episode_return_min": -123.02807370861163, "episode_return_mean": 105.44981707710802, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1216000, "num_agent_steps_trained": 1216000, "num_env_steps_sampled": 304000, "num_env_steps_trained": 304000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1.5986515105509334, "num_env_steps_trained_throughput_per_sec": 1.5986515105509334, "timesteps_total": 304000, "num_env_steps_sampled_lifetime": 304000, "num_agent_steps_sampled_lifetime": 1216000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1216000, "timers": {"training_iteration_time_ms": 2422352.292, "restore_workers_time_ms": 0.014, "training_step_time_ms": 2422352.225, "sample_time_ms": 96171.697, "learn_time_ms": 2326159.024, "learn_throughput": 1.72, "synch_weights_time_ms": 15.87}, "counters": {"num_env_steps_sampled": 304000, "num_env_steps_trained": 304000, "num_agent_steps_sampled": 1216000, "num_agent_steps_trained": 1216000}, "done": false, "training_iteration": 76, "trial_id": "b941d_00000", "date": "2024-08-19_06-52-34", "timestamp": 1724030554, "time_this_iter_s": 2502.153503894806, "time_total_s": 169117.0509262085, "pid": 81115, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[32, [4, 4], 2], [64, [3, 3], 2], [128, [3, 3], 1]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [256, 256], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b03ed5e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 169117.0509262085, "iterations_since_restore": 76, "perf": {"cpu_util_percent": 24.966321243523318, "ram_util_percent": 80.49015544041451}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 12.864176553014724, "cur_kl_coeff": 1.5187500000000005, "cur_lr": 0.00010000000000000003, "total_loss": 8.388771000362578, "policy_loss": -0.08436268074093041, "vf_loss": 8.451203047030818, "vf_explained_var": 0.07447023439028906, "kl": 0.01443992029886989, "entropy": 0.9615276685467473, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 144585.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 15.033020866106426, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.00010000000000000003, "total_loss": 8.735811159598134, "policy_loss": -0.0890770171345187, "vf_loss": 8.8083288048941, "vf_explained_var": -0.43846601701918103, "kl": 0.016354917607250486, "entropy": 0.764161088700017, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 144585.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 308000, "num_env_steps_trained": 308000, "num_agent_steps_sampled": 1232000, "num_agent_steps_trained": 1232000}, "env_runners": {"episode_reward_max": 444.0240107737405, "episode_reward_min": -55.28790576756731, "episode_reward_mean": 93.03686035815359, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -606.042938470736, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 593.2689423568863}, "policy_reward_mean": {"prey_policy": -323.45634342211275, "predator_policy": 369.97477360118944}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-16.434310492585016, 123.8249360074709, 28.06313531537973, 215.69268540029697, 29.6233496530301, 292.97512248638947, 2.3119174652330763, 2.608620408728182, 233.99609169517592, 56.1069722272722, 198.3710691576703, 8.18, 6.116628122882174, 17.79105066946649, 296.1389426619906, 69.98247422672885, 378.65481144685475, -30.90986800336654, 444.0240107737405, 72.35, 228.70747513747722, 111.57000000000009, 17.138475643113082, 190.3684665568715, 246.31293073895665, 242.70367838655397, -0.2898523077801656, 203.09054105003872, 32.79970259377303, 9.279658850475142, 184.85794395070778, 225.67691988807894, 14.921002501718252, 79.90760422831245, 0.17999999999999328, 266.36146727919447, 73.27000000000001, 207.8857507852685, -51.92822249947762, 0.2999999999999945, 27.333481001741124, 56.31, 40.80040953093193, 0.16999999999999993, 43.81410395938932, 2.800356117586955, 6.023535757571315, -15.853881087502693, 4.031831227322547, 46.612873515490406, 13.248245857015224, 33.734936840695596, 139.76423784350385, 13.111279864629475, 226.78044867788472, 84.21820558654387, 7.8480193621531384, 64.82021735641946, -17.604642070478622, -0.9389477401806756, 25.96107914130939, 69.40999999999998, 129.15247340584395, -23.683165079356076, 3.3645792794773657, 1.199999999999997, 192.97648803567114, 300.0073300321879, 170.1032270371045, 26.79294682735099, 371.61604428919253, 67.66771858116945, 9.842466871819934, 234.3299999999997, 143.4663011645095, 279.6469933213759, 214.93421220856703, 180.6016161299588, 78.9334845455748, -0.5307164705240877, 275.62180125947293, 24.90805992490017, 140.469372221949, 76.84250288626232, 8.341483254301838, 21.954351880464685, 3.839999999999962, 123.57028330659949, 0.11999999999999589, 76.72403352478557, 128.28305592355304, 0.26000000000000134, -15.391612240989954, 8.343248216286986, 35.681434831081646, -55.28790576756731, 57.261055382484926, 56.2307879447263, -7.0615947113536945, 377.5767050508096], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-522.790193618772, -382.8822383538628, -108.93054588163213, -393.294137556484, -452.58758088799215, -469.3848604714838, -284.4393163681075, -95.86020562169557, -351.1003299042552, -518.8340782793454, -255.2367442447886, 160.79040128930603, -242.19227295219505, -433.49241358203955, -461.25234642470826, -525.5356802185564, -13.602811885490757, -606.042938470736, -308.4162531534511, -341.6839012679298, -437.7566432768115, -88.47489221527579, -388.77968879156316, -375.9290146033666, -211.19557553125674, -345.67858763773637, -464.817987698545, -364.0706426023259, -456.0695962942151, 136.15064906889182, -506.36371807039905, -266.6372749339965, -531.7048027322676, 86.40435144843771, -454.0851967455836, -383.17430385556395, 200.0, -449.6854971520564, -373.2950625296121, -104.36300205066459, -189.85504808800226, -476.00001882766145, 21.090494976527395, -376.7222770260316, -272.5100121802348, -441.7849933352065, -99.69417398137962, -408.1554921018485, -470.28670738443475, -127.75825761463148, -179.9087521397368, -596.707929882393, -530.3833002141147, -291.14507133239255, -113.09803679500541, -37.19844056923003, -382.0494870044979, -326.4188492365863, -466.58844257521264, -323.95907154134, -438.89277021539993, -103.98575350589726, -263.4097645941741, -432.68955046946087, -340.8512717918365, -511.23224304793234, -198.4353219136355, -482.27345649932386, -453.0948795884341, -457.69492502596256, -253.86706233686832, -97.41563497893065, -134.3647962442889, -592.2489423568863, -184.48821746745182, -19.538614050816193, -517.9641662241124, -472.37167278596814, -425.59972790858234, -264.81462299535025, -361.69563538798616, -414.0821724589961, -113.02541838576687, -569.0807888177196, -298.25203950150075, -379.25248701403495, -499.1575734908528, -380.9501916261986, -294.6343924868744, -345.89433726083496, -356.8633316499775, -362.3418068252939, -431.4617234175855, -352.35562696971635, -359.2210757441696, -356.56530121593147, -440.3595742209756, -469.31039103035135, -290.29755511821674, -383.91523707644603, -284.51987698351587, -389.9855102054554, -358.8069524938698, -388.92165991441794, -240.41135324831203, -267.20846078575266, -399.6967330631498, -340.0329556995156, -67.49737875883045, -529.2111503535263, -417.84724047228127, -279.0314607756795, -293.72943164149297, -457.50331005451477, -391.77183852291085, -471.53888968744394, -388.24970764730625, -334.76151858534536, -374.0063354069549, -370.431882107927, -367.1863980806946, -281.88923032937134, -213.24490483331027, -563.1181691356051, -273.24650225820983, -339.9661537348639, -328.3410247846042, -497.70967987712413, -422.1840666316443, -457.8918322023913, -367.0074378751497, -416.23685514171314, -521.2273655658317, 52.40736838036401, 124.35348813381977, -396.0623688831403, 2.0000000000000013, -515.5610316904892, -354.9896377657169, -343.4098328231072, 106.07314473487315, -464.5137673883434, -244.25103606841543, -380.55653881091763, -326.793324833546, -433.18456674102663, 196.21997051510073, -299.07315725606566, -226.3743479029625, -323.67507031295804, -50.015968776586334, -514.1320861173509, -108.3950010071299, -496.4141075091423, -122.32815574409116, -377.8886682930756, -306.5052628463308, -206.84813978065853, -473.2202706955283, -428.5999259438266, 147.21272263323365, -425.76351121974454, -401.62365429029654, -424.7774951603572, -383.4519707974657, -193.86938215752906, -199.09016357971672, -313.78965621845674, -494.4916092186713, -112.44468014894873, -408.66459968414404, -373.6069493432545, -14.162001030962577, 2.0000000000000013, -361.24657154149514, -360.11928180911804, -514.6481727783035, -447.5106902759638, -220.55588837415493, -496.0526878359364, -245.86933804765644, -425.68910697161084, -402.5966099916889, -437.90922601422534, -465.6491749278615, -396.06868470763095, -427.6119057661465, -333.4785419003196, -401.8564148634448, -283.730994293722, -266.10551714924225, -457.44818515149007, -418.79611246691707, -201.83522527215194, -534.4794517942657, -317.69850788625166, -418.1120838356981, -370.3144059203912, 145.2932689003141, -449.1258066336088], "policy_predator_policy_reward": [511.1009782213509, 378.13714325869927, 225.98268145443637, 400.06693799115044, 445.29424047661024, 504.74133619824494, 220.9751199669463, 375.01708742315344, 386.8379000945805, 512.7198577420497, 110.75093735715326, 276.67052808471874, 244.66270171940567, 433.333902280062, 462.4909668334364, 526.9056802185561, 309.1530063957064, 544.4888356556963, 322.40710989200716, 383.8000167566457, 379.68437036225987, 344.91823428749734, 393.8196887915631, 379.0690146033666, 213.93557553125666, 349.0552157606185, 486.71311227317335, 359.9665686971641, 403.6621816119223, 212.3957082753916, 440.99117861891307, 401.9922886122109, 491.2961786536126, 332.6590840770721, 373.5292661621141, 432.8203664356668, 374.9413422678248, 318.7681656579726, 211.17567110040818, 338.8323934798683, 428.10381416159237, 466.45872789154845, 90.20950502347276, 376.99227702603133, 306.6714207777034, 424.7620603808508, 340.78300893093984, 357.4351237091607, 421.3091819675941, 423.04871377042883, 462.30570801857766, 557.0146523901059, 506.430217611244, 314.8083016274829, 181.93076382459594, 171.45625458967808, 369.6985770967296, 371.56946173812736, 466.58844257521264, 333.23873039181495, 400.9274539662472, 326.80901370575765, 412.6597858731758, 509.1164490785374, 510.1747774115749, 356.8297399299122, 448.1900232503967, 312.4263593908748, 453.12487958843406, 457.8449250259624, 302.7351715315429, 314.9089930634506, 206.6147962442889, 593.2689423568863, 77.45724186490789, 334.45534043862847, 402.87298816323823, 535.5346283473648, 425.60972790858233, 265.1046229953501, 349.99844669279787, 453.1128421559254, 166.2654183857667, 572.1507888177197, 378.23610071336054, 340.06883533310616, 499.1575734908528, 381.12019162619845, 310.5685520219324, 373.77428168516644, 415.73574997167617, 306.2697446211815, 405.7598845807138, 384.08100156415844, 313.9792785159022, 385.9532173566963, 444.30140544829806, 469.4003910303514, 331.39948343711063, 389.4261822730418, 309.0014283767153, 378.75220466927095, 401.3193340985399, 380.14421515044364, 312.00734469329615, 335.37670718427205, 399.3946057785989, 353.446362848696, 482.73653914226816, 340.75243864797346, 419.0995280674388, 361.9973787670655, 295.64338837246476, 463.43737268569595, 448.1584012697994, 479.9725442969748, 380.68951066803004, 324.71707349414254, 374.691642724506, 368.80762705019504, 355.89279528442984, 319.1439122669451, 282.48490483331005, 563.2881691356049, 362.39277049195795, 379.97235890695856, 318.8569557823291, 483.51058380004275, 418.2485121571273, 465.1919659563855, 368.1574378751496, 416.2868551417131, 485.49918800098465, 176.2972972201541, 231.92850885224894, 339.7877019292594, 216.72894635458138, 466.93531237301266, 345.8672515819465, 379.3251658342281, 388.82443623203, 341.23223071063245, 189.01236527209164, 503.46292818841056, 420.08176274167585, 349.7385957047164, 0.8000294848992703, 336.3831572560654, 339.19205881994094, 354.32366056048915, 377.1210910424432, 466.6739571728701, 357.2920255081753, 462.45129521666405, 315.76949195692373, 365.0489482102017, 280.98144784102095, 311.30543933154223, 474.4868093785893, 426.80267079024134, 410.3404639674306, 143.83212587855334, 379.61944487214015, 471.6897645034134, 350.69157980540297, 367.0991453715401, 289.8456040358176, 299.8767186486179, 97.23740288492628, 518.0403697369965, 400.4987972444939, 403.72710366336895, 16.00200103096254, 0.0, 462.5320213303911, 382.40411532682145, 514.7081727783035, 447.5706902759637, 347.2470989105796, 446.0855108242966, 409.2612206723647, 390.5802802704552, 402.68660999168884, 438.0792260142252, 473.99035269635743, 372.3358946981448, 437.16286048559647, 332.27083539715665, 408.0023413006321, 313.266502687616, 320.09729389550364, 348.168502637661, 433.44743616760707, 244.44495695394642, 502.2601796669354, 406.1485679583079, 450.41671398213373, 330.94818106260163, 331.99875352022514, 349.4104892638791]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.264786120953752, "mean_inference_ms": 87.05917625188788, "mean_action_processing_ms": 3.3971460066746055, "mean_env_wait_ms": 5.190846915204636, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005306243896484375, "StateBufferConnector_ms": 0.003585338592529297, "ViewRequirementAgentConnector_ms": 0.11089372634887695}, "num_episodes": 18, "episode_return_max": 444.0240107737405, "episode_return_min": -55.28790576756731, "episode_return_mean": 93.03686035815359, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1232000, "num_agent_steps_trained": 1232000, "num_env_steps_sampled": 308000, "num_env_steps_trained": 308000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 0.8273267656998038, "num_env_steps_trained_throughput_per_sec": 0.8273267656998038, "timesteps_total": 308000, "num_env_steps_sampled_lifetime": 308000, "num_agent_steps_sampled_lifetime": 1232000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1232000, "timers": {"training_iteration_time_ms": 2537046.627, "restore_workers_time_ms": 0.014, "training_step_time_ms": 2537046.557, "sample_time_ms": 96161.069, "learn_time_ms": 2440862.639, "learn_throughput": 1.639, "synch_weights_time_ms": 17.383}, "counters": {"num_env_steps_sampled": 308000, "num_env_steps_trained": 308000, "num_agent_steps_sampled": 1232000, "num_agent_steps_trained": 1232000}, "done": false, "training_iteration": 77, "trial_id": "b941d_00000", "date": "2024-08-19_08-13-09", "timestamp": 1724035389, "time_this_iter_s": 4834.885323047638, "time_total_s": 173951.93624925613, "pid": 81115, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[32, [4, 4], 2], [64, [3, 3], 2], [128, [3, 3], 1]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [256, 256], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b03019d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 173951.93624925613, "iterations_since_restore": 77, "perf": {"cpu_util_percent": 28.016582914572865, "ram_util_percent": 80.96432160804021}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 15.96446352623127, "cur_kl_coeff": 1.5187500000000005, "cur_lr": 0.00010000000000000003, "total_loss": 8.16238353492091, "policy_loss": -0.08640613405295111, "vf_loss": 8.227598771342524, "vf_explained_var": 0.41664522425838246, "kl": 0.013952864446285913, "entropy": 0.9488568984957599, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 146475.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 16.39872401908592, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.00010000000000000003, "total_loss": 9.299521864532794, "policy_loss": -0.088897768690783, "vf_loss": 9.370756608973105, "vf_explained_var": -0.8810371579947295, "kl": 0.017444949883901027, "entropy": 0.8003234689513211, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 146475.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_agent_steps_sampled": 1248000, "num_agent_steps_trained": 1248000}, "env_runners": {"episode_reward_max": 377.5767050508096, "episode_reward_min": -55.28790576756731, "episode_reward_mean": 103.64174080081816, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -596.707929882393, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 196.21997051510073, "predator_policy": 593.2689423568863}, "policy_reward_mean": {"prey_policy": -315.5666859990786, "predator_policy": 367.3875563994875}, "custom_metrics": {}, "hist_stats": {"episode_reward": [190.3684665568715, 246.31293073895665, 242.70367838655397, -0.2898523077801656, 203.09054105003872, 32.79970259377303, 9.279658850475142, 184.85794395070778, 225.67691988807894, 14.921002501718252, 79.90760422831245, 0.17999999999999328, 266.36146727919447, 73.27000000000001, 207.8857507852685, -51.92822249947762, 0.2999999999999945, 27.333481001741124, 56.31, 40.80040953093193, 0.16999999999999993, 43.81410395938932, 2.800356117586955, 6.023535757571315, -15.853881087502693, 4.031831227322547, 46.612873515490406, 13.248245857015224, 33.734936840695596, 139.76423784350385, 13.111279864629475, 226.78044867788472, 84.21820558654387, 7.8480193621531384, 64.82021735641946, -17.604642070478622, -0.9389477401806756, 25.96107914130939, 69.40999999999998, 129.15247340584395, -23.683165079356076, 3.3645792794773657, 1.199999999999997, 192.97648803567114, 300.0073300321879, 170.1032270371045, 26.79294682735099, 371.61604428919253, 67.66771858116945, 9.842466871819934, 234.3299999999997, 143.4663011645095, 279.6469933213759, 214.93421220856703, 180.6016161299588, 78.9334845455748, -0.5307164705240877, 275.62180125947293, 24.90805992490017, 140.469372221949, 76.84250288626232, 8.341483254301838, 21.954351880464685, 3.839999999999962, 123.57028330659949, 0.11999999999999589, 76.72403352478557, 128.28305592355304, 0.26000000000000134, -15.391612240989954, 8.343248216286986, 35.681434831081646, -55.28790576756731, 57.261055382484926, 56.2307879447263, -7.0615947113536945, 377.5767050508096, 188.2251201189355, 341.02716150956473, -0.07396264298273136, 132.18, 117.6847311083177, 11.571309520316412, 220.63216442230276, 245.95673920082638, 257.7601377927281, 6.420233067665752, 70.68663684980532, 248.59571642922114, 57.267355202572865, 214.17601213839694, 86.74, 226.89877619674584, 352.6575982280071, 148.1463833209835, 333.13334677405487, 311.0990328422082, 129.85219367278117, 55.15962352128843, 91.57532499566551], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-99.69417398137962, -408.1554921018485, -470.28670738443475, -127.75825761463148, -179.9087521397368, -596.707929882393, -530.3833002141147, -291.14507133239255, -113.09803679500541, -37.19844056923003, -382.0494870044979, -326.4188492365863, -466.58844257521264, -323.95907154134, -438.89277021539993, -103.98575350589726, -263.4097645941741, -432.68955046946087, -340.8512717918365, -511.23224304793234, -198.4353219136355, -482.27345649932386, -453.0948795884341, -457.69492502596256, -253.86706233686832, -97.41563497893065, -134.3647962442889, -592.2489423568863, -184.48821746745182, -19.538614050816193, -517.9641662241124, -472.37167278596814, -425.59972790858234, -264.81462299535025, -361.69563538798616, -414.0821724589961, -113.02541838576687, -569.0807888177196, -298.25203950150075, -379.25248701403495, -499.1575734908528, -380.9501916261986, -294.6343924868744, -345.89433726083496, -356.8633316499775, -362.3418068252939, -431.4617234175855, -352.35562696971635, -359.2210757441696, -356.56530121593147, -440.3595742209756, -469.31039103035135, -290.29755511821674, -383.91523707644603, -284.51987698351587, -389.9855102054554, -358.8069524938698, -388.92165991441794, -240.41135324831203, -267.20846078575266, -399.6967330631498, -340.0329556995156, -67.49737875883045, -529.2111503535263, -417.84724047228127, -279.0314607756795, -293.72943164149297, -457.50331005451477, -391.77183852291085, -471.53888968744394, -388.24970764730625, -334.76151858534536, -374.0063354069549, -370.431882107927, -367.1863980806946, -281.88923032937134, -213.24490483331027, -563.1181691356051, -273.24650225820983, -339.9661537348639, -328.3410247846042, -497.70967987712413, -422.1840666316443, -457.8918322023913, -367.0074378751497, -416.23685514171314, -521.2273655658317, 52.40736838036401, 124.35348813381977, -396.0623688831403, 2.0000000000000013, -515.5610316904892, -354.9896377657169, -343.4098328231072, 106.07314473487315, -464.5137673883434, -244.25103606841543, -380.55653881091763, -326.793324833546, -433.18456674102663, 196.21997051510073, -299.07315725606566, -226.3743479029625, -323.67507031295804, -50.015968776586334, -514.1320861173509, -108.3950010071299, -496.4141075091423, -122.32815574409116, -377.8886682930756, -306.5052628463308, -206.84813978065853, -473.2202706955283, -428.5999259438266, 147.21272263323365, -425.76351121974454, -401.62365429029654, -424.7774951603572, -383.4519707974657, -193.86938215752906, -199.09016357971672, -313.78965621845674, -494.4916092186713, -112.44468014894873, -408.66459968414404, -373.6069493432545, -14.162001030962577, 2.0000000000000013, -361.24657154149514, -360.11928180911804, -514.6481727783035, -447.5106902759638, -220.55588837415493, -496.0526878359364, -245.86933804765644, -425.68910697161084, -402.5966099916889, -437.90922601422534, -465.6491749278615, -396.06868470763095, -427.6119057661465, -333.4785419003196, -401.8564148634448, -283.730994293722, -266.10551714924225, -457.44818515149007, -418.79611246691707, -201.83522527215194, -534.4794517942657, -317.69850788625166, -418.1120838356981, -370.3144059203912, 145.2932689003141, -449.1258066336088, -106.98411523374251, -550.9348864476193, -395.41309435857045, 186.63740894523448, -503.7281767288093, -504.30261576087645, -201.3870993390749, -99.70012763931038, -236.41021275675453, -469.35511274769993, -299.88374993732907, -455.1622847454969, -15.576676207025855, -448.09450333278517, 29.04867904000777, -439.38749474953477, 37.94247339343286, -287.2070243354651, -326.0758229416047, -422.7915266753773, -204.03474649824585, -428.3133739023019, -259.48050361728684, -92.74872071634465, -296.13560114515514, -388.05078026543026, -440.51426784810525, -23.432875179709228, -135.33864742206526, -343.30935487223604, -90.54447065976126, -474.4853048020649, 30.10297613696406, -452.7906357639069, -323.74815784415034, -393.27426283732945, -20.474790295829848, -506.08454690569545, 188.12, -429.7154792282338, -179.77668396554117, -336.3306924457072, -310.6187303184853, -498.68340292000386, -256.93517670839424, -368.7811113484809], "policy_predator_policy_reward": [340.78300893093984, 357.4351237091607, 421.3091819675941, 423.04871377042883, 462.30570801857766, 557.0146523901059, 506.430217611244, 314.8083016274829, 181.93076382459594, 171.45625458967808, 369.6985770967296, 371.56946173812736, 466.58844257521264, 333.23873039181495, 400.9274539662472, 326.80901370575765, 412.6597858731758, 509.1164490785374, 510.1747774115749, 356.8297399299122, 448.1900232503967, 312.4263593908748, 453.12487958843406, 457.8449250259624, 302.7351715315429, 314.9089930634506, 206.6147962442889, 593.2689423568863, 77.45724186490789, 334.45534043862847, 402.87298816323823, 535.5346283473648, 425.60972790858233, 265.1046229953501, 349.99844669279787, 453.1128421559254, 166.2654183857667, 572.1507888177197, 378.23610071336054, 340.06883533310616, 499.1575734908528, 381.12019162619845, 310.5685520219324, 373.77428168516644, 415.73574997167617, 306.2697446211815, 405.7598845807138, 384.08100156415844, 313.9792785159022, 385.9532173566963, 444.30140544829806, 469.4003910303514, 331.39948343711063, 389.4261822730418, 309.0014283767153, 378.75220466927095, 401.3193340985399, 380.14421515044364, 312.00734469329615, 335.37670718427205, 399.3946057785989, 353.446362848696, 482.73653914226816, 340.75243864797346, 419.0995280674388, 361.9973787670655, 295.64338837246476, 463.43737268569595, 448.1584012697994, 479.9725442969748, 380.68951066803004, 324.71707349414254, 374.691642724506, 368.80762705019504, 355.89279528442984, 319.1439122669451, 282.48490483331005, 563.2881691356049, 362.39277049195795, 379.97235890695856, 318.8569557823291, 483.51058380004275, 418.2485121571273, 465.1919659563855, 368.1574378751496, 416.2868551417131, 485.49918800098465, 176.2972972201541, 231.92850885224894, 339.7877019292594, 216.72894635458138, 466.93531237301266, 345.8672515819465, 379.3251658342281, 388.82443623203, 341.23223071063245, 189.01236527209164, 503.46292818841056, 420.08176274167585, 349.7385957047164, 0.8000294848992703, 336.3831572560654, 339.19205881994094, 354.32366056048915, 377.1210910424432, 466.6739571728701, 357.2920255081753, 462.45129521666405, 315.76949195692373, 365.0489482102017, 280.98144784102095, 311.30543933154223, 474.4868093785893, 426.80267079024134, 410.3404639674306, 143.83212587855334, 379.61944487214015, 471.6897645034134, 350.69157980540297, 367.0991453715401, 289.8456040358176, 299.8767186486179, 97.23740288492628, 518.0403697369965, 400.4987972444939, 403.72710366336895, 16.00200103096254, 0.0, 462.5320213303911, 382.40411532682145, 514.7081727783035, 447.5706902759637, 347.2470989105796, 446.0855108242966, 409.2612206723647, 390.5802802704552, 402.68660999168884, 438.0792260142252, 473.99035269635743, 372.3358946981448, 437.16286048559647, 332.27083539715665, 408.0023413006321, 313.266502687616, 320.09729389550364, 348.168502637661, 433.44743616760707, 244.44495695394642, 502.2601796669354, 406.1485679583079, 450.41671398213373, 330.94818106260163, 331.99875352022514, 349.4104892638791, 357.4316223173978, 488.7124994828997, 311.181356395476, 238.62149052742478, 505.8693029136112, 502.0875269330916, 237.4870993390748, 195.7801276393103, 393.1130434517643, 430.3370131610077, 409.5881311197927, 357.02921308334965, 304.9561476250778, 379.3471963370357, 283.29498203377193, 373.00057287658126, 150.65670088393216, 356.36798785082794, 329.4960560092702, 425.7915266753773, 399.8348295210559, 303.1999277292965, 260.14107217069306, 340.6838685921594, 350.75107217550305, 390.70266443765513, 390.4827416542024, 287.64041351200945, 386.8414123358064, 178.54658995849425, 376.94372216363297, 414.9848294949393, 384.13530601910793, 391.2099518358421, 425.3529166356293, 439.8158873668328, 434.24262363800165, 425.45006033757835, 230.24080440584027, 322.45370766460206, 131.47224570368573, 514.4873243803437, 355.7691891877739, 508.69256757200384, 371.37576352613377, 345.915849526407]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.156749420459298, "mean_inference_ms": 85.78728686335731, "mean_action_processing_ms": 3.340905926575897, "mean_env_wait_ms": 5.131401727226378, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00502777099609375, "StateBufferConnector_ms": 0.0037091970443725586, "ViewRequirementAgentConnector_ms": 0.11236512660980225}, "num_episodes": 23, "episode_return_max": 377.5767050508096, "episode_return_min": -55.28790576756731, "episode_return_mean": 103.64174080081816, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1248000, "num_agent_steps_trained": 1248000, "num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 2.3428096066275885, "num_env_steps_trained_throughput_per_sec": 2.3428096066275885, "timesteps_total": 312000, "num_env_steps_sampled_lifetime": 312000, "num_agent_steps_sampled_lifetime": 1248000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1248000, "timers": {"training_iteration_time_ms": 1567105.835, "restore_workers_time_ms": 0.018, "training_step_time_ms": 1567105.755, "sample_time_ms": 2133.657, "learn_time_ms": 1564948.528, "learn_throughput": 2.556, "synch_weights_time_ms": 17.72}, "counters": {"num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_agent_steps_sampled": 1248000, "num_agent_steps_trained": 1248000}, "done": false, "training_iteration": 78, "trial_id": "b941d_00000", "date": "2024-08-19_08-41-36", "timestamp": 1724037096, "time_this_iter_s": 1707.3994402885437, "time_total_s": 175659.33568954468, "pid": 81115, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[32, [4, 4], 2], [64, [3, 3], 2], [128, [3, 3], 1]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [256, 256], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b042dd30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 175659.33568954468, "iterations_since_restore": 78, "perf": {"cpu_util_percent": 30.1378640776699, "ram_util_percent": 77.01407766990292}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 12.207823510649343, "cur_kl_coeff": 1.5187500000000005, "cur_lr": 0.00010000000000000003, "total_loss": 8.695098911769806, "policy_loss": -0.0924538361990243, "vf_loss": 8.76559226803048, "vf_explained_var": 0.12639100706135786, "kl": 0.014459575024571562, "entropy": 0.9799151049404548, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 148365.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 16.087249759769943, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.00010000000000000003, "total_loss": 9.07185309324315, "policy_loss": -0.0855829530213245, "vf_loss": 9.13975979941232, "vf_explained_var": -0.8422399097649509, "kl": 0.01745803356572239, "entropy": 0.7291760802268982, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 148365.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 316000, "num_env_steps_trained": 316000, "num_agent_steps_sampled": 1264000, "num_agent_steps_trained": 1264000}, "env_runners": {"episode_reward_max": 377.5767050508096, "episode_reward_min": -55.28790576756731, "episode_reward_mean": 95.46960517876225, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -569.0807888177196, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 572.1507888177197}, "policy_reward_mean": {"prey_policy": -317.54653030599167, "predator_policy": 365.28133289537277}, "custom_metrics": {}, "hist_stats": {"episode_reward": [56.31, 40.80040953093193, 0.16999999999999993, 43.81410395938932, 2.800356117586955, 6.023535757571315, -15.853881087502693, 4.031831227322547, 46.612873515490406, 13.248245857015224, 33.734936840695596, 139.76423784350385, 13.111279864629475, 226.78044867788472, 84.21820558654387, 7.8480193621531384, 64.82021735641946, -17.604642070478622, -0.9389477401806756, 25.96107914130939, 69.40999999999998, 129.15247340584395, -23.683165079356076, 3.3645792794773657, 1.199999999999997, 192.97648803567114, 300.0073300321879, 170.1032270371045, 26.79294682735099, 371.61604428919253, 67.66771858116945, 9.842466871819934, 234.3299999999997, 143.4663011645095, 279.6469933213759, 214.93421220856703, 180.6016161299588, 78.9334845455748, -0.5307164705240877, 275.62180125947293, 24.90805992490017, 140.469372221949, 76.84250288626232, 8.341483254301838, 21.954351880464685, 3.839999999999962, 123.57028330659949, 0.11999999999999589, 76.72403352478557, 128.28305592355304, 0.26000000000000134, -15.391612240989954, 8.343248216286986, 35.681434831081646, -55.28790576756731, 57.261055382484926, 56.2307879447263, -7.0615947113536945, 377.5767050508096, 188.2251201189355, 341.02716150956473, -0.07396264298273136, 132.18, 117.6847311083177, 11.571309520316412, 220.63216442230276, 245.95673920082638, 257.7601377927281, 6.420233067665752, 70.68663684980532, 248.59571642922114, 57.267355202572865, 214.17601213839694, 86.74, 226.89877619674584, 352.6575982280071, 148.1463833209835, 333.13334677405487, 311.0990328422082, 129.85219367278117, 55.15962352128843, 91.57532499566551, 7.002458165787081, 200.4999999999998, 0.10999999999999654, 168.24384372479864, 18.095524895441898, 0.11999999999999433, 64.55199383535688, 189.15999999999997, 0.5742170334840315, 5.040000000000003, -29.321681305000617, 262.5908952675571, 15.783746775804254, 3.240000000000003, 25.96541945321848, 19.368769751943006, 162.81858894757733, 21.973734252876085], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-113.02541838576687, -569.0807888177196, -298.25203950150075, -379.25248701403495, -499.1575734908528, -380.9501916261986, -294.6343924868744, -345.89433726083496, -356.8633316499775, -362.3418068252939, -431.4617234175855, -352.35562696971635, -359.2210757441696, -356.56530121593147, -440.3595742209756, -469.31039103035135, -290.29755511821674, -383.91523707644603, -284.51987698351587, -389.9855102054554, -358.8069524938698, -388.92165991441794, -240.41135324831203, -267.20846078575266, -399.6967330631498, -340.0329556995156, -67.49737875883045, -529.2111503535263, -417.84724047228127, -279.0314607756795, -293.72943164149297, -457.50331005451477, -391.77183852291085, -471.53888968744394, -388.24970764730625, -334.76151858534536, -374.0063354069549, -370.431882107927, -367.1863980806946, -281.88923032937134, -213.24490483331027, -563.1181691356051, -273.24650225820983, -339.9661537348639, -328.3410247846042, -497.70967987712413, -422.1840666316443, -457.8918322023913, -367.0074378751497, -416.23685514171314, -521.2273655658317, 52.40736838036401, 124.35348813381977, -396.0623688831403, 2.0000000000000013, -515.5610316904892, -354.9896377657169, -343.4098328231072, 106.07314473487315, -464.5137673883434, -244.25103606841543, -380.55653881091763, -326.793324833546, -433.18456674102663, 196.21997051510073, -299.07315725606566, -226.3743479029625, -323.67507031295804, -50.015968776586334, -514.1320861173509, -108.3950010071299, -496.4141075091423, -122.32815574409116, -377.8886682930756, -306.5052628463308, -206.84813978065853, -473.2202706955283, -428.5999259438266, 147.21272263323365, -425.76351121974454, -401.62365429029654, -424.7774951603572, -383.4519707974657, -193.86938215752906, -199.09016357971672, -313.78965621845674, -494.4916092186713, -112.44468014894873, -408.66459968414404, -373.6069493432545, -14.162001030962577, 2.0000000000000013, -361.24657154149514, -360.11928180911804, -514.6481727783035, -447.5106902759638, -220.55588837415493, -496.0526878359364, -245.86933804765644, -425.68910697161084, -402.5966099916889, -437.90922601422534, -465.6491749278615, -396.06868470763095, -427.6119057661465, -333.4785419003196, -401.8564148634448, -283.730994293722, -266.10551714924225, -457.44818515149007, -418.79611246691707, -201.83522527215194, -534.4794517942657, -317.69850788625166, -418.1120838356981, -370.3144059203912, 145.2932689003141, -449.1258066336088, -106.98411523374251, -550.9348864476193, -395.41309435857045, 186.63740894523448, -503.7281767288093, -504.30261576087645, -201.3870993390749, -99.70012763931038, -236.41021275675453, -469.35511274769993, -299.88374993732907, -455.1622847454969, -15.576676207025855, -448.09450333278517, 29.04867904000777, -439.38749474953477, 37.94247339343286, -287.2070243354651, -326.0758229416047, -422.7915266753773, -204.03474649824585, -428.3133739023019, -259.48050361728684, -92.74872071634465, -296.13560114515514, -388.05078026543026, -440.51426784810525, -23.432875179709228, -135.33864742206526, -343.30935487223604, -90.54447065976126, -474.4853048020649, 30.10297613696406, -452.7906357639069, -323.74815784415034, -393.27426283732945, -20.474790295829848, -506.08454690569545, 188.12, -429.7154792282338, -179.77668396554117, -336.3306924457072, -310.6187303184853, -498.68340292000386, -256.93517670839424, -368.7811113484809, -405.7259004061157, -483.3014116903097, -448.9292695243148, 200.0, -373.02912182311275, -496.0399023042011, -419.95119059746446, -72.0849601950381, -307.63011677503533, -450.77364240913863, -508.5037025778377, -371.17380540359136, -397.4142867565842, -310.6334476321882, 189.11, -401.1526742679526, -349.00803920793936, -405.1007477994385, -420.14221714559784, -446.1579279960625, -412.2325477665089, -422.6184554593174, -33.41135673582578, -391.66684738772506, -426.76012679624796, -345.25746303776475, -398.6306308436486, -303.66651604976283, -347.38978386628827, -345.1272030646209, -292.2832294406235, -369.5775597641663, -421.85442730617154, -88.86122014972162, -380.8136484248058, -512.5386949986099], "policy_predator_policy_reward": [166.2654183857667, 572.1507888177197, 378.23610071336054, 340.06883533310616, 499.1575734908528, 381.12019162619845, 310.5685520219324, 373.77428168516644, 415.73574997167617, 306.2697446211815, 405.7598845807138, 384.08100156415844, 313.9792785159022, 385.9532173566963, 444.30140544829806, 469.4003910303514, 331.39948343711063, 389.4261822730418, 309.0014283767153, 378.75220466927095, 401.3193340985399, 380.14421515044364, 312.00734469329615, 335.37670718427205, 399.3946057785989, 353.446362848696, 482.73653914226816, 340.75243864797346, 419.0995280674388, 361.9973787670655, 295.64338837246476, 463.43737268569595, 448.1584012697994, 479.9725442969748, 380.68951066803004, 324.71707349414254, 374.691642724506, 368.80762705019504, 355.89279528442984, 319.1439122669451, 282.48490483331005, 563.2881691356049, 362.39277049195795, 379.97235890695856, 318.8569557823291, 483.51058380004275, 418.2485121571273, 465.1919659563855, 368.1574378751496, 416.2868551417131, 485.49918800098465, 176.2972972201541, 231.92850885224894, 339.7877019292594, 216.72894635458138, 466.93531237301266, 345.8672515819465, 379.3251658342281, 388.82443623203, 341.23223071063245, 189.01236527209164, 503.46292818841056, 420.08176274167585, 349.7385957047164, 0.8000294848992703, 336.3831572560654, 339.19205881994094, 354.32366056048915, 377.1210910424432, 466.6739571728701, 357.2920255081753, 462.45129521666405, 315.76949195692373, 365.0489482102017, 280.98144784102095, 311.30543933154223, 474.4868093785893, 426.80267079024134, 410.3404639674306, 143.83212587855334, 379.61944487214015, 471.6897645034134, 350.69157980540297, 367.0991453715401, 289.8456040358176, 299.8767186486179, 97.23740288492628, 518.0403697369965, 400.4987972444939, 403.72710366336895, 16.00200103096254, 0.0, 462.5320213303911, 382.40411532682145, 514.7081727783035, 447.5706902759637, 347.2470989105796, 446.0855108242966, 409.2612206723647, 390.5802802704552, 402.68660999168884, 438.0792260142252, 473.99035269635743, 372.3358946981448, 437.16286048559647, 332.27083539715665, 408.0023413006321, 313.266502687616, 320.09729389550364, 348.168502637661, 433.44743616760707, 244.44495695394642, 502.2601796669354, 406.1485679583079, 450.41671398213373, 330.94818106260163, 331.99875352022514, 349.4104892638791, 357.4316223173978, 488.7124994828997, 311.181356395476, 238.62149052742478, 505.8693029136112, 502.0875269330916, 237.4870993390748, 195.7801276393103, 393.1130434517643, 430.3370131610077, 409.5881311197927, 357.02921308334965, 304.9561476250778, 379.3471963370357, 283.29498203377193, 373.00057287658126, 150.65670088393216, 356.36798785082794, 329.4960560092702, 425.7915266753773, 399.8348295210559, 303.1999277292965, 260.14107217069306, 340.6838685921594, 350.75107217550305, 390.70266443765513, 390.4827416542024, 287.64041351200945, 386.8414123358064, 178.54658995849425, 376.94372216363297, 414.9848294949393, 384.13530601910793, 391.2099518358421, 425.3529166356293, 439.8158873668328, 434.24262363800165, 425.45006033757835, 230.24080440584027, 322.45370766460206, 131.47224570368573, 514.4873243803437, 355.7691891877739, 508.69256757200384, 371.37576352613377, 345.915849526407, 536.3890690909753, 359.64070117123714, 449.42926952431435, 0.0, 373.12912182311265, 496.0499023042011, 346.95734577867137, 313.3226487386308, 320.83239216104016, 455.6668919185755, 508.5137025778377, 371.28380540359126, 404.4118873908561, 368.18784083327284, 0.0, 401.20267426795255, 346.44396645576285, 408.2390375850989, 422.1622171455978, 449.17792799606246, 407.0244266443711, 398.5048952764547, 357.40342302576335, 330.2656763653447, 444.2092738551819, 343.5920627546349, 401.80063084364843, 303.73651604976277, 341.0805831468285, 377.401823237299, 300.68791497428896, 380.5416439824431, 405.5906709677875, 267.9435654356827, 406.00031892779054, 509.3257587485011]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.080089654911782, "mean_inference_ms": 84.81213136744722, "mean_action_processing_ms": 3.3044955412757555, "mean_env_wait_ms": 5.073630244102142, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005117058753967285, "StateBufferConnector_ms": 0.0037424564361572266, "ViewRequirementAgentConnector_ms": 0.11604714393615723}, "num_episodes": 18, "episode_return_max": 377.5767050508096, "episode_return_min": -55.28790576756731, "episode_return_mean": 95.46960517876225, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1264000, "num_agent_steps_trained": 1264000, "num_env_steps_sampled": 316000, "num_env_steps_trained": 316000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 29.461240243348502, "num_env_steps_trained_throughput_per_sec": 29.461240243348502, "timesteps_total": 316000, "num_env_steps_sampled_lifetime": 316000, "num_agent_steps_sampled_lifetime": 1264000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1264000, "timers": {"training_iteration_time_ms": 1552012.596, "restore_workers_time_ms": 0.018, "training_step_time_ms": 1552012.525, "sample_time_ms": 2166.353, "learn_time_ms": 1549823.186, "learn_throughput": 2.581, "synch_weights_time_ms": 17.321}, "counters": {"num_env_steps_sampled": 316000, "num_env_steps_trained": 316000, "num_agent_steps_sampled": 1264000, "num_agent_steps_trained": 1264000}, "done": false, "training_iteration": 79, "trial_id": "b941d_00000", "date": "2024-08-19_08-43-52", "timestamp": 1724037232, "time_this_iter_s": 135.82789778709412, "time_total_s": 175795.16358733177, "pid": 81115, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[32, [4, 4], 2], [64, [3, 3], 2], [128, [3, 3], 1]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [256, 256], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b29caa60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 175795.16358733177, "iterations_since_restore": 79, "perf": {"cpu_util_percent": 24.8860103626943, "ram_util_percent": 81.58290155440415}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 11.573288994996005, "cur_kl_coeff": 1.5187500000000005, "cur_lr": 0.00010000000000000003, "total_loss": 8.99417667287998, "policy_loss": -0.0924249157982154, "vf_loss": 9.063628990435726, "vf_explained_var": -0.14182543883878718, "kl": 0.015125984918171256, "entropy": 0.9477651705186834, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 150255.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 15.899680351012599, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.00010000000000000003, "total_loss": 9.368312669178795, "policy_loss": -0.08805775375563711, "vf_loss": 9.440255617716955, "vf_explained_var": -0.8298166352605063, "kl": 0.015915840967986546, "entropy": 0.7828992631069567, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 150255.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 320000, "num_env_steps_trained": 320000, "num_agent_steps_sampled": 1280000, "num_agent_steps_trained": 1280000}, "env_runners": {"episode_reward_max": 377.5767050508096, "episode_reward_min": -55.28790576756731, "episode_reward_mean": 98.42174692249642, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -550.9348864476193, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 575.5977159565374}, "policy_reward_mean": {"prey_policy": -316.06670794513224, "predator_policy": 365.27758140638036}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-23.683165079356076, 3.3645792794773657, 1.199999999999997, 192.97648803567114, 300.0073300321879, 170.1032270371045, 26.79294682735099, 371.61604428919253, 67.66771858116945, 9.842466871819934, 234.3299999999997, 143.4663011645095, 279.6469933213759, 214.93421220856703, 180.6016161299588, 78.9334845455748, -0.5307164705240877, 275.62180125947293, 24.90805992490017, 140.469372221949, 76.84250288626232, 8.341483254301838, 21.954351880464685, 3.839999999999962, 123.57028330659949, 0.11999999999999589, 76.72403352478557, 128.28305592355304, 0.26000000000000134, -15.391612240989954, 8.343248216286986, 35.681434831081646, -55.28790576756731, 57.261055382484926, 56.2307879447263, -7.0615947113536945, 377.5767050508096, 188.2251201189355, 341.02716150956473, -0.07396264298273136, 132.18, 117.6847311083177, 11.571309520316412, 220.63216442230276, 245.95673920082638, 257.7601377927281, 6.420233067665752, 70.68663684980532, 248.59571642922114, 57.267355202572865, 214.17601213839694, 86.74, 226.89877619674584, 352.6575982280071, 148.1463833209835, 333.13334677405487, 311.0990328422082, 129.85219367278117, 55.15962352128843, 91.57532499566551, 7.002458165787081, 200.4999999999998, 0.10999999999999654, 168.24384372479864, 18.095524895441898, 0.11999999999999433, 64.55199383535688, 189.15999999999997, 0.5742170334840315, 5.040000000000003, -29.321681305000617, 262.5908952675571, 15.783746775804254, 3.240000000000003, 25.96541945321848, 19.368769751943006, 162.81858894757733, 21.973734252876085, 130.40297877697375, -23.814053039966907, 3.7980339887498893, 145.9133361060977, -38.86604160438411, 5.841246457139669, 261.2410230176468, 18.05995720984629, 63.425654721884676, -3.389548169062067, 107.24633554256506, 11.727490325885537, 0.13000000000000078, 2.6622330470336255, 0.21999999999999975, 252.0576431712402, 32.18060355275783, 29.18757021866152, 23.99855521916456, 89.13856560451048, 85.53737337280133, 72.72999999999998], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-328.3410247846042, -497.70967987712413, -422.1840666316443, -457.8918322023913, -367.0074378751497, -416.23685514171314, -521.2273655658317, 52.40736838036401, 124.35348813381977, -396.0623688831403, 2.0000000000000013, -515.5610316904892, -354.9896377657169, -343.4098328231072, 106.07314473487315, -464.5137673883434, -244.25103606841543, -380.55653881091763, -326.793324833546, -433.18456674102663, 196.21997051510073, -299.07315725606566, -226.3743479029625, -323.67507031295804, -50.015968776586334, -514.1320861173509, -108.3950010071299, -496.4141075091423, -122.32815574409116, -377.8886682930756, -306.5052628463308, -206.84813978065853, -473.2202706955283, -428.5999259438266, 147.21272263323365, -425.76351121974454, -401.62365429029654, -424.7774951603572, -383.4519707974657, -193.86938215752906, -199.09016357971672, -313.78965621845674, -494.4916092186713, -112.44468014894873, -408.66459968414404, -373.6069493432545, -14.162001030962577, 2.0000000000000013, -361.24657154149514, -360.11928180911804, -514.6481727783035, -447.5106902759638, -220.55588837415493, -496.0526878359364, -245.86933804765644, -425.68910697161084, -402.5966099916889, -437.90922601422534, -465.6491749278615, -396.06868470763095, -427.6119057661465, -333.4785419003196, -401.8564148634448, -283.730994293722, -266.10551714924225, -457.44818515149007, -418.79611246691707, -201.83522527215194, -534.4794517942657, -317.69850788625166, -418.1120838356981, -370.3144059203912, 145.2932689003141, -449.1258066336088, -106.98411523374251, -550.9348864476193, -395.41309435857045, 186.63740894523448, -503.7281767288093, -504.30261576087645, -201.3870993390749, -99.70012763931038, -236.41021275675453, -469.35511274769993, -299.88374993732907, -455.1622847454969, -15.576676207025855, -448.09450333278517, 29.04867904000777, -439.38749474953477, 37.94247339343286, -287.2070243354651, -326.0758229416047, -422.7915266753773, -204.03474649824585, -428.3133739023019, -259.48050361728684, -92.74872071634465, -296.13560114515514, -388.05078026543026, -440.51426784810525, -23.432875179709228, -135.33864742206526, -343.30935487223604, -90.54447065976126, -474.4853048020649, 30.10297613696406, -452.7906357639069, -323.74815784415034, -393.27426283732945, -20.474790295829848, -506.08454690569545, 188.12, -429.7154792282338, -179.77668396554117, -336.3306924457072, -310.6187303184853, -498.68340292000386, -256.93517670839424, -368.7811113484809, -405.7259004061157, -483.3014116903097, -448.9292695243148, 200.0, -373.02912182311275, -496.0399023042011, -419.95119059746446, -72.0849601950381, -307.63011677503533, -450.77364240913863, -508.5037025778377, -371.17380540359136, -397.4142867565842, -310.6334476321882, 189.11, -401.1526742679526, -349.00803920793936, -405.1007477994385, -420.14221714559784, -446.1579279960625, -412.2325477665089, -422.6184554593174, -33.41135673582578, -391.66684738772506, -426.76012679624796, -345.25746303776475, -398.6306308436486, -303.66651604976283, -347.38978386628827, -345.1272030646209, -292.2832294406235, -369.5775597641663, -421.85442730617154, -88.86122014972162, -380.8136484248058, -512.5386949986099, -274.14276726491147, -462.9870739829365, -491.4985364998577, -490.06561128172376, -477.2835436496361, -303.2810246899123, -313.0948841991304, -201.2375931603451, -410.59067530895277, -393.6331005889513, -405.5078867808744, -465.7642114321985, -481.8392117272123, -24.114723863373754, -388.15472513765786, -484.35204423443685, -355.5315138398265, -288.02380526558227, -399.7145402853997, -266.30766303659664, -294.8350531837367, -132.36676298823568, -434.77026691128106, -492.6816960733935, -468.356695034651, -366.59762993653766, -272.76423987531126, -431.23083977835233, -287.9015354024038, -389.00124245066496, -345.5646220854039, -48.65576922914205, -419.3746950305094, -364.37287767229856, -374.3389210609447, -185.61627157880767, -526.9349954888174, -347.47625890628973, -163.32801272445326, -507.13711037214864, -451.4821204704514, -297.64615413778796, -348.7236710987905, -142.50680674086988], "policy_predator_policy_reward": [318.8569557823291, 483.51058380004275, 418.2485121571273, 465.1919659563855, 368.1574378751496, 416.2868551417131, 485.49918800098465, 176.2972972201541, 231.92850885224894, 339.7877019292594, 216.72894635458138, 466.93531237301266, 345.8672515819465, 379.3251658342281, 388.82443623203, 341.23223071063245, 189.01236527209164, 503.46292818841056, 420.08176274167585, 349.7385957047164, 0.8000294848992703, 336.3831572560654, 339.19205881994094, 354.32366056048915, 377.1210910424432, 466.6739571728701, 357.2920255081753, 462.45129521666405, 315.76949195692373, 365.0489482102017, 280.98144784102095, 311.30543933154223, 474.4868093785893, 426.80267079024134, 410.3404639674306, 143.83212587855334, 379.61944487214015, 471.6897645034134, 350.69157980540297, 367.0991453715401, 289.8456040358176, 299.8767186486179, 97.23740288492628, 518.0403697369965, 400.4987972444939, 403.72710366336895, 16.00200103096254, 0.0, 462.5320213303911, 382.40411532682145, 514.7081727783035, 447.5706902759637, 347.2470989105796, 446.0855108242966, 409.2612206723647, 390.5802802704552, 402.68660999168884, 438.0792260142252, 473.99035269635743, 372.3358946981448, 437.16286048559647, 332.27083539715665, 408.0023413006321, 313.266502687616, 320.09729389550364, 348.168502637661, 433.44743616760707, 244.44495695394642, 502.2601796669354, 406.1485679583079, 450.41671398213373, 330.94818106260163, 331.99875352022514, 349.4104892638791, 357.4316223173978, 488.7124994828997, 311.181356395476, 238.62149052742478, 505.8693029136112, 502.0875269330916, 237.4870993390748, 195.7801276393103, 393.1130434517643, 430.3370131610077, 409.5881311197927, 357.02921308334965, 304.9561476250778, 379.3471963370357, 283.29498203377193, 373.00057287658126, 150.65670088393216, 356.36798785082794, 329.4960560092702, 425.7915266753773, 399.8348295210559, 303.1999277292965, 260.14107217069306, 340.6838685921594, 350.75107217550305, 390.70266443765513, 390.4827416542024, 287.64041351200945, 386.8414123358064, 178.54658995849425, 376.94372216363297, 414.9848294949393, 384.13530601910793, 391.2099518358421, 425.3529166356293, 439.8158873668328, 434.24262363800165, 425.45006033757835, 230.24080440584027, 322.45370766460206, 131.47224570368573, 514.4873243803437, 355.7691891877739, 508.69256757200384, 371.37576352613377, 345.915849526407, 536.3890690909753, 359.64070117123714, 449.42926952431435, 0.0, 373.12912182311265, 496.0499023042011, 346.95734577867137, 313.3226487386308, 320.83239216104016, 455.6668919185755, 508.5137025778377, 371.28380540359126, 404.4118873908561, 368.18784083327284, 0.0, 401.20267426795255, 346.44396645576285, 408.2390375850989, 422.1622171455978, 449.17792799606246, 407.0244266443711, 398.5048952764547, 357.40342302576335, 330.2656763653447, 444.2092738551819, 343.5920627546349, 401.80063084364843, 303.73651604976277, 341.0805831468285, 377.401823237299, 300.68791497428896, 380.5416439824431, 405.5906709677875, 267.9435654356827, 406.00031892779054, 509.3257587485011, 453.5371328334035, 413.9956871914182, 575.5977159565374, 382.1523787850774, 482.6150786195118, 301.7475237087861, 356.8798872979761, 303.36592616759754, 342.6589379498629, 422.6987963436567, 402.2297362066947, 474.88360846351765, 392.8469087431537, 374.3480498650797, 371.462521146683, 519.1042054352579, 367.6950382514526, 339.28593557583997, 382.4215621267097, 280.211093026224, 283.6360490044371, 250.81210271010016, 482.38397284913594, 456.7954804614243, 468.41669503465096, 366.6676299365376, 274.41647292234455, 432.2408397783524, 288.0815354024037, 389.041242450665, 304.08764190599993, 342.19039257978585, 393.160524423583, 422.76765183198256, 323.2546633890504, 265.88809946936306, 524.9771824215661, 373.4326271927053, 334.04286888075484, 425.56081982035596, 420.67794644763325, 413.98770153340604, 350.1175545752732, 213.84292326438649]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.154375525300472, "mean_inference_ms": 83.36639184039481, "mean_action_processing_ms": 3.269308762422189, "mean_env_wait_ms": 5.4404330846149485, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005062222480773926, "StateBufferConnector_ms": 0.003634214401245117, "ViewRequirementAgentConnector_ms": 0.11482465267181396}, "num_episodes": 22, "episode_return_max": 377.5767050508096, "episode_return_min": -55.28790576756731, "episode_return_mean": 98.42174692249642, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1280000, "num_agent_steps_trained": 1280000, "num_env_steps_sampled": 320000, "num_env_steps_trained": 320000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 29.816476008186537, "num_env_steps_trained_throughput_per_sec": 29.816476008186537, "timesteps_total": 320000, "num_env_steps_sampled_lifetime": 320000, "num_agent_steps_sampled_lifetime": 1280000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1280000, "timers": {"training_iteration_time_ms": 1034970.531, "restore_workers_time_ms": 0.017, "training_step_time_ms": 1034970.46, "sample_time_ms": 2168.017, "learn_time_ms": 1032780.305, "learn_throughput": 3.873, "synch_weights_time_ms": 17.082}, "counters": {"num_env_steps_sampled": 320000, "num_env_steps_trained": 320000, "num_agent_steps_sampled": 1280000, "num_agent_steps_trained": 1280000}, "done": false, "training_iteration": 80, "trial_id": "b941d_00000", "date": "2024-08-19_08-46-06", "timestamp": 1724037366, "time_this_iter_s": 134.18430709838867, "time_total_s": 175929.34789443016, "pid": 81115, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[32, [4, 4], 2], [64, [3, 3], 2], [128, [3, 3], 1]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [256, 256], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b29ca670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 175929.34789443016, "iterations_since_restore": 80, "perf": {"cpu_util_percent": 24.22041884816754, "ram_util_percent": 81.32984293193718}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 15.052207782091918, "cur_kl_coeff": 1.5187500000000005, "cur_lr": 0.00010000000000000003, "total_loss": 8.531301517839784, "policy_loss": -0.08653270177094749, "vf_loss": 8.596202295797843, "vf_explained_var": 0.10267033545428483, "kl": 0.014243248672606214, "entropy": 0.9151807092169605, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 152145.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 16.21814976394492, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.00010000000000000003, "total_loss": 9.133268161047072, "policy_loss": -0.08786901564943413, "vf_loss": 9.20380530735803, "vf_explained_var": -0.6226285479686878, "kl": 0.017117887875798578, "entropy": 0.7968349362807299, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 152145.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_agent_steps_sampled": 1296000, "num_agent_steps_trained": 1296000}, "env_runners": {"episode_reward_max": 377.5767050508096, "episode_reward_min": -55.28790576756731, "episode_reward_mean": 85.73259108481311, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -619.1250197338517, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 620.3150197338515}, "policy_reward_mean": {"prey_policy": -324.7301298291044, "predator_policy": 367.59642537151086}, "custom_metrics": {}, "hist_stats": {"episode_reward": [24.90805992490017, 140.469372221949, 76.84250288626232, 8.341483254301838, 21.954351880464685, 3.839999999999962, 123.57028330659949, 0.11999999999999589, 76.72403352478557, 128.28305592355304, 0.26000000000000134, -15.391612240989954, 8.343248216286986, 35.681434831081646, -55.28790576756731, 57.261055382484926, 56.2307879447263, -7.0615947113536945, 377.5767050508096, 188.2251201189355, 341.02716150956473, -0.07396264298273136, 132.18, 117.6847311083177, 11.571309520316412, 220.63216442230276, 245.95673920082638, 257.7601377927281, 6.420233067665752, 70.68663684980532, 248.59571642922114, 57.267355202572865, 214.17601213839694, 86.74, 226.89877619674584, 352.6575982280071, 148.1463833209835, 333.13334677405487, 311.0990328422082, 129.85219367278117, 55.15962352128843, 91.57532499566551, 7.002458165787081, 200.4999999999998, 0.10999999999999654, 168.24384372479864, 18.095524895441898, 0.11999999999999433, 64.55199383535688, 189.15999999999997, 0.5742170334840315, 5.040000000000003, -29.321681305000617, 262.5908952675571, 15.783746775804254, 3.240000000000003, 25.96541945321848, 19.368769751943006, 162.81858894757733, 21.973734252876085, 130.40297877697375, -23.814053039966907, 3.7980339887498893, 145.9133361060977, -38.86604160438411, 5.841246457139669, 261.2410230176468, 18.05995720984629, 63.425654721884676, -3.389548169062067, 107.24633554256506, 11.727490325885537, 0.13000000000000078, 2.6622330470336255, 0.21999999999999975, 252.0576431712402, 32.18060355275783, 29.18757021866152, 23.99855521916456, 89.13856560451048, 85.53737337280133, 72.72999999999998, 91.37413346151497, 235.5449433504576, 133.80694442932108, 12.559999999999993, 1.1599999999999993, -54.2788496133842, 47.75456139812053, 232.71145310231717, -5.081193112472487, 24.351665607198285, 75.10819464544494, 38.9997670281546, 7.166831644714316, 73.56253671348426, 100.39035249582678, 68.22, 176.44481407103308, -1.8204109565076965], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-401.62365429029654, -424.7774951603572, -383.4519707974657, -193.86938215752906, -199.09016357971672, -313.78965621845674, -494.4916092186713, -112.44468014894873, -408.66459968414404, -373.6069493432545, -14.162001030962577, 2.0000000000000013, -361.24657154149514, -360.11928180911804, -514.6481727783035, -447.5106902759638, -220.55588837415493, -496.0526878359364, -245.86933804765644, -425.68910697161084, -402.5966099916889, -437.90922601422534, -465.6491749278615, -396.06868470763095, -427.6119057661465, -333.4785419003196, -401.8564148634448, -283.730994293722, -266.10551714924225, -457.44818515149007, -418.79611246691707, -201.83522527215194, -534.4794517942657, -317.69850788625166, -418.1120838356981, -370.3144059203912, 145.2932689003141, -449.1258066336088, -106.98411523374251, -550.9348864476193, -395.41309435857045, 186.63740894523448, -503.7281767288093, -504.30261576087645, -201.3870993390749, -99.70012763931038, -236.41021275675453, -469.35511274769993, -299.88374993732907, -455.1622847454969, -15.576676207025855, -448.09450333278517, 29.04867904000777, -439.38749474953477, 37.94247339343286, -287.2070243354651, -326.0758229416047, -422.7915266753773, -204.03474649824585, -428.3133739023019, -259.48050361728684, -92.74872071634465, -296.13560114515514, -388.05078026543026, -440.51426784810525, -23.432875179709228, -135.33864742206526, -343.30935487223604, -90.54447065976126, -474.4853048020649, 30.10297613696406, -452.7906357639069, -323.74815784415034, -393.27426283732945, -20.474790295829848, -506.08454690569545, 188.12, -429.7154792282338, -179.77668396554117, -336.3306924457072, -310.6187303184853, -498.68340292000386, -256.93517670839424, -368.7811113484809, -405.7259004061157, -483.3014116903097, -448.9292695243148, 200.0, -373.02912182311275, -496.0399023042011, -419.95119059746446, -72.0849601950381, -307.63011677503533, -450.77364240913863, -508.5037025778377, -371.17380540359136, -397.4142867565842, -310.6334476321882, 189.11, -401.1526742679526, -349.00803920793936, -405.1007477994385, -420.14221714559784, -446.1579279960625, -412.2325477665089, -422.6184554593174, -33.41135673582578, -391.66684738772506, -426.76012679624796, -345.25746303776475, -398.6306308436486, -303.66651604976283, -347.38978386628827, -345.1272030646209, -292.2832294406235, -369.5775597641663, -421.85442730617154, -88.86122014972162, -380.8136484248058, -512.5386949986099, -274.14276726491147, -462.9870739829365, -491.4985364998577, -490.06561128172376, -477.2835436496361, -303.2810246899123, -313.0948841991304, -201.2375931603451, -410.59067530895277, -393.6331005889513, -405.5078867808744, -465.7642114321985, -481.8392117272123, -24.114723863373754, -388.15472513765786, -484.35204423443685, -355.5315138398265, -288.02380526558227, -399.7145402853997, -266.30766303659664, -294.8350531837367, -132.36676298823568, -434.77026691128106, -492.6816960733935, -468.356695034651, -366.59762993653766, -272.76423987531126, -431.23083977835233, -287.9015354024038, -389.00124245066496, -345.5646220854039, -48.65576922914205, -419.3746950305094, -364.37287767229856, -374.3389210609447, -185.61627157880767, -526.9349954888174, -347.47625890628973, -163.32801272445326, -507.13711037214864, -451.4821204704514, -297.64615413778796, -348.7236710987905, -142.50680674086988, -316.0105350521545, -335.7872900793253, -381.9443749677831, 41.886470552994666, -423.36402661115494, -157.7722206678964, -619.1250197338517, -289.6654951887205, -429.1030126776398, -427.8748216087764, -350.2122161782427, -345.30938223065743, -493.4024924471332, -259.2094559351542, -340.1183251579726, -7.530712294540384, -415.51897442137124, -323.944300692644, -342.7261306910114, -353.8735080733136, -252.51245545109015, -374.52332358064774, -562.3260955595679, -244.34782704951743, -262.1814950603598, -362.96288485240234, -301.4713027009594, -372.4171113926211, -528.8546625057603, -272.15512733936623, -355.9739547754699, -144.2561850588644, -42.823799184161274, -490.59013026611524, -324.1215988594681, -471.4479450929375], "policy_predator_policy_reward": [379.61944487214015, 471.6897645034134, 350.69157980540297, 367.0991453715401, 289.8456040358176, 299.8767186486179, 97.23740288492628, 518.0403697369965, 400.4987972444939, 403.72710366336895, 16.00200103096254, 0.0, 462.5320213303911, 382.40411532682145, 514.7081727783035, 447.5706902759637, 347.2470989105796, 446.0855108242966, 409.2612206723647, 390.5802802704552, 402.68660999168884, 438.0792260142252, 473.99035269635743, 372.3358946981448, 437.16286048559647, 332.27083539715665, 408.0023413006321, 313.266502687616, 320.09729389550364, 348.168502637661, 433.44743616760707, 244.44495695394642, 502.2601796669354, 406.1485679583079, 450.41671398213373, 330.94818106260163, 331.99875352022514, 349.4104892638791, 357.4316223173978, 488.7124994828997, 311.181356395476, 238.62149052742478, 505.8693029136112, 502.0875269330916, 237.4870993390748, 195.7801276393103, 393.1130434517643, 430.3370131610077, 409.5881311197927, 357.02921308334965, 304.9561476250778, 379.3471963370357, 283.29498203377193, 373.00057287658126, 150.65670088393216, 356.36798785082794, 329.4960560092702, 425.7915266753773, 399.8348295210559, 303.1999277292965, 260.14107217069306, 340.6838685921594, 350.75107217550305, 390.70266443765513, 390.4827416542024, 287.64041351200945, 386.8414123358064, 178.54658995849425, 376.94372216363297, 414.9848294949393, 384.13530601910793, 391.2099518358421, 425.3529166356293, 439.8158873668328, 434.24262363800165, 425.45006033757835, 230.24080440584027, 322.45370766460206, 131.47224570368573, 514.4873243803437, 355.7691891877739, 508.69256757200384, 371.37576352613377, 345.915849526407, 536.3890690909753, 359.64070117123714, 449.42926952431435, 0.0, 373.12912182311265, 496.0499023042011, 346.95734577867137, 313.3226487386308, 320.83239216104016, 455.6668919185755, 508.5137025778377, 371.28380540359126, 404.4118873908561, 368.18784083327284, 0.0, 401.20267426795255, 346.44396645576285, 408.2390375850989, 422.1622171455978, 449.17792799606246, 407.0244266443711, 398.5048952764547, 357.40342302576335, 330.2656763653447, 444.2092738551819, 343.5920627546349, 401.80063084364843, 303.73651604976277, 341.0805831468285, 377.401823237299, 300.68791497428896, 380.5416439824431, 405.5906709677875, 267.9435654356827, 406.00031892779054, 509.3257587485011, 453.5371328334035, 413.9956871914182, 575.5977159565374, 382.1523787850774, 482.6150786195118, 301.7475237087861, 356.8798872979761, 303.36592616759754, 342.6589379498629, 422.6987963436567, 402.2297362066947, 474.88360846351765, 392.8469087431537, 374.3480498650797, 371.462521146683, 519.1042054352579, 367.6950382514526, 339.28593557583997, 382.4215621267097, 280.211093026224, 283.6360490044371, 250.81210271010016, 482.38397284913594, 456.7954804614243, 468.41669503465096, 366.6676299365376, 274.41647292234455, 432.2408397783524, 288.0815354024037, 389.041242450665, 304.08764190599993, 342.19039257978585, 393.160524423583, 422.76765183198256, 323.2546633890504, 265.88809946936306, 524.9771824215661, 373.4326271927053, 334.04286888075484, 425.56081982035596, 420.67794644763325, 413.98770153340604, 350.1175545752732, 213.84292326438649, 444.92028604242466, 298.25167255056925, 291.429437388951, 284.173410376295, 423.5990688410365, 291.3441228673355, 620.3150197338515, 301.0354951887205, 430.1230126776398, 428.0148216087764, 422.49678690996586, 218.74596188554983, 444.39423969681087, 355.9722700835966, 305.4677995229093, 274.8926910319217, 406.8959844054646, 327.48609759607814, 345.48045389042085, 375.47085048110233, 364.79402836752354, 337.34994530965884, 546.2072515108255, 299.4664381264139, 261.86912658132815, 370.44208497614807, 314.7599899787206, 432.6909608283434, 468.72768393829034, 432.6724584026616, 356.03395477546985, 212.41618505886424, 265.38408976520117, 444.474653756108, 324.26097443475703, 469.4881585611407]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.9246405009323375, "mean_inference_ms": 82.76452608406841, "mean_action_processing_ms": 3.234377288058626, "mean_env_wait_ms": 4.940170757998532, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005060434341430664, "StateBufferConnector_ms": 0.003582000732421875, "ViewRequirementAgentConnector_ms": 0.1140587329864502}, "num_episodes": 18, "episode_return_max": 377.5767050508096, "episode_return_min": -55.28790576756731, "episode_return_mean": 85.73259108481311, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1296000, "num_agent_steps_trained": 1296000, "num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 29.26515321297487, "num_env_steps_trained_throughput_per_sec": 29.26515321297487, "timesteps_total": 324000, "num_env_steps_sampled_lifetime": 324000, "num_agent_steps_sampled_lifetime": 1296000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1296000, "timers": {"training_iteration_time_ms": 1012186.733, "restore_workers_time_ms": 0.017, "training_step_time_ms": 1012186.674, "sample_time_ms": 2177.274, "learn_time_ms": 1009987.556, "learn_throughput": 3.96, "synch_weights_time_ms": 16.762}, "counters": {"num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_agent_steps_sampled": 1296000, "num_agent_steps_trained": 1296000}, "done": false, "training_iteration": 81, "trial_id": "b941d_00000", "date": "2024-08-19_08-48-23", "timestamp": 1724037503, "time_this_iter_s": 136.72806191444397, "time_total_s": 176066.0759563446, "pid": 81115, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[32, [4, 4], 2], [64, [3, 3], 2], [128, [3, 3], 1]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [256, 256], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b042d940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 176066.0759563446, "iterations_since_restore": 81, "perf": {"cpu_util_percent": 26.47371134020619, "ram_util_percent": 82.0618556701031}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 15.841202977977732, "cur_kl_coeff": 1.5187500000000005, "cur_lr": 0.00010000000000000003, "total_loss": 8.619800053954755, "policy_loss": -0.08428888098317046, "vf_loss": 8.682664661306553, "vf_explained_var": 0.12657276265835635, "kl": 0.014106524431211605, "entropy": 0.9554640101692664, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 154035.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 17.586229295074624, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.00010000000000000003, "total_loss": 8.893384554272606, "policy_loss": -0.07759681447229234, "vf_loss": 8.95450052533831, "vf_explained_var": -0.5597282558837265, "kl": 0.016277357184397864, "entropy": 0.7448456879646059, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 154035.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 328000, "num_env_steps_trained": 328000, "num_agent_steps_sampled": 1312000, "num_agent_steps_trained": 1312000}, "env_runners": {"episode_reward_max": 442.1665510265595, "episode_reward_min": -54.2788496133842, "episode_reward_mean": 86.8883141079096, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -630.3390965540199, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 630.4290965540198}, "policy_reward_mean": {"prey_policy": -322.1048485889381, "predator_policy": 365.5490056428927}, "custom_metrics": {}, "hist_stats": {"episode_reward": [117.6847311083177, 11.571309520316412, 220.63216442230276, 245.95673920082638, 257.7601377927281, 6.420233067665752, 70.68663684980532, 248.59571642922114, 57.267355202572865, 214.17601213839694, 86.74, 226.89877619674584, 352.6575982280071, 148.1463833209835, 333.13334677405487, 311.0990328422082, 129.85219367278117, 55.15962352128843, 91.57532499566551, 7.002458165787081, 200.4999999999998, 0.10999999999999654, 168.24384372479864, 18.095524895441898, 0.11999999999999433, 64.55199383535688, 189.15999999999997, 0.5742170334840315, 5.040000000000003, -29.321681305000617, 262.5908952675571, 15.783746775804254, 3.240000000000003, 25.96541945321848, 19.368769751943006, 162.81858894757733, 21.973734252876085, 130.40297877697375, -23.814053039966907, 3.7980339887498893, 145.9133361060977, -38.86604160438411, 5.841246457139669, 261.2410230176468, 18.05995720984629, 63.425654721884676, -3.389548169062067, 107.24633554256506, 11.727490325885537, 0.13000000000000078, 2.6622330470336255, 0.21999999999999975, 252.0576431712402, 32.18060355275783, 29.18757021866152, 23.99855521916456, 89.13856560451048, 85.53737337280133, 72.72999999999998, 91.37413346151497, 235.5449433504576, 133.80694442932108, 12.559999999999993, 1.1599999999999993, -54.2788496133842, 47.75456139812053, 232.71145310231717, -5.081193112472487, 24.351665607198285, 75.10819464544494, 38.9997670281546, 7.166831644714316, 73.56253671348426, 100.39035249582678, 68.22, 176.44481407103308, -1.8204109565076965, 342.69299162540517, 59.94115478230466, 141.34000000000006, 32.66623873820355, 20.717970288804665, 192.99502629492204, 149.73134642649728, 3.179999999999998, -0.08405481377117052, 101.47611652351686, 25.693409944627607, 442.1665510265595, -5.912944591984285, 0.5299999999999998, -0.6844030759947506, -0.10526309176466064, -1.445800941716268, 197.1353163813962, 27.238294755312673, 11.992102599662676, 96.01183005147729, 0.0799999999999963, 2.239999999999994], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-236.41021275675453, -469.35511274769993, -299.88374993732907, -455.1622847454969, -15.576676207025855, -448.09450333278517, 29.04867904000777, -439.38749474953477, 37.94247339343286, -287.2070243354651, -326.0758229416047, -422.7915266753773, -204.03474649824585, -428.3133739023019, -259.48050361728684, -92.74872071634465, -296.13560114515514, -388.05078026543026, -440.51426784810525, -23.432875179709228, -135.33864742206526, -343.30935487223604, -90.54447065976126, -474.4853048020649, 30.10297613696406, -452.7906357639069, -323.74815784415034, -393.27426283732945, -20.474790295829848, -506.08454690569545, 188.12, -429.7154792282338, -179.77668396554117, -336.3306924457072, -310.6187303184853, -498.68340292000386, -256.93517670839424, -368.7811113484809, -405.7259004061157, -483.3014116903097, -448.9292695243148, 200.0, -373.02912182311275, -496.0399023042011, -419.95119059746446, -72.0849601950381, -307.63011677503533, -450.77364240913863, -508.5037025778377, -371.17380540359136, -397.4142867565842, -310.6334476321882, 189.11, -401.1526742679526, -349.00803920793936, -405.1007477994385, -420.14221714559784, -446.1579279960625, -412.2325477665089, -422.6184554593174, -33.41135673582578, -391.66684738772506, -426.76012679624796, -345.25746303776475, -398.6306308436486, -303.66651604976283, -347.38978386628827, -345.1272030646209, -292.2832294406235, -369.5775597641663, -421.85442730617154, -88.86122014972162, -380.8136484248058, -512.5386949986099, -274.14276726491147, -462.9870739829365, -491.4985364998577, -490.06561128172376, -477.2835436496361, -303.2810246899123, -313.0948841991304, -201.2375931603451, -410.59067530895277, -393.6331005889513, -405.5078867808744, -465.7642114321985, -481.8392117272123, -24.114723863373754, -388.15472513765786, -484.35204423443685, -355.5315138398265, -288.02380526558227, -399.7145402853997, -266.30766303659664, -294.8350531837367, -132.36676298823568, -434.77026691128106, -492.6816960733935, -468.356695034651, -366.59762993653766, -272.76423987531126, -431.23083977835233, -287.9015354024038, -389.00124245066496, -345.5646220854039, -48.65576922914205, -419.3746950305094, -364.37287767229856, -374.3389210609447, -185.61627157880767, -526.9349954888174, -347.47625890628973, -163.32801272445326, -507.13711037214864, -451.4821204704514, -297.64615413778796, -348.7236710987905, -142.50680674086988, -316.0105350521545, -335.7872900793253, -381.9443749677831, 41.886470552994666, -423.36402661115494, -157.7722206678964, -619.1250197338517, -289.6654951887205, -429.1030126776398, -427.8748216087764, -350.2122161782427, -345.30938223065743, -493.4024924471332, -259.2094559351542, -340.1183251579726, -7.530712294540384, -415.51897442137124, -323.944300692644, -342.7261306910114, -353.8735080733136, -252.51245545109015, -374.52332358064774, -562.3260955595679, -244.34782704951743, -262.1814950603598, -362.96288485240234, -301.4713027009594, -372.4171113926211, -528.8546625057603, -272.15512733936623, -355.9739547754699, -144.2561850588644, -42.823799184161274, -490.59013026611524, -324.1215988594681, -471.4479450929375, -314.68184494097005, 158.31675665337247, -431.40048766320115, -394.03490200295636, -406.5854765790607, 30.409218348691027, -364.23406948872145, -334.4384406705032, -429.20192349659226, -350.1236284517539, 46.513879720760116, -347.2294777493748, -149.87231844844047, -517.9571086498796, -395.2659910814347, -630.3390965540199, -358.0793479170413, -414.4756561729776, -355.95643796585205, -99.97677374758521, -235.17307128376368, -332.25580527338985, 66.04263675849707, -581.9023710746426, -280.85900611762304, -255.3259019156314, -365.87965106588365, -294.18710062471706, -410.14289339876956, -374.47249229579637, -375.25142222658945, -334.725645262027, -295.9095564229718, -337.4669615728478, -284.54384598601325, -81.4174767571632, -421.47003535318925, -269.95436238201887, -398.1703732994508, -349.5113658879474, -197.71704254228737, -394.7877228151001, -401.2468890277571, -440.35288541636777, -365.0684966537952, -407.5810727135043], "policy_predator_policy_reward": [393.1130434517643, 430.3370131610077, 409.5881311197927, 357.02921308334965, 304.9561476250778, 379.3471963370357, 283.29498203377193, 373.00057287658126, 150.65670088393216, 356.36798785082794, 329.4960560092702, 425.7915266753773, 399.8348295210559, 303.1999277292965, 260.14107217069306, 340.6838685921594, 350.75107217550305, 390.70266443765513, 390.4827416542024, 287.64041351200945, 386.8414123358064, 178.54658995849425, 376.94372216363297, 414.9848294949393, 384.13530601910793, 391.2099518358421, 425.3529166356293, 439.8158873668328, 434.24262363800165, 425.45006033757835, 230.24080440584027, 322.45370766460206, 131.47224570368573, 514.4873243803437, 355.7691891877739, 508.69256757200384, 371.37576352613377, 345.915849526407, 536.3890690909753, 359.64070117123714, 449.42926952431435, 0.0, 373.12912182311265, 496.0499023042011, 346.95734577867137, 313.3226487386308, 320.83239216104016, 455.6668919185755, 508.5137025778377, 371.28380540359126, 404.4118873908561, 368.18784083327284, 0.0, 401.20267426795255, 346.44396645576285, 408.2390375850989, 422.1622171455978, 449.17792799606246, 407.0244266443711, 398.5048952764547, 357.40342302576335, 330.2656763653447, 444.2092738551819, 343.5920627546349, 401.80063084364843, 303.73651604976277, 341.0805831468285, 377.401823237299, 300.68791497428896, 380.5416439824431, 405.5906709677875, 267.9435654356827, 406.00031892779054, 509.3257587485011, 453.5371328334035, 413.9956871914182, 575.5977159565374, 382.1523787850774, 482.6150786195118, 301.7475237087861, 356.8798872979761, 303.36592616759754, 342.6589379498629, 422.6987963436567, 402.2297362066947, 474.88360846351765, 392.8469087431537, 374.3480498650797, 371.462521146683, 519.1042054352579, 367.6950382514526, 339.28593557583997, 382.4215621267097, 280.211093026224, 283.6360490044371, 250.81210271010016, 482.38397284913594, 456.7954804614243, 468.41669503465096, 366.6676299365376, 274.41647292234455, 432.2408397783524, 288.0815354024037, 389.041242450665, 304.08764190599993, 342.19039257978585, 393.160524423583, 422.76765183198256, 323.2546633890504, 265.88809946936306, 524.9771824215661, 373.4326271927053, 334.04286888075484, 425.56081982035596, 420.67794644763325, 413.98770153340604, 350.1175545752732, 213.84292326438649, 444.92028604242466, 298.25167255056925, 291.429437388951, 284.173410376295, 423.5990688410365, 291.3441228673355, 620.3150197338515, 301.0354951887205, 430.1230126776398, 428.0148216087764, 422.49678690996586, 218.74596188554983, 444.39423969681087, 355.9722700835966, 305.4677995229093, 274.8926910319217, 406.8959844054646, 327.48609759607814, 345.48045389042085, 375.47085048110233, 364.79402836752354, 337.34994530965884, 546.2072515108255, 299.4664381264139, 261.86912658132815, 370.44208497614807, 314.7599899787206, 432.6909608283434, 468.72768393829034, 432.6724584026616, 356.03395477546985, 212.41618505886424, 265.38408976520117, 444.474653756108, 324.26097443475703, 469.4881585611407, 271.9583141948278, 227.0997657181747, 419.27022882156416, 466.10631562689787, 404.0533698381341, 113.46288839223541, 346.58864591439544, 384.75010298303266, 401.3965804724215, 398.6469417647294, 229.1651844658725, 264.54543985766435, 317.61351682410395, 499.9472567007117, 398.35599108143464, 630.4290965540198, 358.2293479170412, 414.2416013592064, 356.1164379658519, 201.29289027110184, 277.39859148604177, 315.7236950157394, 421.6246611357379, 536.4016242069667, 125.25604174418343, 405.01592169708596, 366.1396510658834, 294.457100624717, 308.783318426636, 475.147664191935, 356.82670450784866, 353.0450998890034, 294.37375548125556, 337.5569615728478, 263.9724775062653, 299.12416161830674, 445.6102206972216, 273.0524717932989, 410.07247589911333, 349.60136588794734, 310.4308433469218, 378.08575206194337, 401.32688902775703, 440.35288541636777, 365.1884966537951, 409.7010727135043]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.257441651033857, "mean_inference_ms": 80.97085755371832, "mean_action_processing_ms": 3.461070486363178, "mean_env_wait_ms": 4.886971225782965, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004976034164428711, "StateBufferConnector_ms": 0.0035439729690551758, "ViewRequirementAgentConnector_ms": 0.11044347286224365}, "num_episodes": 23, "episode_return_max": 442.1665510265595, "episode_return_min": -54.2788496133842, "episode_return_mean": 86.8883141079096, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1312000, "num_agent_steps_trained": 1312000, "num_env_steps_sampled": 328000, "num_env_steps_trained": 328000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 30.259408402256245, "num_env_steps_trained_throughput_per_sec": 30.259408402256245, "timesteps_total": 328000, "num_env_steps_sampled_lifetime": 328000, "num_agent_steps_sampled_lifetime": 1312000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1312000, "timers": {"training_iteration_time_ms": 1008957.584, "restore_workers_time_ms": 0.017, "training_step_time_ms": 1008957.507, "sample_time_ms": 2165.377, "learn_time_ms": 1006770.239, "learn_throughput": 3.973, "synch_weights_time_ms": 16.93}, "counters": {"num_env_steps_sampled": 328000, "num_env_steps_trained": 328000, "num_agent_steps_sampled": 1312000, "num_agent_steps_trained": 1312000}, "done": false, "training_iteration": 82, "trial_id": "b941d_00000", "date": "2024-08-19_08-50-35", "timestamp": 1724037635, "time_this_iter_s": 132.24932098388672, "time_total_s": 176198.3252773285, "pid": 81115, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[32, [4, 4], 2], [64, [3, 3], 2], [128, [3, 3], 1]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [256, 256], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b29dc820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 176198.3252773285, "iterations_since_restore": 82, "perf": {"cpu_util_percent": 20.643617021276597, "ram_util_percent": 81.44946808510639}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 14.06647554982907, "cur_kl_coeff": 1.5187500000000005, "cur_lr": 0.00010000000000000003, "total_loss": 7.9272472858428955, "policy_loss": -0.08827030482004697, "vf_loss": 7.993893378878397, "vf_explained_var": 0.2384938833259401, "kl": 0.014238171951119991, "entropy": 0.9465189383143471, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 155925.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 17.048400219912253, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.00010000000000000003, "total_loss": 8.814638058596818, "policy_loss": -0.08706506651225032, "vf_loss": 8.883770456768218, "vf_explained_var": -0.35919683455790163, "kl": 0.01771127994070164, "entropy": 0.7541628361694397, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 155925.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 332000, "num_env_steps_trained": 332000, "num_agent_steps_sampled": 1328000, "num_agent_steps_trained": 1328000}, "env_runners": {"episode_reward_max": 442.1665510265595, "episode_reward_min": -54.2788496133842, "episode_reward_mean": 79.35337200981766, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -630.3390965540199, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 630.4290965540198}, "policy_reward_mean": {"prey_policy": -320.47440803214306, "predator_policy": 360.1510940370518}, "custom_metrics": {}, "hist_stats": {"episode_reward": [91.57532499566551, 7.002458165787081, 200.4999999999998, 0.10999999999999654, 168.24384372479864, 18.095524895441898, 0.11999999999999433, 64.55199383535688, 189.15999999999997, 0.5742170334840315, 5.040000000000003, -29.321681305000617, 262.5908952675571, 15.783746775804254, 3.240000000000003, 25.96541945321848, 19.368769751943006, 162.81858894757733, 21.973734252876085, 130.40297877697375, -23.814053039966907, 3.7980339887498893, 145.9133361060977, -38.86604160438411, 5.841246457139669, 261.2410230176468, 18.05995720984629, 63.425654721884676, -3.389548169062067, 107.24633554256506, 11.727490325885537, 0.13000000000000078, 2.6622330470336255, 0.21999999999999975, 252.0576431712402, 32.18060355275783, 29.18757021866152, 23.99855521916456, 89.13856560451048, 85.53737337280133, 72.72999999999998, 91.37413346151497, 235.5449433504576, 133.80694442932108, 12.559999999999993, 1.1599999999999993, -54.2788496133842, 47.75456139812053, 232.71145310231717, -5.081193112472487, 24.351665607198285, 75.10819464544494, 38.9997670281546, 7.166831644714316, 73.56253671348426, 100.39035249582678, 68.22, 176.44481407103308, -1.8204109565076965, 342.69299162540517, 59.94115478230466, 141.34000000000006, 32.66623873820355, 20.717970288804665, 192.99502629492204, 149.73134642649728, 3.179999999999998, -0.08405481377117052, 101.47611652351686, 25.693409944627607, 442.1665510265595, -5.912944591984285, 0.5299999999999998, -0.6844030759947506, -0.10526309176466064, -1.445800941716268, 197.1353163813962, 27.238294755312673, 11.992102599662676, 96.01183005147729, 0.0799999999999963, 2.239999999999994, 109.48669694610612, 133.57210956474478, 6.067583037582526, 158.6096077625669, 365.37476384586506, 18.03625295813544, 31.21069265818146, 159.85662310361744, 2.5027360146546433, 9.107772804791239, 334.02251052802353, 41.62080338571502, 191.14548949031936, 66.22701072871729, 388.61184533749304, 90.44261496340962, 13.343915767075593, 221.70475158203087], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-256.93517670839424, -368.7811113484809, -405.7259004061157, -483.3014116903097, -448.9292695243148, 200.0, -373.02912182311275, -496.0399023042011, -419.95119059746446, -72.0849601950381, -307.63011677503533, -450.77364240913863, -508.5037025778377, -371.17380540359136, -397.4142867565842, -310.6334476321882, 189.11, -401.1526742679526, -349.00803920793936, -405.1007477994385, -420.14221714559784, -446.1579279960625, -412.2325477665089, -422.6184554593174, -33.41135673582578, -391.66684738772506, -426.76012679624796, -345.25746303776475, -398.6306308436486, -303.66651604976283, -347.38978386628827, -345.1272030646209, -292.2832294406235, -369.5775597641663, -421.85442730617154, -88.86122014972162, -380.8136484248058, -512.5386949986099, -274.14276726491147, -462.9870739829365, -491.4985364998577, -490.06561128172376, -477.2835436496361, -303.2810246899123, -313.0948841991304, -201.2375931603451, -410.59067530895277, -393.6331005889513, -405.5078867808744, -465.7642114321985, -481.8392117272123, -24.114723863373754, -388.15472513765786, -484.35204423443685, -355.5315138398265, -288.02380526558227, -399.7145402853997, -266.30766303659664, -294.8350531837367, -132.36676298823568, -434.77026691128106, -492.6816960733935, -468.356695034651, -366.59762993653766, -272.76423987531126, -431.23083977835233, -287.9015354024038, -389.00124245066496, -345.5646220854039, -48.65576922914205, -419.3746950305094, -364.37287767229856, -374.3389210609447, -185.61627157880767, -526.9349954888174, -347.47625890628973, -163.32801272445326, -507.13711037214864, -451.4821204704514, -297.64615413778796, -348.7236710987905, -142.50680674086988, -316.0105350521545, -335.7872900793253, -381.9443749677831, 41.886470552994666, -423.36402661115494, -157.7722206678964, -619.1250197338517, -289.6654951887205, -429.1030126776398, -427.8748216087764, -350.2122161782427, -345.30938223065743, -493.4024924471332, -259.2094559351542, -340.1183251579726, -7.530712294540384, -415.51897442137124, -323.944300692644, -342.7261306910114, -353.8735080733136, -252.51245545109015, -374.52332358064774, -562.3260955595679, -244.34782704951743, -262.1814950603598, -362.96288485240234, -301.4713027009594, -372.4171113926211, -528.8546625057603, -272.15512733936623, -355.9739547754699, -144.2561850588644, -42.823799184161274, -490.59013026611524, -324.1215988594681, -471.4479450929375, -314.68184494097005, 158.31675665337247, -431.40048766320115, -394.03490200295636, -406.5854765790607, 30.409218348691027, -364.23406948872145, -334.4384406705032, -429.20192349659226, -350.1236284517539, 46.513879720760116, -347.2294777493748, -149.87231844844047, -517.9571086498796, -395.2659910814347, -630.3390965540199, -358.0793479170413, -414.4756561729776, -355.95643796585205, -99.97677374758521, -235.17307128376368, -332.25580527338985, 66.04263675849707, -581.9023710746426, -280.85900611762304, -255.3259019156314, -365.87965106588365, -294.18710062471706, -410.14289339876956, -374.47249229579637, -375.25142222658945, -334.725645262027, -295.9095564229718, -337.4669615728478, -284.54384598601325, -81.4174767571632, -421.47003535318925, -269.95436238201887, -398.1703732994508, -349.5113658879474, -197.71704254228737, -394.7877228151001, -401.2468890277571, -440.35288541636777, -365.0684966537952, -407.5810727135043, 1.0120257387507599, -174.39282481203702, -488.82977974060356, -255.1215420394421, -383.9618111343399, -270.89193408843295, -477.5879517658161, 151.4694394395931, 161.1594003325904, -350.01334963788844, -231.43700989548142, -429.7861545505732, -427.51636067837427, 2.0000000000000013, 2.0000000000000013, -484.26867345096605, -458.5111072600225, -417.1718716209876, -534.6885979623845, -377.9620633344943, -418.80847461219355, 94.26106391906154, -425.7729774589613, -318.17240408082625, -335.5971232997627, -16.857806738453903, -326.434185669448, -390.9980197205648, -358.9179413528755, 200.0, -276.49390190201797, -246.36618509042873, -293.31314262976093, -437.0732579698316, 6.7884801800421, -428.27215506633127], "policy_predator_policy_reward": [371.37576352613377, 345.915849526407, 536.3890690909753, 359.64070117123714, 449.42926952431435, 0.0, 373.12912182311265, 496.0499023042011, 346.95734577867137, 313.3226487386308, 320.83239216104016, 455.6668919185755, 508.5137025778377, 371.28380540359126, 404.4118873908561, 368.18784083327284, 0.0, 401.20267426795255, 346.44396645576285, 408.2390375850989, 422.1622171455978, 449.17792799606246, 407.0244266443711, 398.5048952764547, 357.40342302576335, 330.2656763653447, 444.2092738551819, 343.5920627546349, 401.80063084364843, 303.73651604976277, 341.0805831468285, 377.401823237299, 300.68791497428896, 380.5416439824431, 405.5906709677875, 267.9435654356827, 406.00031892779054, 509.3257587485011, 453.5371328334035, 413.9956871914182, 575.5977159565374, 382.1523787850774, 482.6150786195118, 301.7475237087861, 356.8798872979761, 303.36592616759754, 342.6589379498629, 422.6987963436567, 402.2297362066947, 474.88360846351765, 392.8469087431537, 374.3480498650797, 371.462521146683, 519.1042054352579, 367.6950382514526, 339.28593557583997, 382.4215621267097, 280.211093026224, 283.6360490044371, 250.81210271010016, 482.38397284913594, 456.7954804614243, 468.41669503465096, 366.6676299365376, 274.41647292234455, 432.2408397783524, 288.0815354024037, 389.041242450665, 304.08764190599993, 342.19039257978585, 393.160524423583, 422.76765183198256, 323.2546633890504, 265.88809946936306, 524.9771824215661, 373.4326271927053, 334.04286888075484, 425.56081982035596, 420.67794644763325, 413.98770153340604, 350.1175545752732, 213.84292326438649, 444.92028604242466, 298.25167255056925, 291.429437388951, 284.173410376295, 423.5990688410365, 291.3441228673355, 620.3150197338515, 301.0354951887205, 430.1230126776398, 428.0148216087764, 422.49678690996586, 218.74596188554983, 444.39423969681087, 355.9722700835966, 305.4677995229093, 274.8926910319217, 406.8959844054646, 327.48609759607814, 345.48045389042085, 375.47085048110233, 364.79402836752354, 337.34994530965884, 546.2072515108255, 299.4664381264139, 261.86912658132815, 370.44208497614807, 314.7599899787206, 432.6909608283434, 468.72768393829034, 432.6724584026616, 356.03395477546985, 212.41618505886424, 265.38408976520117, 444.474653756108, 324.26097443475703, 469.4881585611407, 271.9583141948278, 227.0997657181747, 419.27022882156416, 466.10631562689787, 404.0533698381341, 113.46288839223541, 346.58864591439544, 384.75010298303266, 401.3965804724215, 398.6469417647294, 229.1651844658725, 264.54543985766435, 317.61351682410395, 499.9472567007117, 398.35599108143464, 630.4290965540198, 358.2293479170412, 414.2416013592064, 356.1164379658519, 201.29289027110184, 277.39859148604177, 315.7236950157394, 421.6246611357379, 536.4016242069667, 125.25604174418343, 405.01592169708596, 366.1396510658834, 294.457100624717, 308.783318426636, 475.147664191935, 356.82670450784866, 353.0450998890034, 294.37375548125556, 337.5569615728478, 263.9724775062653, 299.12416161830674, 445.6102206972216, 273.0524717932989, 410.07247589911333, 349.60136588794734, 310.4308433469218, 378.08575206194337, 401.32688902775703, 440.35288541636777, 365.1884966537951, 409.7010727135043, 119.89839733976505, 162.96909867962512, 496.657940225496, 380.8654911192942, 536.365292659339, 124.55603560101557, 484.7281200887899, 0.0, 311.74625401696017, 242.48245913420257, 257.84639188777606, 421.41302551641314, 419.1592946789463, 37.56775865760946, 241.88977735984594, 400.2355191947385, 437.22226280911696, 440.96345208654736, 535.4724043353583, 386.2860297663117, 350.49847976604394, 308.07144145511177, 422.0284487765589, 363.53773614894345, 349.1569555622186, 194.44346396631747, 380.8233620037363, 402.8358541149934, 261.8117800299379, 285.71800666043043, 348.28612895457366, 265.0165730012825, 305.72161164815776, 438.0087047185102, 266.4152775184289, 376.7731489498912]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.763331871554078, "mean_inference_ms": 80.78571502114009, "mean_action_processing_ms": 3.154203198305968, "mean_env_wait_ms": 4.834307799669739, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005097150802612305, "StateBufferConnector_ms": 0.003589034080505371, "ViewRequirementAgentConnector_ms": 0.11236131191253662}, "num_episodes": 18, "episode_return_max": 442.1665510265595, "episode_return_min": -54.2788496133842, "episode_return_mean": 79.35337200981766, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1328000, "num_agent_steps_trained": 1328000, "num_env_steps_sampled": 332000, "num_env_steps_trained": 332000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 30.48298845753255, "num_env_steps_trained_throughput_per_sec": 30.48298845753255, "timesteps_total": 332000, "num_env_steps_sampled_lifetime": 332000, "num_agent_steps_sampled_lifetime": 1328000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1328000, "timers": {"training_iteration_time_ms": 1007737.428, "restore_workers_time_ms": 0.017, "training_step_time_ms": 1007737.351, "sample_time_ms": 2172.396, "learn_time_ms": 1005542.982, "learn_throughput": 3.978, "synch_weights_time_ms": 16.677}, "counters": {"num_env_steps_sampled": 332000, "num_env_steps_trained": 332000, "num_agent_steps_sampled": 1328000, "num_agent_steps_trained": 1328000}, "done": false, "training_iteration": 83, "trial_id": "b941d_00000", "date": "2024-08-19_08-52-46", "timestamp": 1724037766, "time_this_iter_s": 131.27850699424744, "time_total_s": 176329.60378432274, "pid": 81115, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[32, [4, 4], 2], [64, [3, 3], 2], [128, [3, 3], 1]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [256, 256], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b29caf70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 176329.60378432274, "iterations_since_restore": 83, "perf": {"cpu_util_percent": 21.049197860962565, "ram_util_percent": 82.0427807486631}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 14.851935866648558, "cur_kl_coeff": 1.5187500000000005, "cur_lr": 0.00010000000000000003, "total_loss": 8.325230078217844, "policy_loss": -0.08536104805602461, "vf_loss": 8.387772281838473, "vf_explained_var": 0.17822443508597277, "kl": 0.015024755137420562, "entropy": 0.9834359120124232, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 157815.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 15.867363713721119, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.00010000000000000003, "total_loss": 8.94060948185189, "policy_loss": -0.07750740304131001, "vf_loss": 9.0029756619186, "vf_explained_var": -0.5270725766186992, "kl": 0.014954307059455671, "entropy": 0.709625707858454, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 157815.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_agent_steps_sampled": 1344000, "num_agent_steps_trained": 1344000}, "env_runners": {"episode_reward_max": 442.1665510265595, "episode_reward_min": -54.2788496133842, "episode_reward_mean": 83.65411897114316, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -664.5956266469996, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 664.6056266469996}, "policy_reward_mean": {"prey_policy": -319.947688705102, "predator_policy": 361.7747481906734}, "custom_metrics": {}, "hist_stats": {"episode_reward": [21.973734252876085, 130.40297877697375, -23.814053039966907, 3.7980339887498893, 145.9133361060977, -38.86604160438411, 5.841246457139669, 261.2410230176468, 18.05995720984629, 63.425654721884676, -3.389548169062067, 107.24633554256506, 11.727490325885537, 0.13000000000000078, 2.6622330470336255, 0.21999999999999975, 252.0576431712402, 32.18060355275783, 29.18757021866152, 23.99855521916456, 89.13856560451048, 85.53737337280133, 72.72999999999998, 91.37413346151497, 235.5449433504576, 133.80694442932108, 12.559999999999993, 1.1599999999999993, -54.2788496133842, 47.75456139812053, 232.71145310231717, -5.081193112472487, 24.351665607198285, 75.10819464544494, 38.9997670281546, 7.166831644714316, 73.56253671348426, 100.39035249582678, 68.22, 176.44481407103308, -1.8204109565076965, 342.69299162540517, 59.94115478230466, 141.34000000000006, 32.66623873820355, 20.717970288804665, 192.99502629492204, 149.73134642649728, 3.179999999999998, -0.08405481377117052, 101.47611652351686, 25.693409944627607, 442.1665510265595, -5.912944591984285, 0.5299999999999998, -0.6844030759947506, -0.10526309176466064, -1.445800941716268, 197.1353163813962, 27.238294755312673, 11.992102599662676, 96.01183005147729, 0.0799999999999963, 2.239999999999994, 109.48669694610612, 133.57210956474478, 6.067583037582526, 158.6096077625669, 365.37476384586506, 18.03625295813544, 31.21069265818146, 159.85662310361744, 2.5027360146546433, 9.107772804791239, 334.02251052802353, 41.62080338571502, 191.14548949031936, 66.22701072871729, 388.61184533749304, 90.44261496340962, 13.343915767075593, 221.70475158203087, 53.62543604764729, 186.6567013458583, 261.5135755252676, 90.30716797878236, 157.4141443271628, 11.097500551302423, 126.69215925811135, 0.11999999999999611, 1.3089213710156002, 3.822456254953402, -7.549516567451064e-15, 21.036439032103857, 1.2400000000000002, 308.6821559042498, 2.5767504905630654, 362.05, 47.131648773548605, 0.21874081361686182], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-380.8136484248058, -512.5386949986099, -274.14276726491147, -462.9870739829365, -491.4985364998577, -490.06561128172376, -477.2835436496361, -303.2810246899123, -313.0948841991304, -201.2375931603451, -410.59067530895277, -393.6331005889513, -405.5078867808744, -465.7642114321985, -481.8392117272123, -24.114723863373754, -388.15472513765786, -484.35204423443685, -355.5315138398265, -288.02380526558227, -399.7145402853997, -266.30766303659664, -294.8350531837367, -132.36676298823568, -434.77026691128106, -492.6816960733935, -468.356695034651, -366.59762993653766, -272.76423987531126, -431.23083977835233, -287.9015354024038, -389.00124245066496, -345.5646220854039, -48.65576922914205, -419.3746950305094, -364.37287767229856, -374.3389210609447, -185.61627157880767, -526.9349954888174, -347.47625890628973, -163.32801272445326, -507.13711037214864, -451.4821204704514, -297.64615413778796, -348.7236710987905, -142.50680674086988, -316.0105350521545, -335.7872900793253, -381.9443749677831, 41.886470552994666, -423.36402661115494, -157.7722206678964, -619.1250197338517, -289.6654951887205, -429.1030126776398, -427.8748216087764, -350.2122161782427, -345.30938223065743, -493.4024924471332, -259.2094559351542, -340.1183251579726, -7.530712294540384, -415.51897442137124, -323.944300692644, -342.7261306910114, -353.8735080733136, -252.51245545109015, -374.52332358064774, -562.3260955595679, -244.34782704951743, -262.1814950603598, -362.96288485240234, -301.4713027009594, -372.4171113926211, -528.8546625057603, -272.15512733936623, -355.9739547754699, -144.2561850588644, -42.823799184161274, -490.59013026611524, -324.1215988594681, -471.4479450929375, -314.68184494097005, 158.31675665337247, -431.40048766320115, -394.03490200295636, -406.5854765790607, 30.409218348691027, -364.23406948872145, -334.4384406705032, -429.20192349659226, -350.1236284517539, 46.513879720760116, -347.2294777493748, -149.87231844844047, -517.9571086498796, -395.2659910814347, -630.3390965540199, -358.0793479170413, -414.4756561729776, -355.95643796585205, -99.97677374758521, -235.17307128376368, -332.25580527338985, 66.04263675849707, -581.9023710746426, -280.85900611762304, -255.3259019156314, -365.87965106588365, -294.18710062471706, -410.14289339876956, -374.47249229579637, -375.25142222658945, -334.725645262027, -295.9095564229718, -337.4669615728478, -284.54384598601325, -81.4174767571632, -421.47003535318925, -269.95436238201887, -398.1703732994508, -349.5113658879474, -197.71704254228737, -394.7877228151001, -401.2468890277571, -440.35288541636777, -365.0684966537952, -407.5810727135043, 1.0120257387507599, -174.39282481203702, -488.82977974060356, -255.1215420394421, -383.9618111343399, -270.89193408843295, -477.5879517658161, 151.4694394395931, 161.1594003325904, -350.01334963788844, -231.43700989548142, -429.7861545505732, -427.51636067837427, 2.0000000000000013, 2.0000000000000013, -484.26867345096605, -458.5111072600225, -417.1718716209876, -534.6885979623845, -377.9620633344943, -418.80847461219355, 94.26106391906154, -425.7729774589613, -318.17240408082625, -335.5971232997627, -16.857806738453903, -326.434185669448, -390.9980197205648, -358.9179413528755, 200.0, -276.49390190201797, -246.36618509042873, -293.31314262976093, -437.0732579698316, 6.7884801800421, -428.27215506633127, -196.79076075338398, -345.0306282943267, -69.22189806603366, -432.34304284643576, -45.257188373037025, -490.78469690757277, -238.32976633849074, -537.3612384160291, -469.64902600997556, -163.88339650099886, -291.5878407189903, -219.2121146237097, -114.53099879235339, -389.2434219070438, -432.9509127837569, -664.5956266469996, -287.318820522939, -558.8164592741475, -352.46693854779306, -379.82379458816166, -450.73003230502286, -502.9362814286611, -487.1865963185043, -224.94787398091438, -365.9472753746987, -429.2518226863431, -526.814915107476, -109.80777402393726, -295.80409372085643, -464.49741035742755, 200.0, 107.23081495580715, -293.5000556195622, -194.65053713874588, -527.6261443450016, -551.6835864654472], "policy_predator_policy_reward": [406.00031892779054, 509.3257587485011, 453.5371328334035, 413.9956871914182, 575.5977159565374, 382.1523787850774, 482.6150786195118, 301.7475237087861, 356.8798872979761, 303.36592616759754, 342.6589379498629, 422.6987963436567, 402.2297362066947, 474.88360846351765, 392.8469087431537, 374.3480498650797, 371.462521146683, 519.1042054352579, 367.6950382514526, 339.28593557583997, 382.4215621267097, 280.211093026224, 283.6360490044371, 250.81210271010016, 482.38397284913594, 456.7954804614243, 468.41669503465096, 366.6676299365376, 274.41647292234455, 432.2408397783524, 288.0815354024037, 389.041242450665, 304.08764190599993, 342.19039257978585, 393.160524423583, 422.76765183198256, 323.2546633890504, 265.88809946936306, 524.9771824215661, 373.4326271927053, 334.04286888075484, 425.56081982035596, 420.67794644763325, 413.98770153340604, 350.1175545752732, 213.84292326438649, 444.92028604242466, 298.25167255056925, 291.429437388951, 284.173410376295, 423.5990688410365, 291.3441228673355, 620.3150197338515, 301.0354951887205, 430.1230126776398, 428.0148216087764, 422.49678690996586, 218.74596188554983, 444.39423969681087, 355.9722700835966, 305.4677995229093, 274.8926910319217, 406.8959844054646, 327.48609759607814, 345.48045389042085, 375.47085048110233, 364.79402836752354, 337.34994530965884, 546.2072515108255, 299.4664381264139, 261.86912658132815, 370.44208497614807, 314.7599899787206, 432.6909608283434, 468.72768393829034, 432.6724584026616, 356.03395477546985, 212.41618505886424, 265.38408976520117, 444.474653756108, 324.26097443475703, 469.4881585611407, 271.9583141948278, 227.0997657181747, 419.27022882156416, 466.10631562689787, 404.0533698381341, 113.46288839223541, 346.58864591439544, 384.75010298303266, 401.3965804724215, 398.6469417647294, 229.1651844658725, 264.54543985766435, 317.61351682410395, 499.9472567007117, 398.35599108143464, 630.4290965540198, 358.2293479170412, 414.2416013592064, 356.1164379658519, 201.29289027110184, 277.39859148604177, 315.7236950157394, 421.6246611357379, 536.4016242069667, 125.25604174418343, 405.01592169708596, 366.1396510658834, 294.457100624717, 308.783318426636, 475.147664191935, 356.82670450784866, 353.0450998890034, 294.37375548125556, 337.5569615728478, 263.9724775062653, 299.12416161830674, 445.6102206972216, 273.0524717932989, 410.07247589911333, 349.60136588794734, 310.4308433469218, 378.08575206194337, 401.32688902775703, 440.35288541636777, 365.1884966537951, 409.7010727135043, 119.89839733976505, 162.96909867962512, 496.657940225496, 380.8654911192942, 536.365292659339, 124.55603560101557, 484.7281200887899, 0.0, 311.74625401696017, 242.48245913420257, 257.84639188777606, 421.41302551641314, 419.1592946789463, 37.56775865760946, 241.88977735984594, 400.2355191947385, 437.22226280911696, 440.96345208654736, 535.4724043353583, 386.2860297663117, 350.49847976604394, 308.07144145511177, 422.0284487765589, 363.53773614894345, 349.1569555622186, 194.44346396631747, 380.8233620037363, 402.8358541149934, 261.8117800299379, 285.71800666043043, 348.28612895457366, 265.0165730012825, 305.72161164815776, 438.0087047185102, 266.4152775184289, 376.7731489498912, 303.05808373857565, 292.38874135678213, 283.1664941974873, 405.0551480608413, 465.6286615937089, 331.92679921216836, 334.13495611555044, 531.8632166177517, 365.68111281545293, 425.2654540226834, 296.7953412702927, 225.10211462370972, 248.64900198742404, 381.8175779700842, 433.0609127837568, 664.6056266469996, 288.57871586148633, 558.8654853066159, 324.7475924402696, 411.36559695063835, 450.73003230502286, 502.9362814286611, 450.55623136851756, 282.61467796300434, 366.1372753746986, 430.30182268634314, 476.6299331002247, 468.6749119354386, 298.2908442114195, 464.5874103574275, 0.0, 54.81918504419285, 288.0488712152221, 247.23337031663385, 527.8448851586184, 551.6835864654472]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.695466697187239, "mean_inference_ms": 79.92343553824294, "mean_action_processing_ms": 3.121957691020849, "mean_env_wait_ms": 4.783219542996391, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005016207695007324, "StateBufferConnector_ms": 0.0037039518356323242, "ViewRequirementAgentConnector_ms": 0.10933458805084229}, "num_episodes": 18, "episode_return_max": 442.1665510265595, "episode_return_min": -54.2788496133842, "episode_return_mean": 83.65411897114316, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1344000, "num_agent_steps_trained": 1344000, "num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 30.888952275141346, "num_env_steps_trained_throughput_per_sec": 30.888952275141346, "timesteps_total": 336000, "num_env_steps_sampled_lifetime": 336000, "num_agent_steps_sampled_lifetime": 1344000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1344000, "timers": {"training_iteration_time_ms": 1004024.881, "restore_workers_time_ms": 0.017, "training_step_time_ms": 1004024.803, "sample_time_ms": 2175.355, "learn_time_ms": 1001828.357, "learn_throughput": 3.993, "synch_weights_time_ms": 16.356}, "counters": {"num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_agent_steps_sampled": 1344000, "num_agent_steps_trained": 1344000}, "done": false, "training_iteration": 84, "trial_id": "b941d_00000", "date": "2024-08-19_08-54-56", "timestamp": 1724037896, "time_this_iter_s": 129.54181599617004, "time_total_s": 176459.1456003189, "pid": 81115, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[32, [4, 4], 2], [64, [3, 3], 2], [128, [3, 3], 1]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [256, 256], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b29dc4c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 176459.1456003189, "iterations_since_restore": 84, "perf": {"cpu_util_percent": 20.758152173913043, "ram_util_percent": 82.12771739130434}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 12.844939962770573, "cur_kl_coeff": 1.5187500000000005, "cur_lr": 0.00010000000000000003, "total_loss": 8.437955116847204, "policy_loss": -0.09445656797966905, "vf_loss": 8.510102041688546, "vf_explained_var": 0.31769911766682984, "kl": 0.014689455934703178, "entropy": 0.9583211190486081, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 159705.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 15.7669833235009, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.00010000000000000003, "total_loss": 8.963888212234254, "policy_loss": -0.0891419223334798, "vf_loss": 9.036775211556249, "vf_explained_var": -0.5477015532198406, "kl": 0.016054257631949634, "entropy": 0.7902329935283258, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 159705.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 340000, "num_env_steps_trained": 340000, "num_agent_steps_sampled": 1360000, "num_agent_steps_trained": 1360000}, "env_runners": {"episode_reward_max": 442.1665510265595, "episode_reward_min": -54.2788496133842, "episode_reward_mean": 95.79174737896602, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -664.5956266469996, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 664.6056266469996}, "policy_reward_mean": {"prey_policy": -307.30522837172043, "predator_policy": 355.2011020612034}, "custom_metrics": {}, "hist_stats": {"episode_reward": [72.72999999999998, 91.37413346151497, 235.5449433504576, 133.80694442932108, 12.559999999999993, 1.1599999999999993, -54.2788496133842, 47.75456139812053, 232.71145310231717, -5.081193112472487, 24.351665607198285, 75.10819464544494, 38.9997670281546, 7.166831644714316, 73.56253671348426, 100.39035249582678, 68.22, 176.44481407103308, -1.8204109565076965, 342.69299162540517, 59.94115478230466, 141.34000000000006, 32.66623873820355, 20.717970288804665, 192.99502629492204, 149.73134642649728, 3.179999999999998, -0.08405481377117052, 101.47611652351686, 25.693409944627607, 442.1665510265595, -5.912944591984285, 0.5299999999999998, -0.6844030759947506, -0.10526309176466064, -1.445800941716268, 197.1353163813962, 27.238294755312673, 11.992102599662676, 96.01183005147729, 0.0799999999999963, 2.239999999999994, 109.48669694610612, 133.57210956474478, 6.067583037582526, 158.6096077625669, 365.37476384586506, 18.03625295813544, 31.21069265818146, 159.85662310361744, 2.5027360146546433, 9.107772804791239, 334.02251052802353, 41.62080338571502, 191.14548949031936, 66.22701072871729, 388.61184533749304, 90.44261496340962, 13.343915767075593, 221.70475158203087, 53.62543604764729, 186.6567013458583, 261.5135755252676, 90.30716797878236, 157.4141443271628, 11.097500551302423, 126.69215925811135, 0.11999999999999611, 1.3089213710156002, 3.822456254953402, -7.549516567451064e-15, 21.036439032103857, 1.2400000000000002, 308.6821559042498, 2.5767504905630654, 362.05, 47.131648773548605, 0.21874081361686182, 329.44478568150436, 146.64680626775242, 353.12563844582667, 10.60345999836456, 431.2682311605138, 0.30999999999999694, 0.12999999999999412, 3.4599999999999955, 62.52245853731454, 352.9864024648529, -4.1692199407328605, 50.9410256590387, 11.323166337177303, 19.354976804261405, 21.833944460916353, 57.49411830610813, 300.3652570645821, 2.5691519936416336, -8.020383379142698, 173.23000000000002, 116.0057126927274, 1.0099999999999945], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-348.7236710987905, -142.50680674086988, -316.0105350521545, -335.7872900793253, -381.9443749677831, 41.886470552994666, -423.36402661115494, -157.7722206678964, -619.1250197338517, -289.6654951887205, -429.1030126776398, -427.8748216087764, -350.2122161782427, -345.30938223065743, -493.4024924471332, -259.2094559351542, -340.1183251579726, -7.530712294540384, -415.51897442137124, -323.944300692644, -342.7261306910114, -353.8735080733136, -252.51245545109015, -374.52332358064774, -562.3260955595679, -244.34782704951743, -262.1814950603598, -362.96288485240234, -301.4713027009594, -372.4171113926211, -528.8546625057603, -272.15512733936623, -355.9739547754699, -144.2561850588644, -42.823799184161274, -490.59013026611524, -324.1215988594681, -471.4479450929375, -314.68184494097005, 158.31675665337247, -431.40048766320115, -394.03490200295636, -406.5854765790607, 30.409218348691027, -364.23406948872145, -334.4384406705032, -429.20192349659226, -350.1236284517539, 46.513879720760116, -347.2294777493748, -149.87231844844047, -517.9571086498796, -395.2659910814347, -630.3390965540199, -358.0793479170413, -414.4756561729776, -355.95643796585205, -99.97677374758521, -235.17307128376368, -332.25580527338985, 66.04263675849707, -581.9023710746426, -280.85900611762304, -255.3259019156314, -365.87965106588365, -294.18710062471706, -410.14289339876956, -374.47249229579637, -375.25142222658945, -334.725645262027, -295.9095564229718, -337.4669615728478, -284.54384598601325, -81.4174767571632, -421.47003535318925, -269.95436238201887, -398.1703732994508, -349.5113658879474, -197.71704254228737, -394.7877228151001, -401.2468890277571, -440.35288541636777, -365.0684966537952, -407.5810727135043, 1.0120257387507599, -174.39282481203702, -488.82977974060356, -255.1215420394421, -383.9618111343399, -270.89193408843295, -477.5879517658161, 151.4694394395931, 161.1594003325904, -350.01334963788844, -231.43700989548142, -429.7861545505732, -427.51636067837427, 2.0000000000000013, 2.0000000000000013, -484.26867345096605, -458.5111072600225, -417.1718716209876, -534.6885979623845, -377.9620633344943, -418.80847461219355, 94.26106391906154, -425.7729774589613, -318.17240408082625, -335.5971232997627, -16.857806738453903, -326.434185669448, -390.9980197205648, -358.9179413528755, 200.0, -276.49390190201797, -246.36618509042873, -293.31314262976093, -437.0732579698316, 6.7884801800421, -428.27215506633127, -196.79076075338398, -345.0306282943267, -69.22189806603366, -432.34304284643576, -45.257188373037025, -490.78469690757277, -238.32976633849074, -537.3612384160291, -469.64902600997556, -163.88339650099886, -291.5878407189903, -219.2121146237097, -114.53099879235339, -389.2434219070438, -432.9509127837569, -664.5956266469996, -287.318820522939, -558.8164592741475, -352.46693854779306, -379.82379458816166, -450.73003230502286, -502.9362814286611, -487.1865963185043, -224.94787398091438, -365.9472753746987, -429.2518226863431, -526.814915107476, -109.80777402393726, -295.80409372085643, -464.49741035742755, 200.0, 107.23081495580715, -293.5000556195622, -194.65053713874588, -527.6261443450016, -551.6835864654472, -388.4873552275704, 77.03479146645192, -122.54464590261128, -83.7247757064225, -238.8667229593558, 155.88472685564224, -378.46963629632796, -360.5953182825117, -445.6736802763093, 179.48393192864447, -364.2598421702049, -284.736534604723, -539.8409398599056, -526.1487719923911, -287.33849312652643, -390.2424370374401, -487.00491425535955, -252.97401779494174, -371.1837611279081, 137.20029141151554, -359.2366792006033, -406.00075554881084, -321.98375612212254, -398.4845548724315, -385.4755224507169, -504.7365147806279, -317.1527202387904, -377.93715929468436, -385.2552501336939, -517.0076423294475, -450.92960568002763, -300.97233223352686, -363.6514428906413, 50.84124492333635, -503.96530353588486, -381.5979989490697, -413.5052846164902, -317.53439735533766, 145.17346283316272, -412.73296529348954, -265.53651330592385, -185.10794923250978, -598.7102459284129, -400.4311921732461], "policy_predator_policy_reward": [350.1175545752732, 213.84292326438649, 444.92028604242466, 298.25167255056925, 291.429437388951, 284.173410376295, 423.5990688410365, 291.3441228673355, 620.3150197338515, 301.0354951887205, 430.1230126776398, 428.0148216087764, 422.49678690996586, 218.74596188554983, 444.39423969681087, 355.9722700835966, 305.4677995229093, 274.8926910319217, 406.8959844054646, 327.48609759607814, 345.48045389042085, 375.47085048110233, 364.79402836752354, 337.34994530965884, 546.2072515108255, 299.4664381264139, 261.86912658132815, 370.44208497614807, 314.7599899787206, 432.6909608283434, 468.72768393829034, 432.6724584026616, 356.03395477546985, 212.41618505886424, 265.38408976520117, 444.474653756108, 324.26097443475703, 469.4881585611407, 271.9583141948278, 227.0997657181747, 419.27022882156416, 466.10631562689787, 404.0533698381341, 113.46288839223541, 346.58864591439544, 384.75010298303266, 401.3965804724215, 398.6469417647294, 229.1651844658725, 264.54543985766435, 317.61351682410395, 499.9472567007117, 398.35599108143464, 630.4290965540198, 358.2293479170412, 414.2416013592064, 356.1164379658519, 201.29289027110184, 277.39859148604177, 315.7236950157394, 421.6246611357379, 536.4016242069667, 125.25604174418343, 405.01592169708596, 366.1396510658834, 294.457100624717, 308.783318426636, 475.147664191935, 356.82670450784866, 353.0450998890034, 294.37375548125556, 337.5569615728478, 263.9724775062653, 299.12416161830674, 445.6102206972216, 273.0524717932989, 410.07247589911333, 349.60136588794734, 310.4308433469218, 378.08575206194337, 401.32688902775703, 440.35288541636777, 365.1884966537951, 409.7010727135043, 119.89839733976505, 162.96909867962512, 496.657940225496, 380.8654911192942, 536.365292659339, 124.55603560101557, 484.7281200887899, 0.0, 311.74625401696017, 242.48245913420257, 257.84639188777606, 421.41302551641314, 419.1592946789463, 37.56775865760946, 241.88977735984594, 400.2355191947385, 437.22226280911696, 440.96345208654736, 535.4724043353583, 386.2860297663117, 350.49847976604394, 308.07144145511177, 422.0284487765589, 363.53773614894345, 349.1569555622186, 194.44346396631747, 380.8233620037363, 402.8358541149934, 261.8117800299379, 285.71800666043043, 348.28612895457366, 265.0165730012825, 305.72161164815776, 438.0087047185102, 266.4152775184289, 376.7731489498912, 303.05808373857565, 292.38874135678213, 283.1664941974873, 405.0551480608413, 465.6286615937089, 331.92679921216836, 334.13495611555044, 531.8632166177517, 365.68111281545293, 425.2654540226834, 296.7953412702927, 225.10211462370972, 248.64900198742404, 381.8175779700842, 433.0609127837568, 664.6056266469996, 288.57871586148633, 558.8654853066159, 324.7475924402696, 411.36559695063835, 450.73003230502286, 502.9362814286611, 450.55623136851756, 282.61467796300434, 366.1372753746986, 430.30182268634314, 476.6299331002247, 468.6749119354386, 298.2908442114195, 464.5874103574275, 0.0, 54.81918504419285, 288.0488712152221, 247.23337031663385, 527.8448851586184, 551.6835864654472, 305.373933987249, 335.5234154553735, 188.82480889009085, 164.09141898669594, 209.65469904888042, 226.45293550065978, 386.07397308704145, 363.5944414901629, 408.7858972142228, 288.6720822939557, 364.3198421702048, 284.98653460472286, 539.8409398599056, 526.278771992391, 287.68849312652657, 393.3524370374402, 467.7431176721509, 334.7582729154649, 259.78779111863486, 327.1820810626111, 349.66104473930307, 411.4071700693784, 425.33342672472287, 346.07590992886975, 394.7986887878942, 506.7365147806279, 351.54094244400727, 362.9039138937287, 559.045506147813, 365.05133077624345, 503.54389180737377, 305.8521644122887, 266.49622752697, 346.6792275049166, 520.503020614359, 367.6294338642369, 420.8194431017247, 302.1998554909603, 26.936537166837297, 413.85296529348943, 312.70324245407755, 253.9469327770833, 599.7102459284129, 400.44119217324607]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.620399426411421, "mean_inference_ms": 78.89002300842645, "mean_action_processing_ms": 3.09043456656078, "mean_env_wait_ms": 4.7084223020397395, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005357980728149414, "StateBufferConnector_ms": 0.0037069320678710938, "ViewRequirementAgentConnector_ms": 0.10834240913391113}, "num_episodes": 22, "episode_return_max": 442.1665510265595, "episode_return_min": -54.2788496133842, "episode_return_mean": 95.79174737896602, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1360000, "num_agent_steps_trained": 1360000, "num_env_steps_sampled": 340000, "num_env_steps_trained": 340000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 30.3715033123104, "num_env_steps_trained_throughput_per_sec": 30.3715033123104, "timesteps_total": 340000, "num_env_steps_sampled_lifetime": 340000, "num_agent_steps_sampled_lifetime": 1360000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1360000, "timers": {"training_iteration_time_ms": 997552.616, "restore_workers_time_ms": 0.017, "training_step_time_ms": 997552.537, "sample_time_ms": 2148.457, "learn_time_ms": 995383.385, "learn_throughput": 4.019, "synch_weights_time_ms": 16.084}, "counters": {"num_env_steps_sampled": 340000, "num_env_steps_trained": 340000, "num_agent_steps_sampled": 1360000, "num_agent_steps_trained": 1360000}, "done": false, "training_iteration": 85, "trial_id": "b941d_00000", "date": "2024-08-19_08-57-08", "timestamp": 1724038028, "time_this_iter_s": 131.7472448348999, "time_total_s": 176590.8928451538, "pid": 81115, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[32, [4, 4], 2], [64, [3, 3], 2], [128, [3, 3], 1]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [256, 256], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b0436160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 176590.8928451538, "iterations_since_restore": 85, "perf": {"cpu_util_percent": 18.988297872340425, "ram_util_percent": 81.19308510638298}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.29106864311077, "cur_kl_coeff": 1.5187500000000005, "cur_lr": 0.00010000000000000003, "total_loss": 8.611439021428426, "policy_loss": -0.09342955999598695, "vf_loss": 8.682390387600693, "vf_explained_var": 0.28074111219436404, "kl": 0.014800465855312651, "entropy": 0.9763500195016306, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 161595.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 16.745315769929736, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.00010000000000000003, "total_loss": 9.05136267293698, "policy_loss": -0.08884643041725866, "vf_loss": 9.123190843491328, "vf_explained_var": -0.7688371849123132, "kl": 0.016808178963173107, "entropy": 0.7860125020067528, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 161595.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 344000, "num_env_steps_trained": 344000, "num_agent_steps_sampled": 1376000, "num_agent_steps_trained": 1376000}, "env_runners": {"episode_reward_max": 442.1665510265595, "episode_reward_min": -8.020383379142698, "episode_reward_mean": 99.06524440598587, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -664.5956266469996, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 664.6056266469996}, "policy_reward_mean": {"prey_policy": -305.9403533277664, "predator_policy": 355.4729755307593}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.8204109565076965, 342.69299162540517, 59.94115478230466, 141.34000000000006, 32.66623873820355, 20.717970288804665, 192.99502629492204, 149.73134642649728, 3.179999999999998, -0.08405481377117052, 101.47611652351686, 25.693409944627607, 442.1665510265595, -5.912944591984285, 0.5299999999999998, -0.6844030759947506, -0.10526309176466064, -1.445800941716268, 197.1353163813962, 27.238294755312673, 11.992102599662676, 96.01183005147729, 0.0799999999999963, 2.239999999999994, 109.48669694610612, 133.57210956474478, 6.067583037582526, 158.6096077625669, 365.37476384586506, 18.03625295813544, 31.21069265818146, 159.85662310361744, 2.5027360146546433, 9.107772804791239, 334.02251052802353, 41.62080338571502, 191.14548949031936, 66.22701072871729, 388.61184533749304, 90.44261496340962, 13.343915767075593, 221.70475158203087, 53.62543604764729, 186.6567013458583, 261.5135755252676, 90.30716797878236, 157.4141443271628, 11.097500551302423, 126.69215925811135, 0.11999999999999611, 1.3089213710156002, 3.822456254953402, -7.549516567451064e-15, 21.036439032103857, 1.2400000000000002, 308.6821559042498, 2.5767504905630654, 362.05, 47.131648773548605, 0.21874081361686182, 329.44478568150436, 146.64680626775242, 353.12563844582667, 10.60345999836456, 431.2682311605138, 0.30999999999999694, 0.12999999999999412, 3.4599999999999955, 62.52245853731454, 352.9864024648529, -4.1692199407328605, 50.9410256590387, 11.323166337177303, 19.354976804261405, 21.833944460916353, 57.49411830610813, 300.3652570645821, 2.5691519936416336, -8.020383379142698, 173.23000000000002, 116.0057126927274, 1.0099999999999945, 29.391892230227718, 94.69385570974009, 5.059999999999999, 17.57538198249779, -0.24054453569925482, 45.14075566929148, 1.1700000000000004, 238.43249170583277, 5.583297206367832, 2.28670194529819, 7.056109912040869, 253.27065809973422, 0.30999999999999384, 318.011907225256, 294.89364393991144, 153.45021974908835, -6.240512915871591, 200.02999999999997], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-324.1215988594681, -471.4479450929375, -314.68184494097005, 158.31675665337247, -431.40048766320115, -394.03490200295636, -406.5854765790607, 30.409218348691027, -364.23406948872145, -334.4384406705032, -429.20192349659226, -350.1236284517539, 46.513879720760116, -347.2294777493748, -149.87231844844047, -517.9571086498796, -395.2659910814347, -630.3390965540199, -358.0793479170413, -414.4756561729776, -355.95643796585205, -99.97677374758521, -235.17307128376368, -332.25580527338985, 66.04263675849707, -581.9023710746426, -280.85900611762304, -255.3259019156314, -365.87965106588365, -294.18710062471706, -410.14289339876956, -374.47249229579637, -375.25142222658945, -334.725645262027, -295.9095564229718, -337.4669615728478, -284.54384598601325, -81.4174767571632, -421.47003535318925, -269.95436238201887, -398.1703732994508, -349.5113658879474, -197.71704254228737, -394.7877228151001, -401.2468890277571, -440.35288541636777, -365.0684966537952, -407.5810727135043, 1.0120257387507599, -174.39282481203702, -488.82977974060356, -255.1215420394421, -383.9618111343399, -270.89193408843295, -477.5879517658161, 151.4694394395931, 161.1594003325904, -350.01334963788844, -231.43700989548142, -429.7861545505732, -427.51636067837427, 2.0000000000000013, 2.0000000000000013, -484.26867345096605, -458.5111072600225, -417.1718716209876, -534.6885979623845, -377.9620633344943, -418.80847461219355, 94.26106391906154, -425.7729774589613, -318.17240408082625, -335.5971232997627, -16.857806738453903, -326.434185669448, -390.9980197205648, -358.9179413528755, 200.0, -276.49390190201797, -246.36618509042873, -293.31314262976093, -437.0732579698316, 6.7884801800421, -428.27215506633127, -196.79076075338398, -345.0306282943267, -69.22189806603366, -432.34304284643576, -45.257188373037025, -490.78469690757277, -238.32976633849074, -537.3612384160291, -469.64902600997556, -163.88339650099886, -291.5878407189903, -219.2121146237097, -114.53099879235339, -389.2434219070438, -432.9509127837569, -664.5956266469996, -287.318820522939, -558.8164592741475, -352.46693854779306, -379.82379458816166, -450.73003230502286, -502.9362814286611, -487.1865963185043, -224.94787398091438, -365.9472753746987, -429.2518226863431, -526.814915107476, -109.80777402393726, -295.80409372085643, -464.49741035742755, 200.0, 107.23081495580715, -293.5000556195622, -194.65053713874588, -527.6261443450016, -551.6835864654472, -388.4873552275704, 77.03479146645192, -122.54464590261128, -83.7247757064225, -238.8667229593558, 155.88472685564224, -378.46963629632796, -360.5953182825117, -445.6736802763093, 179.48393192864447, -364.2598421702049, -284.736534604723, -539.8409398599056, -526.1487719923911, -287.33849312652643, -390.2424370374401, -487.00491425535955, -252.97401779494174, -371.1837611279081, 137.20029141151554, -359.2366792006033, -406.00075554881084, -321.98375612212254, -398.4845548724315, -385.4755224507169, -504.7365147806279, -317.1527202387904, -377.93715929468436, -385.2552501336939, -517.0076423294475, -450.92960568002763, -300.97233223352686, -363.6514428906413, 50.84124492333635, -503.96530353588486, -381.5979989490697, -413.5052846164902, -317.53439735533766, 145.17346283316272, -412.73296529348954, -265.53651330592385, -185.10794923250978, -598.7102459284129, -400.4311921732461, -429.39831641767654, -276.47411627026855, -243.85569836481142, -107.34316480014834, -443.2763791469681, -564.3587814936944, -449.48141947895283, -428.09017958972646, -412.93707922700725, -342.17588532490134, -369.3178154585206, -485.27011983395136, -465.5336126841734, -409.35922443934976, -37.68718548599472, -464.5358405761778, -313.8429521445343, -326.31249575812495, -340.6018944201596, -365.3862608387715, -407.0067173953306, -264.38277996671326, -424.06406347271553, -41.685195907043095, -323.45187411348553, -386.4696053679919, -441.6722187924851, 56.01222889677489, 128.01632370643364, -335.594724478079, -206.50668540545269, -350.9973342039415, -401.09341877456205, -367.4664458124947, 200.0, -514.6567151411085], "policy_predator_policy_reward": [324.26097443475703, 469.4881585611407, 271.9583141948278, 227.0997657181747, 419.27022882156416, 466.10631562689787, 404.0533698381341, 113.46288839223541, 346.58864591439544, 384.75010298303266, 401.3965804724215, 398.6469417647294, 229.1651844658725, 264.54543985766435, 317.61351682410395, 499.9472567007117, 398.35599108143464, 630.4290965540198, 358.2293479170412, 414.2416013592064, 356.1164379658519, 201.29289027110184, 277.39859148604177, 315.7236950157394, 421.6246611357379, 536.4016242069667, 125.25604174418343, 405.01592169708596, 366.1396510658834, 294.457100624717, 308.783318426636, 475.147664191935, 356.82670450784866, 353.0450998890034, 294.37375548125556, 337.5569615728478, 263.9724775062653, 299.12416161830674, 445.6102206972216, 273.0524717932989, 410.07247589911333, 349.60136588794734, 310.4308433469218, 378.08575206194337, 401.32688902775703, 440.35288541636777, 365.1884966537951, 409.7010727135043, 119.89839733976505, 162.96909867962512, 496.657940225496, 380.8654911192942, 536.365292659339, 124.55603560101557, 484.7281200887899, 0.0, 311.74625401696017, 242.48245913420257, 257.84639188777606, 421.41302551641314, 419.1592946789463, 37.56775865760946, 241.88977735984594, 400.2355191947385, 437.22226280911696, 440.96345208654736, 535.4724043353583, 386.2860297663117, 350.49847976604394, 308.07144145511177, 422.0284487765589, 363.53773614894345, 349.1569555622186, 194.44346396631747, 380.8233620037363, 402.8358541149934, 261.8117800299379, 285.71800666043043, 348.28612895457366, 265.0165730012825, 305.72161164815776, 438.0087047185102, 266.4152775184289, 376.7731489498912, 303.05808373857565, 292.38874135678213, 283.1664941974873, 405.0551480608413, 465.6286615937089, 331.92679921216836, 334.13495611555044, 531.8632166177517, 365.68111281545293, 425.2654540226834, 296.7953412702927, 225.10211462370972, 248.64900198742404, 381.8175779700842, 433.0609127837568, 664.6056266469996, 288.57871586148633, 558.8654853066159, 324.7475924402696, 411.36559695063835, 450.73003230502286, 502.9362814286611, 450.55623136851756, 282.61467796300434, 366.1372753746986, 430.30182268634314, 476.6299331002247, 468.6749119354386, 298.2908442114195, 464.5874103574275, 0.0, 54.81918504419285, 288.0488712152221, 247.23337031663385, 527.8448851586184, 551.6835864654472, 305.373933987249, 335.5234154553735, 188.82480889009085, 164.09141898669594, 209.65469904888042, 226.45293550065978, 386.07397308704145, 363.5944414901629, 408.7858972142228, 288.6720822939557, 364.3198421702048, 284.98653460472286, 539.8409398599056, 526.278771992391, 287.68849312652657, 393.3524370374402, 467.7431176721509, 334.7582729154649, 259.78779111863486, 327.1820810626111, 349.66104473930307, 411.4071700693784, 425.33342672472287, 346.07590992886975, 394.7986887878942, 506.7365147806279, 351.54094244400727, 362.9039138937287, 559.045506147813, 365.05133077624345, 503.54389180737377, 305.8521644122887, 266.49622752697, 346.6792275049166, 520.503020614359, 367.6294338642369, 420.8194431017247, 302.1998554909603, 26.936537166837297, 413.85296529348943, 312.70324245407755, 253.9469327770833, 599.7102459284129, 400.44119217324607, 390.444717436673, 344.81960748149976, 202.77333602685283, 243.11938284784642, 448.29637914696815, 564.3987814936944, 412.48285224304897, 482.6641288081279, 411.81176722251325, 343.0606527936958, 424.25964280376047, 475.46904815800343, 466.63361268417344, 409.4292244393497, 327.67591848294666, 412.97959928505935, 341.0016610827271, 304.73708402629995, 403.9053961861688, 304.3694610180603, 406.0807717855116, 272.3648354885728, 366.16830404516236, 352.85161343433026, 323.70187411348536, 386.52960536799185, 328.37478381216204, 375.2971133088045, 225.5837457819778, 276.8882989295791, 358.3264522731587, 352.6277870853242, 401.2889466111445, 361.03040506004055, 0.0, 514.6867151411085]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.555692974562944, "mean_inference_ms": 78.06803124738808, "mean_action_processing_ms": 3.059702550759233, "mean_env_wait_ms": 4.65973819659667, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00530242919921875, "StateBufferConnector_ms": 0.003728151321411133, "ViewRequirementAgentConnector_ms": 0.10832619667053223}, "num_episodes": 18, "episode_return_max": 442.1665510265595, "episode_return_min": -8.020383379142698, "episode_return_mean": 99.06524440598587, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1376000, "num_agent_steps_trained": 1376000, "num_env_steps_sampled": 344000, "num_env_steps_trained": 344000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 28.94646786416486, "num_env_steps_trained_throughput_per_sec": 28.94646786416486, "timesteps_total": 344000, "num_env_steps_sampled_lifetime": 344000, "num_agent_steps_sampled_lifetime": 1376000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1376000, "timers": {"training_iteration_time_ms": 761160.349, "restore_workers_time_ms": 0.017, "training_step_time_ms": 761160.268, "sample_time_ms": 2143.125, "learn_time_ms": 758996.849, "learn_throughput": 5.27, "synch_weights_time_ms": 16.229}, "counters": {"num_env_steps_sampled": 344000, "num_env_steps_trained": 344000, "num_agent_steps_sampled": 1376000, "num_agent_steps_trained": 1376000}, "done": false, "training_iteration": 86, "trial_id": "b941d_00000", "date": "2024-08-19_08-59-26", "timestamp": 1724038166, "time_this_iter_s": 138.23717188835144, "time_total_s": 176729.13001704216, "pid": 81115, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[32, [4, 4], 2], [64, [3, 3], 2], [128, [3, 3], 1]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [256, 256], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b29caca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 176729.13001704216, "iterations_since_restore": 86, "perf": {"cpu_util_percent": 28.989285714285714, "ram_util_percent": 82.47091836734694}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 12.4864833788897, "cur_kl_coeff": 1.5187500000000005, "cur_lr": 0.00010000000000000003, "total_loss": 9.188405623259367, "policy_loss": -0.09532442919702994, "vf_loss": 9.26041535977964, "vf_explained_var": -0.3883167573699245, "kl": 0.015351253465460886, "entropy": 1.0009614556554765, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 163485.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 15.882462429180347, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.00010000000000000003, "total_loss": 9.266249636493663, "policy_loss": -0.08694571323480911, "vf_loss": 9.338130306062244, "vf_explained_var": -0.865134567148471, "kl": 0.014879090273423521, "entropy": 0.7414874057605784, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 163485.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_agent_steps_sampled": 1392000, "num_agent_steps_trained": 1392000}, "env_runners": {"episode_reward_max": 431.2682311605138, "episode_reward_min": -26.59898437990254, "episode_reward_mean": 90.84756163575622, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -664.5956266469996, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 664.6056266469996}, "policy_reward_mean": {"prey_policy": -313.2006030235181, "predator_policy": 358.62438384139614}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2.239999999999994, 109.48669694610612, 133.57210956474478, 6.067583037582526, 158.6096077625669, 365.37476384586506, 18.03625295813544, 31.21069265818146, 159.85662310361744, 2.5027360146546433, 9.107772804791239, 334.02251052802353, 41.62080338571502, 191.14548949031936, 66.22701072871729, 388.61184533749304, 90.44261496340962, 13.343915767075593, 221.70475158203087, 53.62543604764729, 186.6567013458583, 261.5135755252676, 90.30716797878236, 157.4141443271628, 11.097500551302423, 126.69215925811135, 0.11999999999999611, 1.3089213710156002, 3.822456254953402, -7.549516567451064e-15, 21.036439032103857, 1.2400000000000002, 308.6821559042498, 2.5767504905630654, 362.05, 47.131648773548605, 0.21874081361686182, 329.44478568150436, 146.64680626775242, 353.12563844582667, 10.60345999836456, 431.2682311605138, 0.30999999999999694, 0.12999999999999412, 3.4599999999999955, 62.52245853731454, 352.9864024648529, -4.1692199407328605, 50.9410256590387, 11.323166337177303, 19.354976804261405, 21.833944460916353, 57.49411830610813, 300.3652570645821, 2.5691519936416336, -8.020383379142698, 173.23000000000002, 116.0057126927274, 1.0099999999999945, 29.391892230227718, 94.69385570974009, 5.059999999999999, 17.57538198249779, -0.24054453569925482, 45.14075566929148, 1.1700000000000004, 238.43249170583277, 5.583297206367832, 2.28670194529819, 7.056109912040869, 253.27065809973422, 0.30999999999999384, 318.011907225256, 294.89364393991144, 153.45021974908835, -6.240512915871591, 200.02999999999997, -3.344629878135912, 105.69568812743924, 0.11999999999999345, 7.776370169299662, 96.16392035718773, 238.28565656667914, 53.925713271499994, 25.230000000000132, -1.2711894271592494, 35.20478400481699, 12.614340734243932, -26.59898437990254, 0.10999999999999896, 0.14999999999999636, 125.81990007402854, 0.37999999999999257, 2.300174360474674, -25.776929809689012, 0.6696389431568073, 13.684951441567412, 250.92751186432082, 97.43027852416019, 4.27], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-365.0684966537952, -407.5810727135043, 1.0120257387507599, -174.39282481203702, -488.82977974060356, -255.1215420394421, -383.9618111343399, -270.89193408843295, -477.5879517658161, 151.4694394395931, 161.1594003325904, -350.01334963788844, -231.43700989548142, -429.7861545505732, -427.51636067837427, 2.0000000000000013, 2.0000000000000013, -484.26867345096605, -458.5111072600225, -417.1718716209876, -534.6885979623845, -377.9620633344943, -418.80847461219355, 94.26106391906154, -425.7729774589613, -318.17240408082625, -335.5971232997627, -16.857806738453903, -326.434185669448, -390.9980197205648, -358.9179413528755, 200.0, -276.49390190201797, -246.36618509042873, -293.31314262976093, -437.0732579698316, 6.7884801800421, -428.27215506633127, -196.79076075338398, -345.0306282943267, -69.22189806603366, -432.34304284643576, -45.257188373037025, -490.78469690757277, -238.32976633849074, -537.3612384160291, -469.64902600997556, -163.88339650099886, -291.5878407189903, -219.2121146237097, -114.53099879235339, -389.2434219070438, -432.9509127837569, -664.5956266469996, -287.318820522939, -558.8164592741475, -352.46693854779306, -379.82379458816166, -450.73003230502286, -502.9362814286611, -487.1865963185043, -224.94787398091438, -365.9472753746987, -429.2518226863431, -526.814915107476, -109.80777402393726, -295.80409372085643, -464.49741035742755, 200.0, 107.23081495580715, -293.5000556195622, -194.65053713874588, -527.6261443450016, -551.6835864654472, -388.4873552275704, 77.03479146645192, -122.54464590261128, -83.7247757064225, -238.8667229593558, 155.88472685564224, -378.46963629632796, -360.5953182825117, -445.6736802763093, 179.48393192864447, -364.2598421702049, -284.736534604723, -539.8409398599056, -526.1487719923911, -287.33849312652643, -390.2424370374401, -487.00491425535955, -252.97401779494174, -371.1837611279081, 137.20029141151554, -359.2366792006033, -406.00075554881084, -321.98375612212254, -398.4845548724315, -385.4755224507169, -504.7365147806279, -317.1527202387904, -377.93715929468436, -385.2552501336939, -517.0076423294475, -450.92960568002763, -300.97233223352686, -363.6514428906413, 50.84124492333635, -503.96530353588486, -381.5979989490697, -413.5052846164902, -317.53439735533766, 145.17346283316272, -412.73296529348954, -265.53651330592385, -185.10794923250978, -598.7102459284129, -400.4311921732461, -429.39831641767654, -276.47411627026855, -243.85569836481142, -107.34316480014834, -443.2763791469681, -564.3587814936944, -449.48141947895283, -428.09017958972646, -412.93707922700725, -342.17588532490134, -369.3178154585206, -485.27011983395136, -465.5336126841734, -409.35922443934976, -37.68718548599472, -464.5358405761778, -313.8429521445343, -326.31249575812495, -340.6018944201596, -365.3862608387715, -407.0067173953306, -264.38277996671326, -424.06406347271553, -41.685195907043095, -323.45187411348553, -386.4696053679919, -441.6722187924851, 56.01222889677489, 128.01632370643364, -335.594724478079, -206.50668540545269, -350.9973342039415, -401.09341877456205, -367.4664458124947, 200.0, -514.6567151411085, -382.22578558177554, -388.5614227453813, -254.3280943515751, -195.70575972163064, -343.2162557021687, -519.1344897517758, -358.9114829623453, -397.8278807681512, -208.0312456462287, -263.72017929059774, -169.51330504111294, -125.52102927723968, -447.87245985934413, -342.69299391060594, -319.67539962544424, -191.79511863032647, -525.9672313855534, -442.16831866046334, -391.2951726575938, -386.6952410062394, -302.5399713322146, -364.6090643680847, -321.712840684415, -381.93807828789113, -514.8114422876045, -366.52488262601935, -335.74320487730625, -370.7521637399164, -419.37335769992563, -278.4236099184921, -289.01956982811254, -385.754743697212, -270.28444948998964, -397.703984806296, -329.0835759690677, -370.41393641720884, -476.8543840281488, -436.89761516172103, -401.7981821703592, -389.8860125991074, -63.40766138157508, -393.4951293456936, -321.3025834617284, -369.8338057691856, -300.29453238844576, -445.5962022924615], "policy_predator_policy_reward": [365.1884966537951, 409.7010727135043, 119.89839733976505, 162.96909867962512, 496.657940225496, 380.8654911192942, 536.365292659339, 124.55603560101557, 484.7281200887899, 0.0, 311.74625401696017, 242.48245913420257, 257.84639188777606, 421.41302551641314, 419.1592946789463, 37.56775865760946, 241.88977735984594, 400.2355191947385, 437.22226280911696, 440.96345208654736, 535.4724043353583, 386.2860297663117, 350.49847976604394, 308.07144145511177, 422.0284487765589, 363.53773614894345, 349.1569555622186, 194.44346396631747, 380.8233620037363, 402.8358541149934, 261.8117800299379, 285.71800666043043, 348.28612895457366, 265.0165730012825, 305.72161164815776, 438.0087047185102, 266.4152775184289, 376.7731489498912, 303.05808373857565, 292.38874135678213, 283.1664941974873, 405.0551480608413, 465.6286615937089, 331.92679921216836, 334.13495611555044, 531.8632166177517, 365.68111281545293, 425.2654540226834, 296.7953412702927, 225.10211462370972, 248.64900198742404, 381.8175779700842, 433.0609127837568, 664.6056266469996, 288.57871586148633, 558.8654853066159, 324.7475924402696, 411.36559695063835, 450.73003230502286, 502.9362814286611, 450.55623136851756, 282.61467796300434, 366.1372753746986, 430.30182268634314, 476.6299331002247, 468.6749119354386, 298.2908442114195, 464.5874103574275, 0.0, 54.81918504419285, 288.0488712152221, 247.23337031663385, 527.8448851586184, 551.6835864654472, 305.373933987249, 335.5234154553735, 188.82480889009085, 164.09141898669594, 209.65469904888042, 226.45293550065978, 386.07397308704145, 363.5944414901629, 408.7858972142228, 288.6720822939557, 364.3198421702048, 284.98653460472286, 539.8409398599056, 526.278771992391, 287.68849312652657, 393.3524370374402, 467.7431176721509, 334.7582729154649, 259.78779111863486, 327.1820810626111, 349.66104473930307, 411.4071700693784, 425.33342672472287, 346.07590992886975, 394.7986887878942, 506.7365147806279, 351.54094244400727, 362.9039138937287, 559.045506147813, 365.05133077624345, 503.54389180737377, 305.8521644122887, 266.49622752697, 346.6792275049166, 520.503020614359, 367.6294338642369, 420.8194431017247, 302.1998554909603, 26.936537166837297, 413.85296529348943, 312.70324245407755, 253.9469327770833, 599.7102459284129, 400.44119217324607, 390.444717436673, 344.81960748149976, 202.77333602685283, 243.11938284784642, 448.29637914696815, 564.3987814936944, 412.48285224304897, 482.6641288081279, 411.81176722251325, 343.0606527936958, 424.25964280376047, 475.46904815800343, 466.63361268417344, 409.4292244393497, 327.67591848294666, 412.97959928505935, 341.0016610827271, 304.73708402629995, 403.9053961861688, 304.3694610180603, 406.0807717855116, 272.3648354885728, 366.16830404516236, 352.85161343433026, 323.70187411348536, 386.52960536799185, 328.37478381216204, 375.2971133088045, 225.5837457819778, 276.8882989295791, 358.3264522731587, 352.6277870853242, 401.2889466111445, 361.03040506004055, 0.0, 514.6867151411085, 409.3106357701401, 358.1319426788805, 298.19738117168464, 257.5321610289594, 343.3362557021686, 519.1344897517758, 432.04969816431134, 332.46603573548464, 382.1152757158677, 185.80006957814632, 281.77929688193444, 251.540694003097, 444.21032196482105, 400.28084507662896, 319.9353996254441, 216.76511863032565, 523.5019695930127, 443.3623910258448, 500.522857855023, 312.67233981362676, 334.28576107335357, 345.4776153611894, 393.73593310925094, 283.3160014831528, 514.8214422876044, 366.62488262601926, 335.85320487730615, 370.79216373991636, 442.1437744356388, 381.47309325680703, 289.3595698281123, 385.79474369721197, 270.5146238504637, 399.7739848062959, 316.2234247647475, 357.4971578118398, 505.6071777061817, 408.8144604268446, 422.58541291604905, 382.7837332949849, 327.68028206679844, 380.15002052479093, 437.813590171531, 350.7530775835424, 303.56453238844585, 446.5962022924615]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.469565589510912, "mean_inference_ms": 77.05206668898514, "mean_action_processing_ms": 3.014811483198161, "mean_env_wait_ms": 4.612270291550586, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005321025848388672, "StateBufferConnector_ms": 0.003723621368408203, "ViewRequirementAgentConnector_ms": 0.11072194576263428}, "num_episodes": 23, "episode_return_max": 431.2682311605138, "episode_return_min": -26.59898437990254, "episode_return_mean": 90.84756163575622, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1392000, "num_agent_steps_trained": 1392000, "num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 29.65917566242055, "num_env_steps_trained_throughput_per_sec": 29.65917566242055, "timesteps_total": 348000, "num_env_steps_sampled_lifetime": 348000, "num_agent_steps_sampled_lifetime": 1392000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1392000, "timers": {"training_iteration_time_ms": 291161.999, "restore_workers_time_ms": 0.017, "training_step_time_ms": 291161.916, "sample_time_ms": 2134.97, "learn_time_ms": 289008.194, "learn_throughput": 13.84, "synch_weights_time_ms": 14.527}, "counters": {"num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_agent_steps_sampled": 1392000, "num_agent_steps_trained": 1392000}, "done": false, "training_iteration": 87, "trial_id": "b941d_00000", "date": "2024-08-19_09-01-41", "timestamp": 1724038301, "time_this_iter_s": 134.919930934906, "time_total_s": 176864.04994797707, "pid": 81115, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[32, [4, 4], 2], [64, [3, 3], 2], [128, [3, 3], 1]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [256, 256], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b29dce50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 176864.04994797707, "iterations_since_restore": 87, "perf": {"cpu_util_percent": 24.161458333333332, "ram_util_percent": 81.73854166666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 11.663664884415883, "cur_kl_coeff": 1.5187500000000005, "cur_lr": 0.00010000000000000003, "total_loss": 8.78623758169709, "policy_loss": -0.08630934597618839, "vf_loss": 8.850612941873136, "vf_explained_var": 0.10680145337468101, "kl": 0.014442112854250608, "entropy": 0.9573463066545113, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 165375.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 17.726067712824182, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.00010000000000000003, "total_loss": 8.938223921558844, "policy_loss": -0.08279654856884566, "vf_loss": 9.00503164624411, "vf_explained_var": -0.6111939528316417, "kl": 0.015791420731711414, "entropy": 0.7298959148308587, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 165375.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 352000, "num_env_steps_trained": 352000, "num_agent_steps_sampled": 1408000, "num_agent_steps_trained": 1408000}, "env_runners": {"episode_reward_max": 431.2682311605138, "episode_reward_min": -26.59898437990254, "episode_reward_mean": 83.77423951775484, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -664.5956266469996, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 664.6056266469996}, "policy_reward_mean": {"prey_policy": -316.0436292093284, "predator_policy": 357.9307489682058}, "custom_metrics": {}, "hist_stats": {"episode_reward": [221.70475158203087, 53.62543604764729, 186.6567013458583, 261.5135755252676, 90.30716797878236, 157.4141443271628, 11.097500551302423, 126.69215925811135, 0.11999999999999611, 1.3089213710156002, 3.822456254953402, -7.549516567451064e-15, 21.036439032103857, 1.2400000000000002, 308.6821559042498, 2.5767504905630654, 362.05, 47.131648773548605, 0.21874081361686182, 329.44478568150436, 146.64680626775242, 353.12563844582667, 10.60345999836456, 431.2682311605138, 0.30999999999999694, 0.12999999999999412, 3.4599999999999955, 62.52245853731454, 352.9864024648529, -4.1692199407328605, 50.9410256590387, 11.323166337177303, 19.354976804261405, 21.833944460916353, 57.49411830610813, 300.3652570645821, 2.5691519936416336, -8.020383379142698, 173.23000000000002, 116.0057126927274, 1.0099999999999945, 29.391892230227718, 94.69385570974009, 5.059999999999999, 17.57538198249779, -0.24054453569925482, 45.14075566929148, 1.1700000000000004, 238.43249170583277, 5.583297206367832, 2.28670194529819, 7.056109912040869, 253.27065809973422, 0.30999999999999384, 318.011907225256, 294.89364393991144, 153.45021974908835, -6.240512915871591, 200.02999999999997, -3.344629878135912, 105.69568812743924, 0.11999999999999345, 7.776370169299662, 96.16392035718773, 238.28565656667914, 53.925713271499994, 25.230000000000132, -1.2711894271592494, 35.20478400481699, 12.614340734243932, -26.59898437990254, 0.10999999999999896, 0.14999999999999636, 125.81990007402854, 0.37999999999999257, 2.300174360474674, -25.776929809689012, 0.6696389431568073, 13.684951441567412, 250.92751186432082, 97.43027852416019, 4.27, 10.422556509887887, 1.209999999999998, 114.66163703372551, 2.948813169111025, 27.90042782863411, 195.7424118489401, 4.166526594230444, 0.1599999999999957, 219.18343743510263, 150.1829441577991, 4.953225165491183, 210.24896459965117, 118.09073707812748, 0.48999999999999533, 337.26475214855736, 5.622130700708073, 10.808252826893654, 0.09000000000000319], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [6.7884801800421, -428.27215506633127, -196.79076075338398, -345.0306282943267, -69.22189806603366, -432.34304284643576, -45.257188373037025, -490.78469690757277, -238.32976633849074, -537.3612384160291, -469.64902600997556, -163.88339650099886, -291.5878407189903, -219.2121146237097, -114.53099879235339, -389.2434219070438, -432.9509127837569, -664.5956266469996, -287.318820522939, -558.8164592741475, -352.46693854779306, -379.82379458816166, -450.73003230502286, -502.9362814286611, -487.1865963185043, -224.94787398091438, -365.9472753746987, -429.2518226863431, -526.814915107476, -109.80777402393726, -295.80409372085643, -464.49741035742755, 200.0, 107.23081495580715, -293.5000556195622, -194.65053713874588, -527.6261443450016, -551.6835864654472, -388.4873552275704, 77.03479146645192, -122.54464590261128, -83.7247757064225, -238.8667229593558, 155.88472685564224, -378.46963629632796, -360.5953182825117, -445.6736802763093, 179.48393192864447, -364.2598421702049, -284.736534604723, -539.8409398599056, -526.1487719923911, -287.33849312652643, -390.2424370374401, -487.00491425535955, -252.97401779494174, -371.1837611279081, 137.20029141151554, -359.2366792006033, -406.00075554881084, -321.98375612212254, -398.4845548724315, -385.4755224507169, -504.7365147806279, -317.1527202387904, -377.93715929468436, -385.2552501336939, -517.0076423294475, -450.92960568002763, -300.97233223352686, -363.6514428906413, 50.84124492333635, -503.96530353588486, -381.5979989490697, -413.5052846164902, -317.53439735533766, 145.17346283316272, -412.73296529348954, -265.53651330592385, -185.10794923250978, -598.7102459284129, -400.4311921732461, -429.39831641767654, -276.47411627026855, -243.85569836481142, -107.34316480014834, -443.2763791469681, -564.3587814936944, -449.48141947895283, -428.09017958972646, -412.93707922700725, -342.17588532490134, -369.3178154585206, -485.27011983395136, -465.5336126841734, -409.35922443934976, -37.68718548599472, -464.5358405761778, -313.8429521445343, -326.31249575812495, -340.6018944201596, -365.3862608387715, -407.0067173953306, -264.38277996671326, -424.06406347271553, -41.685195907043095, -323.45187411348553, -386.4696053679919, -441.6722187924851, 56.01222889677489, 128.01632370643364, -335.594724478079, -206.50668540545269, -350.9973342039415, -401.09341877456205, -367.4664458124947, 200.0, -514.6567151411085, -382.22578558177554, -388.5614227453813, -254.3280943515751, -195.70575972163064, -343.2162557021687, -519.1344897517758, -358.9114829623453, -397.8278807681512, -208.0312456462287, -263.72017929059774, -169.51330504111294, -125.52102927723968, -447.87245985934413, -342.69299391060594, -319.67539962544424, -191.79511863032647, -525.9672313855534, -442.16831866046334, -391.2951726575938, -386.6952410062394, -302.5399713322146, -364.6090643680847, -321.712840684415, -381.93807828789113, -514.8114422876045, -366.52488262601935, -335.74320487730625, -370.7521637399164, -419.37335769992563, -278.4236099184921, -289.01956982811254, -385.754743697212, -270.28444948998964, -397.703984806296, -329.0835759690677, -370.41393641720884, -476.8543840281488, -436.89761516172103, -401.7981821703592, -389.8860125991074, -63.40766138157508, -393.4951293456936, -321.3025834617284, -369.8338057691856, -300.29453238844576, -445.5962022924615, -246.53005246374295, -212.14944153314823, -329.05518877311215, -418.0117768882493, -326.8979831849711, -4.0991199790528015, -270.62747653865847, -386.6505980936812, -226.5542362018048, -413.0768558581346, 39.05726699693647, -353.9650797584152, -267.99272002449703, -350.8370913318525, -422.57506861643014, -381.15530446688405, 35.43536423448727, -318.0755578605286, 135.25190317618248, -389.63364233139504, -354.6343997954233, -337.4575975091531, -427.15233025662553, -62.64510269322785, -147.18394032793833, -387.71063428239853, -455.88360070688907, -367.3497971062351, -432.9828973640615, 56.82183307755093, -291.8923073384394, -530.3380685998129, -396.484999019559, -290.41916451977136, -431.312090033262, -371.53157362413543], "policy_predator_policy_reward": [266.4152775184289, 376.7731489498912, 303.05808373857565, 292.38874135678213, 283.1664941974873, 405.0551480608413, 465.6286615937089, 331.92679921216836, 334.13495611555044, 531.8632166177517, 365.68111281545293, 425.2654540226834, 296.7953412702927, 225.10211462370972, 248.64900198742404, 381.8175779700842, 433.0609127837568, 664.6056266469996, 288.57871586148633, 558.8654853066159, 324.7475924402696, 411.36559695063835, 450.73003230502286, 502.9362814286611, 450.55623136851756, 282.61467796300434, 366.1372753746986, 430.30182268634314, 476.6299331002247, 468.6749119354386, 298.2908442114195, 464.5874103574275, 0.0, 54.81918504419285, 288.0488712152221, 247.23337031663385, 527.8448851586184, 551.6835864654472, 305.373933987249, 335.5234154553735, 188.82480889009085, 164.09141898669594, 209.65469904888042, 226.45293550065978, 386.07397308704145, 363.5944414901629, 408.7858972142228, 288.6720822939557, 364.3198421702048, 284.98653460472286, 539.8409398599056, 526.278771992391, 287.68849312652657, 393.3524370374402, 467.7431176721509, 334.7582729154649, 259.78779111863486, 327.1820810626111, 349.66104473930307, 411.4071700693784, 425.33342672472287, 346.07590992886975, 394.7986887878942, 506.7365147806279, 351.54094244400727, 362.9039138937287, 559.045506147813, 365.05133077624345, 503.54389180737377, 305.8521644122887, 266.49622752697, 346.6792275049166, 520.503020614359, 367.6294338642369, 420.8194431017247, 302.1998554909603, 26.936537166837297, 413.85296529348943, 312.70324245407755, 253.9469327770833, 599.7102459284129, 400.44119217324607, 390.444717436673, 344.81960748149976, 202.77333602685283, 243.11938284784642, 448.29637914696815, 564.3987814936944, 412.48285224304897, 482.6641288081279, 411.81176722251325, 343.0606527936958, 424.25964280376047, 475.46904815800343, 466.63361268417344, 409.4292244393497, 327.67591848294666, 412.97959928505935, 341.0016610827271, 304.73708402629995, 403.9053961861688, 304.3694610180603, 406.0807717855116, 272.3648354885728, 366.16830404516236, 352.85161343433026, 323.70187411348536, 386.52960536799185, 328.37478381216204, 375.2971133088045, 225.5837457819778, 276.8882989295791, 358.3264522731587, 352.6277870853242, 401.2889466111445, 361.03040506004055, 0.0, 514.6867151411085, 409.3106357701401, 358.1319426788805, 298.19738117168464, 257.5321610289594, 343.3362557021686, 519.1344897517758, 432.04969816431134, 332.46603573548464, 382.1152757158677, 185.80006957814632, 281.77929688193444, 251.540694003097, 444.21032196482105, 400.28084507662896, 319.9353996254441, 216.76511863032565, 523.5019695930127, 443.3623910258448, 500.522857855023, 312.67233981362676, 334.28576107335357, 345.4776153611894, 393.73593310925094, 283.3160014831528, 514.8214422876044, 366.62488262601926, 335.85320487730615, 370.79216373991636, 442.1437744356388, 381.47309325680703, 289.3595698281123, 385.79474369721197, 270.5146238504637, 399.7739848062959, 316.2234247647475, 357.4971578118398, 505.6071777061817, 408.8144604268446, 422.58541291604905, 382.7837332949849, 327.68028206679844, 380.15002052479093, 437.813590171531, 350.7530775835424, 303.56453238844585, 446.5962022924615, 240.40512232458542, 228.69692818219252, 330.2551887731122, 418.0217768882493, 0.9520219424761238, 444.70671825527364, 281.02135390963537, 379.2055338918149, 279.5962578524889, 387.9352620360838, 249.24317235412423, 261.4070522562946, 294.68478626196384, 328.31155168861596, 422.69506861643004, 381.195304466884, 245.90970171412005, 255.91392934702438, 13.01578387760258, 391.54889943540894, 310.6372919256832, 386.40793054438376, 299.1164166431361, 400.9299809063691, 316.25788789105513, 336.727423797409, 456.2836007068887, 367.439797106235, 335.5040885808849, 377.92172785418336, 322.3844011181857, 505.46810552077477, 404.67871877401603, 293.03369759220766, 431.36209003326195, 371.5715736241354]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.408386847547422, "mean_inference_ms": 76.27273216198728, "mean_action_processing_ms": 2.9857925483286905, "mean_env_wait_ms": 4.566072336958202, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005334734916687012, "StateBufferConnector_ms": 0.0036945343017578125, "ViewRequirementAgentConnector_ms": 0.11147332191467285}, "num_episodes": 18, "episode_return_max": 431.2682311605138, "episode_return_min": -26.59898437990254, "episode_return_mean": 83.77423951775484, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1408000, "num_agent_steps_trained": 1408000, "num_env_steps_sampled": 352000, "num_env_steps_trained": 352000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 28.953771216475527, "num_env_steps_trained_throughput_per_sec": 28.953771216475527, "timesteps_total": 352000, "num_env_steps_sampled_lifetime": 352000, "num_agent_steps_sampled_lifetime": 1408000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1408000, "timers": {"training_iteration_time_ms": 134241.949, "restore_workers_time_ms": 0.013, "training_step_time_ms": 134241.872, "sample_time_ms": 2251.507, "learn_time_ms": 131971.813, "learn_throughput": 30.31, "synch_weights_time_ms": 14.232}, "counters": {"num_env_steps_sampled": 352000, "num_env_steps_trained": 352000, "num_agent_steps_sampled": 1408000, "num_agent_steps_trained": 1408000}, "done": false, "training_iteration": 88, "trial_id": "b941d_00000", "date": "2024-08-19_09-03-59", "timestamp": 1724038439, "time_this_iter_s": 138.20489120483398, "time_total_s": 177002.2548391819, "pid": 81115, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[32, [4, 4], 2], [64, [3, 3], 2], [128, [3, 3], 1]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [256, 256], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b29cad30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 177002.2548391819, "iterations_since_restore": 88, "perf": {"cpu_util_percent": 29.490816326530616, "ram_util_percent": 81.66836734693878}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 12.484139651785451, "cur_kl_coeff": 1.5187500000000005, "cur_lr": 0.00010000000000000003, "total_loss": 9.208877033152909, "policy_loss": -0.09457145573241173, "vf_loss": 9.280170213608514, "vf_explained_var": -0.4373040313443179, "kl": 0.015327268545549498, "entropy": 0.9409018893090505, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 167265.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 18.405571133749827, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.00010000000000000003, "total_loss": 9.35563643521102, "policy_loss": -0.0929348565387988, "vf_loss": 9.431598170346053, "vf_explained_var": -0.8827198084069308, "kl": 0.016763594430565756, "entropy": 0.8057711304180206, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 167265.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 356000, "num_env_steps_trained": 356000, "num_agent_steps_sampled": 1424000, "num_agent_steps_trained": 1424000}, "env_runners": {"episode_reward_max": 431.2682311605138, "episode_reward_min": -27.856377402268716, "episode_reward_mean": 67.87028909519002, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -598.7102459284129, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 599.7102459284129}, "policy_reward_mean": {"prey_policy": -328.1874938658052, "predator_policy": 362.1226384134001}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.60345999836456, 431.2682311605138, 0.30999999999999694, 0.12999999999999412, 3.4599999999999955, 62.52245853731454, 352.9864024648529, -4.1692199407328605, 50.9410256590387, 11.323166337177303, 19.354976804261405, 21.833944460916353, 57.49411830610813, 300.3652570645821, 2.5691519936416336, -8.020383379142698, 173.23000000000002, 116.0057126927274, 1.0099999999999945, 29.391892230227718, 94.69385570974009, 5.059999999999999, 17.57538198249779, -0.24054453569925482, 45.14075566929148, 1.1700000000000004, 238.43249170583277, 5.583297206367832, 2.28670194529819, 7.056109912040869, 253.27065809973422, 0.30999999999999384, 318.011907225256, 294.89364393991144, 153.45021974908835, -6.240512915871591, 200.02999999999997, -3.344629878135912, 105.69568812743924, 0.11999999999999345, 7.776370169299662, 96.16392035718773, 238.28565656667914, 53.925713271499994, 25.230000000000132, -1.2711894271592494, 35.20478400481699, 12.614340734243932, -26.59898437990254, 0.10999999999999896, 0.14999999999999636, 125.81990007402854, 0.37999999999999257, 2.300174360474674, -25.776929809689012, 0.6696389431568073, 13.684951441567412, 250.92751186432082, 97.43027852416019, 4.27, 10.422556509887887, 1.209999999999998, 114.66163703372551, 2.948813169111025, 27.90042782863411, 195.7424118489401, 4.166526594230444, 0.1599999999999957, 219.18343743510263, 150.1829441577991, 4.953225165491183, 210.24896459965117, 118.09073707812748, 0.48999999999999533, 337.26475214855736, 5.622130700708073, 10.808252826893654, 0.09000000000000319, 56.99961362931943, 87.35980177260053, 83.42628168389784, 32.12526554701974, -27.856377402268716, -15.965733806572882, 210.4260058573972, 34.70725192448231, 46.88242676697852, 117.40808842385096, -9.809808828770423, 117.07281493553025, 224.22826056785158, 2.149999999999997, 0.4044949152583164, 35.95441149415344, -9.266588038287178, 32.432233047033634, 22.36765933319746, 0.7034804280208578, 3.540350687492963, 50.73080445662858], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-378.46963629632796, -360.5953182825117, -445.6736802763093, 179.48393192864447, -364.2598421702049, -284.736534604723, -539.8409398599056, -526.1487719923911, -287.33849312652643, -390.2424370374401, -487.00491425535955, -252.97401779494174, -371.1837611279081, 137.20029141151554, -359.2366792006033, -406.00075554881084, -321.98375612212254, -398.4845548724315, -385.4755224507169, -504.7365147806279, -317.1527202387904, -377.93715929468436, -385.2552501336939, -517.0076423294475, -450.92960568002763, -300.97233223352686, -363.6514428906413, 50.84124492333635, -503.96530353588486, -381.5979989490697, -413.5052846164902, -317.53439735533766, 145.17346283316272, -412.73296529348954, -265.53651330592385, -185.10794923250978, -598.7102459284129, -400.4311921732461, -429.39831641767654, -276.47411627026855, -243.85569836481142, -107.34316480014834, -443.2763791469681, -564.3587814936944, -449.48141947895283, -428.09017958972646, -412.93707922700725, -342.17588532490134, -369.3178154585206, -485.27011983395136, -465.5336126841734, -409.35922443934976, -37.68718548599472, -464.5358405761778, -313.8429521445343, -326.31249575812495, -340.6018944201596, -365.3862608387715, -407.0067173953306, -264.38277996671326, -424.06406347271553, -41.685195907043095, -323.45187411348553, -386.4696053679919, -441.6722187924851, 56.01222889677489, 128.01632370643364, -335.594724478079, -206.50668540545269, -350.9973342039415, -401.09341877456205, -367.4664458124947, 200.0, -514.6567151411085, -382.22578558177554, -388.5614227453813, -254.3280943515751, -195.70575972163064, -343.2162557021687, -519.1344897517758, -358.9114829623453, -397.8278807681512, -208.0312456462287, -263.72017929059774, -169.51330504111294, -125.52102927723968, -447.87245985934413, -342.69299391060594, -319.67539962544424, -191.79511863032647, -525.9672313855534, -442.16831866046334, -391.2951726575938, -386.6952410062394, -302.5399713322146, -364.6090643680847, -321.712840684415, -381.93807828789113, -514.8114422876045, -366.52488262601935, -335.74320487730625, -370.7521637399164, -419.37335769992563, -278.4236099184921, -289.01956982811254, -385.754743697212, -270.28444948998964, -397.703984806296, -329.0835759690677, -370.41393641720884, -476.8543840281488, -436.89761516172103, -401.7981821703592, -389.8860125991074, -63.40766138157508, -393.4951293456936, -321.3025834617284, -369.8338057691856, -300.29453238844576, -445.5962022924615, -246.53005246374295, -212.14944153314823, -329.05518877311215, -418.0117768882493, -326.8979831849711, -4.0991199790528015, -270.62747653865847, -386.6505980936812, -226.5542362018048, -413.0768558581346, 39.05726699693647, -353.9650797584152, -267.99272002449703, -350.8370913318525, -422.57506861643014, -381.15530446688405, 35.43536423448727, -318.0755578605286, 135.25190317618248, -389.63364233139504, -354.6343997954233, -337.4575975091531, -427.15233025662553, -62.64510269322785, -147.18394032793833, -387.71063428239853, -455.88360070688907, -367.3497971062351, -432.9828973640615, 56.82183307755093, -291.8923073384394, -530.3380685998129, -396.484999019559, -290.41916451977136, -431.312090033262, -371.53157362413543, -228.72113900144694, -528.0496629582276, -333.70209666223474, -394.2466200183354, -544.7091013366907, -193.87779681473907, -259.2697252100266, -383.0460113661583, -404.20146326815825, -514.9548102435189, -486.54140922632035, -331.27166007989496, 0.28241864015590074, -304.4908411212131, -286.52300693641615, -417.4806933009258, -391.06843522112183, -219.5456580447872, -322.32043337427507, 39.961054232219354, -340.0593679452235, -402.4391368049397, -429.8630426765616, -251.50585954168858, -370.40158556435387, -91.23572594895046, -410.7494705168684, -454.8261289381191, -474.6053711784561, -292.6838192146283, -327.1785391000821, -312.90369641331444, -383.3695256943199, -382.8773713888772, -421.60698796459405, -272.7282061109987, -438.5546419576233, -448.7653229644552, -308.0055561453444, -254.98279224250865, -453.9532159485456, -583.1051503702885, -414.46843580422666, -223.66670073740465], "policy_predator_policy_reward": [386.07397308704145, 363.5944414901629, 408.7858972142228, 288.6720822939557, 364.3198421702048, 284.98653460472286, 539.8409398599056, 526.278771992391, 287.68849312652657, 393.3524370374402, 467.7431176721509, 334.7582729154649, 259.78779111863486, 327.1820810626111, 349.66104473930307, 411.4071700693784, 425.33342672472287, 346.07590992886975, 394.7986887878942, 506.7365147806279, 351.54094244400727, 362.9039138937287, 559.045506147813, 365.05133077624345, 503.54389180737377, 305.8521644122887, 266.49622752697, 346.6792275049166, 520.503020614359, 367.6294338642369, 420.8194431017247, 302.1998554909603, 26.936537166837297, 413.85296529348943, 312.70324245407755, 253.9469327770833, 599.7102459284129, 400.44119217324607, 390.444717436673, 344.81960748149976, 202.77333602685283, 243.11938284784642, 448.29637914696815, 564.3987814936944, 412.48285224304897, 482.6641288081279, 411.81176722251325, 343.0606527936958, 424.25964280376047, 475.46904815800343, 466.63361268417344, 409.4292244393497, 327.67591848294666, 412.97959928505935, 341.0016610827271, 304.73708402629995, 403.9053961861688, 304.3694610180603, 406.0807717855116, 272.3648354885728, 366.16830404516236, 352.85161343433026, 323.70187411348536, 386.52960536799185, 328.37478381216204, 375.2971133088045, 225.5837457819778, 276.8882989295791, 358.3264522731587, 352.6277870853242, 401.2889466111445, 361.03040506004055, 0.0, 514.6867151411085, 409.3106357701401, 358.1319426788805, 298.19738117168464, 257.5321610289594, 343.3362557021686, 519.1344897517758, 432.04969816431134, 332.46603573548464, 382.1152757158677, 185.80006957814632, 281.77929688193444, 251.540694003097, 444.21032196482105, 400.28084507662896, 319.9353996254441, 216.76511863032565, 523.5019695930127, 443.3623910258448, 500.522857855023, 312.67233981362676, 334.28576107335357, 345.4776153611894, 393.73593310925094, 283.3160014831528, 514.8214422876044, 366.62488262601926, 335.85320487730615, 370.79216373991636, 442.1437744356388, 381.47309325680703, 289.3595698281123, 385.79474369721197, 270.5146238504637, 399.7739848062959, 316.2234247647475, 357.4971578118398, 505.6071777061817, 408.8144604268446, 422.58541291604905, 382.7837332949849, 327.68028206679844, 380.15002052479093, 437.813590171531, 350.7530775835424, 303.56453238844585, 446.5962022924615, 240.40512232458542, 228.69692818219252, 330.2551887731122, 418.0217768882493, 0.9520219424761238, 444.70671825527364, 281.02135390963537, 379.2055338918149, 279.5962578524889, 387.9352620360838, 249.24317235412423, 261.4070522562946, 294.68478626196384, 328.31155168861596, 422.69506861643004, 381.195304466884, 245.90970171412005, 255.91392934702438, 13.01578387760258, 391.54889943540894, 310.6372919256832, 386.40793054438376, 299.1164166431361, 400.9299809063691, 316.25788789105513, 336.727423797409, 456.2836007068887, 367.439797106235, 335.5040885808849, 377.92172785418336, 322.3844011181857, 505.46810552077477, 404.67871877401603, 293.03369759220766, 431.36209003326195, 371.5715736241354, 307.01332793080456, 506.75708765818973, 422.9728542399094, 392.33566421326077, 533.3744353541105, 288.6387444812165, 359.61510706538894, 314.82589505781624, 461.6798979067871, 429.619998202621, 408.91849376783836, 392.928841731804, 245.79484226116386, 268.83958607729045, 325.6713802297793, 413.0395719320446, 365.47236152362154, 292.02415850926496, 346.24709997941926, 53.52036758648695, 451.24071783044104, 281.4479780909517, 365.58820415590185, 432.8535129978783, 355.04870978594056, 330.8168622952157, 412.8894705168683, 454.8361289381191, 474.8542544332355, 292.8394308751072, 349.73594333306767, 326.30070367448155, 400.15006574586926, 356.8302432990401, 421.60698796459405, 305.16043915803226, 442.924579254419, 466.76304500085655, 127.01107770970059, 436.6807511061727, 457.49356663603834, 583.1051503702885, 325.93436316469723, 362.93157783356247]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.483157840338217, "mean_inference_ms": 75.08653427373936, "mean_action_processing_ms": 2.957982244749342, "mean_env_wait_ms": 4.901422741657009, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005447745323181152, "StateBufferConnector_ms": 0.003523111343383789, "ViewRequirementAgentConnector_ms": 0.11591565608978271}, "num_episodes": 22, "episode_return_max": 431.2682311605138, "episode_return_min": -27.856377402268716, "episode_return_mean": 67.87028909519002, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1424000, "num_agent_steps_trained": 1424000, "num_env_steps_sampled": 356000, "num_env_steps_trained": 356000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 29.64111940952046, "num_env_steps_trained_throughput_per_sec": 29.64111940952046, "timesteps_total": 356000, "num_env_steps_sampled_lifetime": 356000, "num_agent_steps_sampled_lifetime": 1424000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1424000, "timers": {"training_iteration_time_ms": 134159.555, "restore_workers_time_ms": 0.013, "training_step_time_ms": 134159.478, "sample_time_ms": 2266.322, "learn_time_ms": 131874.91, "learn_throughput": 30.332, "synch_weights_time_ms": 13.981}, "counters": {"num_env_steps_sampled": 356000, "num_env_steps_trained": 356000, "num_agent_steps_sampled": 1424000, "num_agent_steps_trained": 1424000}, "done": false, "training_iteration": 89, "trial_id": "b941d_00000", "date": "2024-08-19_09-06-14", "timestamp": 1724038574, "time_this_iter_s": 135.00628685951233, "time_total_s": 177137.2611260414, "pid": 81115, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[32, [4, 4], 2], [64, [3, 3], 2], [128, [3, 3], 1]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [256, 256], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b042d940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 177137.2611260414, "iterations_since_restore": 89, "perf": {"cpu_util_percent": 25.13489583333333, "ram_util_percent": 81.45572916666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 14.177547530900865, "cur_kl_coeff": 1.5187500000000005, "cur_lr": 0.00010000000000000003, "total_loss": 8.459258465287547, "policy_loss": -0.08304799621845915, "vf_loss": 8.52113174080218, "vf_explained_var": -0.056662558090119136, "kl": 0.01394218930125125, "entropy": 0.9644989865482169, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 169155.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 16.675449108509792, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.00010000000000000003, "total_loss": 9.184259727266099, "policy_loss": -0.08501063739811933, "vf_loss": 9.252520946977, "vf_explained_var": -0.7383695151440051, "kl": 0.016542631747636302, "entropy": 0.7753080914575586, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 169155.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_agent_steps_sampled": 1440000, "num_agent_steps_trained": 1440000}, "env_runners": {"episode_reward_max": 337.26475214855736, "episode_reward_min": -32.901046004622025, "episode_reward_mean": 59.435695271148106, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -598.7102459284129, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 599.7102459284129}, "policy_reward_mean": {"prey_policy": -328.68038078247844, "predator_policy": 358.3982284180524}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1.0099999999999945, 29.391892230227718, 94.69385570974009, 5.059999999999999, 17.57538198249779, -0.24054453569925482, 45.14075566929148, 1.1700000000000004, 238.43249170583277, 5.583297206367832, 2.28670194529819, 7.056109912040869, 253.27065809973422, 0.30999999999999384, 318.011907225256, 294.89364393991144, 153.45021974908835, -6.240512915871591, 200.02999999999997, -3.344629878135912, 105.69568812743924, 0.11999999999999345, 7.776370169299662, 96.16392035718773, 238.28565656667914, 53.925713271499994, 25.230000000000132, -1.2711894271592494, 35.20478400481699, 12.614340734243932, -26.59898437990254, 0.10999999999999896, 0.14999999999999636, 125.81990007402854, 0.37999999999999257, 2.300174360474674, -25.776929809689012, 0.6696389431568073, 13.684951441567412, 250.92751186432082, 97.43027852416019, 4.27, 10.422556509887887, 1.209999999999998, 114.66163703372551, 2.948813169111025, 27.90042782863411, 195.7424118489401, 4.166526594230444, 0.1599999999999957, 219.18343743510263, 150.1829441577991, 4.953225165491183, 210.24896459965117, 118.09073707812748, 0.48999999999999533, 337.26475214855736, 5.622130700708073, 10.808252826893654, 0.09000000000000319, 56.99961362931943, 87.35980177260053, 83.42628168389784, 32.12526554701974, -27.856377402268716, -15.965733806572882, 210.4260058573972, 34.70725192448231, 46.88242676697852, 117.40808842385096, -9.809808828770423, 117.07281493553025, 224.22826056785158, 2.149999999999997, 0.4044949152583164, 35.95441149415344, -9.266588038287178, 32.432233047033634, 22.36765933319746, 0.7034804280208578, 3.540350687492963, 50.73080445662858, 106.67496714921957, 12.779999999999978, 23.903818417364473, 0.4099999999999966, 120.3600000000001, 156.82404930636127, -20.010746409837726, 7.114510093537007, 156.43269262746801, -32.901046004622025, 0.33999999999999986, 42.8964873200533, -4.997250639934403, 24.902075044612758, 55.36738921073536, 99.90285743988625, 1.1038834764831875, 7.645232724104828], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-598.7102459284129, -400.4311921732461, -429.39831641767654, -276.47411627026855, -243.85569836481142, -107.34316480014834, -443.2763791469681, -564.3587814936944, -449.48141947895283, -428.09017958972646, -412.93707922700725, -342.17588532490134, -369.3178154585206, -485.27011983395136, -465.5336126841734, -409.35922443934976, -37.68718548599472, -464.5358405761778, -313.8429521445343, -326.31249575812495, -340.6018944201596, -365.3862608387715, -407.0067173953306, -264.38277996671326, -424.06406347271553, -41.685195907043095, -323.45187411348553, -386.4696053679919, -441.6722187924851, 56.01222889677489, 128.01632370643364, -335.594724478079, -206.50668540545269, -350.9973342039415, -401.09341877456205, -367.4664458124947, 200.0, -514.6567151411085, -382.22578558177554, -388.5614227453813, -254.3280943515751, -195.70575972163064, -343.2162557021687, -519.1344897517758, -358.9114829623453, -397.8278807681512, -208.0312456462287, -263.72017929059774, -169.51330504111294, -125.52102927723968, -447.87245985934413, -342.69299391060594, -319.67539962544424, -191.79511863032647, -525.9672313855534, -442.16831866046334, -391.2951726575938, -386.6952410062394, -302.5399713322146, -364.6090643680847, -321.712840684415, -381.93807828789113, -514.8114422876045, -366.52488262601935, -335.74320487730625, -370.7521637399164, -419.37335769992563, -278.4236099184921, -289.01956982811254, -385.754743697212, -270.28444948998964, -397.703984806296, -329.0835759690677, -370.41393641720884, -476.8543840281488, -436.89761516172103, -401.7981821703592, -389.8860125991074, -63.40766138157508, -393.4951293456936, -321.3025834617284, -369.8338057691856, -300.29453238844576, -445.5962022924615, -246.53005246374295, -212.14944153314823, -329.05518877311215, -418.0117768882493, -326.8979831849711, -4.0991199790528015, -270.62747653865847, -386.6505980936812, -226.5542362018048, -413.0768558581346, 39.05726699693647, -353.9650797584152, -267.99272002449703, -350.8370913318525, -422.57506861643014, -381.15530446688405, 35.43536423448727, -318.0755578605286, 135.25190317618248, -389.63364233139504, -354.6343997954233, -337.4575975091531, -427.15233025662553, -62.64510269322785, -147.18394032793833, -387.71063428239853, -455.88360070688907, -367.3497971062351, -432.9828973640615, 56.82183307755093, -291.8923073384394, -530.3380685998129, -396.484999019559, -290.41916451977136, -431.312090033262, -371.53157362413543, -228.72113900144694, -528.0496629582276, -333.70209666223474, -394.2466200183354, -544.7091013366907, -193.87779681473907, -259.2697252100266, -383.0460113661583, -404.20146326815825, -514.9548102435189, -486.54140922632035, -331.27166007989496, 0.28241864015590074, -304.4908411212131, -286.52300693641615, -417.4806933009258, -391.06843522112183, -219.5456580447872, -322.32043337427507, 39.961054232219354, -340.0593679452235, -402.4391368049397, -429.8630426765616, -251.50585954168858, -370.40158556435387, -91.23572594895046, -410.7494705168684, -454.8261289381191, -474.6053711784561, -292.6838192146283, -327.1785391000821, -312.90369641331444, -383.3695256943199, -382.8773713888772, -421.60698796459405, -272.7282061109987, -438.5546419576233, -448.7653229644552, -308.0055561453444, -254.98279224250865, -453.9532159485456, -583.1051503702885, -414.46843580422666, -223.66670073740465, -400.2690961437223, 2.0000000000000013, -502.2391135740305, -263.0539299562599, -348.702207387641, -146.0503031781422, -406.4164087221522, -397.1273601210294, -357.2836227154594, -23.563765013495413, -130.2275016681436, -449.37893655049066, -296.1746861333108, -463.7506639240753, -412.0982720903515, -306.65397435552546, -379.7510192212493, -239.53975052373517, -326.6630246832778, -441.7579525197299, -281.300667438392, -535.5697023935218, -374.46544366430464, -274.6594784537763, -413.4993721114129, -411.65319205199063, -293.0424872892659, -529.723644949117, -392.31508835820125, -244.37375719592794, -216.625972505354, -145.77854977587168, -341.6270605631694, -412.572068708185, -340.1921874449646, -347.0508857420863], "policy_predator_policy_reward": [599.7102459284129, 400.44119217324607, 390.444717436673, 344.81960748149976, 202.77333602685283, 243.11938284784642, 448.29637914696815, 564.3987814936944, 412.48285224304897, 482.6641288081279, 411.81176722251325, 343.0606527936958, 424.25964280376047, 475.46904815800343, 466.63361268417344, 409.4292244393497, 327.67591848294666, 412.97959928505935, 341.0016610827271, 304.73708402629995, 403.9053961861688, 304.3694610180603, 406.0807717855116, 272.3648354885728, 366.16830404516236, 352.85161343433026, 323.70187411348536, 386.52960536799185, 328.37478381216204, 375.2971133088045, 225.5837457819778, 276.8882989295791, 358.3264522731587, 352.6277870853242, 401.2889466111445, 361.03040506004055, 0.0, 514.6867151411085, 409.3106357701401, 358.1319426788805, 298.19738117168464, 257.5321610289594, 343.3362557021686, 519.1344897517758, 432.04969816431134, 332.46603573548464, 382.1152757158677, 185.80006957814632, 281.77929688193444, 251.540694003097, 444.21032196482105, 400.28084507662896, 319.9353996254441, 216.76511863032565, 523.5019695930127, 443.3623910258448, 500.522857855023, 312.67233981362676, 334.28576107335357, 345.4776153611894, 393.73593310925094, 283.3160014831528, 514.8214422876044, 366.62488262601926, 335.85320487730615, 370.79216373991636, 442.1437744356388, 381.47309325680703, 289.3595698281123, 385.79474369721197, 270.5146238504637, 399.7739848062959, 316.2234247647475, 357.4971578118398, 505.6071777061817, 408.8144604268446, 422.58541291604905, 382.7837332949849, 327.68028206679844, 380.15002052479093, 437.813590171531, 350.7530775835424, 303.56453238844585, 446.5962022924615, 240.40512232458542, 228.69692818219252, 330.2551887731122, 418.0217768882493, 0.9520219424761238, 444.70671825527364, 281.02135390963537, 379.2055338918149, 279.5962578524889, 387.9352620360838, 249.24317235412423, 261.4070522562946, 294.68478626196384, 328.31155168861596, 422.69506861643004, 381.195304466884, 245.90970171412005, 255.91392934702438, 13.01578387760258, 391.54889943540894, 310.6372919256832, 386.40793054438376, 299.1164166431361, 400.9299809063691, 316.25788789105513, 336.727423797409, 456.2836007068887, 367.439797106235, 335.5040885808849, 377.92172785418336, 322.3844011181857, 505.46810552077477, 404.67871877401603, 293.03369759220766, 431.36209003326195, 371.5715736241354, 307.01332793080456, 506.75708765818973, 422.9728542399094, 392.33566421326077, 533.3744353541105, 288.6387444812165, 359.61510706538894, 314.82589505781624, 461.6798979067871, 429.619998202621, 408.91849376783836, 392.928841731804, 245.79484226116386, 268.83958607729045, 325.6713802297793, 413.0395719320446, 365.47236152362154, 292.02415850926496, 346.24709997941926, 53.52036758648695, 451.24071783044104, 281.4479780909517, 365.58820415590185, 432.8535129978783, 355.04870978594056, 330.8168622952157, 412.8894705168683, 454.8361289381191, 474.8542544332355, 292.8394308751072, 349.73594333306767, 326.30070367448155, 400.15006574586926, 356.8302432990401, 421.60698796459405, 305.16043915803226, 442.924579254419, 466.76304500085655, 127.01107770970059, 436.6807511061727, 457.49356663603834, 583.1051503702885, 325.93436316469723, 362.93157783356247, 225.59987141667008, 279.34419187627105, 502.80911357403, 275.2639299562598, 347.7106972425581, 170.94563174058953, 406.56640872215206, 397.3873601210292, 366.55362271545914, 134.65376501349533, 409.44641728404514, 326.98407024094934, 276.0839397234726, 463.8306639240752, 418.68417980148644, 307.1825767379272, 357.4523031598152, 418.27115921263675, 295.6060597865485, 439.91387141183725, 281.5406674383919, 535.6697023935217, 324.1812916256828, 367.84011781245067, 417.7606746234163, 402.39463890005266, 529.6164156514129, 318.0517916315827, 368.1515675492282, 323.90466721563575, 300.7762895682117, 161.53109015289914, 342.6609440396524, 412.6420687081849, 368.1684472751443, 326.7198586360115]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.284758840571283, "mean_inference_ms": 74.63370828770218, "mean_action_processing_ms": 2.9300872065649712, "mean_env_wait_ms": 4.459174649702251, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00504457950592041, "StateBufferConnector_ms": 0.00353240966796875, "ViewRequirementAgentConnector_ms": 0.1142951250076294}, "num_episodes": 18, "episode_return_max": 337.26475214855736, "episode_return_min": -32.901046004622025, "episode_return_mean": 59.435695271148106, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1440000, "num_agent_steps_trained": 1440000, "num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 9.03161512103116, "num_env_steps_trained_throughput_per_sec": 9.03161512103116, "timesteps_total": 360000, "num_env_steps_sampled_lifetime": 360000, "num_agent_steps_sampled_lifetime": 1440000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1440000, "timers": {"training_iteration_time_ms": 165033.02, "restore_workers_time_ms": 0.013, "training_step_time_ms": 165032.946, "sample_time_ms": 2251.283, "learn_time_ms": 162763.576, "learn_throughput": 24.576, "synch_weights_time_ms": 13.809}, "counters": {"num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_agent_steps_sampled": 1440000, "num_agent_steps_trained": 1440000}, "done": false, "training_iteration": 90, "trial_id": "b941d_00000", "date": "2024-08-19_09-13-37", "timestamp": 1724039017, "time_this_iter_s": 442.9348349571228, "time_total_s": 177580.19596099854, "pid": 81115, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[32, [4, 4], 2], [64, [3, 3], 2], [128, [3, 3], 1]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [256, 256], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b29dc790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 177580.19596099854, "iterations_since_restore": 90, "perf": {"cpu_util_percent": 27.41578947368421, "ram_util_percent": 81.52947368421053}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 12.8776893041752, "cur_kl_coeff": 1.5187500000000005, "cur_lr": 0.00010000000000000003, "total_loss": 9.07741548296005, "policy_loss": -0.0857336483972157, "vf_loss": 9.142559230642975, "vf_explained_var": -0.5855513229256585, "kl": 0.013557147106765853, "entropy": 0.9189946382134049, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 171045.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 17.88266764052961, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.00010000000000000003, "total_loss": 8.890154081173044, "policy_loss": -0.0881582660413293, "vf_loss": 8.961412348570647, "vf_explained_var": -0.5053662372959985, "kl": 0.016691335729540846, "entropy": 0.7758218836847437, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 171045.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 364000, "num_env_steps_trained": 364000, "num_agent_steps_sampled": 1456000, "num_agent_steps_trained": 1456000}, "env_runners": {"episode_reward_max": 337.26475214855736, "episode_reward_min": -32.901046004622025, "episode_reward_mean": 55.18226740822233, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -583.1051503702885, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 135.25190317618248, "predator_policy": 583.1051503702885}, "policy_reward_mean": {"prey_policy": -323.7308541311904, "predator_policy": 351.32198783530146}, "custom_metrics": {}, "hist_stats": {"episode_reward": [96.16392035718773, 238.28565656667914, 53.925713271499994, 25.230000000000132, -1.2711894271592494, 35.20478400481699, 12.614340734243932, -26.59898437990254, 0.10999999999999896, 0.14999999999999636, 125.81990007402854, 0.37999999999999257, 2.300174360474674, -25.776929809689012, 0.6696389431568073, 13.684951441567412, 250.92751186432082, 97.43027852416019, 4.27, 10.422556509887887, 1.209999999999998, 114.66163703372551, 2.948813169111025, 27.90042782863411, 195.7424118489401, 4.166526594230444, 0.1599999999999957, 219.18343743510263, 150.1829441577991, 4.953225165491183, 210.24896459965117, 118.09073707812748, 0.48999999999999533, 337.26475214855736, 5.622130700708073, 10.808252826893654, 0.09000000000000319, 56.99961362931943, 87.35980177260053, 83.42628168389784, 32.12526554701974, -27.856377402268716, -15.965733806572882, 210.4260058573972, 34.70725192448231, 46.88242676697852, 117.40808842385096, -9.809808828770423, 117.07281493553025, 224.22826056785158, 2.149999999999997, 0.4044949152583164, 35.95441149415344, -9.266588038287178, 32.432233047033634, 22.36765933319746, 0.7034804280208578, 3.540350687492963, 50.73080445662858, 106.67496714921957, 12.779999999999978, 23.903818417364473, 0.4099999999999966, 120.3600000000001, 156.82404930636127, -20.010746409837726, 7.114510093537007, 156.43269262746801, -32.901046004622025, 0.33999999999999986, 42.8964873200533, -4.997250639934403, 24.902075044612758, 55.36738921073536, 99.90285743988625, 1.1038834764831875, 7.645232724104828, 4.379442190799351, 157.50874703212023, 0.12999999999999856, -27.85494336774041, -8.209165276569202, 0.8756255227628689, 28.268927144440962, 2.043157944685504, 153.07992876984545, 3.1799999999999953, 143.77740028402175, 290.5169356915214, 74.91500713220479, 7.511551643784369, 203.70921212264523, 30.80088259928922, -21.076886972635236, 159.09798121479162, 0.06373351978840014, -29.15249071290387, 171.5354535668891, 0.2699999999999959, 0.4200000000000017], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-208.0312456462287, -263.72017929059774, -169.51330504111294, -125.52102927723968, -447.87245985934413, -342.69299391060594, -319.67539962544424, -191.79511863032647, -525.9672313855534, -442.16831866046334, -391.2951726575938, -386.6952410062394, -302.5399713322146, -364.6090643680847, -321.712840684415, -381.93807828789113, -514.8114422876045, -366.52488262601935, -335.74320487730625, -370.7521637399164, -419.37335769992563, -278.4236099184921, -289.01956982811254, -385.754743697212, -270.28444948998964, -397.703984806296, -329.0835759690677, -370.41393641720884, -476.8543840281488, -436.89761516172103, -401.7981821703592, -389.8860125991074, -63.40766138157508, -393.4951293456936, -321.3025834617284, -369.8338057691856, -300.29453238844576, -445.5962022924615, -246.53005246374295, -212.14944153314823, -329.05518877311215, -418.0117768882493, -326.8979831849711, -4.0991199790528015, -270.62747653865847, -386.6505980936812, -226.5542362018048, -413.0768558581346, 39.05726699693647, -353.9650797584152, -267.99272002449703, -350.8370913318525, -422.57506861643014, -381.15530446688405, 35.43536423448727, -318.0755578605286, 135.25190317618248, -389.63364233139504, -354.6343997954233, -337.4575975091531, -427.15233025662553, -62.64510269322785, -147.18394032793833, -387.71063428239853, -455.88360070688907, -367.3497971062351, -432.9828973640615, 56.82183307755093, -291.8923073384394, -530.3380685998129, -396.484999019559, -290.41916451977136, -431.312090033262, -371.53157362413543, -228.72113900144694, -528.0496629582276, -333.70209666223474, -394.2466200183354, -544.7091013366907, -193.87779681473907, -259.2697252100266, -383.0460113661583, -404.20146326815825, -514.9548102435189, -486.54140922632035, -331.27166007989496, 0.28241864015590074, -304.4908411212131, -286.52300693641615, -417.4806933009258, -391.06843522112183, -219.5456580447872, -322.32043337427507, 39.961054232219354, -340.0593679452235, -402.4391368049397, -429.8630426765616, -251.50585954168858, -370.40158556435387, -91.23572594895046, -410.7494705168684, -454.8261289381191, -474.6053711784561, -292.6838192146283, -327.1785391000821, -312.90369641331444, -383.3695256943199, -382.8773713888772, -421.60698796459405, -272.7282061109987, -438.5546419576233, -448.7653229644552, -308.0055561453444, -254.98279224250865, -453.9532159485456, -583.1051503702885, -414.46843580422666, -223.66670073740465, -400.2690961437223, 2.0000000000000013, -502.2391135740305, -263.0539299562599, -348.702207387641, -146.0503031781422, -406.4164087221522, -397.1273601210294, -357.2836227154594, -23.563765013495413, -130.2275016681436, -449.37893655049066, -296.1746861333108, -463.7506639240753, -412.0982720903515, -306.65397435552546, -379.7510192212493, -239.53975052373517, -326.6630246832778, -441.7579525197299, -281.300667438392, -535.5697023935218, -374.46544366430464, -274.6594784537763, -413.4993721114129, -411.65319205199063, -293.0424872892659, -529.723644949117, -392.31508835820125, -244.37375719592794, -216.625972505354, -145.77854977587168, -341.6270605631694, -412.572068708185, -340.1921874449646, -347.0508857420863, -364.24512368750845, -295.8685701782252, -352.16374038174604, -118.70160895520202, -408.9512650298927, -492.616891318325, -358.33700012765127, -424.57593397667586, -425.0957395926644, -486.74981595622035, -307.6612663171118, -389.96867490353753, -328.22675578843854, -340.3307447643089, -413.5352681059088, -293.16806509706873, -195.29415190863992, -464.2851319085767, -381.4467213147347, -430.47718528696987, -244.1219005758074, -67.42404455792357, 56.79804106304256, -347.975484600297, -307.4178307668734, -338.9274890495861, -401.0447791486688, -331.3457375115414, 0.8317985914784259, -338.2494312060529, -43.06213782579681, -142.3618820338637, -337.68299322088484, -464.1897877280235, 2.0000000000000013, -447.7439475647014, -207.106561841284, -331.0433845772011, -381.6604854829199, -504.4655408972859, -55.76292705834927, -266.1445830019216, -386.751993642495, -343.7427923551345, -294.38073106814403, -410.72866675132445], "policy_predator_policy_reward": [382.1152757158677, 185.80006957814632, 281.77929688193444, 251.540694003097, 444.21032196482105, 400.28084507662896, 319.9353996254441, 216.76511863032565, 523.5019695930127, 443.3623910258448, 500.522857855023, 312.67233981362676, 334.28576107335357, 345.4776153611894, 393.73593310925094, 283.3160014831528, 514.8214422876044, 366.62488262601926, 335.85320487730615, 370.79216373991636, 442.1437744356388, 381.47309325680703, 289.3595698281123, 385.79474369721197, 270.5146238504637, 399.7739848062959, 316.2234247647475, 357.4971578118398, 505.6071777061817, 408.8144604268446, 422.58541291604905, 382.7837332949849, 327.68028206679844, 380.15002052479093, 437.813590171531, 350.7530775835424, 303.56453238844585, 446.5962022924615, 240.40512232458542, 228.69692818219252, 330.2551887731122, 418.0217768882493, 0.9520219424761238, 444.70671825527364, 281.02135390963537, 379.2055338918149, 279.5962578524889, 387.9352620360838, 249.24317235412423, 261.4070522562946, 294.68478626196384, 328.31155168861596, 422.69506861643004, 381.195304466884, 245.90970171412005, 255.91392934702438, 13.01578387760258, 391.54889943540894, 310.6372919256832, 386.40793054438376, 299.1164166431361, 400.9299809063691, 316.25788789105513, 336.727423797409, 456.2836007068887, 367.439797106235, 335.5040885808849, 377.92172785418336, 322.3844011181857, 505.46810552077477, 404.67871877401603, 293.03369759220766, 431.36209003326195, 371.5715736241354, 307.01332793080456, 506.75708765818973, 422.9728542399094, 392.33566421326077, 533.3744353541105, 288.6387444812165, 359.61510706538894, 314.82589505781624, 461.6798979067871, 429.619998202621, 408.91849376783836, 392.928841731804, 245.79484226116386, 268.83958607729045, 325.6713802297793, 413.0395719320446, 365.47236152362154, 292.02415850926496, 346.24709997941926, 53.52036758648695, 451.24071783044104, 281.4479780909517, 365.58820415590185, 432.8535129978783, 355.04870978594056, 330.8168622952157, 412.8894705168683, 454.8361289381191, 474.8542544332355, 292.8394308751072, 349.73594333306767, 326.30070367448155, 400.15006574586926, 356.8302432990401, 421.60698796459405, 305.16043915803226, 442.924579254419, 466.76304500085655, 127.01107770970059, 436.6807511061727, 457.49356663603834, 583.1051503702885, 325.93436316469723, 362.93157783356247, 225.59987141667008, 279.34419187627105, 502.80911357403, 275.2639299562598, 347.7106972425581, 170.94563174058953, 406.56640872215206, 397.3873601210292, 366.55362271545914, 134.65376501349533, 409.44641728404514, 326.98407024094934, 276.0839397234726, 463.8306639240752, 418.68417980148644, 307.1825767379272, 357.4523031598152, 418.27115921263675, 295.6060597865485, 439.91387141183725, 281.5406674383919, 535.6697023935217, 324.1812916256828, 367.84011781245067, 417.7606746234163, 402.39463890005266, 529.6164156514129, 318.0517916315827, 368.1515675492282, 323.90466721563575, 300.7762895682117, 161.53109015289914, 342.6609440396524, 412.6420687081849, 368.1684472751443, 326.7198586360115, 367.23192052608044, 297.2612155304525, 283.684581175652, 344.68951519341687, 409.00126502989264, 492.6968913183249, 367.41273790676917, 387.6452528298174, 429.52662192497985, 474.10976834733594, 324.6363093840092, 373.8692573594028, 321.6732135505002, 375.15321414668756, 415.51791357268615, 293.22857757497684, 357.9106645889254, 454.7485479981358, 381.56672131473465, 433.5371852869698, 455.32334541775293, 0.0, 283.77978117636684, 297.9145980524091, 333.33934261058016, 387.9209843380834, 406.377580317044, 333.5244879869506, 280.71527652665185, 260.41156821056853, 120.68231057237128, 95.54259188657664, 334.8310898398961, 445.96480413637715, 252.23982142106394, 352.60210735842935, 203.3465016547821, 334.8671782834905, 372.0803336484906, 484.89320201881156, 356.93016039658704, 136.51280323057253, 386.82199364249493, 343.94279235513443, 294.70073106814374, 410.8286667513244]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.592400462225731, "mean_inference_ms": 73.13044090403368, "mean_action_processing_ms": 3.137998073783683, "mean_env_wait_ms": 4.416605617945727, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005388498306274414, "StateBufferConnector_ms": 0.0035227537155151367, "ViewRequirementAgentConnector_ms": 0.11542046070098877}, "num_episodes": 23, "episode_return_max": 337.26475214855736, "episode_return_min": -32.901046004622025, "episode_return_mean": 55.18226740822233, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1456000, "num_agent_steps_trained": 1456000, "num_env_steps_sampled": 364000, "num_env_steps_trained": 364000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 10.718046980362374, "num_env_steps_trained_throughput_per_sec": 10.718046980362374, "timesteps_total": 364000, "num_env_steps_sampled_lifetime": 364000, "num_agent_steps_sampled_lifetime": 1456000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1456000, "timers": {"training_iteration_time_ms": 188685.119, "restore_workers_time_ms": 0.013, "training_step_time_ms": 188685.045, "sample_time_ms": 2230.501, "learn_time_ms": 186436.115, "learn_throughput": 21.455, "synch_weights_time_ms": 14.35}, "counters": {"num_env_steps_sampled": 364000, "num_env_steps_trained": 364000, "num_agent_steps_sampled": 1456000, "num_agent_steps_trained": 1456000}, "done": false, "training_iteration": 91, "trial_id": "b941d_00000", "date": "2024-08-19_09-19-51", "timestamp": 1724039391, "time_this_iter_s": 373.2421157360077, "time_total_s": 177953.43807673454, "pid": 81115, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[32, [4, 4], 2], [64, [3, 3], 2], [128, [3, 3], 1]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [256, 256], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b37bd160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 177953.43807673454, "iterations_since_restore": 91, "perf": {"cpu_util_percent": 20.190810810810813, "ram_util_percent": 81.38756756756757}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 18.506705331928515, "cur_kl_coeff": 1.5187500000000005, "cur_lr": 0.00010000000000000003, "total_loss": 8.62431367995247, "policy_loss": -0.09215240460184831, "vf_loss": 8.694194330740228, "vf_explained_var": 0.06616093793874064, "kl": 0.014664543998980102, "entropy": 0.9574344298826954, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 172935.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 17.22681877020175, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.00010000000000000003, "total_loss": 8.959852579661778, "policy_loss": -0.08965017547062229, "vf_loss": 9.032712146214076, "vf_explained_var": -0.7664467213015077, "kl": 0.01658334281428318, "entropy": 0.7828680317868631, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 172935.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 368000, "num_env_steps_trained": 368000, "num_agent_steps_sampled": 1472000, "num_agent_steps_trained": 1472000}, "env_runners": {"episode_reward_max": 337.26475214855736, "episode_reward_min": -34.7881214844796, "episode_reward_mean": 61.9480227372847, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -583.1051503702885, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 135.25190317618248, "predator_policy": 583.1051503702885}, "policy_reward_mean": {"prey_policy": -315.6940534008544, "predator_policy": 346.66806476949665}, "custom_metrics": {}, "hist_stats": {"episode_reward": [4.27, 10.422556509887887, 1.209999999999998, 114.66163703372551, 2.948813169111025, 27.90042782863411, 195.7424118489401, 4.166526594230444, 0.1599999999999957, 219.18343743510263, 150.1829441577991, 4.953225165491183, 210.24896459965117, 118.09073707812748, 0.48999999999999533, 337.26475214855736, 5.622130700708073, 10.808252826893654, 0.09000000000000319, 56.99961362931943, 87.35980177260053, 83.42628168389784, 32.12526554701974, -27.856377402268716, -15.965733806572882, 210.4260058573972, 34.70725192448231, 46.88242676697852, 117.40808842385096, -9.809808828770423, 117.07281493553025, 224.22826056785158, 2.149999999999997, 0.4044949152583164, 35.95441149415344, -9.266588038287178, 32.432233047033634, 22.36765933319746, 0.7034804280208578, 3.540350687492963, 50.73080445662858, 106.67496714921957, 12.779999999999978, 23.903818417364473, 0.4099999999999966, 120.3600000000001, 156.82404930636127, -20.010746409837726, 7.114510093537007, 156.43269262746801, -32.901046004622025, 0.33999999999999986, 42.8964873200533, -4.997250639934403, 24.902075044612758, 55.36738921073536, 99.90285743988625, 1.1038834764831875, 7.645232724104828, 4.379442190799351, 157.50874703212023, 0.12999999999999856, -27.85494336774041, -8.209165276569202, 0.8756255227628689, 28.268927144440962, 2.043157944685504, 153.07992876984545, 3.1799999999999953, 143.77740028402175, 290.5169356915214, 74.91500713220479, 7.511551643784369, 203.70921212264523, 30.80088259928922, -21.076886972635236, 159.09798121479162, 0.06373351978840014, -29.15249071290387, 171.5354535668891, 0.2699999999999959, 0.4200000000000017, -34.7881214844796, 29.985991835766157, 4.188532697180162, -3.094522757447531, 219.72365706565165, 39.65355738765285, 82.78955430650267, 203.74384042361513, 22.262747536935812, 240.6001506564734, 137.77414308195313, 55.733286786962374, 269.9368993571388, 6.039999999999978, 72.52953053290815, 26.108948169512878, 216.30222210356078, -13.665118268263857], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-300.29453238844576, -445.5962022924615, -246.53005246374295, -212.14944153314823, -329.05518877311215, -418.0117768882493, -326.8979831849711, -4.0991199790528015, -270.62747653865847, -386.6505980936812, -226.5542362018048, -413.0768558581346, 39.05726699693647, -353.9650797584152, -267.99272002449703, -350.8370913318525, -422.57506861643014, -381.15530446688405, 35.43536423448727, -318.0755578605286, 135.25190317618248, -389.63364233139504, -354.6343997954233, -337.4575975091531, -427.15233025662553, -62.64510269322785, -147.18394032793833, -387.71063428239853, -455.88360070688907, -367.3497971062351, -432.9828973640615, 56.82183307755093, -291.8923073384394, -530.3380685998129, -396.484999019559, -290.41916451977136, -431.312090033262, -371.53157362413543, -228.72113900144694, -528.0496629582276, -333.70209666223474, -394.2466200183354, -544.7091013366907, -193.87779681473907, -259.2697252100266, -383.0460113661583, -404.20146326815825, -514.9548102435189, -486.54140922632035, -331.27166007989496, 0.28241864015590074, -304.4908411212131, -286.52300693641615, -417.4806933009258, -391.06843522112183, -219.5456580447872, -322.32043337427507, 39.961054232219354, -340.0593679452235, -402.4391368049397, -429.8630426765616, -251.50585954168858, -370.40158556435387, -91.23572594895046, -410.7494705168684, -454.8261289381191, -474.6053711784561, -292.6838192146283, -327.1785391000821, -312.90369641331444, -383.3695256943199, -382.8773713888772, -421.60698796459405, -272.7282061109987, -438.5546419576233, -448.7653229644552, -308.0055561453444, -254.98279224250865, -453.9532159485456, -583.1051503702885, -414.46843580422666, -223.66670073740465, -400.2690961437223, 2.0000000000000013, -502.2391135740305, -263.0539299562599, -348.702207387641, -146.0503031781422, -406.4164087221522, -397.1273601210294, -357.2836227154594, -23.563765013495413, -130.2275016681436, -449.37893655049066, -296.1746861333108, -463.7506639240753, -412.0982720903515, -306.65397435552546, -379.7510192212493, -239.53975052373517, -326.6630246832778, -441.7579525197299, -281.300667438392, -535.5697023935218, -374.46544366430464, -274.6594784537763, -413.4993721114129, -411.65319205199063, -293.0424872892659, -529.723644949117, -392.31508835820125, -244.37375719592794, -216.625972505354, -145.77854977587168, -341.6270605631694, -412.572068708185, -340.1921874449646, -347.0508857420863, -364.24512368750845, -295.8685701782252, -352.16374038174604, -118.70160895520202, -408.9512650298927, -492.616891318325, -358.33700012765127, -424.57593397667586, -425.0957395926644, -486.74981595622035, -307.6612663171118, -389.96867490353753, -328.22675578843854, -340.3307447643089, -413.5352681059088, -293.16806509706873, -195.29415190863992, -464.2851319085767, -381.4467213147347, -430.47718528696987, -244.1219005758074, -67.42404455792357, 56.79804106304256, -347.975484600297, -307.4178307668734, -338.9274890495861, -401.0447791486688, -331.3457375115414, 0.8317985914784259, -338.2494312060529, -43.06213782579681, -142.3618820338637, -337.68299322088484, -464.1897877280235, 2.0000000000000013, -447.7439475647014, -207.106561841284, -331.0433845772011, -381.6604854829199, -504.4655408972859, -55.76292705834927, -266.1445830019216, -386.751993642495, -343.7427923551345, -294.38073106814403, -410.72866675132445, -491.220446870878, -359.0696376536102, -338.4027397342002, -418.6820864920636, -306.4036781287645, -431.9732078466904, -355.4357375214555, -410.42743215764443, -464.04606005088914, -94.89737873524962, -328.16950447681705, -253.0905546199812, -263.89666010209896, -216.18564595408856, -135.89141777183548, -364.1759128000964, -302.6394313952229, -378.28767171733915, 2.0000000000000013, -486.17777650979383, -169.10343018878245, -69.63282834225672, -215.4240775755243, -386.6253107150616, -502.14707402030626, 28.94808480966781, -311.0881375840343, 2.0000000000000013, -306.86993817806075, -360.99677722294433, -283.54783077286663, -415.67659910792054, -416.206962702531, -77.630007871071, -474.43096861361005, -404.2469602468007], "policy_predator_policy_reward": [303.56453238844585, 446.5962022924615, 240.40512232458542, 228.69692818219252, 330.2551887731122, 418.0217768882493, 0.9520219424761238, 444.70671825527364, 281.02135390963537, 379.2055338918149, 279.5962578524889, 387.9352620360838, 249.24317235412423, 261.4070522562946, 294.68478626196384, 328.31155168861596, 422.69506861643004, 381.195304466884, 245.90970171412005, 255.91392934702438, 13.01578387760258, 391.54889943540894, 310.6372919256832, 386.40793054438376, 299.1164166431361, 400.9299809063691, 316.25788789105513, 336.727423797409, 456.2836007068887, 367.439797106235, 335.5040885808849, 377.92172785418336, 322.3844011181857, 505.46810552077477, 404.67871877401603, 293.03369759220766, 431.36209003326195, 371.5715736241354, 307.01332793080456, 506.75708765818973, 422.9728542399094, 392.33566421326077, 533.3744353541105, 288.6387444812165, 359.61510706538894, 314.82589505781624, 461.6798979067871, 429.619998202621, 408.91849376783836, 392.928841731804, 245.79484226116386, 268.83958607729045, 325.6713802297793, 413.0395719320446, 365.47236152362154, 292.02415850926496, 346.24709997941926, 53.52036758648695, 451.24071783044104, 281.4479780909517, 365.58820415590185, 432.8535129978783, 355.04870978594056, 330.8168622952157, 412.8894705168683, 454.8361289381191, 474.8542544332355, 292.8394308751072, 349.73594333306767, 326.30070367448155, 400.15006574586926, 356.8302432990401, 421.60698796459405, 305.16043915803226, 442.924579254419, 466.76304500085655, 127.01107770970059, 436.6807511061727, 457.49356663603834, 583.1051503702885, 325.93436316469723, 362.93157783356247, 225.59987141667008, 279.34419187627105, 502.80911357403, 275.2639299562598, 347.7106972425581, 170.94563174058953, 406.56640872215206, 397.3873601210292, 366.55362271545914, 134.65376501349533, 409.44641728404514, 326.98407024094934, 276.0839397234726, 463.8306639240752, 418.68417980148644, 307.1825767379272, 357.4523031598152, 418.27115921263675, 295.6060597865485, 439.91387141183725, 281.5406674383919, 535.6697023935217, 324.1812916256828, 367.84011781245067, 417.7606746234163, 402.39463890005266, 529.6164156514129, 318.0517916315827, 368.1515675492282, 323.90466721563575, 300.7762895682117, 161.53109015289914, 342.6609440396524, 412.6420687081849, 368.1684472751443, 326.7198586360115, 367.23192052608044, 297.2612155304525, 283.684581175652, 344.68951519341687, 409.00126502989264, 492.6968913183249, 367.41273790676917, 387.6452528298174, 429.52662192497985, 474.10976834733594, 324.6363093840092, 373.8692573594028, 321.6732135505002, 375.15321414668756, 415.51791357268615, 293.22857757497684, 357.9106645889254, 454.7485479981358, 381.56672131473465, 433.5371852869698, 455.32334541775293, 0.0, 283.77978117636684, 297.9145980524091, 333.33934261058016, 387.9209843380834, 406.377580317044, 333.5244879869506, 280.71527652665185, 260.41156821056853, 120.68231057237128, 95.54259188657664, 334.8310898398961, 445.96480413637715, 252.23982142106394, 352.60210735842935, 203.3465016547821, 334.8671782834905, 372.0803336484906, 484.89320201881156, 356.93016039658704, 136.51280323057253, 386.82199364249493, 343.94279235513443, 294.70073106814374, 410.8286667513244, 414.4583695463111, 401.0435934936971, 363.091775488954, 423.9790425730755, 305.5465779925377, 437.0188406800973, 303.9138524343116, 458.8547944873406, 433.31366671341937, 345.35342913837104, 305.3098367298448, 315.6037797546065, 260.63023761709405, 302.24162274559626, 338.6664189352168, 365.14475206033006, 325.147682706289, 378.04216794320894, 401.3774037863844, 323.40052337988345, 157.07446278465844, 219.4359388283325, 249.66628825901464, 408.11638681853356, 483.31139512348443, 259.824493444293, 315.12813758403416, 0.0, 302.61233973707743, 437.78390619683506, 333.8024174958876, 391.5309605544122, 307.7974502318769, 402.3417424452856, 512.677173746502, 352.3356368456446]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.156218072960121, "mean_inference_ms": 73.04532338444439, "mean_action_processing_ms": 2.8660468143784095, "mean_env_wait_ms": 4.374157958121164, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005955815315246582, "StateBufferConnector_ms": 0.004081368446350098, "ViewRequirementAgentConnector_ms": 0.12120306491851807}, "num_episodes": 18, "episode_return_max": 337.26475214855736, "episode_return_min": -34.7881214844796, "episode_return_mean": 61.9480227372847, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1472000, "num_agent_steps_trained": 1472000, "num_env_steps_sampled": 368000, "num_env_steps_trained": 368000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 5.4609782844170605, "num_env_steps_trained_throughput_per_sec": 5.4609782844170605, "timesteps_total": 368000, "num_env_steps_sampled_lifetime": 368000, "num_agent_steps_sampled_lifetime": 1472000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1472000, "timers": {"training_iteration_time_ms": 248713.04, "restore_workers_time_ms": 0.013, "training_step_time_ms": 248712.983, "sample_time_ms": 2291.455, "learn_time_ms": 246402.674, "learn_throughput": 16.234, "synch_weights_time_ms": 14.241}, "counters": {"num_env_steps_sampled": 368000, "num_env_steps_trained": 368000, "num_agent_steps_sampled": 1472000, "num_agent_steps_trained": 1472000}, "done": false, "training_iteration": 92, "trial_id": "b941d_00000", "date": "2024-08-19_09-32-03", "timestamp": 1724040123, "time_this_iter_s": 732.5085623264313, "time_total_s": 178685.94663906097, "pid": 81115, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[32, [4, 4], 2], [64, [3, 3], 2], [128, [3, 3], 1]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [256, 256], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b042d700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 178685.94663906097, "iterations_since_restore": 92, "perf": {"cpu_util_percent": 34.66752577319588, "ram_util_percent": 82.4639175257732}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 16.994241874432436, "cur_kl_coeff": 1.5187500000000005, "cur_lr": 0.00010000000000000003, "total_loss": 8.587990392957416, "policy_loss": -0.08056585012698575, "vf_loss": 8.648123059197077, "vf_explained_var": -0.2044464303387536, "kl": 0.013453946937557805, "entropy": 0.9303707551073145, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 174825.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 18.034114167551515, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.00010000000000000003, "total_loss": 8.802233641740507, "policy_loss": -0.08989380964437726, "vf_loss": 8.876002713864443, "vf_explained_var": -0.6265889144763744, "kl": 0.015925668885665177, "entropy": 0.7863458247411819, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 174825.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_agent_steps_sampled": 1488000, "num_agent_steps_trained": 1488000}, "env_runners": {"episode_reward_max": 290.5169356915214, "episode_reward_min": -50.425749451713756, "episode_reward_mean": 59.08743826637728, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -583.1051503702885, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 147.20328664992678, "predator_policy": 583.1051503702885}, "policy_reward_mean": {"prey_policy": -322.58000702710706, "predator_policy": 352.1237261602956}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.09000000000000319, 56.99961362931943, 87.35980177260053, 83.42628168389784, 32.12526554701974, -27.856377402268716, -15.965733806572882, 210.4260058573972, 34.70725192448231, 46.88242676697852, 117.40808842385096, -9.809808828770423, 117.07281493553025, 224.22826056785158, 2.149999999999997, 0.4044949152583164, 35.95441149415344, -9.266588038287178, 32.432233047033634, 22.36765933319746, 0.7034804280208578, 3.540350687492963, 50.73080445662858, 106.67496714921957, 12.779999999999978, 23.903818417364473, 0.4099999999999966, 120.3600000000001, 156.82404930636127, -20.010746409837726, 7.114510093537007, 156.43269262746801, -32.901046004622025, 0.33999999999999986, 42.8964873200533, -4.997250639934403, 24.902075044612758, 55.36738921073536, 99.90285743988625, 1.1038834764831875, 7.645232724104828, 4.379442190799351, 157.50874703212023, 0.12999999999999856, -27.85494336774041, -8.209165276569202, 0.8756255227628689, 28.268927144440962, 2.043157944685504, 153.07992876984545, 3.1799999999999953, 143.77740028402175, 290.5169356915214, 74.91500713220479, 7.511551643784369, 203.70921212264523, 30.80088259928922, -21.076886972635236, 159.09798121479162, 0.06373351978840014, -29.15249071290387, 171.5354535668891, 0.2699999999999959, 0.4200000000000017, -34.7881214844796, 29.985991835766157, 4.188532697180162, -3.094522757447531, 219.72365706565165, 39.65355738765285, 82.78955430650267, 203.74384042361513, 22.262747536935812, 240.6001506564734, 137.77414308195313, 55.733286786962374, 269.9368993571388, 6.039999999999978, 72.52953053290815, 26.108948169512878, 216.30222210356078, -13.665118268263857, 86.41999999999999, 1.2236048076648145, 1.0657252866515807, 64.492726816438, -43.94369307304974, 6.994110124982871, 19.045702785509157, 53.464146451887885, 6.884484746332227, -50.425749451713756, 90.03241146218626, 3.633282188461971, 218.05011824256326, 39.234139939881565, 251.27254760168205, 273.7424100097381, 1.6662877281474955, 109.41611433875396], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-431.312090033262, -371.53157362413543, -228.72113900144694, -528.0496629582276, -333.70209666223474, -394.2466200183354, -544.7091013366907, -193.87779681473907, -259.2697252100266, -383.0460113661583, -404.20146326815825, -514.9548102435189, -486.54140922632035, -331.27166007989496, 0.28241864015590074, -304.4908411212131, -286.52300693641615, -417.4806933009258, -391.06843522112183, -219.5456580447872, -322.32043337427507, 39.961054232219354, -340.0593679452235, -402.4391368049397, -429.8630426765616, -251.50585954168858, -370.40158556435387, -91.23572594895046, -410.7494705168684, -454.8261289381191, -474.6053711784561, -292.6838192146283, -327.1785391000821, -312.90369641331444, -383.3695256943199, -382.8773713888772, -421.60698796459405, -272.7282061109987, -438.5546419576233, -448.7653229644552, -308.0055561453444, -254.98279224250865, -453.9532159485456, -583.1051503702885, -414.46843580422666, -223.66670073740465, -400.2690961437223, 2.0000000000000013, -502.2391135740305, -263.0539299562599, -348.702207387641, -146.0503031781422, -406.4164087221522, -397.1273601210294, -357.2836227154594, -23.563765013495413, -130.2275016681436, -449.37893655049066, -296.1746861333108, -463.7506639240753, -412.0982720903515, -306.65397435552546, -379.7510192212493, -239.53975052373517, -326.6630246832778, -441.7579525197299, -281.300667438392, -535.5697023935218, -374.46544366430464, -274.6594784537763, -413.4993721114129, -411.65319205199063, -293.0424872892659, -529.723644949117, -392.31508835820125, -244.37375719592794, -216.625972505354, -145.77854977587168, -341.6270605631694, -412.572068708185, -340.1921874449646, -347.0508857420863, -364.24512368750845, -295.8685701782252, -352.16374038174604, -118.70160895520202, -408.9512650298927, -492.616891318325, -358.33700012765127, -424.57593397667586, -425.0957395926644, -486.74981595622035, -307.6612663171118, -389.96867490353753, -328.22675578843854, -340.3307447643089, -413.5352681059088, -293.16806509706873, -195.29415190863992, -464.2851319085767, -381.4467213147347, -430.47718528696987, -244.1219005758074, -67.42404455792357, 56.79804106304256, -347.975484600297, -307.4178307668734, -338.9274890495861, -401.0447791486688, -331.3457375115414, 0.8317985914784259, -338.2494312060529, -43.06213782579681, -142.3618820338637, -337.68299322088484, -464.1897877280235, 2.0000000000000013, -447.7439475647014, -207.106561841284, -331.0433845772011, -381.6604854829199, -504.4655408972859, -55.76292705834927, -266.1445830019216, -386.751993642495, -343.7427923551345, -294.38073106814403, -410.72866675132445, -491.220446870878, -359.0696376536102, -338.4027397342002, -418.6820864920636, -306.4036781287645, -431.9732078466904, -355.4357375214555, -410.42743215764443, -464.04606005088914, -94.89737873524962, -328.16950447681705, -253.0905546199812, -263.89666010209896, -216.18564595408856, -135.89141777183548, -364.1759128000964, -302.6394313952229, -378.28767171733915, 2.0000000000000013, -486.17777650979383, -169.10343018878245, -69.63282834225672, -215.4240775755243, -386.6253107150616, -502.14707402030626, 28.94808480966781, -311.0881375840343, 2.0000000000000013, -306.86993817806075, -360.99677722294433, -283.54783077286663, -415.67659910792054, -416.206962702531, -77.630007871071, -474.43096861361005, -404.2469602468007, -30.114728409623424, -449.3336985680864, -394.28838225004296, -391.09205355783644, -352.6766809065204, -454.2699446793612, -257.17354424460603, -441.90886485507457, -443.249751233483, -491.54096577258684, -387.142235580796, -370.87377802764235, -394.1879885263973, -342.2565869397558, -302.8875768312142, -265.2944659911627, -480.9031647265906, -388.43387465773367, -252.22635556839774, -350.03134049438063, -171.5696000118117, -395.6028367980417, -418.3493897173014, -399.7114734867244, -452.56652590990655, 147.20328664992678, -251.93658662558536, -306.2729035398616, 10.164914195342106, -371.9108017047044, -390.73940123310854, 12.406855805074386, -443.2572072114557, -390.3991938919742, -226.70743279807786, -367.40284777086947], "policy_predator_policy_reward": [431.36209003326195, 371.5715736241354, 307.01332793080456, 506.75708765818973, 422.9728542399094, 392.33566421326077, 533.3744353541105, 288.6387444812165, 359.61510706538894, 314.82589505781624, 461.6798979067871, 429.619998202621, 408.91849376783836, 392.928841731804, 245.79484226116386, 268.83958607729045, 325.6713802297793, 413.0395719320446, 365.47236152362154, 292.02415850926496, 346.24709997941926, 53.52036758648695, 451.24071783044104, 281.4479780909517, 365.58820415590185, 432.8535129978783, 355.04870978594056, 330.8168622952157, 412.8894705168683, 454.8361289381191, 474.8542544332355, 292.8394308751072, 349.73594333306767, 326.30070367448155, 400.15006574586926, 356.8302432990401, 421.60698796459405, 305.16043915803226, 442.924579254419, 466.76304500085655, 127.01107770970059, 436.6807511061727, 457.49356663603834, 583.1051503702885, 325.93436316469723, 362.93157783356247, 225.59987141667008, 279.34419187627105, 502.80911357403, 275.2639299562598, 347.7106972425581, 170.94563174058953, 406.56640872215206, 397.3873601210292, 366.55362271545914, 134.65376501349533, 409.44641728404514, 326.98407024094934, 276.0839397234726, 463.8306639240752, 418.68417980148644, 307.1825767379272, 357.4523031598152, 418.27115921263675, 295.6060597865485, 439.91387141183725, 281.5406674383919, 535.6697023935217, 324.1812916256828, 367.84011781245067, 417.7606746234163, 402.39463890005266, 529.6164156514129, 318.0517916315827, 368.1515675492282, 323.90466721563575, 300.7762895682117, 161.53109015289914, 342.6609440396524, 412.6420687081849, 368.1684472751443, 326.7198586360115, 367.23192052608044, 297.2612155304525, 283.684581175652, 344.68951519341687, 409.00126502989264, 492.6968913183249, 367.41273790676917, 387.6452528298174, 429.52662192497985, 474.10976834733594, 324.6363093840092, 373.8692573594028, 321.6732135505002, 375.15321414668756, 415.51791357268615, 293.22857757497684, 357.9106645889254, 454.7485479981358, 381.56672131473465, 433.5371852869698, 455.32334541775293, 0.0, 283.77978117636684, 297.9145980524091, 333.33934261058016, 387.9209843380834, 406.377580317044, 333.5244879869506, 280.71527652665185, 260.41156821056853, 120.68231057237128, 95.54259188657664, 334.8310898398961, 445.96480413637715, 252.23982142106394, 352.60210735842935, 203.3465016547821, 334.8671782834905, 372.0803336484906, 484.89320201881156, 356.93016039658704, 136.51280323057253, 386.82199364249493, 343.94279235513443, 294.70073106814374, 410.8286667513244, 414.4583695463111, 401.0435934936971, 363.091775488954, 423.9790425730755, 305.5465779925377, 437.0188406800973, 303.9138524343116, 458.8547944873406, 433.31366671341937, 345.35342913837104, 305.3098367298448, 315.6037797546065, 260.63023761709405, 302.24162274559626, 338.6664189352168, 365.14475206033006, 325.147682706289, 378.04216794320894, 401.3774037863844, 323.40052337988345, 157.07446278465844, 219.4359388283325, 249.66628825901464, 408.11638681853356, 483.31139512348443, 259.824493444293, 315.12813758403416, 0.0, 302.61233973707743, 437.78390619683506, 333.8024174958876, 391.5309605544122, 307.7974502318769, 402.3417424452856, 512.677173746502, 352.3356368456446, 116.4547284096236, 449.4136985680863, 395.5092386769164, 391.09480193862777, 382.4333471617947, 425.57900371073845, 425.6273817800387, 337.9477541360796, 399.16981934024426, 491.677204592776, 394.66485511627275, 370.34526861714835, 394.3499347233324, 361.1403435283297, 280.01632425177684, 341.6298650224878, 471.82073909619385, 404.4007850344626, 340.3856493163984, 211.44629729466612, 280.6601103609366, 376.5447379111036, 423.4999099566851, 398.19423543580245, 411.44195608716825, 111.97140141537496, 298.1949077383794, 299.24872236694875, 274.1214499528358, 338.8969851582087, 364.0634869401752, 288.01146849759715, 440.08149893007874, 395.2411899014987, 377.5907229244405, 325.93567198326053]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.101731405867096, "mean_inference_ms": 72.34849456795453, "mean_action_processing_ms": 2.840029600243881, "mean_env_wait_ms": 4.332847591816616, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006348133087158203, "StateBufferConnector_ms": 0.004046082496643066, "ViewRequirementAgentConnector_ms": 0.12650716304779053}, "num_episodes": 18, "episode_return_max": 290.5169356915214, "episode_return_min": -50.425749451713756, "episode_return_mean": 59.08743826637728, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1488000, "num_agent_steps_trained": 1488000, "num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 30.698864963193692, "num_env_steps_trained_throughput_per_sec": 30.698864963193692, "timesteps_total": 372000, "num_env_steps_sampled_lifetime": 372000, "num_agent_steps_sampled_lifetime": 1488000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1488000, "timers": {"training_iteration_time_ms": 248620.764, "restore_workers_time_ms": 0.013, "training_step_time_ms": 248620.708, "sample_time_ms": 2274.319, "learn_time_ms": 246327.527, "learn_throughput": 16.239, "synch_weights_time_ms": 14.604}, "counters": {"num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_agent_steps_sampled": 1488000, "num_agent_steps_trained": 1488000}, "done": false, "training_iteration": 93, "trial_id": "b941d_00000", "date": "2024-08-19_09-34-13", "timestamp": 1724040253, "time_this_iter_s": 130.31935000419617, "time_total_s": 178816.26598906517, "pid": 81115, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[32, [4, 4], 2], [64, [3, 3], 2], [128, [3, 3], 1]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [256, 256], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b29dc5e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 178816.26598906517, "iterations_since_restore": 93, "perf": {"cpu_util_percent": 33.891891891891895, "ram_util_percent": 81.27675675675675}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 15.157238783407463, "cur_kl_coeff": 1.5187500000000005, "cur_lr": 0.00010000000000000003, "total_loss": 7.881758604604731, "policy_loss": -0.07870876286326656, "vf_loss": 7.939665073061747, "vf_explained_var": 0.005109357203125323, "kl": 0.013696988838937465, "entropy": 0.9684847399671241, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 176715.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 19.648385025142993, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.00010000000000000003, "total_loss": 8.938988729254909, "policy_loss": -0.0905098296286755, "vf_loss": 9.012916179687258, "vf_explained_var": -0.6589361139390835, "kl": 0.01637765436155345, "entropy": 0.7587685458874577, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 176715.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 376000, "num_env_steps_trained": 376000, "num_agent_steps_sampled": 1504000, "num_agent_steps_trained": 1504000}, "env_runners": {"episode_reward_max": 290.5169356915214, "episode_reward_min": -50.425749451713756, "episode_reward_mean": 67.9500319125914, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -535.5697023935218, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 147.20328664992678, "predator_policy": 535.6697023935217}, "policy_reward_mean": {"prey_policy": -303.39477805342455, "predator_policy": 337.3697940097202}, "custom_metrics": {}, "hist_stats": {"episode_reward": [50.73080445662858, 106.67496714921957, 12.779999999999978, 23.903818417364473, 0.4099999999999966, 120.3600000000001, 156.82404930636127, -20.010746409837726, 7.114510093537007, 156.43269262746801, -32.901046004622025, 0.33999999999999986, 42.8964873200533, -4.997250639934403, 24.902075044612758, 55.36738921073536, 99.90285743988625, 1.1038834764831875, 7.645232724104828, 4.379442190799351, 157.50874703212023, 0.12999999999999856, -27.85494336774041, -8.209165276569202, 0.8756255227628689, 28.268927144440962, 2.043157944685504, 153.07992876984545, 3.1799999999999953, 143.77740028402175, 290.5169356915214, 74.91500713220479, 7.511551643784369, 203.70921212264523, 30.80088259928922, -21.076886972635236, 159.09798121479162, 0.06373351978840014, -29.15249071290387, 171.5354535668891, 0.2699999999999959, 0.4200000000000017, -34.7881214844796, 29.985991835766157, 4.188532697180162, -3.094522757447531, 219.72365706565165, 39.65355738765285, 82.78955430650267, 203.74384042361513, 22.262747536935812, 240.6001506564734, 137.77414308195313, 55.733286786962374, 269.9368993571388, 6.039999999999978, 72.52953053290815, 26.108948169512878, 216.30222210356078, -13.665118268263857, 86.41999999999999, 1.2236048076648145, 1.0657252866515807, 64.492726816438, -43.94369307304974, 6.994110124982871, 19.045702785509157, 53.464146451887885, 6.884484746332227, -50.425749451713756, 90.03241146218626, 3.633282188461971, 218.05011824256326, 39.234139939881565, 251.27254760168205, 273.7424100097381, 1.6662877281474955, 109.41611433875396, 49.359285614801095, 77.56818541079811, 83.4642496558285, 81.98305689562906, 102.17856625895756, 136.39557883340754, -42.64495382203212, 6.311080194470845, 160.25660074014053, -11.74835132913507, 110.83567805916421, 103.26999999999997, 238.68, 7.4300000000000015, 148.2511379289819, 63.19601253566667, 9.69238691018851, 95.19316570599081, 75.06235030052667, 286.54524943307763, 136.48420873562316, 13.87580949751152], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-414.46843580422666, -223.66670073740465, -400.2690961437223, 2.0000000000000013, -502.2391135740305, -263.0539299562599, -348.702207387641, -146.0503031781422, -406.4164087221522, -397.1273601210294, -357.2836227154594, -23.563765013495413, -130.2275016681436, -449.37893655049066, -296.1746861333108, -463.7506639240753, -412.0982720903515, -306.65397435552546, -379.7510192212493, -239.53975052373517, -326.6630246832778, -441.7579525197299, -281.300667438392, -535.5697023935218, -374.46544366430464, -274.6594784537763, -413.4993721114129, -411.65319205199063, -293.0424872892659, -529.723644949117, -392.31508835820125, -244.37375719592794, -216.625972505354, -145.77854977587168, -341.6270605631694, -412.572068708185, -340.1921874449646, -347.0508857420863, -364.24512368750845, -295.8685701782252, -352.16374038174604, -118.70160895520202, -408.9512650298927, -492.616891318325, -358.33700012765127, -424.57593397667586, -425.0957395926644, -486.74981595622035, -307.6612663171118, -389.96867490353753, -328.22675578843854, -340.3307447643089, -413.5352681059088, -293.16806509706873, -195.29415190863992, -464.2851319085767, -381.4467213147347, -430.47718528696987, -244.1219005758074, -67.42404455792357, 56.79804106304256, -347.975484600297, -307.4178307668734, -338.9274890495861, -401.0447791486688, -331.3457375115414, 0.8317985914784259, -338.2494312060529, -43.06213782579681, -142.3618820338637, -337.68299322088484, -464.1897877280235, 2.0000000000000013, -447.7439475647014, -207.106561841284, -331.0433845772011, -381.6604854829199, -504.4655408972859, -55.76292705834927, -266.1445830019216, -386.751993642495, -343.7427923551345, -294.38073106814403, -410.72866675132445, -491.220446870878, -359.0696376536102, -338.4027397342002, -418.6820864920636, -306.4036781287645, -431.9732078466904, -355.4357375214555, -410.42743215764443, -464.04606005088914, -94.89737873524962, -328.16950447681705, -253.0905546199812, -263.89666010209896, -216.18564595408856, -135.89141777183548, -364.1759128000964, -302.6394313952229, -378.28767171733915, 2.0000000000000013, -486.17777650979383, -169.10343018878245, -69.63282834225672, -215.4240775755243, -386.6253107150616, -502.14707402030626, 28.94808480966781, -311.0881375840343, 2.0000000000000013, -306.86993817806075, -360.99677722294433, -283.54783077286663, -415.67659910792054, -416.206962702531, -77.630007871071, -474.43096861361005, -404.2469602468007, -30.114728409623424, -449.3336985680864, -394.28838225004296, -391.09205355783644, -352.6766809065204, -454.2699446793612, -257.17354424460603, -441.90886485507457, -443.249751233483, -491.54096577258684, -387.142235580796, -370.87377802764235, -394.1879885263973, -342.2565869397558, -302.8875768312142, -265.2944659911627, -480.9031647265906, -388.43387465773367, -252.22635556839774, -350.03134049438063, -171.5696000118117, -395.6028367980417, -418.3493897173014, -399.7114734867244, -452.56652590990655, 147.20328664992678, -251.93658662558536, -306.2729035398616, 10.164914195342106, -371.9108017047044, -390.73940123310854, 12.406855805074386, -443.2572072114557, -390.3991938919742, -226.70743279807786, -367.40284777086947, -283.4590468173659, -228.66882053475422, -338.44859051526, -317.31295076549054, -455.3651094569841, -161.44335228861036, 12.562475273248168, -506.3099574269044, -392.05378894194996, -107.89284267530937, -339.3470342323254, -5.702907231480101, -96.48593013921261, -418.4381143873512, -508.30419195714086, -280.21788199760726, -52.20963520323031, -358.90102905502835, -290.20189276109784, -275.9337089254283, -23.660971386443666, -456.9096170713476, -403.06040128514803, -99.75283087143387, 64.07923683438275, -50.890942108535626, -334.45011542598655, -456.4543091297591, -369.30076196058076, 33.10732474822205, -230.18156384009052, -394.9186897411763, -416.87681051502693, -390.63867883476837, -358.63346983640463, -186.2781652119413, -111.11359068044882, -431.3961094904714, 77.72892949862185, -357.5261402380338, 2.0000000000000013, -373.5877375292218, -518.6454863614234, -384.4802643874592], "policy_predator_policy_reward": [325.93436316469723, 362.93157783356247, 225.59987141667008, 279.34419187627105, 502.80911357403, 275.2639299562598, 347.7106972425581, 170.94563174058953, 406.56640872215206, 397.3873601210292, 366.55362271545914, 134.65376501349533, 409.44641728404514, 326.98407024094934, 276.0839397234726, 463.8306639240752, 418.68417980148644, 307.1825767379272, 357.4523031598152, 418.27115921263675, 295.6060597865485, 439.91387141183725, 281.5406674383919, 535.6697023935217, 324.1812916256828, 367.84011781245067, 417.7606746234163, 402.39463890005266, 529.6164156514129, 318.0517916315827, 368.1515675492282, 323.90466721563575, 300.7762895682117, 161.53109015289914, 342.6609440396524, 412.6420687081849, 368.1684472751443, 326.7198586360115, 367.23192052608044, 297.2612155304525, 283.684581175652, 344.68951519341687, 409.00126502989264, 492.6968913183249, 367.41273790676917, 387.6452528298174, 429.52662192497985, 474.10976834733594, 324.6363093840092, 373.8692573594028, 321.6732135505002, 375.15321414668756, 415.51791357268615, 293.22857757497684, 357.9106645889254, 454.7485479981358, 381.56672131473465, 433.5371852869698, 455.32334541775293, 0.0, 283.77978117636684, 297.9145980524091, 333.33934261058016, 387.9209843380834, 406.377580317044, 333.5244879869506, 280.71527652665185, 260.41156821056853, 120.68231057237128, 95.54259188657664, 334.8310898398961, 445.96480413637715, 252.23982142106394, 352.60210735842935, 203.3465016547821, 334.8671782834905, 372.0803336484906, 484.89320201881156, 356.93016039658704, 136.51280323057253, 386.82199364249493, 343.94279235513443, 294.70073106814374, 410.8286667513244, 414.4583695463111, 401.0435934936971, 363.091775488954, 423.9790425730755, 305.5465779925377, 437.0188406800973, 303.9138524343116, 458.8547944873406, 433.31366671341937, 345.35342913837104, 305.3098367298448, 315.6037797546065, 260.63023761709405, 302.24162274559626, 338.6664189352168, 365.14475206033006, 325.147682706289, 378.04216794320894, 401.3774037863844, 323.40052337988345, 157.07446278465844, 219.4359388283325, 249.66628825901464, 408.11638681853356, 483.31139512348443, 259.824493444293, 315.12813758403416, 0.0, 302.61233973707743, 437.78390619683506, 333.8024174958876, 391.5309605544122, 307.7974502318769, 402.3417424452856, 512.677173746502, 352.3356368456446, 116.4547284096236, 449.4136985680863, 395.5092386769164, 391.09480193862777, 382.4333471617947, 425.57900371073845, 425.6273817800387, 337.9477541360796, 399.16981934024426, 491.677204592776, 394.66485511627275, 370.34526861714835, 394.3499347233324, 361.1403435283297, 280.01632425177684, 341.6298650224878, 471.82073909619385, 404.4007850344626, 340.3856493163984, 211.44629729466612, 280.6601103609366, 376.5447379111036, 423.4999099566851, 398.19423543580245, 411.44195608716825, 111.97140141537496, 298.1949077383794, 299.24872236694875, 274.1214499528358, 338.8969851582087, 364.0634869401752, 288.01146849759715, 440.08149893007874, 395.2411899014987, 377.5907229244405, 325.93567198326053, 297.6190884462505, 263.8680645206699, 431.66527369194375, 301.6644529996048, 421.62062836124585, 278.6520830401773, 66.52611521034424, 509.20442383894135, 231.184429798687, 370.94076807752975, 286.52015518958177, 194.92536510763063, 1.2775322667737514, 471.0015584377591, 468.33708906459464, 326.49606508462426, 290.61818720933445, 280.7490777890641, 270.1260770783851, 284.26117327900516, 219.04177176878306, 372.36449474817266, 403.110401285148, 202.9728308714337, 75.15076316561736, 150.34094210853522, 341.7901154259865, 456.54430912975903, 387.0987798688869, 97.34579527245398, 292.5042044986395, 395.79206161829404, 422.842618286936, 394.36525797304756, 348.81298688144915, 291.2918138728871, 346.27891828921355, 271.29313218223353, 294.59235086120464, 271.750109311285, 289.67155275903286, 218.40039350581173, 383.6534347887943, 533.3481254575997]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.041088016882798, "mean_inference_ms": 71.51030062889726, "mean_action_processing_ms": 2.8144337867107443, "mean_env_wait_ms": 4.272078546596282, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007186412811279297, "StateBufferConnector_ms": 0.004174709320068359, "ViewRequirementAgentConnector_ms": 0.12273991107940674}, "num_episodes": 22, "episode_return_max": 290.5169356915214, "episode_return_min": -50.425749451713756, "episode_return_mean": 67.9500319125914, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1504000, "num_agent_steps_trained": 1504000, "num_env_steps_sampled": 376000, "num_env_steps_trained": 376000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 30.957722849713427, "num_env_steps_trained_throughput_per_sec": 30.957722849713427, "timesteps_total": 376000, "num_env_steps_sampled_lifetime": 376000, "num_agent_steps_sampled_lifetime": 1504000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1504000, "timers": {"training_iteration_time_ms": 248591.998, "restore_workers_time_ms": 0.013, "training_step_time_ms": 248591.942, "sample_time_ms": 2285.174, "learn_time_ms": 246287.015, "learn_throughput": 16.241, "synch_weights_time_ms": 15.201}, "counters": {"num_env_steps_sampled": 376000, "num_env_steps_trained": 376000, "num_agent_steps_sampled": 1504000, "num_agent_steps_trained": 1504000}, "done": false, "training_iteration": 94, "trial_id": "b941d_00000", "date": "2024-08-19_09-36-23", "timestamp": 1724040383, "time_this_iter_s": 129.2523250579834, "time_total_s": 178945.51831412315, "pid": 81115, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[32, [4, 4], 2], [64, [3, 3], 2], [128, [3, 3], 1]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [256, 256], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b04035e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 178945.51831412315, "iterations_since_restore": 94, "perf": {"cpu_util_percent": 32.674725274725276, "ram_util_percent": 80.91538461538462}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 16.33389013053248, "cur_kl_coeff": 1.5187500000000005, "cur_lr": 0.00010000000000000003, "total_loss": 8.50625246996602, "policy_loss": -0.08739447692315533, "vf_loss": 8.572220647145832, "vf_explained_var": 0.09753913652329217, "kl": 0.014107838638933851, "entropy": 0.9274632013979413, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 178605.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 16.811843786037787, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.00010000000000000003, "total_loss": 9.05556826768098, "policy_loss": -0.08976902055724095, "vf_loss": 9.12878875631504, "vf_explained_var": -0.6139449313204125, "kl": 0.016344200908287053, "entropy": 0.7946199392830884, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 178605.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 380000, "num_env_steps_trained": 380000, "num_agent_steps_sampled": 1520000, "num_agent_steps_trained": 1520000}, "env_runners": {"episode_reward_max": 290.5169356915214, "episode_reward_min": -131.80429785747216, "episode_reward_mean": 73.37023971269737, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -555.4009273791121, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 195.05, "predator_policy": 535.4505136343839}, "policy_reward_mean": {"prey_policy": -302.3562419809076, "predator_policy": 339.04136183725626}, "custom_metrics": {}, "hist_stats": {"episode_reward": [7.645232724104828, 4.379442190799351, 157.50874703212023, 0.12999999999999856, -27.85494336774041, -8.209165276569202, 0.8756255227628689, 28.268927144440962, 2.043157944685504, 153.07992876984545, 3.1799999999999953, 143.77740028402175, 290.5169356915214, 74.91500713220479, 7.511551643784369, 203.70921212264523, 30.80088259928922, -21.076886972635236, 159.09798121479162, 0.06373351978840014, -29.15249071290387, 171.5354535668891, 0.2699999999999959, 0.4200000000000017, -34.7881214844796, 29.985991835766157, 4.188532697180162, -3.094522757447531, 219.72365706565165, 39.65355738765285, 82.78955430650267, 203.74384042361513, 22.262747536935812, 240.6001506564734, 137.77414308195313, 55.733286786962374, 269.9368993571388, 6.039999999999978, 72.52953053290815, 26.108948169512878, 216.30222210356078, -13.665118268263857, 86.41999999999999, 1.2236048076648145, 1.0657252866515807, 64.492726816438, -43.94369307304974, 6.994110124982871, 19.045702785509157, 53.464146451887885, 6.884484746332227, -50.425749451713756, 90.03241146218626, 3.633282188461971, 218.05011824256326, 39.234139939881565, 251.27254760168205, 273.7424100097381, 1.6662877281474955, 109.41611433875396, 49.359285614801095, 77.56818541079811, 83.4642496558285, 81.98305689562906, 102.17856625895756, 136.39557883340754, -42.64495382203212, 6.311080194470845, 160.25660074014053, -11.74835132913507, 110.83567805916421, 103.26999999999997, 238.68, 7.4300000000000015, 148.2511379289819, 63.19601253566667, 9.69238691018851, 95.19316570599081, 75.06235030052667, 286.54524943307763, 136.48420873562316, 13.87580949751152, 11.532315879188278, -6.83999024249308, 201.37627867803263, -82.58366882163737, 1.1689198390437472, -131.80429785747216, 22.706690454496798, 251.2516945932568, 116.86055569905825, 83.53802344674956, 56.793890426786774, 206.45213677067272, 38.06397437184828, 268.58368002714616, 0.6549196978426628, 269.53553499623723, 3.31222287113562, 33.252390668661214], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-340.1921874449646, -347.0508857420863, -364.24512368750845, -295.8685701782252, -352.16374038174604, -118.70160895520202, -408.9512650298927, -492.616891318325, -358.33700012765127, -424.57593397667586, -425.0957395926644, -486.74981595622035, -307.6612663171118, -389.96867490353753, -328.22675578843854, -340.3307447643089, -413.5352681059088, -293.16806509706873, -195.29415190863992, -464.2851319085767, -381.4467213147347, -430.47718528696987, -244.1219005758074, -67.42404455792357, 56.79804106304256, -347.975484600297, -307.4178307668734, -338.9274890495861, -401.0447791486688, -331.3457375115414, 0.8317985914784259, -338.2494312060529, -43.06213782579681, -142.3618820338637, -337.68299322088484, -464.1897877280235, 2.0000000000000013, -447.7439475647014, -207.106561841284, -331.0433845772011, -381.6604854829199, -504.4655408972859, -55.76292705834927, -266.1445830019216, -386.751993642495, -343.7427923551345, -294.38073106814403, -410.72866675132445, -491.220446870878, -359.0696376536102, -338.4027397342002, -418.6820864920636, -306.4036781287645, -431.9732078466904, -355.4357375214555, -410.42743215764443, -464.04606005088914, -94.89737873524962, -328.16950447681705, -253.0905546199812, -263.89666010209896, -216.18564595408856, -135.89141777183548, -364.1759128000964, -302.6394313952229, -378.28767171733915, 2.0000000000000013, -486.17777650979383, -169.10343018878245, -69.63282834225672, -215.4240775755243, -386.6253107150616, -502.14707402030626, 28.94808480966781, -311.0881375840343, 2.0000000000000013, -306.86993817806075, -360.99677722294433, -283.54783077286663, -415.67659910792054, -416.206962702531, -77.630007871071, -474.43096861361005, -404.2469602468007, -30.114728409623424, -449.3336985680864, -394.28838225004296, -391.09205355783644, -352.6766809065204, -454.2699446793612, -257.17354424460603, -441.90886485507457, -443.249751233483, -491.54096577258684, -387.142235580796, -370.87377802764235, -394.1879885263973, -342.2565869397558, -302.8875768312142, -265.2944659911627, -480.9031647265906, -388.43387465773367, -252.22635556839774, -350.03134049438063, -171.5696000118117, -395.6028367980417, -418.3493897173014, -399.7114734867244, -452.56652590990655, 147.20328664992678, -251.93658662558536, -306.2729035398616, 10.164914195342106, -371.9108017047044, -390.73940123310854, 12.406855805074386, -443.2572072114557, -390.3991938919742, -226.70743279807786, -367.40284777086947, -283.4590468173659, -228.66882053475422, -338.44859051526, -317.31295076549054, -455.3651094569841, -161.44335228861036, 12.562475273248168, -506.3099574269044, -392.05378894194996, -107.89284267530937, -339.3470342323254, -5.702907231480101, -96.48593013921261, -418.4381143873512, -508.30419195714086, -280.21788199760726, -52.20963520323031, -358.90102905502835, -290.20189276109784, -275.9337089254283, -23.660971386443666, -456.9096170713476, -403.06040128514803, -99.75283087143387, 64.07923683438275, -50.890942108535626, -334.45011542598655, -456.4543091297591, -369.30076196058076, 33.10732474822205, -230.18156384009052, -394.9186897411763, -416.87681051502693, -390.63867883476837, -358.63346983640463, -186.2781652119413, -111.11359068044882, -431.3961094904714, 77.72892949862185, -357.5261402380338, 2.0000000000000013, -373.5877375292218, -518.6454863614234, -384.4802643874592, -406.070295045524, -114.64571488546785, -368.1529496220854, -508.6976586224509, -37.82250323616654, -465.75315258491344, -424.5859916860402, -402.5208534637992, -476.08434803819597, -343.53269499959043, -406.3935312817765, -555.4009273791121, -270.1849708205569, -418.6963594333939, -76.08822540787745, -426.67296263714445, -362.3730370368141, -116.51017408794289, -300.4376602218189, -349.4590906639853, -364.6678796140459, -339.4064088394928, -264.66407696258443, -433.69865363254473, -291.5378602878378, -317.13752291446485, -420.53846144436585, 195.05, -371.7216730381648, -347.27966423321163, -330.4341797839037, 54.22645666372264, -243.34376775409623, -497.61997398831966, -300.543205714848, -482.93602327973963], "policy_predator_policy_reward": [368.1684472751443, 326.7198586360115, 367.23192052608044, 297.2612155304525, 283.684581175652, 344.68951519341687, 409.00126502989264, 492.6968913183249, 367.41273790676917, 387.6452528298174, 429.52662192497985, 474.10976834733594, 324.6363093840092, 373.8692573594028, 321.6732135505002, 375.15321414668756, 415.51791357268615, 293.22857757497684, 357.9106645889254, 454.7485479981358, 381.56672131473465, 433.5371852869698, 455.32334541775293, 0.0, 283.77978117636684, 297.9145980524091, 333.33934261058016, 387.9209843380834, 406.377580317044, 333.5244879869506, 280.71527652665185, 260.41156821056853, 120.68231057237128, 95.54259188657664, 334.8310898398961, 445.96480413637715, 252.23982142106394, 352.60210735842935, 203.3465016547821, 334.8671782834905, 372.0803336484906, 484.89320201881156, 356.93016039658704, 136.51280323057253, 386.82199364249493, 343.94279235513443, 294.70073106814374, 410.8286667513244, 414.4583695463111, 401.0435934936971, 363.091775488954, 423.9790425730755, 305.5465779925377, 437.0188406800973, 303.9138524343116, 458.8547944873406, 433.31366671341937, 345.35342913837104, 305.3098367298448, 315.6037797546065, 260.63023761709405, 302.24162274559626, 338.6664189352168, 365.14475206033006, 325.147682706289, 378.04216794320894, 401.3774037863844, 323.40052337988345, 157.07446278465844, 219.4359388283325, 249.66628825901464, 408.11638681853356, 483.31139512348443, 259.824493444293, 315.12813758403416, 0.0, 302.61233973707743, 437.78390619683506, 333.8024174958876, 391.5309605544122, 307.7974502318769, 402.3417424452856, 512.677173746502, 352.3356368456446, 116.4547284096236, 449.4136985680863, 395.5092386769164, 391.09480193862777, 382.4333471617947, 425.57900371073845, 425.6273817800387, 337.9477541360796, 399.16981934024426, 491.677204592776, 394.66485511627275, 370.34526861714835, 394.3499347233324, 361.1403435283297, 280.01632425177684, 341.6298650224878, 471.82073909619385, 404.4007850344626, 340.3856493163984, 211.44629729466612, 280.6601103609366, 376.5447379111036, 423.4999099566851, 398.19423543580245, 411.44195608716825, 111.97140141537496, 298.1949077383794, 299.24872236694875, 274.1214499528358, 338.8969851582087, 364.0634869401752, 288.01146849759715, 440.08149893007874, 395.2411899014987, 377.5907229244405, 325.93567198326053, 297.6190884462505, 263.8680645206699, 431.66527369194375, 301.6644529996048, 421.62062836124585, 278.6520830401773, 66.52611521034424, 509.20442383894135, 231.184429798687, 370.94076807752975, 286.52015518958177, 194.92536510763063, 1.2775322667737514, 471.0015584377591, 468.33708906459464, 326.49606508462426, 290.61818720933445, 280.7490777890641, 270.1260770783851, 284.26117327900516, 219.04177176878306, 372.36449474817266, 403.110401285148, 202.9728308714337, 75.15076316561736, 150.34094210853522, 341.7901154259865, 456.54430912975903, 387.0987798688869, 97.34579527245398, 292.5042044986395, 395.79206161829404, 422.842618286936, 394.36525797304756, 348.81298688144915, 291.2918138728871, 346.27891828921355, 271.29313218223353, 294.59235086120464, 271.750109311285, 289.67155275903286, 218.40039350581173, 383.6534347887943, 533.3481254575997, 406.3802950455237, 125.86803076465672, 357.81356472141306, 512.1970532806301, 374.87559570389567, 330.0763387952166, 342.18843255172436, 402.3347437764775, 477.22293143190484, 343.5630314449251, 341.3937366872151, 488.5964241162014, 297.33663932804313, 414.25138138040415, 365.89730933173536, 388.1155733065435, 482.65199849987084, 113.09176832394341, 368.5718427255905, 364.862931606963, 327.2711191619438, 433.59705971838144, 369.3643537314179, 535.4505136343839, 291.8189150617873, 354.9204425123636, 411.90845477006883, 82.16368670144317, 373.14687398918977, 346.5093829800293, 252.92608838597758, 292.8171697304411, 403.1844278736207, 341.091536739931, 346.2439980943097, 470.487621568939]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.988558243978727, "mean_inference_ms": 70.84195399672016, "mean_action_processing_ms": 2.7893948117325063, "mean_env_wait_ms": 4.232414930794019, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007456660270690918, "StateBufferConnector_ms": 0.004126906394958496, "ViewRequirementAgentConnector_ms": 0.121742844581604}, "num_episodes": 18, "episode_return_max": 290.5169356915214, "episode_return_min": -131.80429785747216, "episode_return_mean": 73.37023971269737, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1520000, "num_agent_steps_trained": 1520000, "num_env_steps_sampled": 380000, "num_env_steps_trained": 380000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 30.93886168506583, "num_env_steps_trained_throughput_per_sec": 30.93886168506583, "timesteps_total": 380000, "num_env_steps_sampled_lifetime": 380000, "num_agent_steps_sampled_lifetime": 1520000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1520000, "timers": {"training_iteration_time_ms": 248350.481, "restore_workers_time_ms": 0.013, "training_step_time_ms": 248350.426, "sample_time_ms": 2269.582, "learn_time_ms": 246060.869, "learn_throughput": 16.256, "synch_weights_time_ms": 15.422}, "counters": {"num_env_steps_sampled": 380000, "num_env_steps_trained": 380000, "num_agent_steps_sampled": 1520000, "num_agent_steps_trained": 1520000}, "done": false, "training_iteration": 95, "trial_id": "b941d_00000", "date": "2024-08-19_09-38-32", "timestamp": 1724040512, "time_this_iter_s": 129.33216309547424, "time_total_s": 179074.85047721863, "pid": 81115, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[32, [4, 4], 2], [64, [3, 3], 2], [128, [3, 3], 1]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [256, 256], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b29cad30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 179074.85047721863, "iterations_since_restore": 95, "perf": {"cpu_util_percent": 30.088524590163935, "ram_util_percent": 81.38688524590165}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 17.806855171824257, "cur_kl_coeff": 1.5187500000000005, "cur_lr": 0.00010000000000000003, "total_loss": 8.670188002863888, "policy_loss": -0.08182484792008325, "vf_loss": 8.731572273547057, "vf_explained_var": 0.027998770607842338, "kl": 0.013458804322447821, "entropy": 0.9128735418988283, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 180495.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 19.096069126406675, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.00010000000000000003, "total_loss": 8.785149731711735, "policy_loss": -0.08428123279415545, "vf_loss": 8.853796318094567, "vf_explained_var": -0.44454324992876204, "kl": 0.015441640972575521, "entropy": 0.7754429058107749, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 180495.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_agent_steps_sampled": 1536000, "num_agent_steps_trained": 1536000}, "env_runners": {"episode_reward_max": 306.0541362772732, "episode_reward_min": -131.80429785747216, "episode_reward_mean": 74.60395244528064, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -555.4009273791121, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 195.05, "predator_policy": 535.4505136343839}, "policy_reward_mean": {"prey_policy": -300.9125574341743, "predator_policy": 338.2145336568145}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.4200000000000017, -34.7881214844796, 29.985991835766157, 4.188532697180162, -3.094522757447531, 219.72365706565165, 39.65355738765285, 82.78955430650267, 203.74384042361513, 22.262747536935812, 240.6001506564734, 137.77414308195313, 55.733286786962374, 269.9368993571388, 6.039999999999978, 72.52953053290815, 26.108948169512878, 216.30222210356078, -13.665118268263857, 86.41999999999999, 1.2236048076648145, 1.0657252866515807, 64.492726816438, -43.94369307304974, 6.994110124982871, 19.045702785509157, 53.464146451887885, 6.884484746332227, -50.425749451713756, 90.03241146218626, 3.633282188461971, 218.05011824256326, 39.234139939881565, 251.27254760168205, 273.7424100097381, 1.6662877281474955, 109.41611433875396, 49.359285614801095, 77.56818541079811, 83.4642496558285, 81.98305689562906, 102.17856625895756, 136.39557883340754, -42.64495382203212, 6.311080194470845, 160.25660074014053, -11.74835132913507, 110.83567805916421, 103.26999999999997, 238.68, 7.4300000000000015, 148.2511379289819, 63.19601253566667, 9.69238691018851, 95.19316570599081, 75.06235030052667, 286.54524943307763, 136.48420873562316, 13.87580949751152, 11.532315879188278, -6.83999024249308, 201.37627867803263, -82.58366882163737, 1.1689198390437472, -131.80429785747216, 22.706690454496798, 251.2516945932568, 116.86055569905825, 83.53802344674956, 56.793890426786774, 206.45213677067272, 38.06397437184828, 268.58368002714616, 0.6549196978426628, 269.53553499623723, 3.31222287113562, 33.252390668661214, 28.803503697176517, -21.01135805855334, 119.26582699439166, 14.498762493972393, 175.31445324468606, 7.005377576597358, 145.97227452368367, 144.44561993399836, 118.88733977499497, -18.98416139794905, 1.8256039791958287, 32.39595201821183, 147.74837231116342, 205.67555031357125, 306.0541362772732, 8.451002714332317, -3.677967742674198, 10.457593726835622, 33.22136414065841, 0.42999999999999905, 1.1799999999999886, 16.28775951060532, 2.1399999999999957], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-294.38073106814403, -410.72866675132445, -491.220446870878, -359.0696376536102, -338.4027397342002, -418.6820864920636, -306.4036781287645, -431.9732078466904, -355.4357375214555, -410.42743215764443, -464.04606005088914, -94.89737873524962, -328.16950447681705, -253.0905546199812, -263.89666010209896, -216.18564595408856, -135.89141777183548, -364.1759128000964, -302.6394313952229, -378.28767171733915, 2.0000000000000013, -486.17777650979383, -169.10343018878245, -69.63282834225672, -215.4240775755243, -386.6253107150616, -502.14707402030626, 28.94808480966781, -311.0881375840343, 2.0000000000000013, -306.86993817806075, -360.99677722294433, -283.54783077286663, -415.67659910792054, -416.206962702531, -77.630007871071, -474.43096861361005, -404.2469602468007, -30.114728409623424, -449.3336985680864, -394.28838225004296, -391.09205355783644, -352.6766809065204, -454.2699446793612, -257.17354424460603, -441.90886485507457, -443.249751233483, -491.54096577258684, -387.142235580796, -370.87377802764235, -394.1879885263973, -342.2565869397558, -302.8875768312142, -265.2944659911627, -480.9031647265906, -388.43387465773367, -252.22635556839774, -350.03134049438063, -171.5696000118117, -395.6028367980417, -418.3493897173014, -399.7114734867244, -452.56652590990655, 147.20328664992678, -251.93658662558536, -306.2729035398616, 10.164914195342106, -371.9108017047044, -390.73940123310854, 12.406855805074386, -443.2572072114557, -390.3991938919742, -226.70743279807786, -367.40284777086947, -283.4590468173659, -228.66882053475422, -338.44859051526, -317.31295076549054, -455.3651094569841, -161.44335228861036, 12.562475273248168, -506.3099574269044, -392.05378894194996, -107.89284267530937, -339.3470342323254, -5.702907231480101, -96.48593013921261, -418.4381143873512, -508.30419195714086, -280.21788199760726, -52.20963520323031, -358.90102905502835, -290.20189276109784, -275.9337089254283, -23.660971386443666, -456.9096170713476, -403.06040128514803, -99.75283087143387, 64.07923683438275, -50.890942108535626, -334.45011542598655, -456.4543091297591, -369.30076196058076, 33.10732474822205, -230.18156384009052, -394.9186897411763, -416.87681051502693, -390.63867883476837, -358.63346983640463, -186.2781652119413, -111.11359068044882, -431.3961094904714, 77.72892949862185, -357.5261402380338, 2.0000000000000013, -373.5877375292218, -518.6454863614234, -384.4802643874592, -406.070295045524, -114.64571488546785, -368.1529496220854, -508.6976586224509, -37.82250323616654, -465.75315258491344, -424.5859916860402, -402.5208534637992, -476.08434803819597, -343.53269499959043, -406.3935312817765, -555.4009273791121, -270.1849708205569, -418.6963594333939, -76.08822540787745, -426.67296263714445, -362.3730370368141, -116.51017408794289, -300.4376602218189, -349.4590906639853, -364.6678796140459, -339.4064088394928, -264.66407696258443, -433.69865363254473, -291.5378602878378, -317.13752291446485, -420.53846144436585, 195.05, -371.7216730381648, -347.27966423321163, -330.4341797839037, 54.22645666372264, -243.34376775409623, -497.61997398831966, -300.543205714848, -482.93602327973963, -195.5570328475675, -473.4416730086296, -365.0084969093854, -505.2607056503556, -41.10675756375692, -305.0493344167662, -218.05264896689908, -247.6756844418997, -480.72633952659925, -33.74341021512937, -427.67374741745533, -349.73087977639506, -152.3638839183668, 80.21000000000001, 71.76058830156214, -403.8530249162402, -158.75347936930353, -340.3236600625759, -377.87355980288663, -441.23555493618255, -311.8620968063176, -350.8596285170679, -283.9690665265444, -468.39200787622593, -425.61050014087533, -125.33170881574594, -161.51700444463995, -458.61657003826764, 71.04719673661526, 87.41663521095876, -367.1956012934247, -321.22098649817406, -352.2105014147267, -344.2446264993856, -377.7636253818276, -388.81982811260355, -250.42952687811044, -450.2669243739307, -486.12584727340476, -309.0038932358318, -492.44290473700363, -377.7589615594779, -381.89445013026227, -381.0973776226998, -450.21282776037344, -374.9597739977063], "policy_predator_policy_reward": [294.70073106814374, 410.8286667513244, 414.4583695463111, 401.0435934936971, 363.091775488954, 423.9790425730755, 305.5465779925377, 437.0188406800973, 303.9138524343116, 458.8547944873406, 433.31366671341937, 345.35342913837104, 305.3098367298448, 315.6037797546065, 260.63023761709405, 302.24162274559626, 338.6664189352168, 365.14475206033006, 325.147682706289, 378.04216794320894, 401.3774037863844, 323.40052337988345, 157.07446278465844, 219.4359388283325, 249.66628825901464, 408.11638681853356, 483.31139512348443, 259.824493444293, 315.12813758403416, 0.0, 302.61233973707743, 437.78390619683506, 333.8024174958876, 391.5309605544122, 307.7974502318769, 402.3417424452856, 512.677173746502, 352.3356368456446, 116.4547284096236, 449.4136985680863, 395.5092386769164, 391.09480193862777, 382.4333471617947, 425.57900371073845, 425.6273817800387, 337.9477541360796, 399.16981934024426, 491.677204592776, 394.66485511627275, 370.34526861714835, 394.3499347233324, 361.1403435283297, 280.01632425177684, 341.6298650224878, 471.82073909619385, 404.4007850344626, 340.3856493163984, 211.44629729466612, 280.6601103609366, 376.5447379111036, 423.4999099566851, 398.19423543580245, 411.44195608716825, 111.97140141537496, 298.1949077383794, 299.24872236694875, 274.1214499528358, 338.8969851582087, 364.0634869401752, 288.01146849759715, 440.08149893007874, 395.2411899014987, 377.5907229244405, 325.93567198326053, 297.6190884462505, 263.8680645206699, 431.66527369194375, 301.6644529996048, 421.62062836124585, 278.6520830401773, 66.52611521034424, 509.20442383894135, 231.184429798687, 370.94076807752975, 286.52015518958177, 194.92536510763063, 1.2775322667737514, 471.0015584377591, 468.33708906459464, 326.49606508462426, 290.61818720933445, 280.7490777890641, 270.1260770783851, 284.26117327900516, 219.04177176878306, 372.36449474817266, 403.110401285148, 202.9728308714337, 75.15076316561736, 150.34094210853522, 341.7901154259865, 456.54430912975903, 387.0987798688869, 97.34579527245398, 292.5042044986395, 395.79206161829404, 422.842618286936, 394.36525797304756, 348.81298688144915, 291.2918138728871, 346.27891828921355, 271.29313218223353, 294.59235086120464, 271.750109311285, 289.67155275903286, 218.40039350581173, 383.6534347887943, 533.3481254575997, 406.3802950455237, 125.86803076465672, 357.81356472141306, 512.1970532806301, 374.87559570389567, 330.0763387952166, 342.18843255172436, 402.3347437764775, 477.22293143190484, 343.5630314449251, 341.3937366872151, 488.5964241162014, 297.33663932804313, 414.25138138040415, 365.89730933173536, 388.1155733065435, 482.65199849987084, 113.09176832394341, 368.5718427255905, 364.862931606963, 327.2711191619438, 433.59705971838144, 369.3643537314179, 535.4505136343839, 291.8189150617873, 354.9204425123636, 411.90845477006883, 82.16368670144317, 373.14687398918977, 346.5093829800293, 252.92608838597758, 292.8171697304411, 403.1844278736207, 341.091536739931, 346.2439980943097, 470.487621568939, 428.76539366398254, 269.0368158893908, 337.42125720070464, 511.836587300483, 134.7142003683609, 330.7077186065534, 116.4880044716167, 363.7390914311538, 370.49830537248766, 319.2858976139265, 433.96301179728465, 350.4469929731627, 145.66988172808013, 72.4562767139688, 72.62503163243629, 403.91302491624015, 258.7509592674321, 359.2135199394422, 429.4208653823377, 370.7040879587822, 314.14436745217995, 350.402961850401, 312.68322912137353, 472.0737972996085, 344.4177177036284, 354.2728635641562, 444.94446917887063, 380.864655617608, 68.27280423144167, 79.31750009825757, 384.383871752604, 312.48371875332657, 339.0200735435262, 353.75708662791163, 406.69261665924347, 370.3484305620232, 293.6023726038778, 440.3154427888212, 486.2958472734046, 309.2638932358317, 493.4529047370036, 377.92896155947784, 361.0384306354008, 418.2411566281665, 450.2428277603734, 377.0697739977062]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.9182055675178376, "mean_inference_ms": 70.01267766387254, "mean_action_processing_ms": 2.7526577377356642, "mean_env_wait_ms": 4.193570157329026, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007023930549621582, "StateBufferConnector_ms": 0.004081010818481445, "ViewRequirementAgentConnector_ms": 0.11886835098266602}, "num_episodes": 23, "episode_return_max": 306.0541362772732, "episode_return_min": -131.80429785747216, "episode_return_mean": 74.60395244528064, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1536000, "num_agent_steps_trained": 1536000, "num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 29.9503240006901, "num_env_steps_trained_throughput_per_sec": 29.9503240006901, "timesteps_total": 384000, "num_env_steps_sampled_lifetime": 384000, "num_agent_steps_sampled_lifetime": 1536000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1536000, "timers": {"training_iteration_time_ms": 247887.318, "restore_workers_time_ms": 0.013, "training_step_time_ms": 247887.258, "sample_time_ms": 2262.684, "learn_time_ms": 245605.082, "learn_throughput": 16.286, "synch_weights_time_ms": 15.051}, "counters": {"num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_agent_steps_sampled": 1536000, "num_agent_steps_trained": 1536000}, "done": false, "training_iteration": 96, "trial_id": "b941d_00000", "date": "2024-08-19_09-40-46", "timestamp": 1724040646, "time_this_iter_s": 133.58589506149292, "time_total_s": 179208.43637228012, "pid": 81115, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[32, [4, 4], 2], [64, [3, 3], 2], [128, [3, 3], 1]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [256, 256], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b04030d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 179208.43637228012, "iterations_since_restore": 96, "perf": {"cpu_util_percent": 27.83227513227513, "ram_util_percent": 81.73439153439153}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.13321632090069, "cur_kl_coeff": 1.5187500000000005, "cur_lr": 0.00010000000000000003, "total_loss": 8.921064593804577, "policy_loss": -0.08497968777058222, "vf_loss": 8.984831949264285, "vf_explained_var": -0.04873518464426515, "kl": 0.01396696397862323, "entropy": 0.8853478931876086, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 182385.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 18.07002336770769, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.00010000000000000003, "total_loss": 9.323560248985492, "policy_loss": -0.09038645860137881, "vf_loss": 9.396818111560963, "vf_explained_var": -0.9477675093544854, "kl": 0.016917125787286772, "entropy": 0.7780431986801208, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 182385.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 388000, "num_env_steps_trained": 388000, "num_agent_steps_sampled": 1552000, "num_agent_steps_trained": 1552000}, "env_runners": {"episode_reward_max": 306.0541362772732, "episode_reward_min": -131.80429785747216, "episode_reward_mean": 68.59715760414466, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -578.932674869041, "predator_policy": 1.2775322667737514}, "policy_reward_max": {"prey_policy": 195.05, "predator_policy": 535.4505136343839}, "policy_reward_mean": {"prey_policy": -309.2692162477377, "predator_policy": 343.56779504981}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-13.665118268263857, 86.41999999999999, 1.2236048076648145, 1.0657252866515807, 64.492726816438, -43.94369307304974, 6.994110124982871, 19.045702785509157, 53.464146451887885, 6.884484746332227, -50.425749451713756, 90.03241146218626, 3.633282188461971, 218.05011824256326, 39.234139939881565, 251.27254760168205, 273.7424100097381, 1.6662877281474955, 109.41611433875396, 49.359285614801095, 77.56818541079811, 83.4642496558285, 81.98305689562906, 102.17856625895756, 136.39557883340754, -42.64495382203212, 6.311080194470845, 160.25660074014053, -11.74835132913507, 110.83567805916421, 103.26999999999997, 238.68, 7.4300000000000015, 148.2511379289819, 63.19601253566667, 9.69238691018851, 95.19316570599081, 75.06235030052667, 286.54524943307763, 136.48420873562316, 13.87580949751152, 11.532315879188278, -6.83999024249308, 201.37627867803263, -82.58366882163737, 1.1689198390437472, -131.80429785747216, 22.706690454496798, 251.2516945932568, 116.86055569905825, 83.53802344674956, 56.793890426786774, 206.45213677067272, 38.06397437184828, 268.58368002714616, 0.6549196978426628, 269.53553499623723, 3.31222287113562, 33.252390668661214, 28.803503697176517, -21.01135805855334, 119.26582699439166, 14.498762493972393, 175.31445324468606, 7.005377576597358, 145.97227452368367, 144.44561993399836, 118.88733977499497, -18.98416139794905, 1.8256039791958287, 32.39595201821183, 147.74837231116342, 205.67555031357125, 306.0541362772732, 8.451002714332317, -3.677967742674198, 10.457593726835622, 33.22136414065841, 0.42999999999999905, 1.1799999999999886, 16.28775951060532, 2.1399999999999957, 303.75509030859575, 9.889186833369617, 110.28982307499165, 6.639999999999996, 29.62921411487199, 6.599480826982356, -32.011737248959264, 173.78777014258102, 16.57905736480462, 18.27716242716532, 138.63476505432672, 37.494234214716926, -94.6370857506264, 95.47623159075115, 226.14568906203445, -57.85794842931752, 0.19000000000000483, 0.34999999999999787], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-474.43096861361005, -404.2469602468007, -30.114728409623424, -449.3336985680864, -394.28838225004296, -391.09205355783644, -352.6766809065204, -454.2699446793612, -257.17354424460603, -441.90886485507457, -443.249751233483, -491.54096577258684, -387.142235580796, -370.87377802764235, -394.1879885263973, -342.2565869397558, -302.8875768312142, -265.2944659911627, -480.9031647265906, -388.43387465773367, -252.22635556839774, -350.03134049438063, -171.5696000118117, -395.6028367980417, -418.3493897173014, -399.7114734867244, -452.56652590990655, 147.20328664992678, -251.93658662558536, -306.2729035398616, 10.164914195342106, -371.9108017047044, -390.73940123310854, 12.406855805074386, -443.2572072114557, -390.3991938919742, -226.70743279807786, -367.40284777086947, -283.4590468173659, -228.66882053475422, -338.44859051526, -317.31295076549054, -455.3651094569841, -161.44335228861036, 12.562475273248168, -506.3099574269044, -392.05378894194996, -107.89284267530937, -339.3470342323254, -5.702907231480101, -96.48593013921261, -418.4381143873512, -508.30419195714086, -280.21788199760726, -52.20963520323031, -358.90102905502835, -290.20189276109784, -275.9337089254283, -23.660971386443666, -456.9096170713476, -403.06040128514803, -99.75283087143387, 64.07923683438275, -50.890942108535626, -334.45011542598655, -456.4543091297591, -369.30076196058076, 33.10732474822205, -230.18156384009052, -394.9186897411763, -416.87681051502693, -390.63867883476837, -358.63346983640463, -186.2781652119413, -111.11359068044882, -431.3961094904714, 77.72892949862185, -357.5261402380338, 2.0000000000000013, -373.5877375292218, -518.6454863614234, -384.4802643874592, -406.070295045524, -114.64571488546785, -368.1529496220854, -508.6976586224509, -37.82250323616654, -465.75315258491344, -424.5859916860402, -402.5208534637992, -476.08434803819597, -343.53269499959043, -406.3935312817765, -555.4009273791121, -270.1849708205569, -418.6963594333939, -76.08822540787745, -426.67296263714445, -362.3730370368141, -116.51017408794289, -300.4376602218189, -349.4590906639853, -364.6678796140459, -339.4064088394928, -264.66407696258443, -433.69865363254473, -291.5378602878378, -317.13752291446485, -420.53846144436585, 195.05, -371.7216730381648, -347.27966423321163, -330.4341797839037, 54.22645666372264, -243.34376775409623, -497.61997398831966, -300.543205714848, -482.93602327973963, -195.5570328475675, -473.4416730086296, -365.0084969093854, -505.2607056503556, -41.10675756375692, -305.0493344167662, -218.05264896689908, -247.6756844418997, -480.72633952659925, -33.74341021512937, -427.67374741745533, -349.73087977639506, -152.3638839183668, 80.21000000000001, 71.76058830156214, -403.8530249162402, -158.75347936930353, -340.3236600625759, -377.87355980288663, -441.23555493618255, -311.8620968063176, -350.8596285170679, -283.9690665265444, -468.39200787622593, -425.61050014087533, -125.33170881574594, -161.51700444463995, -458.61657003826764, 71.04719673661526, 87.41663521095876, -367.1956012934247, -321.22098649817406, -352.2105014147267, -344.2446264993856, -377.7636253818276, -388.81982811260355, -250.42952687811044, -450.2669243739307, -486.12584727340476, -309.0038932358318, -492.44290473700363, -377.7589615594779, -381.89445013026227, -381.0973776226998, -450.21282776037344, -374.9597739977063, 105.94024174448228, -435.41182591358296, -422.7228287423136, -350.6795511196171, -448.42234900014427, -229.32539068493696, -275.92724226634635, -349.50612451017486, -369.70666180097334, -343.6639125402793, -362.91214850251833, -368.0231863893229, -387.89332010392553, -457.67287506397344, -44.4894717220225, -487.31692801869286, -418.5827515985366, -292.6627771090519, -320.45507156942796, -394.73326571689967, -453.0318448544325, -211.24831863491528, -387.28593547576304, -265.1351351480585, -377.4760468608531, -483.09043781576474, -404.57239660936625, -141.674243668093, -39.85168530555859, -578.932674869041, -418.62441913004267, -355.550305529811, -352.7078036898947, -375.1362322165027, -324.786008126627, -434.24410197958787], "policy_predator_policy_reward": [512.677173746502, 352.3356368456446, 116.4547284096236, 449.4136985680863, 395.5092386769164, 391.09480193862777, 382.4333471617947, 425.57900371073845, 425.6273817800387, 337.9477541360796, 399.16981934024426, 491.677204592776, 394.66485511627275, 370.34526861714835, 394.3499347233324, 361.1403435283297, 280.01632425177684, 341.6298650224878, 471.82073909619385, 404.4007850344626, 340.3856493163984, 211.44629729466612, 280.6601103609366, 376.5447379111036, 423.4999099566851, 398.19423543580245, 411.44195608716825, 111.97140141537496, 298.1949077383794, 299.24872236694875, 274.1214499528358, 338.8969851582087, 364.0634869401752, 288.01146849759715, 440.08149893007874, 395.2411899014987, 377.5907229244405, 325.93567198326053, 297.6190884462505, 263.8680645206699, 431.66527369194375, 301.6644529996048, 421.62062836124585, 278.6520830401773, 66.52611521034424, 509.20442383894135, 231.184429798687, 370.94076807752975, 286.52015518958177, 194.92536510763063, 1.2775322667737514, 471.0015584377591, 468.33708906459464, 326.49606508462426, 290.61818720933445, 280.7490777890641, 270.1260770783851, 284.26117327900516, 219.04177176878306, 372.36449474817266, 403.110401285148, 202.9728308714337, 75.15076316561736, 150.34094210853522, 341.7901154259865, 456.54430912975903, 387.0987798688869, 97.34579527245398, 292.5042044986395, 395.79206161829404, 422.842618286936, 394.36525797304756, 348.81298688144915, 291.2918138728871, 346.27891828921355, 271.29313218223353, 294.59235086120464, 271.750109311285, 289.67155275903286, 218.40039350581173, 383.6534347887943, 533.3481254575997, 406.3802950455237, 125.86803076465672, 357.81356472141306, 512.1970532806301, 374.87559570389567, 330.0763387952166, 342.18843255172436, 402.3347437764775, 477.22293143190484, 343.5630314449251, 341.3937366872151, 488.5964241162014, 297.33663932804313, 414.25138138040415, 365.89730933173536, 388.1155733065435, 482.65199849987084, 113.09176832394341, 368.5718427255905, 364.862931606963, 327.2711191619438, 433.59705971838144, 369.3643537314179, 535.4505136343839, 291.8189150617873, 354.9204425123636, 411.90845477006883, 82.16368670144317, 373.14687398918977, 346.5093829800293, 252.92608838597758, 292.8171697304411, 403.1844278736207, 341.091536739931, 346.2439980943097, 470.487621568939, 428.76539366398254, 269.0368158893908, 337.42125720070464, 511.836587300483, 134.7142003683609, 330.7077186065534, 116.4880044716167, 363.7390914311538, 370.49830537248766, 319.2858976139265, 433.96301179728465, 350.4469929731627, 145.66988172808013, 72.4562767139688, 72.62503163243629, 403.91302491624015, 258.7509592674321, 359.2135199394422, 429.4208653823377, 370.7040879587822, 314.14436745217995, 350.402961850401, 312.68322912137353, 472.0737972996085, 344.4177177036284, 354.2728635641562, 444.94446917887063, 380.864655617608, 68.27280423144167, 79.31750009825757, 384.383871752604, 312.48371875332657, 339.0200735435262, 353.75708662791163, 406.69261665924347, 370.3484305620232, 293.6023726038778, 440.3154427888212, 486.2958472734046, 309.2638932358317, 493.4529047370036, 377.92896155947784, 361.0384306354008, 418.2411566281665, 450.2428277603734, 377.0697739977062, 288.334660172346, 344.8920143053505, 428.17835058896634, 355.11321610633377, 380.0942875020749, 407.94327525799787, 282.3972422663466, 349.6761245101747, 345.85679335513987, 397.1429951009845, 413.8937271577326, 323.64108856109146, 426.0118541174164, 387.5426038015234, 523.1109106782591, 182.48325920503737, 420.06029157078245, 307.76429450161044, 431.81057303320534, 301.654926680288, 307.7478277852834, 495.16710075839126, 339.9746266060217, 349.9406782325164, 336.6634119946122, 429.2659869313797, 461.2732560409009, 180.44961582730937, 419.4410794784292, 425.4889697582051, 328.1398468309862, 388.1769293995495, 352.7378036898947, 375.2962322165026, 324.92600812662687, 434.4541019795878]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.867866368185471, "mean_inference_ms": 69.3719355555013, "mean_action_processing_ms": 2.728649281807484, "mean_env_wait_ms": 4.155570294892785, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0067778825759887695, "StateBufferConnector_ms": 0.003575921058654785, "ViewRequirementAgentConnector_ms": 0.1261909008026123}, "num_episodes": 18, "episode_return_max": 306.0541362772732, "episode_return_min": -131.80429785747216, "episode_return_mean": 68.59715760414466, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1552000, "num_agent_steps_trained": 1552000, "num_env_steps_sampled": 388000, "num_env_steps_trained": 388000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 28.132982030352384, "num_env_steps_trained_throughput_per_sec": 28.132982030352384, "timesteps_total": 388000, "num_env_steps_sampled_lifetime": 388000, "num_agent_steps_sampled_lifetime": 1552000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1552000, "timers": {"training_iteration_time_ms": 248618.953, "restore_workers_time_ms": 0.013, "training_step_time_ms": 248618.894, "sample_time_ms": 2289.398, "learn_time_ms": 246308.688, "learn_throughput": 16.24, "synch_weights_time_ms": 16.563}, "counters": {"num_env_steps_sampled": 388000, "num_env_steps_trained": 388000, "num_agent_steps_sampled": 1552000, "num_agent_steps_trained": 1552000}, "done": false, "training_iteration": 97, "trial_id": "b941d_00000", "date": "2024-08-19_09-43-08", "timestamp": 1724040788, "time_this_iter_s": 142.24439311027527, "time_total_s": 179350.6807653904, "pid": 81115, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[32, [4, 4], 2], [64, [3, 3], 2], [128, [3, 3], 1]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [256, 256], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b0495e50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 179350.6807653904, "iterations_since_restore": 97, "perf": {"cpu_util_percent": 30.43960396039604, "ram_util_percent": 78.7128712871287}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 18.380531920074787, "cur_kl_coeff": 1.5187500000000005, "cur_lr": 0.00010000000000000003, "total_loss": 8.505770161038352, "policy_loss": -0.08164147617425967, "vf_loss": 8.567322158813477, "vf_explained_var": -0.07342613698944213, "kl": 0.013227647713011775, "entropy": 0.9255478041197257, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 184275.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 16.75046314663357, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.00010000000000000003, "total_loss": 9.006024087169182, "policy_loss": -0.09033462187551237, "vf_loss": 9.079350106173722, "vf_explained_var": -0.6164480438623479, "kl": 0.016798594816142112, "entropy": 0.7923237739101289, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 184275.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 392000, "num_env_steps_trained": 392000, "num_agent_steps_sampled": 1568000, "num_agent_steps_trained": 1568000}, "env_runners": {"episode_reward_max": 339.4115951350137, "episode_reward_min": -131.80429785747216, "episode_reward_mean": 73.10181050612853, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -578.932674869041, "predator_policy": 1.2775322667737514}, "policy_reward_max": {"prey_policy": 195.05, "predator_policy": 535.4505136343839}, "policy_reward_mean": {"prey_policy": -303.3133876736183, "predator_policy": 339.86429292668254}, "custom_metrics": {}, "hist_stats": {"episode_reward": [81.98305689562906, 102.17856625895756, 136.39557883340754, -42.64495382203212, 6.311080194470845, 160.25660074014053, -11.74835132913507, 110.83567805916421, 103.26999999999997, 238.68, 7.4300000000000015, 148.2511379289819, 63.19601253566667, 9.69238691018851, 95.19316570599081, 75.06235030052667, 286.54524943307763, 136.48420873562316, 13.87580949751152, 11.532315879188278, -6.83999024249308, 201.37627867803263, -82.58366882163737, 1.1689198390437472, -131.80429785747216, 22.706690454496798, 251.2516945932568, 116.86055569905825, 83.53802344674956, 56.793890426786774, 206.45213677067272, 38.06397437184828, 268.58368002714616, 0.6549196978426628, 269.53553499623723, 3.31222287113562, 33.252390668661214, 28.803503697176517, -21.01135805855334, 119.26582699439166, 14.498762493972393, 175.31445324468606, 7.005377576597358, 145.97227452368367, 144.44561993399836, 118.88733977499497, -18.98416139794905, 1.8256039791958287, 32.39595201821183, 147.74837231116342, 205.67555031357125, 306.0541362772732, 8.451002714332317, -3.677967742674198, 10.457593726835622, 33.22136414065841, 0.42999999999999905, 1.1799999999999886, 16.28775951060532, 2.1399999999999957, 303.75509030859575, 9.889186833369617, 110.28982307499165, 6.639999999999996, 29.62921411487199, 6.599480826982356, -32.011737248959264, 173.78777014258102, 16.57905736480462, 18.27716242716532, 138.63476505432672, 37.494234214716926, -94.6370857506264, 95.47623159075115, 226.14568906203445, -57.85794842931752, 0.19000000000000483, 0.34999999999999787, 270.6350649561269, 0.3726781251816651, 0.20999999999999686, 16.835093580317857, 19.524184235221348, 339.4115951350137, 24.581641812600903, 12.803514309955295, 6.177861056285131, 3.460000000000001, 165.57568885643417, 72.67230305528406, 17.89062228871343, 22.744596326730562, 62.074800069401505, 90.06336599262491, 275.28920058362695, -1.360367654506585, 124.92572885552633, 236.3402417201874, 5.554543368025537, 13.677905944918148], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [12.562475273248168, -506.3099574269044, -392.05378894194996, -107.89284267530937, -339.3470342323254, -5.702907231480101, -96.48593013921261, -418.4381143873512, -508.30419195714086, -280.21788199760726, -52.20963520323031, -358.90102905502835, -290.20189276109784, -275.9337089254283, -23.660971386443666, -456.9096170713476, -403.06040128514803, -99.75283087143387, 64.07923683438275, -50.890942108535626, -334.45011542598655, -456.4543091297591, -369.30076196058076, 33.10732474822205, -230.18156384009052, -394.9186897411763, -416.87681051502693, -390.63867883476837, -358.63346983640463, -186.2781652119413, -111.11359068044882, -431.3961094904714, 77.72892949862185, -357.5261402380338, 2.0000000000000013, -373.5877375292218, -518.6454863614234, -384.4802643874592, -406.070295045524, -114.64571488546785, -368.1529496220854, -508.6976586224509, -37.82250323616654, -465.75315258491344, -424.5859916860402, -402.5208534637992, -476.08434803819597, -343.53269499959043, -406.3935312817765, -555.4009273791121, -270.1849708205569, -418.6963594333939, -76.08822540787745, -426.67296263714445, -362.3730370368141, -116.51017408794289, -300.4376602218189, -349.4590906639853, -364.6678796140459, -339.4064088394928, -264.66407696258443, -433.69865363254473, -291.5378602878378, -317.13752291446485, -420.53846144436585, 195.05, -371.7216730381648, -347.27966423321163, -330.4341797839037, 54.22645666372264, -243.34376775409623, -497.61997398831966, -300.543205714848, -482.93602327973963, -195.5570328475675, -473.4416730086296, -365.0084969093854, -505.2607056503556, -41.10675756375692, -305.0493344167662, -218.05264896689908, -247.6756844418997, -480.72633952659925, -33.74341021512937, -427.67374741745533, -349.73087977639506, -152.3638839183668, 80.21000000000001, 71.76058830156214, -403.8530249162402, -158.75347936930353, -340.3236600625759, -377.87355980288663, -441.23555493618255, -311.8620968063176, -350.8596285170679, -283.9690665265444, -468.39200787622593, -425.61050014087533, -125.33170881574594, -161.51700444463995, -458.61657003826764, 71.04719673661526, 87.41663521095876, -367.1956012934247, -321.22098649817406, -352.2105014147267, -344.2446264993856, -377.7636253818276, -388.81982811260355, -250.42952687811044, -450.2669243739307, -486.12584727340476, -309.0038932358318, -492.44290473700363, -377.7589615594779, -381.89445013026227, -381.0973776226998, -450.21282776037344, -374.9597739977063, 105.94024174448228, -435.41182591358296, -422.7228287423136, -350.6795511196171, -448.42234900014427, -229.32539068493696, -275.92724226634635, -349.50612451017486, -369.70666180097334, -343.6639125402793, -362.91214850251833, -368.0231863893229, -387.89332010392553, -457.67287506397344, -44.4894717220225, -487.31692801869286, -418.5827515985366, -292.6627771090519, -320.45507156942796, -394.73326571689967, -453.0318448544325, -211.24831863491528, -387.28593547576304, -265.1351351480585, -377.4760468608531, -483.09043781576474, -404.57239660936625, -141.674243668093, -39.85168530555859, -578.932674869041, -418.62441913004267, -355.550305529811, -352.7078036898947, -375.1362322165027, -324.786008126627, -434.24410197958787, -102.71195212693851, -422.2574637155842, -267.797897042168, -452.8790226690881, -424.04078169495835, -333.718335423354, -380.430591697686, -368.80375790820744, -344.2621716246029, -403.95920474245906, 122.78, -433.8109797586264, -318.40571729384305, -383.2698081031877, -404.6184531324081, -306.336784912658, -402.22126626998477, -327.1013567110449, -286.5375318924368, -315.84535280129097, -65.75239378876739, -413.24271213028004, -308.1979685171687, 2.0000000000000013, -402.4319796985286, -430.82301805675223, -274.4995194316089, -320.29524880843354, -316.9879546882298, -112.25828108764095, -327.10436642202, -131.06284289229453, -315.26591277633514, 58.73426087429341, -510.5253323341515, -493.95765360138347, -109.22822582920051, -449.953851920169, -403.3319949822617, 9.402880926577964, -262.5335313027606, -212.5967635709852, -388.18650064545085, -394.41987008127904], "policy_predator_policy_reward": [66.52611521034424, 509.20442383894135, 231.184429798687, 370.94076807752975, 286.52015518958177, 194.92536510763063, 1.2775322667737514, 471.0015584377591, 468.33708906459464, 326.49606508462426, 290.61818720933445, 280.7490777890641, 270.1260770783851, 284.26117327900516, 219.04177176878306, 372.36449474817266, 403.110401285148, 202.9728308714337, 75.15076316561736, 150.34094210853522, 341.7901154259865, 456.54430912975903, 387.0987798688869, 97.34579527245398, 292.5042044986395, 395.79206161829404, 422.842618286936, 394.36525797304756, 348.81298688144915, 291.2918138728871, 346.27891828921355, 271.29313218223353, 294.59235086120464, 271.750109311285, 289.67155275903286, 218.40039350581173, 383.6534347887943, 533.3481254575997, 406.3802950455237, 125.86803076465672, 357.81356472141306, 512.1970532806301, 374.87559570389567, 330.0763387952166, 342.18843255172436, 402.3347437764775, 477.22293143190484, 343.5630314449251, 341.3937366872151, 488.5964241162014, 297.33663932804313, 414.25138138040415, 365.89730933173536, 388.1155733065435, 482.65199849987084, 113.09176832394341, 368.5718427255905, 364.862931606963, 327.2711191619438, 433.59705971838144, 369.3643537314179, 535.4505136343839, 291.8189150617873, 354.9204425123636, 411.90845477006883, 82.16368670144317, 373.14687398918977, 346.5093829800293, 252.92608838597758, 292.8171697304411, 403.1844278736207, 341.091536739931, 346.2439980943097, 470.487621568939, 428.76539366398254, 269.0368158893908, 337.42125720070464, 511.836587300483, 134.7142003683609, 330.7077186065534, 116.4880044716167, 363.7390914311538, 370.49830537248766, 319.2858976139265, 433.96301179728465, 350.4469929731627, 145.66988172808013, 72.4562767139688, 72.62503163243629, 403.91302491624015, 258.7509592674321, 359.2135199394422, 429.4208653823377, 370.7040879587822, 314.14436745217995, 350.402961850401, 312.68322912137353, 472.0737972996085, 344.4177177036284, 354.2728635641562, 444.94446917887063, 380.864655617608, 68.27280423144167, 79.31750009825757, 384.383871752604, 312.48371875332657, 339.0200735435262, 353.75708662791163, 406.69261665924347, 370.3484305620232, 293.6023726038778, 440.3154427888212, 486.2958472734046, 309.2638932358317, 493.4529047370036, 377.92896155947784, 361.0384306354008, 418.2411566281665, 450.2428277603734, 377.0697739977062, 288.334660172346, 344.8920143053505, 428.17835058896634, 355.11321610633377, 380.0942875020749, 407.94327525799787, 282.3972422663466, 349.6761245101747, 345.85679335513987, 397.1429951009845, 413.8937271577326, 323.64108856109146, 426.0118541174164, 387.5426038015234, 523.1109106782591, 182.48325920503737, 420.06029157078245, 307.76429450161044, 431.81057303320534, 301.654926680288, 307.7478277852834, 495.16710075839126, 339.9746266060217, 349.9406782325164, 336.6634119946122, 429.2659869313797, 461.2732560409009, 180.44961582730937, 419.4410794784292, 425.4889697582051, 328.1398468309862, 388.1769293995495, 352.7378036898947, 375.2962322165026, 324.92600812662687, 434.4541019795878, 443.6393348398956, 351.9651459587536, 269.2459310309177, 451.80366680551975, 424.1207816949583, 333.848335423354, 371.38818476156644, 394.68125842464485, 333.65331667673695, 434.09224392554637, 276.28300290473516, 374.1595719889049, 356.0992368009419, 370.157930408689, 401.6487874308133, 322.10996492420793, 376.35558748888593, 359.1448965484285, 289.7475318924367, 316.09535280129097, 325.01191390724676, 319.55888086823614, 298.5952752388677, 80.2749963335847, 446.56151485192856, 404.5841051920657, 335.93480218746885, 281.6045623793034, 233.49645690735056, 257.82457893792224, 270.6632788666573, 277.56729644028167, 288.59727058967263, 243.22358189599618, 474.3841700589194, 528.7384482221089, 268.9399058810476, 415.167900723848, 382.6197421013013, 247.6496136745695, 116.12605527359811, 364.5587829681734, 386.55741164977763, 409.7268650218703]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.940444306468796, "mean_inference_ms": 68.36956199453056, "mean_action_processing_ms": 2.705426291365007, "mean_env_wait_ms": 4.463734786714606, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0061026811599731445, "StateBufferConnector_ms": 0.00350034236907959, "ViewRequirementAgentConnector_ms": 0.11710774898529053}, "num_episodes": 22, "episode_return_max": 339.4115951350137, "episode_return_min": -131.80429785747216, "episode_return_mean": 73.10181050612853, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1568000, "num_agent_steps_trained": 1568000, "num_env_steps_sampled": 392000, "num_env_steps_trained": 392000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 27.697783350685018, "num_env_steps_trained_throughput_per_sec": 27.697783350685018, "timesteps_total": 392000, "num_env_steps_sampled_lifetime": 392000, "num_agent_steps_sampled_lifetime": 1568000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1568000, "timers": {"training_iteration_time_ms": 249245.417, "restore_workers_time_ms": 0.014, "training_step_time_ms": 249245.36, "sample_time_ms": 2185.042, "learn_time_ms": 247039.651, "learn_throughput": 16.192, "synch_weights_time_ms": 16.935}, "counters": {"num_env_steps_sampled": 392000, "num_env_steps_trained": 392000, "num_agent_steps_sampled": 1568000, "num_agent_steps_trained": 1568000}, "done": false, "training_iteration": 98, "trial_id": "b941d_00000", "date": "2024-08-19_09-45-32", "timestamp": 1724040932, "time_this_iter_s": 144.44714212417603, "time_total_s": 179495.12790751457, "pid": 81115, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[32, [4, 4], 2], [64, [3, 3], 2], [128, [3, 3], 1]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [256, 256], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b29dcb80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 179495.12790751457, "iterations_since_restore": 98, "perf": {"cpu_util_percent": 31.827317073170732, "ram_util_percent": 82.21658536585365}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 16.12719158470315, "cur_kl_coeff": 1.5187500000000005, "cur_lr": 0.00010000000000000003, "total_loss": 8.378335065438003, "policy_loss": -0.08015061107676023, "vf_loss": 8.437859150972315, "vf_explained_var": 0.03967629251656709, "kl": 0.013581249185232134, "entropy": 0.9649199860751945, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 186165.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 16.029164371793232, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.00010000000000000003, "total_loss": 8.674261040662332, "policy_loss": -0.08096949650028908, "vf_loss": 8.738595792730019, "vf_explained_var": -0.40681838405826104, "kl": 0.01642938000795803, "entropy": 0.7388483449580178, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 186165.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_agent_steps_sampled": 1584000, "num_agent_steps_trained": 1584000}, "env_runners": {"episode_reward_max": 354.8641183198136, "episode_reward_min": -131.80429785747216, "episode_reward_mean": 67.15575907248981, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -581.4973004194204, "predator_policy": 7.550573658986641}, "policy_reward_max": {"prey_policy": 195.05, "predator_policy": 581.6773004194202}, "policy_reward_mean": {"prey_policy": -311.26412991778705, "predator_policy": 344.84200945403194}, "custom_metrics": {}, "hist_stats": {"episode_reward": [13.87580949751152, 11.532315879188278, -6.83999024249308, 201.37627867803263, -82.58366882163737, 1.1689198390437472, -131.80429785747216, 22.706690454496798, 251.2516945932568, 116.86055569905825, 83.53802344674956, 56.793890426786774, 206.45213677067272, 38.06397437184828, 268.58368002714616, 0.6549196978426628, 269.53553499623723, 3.31222287113562, 33.252390668661214, 28.803503697176517, -21.01135805855334, 119.26582699439166, 14.498762493972393, 175.31445324468606, 7.005377576597358, 145.97227452368367, 144.44561993399836, 118.88733977499497, -18.98416139794905, 1.8256039791958287, 32.39595201821183, 147.74837231116342, 205.67555031357125, 306.0541362772732, 8.451002714332317, -3.677967742674198, 10.457593726835622, 33.22136414065841, 0.42999999999999905, 1.1799999999999886, 16.28775951060532, 2.1399999999999957, 303.75509030859575, 9.889186833369617, 110.28982307499165, 6.639999999999996, 29.62921411487199, 6.599480826982356, -32.011737248959264, 173.78777014258102, 16.57905736480462, 18.27716242716532, 138.63476505432672, 37.494234214716926, -94.6370857506264, 95.47623159075115, 226.14568906203445, -57.85794842931752, 0.19000000000000483, 0.34999999999999787, 270.6350649561269, 0.3726781251816651, 0.20999999999999686, 16.835093580317857, 19.524184235221348, 339.4115951350137, 24.581641812600903, 12.803514309955295, 6.177861056285131, 3.460000000000001, 165.57568885643417, 72.67230305528406, 17.89062228871343, 22.744596326730562, 62.074800069401505, 90.06336599262491, 275.28920058362695, -1.360367654506585, 124.92572885552633, 236.3402417201874, 5.554543368025537, 13.677905944918148, 183.14, 125.49217620539662, 139.71321952177354, 0.2800000000000016, 167.04751202574258, 0.4599999999999973, 86.33, 0.20999999999999996, 3.359999999999994, 0.17999999999999905, -27.13532139204088, 19.45810809851134, 354.8641183198136, 31.172017686626894, 77.87838548078625, 24.86917246589197, -79.35766203179064, 4.804897636075627], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-518.6454863614234, -384.4802643874592, -406.070295045524, -114.64571488546785, -368.1529496220854, -508.6976586224509, -37.82250323616654, -465.75315258491344, -424.5859916860402, -402.5208534637992, -476.08434803819597, -343.53269499959043, -406.3935312817765, -555.4009273791121, -270.1849708205569, -418.6963594333939, -76.08822540787745, -426.67296263714445, -362.3730370368141, -116.51017408794289, -300.4376602218189, -349.4590906639853, -364.6678796140459, -339.4064088394928, -264.66407696258443, -433.69865363254473, -291.5378602878378, -317.13752291446485, -420.53846144436585, 195.05, -371.7216730381648, -347.27966423321163, -330.4341797839037, 54.22645666372264, -243.34376775409623, -497.61997398831966, -300.543205714848, -482.93602327973963, -195.5570328475675, -473.4416730086296, -365.0084969093854, -505.2607056503556, -41.10675756375692, -305.0493344167662, -218.05264896689908, -247.6756844418997, -480.72633952659925, -33.74341021512937, -427.67374741745533, -349.73087977639506, -152.3638839183668, 80.21000000000001, 71.76058830156214, -403.8530249162402, -158.75347936930353, -340.3236600625759, -377.87355980288663, -441.23555493618255, -311.8620968063176, -350.8596285170679, -283.9690665265444, -468.39200787622593, -425.61050014087533, -125.33170881574594, -161.51700444463995, -458.61657003826764, 71.04719673661526, 87.41663521095876, -367.1956012934247, -321.22098649817406, -352.2105014147267, -344.2446264993856, -377.7636253818276, -388.81982811260355, -250.42952687811044, -450.2669243739307, -486.12584727340476, -309.0038932358318, -492.44290473700363, -377.7589615594779, -381.89445013026227, -381.0973776226998, -450.21282776037344, -374.9597739977063, 105.94024174448228, -435.41182591358296, -422.7228287423136, -350.6795511196171, -448.42234900014427, -229.32539068493696, -275.92724226634635, -349.50612451017486, -369.70666180097334, -343.6639125402793, -362.91214850251833, -368.0231863893229, -387.89332010392553, -457.67287506397344, -44.4894717220225, -487.31692801869286, -418.5827515985366, -292.6627771090519, -320.45507156942796, -394.73326571689967, -453.0318448544325, -211.24831863491528, -387.28593547576304, -265.1351351480585, -377.4760468608531, -483.09043781576474, -404.57239660936625, -141.674243668093, -39.85168530555859, -578.932674869041, -418.62441913004267, -355.550305529811, -352.7078036898947, -375.1362322165027, -324.786008126627, -434.24410197958787, -102.71195212693851, -422.2574637155842, -267.797897042168, -452.8790226690881, -424.04078169495835, -333.718335423354, -380.430591697686, -368.80375790820744, -344.2621716246029, -403.95920474245906, 122.78, -433.8109797586264, -318.40571729384305, -383.2698081031877, -404.6184531324081, -306.336784912658, -402.22126626998477, -327.1013567110449, -286.5375318924368, -315.84535280129097, -65.75239378876739, -413.24271213028004, -308.1979685171687, 2.0000000000000013, -402.4319796985286, -430.82301805675223, -274.4995194316089, -320.29524880843354, -316.9879546882298, -112.25828108764095, -327.10436642202, -131.06284289229453, -315.26591277633514, 58.73426087429341, -510.5253323341515, -493.95765360138347, -109.22822582920051, -449.953851920169, -403.3319949822617, 9.402880926577964, -262.5335313027606, -212.5967635709852, -388.18650064545085, -394.41987008127904, 175.55942634101336, -368.30522102306514, -96.2391148401105, -553.0359928346006, -74.85518983641263, -301.2903514941032, -417.60251089980295, -295.98868254878937, -65.04194284384336, -426.405450332742, -360.00421345549717, -296.92719119695124, -53.617892533080806, -349.4397883692563, -305.46198348967346, -377.00143639890393, -581.4973004194204, -354.7627731457064, -357.7072764037934, -399.6089195438694, -187.89550137008197, -251.45678080157157, -428.0195087891293, -352.568857839816, -347.4036609875896, 193.07, -398.5677534137089, -278.12500592688144, -356.4155827417146, -96.94297879260849, -348.27306171939705, -299.09138776508524, -417.9586780421164, -503.9583845169716, -417.8384076596593, -127.62094693522224], "policy_predator_policy_reward": [383.6534347887943, 533.3481254575997, 406.3802950455237, 125.86803076465672, 357.81356472141306, 512.1970532806301, 374.87559570389567, 330.0763387952166, 342.18843255172436, 402.3347437764775, 477.22293143190484, 343.5630314449251, 341.3937366872151, 488.5964241162014, 297.33663932804313, 414.25138138040415, 365.89730933173536, 388.1155733065435, 482.65199849987084, 113.09176832394341, 368.5718427255905, 364.862931606963, 327.2711191619438, 433.59705971838144, 369.3643537314179, 535.4505136343839, 291.8189150617873, 354.9204425123636, 411.90845477006883, 82.16368670144317, 373.14687398918977, 346.5093829800293, 252.92608838597758, 292.8171697304411, 403.1844278736207, 341.091536739931, 346.2439980943097, 470.487621568939, 428.76539366398254, 269.0368158893908, 337.42125720070464, 511.836587300483, 134.7142003683609, 330.7077186065534, 116.4880044716167, 363.7390914311538, 370.49830537248766, 319.2858976139265, 433.96301179728465, 350.4469929731627, 145.66988172808013, 72.4562767139688, 72.62503163243629, 403.91302491624015, 258.7509592674321, 359.2135199394422, 429.4208653823377, 370.7040879587822, 314.14436745217995, 350.402961850401, 312.68322912137353, 472.0737972996085, 344.4177177036284, 354.2728635641562, 444.94446917887063, 380.864655617608, 68.27280423144167, 79.31750009825757, 384.383871752604, 312.48371875332657, 339.0200735435262, 353.75708662791163, 406.69261665924347, 370.3484305620232, 293.6023726038778, 440.3154427888212, 486.2958472734046, 309.2638932358317, 493.4529047370036, 377.92896155947784, 361.0384306354008, 418.2411566281665, 450.2428277603734, 377.0697739977062, 288.334660172346, 344.8920143053505, 428.17835058896634, 355.11321610633377, 380.0942875020749, 407.94327525799787, 282.3972422663466, 349.6761245101747, 345.85679335513987, 397.1429951009845, 413.8937271577326, 323.64108856109146, 426.0118541174164, 387.5426038015234, 523.1109106782591, 182.48325920503737, 420.06029157078245, 307.76429450161044, 431.81057303320534, 301.654926680288, 307.7478277852834, 495.16710075839126, 339.9746266060217, 349.9406782325164, 336.6634119946122, 429.2659869313797, 461.2732560409009, 180.44961582730937, 419.4410794784292, 425.4889697582051, 328.1398468309862, 388.1769293995495, 352.7378036898947, 375.2962322165026, 324.92600812662687, 434.4541019795878, 443.6393348398956, 351.9651459587536, 269.2459310309177, 451.80366680551975, 424.1207816949583, 333.848335423354, 371.38818476156644, 394.68125842464485, 333.65331667673695, 434.09224392554637, 276.28300290473516, 374.1595719889049, 356.0992368009419, 370.157930408689, 401.6487874308133, 322.10996492420793, 376.35558748888593, 359.1448965484285, 289.7475318924367, 316.09535280129097, 325.01191390724676, 319.55888086823614, 298.5952752388677, 80.2749963335847, 446.56151485192856, 404.5841051920657, 335.93480218746885, 281.6045623793034, 233.49645690735056, 257.82457893792224, 270.6632788666573, 277.56729644028167, 288.59727058967263, 243.22358189599618, 474.3841700589194, 528.7384482221089, 268.9399058810476, 415.167900723848, 382.6197421013013, 247.6496136745695, 116.12605527359811, 364.5587829681734, 386.55741164977763, 409.7268650218703, 7.550573658986641, 368.33522102306523, 291.4379999828587, 483.329283897249, 58.84963111729299, 457.00912973499635, 417.62251089980293, 296.2486825487893, 302.060328194096, 356.4345770082327, 360.25421345549694, 297.1371911969513, 138.86789253308066, 350.5197883692563, 305.5219834896734, 377.1514363989038, 581.6773004194202, 357.9427731457063, 357.8372764037933, 399.65891954386933, 47.14263220959718, 365.0743285700147, 433.6586522262153, 366.38782250124086, 213.07681658120958, 296.12096272619357, 373.5407931966463, 334.3239838305706, 209.5151226918603, 321.7218243232495, 363.2144251404968, 309.01919680987754, 305.881193499216, 536.6782070280813, 174.98067020974423, 375.28358202121296]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.765126932819238, "mean_inference_ms": 68.01684062216397, "mean_action_processing_ms": 2.6821424786643515, "mean_env_wait_ms": 4.067246244645244, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005592942237854004, "StateBufferConnector_ms": 0.0033888816833496094, "ViewRequirementAgentConnector_ms": 0.11634635925292969}, "num_episodes": 18, "episode_return_max": 354.8641183198136, "episode_return_min": -131.80429785747216, "episode_return_mean": 67.15575907248981, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1584000, "num_agent_steps_trained": 1584000, "num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 29.30685780377581, "num_env_steps_trained_throughput_per_sec": 29.30685780377581, "timesteps_total": 396000, "num_env_steps_sampled_lifetime": 396000, "num_agent_steps_sampled_lifetime": 1584000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1584000, "timers": {"training_iteration_time_ms": 249399.333, "restore_workers_time_ms": 0.014, "training_step_time_ms": 249399.277, "sample_time_ms": 2152.605, "learn_time_ms": 247225.495, "learn_throughput": 16.18, "synch_weights_time_ms": 16.929}, "counters": {"num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_agent_steps_sampled": 1584000, "num_agent_steps_trained": 1584000}, "done": false, "training_iteration": 99, "trial_id": "b941d_00000", "date": "2024-08-19_09-47-49", "timestamp": 1724041069, "time_this_iter_s": 136.52682495117188, "time_total_s": 179631.65473246574, "pid": 81115, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[32, [4, 4], 2], [64, [3, 3], 2], [128, [3, 3], 1]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [256, 256], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b042d0d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 179631.65473246574, "iterations_since_restore": 99, "perf": {"cpu_util_percent": 24.914871794871793, "ram_util_percent": 80.55692307692308}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 12.941156415333824, "cur_kl_coeff": 1.5187500000000005, "cur_lr": 0.00010000000000000003, "total_loss": 9.02085857895947, "policy_loss": -0.07393734073204791, "vf_loss": 9.074900742687246, "vf_explained_var": -0.26376107924829717, "kl": 0.013099705349009417, "entropy": 0.8706914447287403, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 188055.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 17.752579883419017, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.00010000000000000003, "total_loss": 9.490803040398491, "policy_loss": -0.08497942603444533, "vf_loss": 9.559266504156527, "vf_explained_var": -0.9383656443742218, "kl": 0.016312072087522313, "entropy": 0.7866120634255586, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 188055.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 400000, "num_env_steps_trained": 400000, "num_agent_steps_sampled": 1600000, "num_agent_steps_trained": 1600000}, "env_runners": {"episode_reward_max": 372.16782644859353, "episode_reward_min": -273.7886928088745, "episode_reward_mean": 66.85496103923734, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -698.7421716961703, "predator_policy": 7.550573658986641}, "policy_reward_max": {"prey_policy": 193.07, "predator_policy": 652.3256006943532}, "policy_reward_mean": {"prey_policy": -315.18615046158664, "predator_policy": 348.6136309812053}, "custom_metrics": {}, "hist_stats": {"episode_reward": [175.31445324468606, 7.005377576597358, 145.97227452368367, 144.44561993399836, 118.88733977499497, -18.98416139794905, 1.8256039791958287, 32.39595201821183, 147.74837231116342, 205.67555031357125, 306.0541362772732, 8.451002714332317, -3.677967742674198, 10.457593726835622, 33.22136414065841, 0.42999999999999905, 1.1799999999999886, 16.28775951060532, 2.1399999999999957, 303.75509030859575, 9.889186833369617, 110.28982307499165, 6.639999999999996, 29.62921411487199, 6.599480826982356, -32.011737248959264, 173.78777014258102, 16.57905736480462, 18.27716242716532, 138.63476505432672, 37.494234214716926, -94.6370857506264, 95.47623159075115, 226.14568906203445, -57.85794842931752, 0.19000000000000483, 0.34999999999999787, 270.6350649561269, 0.3726781251816651, 0.20999999999999686, 16.835093580317857, 19.524184235221348, 339.4115951350137, 24.581641812600903, 12.803514309955295, 6.177861056285131, 3.460000000000001, 165.57568885643417, 72.67230305528406, 17.89062228871343, 22.744596326730562, 62.074800069401505, 90.06336599262491, 275.28920058362695, -1.360367654506585, 124.92572885552633, 236.3402417201874, 5.554543368025537, 13.677905944918148, 183.14, 125.49217620539662, 139.71321952177354, 0.2800000000000016, 167.04751202574258, 0.4599999999999973, 86.33, 0.20999999999999996, 3.359999999999994, 0.17999999999999905, -27.13532139204088, 19.45810809851134, 354.8641183198136, 31.172017686626894, 77.87838548078625, 24.86917246589197, -79.35766203179064, 4.804897636075627, 1.4499999999999993, -273.7886928088745, 7.6822378279830685, 0.19999999999999352, 184.05650378703052, -5.5313708898488745, 36.94297330120452, 105.31574021374966, 372.16782644859353, 235.57350938176893, -11.529798968270503, 251.58503312012465, 0.2699999999999969, 3.3000000000000007, 72.37312312977626, 0.08999999999999608, 262.96514125166107, 58.18334652065193, 3.545148057399172, 50.387292424854024, 109.55000000000003, 0.10999999999999588, 4.309999999999993], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-480.72633952659925, -33.74341021512937, -427.67374741745533, -349.73087977639506, -152.3638839183668, 80.21000000000001, 71.76058830156214, -403.8530249162402, -158.75347936930353, -340.3236600625759, -377.87355980288663, -441.23555493618255, -311.8620968063176, -350.8596285170679, -283.9690665265444, -468.39200787622593, -425.61050014087533, -125.33170881574594, -161.51700444463995, -458.61657003826764, 71.04719673661526, 87.41663521095876, -367.1956012934247, -321.22098649817406, -352.2105014147267, -344.2446264993856, -377.7636253818276, -388.81982811260355, -250.42952687811044, -450.2669243739307, -486.12584727340476, -309.0038932358318, -492.44290473700363, -377.7589615594779, -381.89445013026227, -381.0973776226998, -450.21282776037344, -374.9597739977063, 105.94024174448228, -435.41182591358296, -422.7228287423136, -350.6795511196171, -448.42234900014427, -229.32539068493696, -275.92724226634635, -349.50612451017486, -369.70666180097334, -343.6639125402793, -362.91214850251833, -368.0231863893229, -387.89332010392553, -457.67287506397344, -44.4894717220225, -487.31692801869286, -418.5827515985366, -292.6627771090519, -320.45507156942796, -394.73326571689967, -453.0318448544325, -211.24831863491528, -387.28593547576304, -265.1351351480585, -377.4760468608531, -483.09043781576474, -404.57239660936625, -141.674243668093, -39.85168530555859, -578.932674869041, -418.62441913004267, -355.550305529811, -352.7078036898947, -375.1362322165027, -324.786008126627, -434.24410197958787, -102.71195212693851, -422.2574637155842, -267.797897042168, -452.8790226690881, -424.04078169495835, -333.718335423354, -380.430591697686, -368.80375790820744, -344.2621716246029, -403.95920474245906, 122.78, -433.8109797586264, -318.40571729384305, -383.2698081031877, -404.6184531324081, -306.336784912658, -402.22126626998477, -327.1013567110449, -286.5375318924368, -315.84535280129097, -65.75239378876739, -413.24271213028004, -308.1979685171687, 2.0000000000000013, -402.4319796985286, -430.82301805675223, -274.4995194316089, -320.29524880843354, -316.9879546882298, -112.25828108764095, -327.10436642202, -131.06284289229453, -315.26591277633514, 58.73426087429341, -510.5253323341515, -493.95765360138347, -109.22822582920051, -449.953851920169, -403.3319949822617, 9.402880926577964, -262.5335313027606, -212.5967635709852, -388.18650064545085, -394.41987008127904, 175.55942634101336, -368.30522102306514, -96.2391148401105, -553.0359928346006, -74.85518983641263, -301.2903514941032, -417.60251089980295, -295.98868254878937, -65.04194284384336, -426.405450332742, -360.00421345549717, -296.92719119695124, -53.617892533080806, -349.4397883692563, -305.46198348967346, -377.00143639890393, -581.4973004194204, -354.7627731457064, -357.7072764037934, -399.6089195438694, -187.89550137008197, -251.45678080157157, -428.0195087891293, -352.568857839816, -347.4036609875896, 193.07, -398.5677534137089, -278.12500592688144, -356.4155827417146, -96.94297879260849, -348.27306171939705, -299.09138776508524, -417.9586780421164, -503.9583845169716, -417.8384076596593, -127.62094693522224, -321.4963657802174, -333.8007596546996, -698.7421716961703, -546.8372178021718, -537.0760944815331, -368.16545407534676, -387.03959229069994, -451.2009844198783, -468.45332912826575, -132.4974623907291, -383.8649107841425, -364.5367062625144, -331.58838007002475, -401.68126658357835, -183.7230170584263, -356.60970430559775, -425.704795720181, 154.46000000000004, -19.89256476628823, -447.6930043970896, -447.8150990030462, -477.82346498550135, -378.1236844412624, -74.68528420209064, -384.61167324600854, -329.68422753855174, -367.0063474469537, -384.28719737973444, -248.64033489892742, -284.53852694913354, -462.10680363125795, -400.3388243698184, -388.4277463835974, -14.489317297027258, -383.27361584484225, -291.4285952466418, -435.11161732955674, -394.9645778483644, -381.39822710031433, -177.92365739718312, 33.333281659781946, -423.64227992273806, -424.3422490415899, -317.8038564813959, -519.9514579517029, -259.7890233476025], "policy_predator_policy_reward": [370.49830537248766, 319.2858976139265, 433.96301179728465, 350.4469929731627, 145.66988172808013, 72.4562767139688, 72.62503163243629, 403.91302491624015, 258.7509592674321, 359.2135199394422, 429.4208653823377, 370.7040879587822, 314.14436745217995, 350.402961850401, 312.68322912137353, 472.0737972996085, 344.4177177036284, 354.2728635641562, 444.94446917887063, 380.864655617608, 68.27280423144167, 79.31750009825757, 384.383871752604, 312.48371875332657, 339.0200735435262, 353.75708662791163, 406.69261665924347, 370.3484305620232, 293.6023726038778, 440.3154427888212, 486.2958472734046, 309.2638932358317, 493.4529047370036, 377.92896155947784, 361.0384306354008, 418.2411566281665, 450.2428277603734, 377.0697739977062, 288.334660172346, 344.8920143053505, 428.17835058896634, 355.11321610633377, 380.0942875020749, 407.94327525799787, 282.3972422663466, 349.6761245101747, 345.85679335513987, 397.1429951009845, 413.8937271577326, 323.64108856109146, 426.0118541174164, 387.5426038015234, 523.1109106782591, 182.48325920503737, 420.06029157078245, 307.76429450161044, 431.81057303320534, 301.654926680288, 307.7478277852834, 495.16710075839126, 339.9746266060217, 349.9406782325164, 336.6634119946122, 429.2659869313797, 461.2732560409009, 180.44961582730937, 419.4410794784292, 425.4889697582051, 328.1398468309862, 388.1769293995495, 352.7378036898947, 375.2962322165026, 324.92600812662687, 434.4541019795878, 443.6393348398956, 351.9651459587536, 269.2459310309177, 451.80366680551975, 424.1207816949583, 333.848335423354, 371.38818476156644, 394.68125842464485, 333.65331667673695, 434.09224392554637, 276.28300290473516, 374.1595719889049, 356.0992368009419, 370.157930408689, 401.6487874308133, 322.10996492420793, 376.35558748888593, 359.1448965484285, 289.7475318924367, 316.09535280129097, 325.01191390724676, 319.55888086823614, 298.5952752388677, 80.2749963335847, 446.56151485192856, 404.5841051920657, 335.93480218746885, 281.6045623793034, 233.49645690735056, 257.82457893792224, 270.6632788666573, 277.56729644028167, 288.59727058967263, 243.22358189599618, 474.3841700589194, 528.7384482221089, 268.9399058810476, 415.167900723848, 382.6197421013013, 247.6496136745695, 116.12605527359811, 364.5587829681734, 386.55741164977763, 409.7268650218703, 7.550573658986641, 368.33522102306523, 291.4379999828587, 483.329283897249, 58.84963111729299, 457.00912973499635, 417.62251089980293, 296.2486825487893, 302.060328194096, 356.4345770082327, 360.25421345549694, 297.1371911969513, 138.86789253308066, 350.5197883692563, 305.5219834896734, 377.1514363989038, 581.6773004194202, 357.9427731457063, 357.8372764037933, 399.65891954386933, 47.14263220959718, 365.0743285700147, 433.6586522262153, 366.38782250124086, 213.07681658120958, 296.12096272619357, 373.5407931966463, 334.3239838305706, 209.5151226918603, 321.7218243232495, 363.2144251404968, 309.01919680987754, 305.881193499216, 536.6782070280813, 174.98067020974423, 375.28358202121296, 322.90636578021736, 333.84075965469964, 652.3256006943532, 319.4650959951151, 502.33299633700415, 410.59079004785866, 387.2095922906999, 451.23098441987827, 345.0236901204071, 439.9836051856179, 403.43234237979567, 339.43790377701214, 238.25385142928042, 531.9587685255266, 328.79833780413617, 316.85012377363654, 404.11461351413146, 239.29800865464284, 410.3653261001579, 292.7937524449893, 439.7011293909185, 474.40763562935814, 370.29917004550737, 334.09483171797024, 384.6616732460085, 329.90422753855165, 370.07634744695366, 384.5171973797342, 368.9308664975535, 236.62111848028337, 462.1568036312579, 400.37882436981835, 356.3336337912537, 309.5485711410321, 352.8461593403174, 380.03939827181813, 434.88137142365156, 398.7399718116686, 283.0654414077675, 326.64373551458397, 76.07671834021824, 423.7822799227379, 424.35224904158997, 317.90385648139585, 519.9914579517028, 264.05902334760236]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.049586168284422, "mean_inference_ms": 66.72439160312885, "mean_action_processing_ms": 2.8733532288711836, "mean_env_wait_ms": 4.032092332558815, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005360007286071777, "StateBufferConnector_ms": 0.0034542083740234375, "ViewRequirementAgentConnector_ms": 0.1227121353149414}, "num_episodes": 23, "episode_return_max": 372.16782644859353, "episode_return_min": -273.7886928088745, "episode_return_mean": 66.85496103923734, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1600000, "num_agent_steps_trained": 1600000, "num_env_steps_sampled": 400000, "num_env_steps_trained": 400000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 28.020592132675276, "num_env_steps_trained_throughput_per_sec": 28.020592132675276, "timesteps_total": 400000, "num_env_steps_sampled_lifetime": 400000, "num_agent_steps_sampled_lifetime": 1600000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1600000, "timers": {"training_iteration_time_ms": 219385.682, "restore_workers_time_ms": 0.014, "training_step_time_ms": 219385.624, "sample_time_ms": 2187.372, "learn_time_ms": 217176.686, "learn_throughput": 18.418, "synch_weights_time_ms": 17.293}, "counters": {"num_env_steps_sampled": 400000, "num_env_steps_trained": 400000, "num_agent_steps_sampled": 1600000, "num_agent_steps_trained": 1600000}, "done": true, "training_iteration": 100, "trial_id": "b941d_00000", "date": "2024-08-19_09-50-12", "timestamp": 1724041212, "time_this_iter_s": 142.80701279640198, "time_total_s": 179774.46174526215, "pid": 81115, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[32, [4, 4], 2], [64, [3, 3], 2], [128, [3, 3], 1]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [256, 256], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b37d5310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 179774.46174526215, "iterations_since_restore": 100, "perf": {"cpu_util_percent": 30.6512315270936, "ram_util_percent": 81.86600985221672}}
